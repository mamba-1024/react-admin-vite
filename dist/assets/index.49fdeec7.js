import{c as is,_ as X,r as ut,a as So,C as d_,o as ZL,A as kZ,b as Et,d as Pr,e as em,f as tn,g as oc,h as Qpe,T as Jpe,E as ede,M as tde,R as h7,i as Is,j as rde,t as nde,S as PZ,k as ide,l as ade,m as RZ,n as jp,p as ode,q as _y,s as oo,F as OZ,u as ed,v as ot,w as st,x as er,y as ze,z as nr,B as He,D as sde,G as FZ,H as Hi,I as ude,J as x3,K as lde,L as cde,N as sS,O as fde,P as DZ,Q as b3,U as BZ,V as hde,W as pde,X as dde,Y as vde,Z as gde,$ as mde,a0 as yde,a1 as _de,a2 as xde,a3 as tR,a4 as Iw}from"./index.a57427a9.js";import{P as bde}from"./index.3a531155.js";import"./transButton.64a27aec.js";var qL=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return Jv},get Circle(){return Owe},get Ellipse(){return Dwe},get Image(){return Nwe},get Line(){return $we},get Marker(){return Gwe},get Path(){return E4},get Polygon(){return Qwe},get Polyline(){return eCe},get Rect(){return iCe},get Text(){return oCe}},Symbol.toStringTag,{value:"Module"})),KL=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return Kd},get Circle(){return vCe},get Dom(){return mCe},get Ellipse(){return _Ce},get Image(){return bCe},get Line(){return CCe},get Marker(){return SCe},get Path(){return TCe},get Polygon(){return LCe},get Polyline(){return kCe},get Rect(){return OCe},get Text(){return zCe}},Symbol.toStringTag,{value:"Module"})),wde=function(r){var t,n,i=r.prefixCls,a=r.className,o=r.style,s=r.size,u=r.shape,l=is((t={},X(t,"".concat(i,"-lg"),s==="large"),X(t,"".concat(i,"-sm"),s==="small"),t)),f=is((n={},X(n,"".concat(i,"-circle"),u==="circle"),X(n,"".concat(i,"-square"),u==="square"),X(n,"".concat(i,"-round"),u==="round"),n)),h=ut.exports.useMemo(function(){return typeof s=="number"?{width:s,height:s,lineHeight:"".concat(s,"px")}:{}},[s]);return ut.exports.createElement("span",{className:is(i,l,f,a),style:So(So({},h),o)})},QL=wde,Cde=function(r){var t=r.prefixCls,n=r.className,i=r.active,a=r.shape,o=a===void 0?"circle":a,s=r.size,u=s===void 0?"default":s,l=ut.exports.useContext(d_),f=l.getPrefixCls,h=f("skeleton",t),p=ZL(r,["prefixCls","className"]),v=is(h,"".concat(h,"-element"),X({},"".concat(h,"-active"),i),n);return ut.exports.createElement("div",{className:v},ut.exports.createElement(QL,So({prefixCls:"".concat(h,"-avatar"),shape:o,size:u},p)))},Ede=Cde,Sde=function(r){var t,n=r.prefixCls,i=r.className,a=r.active,o=r.block,s=o===void 0?!1:o,u=r.size,l=u===void 0?"default":u,f=ut.exports.useContext(d_),h=f.getPrefixCls,p=h("skeleton",n),v=ZL(r,["prefixCls"]),m=is(p,"".concat(p,"-element"),(t={},X(t,"".concat(p,"-active"),a),X(t,"".concat(p,"-block"),s),t),i);return ut.exports.createElement("div",{className:m},ut.exports.createElement(QL,So({prefixCls:"".concat(p,"-button"),size:l},v)))},Ade=Sde,Tde={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM288 604a64 64 0 10128 0 64 64 0 10-128 0zm118-224a48 48 0 1096 0 48 48 0 10-96 0zm158 228a96 96 0 10192 0 96 96 0 10-192 0zm148-314a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"dot-chart",theme:"outlined"},Mde=Tde,NZ=function(r,t){return ut.exports.createElement(kZ,Et(Et({},r),{},{ref:t,icon:Mde}))};NZ.displayName="DotChartOutlined";var Lde=ut.exports.forwardRef(NZ),Ide=function(r){var t=r.prefixCls,n=r.className,i=r.style,a=r.active,o=r.children,s=ut.exports.useContext(d_),u=s.getPrefixCls,l=u("skeleton",t),f=is(l,"".concat(l,"-element"),X({},"".concat(l,"-active"),a),n),h=o!=null?o:ut.exports.createElement(Lde,null);return ut.exports.createElement("div",{className:f},ut.exports.createElement("div",{className:is("".concat(l,"-image"),n),style:i},h))},kde=Ide,Pde="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",Rde=function(r){var t=r.prefixCls,n=r.className,i=r.style,a=r.active,o=ut.exports.useContext(d_),s=o.getPrefixCls,u=s("skeleton",t),l=is(u,"".concat(u,"-element"),X({},"".concat(u,"-active"),a),n);return ut.exports.createElement("div",{className:l},ut.exports.createElement("div",{className:is("".concat(u,"-image"),n),style:i},ut.exports.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(u,"-image-svg")},ut.exports.createElement("path",{d:Pde,className:"".concat(u,"-image-path")}))))},Ode=Rde,Fde=function(r){var t,n=r.prefixCls,i=r.className,a=r.active,o=r.block,s=r.size,u=s===void 0?"default":s,l=ut.exports.useContext(d_),f=l.getPrefixCls,h=f("skeleton",n),p=ZL(r,["prefixCls"]),v=is(h,"".concat(h,"-element"),(t={},X(t,"".concat(h,"-active"),a),X(t,"".concat(h,"-block"),o),t),i);return ut.exports.createElement("div",{className:v},ut.exports.createElement(QL,So({prefixCls:"".concat(h,"-input"),size:u},p)))},Dde=Fde,Bde=function(r){var t=function(l){var f=r.width,h=r.rows,p=h===void 0?2:h;if(Array.isArray(f))return f[l];if(p-1===l)return f},n=r.prefixCls,i=r.className,a=r.style,o=r.rows,s=Pr(Array(o)).map(function(u,l){return ut.exports.createElement("li",{key:l,style:{width:t(l)}})});return ut.exports.createElement("ul",{className:is(n,i),style:a},s)},Nde=Bde,zde=function(r){var t=r.prefixCls,n=r.className,i=r.width,a=r.style;return ut.exports.createElement("h3",{className:is(t,n),style:So({width:i},a)})},$de=zde;function rR(e){return e&&em(e)==="object"?e:{}}function Ude(e,r){return e&&!r?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Vde(e,r){return!e&&r?{width:"38%"}:e&&r?{width:"50%"}:{}}function Gde(e,r){var t={};return(!e||!r)&&(t.width="61%"),!e&&r?t.rows=3:t.rows=2,t}var O2=function(r){var t=r.prefixCls,n=r.loading,i=r.className,a=r.style,o=r.children,s=r.avatar,u=s===void 0?!1:s,l=r.title,f=l===void 0?!0:l,h=r.paragraph,p=h===void 0?!0:h,v=r.active,m=r.round,x=ut.exports.useContext(d_),E=x.getPrefixCls,A=x.direction,L=E("skeleton",t);if(n||!("loading"in r)){var k,R=!!u,D=!!f,$=!!p,j;if(R){var H=So(So({prefixCls:"".concat(L,"-avatar")},Ude(D,$)),rR(u));j=ut.exports.createElement("div",{className:"".concat(L,"-header")},ut.exports.createElement(QL,So({},H)))}var ee;if(D||$){var U;if(D){var W=So(So({prefixCls:"".concat(L,"-title")},Vde(R,$)),rR(f));U=ut.exports.createElement($de,So({},W))}var Q;if($){var te=So(So({prefixCls:"".concat(L,"-paragraph")},Gde(R,D)),rR(p));Q=ut.exports.createElement(Nde,So({},te))}ee=ut.exports.createElement("div",{className:"".concat(L,"-content")},U,Q)}var ie=is(L,(k={},X(k,"".concat(L,"-with-avatar"),R),X(k,"".concat(L,"-active"),v),X(k,"".concat(L,"-rtl"),A==="rtl"),X(k,"".concat(L,"-round"),m),k),i);return ut.exports.createElement("div",{className:ie,style:a},j,ee)}return typeof o!="undefined"?o:null};O2.Button=Ade;O2.Avatar=Ede;O2.Input=Dde;O2.Image=Ode;O2.Node=kde;var Hde=O2,jde={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},Wde=jde,zZ=function(r,t){return ut.exports.createElement(kZ,Et(Et({},r),{},{ref:t,icon:Wde}))};zZ.displayName="PlusOutlined";var Xde=ut.exports.forwardRef(zZ),Yde=function(){if(typeof navigator=="undefined"||typeof window=="undefined")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substr(0,4))};function p7(e){var r=ut.exports.useRef();r.current=e;var t=ut.exports.useCallback(function(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=r.current)===null||n===void 0?void 0:n.call.apply(n,[r].concat(a))},[]);return t}function Zde(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var IF=Zde()?ut.exports.useLayoutEffect:ut.exports.useEffect,qde=function(r,t){var n=ut.exports.useRef(!0);IF(function(){if(!n.current)return r()},t),IF(function(){return n.current=!1,function(){n.current=!0}},[])};function Kde(e){var r=ut.exports.useRef(!1),t=ut.exports.useState(e),n=tn(t,2),i=n[0],a=n[1];ut.exports.useEffect(function(){return r.current=!1,function(){r.current=!0}},[]);function o(s,u){u&&r.current||a(s)}return[i,o]}var qm;(function(e){e[e.INNER=0]="INNER",e[e.PROP=1]="PROP"})(qm||(qm={}));function nR(e){return e!==void 0}function d7(e,r){var t=r||{},n=t.defaultValue,i=t.value,a=t.onChange,o=t.postState,s=Kde(function(){var E=void 0,A;return nR(i)?(E=i,A=qm.PROP):nR(n)?(E=typeof n=="function"?n():n,A=qm.PROP):(E=typeof e=="function"?e():e,A=qm.INNER),[E,A,E]}),u=tn(s,2),l=u[0],f=u[1],h=nR(i)?i:l[0],p=o?o(h):h;qde(function(){f(function(E){var A=tn(E,1),L=A[0];return[i,qm.PROP,L]})},[i]);var v=ut.exports.useRef(),m=p7(function(E,A){f(function(L){var k=tn(L,3),R=k[0],D=k[1],$=k[2],j=typeof E=="function"?E(R):E;if(j===R)return L;var H=D===qm.INNER&&v.current!==$?$:R;return[j,qm.INNER,H]},A)}),x=p7(a);return IF(function(){var E=tn(l,3),A=E[0],L=E[1],k=E[2];A!==k&&L===qm.INNER&&(x(A,k),v.current=k)},[l]),[p,m]}var JL=ut.exports.createContext(null),$Z=ut.exports.forwardRef(function(e,r){var t=e.prefixCls,n=e.className,i=e.style,a=e.id,o=e.active,s=e.tabKey,u=e.children;return ut.exports.createElement("div",{id:a&&"".concat(a,"-panel-").concat(s),role:"tabpanel",tabIndex:o?0:-1,"aria-labelledby":a&&"".concat(a,"-tab-").concat(s),"aria-hidden":!o,style:i,className:is(t,o&&"".concat(t,"-active"),n),ref:r},u)}),Qde=["key","forceRender","style","className"];function Jde(e){var r=e.id,t=e.activeKey,n=e.animated,i=e.tabPosition,a=e.destroyInactiveTabPane,o=ut.exports.useContext(JL),s=o.prefixCls,u=o.tabs,l=n.tabPane,f="".concat(s,"-tabpane");return ut.exports.createElement("div",{className:is("".concat(s,"-content-holder"))},ut.exports.createElement("div",{className:is("".concat(s,"-content"),"".concat(s,"-content-").concat(i),X({},"".concat(s,"-content-animated"),l))},u.map(function(h){var p=h.key,v=h.forceRender,m=h.style,x=h.className,E=oc(h,Qde),A=p===t;return ut.exports.createElement(Qpe,So({key:p,visible:A,forceRender:v,removeOnLeave:!!a,leavedClassName:"".concat(f,"-hidden")},n.tabPaneMotion),function(L,k){var R=L.style,D=L.className;return ut.exports.createElement($Z,So({},E,{prefixCls:f,id:r,tabKey:p,animated:l,active:A,style:Et(Et({},m),R),className:is(x,D),ref:k}))})})))}var UZ=function(r){return+setTimeout(r,16)},VZ=function(r){return clearTimeout(r)};typeof window!="undefined"&&"requestAnimationFrame"in window&&(UZ=function(r){return window.requestAnimationFrame(r)},VZ=function(r){return window.cancelAnimationFrame(r)});var v7=0,w3=new Map;function GZ(e){w3.delete(e)}function zx(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;v7+=1;var t=v7;function n(i){if(i===0)GZ(t),e();else{var a=UZ(function(){n(i-1)});w3.set(t,a)}}return n(r),t}zx.cancel=function(e){var r=w3.get(e);return GZ(r),VZ(r)};function eve(e,r,t){var n=ut.exports.useRef({});return(!("value"in n.current)||t(n.current.condition,r))&&(n.current.value=e(),n.current.condition=r),n.current.value}function tve(e,r){typeof e=="function"?e(r):em(e)==="object"&&e&&"current"in e&&(e.current=r)}function rve(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r.filter(function(i){return i});return n.length<=1?n[0]:function(i){r.forEach(function(a){tve(a,i)})}}function nve(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return eve(function(){return rve.apply(void 0,r)},r,function(n,i){return n.length===i.length&&n.every(function(a,o){return a===i[o]})})}function HZ(e){var r=ut.exports.useRef(),t=ut.exports.useRef(!1);function n(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];t.current||(zx.cancel(r.current),r.current=zx(function(){e.apply(void 0,a)}))}return ut.exports.useEffect(function(){return t.current=!1,function(){t.current=!0,zx.cancel(r.current)}},[]),n}function ive(e){var r=ut.exports.useRef([]),t=ut.exports.useState({}),n=tn(t,2),i=n[1],a=ut.exports.useRef(typeof e=="function"?e():e),o=HZ(function(){var u=a.current;r.current.forEach(function(l){u=l(u)}),r.current=[],a.current=u,i({})});function s(u){r.current.push(u),o()}return[a.current,s]}var gi={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(r){var t=r.keyCode;if(r.altKey&&!r.ctrlKey||r.metaKey||t>=gi.F1&&t<=gi.F12)return!1;switch(t){case gi.ALT:case gi.CAPS_LOCK:case gi.CONTEXT_MENU:case gi.CTRL:case gi.DOWN:case gi.END:case gi.ESC:case gi.HOME:case gi.INSERT:case gi.LEFT:case gi.MAC_FF_META:case gi.META:case gi.NUMLOCK:case gi.NUM_CENTER:case gi.PAGE_DOWN:case gi.PAGE_UP:case gi.PAUSE:case gi.PRINT_SCREEN:case gi.RIGHT:case gi.SHIFT:case gi.UP:case gi.WIN_KEY:case gi.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(r){if(r>=gi.ZERO&&r<=gi.NINE||r>=gi.NUM_ZERO&&r<=gi.NUM_MULTIPLY||r>=gi.A&&r<=gi.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&r===0)return!0;switch(r){case gi.SPACE:case gi.QUESTION_MARK:case gi.NUM_PLUS:case gi.NUM_MINUS:case gi.NUM_PERIOD:case gi.NUM_DIVISION:case gi.SEMICOLON:case gi.DASH:case gi.EQUALS:case gi.COMMA:case gi.PERIOD:case gi.SLASH:case gi.APOSTROPHE:case gi.SINGLE_QUOTE:case gi.OPEN_SQUARE_BRACKET:case gi.BACKSLASH:case gi.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};function ave(e,r){var t,n=e.prefixCls,i=e.id,a=e.active,o=e.tab,s=o.key,u=o.label,l=o.disabled,f=o.closeIcon,h=e.closable,p=e.renderWrapper,v=e.removeAriaLabel,m=e.editable,x=e.onClick,E=e.onRemove,A=e.onFocus,L=e.style,k="".concat(n,"-tab");ut.exports.useEffect(function(){return E},[]);var R=m&&h!==!1&&!l;function D(H){l||x(H)}function $(H){H.preventDefault(),H.stopPropagation(),m.onEdit("remove",{key:s,event:H})}var j=ut.exports.createElement("div",{key:s,ref:r,className:is(k,(t={},X(t,"".concat(k,"-with-remove"),R),X(t,"".concat(k,"-active"),a),X(t,"".concat(k,"-disabled"),l),t)),style:L,onClick:D},ut.exports.createElement("div",{role:"tab","aria-selected":a,id:i&&"".concat(i,"-tab-").concat(s),className:"".concat(k,"-btn"),"aria-controls":i&&"".concat(i,"-panel-").concat(s),"aria-disabled":l,tabIndex:l?null:0,onClick:function(ee){ee.stopPropagation(),D(ee)},onKeyDown:function(ee){[gi.SPACE,gi.ENTER].includes(ee.which)&&(ee.preventDefault(),D(ee))},onFocus:A},u),R&&ut.exports.createElement("button",{type:"button","aria-label":v||"remove",tabIndex:0,className:"".concat(k,"-remove"),onClick:function(ee){ee.stopPropagation(),$(ee)}},f||m.removeIcon||"\xD7"));return p?p(j):j}var ove=ut.exports.forwardRef(ave),g7={width:0,height:0,left:0,top:0};function sve(e,r,t){return ut.exports.useMemo(function(){for(var n,i=new Map,a=r.get((n=e[0])===null||n===void 0?void 0:n.key)||g7,o=a.left+a.width,s=0;s<e.length;s+=1){var u=e[s].key,l=r.get(u);if(!l){var f;l=r.get((f=e[s-1])===null||f===void 0?void 0:f.key)||g7}var h=i.get(u)||Et({},l);h.right=o-h.left-h.width,i.set(u,h)}return i},[e.map(function(n){return n.key}).join("_"),r,t])}var m7={width:0,height:0,left:0,top:0,right:0};function uve(e,r,t,n,i,a,o){var s=o.tabs,u=o.tabPosition,l=o.rtl,f,h,p;return["top","bottom"].includes(u)?(f="width",h=l?"right":"left",p=Math.abs(t)):(f="height",h="top",p=-t),ut.exports.useMemo(function(){if(!s.length)return[0,0];for(var v=s.length,m=v,x=0;x<v;x+=1){var E=e.get(s[x].key)||m7;if(E[h]+E[f]>p+r){m=x-1;break}}for(var A=0,L=v-1;L>=0;L-=1){var k=e.get(s[L].key)||m7;if(k[h]<p){A=L+1;break}}return[A,m]},[e,r,n,i,a,p,u,s.map(function(v){return v.key}).join("_"),l])}var ub={adjustX:1,adjustY:1},lb=[0,0],lve={topLeft:{points:["bl","tl"],overflow:ub,offset:[0,-4],targetOffset:lb},topCenter:{points:["bc","tc"],overflow:ub,offset:[0,-4],targetOffset:lb},topRight:{points:["br","tr"],overflow:ub,offset:[0,-4],targetOffset:lb},bottomLeft:{points:["tl","bl"],overflow:ub,offset:[0,4],targetOffset:lb},bottomCenter:{points:["tc","bc"],overflow:ub,offset:[0,4],targetOffset:lb},bottomRight:{points:["tr","br"],overflow:ub,offset:[0,4],targetOffset:lb}},cve=function(e){if(!e)return!1;if(e instanceof HTMLElement&&e.offsetParent)return!0;if(e instanceof SVGGraphicsElement&&e.getBBox){var r=e.getBBox(),t=r.width,n=r.height;if(t||n)return!0}if(e instanceof HTMLElement&&e.getBoundingClientRect){var i=e.getBoundingClientRect(),a=i.width,o=i.height;if(a||o)return!0}return!1};function y7(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(cve(e)){var t=e.nodeName.toLowerCase(),n=["input","select","textarea","button"].includes(t)||e.isContentEditable||t==="a"&&!!e.getAttribute("href"),i=e.getAttribute("tabindex"),a=Number(i),o=null;return i&&!Number.isNaN(a)?o=a:n&&o===null&&(o=0),n&&e.disabled&&(o=null),o!==null&&(o>=0||r&&o<0)}return!1}function fve(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=Pr(e.querySelectorAll("*")).filter(function(n){return y7(n,r)});return y7(e,r)&&t.unshift(e),t}var hve=gi.ESC,pve=gi.TAB;function dve(e){var r=e.visible,t=e.setTriggerVisible,n=e.triggerRef,i=e.onVisibleChange,a=e.autoFocus,o=ut.exports.useRef(!1),s=function(){if(r&&n.current){var h,p,v,m;(h=n.current)===null||h===void 0||(p=h.triggerRef)===null||p===void 0||(v=p.current)===null||v===void 0||(m=v.focus)===null||m===void 0||m.call(v),t(!1),typeof i=="function"&&i(!1)}},u=function(){var h,p,v,m,x=fve((h=n.current)===null||h===void 0||(p=h.popupRef)===null||p===void 0||(v=p.current)===null||v===void 0||(m=v.getElement)===null||m===void 0?void 0:m.call(v)),E=x[0];return E!=null&&E.focus?(E.focus(),o.current=!0,!0):!1},l=function(h){switch(h.keyCode){case hve:s();break;case pve:{var p=!1;o.current||(p=u()),p?h.preventDefault():s();break}}};ut.exports.useEffect(function(){return r?(window.addEventListener("keydown",l),a&&zx(u,3),function(){window.removeEventListener("keydown",l),o.current=!1}):function(){o.current=!1}},[r])}var vve=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus"];function gve(e,r){var t=e.arrow,n=t===void 0?!1:t,i=e.prefixCls,a=i===void 0?"rc-dropdown":i,o=e.transitionName,s=e.animation,u=e.align,l=e.placement,f=l===void 0?"bottomLeft":l,h=e.placements,p=h===void 0?lve:h,v=e.getPopupContainer,m=e.showAction,x=e.hideAction,E=e.overlayClassName,A=e.overlayStyle,L=e.visible,k=e.trigger,R=k===void 0?["hover"]:k,D=e.autoFocus,$=oc(e,vve),j=ut.exports.useState(),H=tn(j,2),ee=H[0],U=H[1],W="visible"in e?L:ee,Q=ut.exports.useRef(null);ut.exports.useImperativeHandle(r,function(){return Q.current}),dve({visible:W,setTriggerVisible:U,triggerRef:Q,onVisibleChange:e.onVisibleChange,autoFocus:D});var te=function(){var Tt=e.overlay,It;return typeof Tt=="function"?It=Tt():It=Tt,It},ie=function(Tt){var It=e.onOverlayClick;U(!1),It&&It(Tt)},ve=function(Tt){var It=e.onVisibleChange;U(Tt),typeof It=="function"&&It(Tt)},me=function(){var Tt=te();return ut.exports.createElement(ut.exports.Fragment,null,n&&ut.exports.createElement("div",{className:"".concat(a,"-arrow")}),Tt)},Re=function(){var Tt=e.overlay;return typeof Tt=="function"?me:me()},We=function(){var Tt=e.minOverlayWidthMatchTrigger,It=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?Tt:!It},je=function(){var Tt=e.openClassName;return Tt!==void 0?Tt:"".concat(a,"-open")},lt=function(){var Tt=e.children,It=Tt.props?Tt.props:{},Lt=is(It.className,je());return W&&Tt?ut.exports.cloneElement(Tt,{className:Lt}):Tt},dt=x;return!dt&&R.indexOf("contextMenu")!==-1&&(dt=["click"]),ut.exports.createElement(Jpe,Et(Et({builtinPlacements:p},$),{},{prefixCls:a,ref:Q,popupClassName:is(E,X({},"".concat(a,"-show-arrow"),n)),popupStyle:A,action:R,showAction:m,hideAction:dt||[],popupPlacement:f,popupAlign:u,popupTransitionName:o,popupAnimation:s,popupVisible:W,stretch:We()?"minWidth":"",popup:Re(),onPopupVisibleChange:ve,onPopupClick:ie,getPopupContainer:v}),lt())}var mve=ut.exports.forwardRef(gve);function yve(e,r){var t=e.prefixCls,n=e.editable,i=e.locale,a=e.style;return!n||n.showAdd===!1?null:ut.exports.createElement("button",{ref:r,type:"button",className:"".concat(t,"-nav-add"),style:a,"aria-label":(i==null?void 0:i.addAriaLabel)||"Add tab",onClick:function(s){n.onEdit("add",{event:s})}},n.addIcon||"+")}var jZ=ut.exports.forwardRef(yve);function _ve(e,r){var t=e.prefixCls,n=e.id,i=e.tabs,a=e.locale,o=e.mobile,s=e.moreIcon,u=s===void 0?"More":s,l=e.moreTransitionName,f=e.style,h=e.className,p=e.editable,v=e.tabBarGutter,m=e.rtl,x=e.removeAriaLabel,E=e.onTabClick,A=e.getPopupContainer,L=e.popupClassName,k=ut.exports.useState(!1),R=tn(k,2),D=R[0],$=R[1],j=ut.exports.useState(null),H=tn(j,2),ee=H[0],U=H[1],W="".concat(n,"-more-popup"),Q="".concat(t,"-dropdown"),te=ee!==null?"".concat(W,"-").concat(ee):null,ie=a==null?void 0:a.dropdownAriaLabel;function ve(ct,Tt){ct.preventDefault(),ct.stopPropagation(),p.onEdit("remove",{key:Tt,event:ct})}var me=ut.exports.createElement(ede,{onClick:function(Tt){var It=Tt.key,Lt=Tt.domEvent;E(It,Lt),$(!1)},prefixCls:"".concat(Q,"-menu"),id:W,tabIndex:-1,role:"listbox","aria-activedescendant":te,selectedKeys:[ee],"aria-label":ie!==void 0?ie:"expanded dropdown"},i.map(function(ct){var Tt=p&&ct.closable!==!1&&!ct.disabled;return ut.exports.createElement(tde,{key:ct.key,id:"".concat(W,"-").concat(ct.key),role:"option","aria-controls":n&&"".concat(n,"-panel-").concat(ct.key),disabled:ct.disabled},ut.exports.createElement("span",null,ct.label),Tt&&ut.exports.createElement("button",{type:"button","aria-label":x||"remove",tabIndex:0,className:"".concat(Q,"-menu-item-remove"),onClick:function(Lt){Lt.stopPropagation(),ve(Lt,ct.key)}},ct.closeIcon||p.removeIcon||"\xD7"))}));function Re(ct){for(var Tt=i.filter(function(zn){return!zn.disabled}),It=Tt.findIndex(function(zn){return zn.key===ee})||0,Lt=Tt.length,rn=0;rn<Lt;rn+=1){It=(It+ct+Lt)%Lt;var wn=Tt[It];if(!wn.disabled){U(wn.key);return}}}function We(ct){var Tt=ct.which;if(!D){[gi.DOWN,gi.SPACE,gi.ENTER].includes(Tt)&&($(!0),ct.preventDefault());return}switch(Tt){case gi.UP:Re(-1),ct.preventDefault();break;case gi.DOWN:Re(1),ct.preventDefault();break;case gi.ESC:$(!1);break;case gi.SPACE:case gi.ENTER:ee!==null&&E(ee,ct);break}}ut.exports.useEffect(function(){var ct=document.getElementById(te);ct&&ct.scrollIntoView&&ct.scrollIntoView(!1)},[ee]),ut.exports.useEffect(function(){D||U(null)},[D]);var je=X({},m?"marginRight":"marginLeft",v);i.length||(je.visibility="hidden",je.order=1);var lt=is(X({},"".concat(Q,"-rtl"),m)),dt=o?null:ut.exports.createElement(mve,{prefixCls:Q,overlay:me,trigger:["hover"],visible:i.length?D:!1,transitionName:l,onVisibleChange:$,overlayClassName:is(lt,L),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:A},ut.exports.createElement("button",{type:"button",className:"".concat(t,"-nav-more"),style:je,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":W,id:"".concat(n,"-more"),"aria-expanded":D,onKeyDown:We},u));return ut.exports.createElement("div",{className:is("".concat(t,"-nav-operations"),h),style:f,ref:r},dt,ut.exports.createElement(jZ,{prefixCls:t,locale:a,editable:p}))}var xve=ut.exports.memo(ut.exports.forwardRef(_ve),function(e,r){return r.tabMoving}),bve=.1,_7=.01,YT=20,x7=Math.pow(.995,YT);function wve(e,r){var t=ut.exports.useState(),n=tn(t,2),i=n[0],a=n[1],o=ut.exports.useState(0),s=tn(o,2),u=s[0],l=s[1],f=ut.exports.useState(0),h=tn(f,2),p=h[0],v=h[1],m=ut.exports.useState(),x=tn(m,2),E=x[0],A=x[1],L=ut.exports.useRef();function k(ee){var U=ee.touches[0],W=U.screenX,Q=U.screenY;a({x:W,y:Q}),window.clearInterval(L.current)}function R(ee){if(!!i){ee.preventDefault();var U=ee.touches[0],W=U.screenX,Q=U.screenY;a({x:W,y:Q});var te=W-i.x,ie=Q-i.y;r(te,ie);var ve=Date.now();l(ve),v(ve-u),A({x:te,y:ie})}}function D(){if(!!i&&(a(null),A(null),E)){var ee=E.x/p,U=E.y/p,W=Math.abs(ee),Q=Math.abs(U);if(Math.max(W,Q)<bve)return;var te=ee,ie=U;L.current=window.setInterval(function(){if(Math.abs(te)<_7&&Math.abs(ie)<_7){window.clearInterval(L.current);return}te*=x7,ie*=x7,r(te*YT,ie*YT)},YT)}}var $=ut.exports.useRef();function j(ee){var U=ee.deltaX,W=ee.deltaY,Q=0,te=Math.abs(U),ie=Math.abs(W);te===ie?Q=$.current==="x"?U:W:te>ie?(Q=U,$.current="x"):(Q=W,$.current="y"),r(-Q,-Q)&&ee.preventDefault()}var H=ut.exports.useRef(null);H.current={onTouchStart:k,onTouchMove:R,onTouchEnd:D,onWheel:j},ut.exports.useEffect(function(){function ee(te){H.current.onTouchStart(te)}function U(te){H.current.onTouchMove(te)}function W(te){H.current.onTouchEnd(te)}function Q(te){H.current.onWheel(te)}return document.addEventListener("touchmove",U,{passive:!1}),document.addEventListener("touchend",W,{passive:!1}),e.current.addEventListener("touchstart",ee,{passive:!1}),e.current.addEventListener("wheel",Q),function(){document.removeEventListener("touchmove",U),document.removeEventListener("touchend",W)}},[])}function Cve(){var e=ut.exports.useRef(new Map);function r(n){return e.current.has(n)||e.current.set(n,ut.exports.createRef()),e.current.get(n)}function t(n){e.current.delete(n)}return[r,t]}function b7(e,r){var t=ut.exports.useRef(e),n=ut.exports.useState({}),i=tn(n,2),a=i[1];function o(s){var u=typeof s=="function"?s(t.current):s;u!==t.current&&r(u,t.current),t.current=u,a({})}return[t.current,o]}function w7(e){var r;return e instanceof Map?(r={},e.forEach(function(t,n){r[n]=t})):r=e,JSON.stringify(r)}var C7=ut.exports.forwardRef(function(e,r){var t=e.position,n=e.prefixCls,i=e.extra;if(!i)return null;var a,o={};return em(i)==="object"&&!ut.exports.isValidElement(i)?o=i:o.right=i,t==="right"&&(a=o.right),t==="left"&&(a=o.left),a?ut.exports.createElement("div",{className:"".concat(n,"-extra-content"),ref:r},a):null}),cb=function(r){var t=r.current||{},n=t.offsetWidth,i=n===void 0?0:n,a=t.offsetHeight,o=a===void 0?0:a;return[i,o]},EA=function(r,t){return r[t?0:1]};function Eve(e,r){var t,n=ut.exports.useContext(JL),i=n.prefixCls,a=n.tabs,o=e.className,s=e.style,u=e.id,l=e.animated,f=e.activeKey,h=e.rtl,p=e.extra,v=e.editable,m=e.locale,x=e.tabPosition,E=e.tabBarGutter,A=e.children,L=e.onTabClick,k=e.onTabScroll,R=ut.exports.useRef(),D=ut.exports.useRef(),$=ut.exports.useRef(),j=ut.exports.useRef(),H=ut.exports.useRef(),ee=ut.exports.useRef(),U=ut.exports.useRef(),W=Cve(),Q=tn(W,2),te=Q[0],ie=Q[1],ve=x==="top"||x==="bottom",me=b7(0,function(Ln,Tr){ve&&k&&k({direction:Ln>Tr?"left":"right"})}),Re=tn(me,2),We=Re[0],je=Re[1],lt=b7(0,function(Ln,Tr){!ve&&k&&k({direction:Ln>Tr?"top":"bottom"})}),dt=tn(lt,2),ct=dt[0],Tt=dt[1],It=ut.exports.useState([0,0]),Lt=tn(It,2),rn=Lt[0],wn=Lt[1],zn=ut.exports.useState([0,0]),Zt=tn(zn,2),nn=Zt[0],mn=Zt[1],zt=ut.exports.useState([0,0]),Vr=tn(zt,2),On=Vr[0],Si=Vr[1],Fn=ut.exports.useState([0,0]),Ai=tn(Fn,2),Ua=Ai[0],va=Ai[1],Va=ive(new Map),to=tn(Va,2),Os=to[0],Ro=to[1],ne=sve(a,Os,nn[0]),Qt=EA(rn,ve),gr=EA(nn,ve),hn=EA(On,ve),$n=EA(Ua,ve),Ta=Qt<gr+hn,Qn=Ta?Qt-$n:Qt-hn,ci="".concat(i,"-nav-operations-hidden"),Wn=0,Ti=0;ve&&h?(Wn=0,Ti=Math.max(0,gr-Qn)):(Wn=Math.min(0,Qn-gr),Ti=0);function Li(Ln){return Ln<Wn?Wn:Ln>Ti?Ti:Ln}var Oo=ut.exports.useRef(),Fo=ut.exports.useState(),xl=tn(Fo,2),Fc=xl[0],gf=xl[1];function Gl(){gf(Date.now())}function iu(){window.clearTimeout(Oo.current)}wve(j,function(Ln,Tr){function Sn(pi,oi){pi(function(Pi){var Oi=Li(Pi+oi);return Oi})}return Qt>=gr?!1:(ve?Sn(je,Ln):Sn(Tt,Tr),iu(),Gl(),!0)}),ut.exports.useEffect(function(){return iu(),Fc&&(Oo.current=window.setTimeout(function(){gf(0)},100)),iu},[Fc]);var bl=uve(ne,Qn,ve?We:ct,gr,hn,$n,Et(Et({},e),{},{tabs:a})),Dc=tn(bl,2),mf=Dc[0],fo=Dc[1],ae=function(){var Tr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,Sn=ne.get(Tr)||{width:0,height:0,left:0,right:0,top:0};if(ve){var pi=We;h?Sn.right<We?pi=Sn.right:Sn.right+Sn.width>We+Qn&&(pi=Sn.right+Sn.width-Qn):Sn.left<-We?pi=-Sn.left:Sn.left+Sn.width>-We+Qn&&(pi=-(Sn.left+Sn.width-Qn)),Tt(0),je(Li(pi))}else{var oi=ct;Sn.top<-ct?oi=-Sn.top:Sn.top+Sn.height>-ct+Qn&&(oi=-(Sn.top+Sn.height-Qn)),je(0),Tt(Li(oi))}},ue={};x==="top"||x==="bottom"?ue[h?"marginRight":"marginLeft"]=E:ue.marginTop=E;var fe=a.map(function(Ln,Tr){var Sn=Ln.key;return ut.exports.createElement(ove,{id:u,prefixCls:i,key:Sn,tab:Ln,style:Tr===0?void 0:ue,closable:Ln.closable,editable:v,active:Sn===f,renderWrapper:A,removeAriaLabel:m==null?void 0:m.removeAriaLabel,ref:te(Sn),onClick:function(oi){L(Sn,oi)},onRemove:function(){ie(Sn)},onFocus:function(){ae(Sn),Gl(),j.current&&(h||(j.current.scrollLeft=0),j.current.scrollTop=0)}})}),Ce=HZ(function(){var Ln=cb(R),Tr=cb(D),Sn=cb($);wn([Ln[0]-Tr[0]-Sn[0],Ln[1]-Tr[1]-Sn[1]]);var pi=cb(U);Si(pi);var oi=cb(ee);va(oi);var Pi=cb(H);mn([Pi[0]-pi[0],Pi[1]-pi[1]]),Ro(function(){var Oi=new Map;return a.forEach(function(Gs){var Qi=Gs.key,Ki=te(Qi).current;Ki&&Oi.set(Qi,{width:Ki.offsetWidth,height:Ki.offsetHeight,left:Ki.offsetLeft,top:Ki.offsetTop})}),Oi})}),Ne=a.slice(0,mf),it=a.slice(fo+1),pt=[].concat(Pr(Ne),Pr(it)),_e=ut.exports.useState(),Ge=tn(_e,2),wt=Ge[0],cr=Ge[1],fr=ne.get(f),$t=ut.exports.useRef();function pr(){zx.cancel($t.current)}ut.exports.useEffect(function(){var Ln={};return fr&&(ve?(h?Ln.right=fr.right:Ln.left=fr.left,Ln.width=fr.width):(Ln.top=fr.top,Ln.height=fr.height)),pr(),$t.current=zx(function(){cr(Ln)}),pr},[fr,ve,h]),ut.exports.useEffect(function(){ae()},[f,w7(fr),w7(ne),ve]),ut.exports.useEffect(function(){Ce()},[h]);var Rr=!!pt.length,cn="".concat(i,"-nav-wrap"),Ht,an,Br,$r;return ve?h?(an=We>0,Ht=We+Qt<gr):(Ht=We<0,an=-We+Qt<gr):(Br=ct<0,$r=-ct+Qt<gr),ut.exports.createElement(h7,{onResize:Ce},ut.exports.createElement("div",{ref:nve(r,R),role:"tablist",className:is("".concat(i,"-nav"),o),style:s,onKeyDown:function(){Gl()}},ut.exports.createElement(C7,{ref:D,position:"left",extra:p,prefixCls:i}),ut.exports.createElement("div",{className:is(cn,(t={},X(t,"".concat(cn,"-ping-left"),Ht),X(t,"".concat(cn,"-ping-right"),an),X(t,"".concat(cn,"-ping-top"),Br),X(t,"".concat(cn,"-ping-bottom"),$r),t)),ref:j},ut.exports.createElement(h7,{onResize:Ce},ut.exports.createElement("div",{ref:H,className:"".concat(i,"-nav-list"),style:{transform:"translate(".concat(We,"px, ").concat(ct,"px)"),transition:Fc?"none":void 0}},fe,ut.exports.createElement(jZ,{ref:U,prefixCls:i,locale:m,editable:v,style:Et(Et({},fe.length===0?void 0:ue),{},{visibility:Rr?"hidden":null})}),ut.exports.createElement("div",{className:is("".concat(i,"-ink-bar"),X({},"".concat(i,"-ink-bar-animated"),l.inkBar)),style:wt})))),ut.exports.createElement(xve,So({},e,{removeAriaLabel:m==null?void 0:m.removeAriaLabel,ref:ee,prefixCls:i,tabs:pt,className:!Rr&&ci,tabMoving:!!Fc})),ut.exports.createElement(C7,{ref:$,position:"right",extra:p,prefixCls:i})))}var E7=ut.exports.forwardRef(Eve),Sve=["renderTabBar"],Ave=["label","key"];function Tve(e){var r=e.renderTabBar,t=oc(e,Sve),n=ut.exports.useContext(JL),i=n.tabs;if(r){var a=Et(Et({},t),{},{panes:i.map(function(o){var s=o.label,u=o.key,l=oc(o,Ave);return Is.createElement($Z,So({tab:s,key:u,tabKey:u},l))})});return r(a,E7)}return Is.createElement(E7,t)}function Mve(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{inkBar:!0,tabPane:!1},r;return e===!1?r={inkBar:!1,tabPane:!1}:e===!0?r={inkBar:!0,tabPane:!1}:r=Et({inkBar:!0},em(e)==="object"?e:{}),r.tabPaneMotion&&r.tabPane===void 0&&(r.tabPane=!0),!r.tabPaneMotion&&r.tabPane&&(r.tabPane=!1),r}var Lve=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","moreIcon","moreTransitionName","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName"],S7=0;function Ive(e,r){var t,n=e.id,i=e.prefixCls,a=i===void 0?"rc-tabs":i,o=e.className,s=e.items,u=e.direction,l=e.activeKey,f=e.defaultActiveKey,h=e.editable,p=e.animated,v=e.tabPosition,m=v===void 0?"top":v,x=e.tabBarGutter,E=e.tabBarStyle,A=e.tabBarExtraContent,L=e.locale,k=e.moreIcon,R=e.moreTransitionName,D=e.destroyInactiveTabPane,$=e.renderTabBar,j=e.onChange,H=e.onTabClick,ee=e.onTabScroll,U=e.getPopupContainer,W=e.popupClassName,Q=oc(e,Lve),te=ut.exports.useMemo(function(){return(s||[]).filter(function(Fn){return Fn&&em(Fn)==="object"&&"key"in Fn})},[s]),ie=u==="rtl",ve=Mve(p),me=ut.exports.useState(!1),Re=tn(me,2),We=Re[0],je=Re[1];ut.exports.useEffect(function(){je(Yde())},[]);var lt=d7(function(){var Fn;return(Fn=te[0])===null||Fn===void 0?void 0:Fn.key},{value:l,defaultValue:f}),dt=tn(lt,2),ct=dt[0],Tt=dt[1],It=ut.exports.useState(function(){return te.findIndex(function(Fn){return Fn.key===ct})}),Lt=tn(It,2),rn=Lt[0],wn=Lt[1];ut.exports.useEffect(function(){var Fn=te.findIndex(function(Ua){return Ua.key===ct});if(Fn===-1){var Ai;Fn=Math.max(0,Math.min(rn,te.length-1)),Tt((Ai=te[Fn])===null||Ai===void 0?void 0:Ai.key)}wn(Fn)},[te.map(function(Fn){return Fn.key}).join("_"),ct,rn]);var zn=d7(null,{value:n}),Zt=tn(zn,2),nn=Zt[0],mn=Zt[1];ut.exports.useEffect(function(){n||(mn("rc-tabs-".concat(S7)),S7+=1)},[]);function zt(Fn,Ai){H==null||H(Fn,Ai);var Ua=Fn!==ct;Tt(Fn),Ua&&(j==null||j(Fn))}var Vr={id:nn,activeKey:ct,animated:ve,tabPosition:m,rtl:ie,mobile:We},On,Si=Et(Et({},Vr),{},{editable:h,locale:L,moreIcon:k,moreTransitionName:R,tabBarGutter:x,onTabClick:zt,onTabScroll:ee,extra:A,style:E,panes:null,getPopupContainer:U,popupClassName:W});return ut.exports.createElement(JL.Provider,{value:{tabs:te,prefixCls:a}},ut.exports.createElement("div",So({ref:r,id:n,className:is(a,"".concat(a,"-").concat(m),(t={},X(t,"".concat(a,"-mobile"),We),X(t,"".concat(a,"-editable"),h),X(t,"".concat(a,"-rtl"),ie),t),o)},Q),On,ut.exports.createElement(Tve,So({},Si,{renderTabBar:$})),ut.exports.createElement(Jde,So({destroyInactiveTabPane:D},Vr,{animated:ve}))))}var kve=ut.exports.forwardRef(Ive),Pve={motionAppear:!1,motionEnter:!0,motionLeave:!0};function Rve(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{inkBar:!0,tabPane:!1},t;return r===!1?t={inkBar:!1,tabPane:!1}:r===!0?t={inkBar:!0,tabPane:!0}:t=So({inkBar:!0},em(r)==="object"?r:{}),t.tabPane&&(t.tabPaneMotion=So(So({},Pve),{motionName:rde(e,"switch")})),t}var Ove=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};function Fve(e){return e.filter(function(r){return r})}function Dve(e,r){if(e)return e;var t=nde(r).map(function(n){if(ut.exports.isValidElement(n)){var i=n.key,a=n.props,o=a||{},s=o.tab,u=Ove(o,["tab"]),l=So(So({key:String(i)},u),{label:s});return l}return null});return Fve(t)}var Bve=function(){return null},Nve=Bve,zve=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};function WZ(e){var r=e.type,t=e.className,n=e.size,i=e.onEdit,a=e.hideAdd,o=e.centered,s=e.addIcon,u=e.children,l=e.items,f=e.animated,h=zve(e,["type","className","size","onEdit","hideAdd","centered","addIcon","children","items","animated"]),p=h.prefixCls,v=h.moreIcon,m=v===void 0?ut.exports.createElement(ide,null):v,x=ut.exports.useContext(d_),E=x.getPrefixCls,A=x.direction,L=E("tabs",p),k;r==="editable-card"&&(k={onEdit:function(H,ee){var U=ee.key,W=ee.event;i==null||i(H==="add"?W:U,H)},removeIcon:ut.exports.createElement(ade,null),addIcon:s||ut.exports.createElement(Xde,null),showAdd:a!==!0});var R=E(),D=Dve(l,u),$=Rve(L,f);return ut.exports.createElement(PZ.Consumer,null,function(j){var H,ee=n!==void 0?n:j;return ut.exports.createElement(kve,So({direction:A,moreTransitionName:"".concat(R,"-slide-up")},h,{items:D,className:is((H={},X(H,"".concat(L,"-").concat(ee),ee),X(H,"".concat(L,"-card"),["card","editable-card"].includes(r)),X(H,"".concat(L,"-editable-card"),r==="editable-card"),X(H,"".concat(L,"-centered"),o),H),t),editable:k,moreIcon:m,prefixCls:L,animated:$}))})}WZ.TabPane=Nve;var $ve=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},Uve=function(r){var t=r.prefixCls,n=r.className,i=r.hoverable,a=i===void 0?!0:i,o=$ve(r,["prefixCls","className","hoverable"]);return ut.exports.createElement(RZ,null,function(s){var u=s.getPrefixCls,l=u("card",t),f=is("".concat(l,"-grid"),n,X({},"".concat(l,"-grid-hoverable"),a));return ut.exports.createElement("div",So({},o,{className:f}))})},XZ=Uve,Vve=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};function Gve(e){var r=e.map(function(t,n){return ut.exports.createElement("li",{style:{width:"".concat(100/e.length,"%")},key:"action-".concat(n)},ut.exports.createElement("span",null,t))});return r}var Hve=ut.exports.forwardRef(function(e,r){var t,n,i=ut.exports.useContext(d_),a=i.getPrefixCls,o=i.direction,s=ut.exports.useContext(PZ),u=function(mn){var zt;(zt=e.onTabChange)===null||zt===void 0||zt.call(e,mn)},l=function(){var mn;return ut.exports.Children.forEach(e.children,function(zt){zt&&zt.type&&zt.type===XZ&&(mn=!0)}),mn},f=e.prefixCls,h=e.className,p=e.extra,v=e.headStyle,m=v===void 0?{}:v,x=e.bodyStyle,E=x===void 0?{}:x,A=e.title,L=e.loading,k=e.bordered,R=k===void 0?!0:k,D=e.size,$=e.type,j=e.cover,H=e.actions,ee=e.tabList,U=e.children,W=e.activeTabKey,Q=e.defaultActiveTabKey,te=e.tabBarExtraContent,ie=e.hoverable,ve=e.tabProps,me=ve===void 0?{}:ve,Re=Vve(e,["prefixCls","className","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps"]),We=a("card",f),je=ut.exports.createElement(Hde,{loading:!0,active:!0,paragraph:{rows:4},title:!1},U),lt=W!==void 0,dt=So(So({},me),(t={},X(t,lt?"activeKey":"defaultActiveKey",lt?W:Q),X(t,"tabBarExtraContent",te),t)),ct,Tt=ee&&ee.length?ut.exports.createElement(WZ,So({size:"large"},dt,{className:"".concat(We,"-head-tabs"),onChange:u,items:ee.map(function(nn){var mn;return{label:nn.tab,key:nn.key,disabled:(mn=nn.disabled)!==null&&mn!==void 0?mn:!1}})})):null;(A||p||Tt)&&(ct=ut.exports.createElement("div",{className:"".concat(We,"-head"),style:m},ut.exports.createElement("div",{className:"".concat(We,"-head-wrapper")},A&&ut.exports.createElement("div",{className:"".concat(We,"-head-title")},A),p&&ut.exports.createElement("div",{className:"".concat(We,"-extra")},p)),Tt));var It=j?ut.exports.createElement("div",{className:"".concat(We,"-cover")},j):null,Lt=ut.exports.createElement("div",{className:"".concat(We,"-body"),style:E},L?je:U),rn=H&&H.length?ut.exports.createElement("ul",{className:"".concat(We,"-actions")},Gve(H)):null,wn=ZL(Re,["onTabChange"]),zn=D||s,Zt=is(We,(n={},X(n,"".concat(We,"-loading"),L),X(n,"".concat(We,"-bordered"),R),X(n,"".concat(We,"-hoverable"),ie),X(n,"".concat(We,"-contain-grid"),l()),X(n,"".concat(We,"-contain-tabs"),ee&&ee.length),X(n,"".concat(We,"-").concat(zn),zn),X(n,"".concat(We,"-type-").concat($),!!$),X(n,"".concat(We,"-rtl"),o==="rtl"),n),h);return ut.exports.createElement("div",So({ref:r},wn,{className:Zt}),ct,It,Lt,rn)}),jve=Hve,Wve=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},Xve=function(r){return ut.exports.createElement(RZ,null,function(t){var n=t.getPrefixCls,i=r.prefixCls,a=r.className,o=r.avatar,s=r.title,u=r.description,l=Wve(r,["prefixCls","className","avatar","title","description"]),f=n("card",i),h=is("".concat(f,"-meta"),a),p=o?ut.exports.createElement("div",{className:"".concat(f,"-meta-avatar")},o):null,v=s?ut.exports.createElement("div",{className:"".concat(f,"-meta-title")},s):null,m=u?ut.exports.createElement("div",{className:"".concat(f,"-meta-description")},u):null,x=v||m?ut.exports.createElement("div",{className:"".concat(f,"-meta-detail")},v,m):null;return ut.exports.createElement("div",So({},l,{className:h}),p,x)})},Yve=Xve,C3=jve;C3.Grid=XZ;C3.Meta=Yve;var kw=C3,kF=function(e,r){return kF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},kF(e,r)};function Rn(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");kF(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Xe=function(){return Xe=Object.assign||function(r){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},Xe.apply(this,arguments)};function tp(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t}function tE(e,r,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(h){o(h)}}function u(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(e,r||[])).next())})}function rE(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=r.call(e,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function so(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function jn(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return a}function vu(e,r,t){if(t||arguments.length===2)for(var n=0,i=r.length,a;n<i;n++)(a||!(n in r))&&(a||(a=Array.prototype.slice.call(r,0,n)),a[n]=r[n]);return e.concat(a||Array.prototype.slice.call(r))}var hp=function(e){return e!==null&&typeof e!="function"&&isFinite(e.length)},Ug=function(e,r){return hp(e)?e.indexOf(r)>-1:!1},kc=function(e,r){if(!hp(e))return e;for(var t=[],n=0;n<e.length;n++){var i=e[n];r(i,n)&&t.push(i)}return t},YZ=function(e,r){return r===void 0&&(r=[]),kc(e,function(t){return!Ug(r,t)})},Zve={}.toString,Zd=function(e,r){return Zve.call(e)==="[object "+r+"]"},kn=function(e){return Zd(e,"Function")},rr=function(e){return e==null},ar=function(e){return Array.isArray?Array.isArray(e):Zd(e,"Array")},xo=function(e){var r=typeof e;return e!==null&&r==="object"||r==="function"};function we(e,r){if(!!e){var t;if(ar(e))for(var n=0,i=e.length;n<i&&(t=r(e[n],n),t!==!1);n++);else if(xo(e)){for(var a in e)if(e.hasOwnProperty(a)&&(t=r(e[a],a),t===!1))break}}}var p1=Object.keys?function(e){return Object.keys(e)}:function(e){var r=[];return we(e,function(t,n){kn(e)&&n==="prototype"||r.push(n)}),r};function E3(e,r){var t=p1(r),n=t.length;if(rr(e))return!n;for(var i=0;i<n;i+=1){var a=t[i];if(r[a]!==e[a]||!(a in e))return!1}return!0}var MM=function(e){return typeof e=="object"&&e!==null},Wv=function(e){if(!MM(e)||!Zd(e,"Object"))return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var r=e;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r};function $d(e,r){if(!ar(e))return null;var t;if(kn(r)&&(t=r),Wv(r)&&(t=function(i){return E3(i,r)}),t){for(var n=0;n<e.length;n+=1)if(t(e[n]))return e[n]}return null}function S3(e,r,t){t===void 0&&(t=0);for(var n=t;n<e.length;n++)if(r(e[n],n))return n;return-1}var ZZ=function(e,r){for(var t=null,n=0;n<e.length;n++){var i=e[n],a=i[r];if(!rr(a)){ar(a)?t=a[0]:t=a;break}}return t},pp=function(e){if(!ar(e))return[];for(var r=[],t=0;t<e.length;t++)r=r.concat(e[t]);return r},qZ=function(e,r){if(r===void 0&&(r=[]),!ar(e))r.push(e);else for(var t=0;t<e.length;t+=1)qZ(e[t],r);return r},Ff=function(e){if(!!ar(e))return e.reduce(function(r,t){return Math.max(r,t)},e[0])},oh=function(e){if(!!ar(e))return e.reduce(function(r,t){return Math.min(r,t)},e[0])},A3=function(e){var r=e.filter(function(o){return!isNaN(o)});if(!r.length)return{min:0,max:0};if(ar(e[0])){for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);r=t}var i=Ff(r),a=oh(r);return{min:a,max:i}},KZ=Array.prototype,qve=KZ.splice,Kve=KZ.indexOf,Qve=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=0;n<r.length;n++)for(var i=r[n],a=-1;(a=Kve.call(e,i))>-1;)qve.call(e,a,1);return e},Jve=Array.prototype.splice,QZ=function(r,t){if(!hp(r))return[];for(var n=r?t.length:0,i=n-1;n--;){var a=void 0,o=t[n];(n===i||o!==a)&&(a=o,Jve.call(r,o,1))}return r},cf=function(e,r,t){if(!ar(e)&&!Wv(e))return e;var n=t;return we(e,function(i,a){n=r(n,i,a)}),n},JZ=function(e,r){var t=[];if(!hp(e))return t;for(var n=-1,i=[],a=e.length;++n<a;){var o=e[n];r(o,n,e)&&(t.push(o),i.push(n))}return QZ(e,i),t},ei=function(e){return Zd(e,"String")};function eq(e,r){var t;if(kn(r))t=function(i,a){return r(i)-r(a)};else{var n=[];ei(r)?n.push(r):ar(r)&&(n=r),t=function(i,a){for(var o=0;o<n.length;o+=1){var s=n[o];if(i[s]>a[s])return 1;if(i[s]<a[s])return-1}return 0}}return e.sort(t),e}function Z0(e,r){r===void 0&&(r=new Map);var t=[];if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var a=e[n];r.has(a)||(t.push(a),r.set(a,!0))}return t}var ege=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Z0([].concat.apply([],e))},Gd=function(e,r){for(var t=[],n={},i=0;i<e.length;i++){var a=e[i],o=a[r];if(!rr(o)){ar(o)||(o=[o]);for(var s=0;s<o.length;s++){var u=o[s];n[u]||(t.push(u),n[u]=!0)}}}return t};function up(e){if(hp(e))return e[0]}function al(e){if(hp(e)){var r=e;return r[r.length-1]}}function tge(e,r){return ar(e)||ei(e)?e[0]===r:!1}function rge(e,r){return ar(e)||ei(e)?e[e.length-1]===r:!1}var eI=function(e,r){for(var t=0;t<e.length;t++)if(!r(e[t],t))return!1;return!0},uS=function(e,r){for(var t=0;t<e.length;t++)if(r(e[t],t))return!0;return!1},nge=Object.prototype.hasOwnProperty;function lp(e,r){if(!r||!ar(e))return{};for(var t={},n=kn(r)?r:function(s){return s[r]},i,a=0;a<e.length;a++){var o=e[a];i=n(o),nge.call(t,i)?t[i].push(o):t[i]=[o]}return t}function T3(e,r){if(!r)return{0:e};if(!kn(r)){var t=ar(r)?r:r.replace(/\s+/g,"").split("*");r=function(n){for(var i="_",a=0,o=t.length;a<o;a++)i+=n[t[a]]&&n[t[a]].toString();return i}}return lp(e,r)}var tq=function(e,r){if(!r)return[e];var t=T3(e,r),n=[];for(var i in t)n.push(t[i]);return n};function ige(e,r){return e["_wrap_"+r]}function age(e,r){if(e["_wrap_"+r])return e["_wrap_"+r];var t=function(n){e[r](n)};return e["_wrap_"+r]=t,t}var A7={};function oge(e){var r=A7[e];if(!r){for(var t=e.toString(16),n=t.length;n<6;n++)t="0"+t;r="#"+t,A7[e]=r}return r}function sge(e){var r=0,t=0,n=0,i=0;return ar(e)?e.length===1?r=t=n=i=e[0]:e.length===2?(r=n=e[0],t=i=e[1]):e.length===3?(r=e[0],t=i=e[1],n=e[2]):(r=e[0],t=e[1],n=e[2],i=e[3]):r=t=n=i=e,{r1:r,r2:t,r3:n,r4:i}}var _s=function(e,r,t){return e<r?r:e>t?t:e},ZT=function(e,r){var t=r.toString(),n=t.indexOf(".");if(n===-1)return Math.round(e);var i=t.substr(n+1).length;return i>20&&(i=20),parseFloat(e.toFixed(i))},xi=function(e){return Zd(e,"Number")},uge=function(e){return xi(e)&&e%1!==0},lge=function(e){return xi(e)&&e%2===0},cge=Number.isInteger?Number.isInteger:function(e){return xi(e)&&e%1===0},fge=function(e){return xi(e)&&e<0},hge=1e-5;function ac(e,r,t){return t===void 0&&(t=hge),Math.abs(e-r)<t}var pge=function(e){return xi(e)&&e%2!==0},dge=function(e){return xi(e)&&e>0},M3=function(e,r){if(!!ar(e)){for(var t,n=-1/0,i=0;i<e.length;i++){var a=e[i],o=kn(r)?r(a):a[r];o>n&&(t=a,n=o)}return t}},rq=function(e,r){if(!!ar(e)){for(var t,n=1/0,i=0;i<e.length;i++){var a=e[i],o=kn(r)?r(a):a[r];o<n&&(t=a,n=o)}return t}},tI=function(e,r){return(e%r+r)%r},vge=180/Math.PI,gge=function(e){return vge*e},mge=parseInt,yge=Math.PI/180,rI=function(e){return yge*e},qg=function(e,r){return e.hasOwnProperty(r)},F2=Object.values?function(e){return Object.values(e)}:function(e){var r=[];return we(e,function(t,n){kn(e)&&n==="prototype"||r.push(t)}),r},_ge=function(e,r){return Ug(F2(e),r)},v_=function(e){return rr(e)?"":e.toString()},d1=function(e){return v_(e).toLowerCase()},xge=function(e){var r=v_(e);return r.charAt(0).toLowerCase()+r.substring(1)};function D2(e,r){return!e||!r?e:e.replace(/\\?\{([^{}]+)\}/g,function(t,n){return t.charAt(0)==="\\"?t.slice(1):r[n]===void 0?"":r[n]})}var bge=function(e){return v_(e).toUpperCase()},g_=function(e){var r=v_(e);return r.charAt(0).toUpperCase()+r.substring(1)},wge={}.toString,nq=function(e){return wge.call(e).replace(/^\[object /,"").replace(/]$/,"")},Cge=function(e){return Zd(e,"Arguments")},Zx=function(e){return Zd(e,"Boolean")},L3=function(e){return Zd(e,"Date")},Ege=function(e){return Zd(e,"Error")};function Sge(e){return xi(e)&&isFinite(e)}var iq=function(e){return e===null},Age=Object.prototype,aq=function(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||Age;return e===t},Tge=function(e){return Zd(e,"RegExp")},R0=function(e){return e===void 0},I3=function(e){return e instanceof Element||e instanceof HTMLDocument};function oq(e){var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,16)};return r(e)}function sq(e){var r=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;r(e)}function iR(e,r){for(var t in r)r.hasOwnProperty(t)&&t!=="constructor"&&r[t]!==void 0&&(e[t]=r[t])}function Na(e,r,t,n){return r&&iR(e,r),t&&iR(e,t),n&&iR(e,n),e}var Mge=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var t=e[0],n=1;n<e.length;n++){var i=e[n];kn(i)&&(i=i.prototype),Na(t.prototype,i)}},Of=function(e){if(typeof e!="object"||e===null)return e;var r;if(ar(e)){r=[];for(var t=0,n=e.length;t<n;t++)typeof e[t]=="object"&&e[t]!=null?r[t]=Of(e[t]):r[t]=e[t]}else{r={};for(var i in e)typeof e[i]=="object"&&e[i]!=null?r[i]=Of(e[i]):r[i]=e[i]}return r};function k3(e,r,t){var n;return function(){var i=this,a=arguments,o=function(){n=null,t||e.apply(i,a)},s=t&&!n;clearTimeout(n),n=setTimeout(o,r),s&&e.apply(i,a)}}var v1=function(e,r){if(!kn(e))throw new TypeError("Expected a function");var t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=r?r.apply(this,n):n[0],o=t.cache;if(o.has(a))return o.get(a);var s=e.apply(this,n);return o.set(a,s),s};return t.cache=new Map,t},Lge=5;function uq(e,r,t,n){t=t||0,n=n||Lge;for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];a!==null&&Wv(a)?(Wv(e[i])||(e[i]={}),t<n?uq(e[i],a,t+1,n):e[i]=r[i]):ar(a)?(e[i]=[],e[i]=e[i].concat(a)):a!==void 0&&(e[i]=a)}}var yn=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=0;n<r.length;n+=1)uq(e,r[n]);return e},Ige=function(e,r,t,n){kn(r)||(t=r,r=e,e=function(){});var i=Object.create?function(o,s){return Object.create(o,{constructor:{value:s}})}:function(o,s){function u(){}u.prototype=o;var l=new u;return l.constructor=s,l},a=i(r.prototype,e);return e.prototype=Na(a,e.prototype),e.superclass=i(r.prototype,r),Na(a,t),Na(e,n),e},P3=function(e,r){if(!hp(e))return-1;var t=Array.prototype.indexOf;if(t)return t.call(e,r);for(var n=-1,i=0;i<e.length;i++)if(e[i]===r){n=i;break}return n},kge=Object.prototype.hasOwnProperty;function uh(e){if(rr(e))return!0;if(hp(e))return!e.length;var r=nq(e);if(r==="Map"||r==="Set")return!e.size;if(aq(e))return!Object.keys(e).length;for(var t in e)if(kge.call(e,t))return!1;return!0}var rs=function(e,r){if(e===r)return!0;if(!e||!r||ei(e)||ei(r))return!1;if(hp(e)||hp(r)){if(e.length!==r.length)return!1;for(var t=!0,n=0;n<e.length&&(t=rs(e[n],r[n]),!!t);n++);return t}if(MM(e)||MM(r)){var i=Object.keys(e),a=Object.keys(r);if(i.length!==a.length)return!1;for(var t=!0,n=0;n<i.length&&(t=rs(e[i[n]],r[i[n]]),!!t);n++);return t}return!1},Pge=function(e,r,t){return kn(t)?!!t(e,r):rs(e,r)},gu=function(e,r){if(!hp(e))return e;for(var t=[],n=0;n<e.length;n++){var i=e[n];t.push(r(i,n))}return t},Rge=function(e){return e},lq=function(e,r){r===void 0&&(r=Rge);var t={};return xo(e)&&!rr(e)&&Object.keys(e).forEach(function(n){t[n]=r(e[n],n)}),t},Ie=function(e,r,t){for(var n=0,i=ei(r)?r.split("."):r;e&&n<i.length;)e=e[i[n++]];return e===void 0||n<i.length?t:e},nl=function(e,r,t){var n=e,i=ei(r)?r.split("."):r;return i.forEach(function(a,o){o<i.length-1?(xo(n[a])||(n[a]=xi(i[o+1])?[]:{}),n=n[a]):n[a]=t}),e},Oge=Object.prototype.hasOwnProperty,lS=function(e,r){if(e===null||!Wv(e))return{};var t={};return we(r,function(n){Oge.call(e,n)&&(t[n]=e[n])}),t},cS=function(e,r){return cf(e,function(t,n,i){return r.includes(i)||(t[i]=n),t},{})},nI=function(e,r,t){var n,i,a,o,s=0;t||(t={});var u=function(){s=t.leading===!1?0:Date.now(),n=null,o=e.apply(i,a),n||(i=a=null)},l=function(){var f=Date.now();!s&&t.leading===!1&&(s=f);var h=r-(f-s);return i=this,a=arguments,h<=0||h>r?(n&&(clearTimeout(n),n=null),s=f,o=e.apply(i,a),n||(i=a=null)):!n&&t.trailing!==!1&&(n=setTimeout(u,h)),o};return l.cancel=function(){clearTimeout(n),s=0,n=i=a=null},l},cq=function(e){return hp(e)?Array.prototype.slice.call(e):[]},SA={},Iy=function(e){return e=e||"g",SA[e]?SA[e]+=1:SA[e]=1,e+SA[e]},ny=function(){},Fge=function(e){return e};function zl(e){return rr(e)?0:hp(e)?e.length:Object.keys(e).length}function Dge(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;for(var n=Array(e),i=0,r=0;r<t;r++)for(var a=arguments[r],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}var AA,vC=v1(function(e,r){r===void 0&&(r={});var t=r.fontSize,n=r.fontFamily,i=r.fontWeight,a=r.fontStyle,o=r.fontVariant;return AA||(AA=document.createElement("canvas").getContext("2d")),AA.font=[a,o,i,t+"px",n].join(" "),AA.measureText(ei(e)?e:"").width},function(e,r){return r===void 0&&(r={}),Dge([e],F2(r)).join("")}),fq=function(e,r,t,n){n===void 0&&(n="...");var i=16,a=vC(n,t),o=ei(e)?e:v_(e),s=r,u=[],l,f;if(vC(e,t)<=r)return e;for(;l=o.substr(0,i),f=vC(l,t),!(f+a>s&&f>s);)if(u.push(l),s-=f,o=o.substr(i),!o)return u.join("");for(;l=o.substr(0,1),f=vC(l,t),!(f+a>s);)if(u.push(l),s-=f,o=o.substr(1),!o)return u.join("");return""+u.join("")+n},hq=function(){function e(){this.map={}}return e.prototype.has=function(r){return this.map[r]!==void 0},e.prototype.get=function(r,t){var n=this.map[r];return n===void 0?t:n},e.prototype.set=function(r,t){this.map[r]=t},e.prototype.clear=function(){this.map={}},e.prototype.delete=function(r){delete this.map[r]},e.prototype.size=function(){return Object.keys(this.map).length},e}(),Bge=Object.freeze(Object.defineProperty({__proto__:null,contains:Ug,includes:Ug,difference:YZ,find:$d,findIndex:S3,firstValue:ZZ,flatten:pp,flattenDeep:qZ,getRange:A3,pull:Qve,pullAt:QZ,reduce:cf,remove:JZ,sortBy:eq,union:ege,uniq:Z0,valuesOfKey:Gd,head:up,last:al,startsWith:tge,endsWith:rge,filter:kc,every:eI,some:uS,group:tq,groupBy:lp,groupToMap:T3,getWrapBehavior:ige,wrapBehavior:age,number2color:oge,parseRadius:sge,clamp:_s,fixedBase:ZT,isDecimal:uge,isEven:lge,isInteger:cge,isNegative:fge,isNumberEqual:ac,isOdd:pge,isPositive:dge,max:Ff,maxBy:M3,min:oh,minBy:rq,mod:tI,toDegree:gge,toInteger:mge,toRadian:rI,forIn:we,has:qg,hasKey:qg,hasValue:_ge,keys:p1,isMatch:E3,values:F2,lowerCase:d1,lowerFirst:xge,substitute:D2,upperCase:bge,upperFirst:g_,getType:nq,isArguments:Cge,isArray:ar,isArrayLike:hp,isBoolean:Zx,isDate:L3,isError:Ege,isFunction:kn,isFinite:Sge,isNil:rr,isNull:iq,isNumber:xi,isObject:xo,isObjectLike:MM,isPlainObject:Wv,isPrototype:aq,isRegExp:Tge,isString:ei,isType:Zd,isUndefined:R0,isElement:I3,requestAnimationFrame:oq,clearAnimationFrame:sq,augment:Mge,clone:Of,debounce:k3,memoize:v1,deepMix:yn,each:we,extend:Ige,indexOf:P3,isEmpty:uh,isEqual:rs,isEqualWith:Pge,map:gu,mapValues:lq,mix:Na,assign:Na,get:Ie,set:nl,pick:lS,omit:cS,throttle:nI,toArray:cq,toString:v_,uniqueId:Iy,noop:ny,identity:Fge,size:zl,measureTextWidth:vC,getEllipsisText:fq,Cache:hq},Symbol.toStringTag,{value:"Module"})),Vu;(function(e){e.FORE="fore",e.MID="mid",e.BG="bg"})(Vu||(Vu={}));var en;(function(e){e.TOP="top",e.TOP_LEFT="top-left",e.TOP_RIGHT="top-right",e.RIGHT="right",e.RIGHT_TOP="right-top",e.RIGHT_BOTTOM="right-bottom",e.LEFT="left",e.LEFT_TOP="left-top",e.LEFT_BOTTOM="left-bottom",e.BOTTOM="bottom",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_RIGHT="bottom-right",e.RADIUS="radius",e.CIRCLE="circle",e.NONE="none"})(en||(en={}));var ic;(function(e){e.AXIS="axis",e.GRID="grid",e.LEGEND="legend",e.TOOLTIP="tooltip",e.ANNOTATION="annotation",e.SLIDER="slider",e.SCROLLBAR="scrollbar",e.OTHER="other"})(ic||(ic={}));var Xb={FORE:3,MID:2,BG:1},ra;(function(e){e.BEFORE_RENDER="beforerender",e.AFTER_RENDER="afterrender",e.BEFORE_PAINT="beforepaint",e.AFTER_PAINT="afterpaint",e.BEFORE_CHANGE_DATA="beforechangedata",e.AFTER_CHANGE_DATA="afterchangedata",e.BEFORE_CLEAR="beforeclear",e.AFTER_CLEAR="afterclear",e.BEFORE_DESTROY="beforedestroy",e.BEFORE_CHANGE_SIZE="beforechangesize",e.AFTER_CHANGE_SIZE="afterchangesize"})(ra||(ra={}));var U0;(function(e){e.BEFORE_DRAW_ANIMATE="beforeanimate",e.AFTER_DRAW_ANIMATE="afteranimate",e.BEFORE_RENDER_LABEL="beforerenderlabel",e.AFTER_RENDER_LABEL="afterrenderlabel"})(U0||(U0={}));var Qh;(function(e){e.MOUSE_ENTER="plot:mouseenter",e.MOUSE_DOWN="plot:mousedown",e.MOUSE_MOVE="plot:mousemove",e.MOUSE_UP="plot:mouseup",e.MOUSE_LEAVE="plot:mouseleave",e.TOUCH_START="plot:touchstart",e.TOUCH_MOVE="plot:touchmove",e.TOUCH_END="plot:touchend",e.TOUCH_CANCEL="plot:touchcancel",e.CLICK="plot:click",e.DBLCLICK="plot:dblclick",e.CONTEXTMENU="plot:contextmenu",e.LEAVE="plot:leave",e.ENTER="plot:enter"})(Qh||(Qh={}));var LM;(function(e){e.ACTIVE="active",e.INACTIVE="inactive",e.SELECTED="selected",e.DEFAULT="default"})(LM||(LM={}));var Vb=["color","shape","size"],Wo="_origin",T7=1,M7=1,L7=.25,pq={};function Nge(e){var r=pq[e];if(!r)throw new Error("G engine '".concat(e,"' is not exist, please register it at first."));return r}function dq(e,r){pq[e]=r}function fb(e,r,t){if(e){if(typeof e.addEventListener=="function")return e.addEventListener(r,t,!1),{remove:function(){e.removeEventListener(r,t,!1)}};if(typeof e.attachEvent=="function")return e.attachEvent("on"+r,t),{remove:function(){e.detachEvent("on"+r,t)}}}}var gC,aR,vq,PF;function zge(){gC=document.createElement("table"),aR=document.createElement("tr"),vq=/^\s*<(\w+|!)[^>]*>/,PF={tr:document.createElement("tbody"),tbody:gC,thead:gC,tfoot:gC,td:aR,th:aR,"*":document.createElement("div")}}function ly(e){gC||zge();var r=vq.test(e)&&RegExp.$1;(!r||!(r in PF))&&(r="*");var t=PF[r];e=typeof e=="string"?e.replace(/(^\s*)|(\s*$)/g,""):e,t.innerHTML=""+e;var n=t.childNodes[0];return n&&t.contains(n)&&t.removeChild(n),n}function ap(e,r,t){var n;try{n=window.getComputedStyle?window.getComputedStyle(e,null)[r]:e.style[r]}catch{}finally{n=n===void 0?t:n}return n}function $ge(e,r){var t=ap(e,"height",r);return t==="auto"&&(t=e.offsetHeight),parseFloat(t)}function Uge(e,r){var t=$ge(e,r),n=parseFloat(ap(e,"borderTopWidth"))||0,i=parseFloat(ap(e,"paddingTop"))||0,a=parseFloat(ap(e,"paddingBottom"))||0,o=parseFloat(ap(e,"borderBottomWidth"))||0,s=parseFloat(ap(e,"marginTop"))||0,u=parseFloat(ap(e,"marginBottom"))||0;return t+n+o+i+a+s+u}function Vge(e,r){var t=ap(e,"width",r);return t==="auto"&&(t=e.offsetWidth),parseFloat(t)}function Gge(e,r){var t=Vge(e,r),n=parseFloat(ap(e,"borderLeftWidth"))||0,i=parseFloat(ap(e,"paddingLeft"))||0,a=parseFloat(ap(e,"paddingRight"))||0,o=parseFloat(ap(e,"borderRightWidth"))||0,s=parseFloat(ap(e,"marginRight"))||0,u=parseFloat(ap(e,"marginLeft"))||0;return t+n+o+i+a+u+s}function es(e,r){if(e)for(var t in r)r.hasOwnProperty(t)&&(e.style[t]=r[t]);return e}function Hge(e){var r=getComputedStyle(e);return{width:(e.clientWidth||parseInt(r.width,10))-parseInt(r.paddingLeft,10)-parseInt(r.paddingRight,10),height:(e.clientHeight||parseInt(r.height,10))-parseInt(r.paddingTop,10)-parseInt(r.paddingBottom,10)}}function I7(e){return typeof e=="number"&&!isNaN(e)}function k7(e,r,t,n){var i=t,a=n;if(r){var o=Hge(e);i=o.width?o.width:i,a=o.height?o.height:a}return{width:Math.max(I7(i)?i:T7,T7),height:Math.max(I7(a)?a:M7,M7)}}function jge(e){var r=e.parentNode;r&&r.removeChild(e)}var Wge="*",iI=function(){function e(){this._events={}}return e.prototype.on=function(r,t,n){return this._events[r]||(this._events[r]=[]),this._events[r].push({callback:t,once:!!n}),this},e.prototype.once=function(r,t){return this.on(r,t,!0)},e.prototype.emit=function(r){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[r]||[],o=this._events[Wge]||[],s=function(u){for(var l=u.length,f=0;f<l;f++)if(!!u[f]){var h=u[f],p=h.callback,v=h.once;v&&(u.splice(f,1),u.length===0&&delete t._events[r],l--,f--),p.apply(t,n)}};s(a),s(o)},e.prototype.off=function(r,t){if(!r)this._events={};else if(!t)delete this._events[r];else{for(var n=this._events[r]||[],i=n.length,a=0;a<i;a++)n[a].callback===t&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[r]}return this},e.prototype.getEvents=function(){return this._events},e}(),Xge=Object.freeze(Object.defineProperty({__proto__:null,default:iI},Symbol.toStringTag,{value:"Module"})),R3=function(e){Rn(r,e);function r(t){var n=e.call(this)||this;n.destroyed=!1;var i=t.visible,a=i===void 0?!0:i;return n.visible=a,n}return r.prototype.show=function(){var t=this.visible;t||this.changeVisible(!0)},r.prototype.hide=function(){var t=this.visible;t&&this.changeVisible(!1)},r.prototype.destroy=function(){this.off(),this.destroyed=!0},r.prototype.changeVisible=function(t){this.visible!==t&&(this.visible=t)},r}(iI),PC=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,Yge=new RegExp("([a-z])["+PC+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+PC+"]*,?["+PC+"]*)+)","ig"),Zge=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+PC+"]*,?["+PC+"]*","ig"),Gb=function(e){if(!e)return null;if(ar(e))return e;var r={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},t=[];return String(e).replace(Yge,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(Zge,function(u,l){l&&o.push(+l)}),s==="m"&&o.length>2&&(t.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&t.push([i,o[0]]),s==="r")t.push([i].concat(o));else for(;o.length>=r[s]&&(t.push([i].concat(o.splice(0,r[s]))),!!r[s]););return e}),t},RF=function(e,r){for(var t=[],n=0,i=e.length;i-2*!r>n;n+=2){var a=[{x:+e[n-2],y:+e[n-1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];r?n?i-4===n?a[3]={x:+e[0],y:+e[1]}:i-2===n&&(a[2]={x:+e[0],y:+e[1]},a[3]={x:+e[2],y:+e[3]}):a[0]={x:+e[i-2],y:+e[i-1]}:i-4===n?a[3]=a[2]:n||(a[0]={x:+e[n],y:+e[n+1]}),t.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return t},TA=function(e,r,t,n,i){var a=[];if(i===null&&n===null&&(n=t),e=+e,r=+r,t=+t,n=+n,i!==null){var o=Math.PI/180,s=e+t*Math.cos(-n*o),u=e+t*Math.cos(-i*o),l=r+t*Math.sin(-n*o),f=r+t*Math.sin(-i*o);a=[["M",s,l],["A",t,t,0,+(i-n>180),0,u,f]]}else a=[["M",e,r],["m",0,-n],["a",t,n,0,1,1,0,2*n],["a",t,n,0,1,1,0,-2*n],["z"]];return a},OF=function(e){if(e=Gb(e),!e||!e.length)return[["M",0,0]];var r=[],t=0,n=0,i=0,a=0,o=0,s,u;e[0][0]==="M"&&(t=+e[0][1],n=+e[0][2],i=t,a=n,o++,r[0]=["M",t,n]);for(var l=e.length===3&&e[0][0]==="M"&&e[1][0].toUpperCase()==="R"&&e[2][0].toUpperCase()==="Z",f=void 0,h=void 0,p=o,v=e.length;p<v;p++){if(r.push(f=[]),h=e[p],s=h[0],s!==s.toUpperCase())switch(f[0]=s.toUpperCase(),f[0]){case"A":f[1]=h[1],f[2]=h[2],f[3]=h[3],f[4]=h[4],f[5]=h[5],f[6]=+h[6]+t,f[7]=+h[7]+n;break;case"V":f[1]=+h[1]+n;break;case"H":f[1]=+h[1]+t;break;case"R":u=[t,n].concat(h.slice(1));for(var m=2,x=u.length;m<x;m++)u[m]=+u[m]+t,u[++m]=+u[m]+n;r.pop(),r=r.concat(RF(u,l));break;case"O":r.pop(),u=TA(t,n,h[1],h[2]),u.push(u[0]),r=r.concat(u);break;case"U":r.pop(),r=r.concat(TA(t,n,h[1],h[2],h[3])),f=["U"].concat(r[r.length-1].slice(-2));break;case"M":i=+h[1]+t,a=+h[2]+n;break;default:for(var m=1,x=h.length;m<x;m++)f[m]=+h[m]+(m%2?t:n)}else if(s==="R")u=[t,n].concat(h.slice(1)),r.pop(),r=r.concat(RF(u,l)),f=["R"].concat(h.slice(-2));else if(s==="O")r.pop(),u=TA(t,n,h[1],h[2]),u.push(u[0]),r=r.concat(u);else if(s==="U")r.pop(),r=r.concat(TA(t,n,h[1],h[2],h[3])),f=["U"].concat(r[r.length-1].slice(-2));else for(var E=0,A=h.length;E<A;E++)f[E]=h[E];if(s=s.toUpperCase(),s!=="O")switch(f[0]){case"Z":t=+i,n=+a;break;case"H":t=f[1];break;case"V":n=f[1];break;case"M":i=f[f.length-2],a=f[f.length-1];break;default:t=f[f.length-2],n=f[f.length-1]}}return r},MA=function(e,r,t,n){return[e,r,t,n,t,n]},P7=function(e,r,t,n,i,a){var o=.3333333333333333,s=2/3;return[o*e+s*t,o*r+s*n,o*i+s*t,o*a+s*n,i,a]},gq=function(e,r,t,n,i,a,o,s,u,l){t===n&&(t+=1);var f=Math.PI*120/180,h=Math.PI/180*(+i||0),p=[],v,m,x,E,A,L=function(wn,zn,Zt){var nn=wn*Math.cos(Zt)-zn*Math.sin(Zt),mn=wn*Math.sin(Zt)+zn*Math.cos(Zt);return{x:nn,y:mn}};if(l)m=l[0],x=l[1],E=l[2],A=l[3];else{v=L(e,r,-h),e=v.x,r=v.y,v=L(s,u,-h),s=v.x,u=v.y,e===s&&r===u&&(s+=1,u+=1);var k=(e-s)/2,R=(r-u)/2,D=k*k/(t*t)+R*R/(n*n);D>1&&(D=Math.sqrt(D),t=D*t,n=D*n);var $=t*t,j=n*n,H=(a===o?-1:1)*Math.sqrt(Math.abs(($*j-$*R*R-j*k*k)/($*R*R+j*k*k)));E=H*t*R/n+(e+s)/2,A=H*-n*k/t+(r+u)/2,m=Math.asin(((r-A)/n).toFixed(9)),x=Math.asin(((u-A)/n).toFixed(9)),m=e<E?Math.PI-m:m,x=s<E?Math.PI-x:x,m<0&&(m=Math.PI*2+m),x<0&&(x=Math.PI*2+x),o&&m>x&&(m=m-Math.PI*2),!o&&x>m&&(x=x-Math.PI*2)}var ee=x-m;if(Math.abs(ee)>f){var U=x,W=s,Q=u;x=m+f*(o&&x>m?1:-1),s=E+t*Math.cos(x),u=A+n*Math.sin(x),p=gq(s,u,t,n,i,0,o,W,Q,[x,U,E,A])}ee=x-m;var te=Math.cos(m),ie=Math.sin(m),ve=Math.cos(x),me=Math.sin(x),Re=Math.tan(ee/4),We=4/3*t*Re,je=4/3*n*Re,lt=[e,r],dt=[e+We*ie,r-je*te],ct=[s+We*me,u-je*ve],Tt=[s,u];if(dt[0]=2*lt[0]-dt[0],dt[1]=2*lt[1]-dt[1],l)return[dt,ct,Tt].concat(p);p=[dt,ct,Tt].concat(p).join().split(",");for(var It=[],Lt=0,rn=p.length;Lt<rn;Lt++)It[Lt]=Lt%2?L(p[Lt-1],p[Lt],h).y:L(p[Lt],p[Lt+1],h).x;return It},FF=function(e,r){var t=OF(e),n=r&&OF(r),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=[],s=[],u="",l="",f,h=function(k,R,D){var $,j;if(!k)return["C",R.x,R.y,R.x,R.y,R.x,R.y];switch(!(k[0]in{T:1,Q:1})&&(R.qx=R.qy=null),k[0]){case"M":R.X=k[1],R.Y=k[2];break;case"A":k=["C"].concat(gq.apply(0,[R.x,R.y].concat(k.slice(1))));break;case"S":D==="C"||D==="S"?($=R.x*2-R.bx,j=R.y*2-R.by):($=R.x,j=R.y),k=["C",$,j].concat(k.slice(1));break;case"T":D==="Q"||D==="T"?(R.qx=R.x*2-R.qx,R.qy=R.y*2-R.qy):(R.qx=R.x,R.qy=R.y),k=["C"].concat(P7(R.x,R.y,R.qx,R.qy,k[1],k[2]));break;case"Q":R.qx=k[1],R.qy=k[2],k=["C"].concat(P7(R.x,R.y,k[1],k[2],k[3],k[4]));break;case"L":k=["C"].concat(MA(R.x,R.y,k[1],k[2]));break;case"H":k=["C"].concat(MA(R.x,R.y,k[1],R.y));break;case"V":k=["C"].concat(MA(R.x,R.y,R.x,k[1]));break;case"Z":k=["C"].concat(MA(R.x,R.y,R.X,R.Y));break}return k},p=function(k,R){if(k[R].length>7){k[R].shift();for(var D=k[R];D.length;)o[R]="A",n&&(s[R]="A"),k.splice(R++,0,["C"].concat(D.splice(0,6)));k.splice(R,1),f=Math.max(t.length,n&&n.length||0)}},v=function(k,R,D,$,j){k&&R&&k[j][0]==="M"&&R[j][0]!=="M"&&(R.splice(j,0,["M",$.x,$.y]),D.bx=0,D.by=0,D.x=k[j][1],D.y=k[j][2],f=Math.max(t.length,n&&n.length||0))};f=Math.max(t.length,n&&n.length||0);for(var m=0;m<f;m++){t[m]&&(u=t[m][0]),u!=="C"&&(o[m]=u,m&&(l=o[m-1])),t[m]=h(t[m],i,l),o[m]!=="A"&&u==="C"&&(o[m]="C"),p(t,m),n&&(n[m]&&(u=n[m][0]),u!=="C"&&(s[m]=u,m&&(l=s[m-1])),n[m]=h(n[m],a,l),s[m]!=="A"&&u==="C"&&(s[m]="C"),p(n,m)),v(t,n,i,a,m),v(n,t,a,i,m);var x=t[m],E=n&&n[m],A=x.length,L=n&&E.length;i.x=x[A-2],i.y=x[A-1],i.bx=parseFloat(x[A-4])||i.x,i.by=parseFloat(x[A-3])||i.y,a.bx=n&&(parseFloat(E[L-4])||a.x),a.by=n&&(parseFloat(E[L-3])||a.y),a.x=n&&E[L-2],a.y=n&&E[L-1]}return n?[t,n]:t},qge=/,?([a-z]),?/gi,mq=function(e){return e.join(",").replace(qge,"$1")},R7=function(e,r,t,n,i){var a=-3*r+9*t-9*n+3*i,o=e*a+6*r-12*t+6*n;return e*o-3*r+3*t},O7=function(e,r,t,n,i,a,o,s,u){u===null&&(u=1),u=u>1?1:u<0?0:u;for(var l=u/2,f=12,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],v=0,m=0;m<f;m++){var x=l*h[m]+l,E=R7(x,e,t,i,o),A=R7(x,r,n,a,s),L=E*E+A*A;v+=p[m]*Math.sqrt(L)}return l*v},Kge=function(e,r,t,n,i,a,o,s){for(var u=[],l=[[],[]],f,h,p,v,m=0;m<2;++m){if(m===0?(h=6*e-12*t+6*i,f=-3*e+9*t-9*i+3*o,p=3*t-3*e):(h=6*r-12*n+6*a,f=-3*r+9*n-9*a+3*s,p=3*n-3*r),Math.abs(f)<1e-12){if(Math.abs(h)<1e-12)continue;v=-p/h,v>0&&v<1&&u.push(v);continue}var x=h*h-4*p*f,E=Math.sqrt(x);if(!(x<0)){var A=(-h+E)/(2*f);A>0&&A<1&&u.push(A);var L=(-h-E)/(2*f);L>0&&L<1&&u.push(L)}}for(var k=u.length,R=k,D;k--;)v=u[k],D=1-v,l[0][k]=D*D*D*e+3*D*D*v*t+3*D*v*v*i+v*v*v*o,l[1][k]=D*D*D*r+3*D*D*v*n+3*D*v*v*a+v*v*v*s;return l[0][R]=e,l[1][R]=r,l[0][R+1]=o,l[1][R+1]=s,l[0].length=l[1].length=R+2,{min:{x:Math.min.apply(0,l[0]),y:Math.min.apply(0,l[1])},max:{x:Math.max.apply(0,l[0]),y:Math.max.apply(0,l[1])}}},Qge=function(e,r,t,n,i,a,o,s){if(!(Math.max(e,t)<Math.min(i,o)||Math.min(e,t)>Math.max(i,o)||Math.max(r,n)<Math.min(a,s)||Math.min(r,n)>Math.max(a,s))){var u=(e*n-r*t)*(i-o)-(e-t)*(i*s-a*o),l=(e*n-r*t)*(a-s)-(r-n)*(i*s-a*o),f=(e-t)*(a-s)-(r-n)*(i-o);if(!!f){var h=u/f,p=l/f,v=+h.toFixed(2),m=+p.toFixed(2);if(!(v<+Math.min(e,t).toFixed(2)||v>+Math.max(e,t).toFixed(2)||v<+Math.min(i,o).toFixed(2)||v>+Math.max(i,o).toFixed(2)||m<+Math.min(r,n).toFixed(2)||m>+Math.max(r,n).toFixed(2)||m<+Math.min(a,s).toFixed(2)||m>+Math.max(a,s).toFixed(2)))return{x:h,y:p}}}},o0=function(e,r,t){return r>=e.x&&r<=e.x+e.width&&t>=e.y&&t<=e.y+e.height},yq=function(e,r,t,n,i){if(i)return[["M",+e+ +i,r],["l",t-i*2,0],["a",i,i,0,0,1,i,i],["l",0,n-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-t,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-n],["a",i,i,0,0,1,i,-i],["z"]];var a=[["M",e,r],["l",t,0],["l",0,n],["l",-t,0],["z"]];return a.parsePathArray=mq,a},DF=function(e,r,t,n){return e===null&&(e=r=t=n=0),r===null&&(r=e.y,t=e.width,n=e.height,e=e.x),{x:e,y:r,width:t,w:t,height:n,h:n,x2:e+t,y2:r+n,cx:e+t/2,cy:r+n/2,r1:Math.min(t,n)/2,r2:Math.max(t,n)/2,r0:Math.sqrt(t*t+n*n)/2,path:yq(e,r,t,n),vb:[e,r,t,n].join(" ")}},Jge=function(e,r){return e=DF(e),r=DF(r),o0(r,e.x,e.y)||o0(r,e.x2,e.y)||o0(r,e.x,e.y2)||o0(r,e.x2,e.y2)||o0(e,r.x,r.y)||o0(e,r.x2,r.y)||o0(e,r.x,r.y2)||o0(e,r.x2,r.y2)||(e.x<r.x2&&e.x>r.x||r.x<e.x2&&r.x>e.x)&&(e.y<r.y2&&e.y>r.y||r.y<e.y2&&r.y>e.y)},F7=function(e,r,t,n,i,a,o,s){ar(e)||(e=[e,r,t,n,i,a,o,s]);var u=Kge.apply(null,e);return DF(u.min.x,u.min.y,u.max.x-u.min.x,u.max.y-u.min.y)},D7=function(e,r,t,n,i,a,o,s,u){var l=1-u,f=Math.pow(l,3),h=Math.pow(l,2),p=u*u,v=p*u,m=f*e+h*3*u*t+l*3*u*u*i+v*o,x=f*r+h*3*u*n+l*3*u*u*a+v*s,E=e+2*u*(t-e)+p*(i-2*t+e),A=r+2*u*(n-r)+p*(a-2*n+r),L=t+2*u*(i-t)+p*(o-2*i+t),k=n+2*u*(a-n)+p*(s-2*a+n),R=l*e+u*t,D=l*r+u*n,$=l*i+u*o,j=l*a+u*s,H=90-Math.atan2(E-L,A-k)*180/Math.PI;return{x:m,y:x,m:{x:E,y:A},n:{x:L,y:k},start:{x:R,y:D},end:{x:$,y:j},alpha:H}},eme=function(e,r,t){var n=F7(e),i=F7(r);if(!Jge(n,i))return t?0:[];for(var a=O7.apply(0,e),o=O7.apply(0,r),s=~~(a/8),u=~~(o/8),l=[],f=[],h={},p=t?0:[],v=0;v<s+1;v++){var m=D7.apply(0,e.concat(v/s));l.push({x:m.x,y:m.y,t:v/s})}for(var v=0;v<u+1;v++){var m=D7.apply(0,r.concat(v/u));f.push({x:m.x,y:m.y,t:v/u})}for(var v=0;v<s;v++)for(var x=0;x<u;x++){var E=l[v],A=l[v+1],L=f[x],k=f[x+1],R=Math.abs(A.x-E.x)<.001?"y":"x",D=Math.abs(k.x-L.x)<.001?"y":"x",$=Qge(E.x,E.y,A.x,A.y,L.x,L.y,k.x,k.y);if($){if(h[$.x.toFixed(4)]===$.y.toFixed(4))continue;h[$.x.toFixed(4)]=$.y.toFixed(4);var j=E.t+Math.abs(($[R]-E[R])/(A[R]-E[R]))*(A.t-E.t),H=L.t+Math.abs(($[D]-L[D])/(k[D]-L[D]))*(k.t-L.t);j>=0&&j<=1&&H>=0&&H<=1&&(t?p+=1:p.push({x:$.x,y:$.y,t1:j,t2:H}))}}return p},tme=function(e,r,t){e=FF(e),r=FF(r);for(var n,i,a,o,s,u,l,f,h,p,v=t?0:[],m=0,x=e.length;m<x;m++){var E=e[m];if(E[0]==="M")n=s=E[1],i=u=E[2];else{E[0]==="C"?(h=[n,i].concat(E.slice(1)),n=h[6],i=h[7]):(h=[n,i,n,i,s,u,s,u],n=s,i=u);for(var A=0,L=r.length;A<L;A++){var k=r[A];if(k[0]==="M")a=l=k[1],o=f=k[2];else{k[0]==="C"?(p=[a,o].concat(k.slice(1)),a=p[6],o=p[7]):(p=[a,o,a,o,l,f,l,f],a=l,o=f);var R=eme(h,p,t);if(t)v+=R;else{for(var D=0,$=R.length;D<$;D++)R[D].segment1=m,R[D].segment2=A,R[D].bez1=h,R[D].bez2=p;v=v.concat(R)}}}}}return v},rme=function(e,r){return tme(e,r)};function nme(e,r){var t=[],n=[];function i(a,o){if(a.length===1)t.push(a[0]),n.push(a[0]);else{for(var s=[],u=0;u<a.length-1;u++)u===0&&t.push(a[0]),u===a.length-2&&n.push(a[u+1]),s[u]=[(1-o)*a[u][0]+o*a[u+1][0],(1-o)*a[u][1]+o*a[u+1][1]];i(s,o)}}return e.length&&i(e,r),{left:t,right:n.reverse()}}function ime(e,r,t){var n=[[e[1],e[2]]];t=t||2;var i=[];r[0]==="A"?(n.push(r[6]),n.push(r[7])):r[0]==="C"?(n.push([r[1],r[2]]),n.push([r[3],r[4]]),n.push([r[5],r[6]])):r[0]==="S"||r[0]==="Q"?(n.push([r[1],r[2]]),n.push([r[3],r[4]])):n.push([r[1],r[2]]);for(var a=n,o=1/t,s=0;s<t-1;s++){var u=o/(1-o*s),l=nme(a,u);i.push(l.left),a=l.right}i.push(a);var f=i.map(function(h){var p=[];return h.length===4&&(p.push("C"),p=p.concat(h[2])),h.length>=3&&(h.length===3&&p.push("Q"),p=p.concat(h[1])),h.length===2&&p.push("L"),p=p.concat(h[h.length-1]),p});return f}var ame=function(e,r,t){if(t===1)return[[].concat(e)];var n=[];if(r[0]==="L"||r[0]==="C"||r[0]==="Q")n=n.concat(ime(e,r,t));else{var i=[].concat(e);i[0]==="M"&&(i[0]="L");for(var a=0;a<=t-1;a++)n.push(i)}return n},ome=function(e,r){if(e.length===1)return e;var t=e.length-1,n=r.length-1,i=t/n,a=[];if(e.length===1&&e[0][0]==="M"){for(var o=0;o<n-t;o++)e.push(e[0]);return e}for(var o=0;o<n;o++){var s=Math.floor(i*o);a[s]=(a[s]||0)+1}var u=a.reduce(function(l,f,h){return h===t?l.concat(e[t]):l.concat(ame(e[h],e[h+1],f))},[]);return u.unshift(e[0]),(r[n]==="Z"||r[n]==="z")&&u.push("Z"),u},sme=function(e,r){if(e.length!==r.length)return!1;var t=!0;return we(e,function(n,i){if(n!==r[i])return t=!1,!1}),t};function ume(e,r,t){var n=null,i=t;return r<i&&(i=r,n="add"),e<i&&(i=e,n="del"),{type:n,min:i}}var lme=function(e,r){var t=e.length,n=r.length,i,a,o=0;if(t===0||n===0)return null;for(var s=[],u=0;u<=t;u++)s[u]=[],s[u][0]={min:u};for(var l=0;l<=n;l++)s[0][l]={min:l};for(var u=1;u<=t;u++){i=e[u-1];for(var l=1;l<=n;l++){a=r[l-1],sme(i,a)?o=0:o=1;var f=s[u-1][l].min+1,h=s[u][l-1].min+1,p=s[u-1][l-1].min+o;s[u][l]=ume(f,h,p)}}return s},_q=function(e,r){var t=lme(e,r),n=e.length,i=r.length,a=[],o=1,s=1;if(t[n][i].min!==n){for(var u=1;u<=n;u++){var l=t[u][u].min;s=u;for(var f=o;f<=i;f++)t[u][f].min<l&&(l=t[u][f].min,s=f);o=s,t[u][o].type&&a.push({index:u-1,type:t[u][o].type})}for(var u=a.length-1;u>=0;u--)o=a[u].index,a[u].type==="add"?e.splice(o,0,[].concat(e[o])):e.splice(o,1)}n=e.length;var h=i-n;if(n<i)for(var u=0;u<h;u++)e[n-1][0]==="z"||e[n-1][0]==="Z"?e.splice(n-2,0,e[n-2]):e.push(e[n-1]),n+=1;return e};function oR(e,r,t){for(var n=[].concat(e),i,a=1/(t+1),o=xq(r)[0],s=1;s<=t;s++)a*=s,i=Math.floor(e.length*a),i===0?n.unshift([o[0]*a+e[i][0]*(1-a),o[1]*a+e[i][1]*(1-a)]):n.splice(i,0,[o[0]*a+e[i][0]*(1-a),o[1]*a+e[i][1]*(1-a)]);return n}function xq(e){var r=[];switch(e[0]){case"M":r.push([e[1],e[2]]);break;case"L":r.push([e[1],e[2]]);break;case"A":r.push([e[6],e[7]]);break;case"Q":r.push([e[3],e[4]]),r.push([e[1],e[2]]);break;case"T":r.push([e[1],e[2]]);break;case"C":r.push([e[5],e[6]]),r.push([e[1],e[2]]),r.push([e[3],e[4]]);break;case"S":r.push([e[3],e[4]]),r.push([e[1],e[2]]);break;case"H":r.push([e[1],e[1]]);break;case"V":r.push([e[1],e[1]]);break}return r}var BF=function(e,r){if(e.length<=1)return e;for(var t,n=0;n<r.length;n++)if(e[n][0]!==r[n][0])switch(t=xq(e[n]),r[n][0]){case"M":e[n]=["M"].concat(t[0]);break;case"L":e[n]=["L"].concat(t[0]);break;case"A":e[n]=[].concat(r[n]),e[n][6]=t[0][0],e[n][7]=t[0][1];break;case"Q":if(t.length<2)if(n>0)t=oR(t,e[n-1],1);else{e[n]=r[n];break}e[n]=["Q"].concat(t.reduce(function(i,a){return i.concat(a)},[]));break;case"T":e[n]=["T"].concat(t[0]);break;case"C":if(t.length<3)if(n>0)t=oR(t,e[n-1],2);else{e[n]=r[n];break}e[n]=["C"].concat(t.reduce(function(i,a){return i.concat(a)},[]));break;case"S":if(t.length<2)if(n>0)t=oR(t,e[n-1],1);else{e[n]=r[n];break}e[n]=["S"].concat(t.reduce(function(i,a){return i.concat(a)},[]));break;default:e[n]=r[n]}return e},O3=Object.freeze(Object.defineProperty({__proto__:null,catmullRomToBezier:RF,fillPath:ome,fillPathByDiff:_q,formatPath:BF,intersection:rme,parsePathArray:mq,parsePathString:Gb,pathToAbsolute:OF,pathToCurve:FF,rectPath:yq},Symbol.toStringTag,{value:"Module"})),fS=function(){function e(r,t){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=r,this.name=r,this.originalEvent=t,this.timeStamp=t.timeStamp}return e.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.toString=function(){var r=this.type;return"[Event (type="+r+")]"},e.prototype.save=function(){},e.prototype.restore=function(){},e}(),NF=function(e,r){return NF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},NF(e,r)};function B2(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");NF(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}function bq(e,r){var t=e.indexOf(r);t!==-1&&e.splice(t,1)}var B7=typeof window!="undefined"&&typeof window.document!="undefined";function wq(e,r){if(e.isCanvas())return!0;for(var t=r.getParent(),n=!1;t;){if(t===e){n=!0;break}t=t.getParent()}return n}function nE(e){return e.cfg.visible&&e.cfg.capture}var aI=function(e){B2(r,e);function r(t){var n=e.call(this)||this;n.destroyed=!1;var i=n.getDefaultCfg();return n.cfg=Na(i,t),n}return r.prototype.getDefaultCfg=function(){return{}},r.prototype.get=function(t){return this.cfg[t]},r.prototype.set=function(t,n){this.cfg[t]=n},r.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},r}(iI),N7=globalThis&&globalThis.__spreadArray||function(e,r,t){if(t||arguments.length===2)for(var n=0,i=r.length,a;n<i;n++)(a||!(n in r))&&(a||(a=Array.prototype.slice.call(r,0,n)),a[n]=r[n]);return e.concat(a||Array.prototype.slice.call(r))},cme=function(){function e(r,t,n){this.name=r,this.version=t,this.os=n,this.type="browser"}return e}(),fme=function(){function e(r){this.version=r,this.type="node",this.name="node",this.os=process.platform}return e}(),hme=function(){function e(r,t,n,i){this.name=r,this.version=t,this.os=n,this.bot=i,this.type="bot-device"}return e}(),pme=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),dme=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),vme=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,gme=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,z7=3,mme=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",vme]],$7=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Cq(e){return e?U7(e):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new dme:typeof navigator!="undefined"?U7(navigator.userAgent):xme()}function yme(e){return e!==""&&mme.reduce(function(r,t){var n=t[0],i=t[1];if(r)return r;var a=i.exec(e);return!!a&&[n,a]},!1)}function U7(e){var r=yme(e);if(!r)return null;var t=r[0],n=r[1];if(t==="searchbot")return new pme;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<z7&&(i=N7(N7([],i,!0),bme(z7-i.length),!0)):i=[];var a=i.join("."),o=_me(e),s=gme.exec(e);return s&&s[1]?new hme(t,a,o,s[1]):new cme(t,a,o)}function _me(e){for(var r=0,t=$7.length;r<t;r++){var n=$7[r],i=n[0],a=n[1],o=a.exec(e);if(o)return i}return null}function xme(){var e=typeof process!="undefined"&&process.version;return e?new fme(process.version.slice(1)):null}function bme(e){for(var r=[],t=0;t<e;t++)r.push("0");return r}var Lu=1e-6,Ic=typeof Float32Array!="undefined"?Float32Array:Array,V7=Math.random;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function wme(){var e=new Ic(4);return Ic!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function Cme(e,r,t){var n=r[0],i=r[1],a=r[2],o=r[3],s=Math.sin(t),u=Math.cos(t);return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=n*-s+a*u,e[3]=i*-s+o*u,e}function Eme(e,r){var t=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],u=r[6],l=r[7],f=r[8],h=f*o-s*l,p=-f*a+s*u,v=l*a-o*u,m=t*h+n*p+i*v;return m?(m=1/m,e[0]=h*m,e[1]=(-f*n+i*l)*m,e[2]=(s*n-i*o)*m,e[3]=p*m,e[4]=(f*t-i*u)*m,e[5]=(-s*t+i*a)*m,e[6]=v*m,e[7]=(-l*t+n*u)*m,e[8]=(o*t-n*a)*m,e):null}function oI(e,r,t){var n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],u=r[5],l=r[6],f=r[7],h=r[8],p=t[0],v=t[1],m=t[2],x=t[3],E=t[4],A=t[5],L=t[6],k=t[7],R=t[8];return e[0]=p*n+v*o+m*l,e[1]=p*i+v*s+m*f,e[2]=p*a+v*u+m*h,e[3]=x*n+E*o+A*l,e[4]=x*i+E*s+A*f,e[5]=x*a+E*u+A*h,e[6]=L*n+k*o+R*l,e[7]=L*i+k*s+R*f,e[8]=L*a+k*u+R*h,e}function Sme(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=r[0],e[7]=r[1],e[8]=1,e}function Ame(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=-t,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Tme(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=r[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ts(){var e=new Ic(16);return Ic!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function sI(e){var r=new Ic(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Mme(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Eq(e,r,t,n,i,a,o,s,u,l,f,h,p,v,m,x){var E=new Ic(16);return E[0]=e,E[1]=r,E[2]=t,E[3]=n,E[4]=i,E[5]=a,E[6]=o,E[7]=s,E[8]=u,E[9]=l,E[10]=f,E[11]=h,E[12]=p,E[13]=v,E[14]=m,E[15]=x,E}function Lme(e,r,t,n,i,a,o,s,u,l,f,h,p,v,m,x,E){return e[0]=r,e[1]=t,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=f,e[10]=h,e[11]=p,e[12]=v,e[13]=m,e[14]=x,e[15]=E,e}function IM(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ime(e,r){if(e===r){var t=r[1],n=r[2],i=r[3],a=r[6],o=r[7],s=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=a,e[11]=r[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function s2(e,r){var t=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],u=r[6],l=r[7],f=r[8],h=r[9],p=r[10],v=r[11],m=r[12],x=r[13],E=r[14],A=r[15],L=t*s-n*o,k=t*u-i*o,R=t*l-a*o,D=n*u-i*s,$=n*l-a*s,j=i*l-a*u,H=f*x-h*m,ee=f*E-p*m,U=f*A-v*m,W=h*E-p*x,Q=h*A-v*x,te=p*A-v*E,ie=L*te-k*Q+R*W+D*U-$*ee+j*H;return ie?(ie=1/ie,e[0]=(s*te-u*Q+l*W)*ie,e[1]=(i*Q-n*te-a*W)*ie,e[2]=(x*j-E*$+A*D)*ie,e[3]=(p*$-h*j-v*D)*ie,e[4]=(u*U-o*te-l*ee)*ie,e[5]=(t*te-i*U+a*ee)*ie,e[6]=(E*R-m*j-A*k)*ie,e[7]=(f*j-p*R+v*k)*ie,e[8]=(o*Q-s*U+l*H)*ie,e[9]=(n*U-t*Q-a*H)*ie,e[10]=(m*$-x*R+A*L)*ie,e[11]=(h*R-f*$-v*L)*ie,e[12]=(s*ee-o*W-u*H)*ie,e[13]=(t*W-n*ee+i*H)*ie,e[14]=(x*k-m*D-E*L)*ie,e[15]=(f*D-h*k+p*L)*ie,e):null}function kme(e,r){var t=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],u=r[6],l=r[7],f=r[8],h=r[9],p=r[10],v=r[11],m=r[12],x=r[13],E=r[14],A=r[15];return e[0]=s*(p*A-v*E)-h*(u*A-l*E)+x*(u*v-l*p),e[1]=-(n*(p*A-v*E)-h*(i*A-a*E)+x*(i*v-a*p)),e[2]=n*(u*A-l*E)-s*(i*A-a*E)+x*(i*l-a*u),e[3]=-(n*(u*v-l*p)-s*(i*v-a*p)+h*(i*l-a*u)),e[4]=-(o*(p*A-v*E)-f*(u*A-l*E)+m*(u*v-l*p)),e[5]=t*(p*A-v*E)-f*(i*A-a*E)+m*(i*v-a*p),e[6]=-(t*(u*A-l*E)-o*(i*A-a*E)+m*(i*l-a*u)),e[7]=t*(u*v-l*p)-o*(i*v-a*p)+f*(i*l-a*u),e[8]=o*(h*A-v*x)-f*(s*A-l*x)+m*(s*v-l*h),e[9]=-(t*(h*A-v*x)-f*(n*A-a*x)+m*(n*v-a*h)),e[10]=t*(s*A-l*x)-o*(n*A-a*x)+m*(n*l-a*s),e[11]=-(t*(s*v-l*h)-o*(n*v-a*h)+f*(n*l-a*s)),e[12]=-(o*(h*E-p*x)-f*(s*E-u*x)+m*(s*p-u*h)),e[13]=t*(h*E-p*x)-f*(n*E-i*x)+m*(n*p-i*h),e[14]=-(t*(s*E-u*x)-o*(n*E-i*x)+m*(n*u-i*s)),e[15]=t*(s*p-u*h)-o*(n*p-i*h)+f*(n*u-i*s),e}function Pme(e){var r=e[0],t=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],f=e[9],h=e[10],p=e[11],v=e[12],m=e[13],x=e[14],E=e[15],A=r*o-t*a,L=r*s-n*a,k=r*u-i*a,R=t*s-n*o,D=t*u-i*o,$=n*u-i*s,j=l*m-f*v,H=l*x-h*v,ee=l*E-p*v,U=f*x-h*m,W=f*E-p*m,Q=h*E-p*x;return A*Q-L*W+k*U+R*ee-D*H+$*j}function ff(e,r,t){var n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],u=r[5],l=r[6],f=r[7],h=r[8],p=r[9],v=r[10],m=r[11],x=r[12],E=r[13],A=r[14],L=r[15],k=t[0],R=t[1],D=t[2],$=t[3];return e[0]=k*n+R*s+D*h+$*x,e[1]=k*i+R*u+D*p+$*E,e[2]=k*a+R*l+D*v+$*A,e[3]=k*o+R*f+D*m+$*L,k=t[4],R=t[5],D=t[6],$=t[7],e[4]=k*n+R*s+D*h+$*x,e[5]=k*i+R*u+D*p+$*E,e[6]=k*a+R*l+D*v+$*A,e[7]=k*o+R*f+D*m+$*L,k=t[8],R=t[9],D=t[10],$=t[11],e[8]=k*n+R*s+D*h+$*x,e[9]=k*i+R*u+D*p+$*E,e[10]=k*a+R*l+D*v+$*A,e[11]=k*o+R*f+D*m+$*L,k=t[12],R=t[13],D=t[14],$=t[15],e[12]=k*n+R*s+D*h+$*x,e[13]=k*i+R*u+D*p+$*E,e[14]=k*a+R*l+D*v+$*A,e[15]=k*o+R*f+D*m+$*L,e}function ih(e,r,t){var n=t[0],i=t[1],a=t[2],o,s,u,l,f,h,p,v,m,x,E,A;return r===e?(e[12]=r[0]*n+r[4]*i+r[8]*a+r[12],e[13]=r[1]*n+r[5]*i+r[9]*a+r[13],e[14]=r[2]*n+r[6]*i+r[10]*a+r[14],e[15]=r[3]*n+r[7]*i+r[11]*a+r[15]):(o=r[0],s=r[1],u=r[2],l=r[3],f=r[4],h=r[5],p=r[6],v=r[7],m=r[8],x=r[9],E=r[10],A=r[11],e[0]=o,e[1]=s,e[2]=u,e[3]=l,e[4]=f,e[5]=h,e[6]=p,e[7]=v,e[8]=m,e[9]=x,e[10]=E,e[11]=A,e[12]=o*n+f*i+m*a+r[12],e[13]=s*n+h*i+x*a+r[13],e[14]=u*n+p*i+E*a+r[14],e[15]=l*n+v*i+A*a+r[15]),e}function op(e,r,t){var n=t[0],i=t[1],a=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=r[7]*i,e[8]=r[8]*a,e[9]=r[9]*a,e[10]=r[10]*a,e[11]=r[11]*a,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Rme(e,r,t,n){var i=n[0],a=n[1],o=n[2],s=Math.hypot(i,a,o),u,l,f,h,p,v,m,x,E,A,L,k,R,D,$,j,H,ee,U,W,Q,te,ie,ve;return s<Lu?null:(s=1/s,i*=s,a*=s,o*=s,u=Math.sin(t),l=Math.cos(t),f=1-l,h=r[0],p=r[1],v=r[2],m=r[3],x=r[4],E=r[5],A=r[6],L=r[7],k=r[8],R=r[9],D=r[10],$=r[11],j=i*i*f+l,H=a*i*f+o*u,ee=o*i*f-a*u,U=i*a*f-o*u,W=a*a*f+l,Q=o*a*f+i*u,te=i*o*f+a*u,ie=a*o*f-i*u,ve=o*o*f+l,e[0]=h*j+x*H+k*ee,e[1]=p*j+E*H+R*ee,e[2]=v*j+A*H+D*ee,e[3]=m*j+L*H+$*ee,e[4]=h*U+x*W+k*Q,e[5]=p*U+E*W+R*Q,e[6]=v*U+A*W+D*Q,e[7]=m*U+L*W+$*Q,e[8]=h*te+x*ie+k*ve,e[9]=p*te+E*ie+R*ve,e[10]=v*te+A*ie+D*ve,e[11]=m*te+L*ie+$*ve,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function m_(e,r,t){var n=Math.sin(t),i=Math.cos(t),a=r[4],o=r[5],s=r[6],u=r[7],l=r[8],f=r[9],h=r[10],p=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=a*i+l*n,e[5]=o*i+f*n,e[6]=s*i+h*n,e[7]=u*i+p*n,e[8]=l*i-a*n,e[9]=f*i-o*n,e[10]=h*i-s*n,e[11]=p*i-u*n,e}function g1(e,r,t){var n=Math.sin(t),i=Math.cos(t),a=r[0],o=r[1],s=r[2],u=r[3],l=r[8],f=r[9],h=r[10],p=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=a*i-l*n,e[1]=o*i-f*n,e[2]=s*i-h*n,e[3]=u*i-p*n,e[8]=a*n+l*i,e[9]=o*n+f*i,e[10]=s*n+h*i,e[11]=u*n+p*i,e}function y_(e,r,t){var n=Math.sin(t),i=Math.cos(t),a=r[0],o=r[1],s=r[2],u=r[3],l=r[4],f=r[5],h=r[6],p=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=a*i+l*n,e[1]=o*i+f*n,e[2]=s*i+h*n,e[3]=u*i+p*n,e[4]=l*i-a*n,e[5]=f*i-o*n,e[6]=h*i-s*n,e[7]=p*i-u*n,e}function Sq(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Ome(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fme(e,r,t){var n=t[0],i=t[1],a=t[2],o=Math.hypot(n,i,a),s,u,l;return o<Lu?null:(o=1/o,n*=o,i*=o,a*=o,s=Math.sin(r),u=Math.cos(r),l=1-u,e[0]=n*n*l+u,e[1]=i*n*l+a*s,e[2]=a*n*l-i*s,e[3]=0,e[4]=n*i*l-a*s,e[5]=i*i*l+u,e[6]=a*i*l+n*s,e[7]=0,e[8]=n*a*l+i*s,e[9]=i*a*l-n*s,e[10]=a*a*l+u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Dme(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Bme(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Nme(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Aq(e,r,t){var n=r[0],i=r[1],a=r[2],o=r[3],s=n+n,u=i+i,l=a+a,f=n*s,h=n*u,p=n*l,v=i*u,m=i*l,x=a*l,E=o*s,A=o*u,L=o*l;return e[0]=1-(v+x),e[1]=h+L,e[2]=p-A,e[3]=0,e[4]=h-L,e[5]=1-(f+x),e[6]=m+E,e[7]=0,e[8]=p+A,e[9]=m-E,e[10]=1-(f+v),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function zme(e,r){var t=new Ic(3),n=-r[0],i=-r[1],a=-r[2],o=r[3],s=r[4],u=r[5],l=r[6],f=r[7],h=n*n+i*i+a*a+o*o;return h>0?(t[0]=(s*o+f*n+u*a-l*i)*2/h,t[1]=(u*o+f*i+l*n-s*a)*2/h,t[2]=(l*o+f*a+s*i-u*n)*2/h):(t[0]=(s*o+f*n+u*a-l*i)*2,t[1]=(u*o+f*i+l*n-s*a)*2,t[2]=(l*o+f*a+s*i-u*n)*2),Aq(e,r,t),e}function $me(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function Tq(e,r){var t=r[0],n=r[1],i=r[2],a=r[4],o=r[5],s=r[6],u=r[8],l=r[9],f=r[10];return e[0]=Math.hypot(t,n,i),e[1]=Math.hypot(a,o,s),e[2]=Math.hypot(u,l,f),e}function Ume(e,r){var t=new Ic(3);Tq(t,r);var n=1/t[0],i=1/t[1],a=1/t[2],o=r[0]*n,s=r[1]*i,u=r[2]*a,l=r[4]*n,f=r[5]*i,h=r[6]*a,p=r[8]*n,v=r[9]*i,m=r[10]*a,x=o+f+m,E=0;return x>0?(E=Math.sqrt(x+1)*2,e[3]=.25*E,e[0]=(h-v)/E,e[1]=(p-u)/E,e[2]=(s-l)/E):o>f&&o>m?(E=Math.sqrt(1+o-f-m)*2,e[3]=(h-v)/E,e[0]=.25*E,e[1]=(s+l)/E,e[2]=(p+u)/E):f>m?(E=Math.sqrt(1+f-o-m)*2,e[3]=(p-u)/E,e[0]=(s+l)/E,e[1]=.25*E,e[2]=(h+v)/E):(E=Math.sqrt(1+m-o-f)*2,e[3]=(s-l)/E,e[0]=(p+u)/E,e[1]=(h+v)/E,e[2]=.25*E),e}function Vme(e,r,t,n){var i=r[0],a=r[1],o=r[2],s=r[3],u=i+i,l=a+a,f=o+o,h=i*u,p=i*l,v=i*f,m=a*l,x=a*f,E=o*f,A=s*u,L=s*l,k=s*f,R=n[0],D=n[1],$=n[2];return e[0]=(1-(m+E))*R,e[1]=(p+k)*R,e[2]=(v-L)*R,e[3]=0,e[4]=(p-k)*D,e[5]=(1-(h+E))*D,e[6]=(x+A)*D,e[7]=0,e[8]=(v+L)*$,e[9]=(x-A)*$,e[10]=(1-(h+m))*$,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Gme(e,r,t,n,i){var a=r[0],o=r[1],s=r[2],u=r[3],l=a+a,f=o+o,h=s+s,p=a*l,v=a*f,m=a*h,x=o*f,E=o*h,A=s*h,L=u*l,k=u*f,R=u*h,D=n[0],$=n[1],j=n[2],H=i[0],ee=i[1],U=i[2],W=(1-(x+A))*D,Q=(v+R)*D,te=(m-k)*D,ie=(v-R)*$,ve=(1-(p+A))*$,me=(E+L)*$,Re=(m+k)*j,We=(E-L)*j,je=(1-(p+x))*j;return e[0]=W,e[1]=Q,e[2]=te,e[3]=0,e[4]=ie,e[5]=ve,e[6]=me,e[7]=0,e[8]=Re,e[9]=We,e[10]=je,e[11]=0,e[12]=t[0]+H-(W*H+ie*ee+Re*U),e[13]=t[1]+ee-(Q*H+ve*ee+We*U),e[14]=t[2]+U-(te*H+me*ee+je*U),e[15]=1,e}function Hme(e,r){var t=r[0],n=r[1],i=r[2],a=r[3],o=t+t,s=n+n,u=i+i,l=t*o,f=n*o,h=n*s,p=i*o,v=i*s,m=i*u,x=a*o,E=a*s,A=a*u;return e[0]=1-h-m,e[1]=f+A,e[2]=p-E,e[3]=0,e[4]=f-A,e[5]=1-l-m,e[6]=v+x,e[7]=0,e[8]=p+E,e[9]=v-x,e[10]=1-l-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function jme(e,r,t,n,i,a,o){var s=1/(t-r),u=1/(i-n),l=1/(a-o);return e[0]=a*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*u,e[6]=0,e[7]=0,e[8]=(t+r)*s,e[9]=(i+n)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function Mq(e,r,t,n,i){var a=1/Math.tan(r/2),o;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e}var N2=Mq;function Wme(e,r,t,n,i){var a=1/Math.tan(r/2),o;return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(n-i),e[10]=i*o,e[14]=i*n*o):(e[10]=-1,e[14]=-n),e}function Xme(e,r,t,n){var i=Math.tan(r.upDegrees*Math.PI/180),a=Math.tan(r.downDegrees*Math.PI/180),o=Math.tan(r.leftDegrees*Math.PI/180),s=Math.tan(r.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((o-s)*u*.5),e[9]=(i-a)*l*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function Lq(e,r,t,n,i,a,o){var s=1/(r-t),u=1/(n-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(r+t)*s,e[13]=(i+n)*u,e[14]=(o+a)*l,e[15]=1,e}var Yme=Lq;function Zme(e,r,t,n,i,a,o){var s=1/(r-t),u=1/(n-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=l,e[11]=0,e[12]=(r+t)*s,e[13]=(i+n)*u,e[14]=a*l,e[15]=1,e}function uI(e,r,t,n){var i,a,o,s,u,l,f,h,p,v,m=r[0],x=r[1],E=r[2],A=n[0],L=n[1],k=n[2],R=t[0],D=t[1],$=t[2];return Math.abs(m-R)<Lu&&Math.abs(x-D)<Lu&&Math.abs(E-$)<Lu?IM(e):(f=m-R,h=x-D,p=E-$,v=1/Math.hypot(f,h,p),f*=v,h*=v,p*=v,i=L*p-k*h,a=k*f-A*p,o=A*h-L*f,v=Math.hypot(i,a,o),v?(v=1/v,i*=v,a*=v,o*=v):(i=0,a=0,o=0),s=h*o-p*a,u=p*i-f*o,l=f*a-h*i,v=Math.hypot(s,u,l),v?(v=1/v,s*=v,u*=v,l*=v):(s=0,u=0,l=0),e[0]=i,e[1]=s,e[2]=f,e[3]=0,e[4]=a,e[5]=u,e[6]=h,e[7]=0,e[8]=o,e[9]=l,e[10]=p,e[11]=0,e[12]=-(i*m+a*x+o*E),e[13]=-(s*m+u*x+l*E),e[14]=-(f*m+h*x+p*E),e[15]=1,e)}function qme(e,r,t,n){var i=r[0],a=r[1],o=r[2],s=n[0],u=n[1],l=n[2],f=i-t[0],h=a-t[1],p=o-t[2],v=f*f+h*h+p*p;v>0&&(v=1/Math.sqrt(v),f*=v,h*=v,p*=v);var m=u*p-l*h,x=l*f-s*p,E=s*h-u*f;return v=m*m+x*x+E*E,v>0&&(v=1/Math.sqrt(v),m*=v,x*=v,E*=v),e[0]=m,e[1]=x,e[2]=E,e[3]=0,e[4]=h*E-p*x,e[5]=p*m-f*E,e[6]=f*x-h*m,e[7]=0,e[8]=f,e[9]=h,e[10]=p,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function Kme(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Qme(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Jme(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e[9]=r[9]+t[9],e[10]=r[10]+t[10],e[11]=r[11]+t[11],e[12]=r[12]+t[12],e[13]=r[13]+t[13],e[14]=r[14]+t[14],e[15]=r[15]+t[15],e}function Iq(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e[9]=r[9]-t[9],e[10]=r[10]-t[10],e[11]=r[11]-t[11],e[12]=r[12]-t[12],e[13]=r[13]-t[13],e[14]=r[14]-t[14],e[15]=r[15]-t[15],e}function eye(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12]*t,e[13]=r[13]*t,e[14]=r[14]*t,e[15]=r[15]*t,e}function tye(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e[9]=r[9]+t[9]*n,e[10]=r[10]+t[10]*n,e[11]=r[11]+t[11]*n,e[12]=r[12]+t[12]*n,e[13]=r[13]+t[13]*n,e[14]=r[14]+t[14]*n,e[15]=r[15]+t[15]*n,e}function rye(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function zF(e,r){var t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],f=e[8],h=e[9],p=e[10],v=e[11],m=e[12],x=e[13],E=e[14],A=e[15],L=r[0],k=r[1],R=r[2],D=r[3],$=r[4],j=r[5],H=r[6],ee=r[7],U=r[8],W=r[9],Q=r[10],te=r[11],ie=r[12],ve=r[13],me=r[14],Re=r[15];return Math.abs(t-L)<=Lu*Math.max(1,Math.abs(t),Math.abs(L))&&Math.abs(n-k)<=Lu*Math.max(1,Math.abs(n),Math.abs(k))&&Math.abs(i-R)<=Lu*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(a-D)<=Lu*Math.max(1,Math.abs(a),Math.abs(D))&&Math.abs(o-$)<=Lu*Math.max(1,Math.abs(o),Math.abs($))&&Math.abs(s-j)<=Lu*Math.max(1,Math.abs(s),Math.abs(j))&&Math.abs(u-H)<=Lu*Math.max(1,Math.abs(u),Math.abs(H))&&Math.abs(l-ee)<=Lu*Math.max(1,Math.abs(l),Math.abs(ee))&&Math.abs(f-U)<=Lu*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(h-W)<=Lu*Math.max(1,Math.abs(h),Math.abs(W))&&Math.abs(p-Q)<=Lu*Math.max(1,Math.abs(p),Math.abs(Q))&&Math.abs(v-te)<=Lu*Math.max(1,Math.abs(v),Math.abs(te))&&Math.abs(m-ie)<=Lu*Math.max(1,Math.abs(m),Math.abs(ie))&&Math.abs(x-ve)<=Lu*Math.max(1,Math.abs(x),Math.abs(ve))&&Math.abs(E-me)<=Lu*Math.max(1,Math.abs(E),Math.abs(me))&&Math.abs(A-Re)<=Lu*Math.max(1,Math.abs(A),Math.abs(Re))}var nye=ff,iye=Iq,aye=Object.freeze(Object.defineProperty({__proto__:null,create:ts,clone:sI,copy:Mme,fromValues:Eq,set:Lme,identity:IM,transpose:Ime,invert:s2,adjoint:kme,determinant:Pme,multiply:ff,translate:ih,scale:op,rotate:Rme,rotateX:m_,rotateY:g1,rotateZ:y_,fromTranslation:Sq,fromScaling:Ome,fromRotation:Fme,fromXRotation:Dme,fromYRotation:Bme,fromZRotation:Nme,fromRotationTranslation:Aq,fromQuat2:zme,getTranslation:$me,getScaling:Tq,getRotation:Ume,fromRotationTranslationScale:Vme,fromRotationTranslationScaleOrigin:Gme,fromQuat:Hme,frustum:jme,perspectiveNO:Mq,perspective:N2,perspectiveZO:Wme,perspectiveFromFieldOfView:Xme,orthoNO:Lq,ortho:Yme,orthoZO:Zme,lookAt:uI,targetTo:qme,str:Kme,frob:Qme,add:Jme,subtract:Iq,multiplyScalar:eye,multiplyScalarAndAdd:tye,exactEquals:rye,equals:zF,mul:nye,sub:iye},Symbol.toStringTag,{value:"Module"}));function O0(){var e=new Ic(3);return Ic!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function oye(e){var r=new Ic(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function kq(e){var r=e[0],t=e[1],n=e[2];return Math.hypot(r,t,n)}function Io(e,r,t){var n=new Ic(3);return n[0]=e,n[1]=r,n[2]=t,n}function sye(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function uye(e,r,t,n){return e[0]=r,e[1]=t,e[2]=n,e}function lye(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function Pq(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e}function F3(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function Rq(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e}function cye(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}function fye(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}function hye(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e}function pye(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e}function dye(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}function D3(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e}function vye(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e}function Oq(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2];return Math.hypot(t,n,i)}function Fq(e,r){var t=r[0]-e[0],n=r[1]-e[1],i=r[2]-e[2];return t*t+n*n+i*i}function Dq(e){var r=e[0],t=e[1],n=e[2];return r*r+t*t+n*n}function Bq(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function gye(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}function F0(e,r){var t=r[0],n=r[1],i=r[2],a=t*t+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=r[0]*a,e[1]=r[1]*a,e[2]=r[2]*a,e}function Nq(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function kM(e,r,t){var n=r[0],i=r[1],a=r[2],o=t[0],s=t[1],u=t[2];return e[0]=i*u-a*s,e[1]=a*o-n*u,e[2]=n*s-i*o,e}function mye(e,r,t,n){var i=r[0],a=r[1],o=r[2];return e[0]=i+n*(t[0]-i),e[1]=a+n*(t[1]-a),e[2]=o+n*(t[2]-o),e}function yye(e,r,t,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),f=o*(3-2*a);return e[0]=r[0]*s+t[0]*u+n[0]*l+i[0]*f,e[1]=r[1]*s+t[1]*u+n[1]*l+i[1]*f,e[2]=r[2]*s+t[2]*u+n[2]*l+i[2]*f,e}function _ye(e,r,t,n,i,a){var o=1-a,s=o*o,u=a*a,l=s*o,f=3*a*s,h=3*u*o,p=u*a;return e[0]=r[0]*l+t[0]*f+n[0]*h+i[0]*p,e[1]=r[1]*l+t[1]*f+n[1]*h+i[1]*p,e[2]=r[2]*l+t[2]*f+n[2]*h+i[2]*p,e}function xye(e,r){r=r||1;var t=V7()*2*Math.PI,n=V7()*2-1,i=Math.sqrt(1-n*n)*r;return e[0]=Math.cos(t)*i,e[1]=Math.sin(t)*i,e[2]=n*r,e}function Ix(e,r,t){var n=r[0],i=r[1],a=r[2],o=t[3]*n+t[7]*i+t[11]*a+t[15];return o=o||1,e[0]=(t[0]*n+t[4]*i+t[8]*a+t[12])/o,e[1]=(t[1]*n+t[5]*i+t[9]*a+t[13])/o,e[2]=(t[2]*n+t[6]*i+t[10]*a+t[14])/o,e}function u2(e,r,t){var n=r[0],i=r[1],a=r[2];return e[0]=n*t[0]+i*t[3]+a*t[6],e[1]=n*t[1]+i*t[4]+a*t[7],e[2]=n*t[2]+i*t[5]+a*t[8],e}function bye(e,r,t){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],l=r[2],f=i*l-a*u,h=a*s-n*l,p=n*u-i*s,v=i*p-a*h,m=a*f-n*p,x=n*h-i*f,E=o*2;return f*=E,h*=E,p*=E,v*=2,m*=2,x*=2,e[0]=s+f+v,e[1]=u+h+m,e[2]=l+p+x,e}function wye(e,r,t,n){var i=[],a=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function Cye(e,r,t,n){var i=[],a=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function Eye(e,r,t,n){var i=[],a=[];return i[0]=r[0]-t[0],i[1]=r[1]-t[1],i[2]=r[2]-t[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e}function $F(e,r){var t=e[0],n=e[1],i=e[2],a=r[0],o=r[1],s=r[2],u=Math.sqrt(t*t+n*n+i*i),l=Math.sqrt(a*a+o*o+s*s),f=u*l,h=f&&Nq(e,r)/f;return Math.acos(Math.min(Math.max(h,-1),1))}function Sye(e){return e[0]=0,e[1]=0,e[2]=0,e}function Aye(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Tye(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function Mye(e,r){var t=e[0],n=e[1],i=e[2],a=r[0],o=r[1],s=r[2];return Math.abs(t-a)<=Lu*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-o)<=Lu*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=Lu*Math.max(1,Math.abs(i),Math.abs(s))}var UF=Pq,Lye=F3,Iye=Rq,kye=Oq,Pye=Fq,Rye=kq,Oye=Dq,Fye=function(){var e=O0();return function(r,t,n,i,a,o){var s,u;for(t||(t=3),n||(n=0),i?u=Math.min(i*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],a(e,e,o),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2];return r}}(),Yb=Object.freeze(Object.defineProperty({__proto__:null,create:O0,clone:oye,length:kq,fromValues:Io,copy:sye,set:uye,add:lye,subtract:Pq,multiply:F3,divide:Rq,ceil:cye,floor:fye,min:hye,max:pye,round:dye,scale:D3,scaleAndAdd:vye,distance:Oq,squaredDistance:Fq,squaredLength:Dq,negate:Bq,inverse:gye,normalize:F0,dot:Nq,cross:kM,lerp:mye,hermite:yye,bezier:_ye,random:xye,transformMat4:Ix,transformMat3:u2,transformQuat:bye,rotateX:wye,rotateY:Cye,rotateZ:Eye,angle:$F,zero:Sye,str:Aye,exactEquals:Tye,equals:Mye,sub:UF,mul:Lye,div:Iye,dist:kye,sqrDist:Pye,len:Rye,sqrLen:Oye,forEach:Fye},Symbol.toStringTag,{value:"Module"}));function zq(){var e=new Ic(4);return Ic!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function $q(e,r,t,n){var i=new Ic(4);return i[0]=e,i[1]=r,i[2]=t,i[3]=n,i}function Dye(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function kx(e,r,t){var n=r[0],i=r[1],a=r[2],o=r[3];return e[0]=t[0]*n+t[4]*i+t[8]*a+t[12]*o,e[1]=t[1]*n+t[5]*i+t[9]*a+t[13]*o,e[2]=t[2]*n+t[6]*i+t[10]*a+t[14]*o,e[3]=t[3]*n+t[7]*i+t[11]*a+t[15]*o,e}(function(){var e=zq();return function(r,t,n,i,a,o){var s,u;for(t||(t=4),n||(n=0),i?u=Math.min(i*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],e[3]=r[s+3],a(e,e,o),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2],r[s+3]=e[3];return r}})();function Ba(){var e=new Ic(2);return Ic!=Float32Array&&(e[0]=0,e[1]=0),e}function l2(e,r){var t=new Ic(2);return t[0]=e,t[1]=r,t}function Vg(e,r){return e[0]=r[0],e[1]=r[1],e}function Uq(e,r,t){return e[0]=r,e[1]=t,e}function Xo(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e}function V0(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e}function Ac(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e}function Tc(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e}function ah(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e}function c2(e,r){var t=r[0]-e[0],n=r[1]-e[1];return Math.hypot(t,n)}function Hb(e){var r=e[0],t=e[1];return Math.hypot(r,t)}function Bye(e,r){return e[0]=-r[0],e[1]=-r[1],e}function Ud(e,r){var t=r[0],n=r[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=r[0]*i,e[1]=r[1]*i,e}function cy(e,r){return e[0]*r[0]+e[1]*r[1]}function Nye(e,r,t,n){var i=r[0],a=r[1];return e[0]=i+n*(t[0]-i),e[1]=a+n*(t[1]-a),e}function zye(e,r,t){var n=r[0],i=r[1];return e[0]=t[0]*n+t[3]*i+t[6],e[1]=t[1]*n+t[4]*i+t[7],e}function VF(e,r){var t=e[0],n=e[1],i=r[0],a=r[1],o=Math.sqrt(t*t+n*n)*Math.sqrt(i*i+a*a),s=o&&(t*i+n*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}function $ye(e,r){return e[0]===r[0]&&e[1]===r[1]}var Xp=V0;(function(){var e=Ba();return function(r,t,n,i,a,o){var s,u;for(t||(t=2),n||(n=0),i?u=Math.min(i*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],a(e,e,o),r[s]=e[0],r[s+1]=e[1];return r}})();function Rb(e,r,t){var n=[0,0,0,0,0,0,0,0,0];return Sme(n,t),oI(e,n,r)}function B3(e,r,t){var n=[0,0,0,0,0,0,0,0,0];return Ame(n,t),oI(e,n,r)}function Vq(e,r,t){var n=[0,0,0,0,0,0,0,0,0];return Tme(n,t),oI(e,n,r)}function Uye(e,r,t){return oI(e,t,r)}function yl(e,r){for(var t=e?[].concat(e):[1,0,0,0,1,0,0,0,1],n=0,i=r.length;n<i;n++){var a=r[n];switch(a[0]){case"t":Rb(t,t,[a[1],a[2]]);break;case"s":Vq(t,t,[a[1],a[2]]);break;case"r":B3(t,t,a[1]);break;case"m":Uye(t,t,a[1]);break}}return t}function Vye(e,r){return e[0]*r[1]-r[0]*e[1]}function N3(e,r,t){var n=VF(e,r),i=Vye(e,r)>=0;return t?i?Math.PI*2-n:n:i?n:Math.PI*2-n}function G7(e,r){var t=[],n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],f=e[7],h=e[8],p=r[0],v=r[1],m=r[2],x=r[3],E=r[4],A=r[5],L=r[6],k=r[7],R=r[8];return t[0]=p*n+v*o+m*l,t[1]=p*i+v*s+m*f,t[2]=p*a+v*u+m*h,t[3]=x*n+E*o+A*l,t[4]=x*i+E*s+A*f,t[5]=x*a+E*u+A*h,t[6]=L*n+k*o+R*l,t[7]=L*i+k*s+R*f,t[8]=L*a+k*u+R*h,t}function iy(e,r){var t=[],n=r[0],i=r[1];return t[0]=e[0]*n+e[3]*i+e[6],t[1]=e[1]*n+e[4]*i+e[7],t}function lI(e){var r=[],t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],f=e[8],h=f*o-s*l,p=-f*a+s*u,v=l*a-o*u,m=t*h+n*p+i*v;return m?(m=1/m,r[0]=h*m,r[1]=(-f*n+i*l)*m,r[2]=(s*n-i*o)*m,r[3]=p*m,r[4]=(f*t-i*u)*m,r[5]=(-s*t+i*a)*m,r[6]=v*m,r[7]=(-l*t+n*u)*m,r[8]=(o*t-n*a)*m,r):null}var Pw=yl,sR="matrix",Gye=["zIndex","capture","visible","type"],Hye=["repeat"],jye=":",Wye="*";function Xye(e){for(var r=[],t=0;t<e.length;t++)ar(e[t])?r.push([].concat(e[t])):r.push(e[t]);return r}function Yye(e,r){var t={},n=r.attrs;for(var i in e)t[i]=n[i];return t}function Zye(e,r){var t={},n=r.attr();return we(e,function(i,a){Hye.indexOf(a)===-1&&!rs(n[a],i)&&(t[a]=i)}),t}function qye(e,r){if(r.onFrame)return e;var t=r.startTime,n=r.delay,i=r.duration,a=Object.prototype.hasOwnProperty;return we(e,function(o){t+n<o.startTime+o.delay+o.duration&&i>o.delay&&we(r.toAttrs,function(s,u){a.call(o.toAttrs,u)&&(delete o.toAttrs[u],delete o.fromAttrs[u])})}),e}var Gq=function(e){B2(r,e);function r(t){var n=e.call(this,t)||this;n.attrs={};var i=n.getDefaultAttrs();return Na(i,t.attrs),n.attrs=i,n.initAttrs(i),n.initAnimate(),n}return r.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},r.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},r.prototype.onCanvasChange=function(t){},r.prototype.initAttrs=function(t){},r.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},r.prototype.isGroup=function(){return!1},r.prototype.getParent=function(){return this.get("parent")},r.prototype.getCanvas=function(){return this.get("canvas")},r.prototype.attr=function(){for(var t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=n[0],o=n[1];if(!a)return this.attrs;if(xo(a)){for(var s in a)this.setAttr(s,a[s]);return this.afterAttrsChange(a),this}return n.length===2?(this.setAttr(a,o),this.afterAttrsChange((t={},t[a]=o,t)),this):this.attrs[a]},r.prototype.isClipped=function(t,n){var i=this.getClip();return i&&!i.isHit(t,n)},r.prototype.setAttr=function(t,n){var i=this.attrs[t];i!==n&&(this.attrs[t]=n,this.onAttrChange(t,n,i))},r.prototype.onAttrChange=function(t,n,i){t==="matrix"&&this.set("totalMatrix",null)},r.prototype.afterAttrsChange=function(t){if(this.cfg.isClipShape){var n=this.cfg.applyTo;n&&n.onCanvasChange("clip")}else this.onCanvasChange("attr")},r.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},r.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},r.prototype.setZIndex=function(t){this.set("zIndex",t);var n=this.getParent();return n&&n.sort(),this},r.prototype.toFront=function(){var t=this.getParent();if(!!t){var n=t.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.push(this),this.onCanvasChange("zIndex")}},r.prototype.toBack=function(){var t=this.getParent();if(!!t){var n=t.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.unshift(this),this.onCanvasChange("zIndex")}},r.prototype.remove=function(t){t===void 0&&(t=!0);var n=this.getParent();n?(bq(n.getChildren(),this),n.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),t&&this.destroy()},r.prototype.resetMatrix=function(){this.attr(sR,this.getDefaultMatrix()),this.onCanvasChange("matrix")},r.prototype.getMatrix=function(){return this.attr(sR)},r.prototype.setMatrix=function(t){this.attr(sR,t),this.onCanvasChange("matrix")},r.prototype.getTotalMatrix=function(){var t=this.cfg.totalMatrix;if(!t){var n=this.attr("matrix"),i=this.cfg.parentMatrix;i&&n?t=G7(i,n):t=n||i,this.set("totalMatrix",t)}return t},r.prototype.applyMatrix=function(t){var n=this.attr("matrix"),i=null;t&&n?i=G7(t,n):i=n||t,this.set("totalMatrix",i),this.set("parentMatrix",t)},r.prototype.getDefaultMatrix=function(){return null},r.prototype.applyToMatrix=function(t){var n=this.attr("matrix");return n?iy(n,t):t},r.prototype.invertFromMatrix=function(t){var n=this.attr("matrix");if(n){var i=lI(n);if(i)return iy(i,t)}return t},r.prototype.setClip=function(t){var n=this.getCanvas(),i=null;if(t){var a=this.getShapeBase(),o=g_(t.type),s=a[o];s&&(i=new s({type:t.type,isClipShape:!0,applyTo:this,attrs:t.attrs,canvas:n}))}return this.set("clipShape",i),this.onCanvasChange("clip"),i},r.prototype.getClip=function(){var t=this.cfg.clipShape;return t||null},r.prototype.clone=function(){var t=this,n=this.attrs,i={};we(n,function(s,u){ar(n[u])?i[u]=Xye(n[u]):i[u]=n[u]});var a=this.constructor,o=new a({attrs:i});return we(Gye,function(s){o.set(s,t.get(s))}),o},r.prototype.destroy=function(){var t=this.destroyed;t||(this.attrs={},e.prototype.destroy.call(this))},r.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},r.prototype.animate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var i=this.get("timeline");i||(i=this.get("canvas").get("timeline"),this.set("timeline",i));var a=this.get("animations")||[];i.timer||i.initTimer();var o=t[0],s=t[1],u=t[2],l=u===void 0?"easeLinear":u,f=t[3],h=f===void 0?ny:f,p=t[4],v=p===void 0?0:p,m,x,E,A,L;kn(o)?(m=o,o={}):xo(o)&&o.onFrame&&(m=o.onFrame,x=o.repeat),xo(s)?(L=s,s=L.duration,l=L.easing||"easeLinear",v=L.delay||0,x=L.repeat||x||!1,h=L.callback||ny,E=L.pauseCallback||ny,A=L.resumeCallback||ny):(xi(h)&&(v=h,h=null),kn(l)?(h=l,l="easeLinear"):l=l||"easeLinear");var k=Zye(o,this),R={fromAttrs:Yye(k,this),toAttrs:k,duration:s,easing:l,repeat:x,callback:h,pauseCallback:E,resumeCallback:A,delay:v,startTime:i.getTime(),id:Iy(),onFrame:m,pathFormatted:!1};a.length>0?a=qye(a,R):i.addAnimator(this),a.push(R),this.set("animations",a),this.set("_pause",{isPaused:!1})}},r.prototype.stopAnimate=function(t){var n=this;t===void 0&&(t=!0);var i=this.get("animations");we(i,function(a){t&&(a.onFrame?n.attr(a.onFrame(1)):n.attr(a.toAttrs)),a.callback&&a.callback()}),this.set("animating",!1),this.set("animations",[])},r.prototype.pauseAnimate=function(){var t=this.get("timeline"),n=this.get("animations"),i=t.getTime();return we(n,function(a){a._paused=!0,a._pauseTime=i,a.pauseCallback&&a.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:i}),this},r.prototype.resumeAnimate=function(){var t=this.get("timeline"),n=t.getTime(),i=this.get("animations"),a=this.get("_pause").pauseTime;return we(i,function(o){o.startTime=o.startTime+(n-a),o._paused=!1,o._pauseTime=null,o.resumeCallback&&o.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",i),this},r.prototype.emitDelegation=function(t,n){var i=this,a=n.propagationPath;this.getEvents();var o;t==="mouseenter"?o=n.fromShape:t==="mouseleave"&&(o=n.toShape);for(var s=function(h){var p=a[h],v=p.get("name");if(v){if((p.isGroup()||p.isCanvas&&p.isCanvas())&&o&&wq(p,o))return"break";ar(v)?we(v,function(m){i.emitDelegateEvent(p,m,n)}):u.emitDelegateEvent(p,v,n)}},u=this,l=0;l<a.length;l++){var f=s(l);if(f==="break")break}},r.prototype.emitDelegateEvent=function(t,n,i){var a=this.getEvents(),o=n+jye+i.type;(a[o]||a[Wye])&&(i.name=o,i.currentTarget=t,i.delegateTarget=this,i.delegateObject=t.get("delegateObject"),this.emit(o,i))},r.prototype.translate=function(t,n){t===void 0&&(t=0),n===void 0&&(n=0);var i=this.getMatrix(),a=Pw(i,[["t",t,n]]);return this.setMatrix(a),this},r.prototype.move=function(t,n){var i=this.attr("x")||0,a=this.attr("y")||0;return this.translate(t-i,n-a),this},r.prototype.moveTo=function(t,n){return this.move(t,n)},r.prototype.scale=function(t,n){var i=this.getMatrix(),a=Pw(i,[["s",t,n||t]]);return this.setMatrix(a),this},r.prototype.rotate=function(t){var n=this.getMatrix(),i=Pw(n,[["r",t]]);return this.setMatrix(i),this},r.prototype.rotateAtStart=function(t){var n=this.attr(),i=n.x,a=n.y,o=this.getMatrix(),s=Pw(o,[["t",-i,-a],["r",t],["t",i,a]]);return this.setMatrix(s),this},r.prototype.rotateAtPoint=function(t,n,i){var a=this.getMatrix(),o=Pw(a,[["t",-t,-n],["r",i],["t",t,n]]);return this.setMatrix(o),this},r}(aI),H7={},GF="_INDEX";function Hq(e,r){if(e.set("canvas",r),e.isGroup()){var t=e.get("children");t.length&&t.forEach(function(n){Hq(n,r)})}}function jq(e,r){if(e.set("timeline",r),e.isGroup()){var t=e.get("children");t.length&&t.forEach(function(n){jq(n,r)})}}function Kye(e,r,t){t===void 0&&(t=!0),t?r.destroy():(r.set("parent",null),r.set("canvas",null)),bq(e.getChildren(),r)}function Qye(e){return function(r,t){var n=e(r,t);return n===0?r[GF]-t[GF]:n}}var Wq=function(e){B2(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.isCanvas=function(){return!1},r.prototype.getBBox=function(){var t=1/0,n=-1/0,i=1/0,a=-1/0,o=[],s=[],u=this.getChildren().filter(function(f){return f.get("visible")&&(!f.isGroup()||f.isGroup()&&f.getChildren().length>0)});u.length>0?(we(u,function(f){var h=f.getBBox();o.push(h.minX,h.maxX),s.push(h.minY,h.maxY)}),t=oh(o),n=Ff(o),i=oh(s),a=Ff(s)):(t=0,n=0,i=0,a=0);var l={x:t,y:i,minX:t,minY:i,maxX:n,maxY:a,width:n-t,height:a-i};return l},r.prototype.getCanvasBBox=function(){var t=1/0,n=-1/0,i=1/0,a=-1/0,o=[],s=[],u=this.getChildren().filter(function(f){return f.get("visible")&&(!f.isGroup()||f.isGroup()&&f.getChildren().length>0)});u.length>0?(we(u,function(f){var h=f.getCanvasBBox();o.push(h.minX,h.maxX),s.push(h.minY,h.maxY)}),t=oh(o),n=Ff(o),i=oh(s),a=Ff(s)):(t=0,n=0,i=0,a=0);var l={x:t,y:i,minX:t,minY:i,maxX:n,maxY:a,width:n-t,height:a-i};return l},r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.children=[],t},r.prototype.onAttrChange=function(t,n,i){if(e.prototype.onAttrChange.call(this,t,n,i),t==="matrix"){var a=this.getTotalMatrix();this._applyChildrenMarix(a)}},r.prototype.applyMatrix=function(t){var n=this.getTotalMatrix();e.prototype.applyMatrix.call(this,t);var i=this.getTotalMatrix();i!==n&&this._applyChildrenMarix(i)},r.prototype._applyChildrenMarix=function(t){var n=this.getChildren();we(n,function(i){i.applyMatrix(t)})},r.prototype.addShape=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t[0],a=t[1];xo(i)?a=i:a.type=i;var o=H7[a.type];o||(o=g_(a.type),H7[a.type]=o);var s=this.getShapeBase(),u=new s[o](a);return this.add(u),u},r.prototype.addGroup=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t[0],a=t[1],o;if(kn(i))a?o=new i(a):o=new i({parent:this});else{var s=i||{},u=this.getGroupBase();o=new u(s)}return this.add(o),o},r.prototype.getCanvas=function(){var t;return this.isCanvas()?t=this:t=this.get("canvas"),t},r.prototype.getShape=function(t,n,i){if(!nE(this))return null;var a=this.getChildren(),o;if(this.isCanvas())o=this._findShape(a,t,n,i);else{var s=[t,n,1];s=this.invertFromMatrix(s),this.isClipped(s[0],s[1])||(o=this._findShape(a,s[0],s[1],i))}return o},r.prototype._findShape=function(t,n,i,a){for(var o=null,s=t.length-1;s>=0;s--){var u=t[s];if(nE(u)&&(u.isGroup()?o=u.getShape(n,i,a):u.isHit(n,i)&&(o=u)),o)break}return o},r.prototype.add=function(t){var n=this.getCanvas(),i=this.getChildren(),a=this.get("timeline"),o=t.getParent();o&&Kye(o,t,!1),t.set("parent",this),n&&Hq(t,n),a&&jq(t,a),i.push(t),t.onCanvasChange("add"),this._applyElementMatrix(t)},r.prototype._applyElementMatrix=function(t){var n=this.getTotalMatrix();n&&t.applyMatrix(n)},r.prototype.getChildren=function(){return this.get("children")},r.prototype.sort=function(){var t=this.getChildren();we(t,function(n,i){return n[GF]=i,n}),t.sort(Qye(function(n,i){return n.get("zIndex")-i.get("zIndex")})),this.onCanvasChange("sort")},r.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var t=this.getChildren(),n=t.length-1;n>=0;n--)t[n].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},r.prototype.destroy=function(){this.get("destroyed")||(this.clear(),e.prototype.destroy.call(this))},r.prototype.getFirst=function(){return this.getChildByIndex(0)},r.prototype.getLast=function(){var t=this.getChildren();return this.getChildByIndex(t.length-1)},r.prototype.getChildByIndex=function(t){var n=this.getChildren();return n[t]},r.prototype.getCount=function(){var t=this.getChildren();return t.length},r.prototype.contain=function(t){var n=this.getChildren();return n.indexOf(t)>-1},r.prototype.removeChild=function(t,n){n===void 0&&(n=!0),this.contain(t)&&t.remove(n)},r.prototype.findAll=function(t){var n=[],i=this.getChildren();return we(i,function(a){t(a)&&n.push(a),a.isGroup()&&(n=n.concat(a.findAll(t)))}),n},r.prototype.find=function(t){var n=null,i=this.getChildren();return we(i,function(a){if(t(a)?n=a:a.isGroup()&&(n=a.find(t)),n)return!1}),n},r.prototype.findById=function(t){return this.find(function(n){return n.get("id")===t})},r.prototype.findByClassName=function(t){return this.find(function(n){return n.get("className")===t})},r.prototype.findAllByName=function(t){return this.findAll(function(n){return n.get("name")===t})},r}(Gq),f2=0,mC=0,Rw=0,Xq=1e3,PM,yC,RM=0,qx=0,cI=0,iE=typeof performance=="object"&&performance.now?performance:Date,Yq=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Zq(){return qx||(Yq(Jye),qx=iE.now()+cI)}function Jye(){qx=0}function HF(){this._call=this._time=this._next=null}HF.prototype=qq.prototype={constructor:HF,restart:function(e,r,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?Zq():+t)+(r==null?0:+r),!this._next&&yC!==this&&(yC?yC._next=this:PM=this,yC=this),this._call=e,this._time=t,jF()},stop:function(){this._call&&(this._call=null,this._time=1/0,jF())}};function qq(e,r,t){var n=new HF;return n.restart(e,r,t),n}function e0e(){Zq(),++f2;for(var e=PM,r;e;)(r=qx-e._time)>=0&&e._call.call(null,r),e=e._next;--f2}function j7(){qx=(RM=iE.now())+cI,f2=mC=0;try{e0e()}finally{f2=0,r0e(),qx=0}}function t0e(){var e=iE.now(),r=e-RM;r>Xq&&(cI-=r,RM=e)}function r0e(){for(var e,r=PM,t,n=1/0;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:PM=t);yC=e,jF(n)}function jF(e){if(!f2){mC&&(mC=clearTimeout(mC));var r=e-qx;r>24?(e<1/0&&(mC=setTimeout(j7,e-iE.now()-cI)),Rw&&(Rw=clearInterval(Rw))):(Rw||(RM=iE.now(),Rw=setInterval(t0e,Xq)),f2=1,Yq(j7))}}function z3(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function Kq(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function hS(){}var aE=.7,OM=1/aE,Zb="\\s*([+-]?\\d+)\\s*",oE="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",n0e=/^#([0-9a-f]{3,8})$/,i0e=new RegExp("^rgb\\("+[Zb,Zb,Zb]+"\\)$"),a0e=new RegExp("^rgb\\("+[Xg,Xg,Xg]+"\\)$"),o0e=new RegExp("^rgba\\("+[Zb,Zb,Zb,oE]+"\\)$"),s0e=new RegExp("^rgba\\("+[Xg,Xg,Xg,oE]+"\\)$"),u0e=new RegExp("^hsl\\("+[oE,Xg,Xg]+"\\)$"),l0e=new RegExp("^hsla\\("+[oE,Xg,Xg,oE]+"\\)$"),W7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};z3(hS,q0,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:X7,formatHex:X7,formatHsl:c0e,formatRgb:Y7,toString:Y7});function X7(){return this.rgb().formatHex()}function c0e(){return Qq(this).formatHsl()}function Y7(){return this.rgb().formatRgb()}function q0(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=n0e.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?Z7(r):t===3?new Wp(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?LA(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?LA(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=i0e.exec(e))?new Wp(r[1],r[2],r[3],1):(r=a0e.exec(e))?new Wp(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=o0e.exec(e))?LA(r[1],r[2],r[3],r[4]):(r=s0e.exec(e))?LA(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=u0e.exec(e))?Q7(r[1],r[2]/100,r[3]/100,1):(r=l0e.exec(e))?Q7(r[1],r[2]/100,r[3]/100,r[4]):W7.hasOwnProperty(e)?Z7(W7[e]):e==="transparent"?new Wp(NaN,NaN,NaN,0):null}function Z7(e){return new Wp(e>>16&255,e>>8&255,e&255,1)}function LA(e,r,t,n){return n<=0&&(e=r=t=NaN),new Wp(e,r,t,n)}function f0e(e){return e instanceof hS||(e=q0(e)),e?(e=e.rgb(),new Wp(e.r,e.g,e.b,e.opacity)):new Wp}function FM(e,r,t,n){return arguments.length===1?f0e(e):new Wp(e,r,t,n==null?1:n)}function Wp(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}z3(Wp,FM,Kq(hS,{brighter:function(e){return e=e==null?OM:Math.pow(OM,e),new Wp(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?aE:Math.pow(aE,e),new Wp(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:q7,formatHex:q7,formatRgb:K7,toString:K7}));function q7(){return"#"+uR(this.r)+uR(this.g)+uR(this.b)}function K7(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function uR(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Q7(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new Gg(e,r,t,n)}function Qq(e){if(e instanceof Gg)return new Gg(e.h,e.s,e.l,e.opacity);if(e instanceof hS||(e=q0(e)),!e)return new Gg;if(e instanceof Gg)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,i=Math.min(r,t,n),a=Math.max(r,t,n),o=NaN,s=a-i,u=(a+i)/2;return s?(r===a?o=(t-n)/s+(t<n)*6:t===a?o=(n-r)/s+2:o=(r-t)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Gg(o,s,u,e.opacity)}function h0e(e,r,t,n){return arguments.length===1?Qq(e):new Gg(e,r,t,n==null?1:n)}function Gg(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}z3(Gg,h0e,Kq(hS,{brighter:function(e){return e=e==null?OM:Math.pow(OM,e),new Gg(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?aE:Math.pow(aE,e),new Gg(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*r,i=2*t-n;return new Wp(lR(e>=240?e-240:e+120,i,n),lR(e,i,n),lR(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function lR(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}function p0e(e,r,t,n,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*r+(4-6*a+3*o)*t+(1+3*e+3*a-3*o)*n+o*i)/6}function d0e(e){var r=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,r-1):Math.floor(t*r),i=e[n],a=e[n+1],o=n>0?e[n-1]:2*i-a,s=n<r-1?e[n+2]:2*a-i;return p0e((t-n/r)*r,o,i,a,s)}}function $3(e){return function(){return e}}function v0e(e,r){return function(t){return e+t*r}}function g0e(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function m0e(e){return(e=+e)==1?Jq:function(r,t){return t-r?g0e(r,t,e):$3(isNaN(r)?t:r)}}function Jq(e,r){var t=r-e;return t?v0e(e,t):$3(isNaN(e)?r:e)}var J7=function e(r){var t=m0e(r);function n(i,a){var o=t((i=FM(i)).r,(a=FM(a)).r),s=t(i.g,a.g),u=t(i.b,a.b),l=Jq(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=s(f),i.b=u(f),i.opacity=l(f),i+""}}return n.gamma=e,n}(1);function y0e(e){return function(r){var t=r.length,n=new Array(t),i=new Array(t),a=new Array(t),o,s;for(o=0;o<t;++o)s=FM(r[o]),n[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return n=e(n),i=e(i),a=e(a),s.opacity=1,function(u){return s.r=n(u),s.g=i(u),s.b=a(u),s+""}}}var _0e=y0e(d0e);function eK(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),i;return function(a){for(i=0;i<t;++i)n[i]=e[i]*(1-a)+r[i]*a;return n}}function tK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function x0e(e,r){return(tK(r)?eK:rK)(e,r)}function rK(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,i=new Array(n),a=new Array(t),o;for(o=0;o<n;++o)i[o]=sE(e[o],r[o]);for(;o<t;++o)a[o]=r[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function b0e(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}}function DM(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}function w0e(e,r){var t={},n={},i;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(i in r)i in e?t[i]=sE(e[i],r[i]):n[i]=r[i];return function(a){for(i in t)n[i]=t[i](a);return n}}var WF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cR=new RegExp(WF.source,"g");function C0e(e){return function(){return e}}function E0e(e){return function(r){return e(r)+""}}function S0e(e,r){var t=WF.lastIndex=cR.lastIndex=0,n,i,a,o=-1,s=[],u=[];for(e=e+"",r=r+"";(n=WF.exec(e))&&(i=cR.exec(r));)(a=i.index)>t&&(a=r.slice(t,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:DM(n,i)})),t=cR.lastIndex;return t<r.length&&(a=r.slice(t),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?E0e(u[0].x):C0e(r):(r=u.length,function(l){for(var f=0,h;f<r;++f)s[(h=u[f]).i]=h.x(l);return s.join("")})}function sE(e,r){var t=typeof r,n;return r==null||t==="boolean"?$3(r):(t==="number"?DM:t==="string"?(n=q0(r))?(r=n,J7):S0e:r instanceof q0?J7:r instanceof Date?b0e:tK(r)?eK:Array.isArray(r)?rK:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?w0e:DM)(e,r)}function A0e(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}}function T0e(e){return+e}function M0e(e){return e*e}function L0e(e){return e*(2-e)}function e8(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function I0e(e){return e*e*e}function k0e(e){return--e*e*e+1}function t8(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var U3=3,P0e=function e(r){r=+r;function t(n){return Math.pow(n,r)}return t.exponent=e,t}(U3),R0e=function e(r){r=+r;function t(n){return 1-Math.pow(1-n,r)}return t.exponent=e,t}(U3),r8=function e(r){r=+r;function t(n){return((n*=2)<=1?Math.pow(n,r):2-Math.pow(2-n,r))/2}return t.exponent=e,t}(U3),nK=Math.PI,iK=nK/2;function O0e(e){return+e==1?1:1-Math.cos(e*iK)}function F0e(e){return Math.sin(e*iK)}function n8(e){return(1-Math.cos(nK*e))/2}function K0(e){return(Math.pow(2,-10*e)-.0009765625)*1.0009775171065494}function D0e(e){return K0(1-+e)}function B0e(e){return 1-K0(e)}function i8(e){return((e*=2)<=1?K0(1-e):2-K0(e-1))/2}function N0e(e){return 1-Math.sqrt(1-e*e)}function z0e(e){return Math.sqrt(1- --e*e)}function a8(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var XF=4/11,$0e=6/11,U0e=8/11,V0e=3/4,G0e=9/11,H0e=10/11,j0e=15/16,W0e=21/22,X0e=63/64,IA=1/XF/XF;function Y0e(e){return 1-uE(1-e)}function uE(e){return(e=+e)<XF?IA*e*e:e<U0e?IA*(e-=$0e)*e+V0e:e<H0e?IA*(e-=G0e)*e+j0e:IA*(e-=W0e)*e+X0e}function Z0e(e){return((e*=2)<=1?1-uE(1-e):uE(e-1)+1)/2}var V3=1.70158,q0e=function e(r){r=+r;function t(n){return(n=+n)*n*(r*(n-1)+n)}return t.overshoot=e,t}(V3),K0e=function e(r){r=+r;function t(n){return--n*n*((n+1)*r+n)+1}return t.overshoot=e,t}(V3),o8=function e(r){r=+r;function t(n){return((n*=2)<1?n*n*((r+1)*n-r):(n-=2)*n*((r+1)*n+r)+2)/2}return t.overshoot=e,t}(V3),h2=2*Math.PI,G3=1,H3=.3,Q0e=function e(r,t){var n=Math.asin(1/(r=Math.max(1,r)))*(t/=h2);function i(a){return r*K0(- --a)*Math.sin((n-a)/t)}return i.amplitude=function(a){return e(a,t*h2)},i.period=function(a){return e(r,a)},i}(G3,H3),s8=function e(r,t){var n=Math.asin(1/(r=Math.max(1,r)))*(t/=h2);function i(a){return 1-r*K0(a=+a)*Math.sin((a+n)/t)}return i.amplitude=function(a){return e(a,t*h2)},i.period=function(a){return e(r,a)},i}(G3,H3),J0e=function e(r,t){var n=Math.asin(1/(r=Math.max(1,r)))*(t/=h2);function i(a){return((a=a*2-1)<0?r*K0(-a)*Math.sin((n-a)/t):2-r*K0(a)*Math.sin((n+a)/t))/2}return i.amplitude=function(a){return e(a,t*h2)},i.period=function(a){return e(r,a)},i}(G3,H3),e_e=Object.freeze(Object.defineProperty({__proto__:null,easeLinear:T0e,easeQuad:e8,easeQuadIn:M0e,easeQuadOut:L0e,easeQuadInOut:e8,easeCubic:t8,easeCubicIn:I0e,easeCubicOut:k0e,easeCubicInOut:t8,easePoly:r8,easePolyIn:P0e,easePolyOut:R0e,easePolyInOut:r8,easeSin:n8,easeSinIn:O0e,easeSinOut:F0e,easeSinInOut:n8,easeExp:i8,easeExpIn:D0e,easeExpOut:B0e,easeExpInOut:i8,easeCircle:a8,easeCircleIn:N0e,easeCircleOut:z0e,easeCircleInOut:a8,easeBounce:uE,easeBounceIn:Y0e,easeBounceOut:uE,easeBounceInOut:Z0e,easeBack:o8,easeBackIn:q0e,easeBackOut:K0e,easeBackInOut:o8,easeElastic:s8,easeElasticIn:Q0e,easeElasticOut:s8,easeElasticInOut:J0e},Symbol.toStringTag,{value:"Module"})),aK={};function t_e(e){return aK[e.toLowerCase()]||e_e[e]}function oK(e,r){aK[e.toLowerCase()]=r}var r_e=function(e){return["fill","stroke","fillStyle","strokeStyle"].includes(e)},n_e=function(e){return/^[r,R,L,l]{1}[\s]*\(/.test(e)},u8=[1,0,0,0,1,0,0,0,1];function i_e(e,r,t){var n={},i=r.fromAttrs,a=r.toAttrs;if(!e.destroyed){var o;for(var s in a)if(!rs(i[s],a[s]))if(s==="path"){var u=a[s],l=i[s];u.length>l.length?(u=Gb(a[s]),l=Gb(i[s]),l=_q(l,u),l=BF(l,u),r.fromAttrs.path=l,r.toAttrs.path=u):r.pathFormatted||(u=Gb(a[s]),l=Gb(i[s]),l=BF(l,u),r.fromAttrs.path=l,r.toAttrs.path=u,r.pathFormatted=!0),n[s]=[];for(var f=0;f<u.length;f++){for(var h=u[f],p=l[f],v=[],m=0;m<h.length;m++)xi(h[m])&&p&&xi(p[m])?(o=sE(p[m],h[m]),v.push(o(t))):v.push(h[m]);n[s].push(v)}}else if(s==="matrix"){var x=x0e(i[s]||u8,a[s]||u8),E=x(t);n[s]=E}else r_e(s)&&n_e(a[s])?n[s]=a[s]:kn(a[s])||(o=sE(i[s],a[s]),n[s]=o(t));e.attr(n)}}function a_e(e,r,t){var n=r.startTime,i=r.delay;if(t<n+i||r._paused)return!1;var a,o=r.duration,s=r.easing,u=t_e(s);if(t=t-n-r.delay,r.repeat)a=t%o/o,a=u(a);else if(a=t/o,a<1)a=u(a);else return r.onFrame?e.attr(r.onFrame(1)):e.attr(r.toAttrs),!0;if(r.onFrame){var l=r.onFrame(a);e.attr(l)}else i_e(e,r,a);return!1}var o_e=function(){function e(r){this.animators=[],this.current=0,this.timer=null,this.canvas=r}return e.prototype.initTimer=function(){var r=this,t=!1,n,i,a;this.timer=qq(function(o){if(r.current=o,r.animators.length>0){for(var s=r.animators.length-1;s>=0;s--){if(n=r.animators[s],n.destroyed){r.removeAnimator(s);continue}if(!n.isAnimatePaused()){i=n.get("animations");for(var u=i.length-1;u>=0;u--)a=i[u],t=a_e(n,a,o),t&&(i.splice(u,1),t=!1,a.callback&&a.callback())}i.length===0&&r.removeAnimator(s)}var l=r.canvas.get("autoDraw");l||r.canvas.draw()}})},e.prototype.addAnimator=function(r){this.animators.push(r)},e.prototype.removeAnimator=function(r){this.animators.splice(r,1)},e.prototype.isAnimating=function(){return!!this.animators.length},e.prototype.stop=function(){this.timer&&this.timer.stop()},e.prototype.stopAllAnimations=function(r){r===void 0&&(r=!0),this.animators.forEach(function(t){t.stopAnimate(r)}),this.animators=[],this.canvas.draw()},e.prototype.getTime=function(){return this.current},e}(),s_e=40,l8=0,c8=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function f8(e,r,t){t.name=r,t.target=e,t.currentTarget=e,t.delegateTarget=e,e.emit(r,t)}function u_e(e,r,t){if(t.bubbles){var n=void 0,i=!1;if(r==="mouseenter"?(n=t.fromShape,i=!0):r==="mouseleave"&&(i=!0,n=t.toShape),e.isCanvas()&&i)return;if(n&&wq(e,n)){t.bubbles=!1;return}t.name=r,t.currentTarget=e,t.delegateTarget=e,e.emit(r,t)}}var l_e=function(){function e(r){var t=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(n){var i=n.type;t._triggerEvent(i,n)},this._onDocumentMove=function(n){var i=t.canvas,a=i.get("el");if(a!==n.target&&(t.dragging||t.currentShape)){var o=t._getPointInfo(n);t.dragging&&t._emitEvent("drag",n,o,t.draggingShape)}},this._onDocumentMouseUp=function(n){var i=t.canvas,a=i.get("el");if(a!==n.target&&t.dragging){var o=t._getPointInfo(n);t.draggingShape&&t._emitEvent("drop",n,o,null),t._emitEvent("dragend",n,o,t.draggingShape),t._afterDrag(t.draggingShape,o,n)}},this.canvas=r.canvas}return e.prototype.init=function(){this._bindEvents()},e.prototype._bindEvents=function(){var r=this,t=this.canvas.get("el");we(c8,function(n){t.addEventListener(n,r._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._clearEvents=function(){var r=this,t=this.canvas.get("el");we(c8,function(n){t.removeEventListener(n,r._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._getEventObj=function(r,t,n,i,a,o){var s=new fS(r,t);return s.fromShape=a,s.toShape=o,s.x=n.x,s.y=n.y,s.clientX=n.clientX,s.clientY=n.clientY,s.propagationPath.push(i),s},e.prototype._getShape=function(r,t){return this.canvas.getShape(r.x,r.y,t)},e.prototype._getPointInfo=function(r){var t=this.canvas,n=t.getClientByEvent(r),i=t.getPointByEvent(r);return{x:i.x,y:i.y,clientX:n.x,clientY:n.y}},e.prototype._triggerEvent=function(r,t){var n=this._getPointInfo(t),i=this._getShape(n,t),a=this["_on"+r],o=!1;if(a)a.call(this,n,i,t);else{var s=this.currentShape;r==="mouseenter"||r==="dragenter"||r==="mouseover"?(this._emitEvent(r,t,n,null,null,i),i&&this._emitEvent(r,t,n,i,null,i),r==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",t,n,null)):r==="mouseleave"||r==="dragleave"||r==="mouseout"?(o=!0,s&&this._emitEvent(r,t,n,s,s,null),this._emitEvent(r,t,n,null,s,null),r==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",t,n,null)):this._emitEvent(r,t,n,i,null,null)}if(o||(this.currentShape=i),i&&!i.get("destroyed")){var u=this.canvas,l=u.get("el");l.style.cursor=i.attr("cursor")||u.get("cursor")}},e.prototype._onmousedown=function(r,t,n){n.button===l8&&(this.mousedownShape=t,this.mousedownPoint=r,this.mousedownTimeStamp=n.timeStamp),this._emitEvent("mousedown",n,r,t,null,null)},e.prototype._emitMouseoverEvents=function(r,t,n,i){var a=this.canvas.get("el");n!==i&&(n&&(this._emitEvent("mouseout",r,t,n,n,i),this._emitEvent("mouseleave",r,t,n,n,i),(!i||i.get("destroyed"))&&(a.style.cursor=this.canvas.get("cursor"))),i&&(this._emitEvent("mouseover",r,t,i,n,i),this._emitEvent("mouseenter",r,t,i,n,i)))},e.prototype._emitDragoverEvents=function(r,t,n,i,a){i?(i!==n&&(n&&this._emitEvent("dragleave",r,t,n,n,i),this._emitEvent("dragenter",r,t,i,n,i)),a||this._emitEvent("dragover",r,t,i)):n&&this._emitEvent("dragleave",r,t,n,n,i),a&&this._emitEvent("dragover",r,t,i)},e.prototype._afterDrag=function(r,t,n){r&&(r.set("capture",!0),this.draggingShape=null),this.dragging=!1;var i=this._getShape(t,n);i!==r&&this._emitMouseoverEvents(n,t,r,i),this.currentShape=i},e.prototype._onmouseup=function(r,t,n){if(n.button===l8){var i=this.draggingShape;this.dragging?(i&&this._emitEvent("drop",n,r,t),this._emitEvent("dragend",n,r,i),this._afterDrag(i,r,n)):(this._emitEvent("mouseup",n,r,t),t===this.mousedownShape&&this._emitEvent("click",n,r,t),this.mousedownShape=null,this.mousedownPoint=null)}},e.prototype._ondragover=function(r,t,n){n.preventDefault();var i=this.currentShape;this._emitDragoverEvents(n,r,i,t,!0)},e.prototype._onmousemove=function(r,t,n){var i=this.canvas,a=this.currentShape,o=this.draggingShape;if(this.dragging)o&&this._emitDragoverEvents(n,r,a,t,!1),this._emitEvent("drag",n,r,o);else{var s=this.mousedownPoint;if(s){var u=this.mousedownShape,l=n.timeStamp,f=l-this.mousedownTimeStamp,h=s.clientX-r.clientX,p=s.clientY-r.clientY,v=h*h+p*p;f>120||v>s_e?u&&u.get("draggable")?(o=this.mousedownShape,o.set("capture",!1),this.draggingShape=o,this.dragging=!0,this._emitEvent("dragstart",n,r,o),this.mousedownShape=null,this.mousedownPoint=null):!u&&i.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",n,r,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(n,r,a,t),this._emitEvent("mousemove",n,r,t)):(this._emitMouseoverEvents(n,r,a,t),this._emitEvent("mousemove",n,r,t))}else this._emitMouseoverEvents(n,r,a,t),this._emitEvent("mousemove",n,r,t)}},e.prototype._emitEvent=function(r,t,n,i,a,o){var s=this._getEventObj(r,t,n,i,a,o);if(i){s.shape=i,f8(i,r,s);for(var u=i.getParent();u;)u.emitDelegation(r,s),s.propagationStopped||u_e(u,r,s),s.propagationPath.push(u),u=u.getParent()}else{var l=this.canvas;f8(l,r,s)}},e.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},e}(),h8="px",p8=Cq(),c_e=p8&&p8.name==="firefox",fI=function(e){B2(r,e);function r(t){var n=e.call(this,t)||this;return n.initContainer(),n.initDom(),n.initEvents(),n.initTimeline(),n}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.cursor="default",t.supportCSSTransform=!1,t},r.prototype.initContainer=function(){var t=this.get("container");ei(t)&&(t=document.getElementById(t),this.set("container",t))},r.prototype.initDom=function(){var t=this.createDom();this.set("el",t);var n=this.get("container");n.appendChild(t),this.setDOMSize(this.get("width"),this.get("height"))},r.prototype.initEvents=function(){var t=new l_e({canvas:this});t.init(),this.set("eventController",t)},r.prototype.initTimeline=function(){var t=new o_e(this);this.set("timeline",t)},r.prototype.setDOMSize=function(t,n){var i=this.get("el");B7&&(i.style.width=t+h8,i.style.height=n+h8)},r.prototype.changeSize=function(t,n){this.setDOMSize(t,n),this.set("width",t),this.set("height",n),this.onCanvasChange("changeSize")},r.prototype.getRenderer=function(){return this.get("renderer")},r.prototype.getCursor=function(){return this.get("cursor")},r.prototype.setCursor=function(t){this.set("cursor",t);var n=this.get("el");B7&&n&&(n.style.cursor=t)},r.prototype.getPointByEvent=function(t){var n=this.get("supportCSSTransform");if(n){if(c_e&&!rr(t.layerX)&&t.layerX!==t.offsetX)return{x:t.layerX,y:t.layerY};if(!rr(t.offsetX))return{x:t.offsetX,y:t.offsetY}}var i=this.getClientByEvent(t),a=i.x,o=i.y;return this.getPointByClient(a,o)},r.prototype.getClientByEvent=function(t){var n=t;return t.touches&&(t.type==="touchend"?n=t.changedTouches[0]:n=t.touches[0]),{x:n.clientX,y:n.clientY}},r.prototype.getPointByClient=function(t,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:t-a.left,y:n-a.top}},r.prototype.getClientByPoint=function(t,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:t+a.left,y:n+a.top}},r.prototype.draw=function(){},r.prototype.removeDom=function(){var t=this.get("el");t.parentNode.removeChild(t)},r.prototype.clearEvents=function(){var t=this.get("eventController");t.destroy()},r.prototype.isCanvas=function(){return!0},r.prototype.getParent=function(){return null},r.prototype.destroy=function(){var t=this.get("timeline");this.get("destroyed")||(this.clear(),t&&t.stop(),this.clearEvents(),this.removeDom(),e.prototype.destroy.call(this))},r}(Wq),hI=function(e){B2(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.isGroup=function(){return!0},r.prototype.isEntityGroup=function(){return!1},r.prototype.clone=function(){for(var t=e.prototype.clone.call(this),n=this.getChildren(),i=0;i<n.length;i++){var a=n[i];t.add(a.clone())}return t},r}(Wq),pI=function(e){B2(r,e);function r(t){return e.call(this,t)||this}return r.prototype._isInBBox=function(t,n){var i=this.getBBox();return i.minX<=t&&i.maxX>=t&&i.minY<=n&&i.maxY>=n},r.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t),this.clearCacheBBox()},r.prototype.getBBox=function(){var t=this.cfg.bbox;return t||(t=this.calculateBBox(),this.set("bbox",t)),t},r.prototype.getCanvasBBox=function(){var t=this.cfg.canvasBBox;return t||(t=this.calculateCanvasBBox(),this.set("canvasBBox",t)),t},r.prototype.applyMatrix=function(t){e.prototype.applyMatrix.call(this,t),this.set("canvasBBox",null)},r.prototype.calculateCanvasBBox=function(){var t=this.getBBox(),n=this.getTotalMatrix(),i=t.minX,a=t.minY,o=t.maxX,s=t.maxY;if(n){var u=iy(n,[t.minX,t.minY]),l=iy(n,[t.maxX,t.minY]),f=iy(n,[t.minX,t.maxY]),h=iy(n,[t.maxX,t.maxY]);i=Math.min(u[0],l[0],f[0],h[0]),o=Math.max(u[0],l[0],f[0],h[0]),a=Math.min(u[1],l[1],f[1],h[1]),s=Math.max(u[1],l[1],f[1],h[1])}var p=this.attrs;if(p.shadowColor){var v=p.shadowBlur,m=v===void 0?0:v,x=p.shadowOffsetX,E=x===void 0?0:x,A=p.shadowOffsetY,L=A===void 0?0:A,k=i-m+E,R=o+m+E,D=a-m+L,$=s+m+L;i=Math.min(i,k),o=Math.max(o,R),a=Math.min(a,D),s=Math.max(s,$)}return{x:i,y:a,minX:i,minY:a,maxX:o,maxY:s,width:o-i,height:s-a}},r.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},r.prototype.isClipShape=function(){return this.get("isClipShape")},r.prototype.isInShape=function(t,n){return!1},r.prototype.isOnlyHitBox=function(){return!1},r.prototype.isHit=function(t,n){var i=this.get("startArrowShape"),a=this.get("endArrowShape"),o=[t,n,1];o=this.invertFromMatrix(o);var s=o[0],u=o[1],l=this._isInBBox(s,u);return this.isOnlyHitBox()?l:!!(l&&!this.isClipped(s,u)&&(this.isInShape(s,u)||i&&i.isHit(s,u)||a&&a.isHit(s,u)))},r}(Gq),sK=new Map;function qd(e,r){sK.set(e,r)}function dI(e){return sK.get(e)}function uK(e){var r=e.attr(),t=r.x,n=r.y,i=r.width,a=r.height;return{x:t,y:n,width:i,height:a}}function lK(e){var r=e.attr(),t=r.x,n=r.y,i=r.r;return{x:t-i,y:n-i,width:i*2,height:i*2}}function d8(e){return Math.min.apply(null,e)}function v8(e){return Math.max.apply(null,e)}function Bf(e,r,t,n){var i=e-t,a=r-n;return Math.sqrt(i*i+a*a)}function qT(e,r){return Math.abs(e-r)<.001}function z2(e,r){var t=d8(e),n=d8(r),i=v8(e),a=v8(r);return{x:t,y:n,width:i-t,height:a-n}}function vI(e){return(e+Math.PI*2)%(Math.PI*2)}var Mc={box:function(e,r,t,n){return z2([e,t],[r,n])},length:function(e,r,t,n){return Bf(e,r,t,n)},pointAt:function(e,r,t,n,i){return{x:(1-i)*e+i*t,y:(1-i)*r+i*n}},pointDistance:function(e,r,t,n,i,a){var o=(t-e)*(i-e)+(n-r)*(a-r);if(o<0)return Bf(e,r,i,a);var s=(t-e)*(t-e)+(n-r)*(n-r);return o>s?Bf(t,n,i,a):this.pointToLine(e,r,t,n,i,a)},pointToLine:function(e,r,t,n,i,a){var o=[t-e,n-r];if($ye(o,[0,0]))return Math.sqrt((i-e)*(i-e)+(a-r)*(a-r));var s=[-o[1],o[0]];Ud(s,s);var u=[i-e,a-r];return Math.abs(cy(u,s))},tangentAngle:function(e,r,t,n){return Math.atan2(n-r,t-e)}},f_e=1e-4;function cK(e,r,t,n,i,a){var o,s=1/0,u=[t,n],l=20;a&&a>200&&(l=a/10);for(var f=1/l,h=f/10,p=0;p<=l;p++){var v=p*f,m=[i.apply(null,e.concat([v])),i.apply(null,r.concat([v]))],x=Bf(u[0],u[1],m[0],m[1]);x<s&&(o=v,s=x)}if(o===0)return{x:e[0],y:r[0]};if(o===1){var E=e.length;return{x:e[E-1],y:r[E-1]}}s=1/0;for(var p=0;p<32&&!(h<f_e);p++){var A=o-h,L=o+h,m=[i.apply(null,e.concat([A])),i.apply(null,r.concat([A]))],x=Bf(u[0],u[1],m[0],m[1]);if(A>=0&&x<s)o=A,s=x;else{var k=[i.apply(null,e.concat([L])),i.apply(null,r.concat([L]))],R=Bf(u[0],u[1],k[0],k[1]);L<=1&&R<s?(o=L,s=R):h*=.5}}return{x:i.apply(null,e.concat([o])),y:i.apply(null,r.concat([o]))}}function h_e(e,r){for(var t=0,n=e.length,i=0;i<n;i++){var a=e[i],o=r[i],s=e[(i+1)%n],u=r[(i+1)%n];t+=Bf(a,o,s,u)}return t/2}function S0(e,r,t,n){var i=1-n;return i*i*e+2*n*i*r+n*n*t}function g8(e,r,t){var n=e+t-2*r;if(qT(n,0))return[.5];var i=(e-r)/n;return i<=1&&i>=0?[i]:[]}function m8(e,r,t,n){return 2*(1-n)*(r-e)+2*n*(t-r)}function fK(e,r,t,n,i,a,o){var s=S0(e,t,i,o),u=S0(r,n,a,o),l=Mc.pointAt(e,r,t,n,o),f=Mc.pointAt(t,n,i,a,o);return[[e,r,l.x,l.y,s,u],[s,u,f.x,f.y,i,a]]}function YF(e,r,t,n,i,a,o){if(o===0)return(Bf(e,r,t,n)+Bf(t,n,i,a)+Bf(e,r,i,a))/2;var s=fK(e,r,t,n,i,a,.5),u=s[0],l=s[1];return u.push(o-1),l.push(o-1),YF.apply(null,u)+YF.apply(null,l)}var hK={box:function(e,r,t,n,i,a){var o=g8(e,t,i)[0],s=g8(r,n,a)[0],u=[e,i],l=[r,a];return o!==void 0&&u.push(S0(e,t,i,o)),s!==void 0&&l.push(S0(r,n,a,s)),z2(u,l)},length:function(e,r,t,n,i,a){return YF(e,r,t,n,i,a,3)},nearestPoint:function(e,r,t,n,i,a,o,s){return cK([e,t,i],[r,n,a],o,s,S0)},pointDistance:function(e,r,t,n,i,a,o,s){var u=this.nearestPoint(e,r,t,n,i,a,o,s);return Bf(u.x,u.y,o,s)},interpolationAt:S0,pointAt:function(e,r,t,n,i,a,o){return{x:S0(e,t,i,o),y:S0(r,n,a,o)}},divide:function(e,r,t,n,i,a,o){return fK(e,r,t,n,i,a,o)},tangentAngle:function(e,r,t,n,i,a,o){var s=m8(e,t,i,o),u=m8(r,n,a,o),l=Math.atan2(u,s);return vI(l)}};function A0(e,r,t,n,i){var a=1-i;return a*a*a*e+3*r*i*a*a+3*t*i*i*a+n*i*i*i}function y8(e,r,t,n,i){var a=1-i;return 3*(a*a*(r-e)+2*a*i*(t-r)+i*i*(n-t))}function fR(e,r,t,n){var i=-3*e+9*r-9*t+3*n,a=6*e-12*r+6*t,o=3*r-3*e,s=[],u,l,f;if(qT(i,0))qT(a,0)||(u=-o/a,u>=0&&u<=1&&s.push(u));else{var h=a*a-4*i*o;qT(h,0)?s.push(-a/(2*i)):h>0&&(f=Math.sqrt(h),u=(-a+f)/(2*i),l=(-a-f)/(2*i),u>=0&&u<=1&&s.push(u),l>=0&&l<=1&&s.push(l))}return s}function pK(e,r,t,n,i,a,o,s,u){var l=A0(e,t,i,o,u),f=A0(r,n,a,s,u),h=Mc.pointAt(e,r,t,n,u),p=Mc.pointAt(t,n,i,a,u),v=Mc.pointAt(i,a,o,s,u),m=Mc.pointAt(h.x,h.y,p.x,p.y,u),x=Mc.pointAt(p.x,p.y,v.x,v.y,u);return[[e,r,h.x,h.y,m.x,m.y,l,f],[l,f,x.x,x.y,v.x,v.y,o,s]]}function ZF(e,r,t,n,i,a,o,s,u){if(u===0)return h_e([e,t,i,o],[r,n,a,s]);var l=pK(e,r,t,n,i,a,o,s,.5),f=l[0],h=l[1];return f.push(u-1),h.push(u-1),ZF.apply(null,f)+ZF.apply(null,h)}var RC={extrema:fR,box:function(e,r,t,n,i,a,o,s){for(var u=[e,o],l=[r,s],f=fR(e,t,i,o),h=fR(r,n,a,s),p=0;p<f.length;p++)u.push(A0(e,t,i,o,f[p]));for(var p=0;p<h.length;p++)l.push(A0(r,n,a,s,h[p]));return z2(u,l)},length:function(e,r,t,n,i,a,o,s){return ZF(e,r,t,n,i,a,o,s,3)},nearestPoint:function(e,r,t,n,i,a,o,s,u,l,f){return cK([e,t,i,o],[r,n,a,s],u,l,A0,f)},pointDistance:function(e,r,t,n,i,a,o,s,u,l,f){var h=this.nearestPoint(e,r,t,n,i,a,o,s,u,l,f);return Bf(h.x,h.y,u,l)},interpolationAt:A0,pointAt:function(e,r,t,n,i,a,o,s,u){return{x:A0(e,t,i,o,u),y:A0(r,n,a,s,u)}},divide:function(e,r,t,n,i,a,o,s,u){return pK(e,r,t,n,i,a,o,s,u)},tangentAngle:function(e,r,t,n,i,a,o,s,u){var l=y8(e,t,i,o,u),f=y8(r,n,a,s,u);return vI(Math.atan2(f,l))}};function _8(e,r){var t=Math.abs(e);return r>0?t:t*-1}var p_e={box:function(e,r,t,n){return{x:e-t,y:r-n,width:t*2,height:n*2}},length:function(e,r,t,n){return Math.PI*(3*(t+n)-Math.sqrt((3*t+n)*(t+3*n)))},nearestPoint:function(e,r,t,n,i,a){var o=t,s=n;if(o===0||s===0)return{x:e,y:r};for(var u=i-e,l=a-r,f=Math.abs(u),h=Math.abs(l),p=o*o,v=s*s,m=Math.PI/4,x,E,A=0;A<4;A++){x=o*Math.cos(m),E=s*Math.sin(m);var L=(p-v)*Math.pow(Math.cos(m),3)/o,k=(v-p)*Math.pow(Math.sin(m),3)/s,R=x-L,D=E-k,$=f-L,j=h-k,H=Math.hypot(D,R),ee=Math.hypot(j,$),U=H*Math.asin((R*j-D*$)/(H*ee)),W=U/Math.sqrt(p+v-x*x-E*E);m+=W,m=Math.min(Math.PI/2,Math.max(0,m))}return{x:e+_8(x,u),y:r+_8(E,l)}},pointDistance:function(e,r,t,n,i,a){var o=this.nearestPoint(e,r,t,n,i,a);return Bf(o.x,o.y,i,a)},pointAt:function(e,r,t,n,i){var a=2*Math.PI*i;return{x:e+t*Math.cos(a),y:r+n*Math.sin(a)}},tangentAngle:function(e,r,t,n,i){var a=2*Math.PI*i,o=Math.atan2(n*Math.cos(a),-t*Math.sin(a));return vI(o)}};function d_e(e,r,t,n,i,a,o,s){return-1*t*Math.cos(i)*Math.sin(s)-n*Math.sin(i)*Math.cos(s)}function v_e(e,r,t,n,i,a,o,s){return-1*t*Math.sin(i)*Math.sin(s)+n*Math.cos(i)*Math.cos(s)}function g_e(e,r,t){return Math.atan(-r/e*Math.tan(t))}function m_e(e,r,t){return Math.atan(r/(e*Math.tan(t)))}function x8(e,r,t,n,i,a){return t*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+e}function b8(e,r,t,n,i,a){return t*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+r}function y_e(e,r,t,n){var i=Math.atan2(n*e,t*r);return(i+Math.PI*2)%(Math.PI*2)}function w8(e,r,t){return{x:e*Math.cos(t),y:r*Math.sin(t)}}function C8(e,r,t){var n=Math.cos(t),i=Math.sin(t);return[e*n-r*i,e*i+r*n]}var __e={box:function(e,r,t,n,i,a,o){for(var s=g_e(t,n,i),u=1/0,l=-1/0,f=[a,o],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var p=s+h;a<o?a<p&&p<o&&f.push(p):o<p&&p<a&&f.push(p)}for(var h=0;h<f.length;h++){var v=x8(e,r,t,n,i,f[h]);v<u&&(u=v),v>l&&(l=v)}for(var m=m_e(t,n,i),x=1/0,E=-1/0,A=[a,o],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var L=m+h;a<o?a<L&&L<o&&A.push(L):o<L&&L<a&&A.push(L)}for(var h=0;h<A.length;h++){var k=b8(e,r,t,n,i,A[h]);k<x&&(x=k),k>E&&(E=k)}return{x:u,y:x,width:l-u,height:E-x}},length:function(e,r,t,n,i,a,o){},nearestPoint:function(e,r,t,n,i,a,o,s,u){var l=C8(s-e,u-r,-i),f=l[0],h=l[1],p=p_e.nearestPoint(0,0,t,n,f,h),v=y_e(t,n,p.x,p.y);v<a?p=w8(t,n,a):v>o&&(p=w8(t,n,o));var m=C8(p.x,p.y,i);return{x:m[0]+e,y:m[1]+r}},pointDistance:function(e,r,t,n,i,a,o,s,u){var l=this.nearestPoint(e,r,t,n,s,u);return Bf(l.x,l.y,s,u)},pointAt:function(e,r,t,n,i,a,o,s){var u=(o-a)*s+a;return{x:x8(e,r,t,n,i,u),y:b8(e,r,t,n,i,u)}},tangentAngle:function(e,r,t,n,i,a,o,s){var u=(o-a)*s+a,l=d_e(e,r,t,n,i,a,o,u),f=v_e(e,r,t,n,i,a,o,u);return vI(Math.atan2(f,l))}};function dK(e){for(var r=0,t=[],n=0;n<e.length-1;n++){var i=e[n],a=e[n+1],o=Bf(i[0],i[1],a[0],a[1]),s={from:i,to:a,length:o};t.push(s),r+=o}return{segments:t,totalLength:r}}function x_e(e){if(e.length<2)return 0;for(var r=0,t=0;t<e.length-1;t++){var n=e[t],i=e[t+1];r+=Bf(n[0],n[1],i[0],i[1])}return r}function b_e(e,r){if(r>1||r<0||e.length<2)return null;var t=dK(e),n=t.segments,i=t.totalLength;if(i===0)return{x:e[0][0],y:e[0][1]};for(var a=0,o=null,s=0;s<n.length;s++){var u=n[s],l=u.from,f=u.to,h=u.length/i;if(r>=a&&r<=a+h){var p=(r-a)/h;o=Mc.pointAt(l[0],l[1],f[0],f[1],p);break}a+=h}return o}function w_e(e,r){if(r>1||r<0||e.length<2)return 0;for(var t=dK(e),n=t.segments,i=t.totalLength,a=0,o=0,s=0;s<n.length;s++){var u=n[s],l=u.from,f=u.to,h=u.length/i;if(r>=a&&r<=a+h){o=Math.atan2(f[1]-l[1],f[0]-l[0]);break}a+=h}return o}function C_e(e,r,t){for(var n=1/0,i=0;i<e.length-1;i++){var a=e[i],o=e[i+1],s=Mc.pointDistance(a[0],a[1],o[0],o[1],r,t);s<n&&(n=s)}return n}var vK={box:function(e){for(var r=[],t=[],n=0;n<e.length;n++){var i=e[n];r.push(i[0]),t.push(i[1])}return z2(r,t)},length:function(e){return x_e(e)},pointAt:function(e,r){return b_e(e,r)},pointDistance:function(e,r,t){return C_e(e,r,t)},tangentAngle:function(e,r){return w_e(e,r)}};function E8(e,r){return!e||!r?e||r:{minX:Math.min(e.minX,r.minX),minY:Math.min(e.minY,r.minY),maxX:Math.max(e.maxX,r.maxX),maxY:Math.max(e.maxY,r.maxY)}}function j3(e,r){var t=e.get("startArrowShape"),n=e.get("endArrowShape"),i=null,a=null;return t&&(i=t.getCanvasBBox(),r=E8(r,i)),n&&(a=n.getCanvasBBox(),r=E8(r,a)),r}function E_e(e){for(var r=e.attr(),t=r.points,n=[],i=[],a=0;a<t.length;a++){var o=t[a];n.push(o[0]),i.push(o[1])}var s=z2(n,i),u=s.x,l=s.y,f=s.width,h=s.height,p={minX:u,minY:l,maxX:u+f,maxY:l+h};return p=j3(e,p),{x:p.minX,y:p.minY,width:p.maxX-p.minX,height:p.maxY-p.minY}}function S_e(e){for(var r=e.attr(),t=r.points,n=[],i=[],a=0;a<t.length;a++){var o=t[a];n.push(o[0]),i.push(o[1])}return z2(n,i)}var hR=null;function gI(){if(!hR){var e=document.createElement("canvas");e.width=1,e.height=1,hR=e.getContext("2d")}return hR}function mI(e,r,t){var n=1;if(ei(e)&&(n=e.split(`
`).length),n>1){var i=A_e(r,t);return r*n+i*(n-1)}return r}function A_e(e,r){return r?r-e:e*.14}function T_e(e,r){var t=gI(),n=0;if(rr(e)||e==="")return n;if(t.save(),t.font=r,ei(e)&&e.includes(`
`)){var i=e.split(`
`);we(i,function(a){var o=t.measureText(a).width;n<o&&(n=o)})}else n=t.measureText(e).width;return t.restore(),n}function yI(e){var r=e.fontSize,t=e.fontFamily,n=e.fontWeight,i=e.fontStyle,a=e.fontVariant;return[i,a,n,r+"px",t].join(" ").trim()}function M_e(e){var r=e.attr(),t=r.x,n=r.y,i=r.text,a=r.fontSize,o=r.lineHeight,s=r.font;s||(s=yI(r));var u=T_e(i,s),l;if(!u)l={x:t,y:n,width:0,height:0};else{var f=r.textAlign,h=r.textBaseline,p=mI(i,a,o),v={x:t,y:n-p};f&&(f==="end"||f==="right"?v.x-=u:f==="center"&&(v.x-=u/2)),h&&(h==="top"?v.y+=p:h==="middle"&&(v.y+=p/2)),l={x:v.x,y:v.y,width:u,height:p}}return l}var L_e=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,I_e=/[^\s\,]+/ig;function k_e(e){var r=e||[];if(ar(r))return r;if(ei(r))return r=r.match(L_e),we(r,function(t,n){if(t=t.match(I_e),t[0].length>1){var i=t[0].charAt(0);t.splice(1,0,t[0].substr(1)),t[0]=i}we(t,function(a,o){isNaN(a)||(t[o]=+a)}),r[n]=t}),r}function P_e(e,r,t,n){var i=[],a=!!n,o,s,u,l,f,h,p;if(a){u=n[0],l=n[1];for(var v=0,m=e.length;v<m;v+=1){var x=e[v];u=Ac([0,0],u,x),l=Tc([0,0],l,x)}}for(var v=0,E=e.length;v<E;v+=1){var x=e[v];if(v===0&&!t)p=x;else if(v===E-1&&!t)h=x,i.push(p),i.push(h);else{var A=[v?v-1:E-1,v-1][t?0:1];o=e[A],s=e[t?(v+1)%E:v+1];var L=[0,0];L=Xp(L,s,o),L=ah(L,L,r);var k=c2(x,o),R=c2(x,s),D=k+R;D!==0&&(k/=D,R/=D);var $=ah([0,0],L,-k),j=ah([0,0],L,R);h=Xo([0,0],x,$),f=Xo([0,0],x,j),f=Ac([0,0],f,Tc([0,0],s,x)),f=Tc([0,0],f,Ac([0,0],s,x)),$=Xp([0,0],f,x),$=ah([0,0],$,-k/R),h=Xo([0,0],x,$),h=Ac([0,0],h,Tc([0,0],o,x)),h=Tc([0,0],h,Ac([0,0],o,x)),j=Xp([0,0],x,h),j=ah([0,0],j,R/k),f=Xo([0,0],x,j),a&&(h=Tc([0,0],h,u),h=Ac([0,0],h,l),f=Tc([0,0],f,u),f=Ac([0,0],f,l)),i.push(p),i.push(h),p=f}}return t&&i.push(i.shift()),i}function R_e(e,r,t){r===void 0&&(r=!1),t===void 0&&(t=[[0,0],[1,1]]);for(var n=!!r,i=[],a=0,o=e.length;a<o;a+=2)i.push([e[a],e[a+1]]);for(var s=P_e(i,.4,n,t),u=i.length,l=[],f,h,p,a=0;a<u-1;a+=1)f=s[a*2],h=s[a*2+1],p=i[a+1],l.push(["C",f[0],f[1],h[0],h[1],p[0],p[1]]);return n&&(f=s[u],h=s[u+1],p=i[0],l.push(["C",f[0],f[1],h[0],h[1],p[0],p[1]])),l}var OC=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,O_e=new RegExp("([a-z])["+OC+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+OC+"]*,?["+OC+"]*)+)","ig"),F_e=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+OC+"]*,?["+OC+"]*","ig");function W3(e){if(!e)return null;if(ar(e))return e;var r={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},t=[];return String(e).replace(O_e,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(F_e,function(u,l){l&&o.push(+l)}),s==="m"&&o.length>2&&(t.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&t.push([i,o[0]]),s==="r")t.push([i].concat(o));else for(;o.length>=r[s]&&(t.push([i].concat(o.splice(0,r[s]))),!!r[s]););return""}),t}var D_e=/[a-z]/;function S8(e,r){return[r[0]+(r[0]-e[0]),r[1]+(r[1]-e[1])]}function gK(e){var r=W3(e);if(!r||!r.length)return[["M",0,0]];for(var t=!1,n=0;n<r.length;n++){var i=r[n][0];if(D_e.test(i)||["V","H","T","S"].indexOf(i)>=0){t=!0;break}}if(!t)return r;var a=[],o=0,s=0,u=0,l=0,f=0,h=r[0];(h[0]==="M"||h[0]==="m")&&(o=+h[1],s=+h[2],u=o,l=s,f++,a[0]=["M",o,s]);for(var n=f,p=r.length;n<p;n++){var v=r[n],m=a[n-1],x=[],i=v[0],E=i.toUpperCase();if(i!==E)switch(x[0]=E,E){case"A":x[1]=v[1],x[2]=v[2],x[3]=v[3],x[4]=v[4],x[5]=v[5],x[6]=+v[6]+o,x[7]=+v[7]+s;break;case"V":x[1]=+v[1]+s;break;case"H":x[1]=+v[1]+o;break;case"M":u=+v[1]+o,l=+v[2]+s,x[1]=u,x[2]=l;break;default:for(var A=1,L=v.length;A<L;A++)x[A]=+v[A]+(A%2?o:s)}else x=r[n];switch(E){case"Z":o=+u,s=+l;break;case"H":o=x[1],x=["L",o,s];break;case"V":s=x[1],x=["L",o,s];break;case"T":o=x[1],s=x[2];var k=S8([m[1],m[2]],[m[3],m[4]]);x=["Q",k[0],k[1],o,s];break;case"S":o=x[x.length-2],s=x[x.length-1];var R=m.length,D=S8([m[R-4],m[R-3]],[m[R-2],m[R-1]]);x=["C",D[0],D[1],x[1],x[2],o,s];break;case"M":u=x[x.length-2],l=x[x.length-1];break;default:o=x[x.length-2],s=x[x.length-1]}a.push(x)}return a}function kA(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function qF(e,r){return kA(e)*kA(r)?(e[0]*r[0]+e[1]*r[1])/(kA(e)*kA(r)):1}function A8(e,r){return(e[0]*r[1]<e[1]*r[0]?-1:1)*Math.acos(qF(e,r))}function KF(e,r){return e[0]===r[0]&&e[1]===r[1]}function B_e(e,r){var t=r[1],n=r[2],i=tI(rI(r[3]),Math.PI*2),a=r[4],o=r[5],s=e[0],u=e[1],l=r[6],f=r[7],h=Math.cos(i)*(s-l)/2+Math.sin(i)*(u-f)/2,p=-1*Math.sin(i)*(s-l)/2+Math.cos(i)*(u-f)/2,v=h*h/(t*t)+p*p/(n*n);v>1&&(t*=Math.sqrt(v),n*=Math.sqrt(v));var m=t*t*(p*p)+n*n*(h*h),x=m?Math.sqrt((t*t*(n*n)-m)/m):1;a===o&&(x*=-1),isNaN(x)&&(x=0);var E=n?x*t*p/n:0,A=t?x*-n*h/t:0,L=(s+l)/2+Math.cos(i)*E-Math.sin(i)*A,k=(u+f)/2+Math.sin(i)*E+Math.cos(i)*A,R=[(h-E)/t,(p-A)/n],D=[(-1*h-E)/t,(-1*p-A)/n],$=A8([1,0],R),j=A8(R,D);return qF(R,D)<=-1&&(j=Math.PI),qF(R,D)>=1&&(j=0),o===0&&j>0&&(j=j-2*Math.PI),o===1&&j<0&&(j=j+2*Math.PI),{cx:L,cy:k,rx:KF(e,[l,f])?0:t,ry:KF(e,[l,f])?0:n,startAngle:$,endAngle:$+j,xRotation:i,arcFlag:a,sweepFlag:o}}function T8(e,r){return[r[0]+(r[0]-e[0]),r[1]+(r[1]-e[1])]}function mK(e){e=k_e(e);for(var r=[],t=null,n=null,i=null,a=0,o=e.length,s=0;s<o;s++){var u=e[s];n=e[s+1];var l=u[0],f={command:l,prePoint:t,params:u,startTangent:null,endTangent:null};switch(l){case"M":i=[u[1],u[2]],a=s;break;case"A":var h=B_e(t,u);f.arcParams=h;break}if(l==="Z")t=i,n=e[a+1];else{var p=u.length;t=[u[p-2],u[p-1]]}n&&n[0]==="Z"&&(n=e[a],r[a]&&(r[a].prePoint=t)),f.currentPoint=t,r[a]&&KF(t,r[a].currentPoint)&&(r[a].prePoint=f.prePoint);var v=n?[n[n.length-2],n[n.length-1]]:null;f.nextPoint=v;var m=f.prePoint;if(["L","H","V"].includes(l))f.startTangent=[m[0]-t[0],m[1]-t[1]],f.endTangent=[t[0]-m[0],t[1]-m[1]];else if(l==="Q"){var x=[u[1],u[2]];f.startTangent=[m[0]-x[0],m[1]-x[1]],f.endTangent=[t[0]-x[0],t[1]-x[1]]}else if(l==="T"){var E=r[s-1],x=T8(E.currentPoint,m);E.command==="Q"?(f.command="Q",f.startTangent=[m[0]-x[0],m[1]-x[1]],f.endTangent=[t[0]-x[0],t[1]-x[1]]):(f.command="TL",f.startTangent=[m[0]-t[0],m[1]-t[1]],f.endTangent=[t[0]-m[0],t[1]-m[1]])}else if(l==="C"){var A=[u[1],u[2]],L=[u[3],u[4]];f.startTangent=[m[0]-A[0],m[1]-A[1]],f.endTangent=[t[0]-L[0],t[1]-L[1]],f.startTangent[0]===0&&f.startTangent[1]===0&&(f.startTangent=[A[0]-L[0],A[1]-L[1]]),f.endTangent[0]===0&&f.endTangent[1]===0&&(f.endTangent=[L[0]-A[0],L[1]-A[1]])}else if(l==="S"){var E=r[s-1],A=T8(E.currentPoint,m),L=[u[1],u[2]];E.command==="C"?(f.command="C",f.startTangent=[m[0]-A[0],m[1]-A[1]],f.endTangent=[t[0]-L[0],t[1]-L[1]]):(f.command="SQ",f.startTangent=[m[0]-L[0],m[1]-L[1]],f.endTangent=[t[0]-L[0],t[1]-L[1]])}else if(l==="A"){var k=.001,R=f.arcParams||{},D=R.cx,$=D===void 0?0:D,j=R.cy,H=j===void 0?0:j,ee=R.rx,U=ee===void 0?0:ee,W=R.ry,Q=W===void 0?0:W,te=R.sweepFlag,ie=te===void 0?0:te,ve=R.startAngle,me=ve===void 0?0:ve,Re=R.endAngle,We=Re===void 0?0:Re;ie===0&&(k*=-1);var je=U*Math.cos(me-k)+$,lt=Q*Math.sin(me-k)+H;f.startTangent=[je-i[0],lt-i[1]];var dt=U*Math.cos(me+We+k)+$,ct=Q*Math.sin(me+We-k)+H;f.endTangent=[m[0]-dt,m[1]-ct]}r.push(f)}return r}var M8=function(e,r,t){return e>=r&&e<=t};function N_e(e,r,t,n){var i=.001,a={x:t.x-e.x,y:t.y-e.y},o={x:r.x-e.x,y:r.y-e.y},s={x:n.x-t.x,y:n.y-t.y},u=o.x*s.y-o.y*s.x,l=u*u,f=o.x*o.x+o.y*o.y,h=s.x*s.x+s.y*s.y,p=null;if(l>i*f*h){var v=(a.x*s.y-a.y*s.x)/u,m=(a.x*o.y-a.y*o.x)/u;M8(v,0,1)&&M8(m,0,1)&&(p={x:e.x+v*o.x,y:e.y+v*o.y})}return p}var z_e=1e-6;function pR(e){return Math.abs(e)<z_e?0:e<0?-1:1}function $_e(e,r,t){return(t[0]-e[0])*(r[1]-e[1])===(r[0]-e[0])*(t[1]-e[1])&&Math.min(e[0],r[0])<=t[0]&&t[0]<=Math.max(e[0],r[0])&&Math.min(e[1],r[1])<=t[1]&&t[1]<=Math.max(e[1],r[1])}function L8(e,r,t){var n=!1,i=e.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=e[a],s=e[(a+1)%i];if($_e(o,s,[r,t]))return!0;pR(o[1]-t)>0!=pR(s[1]-t)>0&&pR(r-(t-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(n=!n)}return n}function I8(e){for(var r=[],t=e.length,n=0;n<t-1;n++){var i=e[n],a=e[n+1];r.push({from:{x:i[0],y:i[1]},to:{x:a[0],y:a[1]}})}if(r.length>1){var o=e[0],s=e[t-1];r.push({from:{x:s[0],y:s[1]},to:{x:o[0],y:o[1]}})}return r}function U_e(e,r){var t=!1;return we(e,function(n){if(N_e(n.from,n.to,r.from,r.to))return t=!0,!1}),t}function k8(e){var r=e.map(function(n){return n[0]}),t=e.map(function(n){return n[1]});return{minX:Math.min.apply(null,r),maxX:Math.max.apply(null,r),minY:Math.min.apply(null,t),maxY:Math.max.apply(null,t)}}function V_e(e,r){return!(r.minX>e.maxX||r.maxX<e.minX||r.minY>e.maxY||r.maxY<e.minY)}function G_e(e,r){if(e.length<2||r.length<2)return!1;var t=k8(e),n=k8(r);if(!V_e(t,n))return!1;var i=!1;if(we(r,function(u){if(L8(e,u[0],u[1]))return i=!0,!1}),i||(we(e,function(u){if(L8(r,u[0],u[1]))return i=!0,!1}),i))return!0;var a=I8(e),o=I8(r),s=!1;return we(o,function(u){if(U_e(a,u))return s=!0,!1}),s}function H_e(e,r){for(var t=[],n=[],i=[],a=0;a<e.length;a++){var o=e[a],s=o.currentPoint,u=o.params,l=o.prePoint,f=void 0;switch(o.command){case"Q":f=hK.box(l[0],l[1],u[1],u[2],u[3],u[4]);break;case"C":f=RC.box(l[0],l[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var h=o.arcParams;f=__e.box(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(s[0]),n.push(s[1]);break}f&&(o.box=f,t.push(f.x,f.x+f.width),n.push(f.y,f.y+f.height)),r&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(A){return!Number.isNaN(A)&&A!==1/0&&A!==-1/0}),n=n.filter(function(A){return!Number.isNaN(A)&&A!==1/0&&A!==-1/0});var p=oh(t),v=oh(n),m=Ff(t),x=Ff(n);if(i.length===0)return{x:p,y:v,width:m-p,height:x-v};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,E=void 0;s[0]===p?(E=PA(o,r),p=p-E.xExtra):s[0]===m&&(E=PA(o,r),m=m+E.xExtra),s[1]===v?(E=PA(o,r),v=v-E.yExtra):s[1]===x&&(E=PA(o,r),x=x+E.yExtra)}return{x:p,y:v,width:m-p,height:x-v}}function PA(e,r){var t=e.prePoint,n=e.currentPoint,i=e.nextPoint,a=Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2),o=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),u=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!u||Math.sin(u)===0||ac(u,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),f=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));l=l>Math.PI/2?Math.PI-l:l,f=f>Math.PI/2?Math.PI-f:f;var h={xExtra:Math.cos(u/2-l)*(r/2*(1/Math.sin(u/2)))-r/2||0,yExtra:Math.cos(f-u/2)*(r/2*(1/Math.sin(u/2)))-r/2||0};return h}function j_e(e){var r=e.attr(),t=r.path,n=r.stroke,i=n?r.lineWidth:0,a=e.get("segments")||mK(t),o=H_e(a,i),s=o.x,u=o.y,l=o.width,f=o.height,h={minX:s,minY:u,maxX:s+l,maxY:u+f};return h=j3(e,h),{x:h.minX,y:h.minY,width:h.maxX-h.minX,height:h.maxY-h.minY}}function W_e(e){var r=e.attr(),t=r.x1,n=r.y1,i=r.x2,a=r.y2,o=Math.min(t,i),s=Math.max(t,i),u=Math.min(n,a),l=Math.max(n,a),f={minX:o,maxX:s,minY:u,maxY:l};return f=j3(e,f),{x:f.minX,y:f.minY,width:f.maxX-f.minX,height:f.maxY-f.minY}}function X_e(e){var r=e.attr(),t=r.x,n=r.y,i=r.rx,a=r.ry;return{x:t-i,y:n-a,width:i*2,height:a*2}}qd("rect",uK);qd("image",uK);qd("circle",lK);qd("marker",lK);qd("polyline",E_e);qd("polygon",S_e);qd("text",M_e);qd("path",j_e);qd("line",W_e);qd("ellipse",X_e);var P8=0,Y_e=1/2,Z_e=1/2,q_e=.05,_I=function(){function e(r){var t=r.xField,n=r.yField,i=r.adjustNames,a=i===void 0?["x","y"]:i,o=r.dimValuesMap;this.adjustNames=a,this.xField=t,this.yField=n,this.dimValuesMap=o}return e.prototype.isAdjust=function(r){return this.adjustNames.indexOf(r)>=0},e.prototype.getAdjustRange=function(r,t,n){var i=this.yField,a=n.indexOf(t),o=n.length,s,u;return!i&&this.isAdjust("y")?(s=0,u=1):o>1?(s=n[a===0?0:a-1],u=n[a===o-1?o-1:a+1],a!==0?s+=(t-s)/2:s-=(u-t)/2,a!==o-1?u-=(u-t)/2:u+=(t-n[o-2])/2):(s=t===0?0:t-.5,u=t===0?1:t+.5),{pre:s,next:u}},e.prototype.adjustData=function(r,t){var n=this,i=this.getDimValues(t);we(r,function(a,o){we(i,function(s,u){n.adjustDim(u,s,a,o)})})},e.prototype.groupData=function(r,t){return we(r,function(n){n[t]===void 0&&(n[t]=P8)}),lp(r,t)},e.prototype.adjustDim=function(r,t,n,i){},e.prototype.getDimValues=function(r){var t=this,n=t.xField,i=t.yField,a=Na({},this.dimValuesMap),o=[];if(n&&this.isAdjust("x")&&o.push(n),i&&this.isAdjust("y")&&o.push(i),o.forEach(function(u){a&&a[u]||(a[u]=Gd(r,u).sort(function(l,f){return l-f}))}),!i&&this.isAdjust("y")){var s="y";a[s]=[P8,1]}return a},e}(),yK={},_K=function(e){return yK[e.toLowerCase()]},xI=function(e,r){if(_K(e))throw new Error("Adjust type '"+e+"' existed.");yK[e.toLowerCase()]=r},mi={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(e){var r,t,n,i,a,o,s,u,l,f,h,p,v,m,x,E,A,L,k,R,D,$,j;(function(H){var ee=typeof jp=="object"?jp:typeof self=="object"?self:typeof this=="object"?this:{};H(U(ee,U(e.exports)));function U(W,Q){return W!==ee&&(typeof Object.create=="function"?Object.defineProperty(W,"__esModule",{value:!0}):W.__esModule=!0),function(te,ie){return W[te]=Q?Q(te,ie):ie}}})(function(H){var ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,W){U.__proto__=W}||function(U,W){for(var Q in W)W.hasOwnProperty(Q)&&(U[Q]=W[Q])};r=function(U,W){ee(U,W);function Q(){this.constructor=U}U.prototype=W===null?Object.create(W):(Q.prototype=W.prototype,new Q)},t=Object.assign||function(U){for(var W,Q=1,te=arguments.length;Q<te;Q++){W=arguments[Q];for(var ie in W)Object.prototype.hasOwnProperty.call(W,ie)&&(U[ie]=W[ie])}return U},n=function(U,W){var Q={};for(var te in U)Object.prototype.hasOwnProperty.call(U,te)&&W.indexOf(te)<0&&(Q[te]=U[te]);if(U!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ie=0,te=Object.getOwnPropertySymbols(U);ie<te.length;ie++)W.indexOf(te[ie])<0&&Object.prototype.propertyIsEnumerable.call(U,te[ie])&&(Q[te[ie]]=U[te[ie]]);return Q},i=function(U,W,Q,te){var ie=arguments.length,ve=ie<3?W:te===null?te=Object.getOwnPropertyDescriptor(W,Q):te,me;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ve=Reflect.decorate(U,W,Q,te);else for(var Re=U.length-1;Re>=0;Re--)(me=U[Re])&&(ve=(ie<3?me(ve):ie>3?me(W,Q,ve):me(W,Q))||ve);return ie>3&&ve&&Object.defineProperty(W,Q,ve),ve},a=function(U,W){return function(Q,te){W(Q,te,U)}},o=function(U,W){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(U,W)},s=function(U,W,Q,te){function ie(ve){return ve instanceof Q?ve:new Q(function(me){me(ve)})}return new(Q||(Q=Promise))(function(ve,me){function Re(lt){try{je(te.next(lt))}catch(dt){me(dt)}}function We(lt){try{je(te.throw(lt))}catch(dt){me(dt)}}function je(lt){lt.done?ve(lt.value):ie(lt.value).then(Re,We)}je((te=te.apply(U,W||[])).next())})},u=function(U,W){var Q={label:0,sent:function(){if(ve[0]&1)throw ve[1];return ve[1]},trys:[],ops:[]},te,ie,ve,me;return me={next:Re(0),throw:Re(1),return:Re(2)},typeof Symbol=="function"&&(me[Symbol.iterator]=function(){return this}),me;function Re(je){return function(lt){return We([je,lt])}}function We(je){if(te)throw new TypeError("Generator is already executing.");for(;Q;)try{if(te=1,ie&&(ve=je[0]&2?ie.return:je[0]?ie.throw||((ve=ie.return)&&ve.call(ie),0):ie.next)&&!(ve=ve.call(ie,je[1])).done)return ve;switch(ie=0,ve&&(je=[je[0]&2,ve.value]),je[0]){case 0:case 1:ve=je;break;case 4:return Q.label++,{value:je[1],done:!1};case 5:Q.label++,ie=je[1],je=[0];continue;case 7:je=Q.ops.pop(),Q.trys.pop();continue;default:if(ve=Q.trys,!(ve=ve.length>0&&ve[ve.length-1])&&(je[0]===6||je[0]===2)){Q=0;continue}if(je[0]===3&&(!ve||je[1]>ve[0]&&je[1]<ve[3])){Q.label=je[1];break}if(je[0]===6&&Q.label<ve[1]){Q.label=ve[1],ve=je;break}if(ve&&Q.label<ve[2]){Q.label=ve[2],Q.ops.push(je);break}ve[2]&&Q.ops.pop(),Q.trys.pop();continue}je=W.call(U,Q)}catch(lt){je=[6,lt],ie=0}finally{te=ve=0}if(je[0]&5)throw je[1];return{value:je[0]?je[1]:void 0,done:!0}}},j=function(U,W,Q,te){te===void 0&&(te=Q),U[te]=W[Q]},l=function(U,W){for(var Q in U)Q!=="default"&&!W.hasOwnProperty(Q)&&(W[Q]=U[Q])},f=function(U){var W=typeof Symbol=="function"&&Symbol.iterator,Q=W&&U[W],te=0;if(Q)return Q.call(U);if(U&&typeof U.length=="number")return{next:function(){return U&&te>=U.length&&(U=void 0),{value:U&&U[te++],done:!U}}};throw new TypeError(W?"Object is not iterable.":"Symbol.iterator is not defined.")},h=function(U,W){var Q=typeof Symbol=="function"&&U[Symbol.iterator];if(!Q)return U;var te=Q.call(U),ie,ve=[],me;try{for(;(W===void 0||W-- >0)&&!(ie=te.next()).done;)ve.push(ie.value)}catch(Re){me={error:Re}}finally{try{ie&&!ie.done&&(Q=te.return)&&Q.call(te)}finally{if(me)throw me.error}}return ve},p=function(){for(var U=[],W=0;W<arguments.length;W++)U=U.concat(h(arguments[W]));return U},v=function(){for(var U=0,W=0,Q=arguments.length;W<Q;W++)U+=arguments[W].length;for(var te=Array(U),ie=0,W=0;W<Q;W++)for(var ve=arguments[W],me=0,Re=ve.length;me<Re;me++,ie++)te[ie]=ve[me];return te},m=function(U){return this instanceof m?(this.v=U,this):new m(U)},x=function(U,W,Q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var te=Q.apply(U,W||[]),ie,ve=[];return ie={},me("next"),me("throw"),me("return"),ie[Symbol.asyncIterator]=function(){return this},ie;function me(ct){te[ct]&&(ie[ct]=function(Tt){return new Promise(function(It,Lt){ve.push([ct,Tt,It,Lt])>1||Re(ct,Tt)})})}function Re(ct,Tt){try{We(te[ct](Tt))}catch(It){dt(ve[0][3],It)}}function We(ct){ct.value instanceof m?Promise.resolve(ct.value.v).then(je,lt):dt(ve[0][2],ct)}function je(ct){Re("next",ct)}function lt(ct){Re("throw",ct)}function dt(ct,Tt){ct(Tt),ve.shift(),ve.length&&Re(ve[0][0],ve[0][1])}},E=function(U){var W,Q;return W={},te("next"),te("throw",function(ie){throw ie}),te("return"),W[Symbol.iterator]=function(){return this},W;function te(ie,ve){W[ie]=U[ie]?function(me){return(Q=!Q)?{value:m(U[ie](me)),done:ie==="return"}:ve?ve(me):me}:ve}},A=function(U){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var W=U[Symbol.asyncIterator],Q;return W?W.call(U):(U=typeof f=="function"?f(U):U[Symbol.iterator](),Q={},te("next"),te("throw"),te("return"),Q[Symbol.asyncIterator]=function(){return this},Q);function te(ve){Q[ve]=U[ve]&&function(me){return new Promise(function(Re,We){me=U[ve](me),ie(Re,We,me.done,me.value)})}}function ie(ve,me,Re,We){Promise.resolve(We).then(function(je){ve({value:je,done:Re})},me)}},L=function(U,W){return Object.defineProperty?Object.defineProperty(U,"raw",{value:W}):U.raw=W,U},k=function(U){if(U&&U.__esModule)return U;var W={};if(U!=null)for(var Q in U)Object.hasOwnProperty.call(U,Q)&&(W[Q]=U[Q]);return W.default=U,W},R=function(U){return U&&U.__esModule?U:{default:U}},D=function(U,W){if(!W.has(U))throw new TypeError("attempted to get private field on non-instance");return W.get(U)},$=function(U,W,Q){if(!W.has(U))throw new TypeError("attempted to set private field on non-instance");return W.set(U,Q),Q},H("__extends",r),H("__assign",t),H("__rest",n),H("__decorate",i),H("__param",a),H("__metadata",o),H("__awaiter",s),H("__generator",u),H("__exportStar",l),H("__createBinding",j),H("__values",f),H("__read",h),H("__spread",p),H("__spreadArrays",v),H("__await",m),H("__asyncGenerator",x),H("__asyncDelegator",E),H("__asyncValues",A),H("__makeTemplateObject",L),H("__importStar",k),H("__importDefault",R),H("__classPrivateFieldGet",D),H("__classPrivateFieldSet",$)})})(mi);var K_e=function(e){mi.exports.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.cacheMap={},n.adjustDataArray=[],n.mergeData=[];var i=t.marginRatio,a=i===void 0?Y_e:i,o=t.dodgeRatio,s=o===void 0?Z_e:o,u=t.dodgeBy,l=t.intervalPadding,f=t.dodgePadding,h=t.xDimensionLength,p=t.groupNum,v=t.defaultSize,m=t.maxColumnWidth,x=t.minColumnWidth,E=t.columnWidthRatio,A=t.customOffset;return n.marginRatio=a,n.dodgeRatio=s,n.dodgeBy=u,n.intervalPadding=l,n.dodgePadding=f,n.xDimensionLegenth=h,n.groupNum=p,n.defaultSize=v,n.maxColumnWidth=m,n.minColumnWidth=x,n.columnWidthRatio=E,n.customOffset=A,n}return r.prototype.process=function(t){var n=Of(t),i=pp(n),a=this.dodgeBy,o=a?tq(i,a):n;return this.cacheMap={},this.adjustDataArray=o,this.mergeData=i,this.adjustData(o,i),this.adjustDataArray=[],this.mergeData=[],n},r.prototype.adjustDim=function(t,n,i,a){var o=this,s=this.customOffset,u=this.getDistribution(t),l=this.groupData(i,t);return we(l,function(f,h){var p;n.length===1?p={pre:n[0]-1,next:n[0]+1}:p=o.getAdjustRange(t,parseFloat(h),n),we(f,function(v){var m=v[t],x=u[m],E=x.indexOf(a);if(rr(s))v[t]=o.getDodgeOffset(p,E,x.length);else{var A=p.pre,L=p.next;v[t]=kn(s)?s(v,p):(A+L)/2+s}})}),[]},r.prototype.getDodgeOffset=function(t,n,i){var a=this,o=a.dodgeRatio,s=a.marginRatio,u=a.intervalPadding,l=a.dodgePadding,f=t.pre,h=t.next,p=h-f,v;if(!rr(u)&&rr(l)&&u>=0){var m=this.getIntervalOnlyOffset(i,n);v=f+m}else if(!rr(l)&&rr(u)&&l>=0){var m=this.getDodgeOnlyOffset(i,n);v=f+m}else if(!rr(u)&&!rr(l)&&u>=0&&l>=0){var m=this.getIntervalAndDodgeOffset(i,n);v=f+m}else{var x=p*o/i,E=s*x,m=1/2*(p-i*x-(i-1)*E)+((n+1)*x+n*E)-1/2*x-1/2*p;v=(f+h)/2+m}return v},r.prototype.getIntervalOnlyOffset=function(t,n){var i=this,a=i.defaultSize,o=i.intervalPadding,s=i.xDimensionLegenth,u=i.groupNum,l=i.dodgeRatio,f=i.maxColumnWidth,h=i.minColumnWidth,p=i.columnWidthRatio,v=o/s,m=(1-(u-1)*v)/u*l/(t-1),x=((1-v*(u-1))/u-m*(t-1))/t;if(x=rr(p)?x:1/u/t*p,!rr(f)){var E=f/s;x=Math.min(x,E)}if(!rr(h)){var A=h/s;x=Math.max(x,A)}x=a?a/s:x,m=((1-(u-1)*v)/u-t*x)/(t-1);var L=((1/2+n)*x+n*m+1/2*v)*u-v/2;return L},r.prototype.getDodgeOnlyOffset=function(t,n){var i=this,a=i.defaultSize,o=i.dodgePadding,s=i.xDimensionLegenth,u=i.groupNum,l=i.marginRatio,f=i.maxColumnWidth,h=i.minColumnWidth,p=i.columnWidthRatio,v=o/s,m=1*l/(u-1),x=((1-m*(u-1))/u-v*(t-1))/t;if(x=p?1/u/t*p:x,!rr(f)){var E=f/s;x=Math.min(x,E)}if(!rr(h)){var A=h/s;x=Math.max(x,A)}x=a?a/s:x,m=(1-(x*t+v*(t-1))*u)/(u-1);var L=((1/2+n)*x+n*v+1/2*m)*u-m/2;return L},r.prototype.getIntervalAndDodgeOffset=function(t,n){var i=this,a=i.intervalPadding,o=i.dodgePadding,s=i.xDimensionLegenth,u=i.groupNum,l=a/s,f=o/s,h=((1-l*(u-1))/u-f*(t-1))/t,p=((1/2+n)*h+n*f+1/2*l)*u-l/2;return p},r.prototype.getDistribution=function(t){var n=this.adjustDataArray,i=this.cacheMap,a=i[t];return a||(a={},we(n,function(o,s){var u=Gd(o,t);u.length||u.push(0),we(u,function(l){a[l]||(a[l]=[]),a[l].push(s)})}),i[t]=a),a},r}(_I);function Q_e(e,r){return(r-e)*Math.random()+e}var J_e=function(e){mi.exports.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.process=function(t){var n=Of(t),i=pp(n);return this.adjustData(n,i),n},r.prototype.adjustDim=function(t,n,i){var a=this,o=this.groupData(i,t);return we(o,function(s,u){return a.adjustGroup(s,t,parseFloat(u),n)})},r.prototype.getAdjustOffset=function(t){var n=t.pre,i=t.next,a=(i-n)*q_e;return Q_e(n+a,i-a)},r.prototype.adjustGroup=function(t,n,i,a){var o=this,s=this.getAdjustRange(n,i,a);return we(t,function(u){u[n]=o.getAdjustOffset(s)}),t},r}(_I),dR=hq,exe=function(e){mi.exports.__extends(r,e);function r(t){var n=e.call(this,t)||this,i=t.adjustNames,a=i===void 0?["y"]:i,o=t.height,s=o===void 0?NaN:o,u=t.size,l=u===void 0?10:u,f=t.reverseOrder,h=f===void 0?!1:f;return n.adjustNames=a,n.height=s,n.size=l,n.reverseOrder=h,n}return r.prototype.process=function(t){var n=this,i=n.yField,a=n.reverseOrder,o=i?this.processStack(t):this.processOneDimStack(t);return a?this.reverse(o):o},r.prototype.reverse=function(t){return t.slice(0).reverse()},r.prototype.processStack=function(t){var n=this,i=n.xField,a=n.yField,o=n.reverseOrder,s=o?this.reverse(t):t,u=new dR,l=new dR;return s.map(function(f){return f.map(function(h){var p,v=Ie(h,i,0),m=Ie(h,[a]),x=v.toString();if(m=ar(m)?m[1]:m,!rr(m)){var E=m>=0?u:l;E.has(x)||E.set(x,0);var A=E.get(x),L=m+A;return E.set(x,L),mi.exports.__assign(mi.exports.__assign({},h),(p={},p[a]=[A,L],p))}return h})})},r.prototype.processOneDimStack=function(t){var n=this,i=this,a=i.xField,o=i.height,s=i.reverseOrder,u="y",l=s?this.reverse(t):t,f=new dR;return l.map(function(h){return h.map(function(p){var v,m=n.size,x=p[a],E=m*2/o;f.has(x)||f.set(x,E/2);var A=f.get(x);return f.set(x,A+E),mi.exports.__assign(mi.exports.__assign({},p),(v={},v[u]=A,v))})})},r}(_I),txe=function(e){mi.exports.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.process=function(t){var n=pp(t),i=this,a=i.xField,o=i.yField,s=this.getXValuesMaxMap(n),u=Math.max.apply(Math,Object.keys(s).map(function(l){return s[l]}));return gu(t,function(l){return gu(l,function(f){var h,p,v=f[o],m=f[a];if(ar(v)){var x=(u-s[m])/2;return mi.exports.__assign(mi.exports.__assign({},f),(h={},h[o]=gu(v,function(A){return x+A}),h))}var E=(u-v)/2;return mi.exports.__assign(mi.exports.__assign({},f),(p={},p[o]=[E,v+E],p))})})},r.prototype.getXValuesMaxMap=function(t){var n=this,i=this,a=i.xField,o=i.yField,s=lp(t,function(u){return u[a]});return lq(s,function(u){return n.getDimMaxValue(u,o)})},r.prototype.getDimMaxValue=function(t,n){var i=gu(t,function(o){return Ie(o,n,[])}),a=pp(i);return Math.max.apply(Math,a)},r}(_I);xI("Dodge",K_e);xI("Jitter",J_e);xI("Stack",exe);xI("Symmetric",txe);var R8=function(e,r){return ei(r)?r:e.invert(e.scale(r))},pS=function(){function e(r){this.names=[],this.scales=[],this.linear=!1,this.values=[],this.callback=function(){return[]},this._parseCfg(r)}return e.prototype.mapping=function(){for(var r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t.map(function(a,o){return r._toOriginParam(a,r.scales[o])});return this.callback.apply(this,i)},e.prototype.getLinearValue=function(r){var t=this.values.length-1,n=Math.floor(t*r),i=t*r-n,a=this.values[n],o=n===t?a:this.values[n+1];return a+(o-a)*i},e.prototype.getNames=function(){for(var r=this.scales,t=this.names,n=Math.min(r.length,t.length),i=[],a=0;a<n;a+=1)i.push(t[a]);return i},e.prototype.getFields=function(){return this.scales.map(function(r){return r.field})},e.prototype.getScale=function(r){return this.scales[this.names.indexOf(r)]},e.prototype.defaultCallback=function(){for(var r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.length===0?this.values:t.map(function(i,a){var o=r.scales[a];return o.type==="identity"?o.values[0]:r._getAttributeValue(o,i)})},e.prototype._parseCfg=function(r){var t=this,n=r.type,i=n===void 0?"base":n,a=r.names,o=a===void 0?[]:a,s=r.scales,u=s===void 0?[]:s,l=r.values,f=l===void 0?[]:l,h=r.callback;this.type=i,this.scales=u,this.values=f,this.names=o,this.callback=function(){for(var p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];if(h){var m=h.apply(void 0,p);if(!rr(m))return[m]}return t.defaultCallback.apply(t,p)}},e.prototype._getAttributeValue=function(r,t){if(r.isCategory&&!this.linear){var n=r.translate(t);return this.values[n%this.values.length]}var i=r.scale(t);return this.getLinearValue(i)},e.prototype._toOriginParam=function(r,t){return t.isLinear?r:ar(r)?r.map(function(n){return R8(t,n)}):R8(t,r)},e}(),rxe=/rgba?\(([\s.,0-9]+)\)/,nxe=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,ixe=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,axe=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,oxe=function(e){return/^[r,R,L,l]{1}[\s]*\(/.test(e)},sxe=function(){var e=document.createElement("i");return e.title="Web Colour Picker",e.style.display="none",document.body.appendChild(e),e},vR=function(e,r,t,n){return e[n]+(r[n]-e[n])*t};function xK(e){return"#"+gR(e[0])+gR(e[1])+gR(e[2])}var bK=function(e){return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]},gR=function(e){var r=Math.round(e).toString(16);return r.length===1?"0"+r:r},uxe=function(e,r){var t=isNaN(Number(r))||r<0?0:r>1?1:Number(r),n=e.length-1,i=Math.floor(n*t),a=n*t-i,o=e[i],s=i===n?o:e[i+1];return xK([vR(o,s,a,0),vR(o,s,a,1),vR(o,s,a,2)])},RA,wK=function(e){if(e[0]==="#"&&e.length===7)return e;RA||(RA=sxe()),RA.style.color=e;var r=document.defaultView.getComputedStyle(RA,"").getPropertyValue("color"),t=rxe.exec(r),n=t[1].split(/\s*,\s*/).map(function(i){return Number(i)});return r=xK(n),r},lxe=function(e){var r=ei(e)?e.split("-"):e,t=gu(r,function(n){return bK(n.indexOf("#")===-1?wK(n):n)});return function(n){return uxe(t,n)}},cxe=function(e){if(oxe(e)){var r,t=void 0;if(e[0]==="l"){var n=nxe.exec(e),i=+n[1]+90;t=n[2],r="linear-gradient("+i+"deg, "}else if(e[0]==="r"){r="radial-gradient(";var n=ixe.exec(e);t=n[4]}var a=t.match(axe);return we(a,function(o,s){var u=o.split(":");r+=u[1]+" "+u[0]*100+"%",s!==a.length-1&&(r+=", ")}),r+=")",r}return e},G0={rgb2arr:bK,gradient:lxe,toRGB:v1(wK),toCSSGradient:cxe},fxe=function(e){mi.exports.__extends(r,e);function r(t){var n=e.call(this,t)||this;return n.type="color",n.names=["color"],ei(n.values)&&(n.linear=!0),n.gradient=G0.gradient(n.values),n}return r.prototype.getLinearValue=function(t){return this.gradient(t)},r}(pS),hxe=function(e){mi.exports.__extends(r,e);function r(t){var n=e.call(this,t)||this;return n.type="opacity",n.names=["opacity"],n}return r}(pS),pxe=function(e){mi.exports.__extends(r,e);function r(t){var n=e.call(this,t)||this;return n.names=["x","y"],n.type="position",n}return r.prototype.mapping=function(t,n){var i=this.scales,a=i[0],o=i[1];return rr(t)||rr(n)?[]:[ar(t)?t.map(function(s){return a.scale(s)}):a.scale(t),ar(n)?n.map(function(s){return o.scale(s)}):o.scale(n)]},r}(pS),dxe=function(e){mi.exports.__extends(r,e);function r(t){var n=e.call(this,t)||this;return n.type="shape",n.names=["shape"],n}return r.prototype.getLinearValue=function(t){var n=Math.round((this.values.length-1)*t);return this.values[n]},r}(pS),vxe=function(e){mi.exports.__extends(r,e);function r(t){var n=e.call(this,t)||this;return n.type="size",n.names=["size"],n}return r}(pS),CK={};function gxe(e){return CK[e]}function tm(e,r){CK[e]=r}var X3=function(){function e(r){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=r,this.initCfg(),this.init()}return e.prototype.translate=function(r){return r},e.prototype.change=function(r){Na(this.__cfg__,r),this.init()},e.prototype.clone=function(){return this.constructor(this.__cfg__)},e.prototype.getTicks=function(){var r=this;return gu(this.ticks,function(t,n){return xo(t)?t:{text:r.getText(t,n),tickValue:t,value:r.scale(t)}})},e.prototype.getText=function(r,t){var n=this.formatter,i=n?n(r,t):r;return rr(i)||!kn(i.toString)?"":i.toString()},e.prototype.getConfig=function(r){return this.__cfg__[r]},e.prototype.init=function(){Na(this,this.__cfg__),this.setDomain(),uh(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},e.prototype.initCfg=function(){},e.prototype.setDomain=function(){},e.prototype.calculateTicks=function(){var r=this.tickMethod,t=[];if(ei(r)){var n=gxe(r);if(!n)throw new Error("There is no method to to calculate ticks!");t=n(this)}else kn(r)&&(t=r(this));return t},e.prototype.rangeMin=function(){return this.range[0]},e.prototype.rangeMax=function(){return this.range[1]},e.prototype.calcPercent=function(r,t,n){return xi(r)?(r-t)/(n-t):NaN},e.prototype.calcValue=function(r,t,n){return t+r*(n-t)},e}(),QF=function(e,r){return QF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},QF(e,r)};function rm(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");QF(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var JF=function(){return JF=Object.assign||function(r){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},JF.apply(this,arguments)};function mxe(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;for(var n=Array(e),i=0,r=0;r<t;r++)for(var a=arguments[r],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}var bI=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="cat",t.isCategory=!0,t}return r.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var t=0;t<this.values.length;t++)this.translateIndexMap.set(this.values[t],t)}},r.prototype.translate=function(t){this.buildIndexMap();var n=this.translateIndexMap.get(t);return n===void 0&&(n=xi(t)?t:NaN),n},r.prototype.scale=function(t){var n=this.translate(t),i=this.calcPercent(n,this.min,this.max);return this.calcValue(i,this.rangeMin(),this.rangeMax())},r.prototype.invert=function(t){var n=this.max-this.min,i=this.calcPercent(t,this.rangeMin(),this.rangeMax()),a=Math.round(n*i)+this.min;return a<this.min||a>this.max?NaN:this.values[a]},r.prototype.getText=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=t;return xi(t)&&!this.values.includes(t)&&(a=this.values[a]),e.prototype.getText.apply(this,mxe([a],n))},r.prototype.initCfg=function(){this.tickMethod="cat"},r.prototype.setDomain=function(){if(rr(this.getConfig("min"))&&(this.min=0),rr(this.getConfig("max"))){var t=this.values.length;this.max=t>1?t-1:t}this.translateIndexMap&&(this.translateIndexMap=void 0)},r}(X3),EK=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,b0="\\d\\d?",s0="\\d\\d",yxe="\\d{3}",_xe="\\d{4}",FC="[^\\s]+",SK=/\[([^]*?)\]/gm;function AK(e,r){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n].substr(0,r));return t}var O8=function(e){return function(r,t){var n=t[e].map(function(a){return a.toLowerCase()}),i=n.indexOf(r.toLowerCase());return i>-1?i:null}};function Q0(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=0,i=r;n<i.length;n++){var a=i[n];for(var o in a)e[o]=a[o]}return e}var TK=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],MK=["January","February","March","April","May","June","July","August","September","October","November","December"],xxe=AK(MK,3),bxe=AK(TK,3),Y3={dayNamesShort:bxe,dayNames:TK,monthNamesShort:xxe,monthNames:MK,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!==10?1:0)*e%10]}},BM=Q0({},Y3),LK=function(e){return BM=Q0(BM,e)},F8=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},Yh=function(e,r){for(r===void 0&&(r=2),e=String(e);e.length<r;)e="0"+e;return e},wxe={D:function(e){return String(e.getDate())},DD:function(e){return Yh(e.getDate())},Do:function(e,r){return r.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return Yh(e.getDay())},ddd:function(e,r){return r.dayNamesShort[e.getDay()]},dddd:function(e,r){return r.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return Yh(e.getMonth()+1)},MMM:function(e,r){return r.monthNamesShort[e.getMonth()]},MMMM:function(e,r){return r.monthNames[e.getMonth()]},YY:function(e){return Yh(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return Yh(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return Yh(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return Yh(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return Yh(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return Yh(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return Yh(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return Yh(e.getMilliseconds(),3)},a:function(e,r){return e.getHours()<12?r.amPm[0]:r.amPm[1]},A:function(e,r){return e.getHours()<12?r.amPm[0].toUpperCase():r.amPm[1].toUpperCase()},ZZ:function(e){var r=e.getTimezoneOffset();return(r>0?"-":"+")+Yh(Math.floor(Math.abs(r)/60)*100+Math.abs(r)%60,4)},Z:function(e){var r=e.getTimezoneOffset();return(r>0?"-":"+")+Yh(Math.floor(Math.abs(r)/60),2)+":"+Yh(Math.abs(r)%60,2)}},D8=function(e){return+e-1},B8=[null,b0],N8=[null,FC],z8=["isPm",FC,function(e,r){var t=e.toLowerCase();return t===r.amPm[0]?0:t===r.amPm[1]?1:null}],$8=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var r=(e+"").match(/([+-]|\d\d)/gi);if(r){var t=+r[1]*60+parseInt(r[2],10);return r[0]==="+"?t:-t}return 0}],Cxe={D:["day",b0],DD:["day",s0],Do:["day",b0+FC,function(e){return parseInt(e,10)}],M:["month",b0,D8],MM:["month",s0,D8],YY:["year",s0,function(e){var r=new Date,t=+(""+r.getFullYear()).substr(0,2);return+(""+(+e>68?t-1:t)+e)}],h:["hour",b0,void 0,"isPm"],hh:["hour",s0,void 0,"isPm"],H:["hour",b0],HH:["hour",s0],m:["minute",b0],mm:["minute",s0],s:["second",b0],ss:["second",s0],YYYY:["year",_xe],S:["millisecond","\\d",function(e){return+e*100}],SS:["millisecond",s0,function(e){return+e*10}],SSS:["millisecond",yxe],d:B8,dd:B8,ddd:N8,dddd:N8,MMM:["month",FC,O8("monthNamesShort")],MMMM:["month",FC,O8("monthNames")],a:z8,A:z8,ZZ:$8,Z:$8},NM={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},IK=function(e){return Q0(NM,e)},kK=function(e,r,t){if(r===void 0&&(r=NM.default),t===void 0&&(t={}),typeof e=="number"&&(e=new Date(e)),Object.prototype.toString.call(e)!=="[object Date]"||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");r=NM[r]||r;var n=[];r=r.replace(SK,function(a,o){return n.push(o),"@@@"});var i=Q0(Q0({},BM),t);return r=r.replace(EK,function(a){return wxe[a](e,i)}),r.replace(/@@@/g,function(){return n.shift()})};function PK(e,r,t){if(t===void 0&&(t={}),typeof r!="string")throw new Error("Invalid format in fecha parse");if(r=NM[r]||r,e.length>1e3)return null;var n=new Date,i={year:n.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},a=[],o=[],s=r.replace(SK,function(R,D){return o.push(F8(D)),"@@@"}),u={},l={};s=F8(s).replace(EK,function(R){var D=Cxe[R],$=D[0],j=D[1],H=D[3];if(u[$])throw new Error("Invalid format. "+$+" specified twice in format");return u[$]=!0,H&&(l[H]=!0),a.push(D),"("+j+")"}),Object.keys(l).forEach(function(R){if(!u[R])throw new Error("Invalid format. "+R+" is required in specified format")}),s=s.replace(/@@@/g,function(){return o.shift()});var f=e.match(new RegExp(s,"i"));if(!f)return null;for(var h=Q0(Q0({},BM),t),p=1;p<f.length;p++){var v=a[p-1],m=v[0],x=v[2],E=x?x(f[p],h):+f[p];if(E==null)return null;i[m]=E}i.isPm===1&&i.hour!=null&&+i.hour!=12?i.hour=+i.hour+12:i.isPm===0&&+i.hour==12&&(i.hour=0);var A;if(i.timezoneOffset==null){A=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond);for(var L=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],p=0,k=L.length;p<k;p++)if(u[L[p][0]]&&i[L[p][0]]!==A[L[p][1]]())return null}else if(A=new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond)),i.month>11||i.month<0||i.day>31||i.day<1||i.hour>23||i.hour<0||i.minute>59||i.minute<0||i.second>59||i.second<0)return null;return A}var RK={format:kK,parse:PK,defaultI18n:Y3,setGlobalDateI18n:LK,setGlobalDateMasks:IK},Exe=Object.freeze(Object.defineProperty({__proto__:null,default:RK,assign:Q0,format:kK,parse:PK,defaultI18n:Y3,setGlobalDateI18n:LK,setGlobalDateMasks:IK},Symbol.toStringTag,{value:"Module"}));function Sxe(e){return function(r,t,n,i){for(var a=rr(n)?0:n,o=rr(i)?r.length:i;a<o;){var s=a+o>>>1;e(r[s])>t?o=s:a=s+1}return a}}var U8="format";function OK(e,r){var t=Exe[U8]||RK[U8];return t(e,r)}function zM(e){return ei(e)&&(e.indexOf("T")>0?e=new Date(e).getTime():e=new Date(e.replace(/-/gi,"/")).getTime()),L3(e)&&(e=e.getTime()),e}var Vv=1e3,$x=60*Vv,Ux=60*$x,ay=24*Ux,DC=ay*31,V8=ay*365,Ow=[["HH:mm:ss",Vv],["HH:mm:ss",Vv*10],["HH:mm:ss",Vv*30],["HH:mm",$x],["HH:mm",$x*10],["HH:mm",$x*30],["HH",Ux],["HH",Ux*6],["HH",Ux*12],["YYYY-MM-DD",ay],["YYYY-MM-DD",ay*4],["YYYY-WW",ay*7],["YYYY-MM",DC],["YYYY-MM",DC*4],["YYYY-MM",DC*6],["YYYY",ay*380]];function Axe(e,r,t){var n=(r-e)/t,i=Sxe(function(o){return o[1]})(Ow,n)-1,a=Ow[i];return i<0?a=Ow[0]:i>=Ow.length&&(a=al(Ow)),a}var Txe=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="timeCat",t}return r.prototype.translate=function(t){t=zM(t);var n=this.values.indexOf(t);return n===-1&&(xi(t)&&t<this.values.length?n=t:n=NaN),n},r.prototype.getText=function(t,n){var i=this.translate(t);if(i>-1){var a=this.values[i],o=this.formatter;return a=o?o(a,n):OK(a,this.mask),a}return t},r.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},r.prototype.setDomain=function(){var t=this.values;we(t,function(n,i){t[i]=zM(n)}),t.sort(function(n,i){return n-i}),e.prototype.setDomain.call(this)},r}(bI),wI=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.isContinuous=!0,t}return r.prototype.scale=function(t){if(rr(t))return NaN;var n=this.rangeMin(),i=this.rangeMax(),a=this.max,o=this.min;if(a===o)return n;var s=this.getScalePercent(t);return n+s*(i-n)},r.prototype.init=function(){e.prototype.init.call(this);var t=this.ticks,n=up(t),i=al(t);n<this.min&&(this.min=n),i>this.max&&(this.max=i),rr(this.minLimit)||(this.min=n),rr(this.maxLimit)||(this.max=i)},r.prototype.setDomain=function(){var t=A3(this.values),n=t.min,i=t.max;rr(this.min)&&(this.min=n),rr(this.max)&&(this.max=i),this.min>this.max&&(this.min=n,this.max=i)},r.prototype.calculateTicks=function(){var t=this,n=e.prototype.calculateTicks.call(this);return this.nice||(n=kc(n,function(i){return i>=t.min&&i<=t.max})),n},r.prototype.getScalePercent=function(t){var n=this.max,i=this.min;return(t-i)/(n-i)},r.prototype.getInvertPercent=function(t){return(t-this.rangeMin())/(this.rangeMax()-this.rangeMin())},r}(X3),CI=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="linear",t.isLinear=!0,t}return r.prototype.invert=function(t){var n=this.getInvertPercent(t);return this.min+n*(this.max-this.min)},r.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},r}(wI);function T0(e,r){var t=Math.E,n;return r>=0?n=Math.pow(t,Math.log(r)/e):n=Math.pow(t,Math.log(-r)/e)*-1,n}function Rd(e,r){return e===1?1:Math.log(r)/Math.log(e)}function FK(e,r,t){rr(t)&&(t=Math.max.apply(null,e));var n=t;return we(e,function(i){i>0&&i<n&&(n=i)}),n===t&&(n=t/r),n>1&&(n=1),n}var Mxe=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="log",t}return r.prototype.invert=function(t){var n=this.base,i=Rd(n,this.max),a=this.rangeMin(),o=this.rangeMax()-a,s,u=this.positiveMin;if(u){if(t===0)return 0;s=Rd(n,u/n);var l=1/(i-s)*o;if(t<l)return t/l*u}else s=Rd(n,this.min);var f=(t-a)/o,h=f*(i-s)+s;return Math.pow(n,h)},r.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},r.prototype.setDomain=function(){e.prototype.setDomain.call(this);var t=this.min;if(t<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");t===0&&(this.positiveMin=FK(this.values,this.base,this.max))},r.prototype.getScalePercent=function(t){var n=this.max,i=this.min;if(n===i||t<=0)return 0;var a=this.base,o=this.positiveMin;o&&(i=o*1/a);var s;return t<o?s=t/o/(Rd(a,n)-Rd(a,i)):s=(Rd(a,t)-Rd(a,i))/(Rd(a,n)-Rd(a,i)),s},r}(wI),Lxe=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="pow",t}return r.prototype.invert=function(t){var n=this.getInvertPercent(t),i=this.exponent,a=T0(i,this.max),o=T0(i,this.min),s=n*(a-o)+o,u=s>=0?1:-1;return Math.pow(s,i)*u},r.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},r.prototype.getScalePercent=function(t){var n=this.max,i=this.min;if(n===i)return 0;var a=this.exponent,o=(T0(a,t)-T0(a,i))/(T0(a,n)-T0(a,i));return o},r}(wI),Ixe=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="time",t}return r.prototype.getText=function(t,n){var i=this.translate(t),a=this.formatter;return a?a(i,n):OK(i,this.mask)},r.prototype.scale=function(t){var n=t;return(ei(n)||L3(n))&&(n=this.translate(n)),e.prototype.scale.call(this,n)},r.prototype.translate=function(t){return zM(t)},r.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},r.prototype.setDomain=function(){var t=this.values,n=this.getConfig("min"),i=this.getConfig("max");if((!rr(n)||!xi(n))&&(this.min=this.translate(this.min)),(!rr(i)||!xi(i))&&(this.max=this.translate(this.max)),t&&t.length){var a=[],o=1/0,s=o,u=0;we(t,function(l){var f=zM(l);if(isNaN(f))throw new TypeError("Invalid Time: "+l+" in time scale!");o>f?(s=o,o=f):s>f&&(s=f),u<f&&(u=f),a.push(f)}),t.length>1&&(this.minTickInterval=s-o),rr(n)&&(this.min=o),rr(i)&&(this.max=u)}},r}(CI),DK=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="quantize",t}return r.prototype.invert=function(t){var n=this.ticks,i=n.length,a=this.getInvertPercent(t),o=Math.floor(a*(i-1));if(o>=i-1)return al(n);if(o<0)return up(n);var s=n[o],u=n[o+1],l=o/(i-1),f=(o+1)/(i-1);return s+(a-l)/(f-l)*(u-s)},r.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},r.prototype.calculateTicks=function(){var t=e.prototype.calculateTicks.call(this);return this.nice||(al(t)!==this.max&&t.push(this.max),up(t)!==this.min&&t.unshift(this.min)),t},r.prototype.getScalePercent=function(t){var n=this.ticks;if(t<up(n))return 0;if(t>al(n))return 1;var i=0;return we(n,function(a,o){if(t>=a)i=o;else return!1}),i/(n.length-1)},r}(wI),kxe=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="quantile",t}return r.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},r}(DK),BK={};function e5(e){return BK[e]}function nm(e,r){if(e5(e))throw new Error("type '"+e+"' existed.");BK[e]=r}var Pxe=function(e){rm(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="identity",t.isIdentity=!0,t}return r.prototype.calculateTicks=function(){return this.values},r.prototype.scale=function(t){return this.values[0]!==t&&xi(t)?t:this.range[0]},r.prototype.invert=function(t){var n=this.range;return t<n[0]||t>n[1]?NaN:this.values[0]},r}(X3);function NK(e){var r=e.values,t=e.tickInterval,n=e.tickCount,i=e.showLast;if(xi(t)){var a=kc(r,function(m,x){return x%t===0}),o=al(r);return i&&al(a)!==o&&a.push(o),a}var s=r.length,u=e.min,l=e.max;if(rr(u)&&(u=0),rr(l)&&(l=r.length-1),!xi(n)||n>=s)return r.slice(u,l+1);if(n<=0||l<=0)return[];for(var f=n===1?s:Math.floor(s/(n-1)),h=[],p=u,v=0;v<n&&!(p>=l);v++)p=Math.min(u+v*f,l),v===n-1&&i?h.push(r[l]):h.push(r[p]);return h}function Rxe(e){var r=e.min,t=e.max,n=e.nice,i=e.tickCount,a=new Oxe;return a.domain([r,t]),n&&a.nice(i),a.ticks(i)}var mR=5,G8=Math.sqrt(50),H8=Math.sqrt(10),j8=Math.sqrt(2),Oxe=function(){function e(){this._domain=[0,1]}return e.prototype.domain=function(r){return r?(this._domain=Array.from(r,Number),this):this._domain.slice()},e.prototype.nice=function(r){var t,n;r===void 0&&(r=mR);var i=this._domain.slice(),a=0,o=this._domain.length-1,s=this._domain[a],u=this._domain[o],l;return u<s&&(t=[u,s],s=t[0],u=t[1],n=[o,a],a=n[0],o=n[1]),l=KT(s,u,r),l>0?(s=Math.floor(s/l)*l,u=Math.ceil(u/l)*l,l=KT(s,u,r)):l<0&&(s=Math.ceil(s*l)/l,u=Math.floor(u*l)/l,l=KT(s,u,r)),l>0?(i[a]=Math.floor(s/l)*l,i[o]=Math.ceil(u/l)*l,this.domain(i)):l<0&&(i[a]=Math.ceil(s*l)/l,i[o]=Math.floor(u*l)/l,this.domain(i)),this},e.prototype.ticks=function(r){return r===void 0&&(r=mR),Fxe(this._domain[0],this._domain[this._domain.length-1],r||mR)},e}();function Fxe(e,r,t){var n,i=-1,a,o,s;if(r=+r,e=+e,t=+t,e===r&&t>0)return[e];if((n=r<e)&&(a=e,e=r,r=a),(s=KT(e,r,t))===0||!isFinite(s))return[];if(s>0)for(e=Math.ceil(e/s),r=Math.floor(r/s),o=new Array(a=Math.ceil(r-e+1));++i<a;)o[i]=(e+i)*s;else for(e=Math.floor(e*s),r=Math.ceil(r*s),o=new Array(a=Math.ceil(e-r+1));++i<a;)o[i]=(e-i)/s;return n&&o.reverse(),o}function KT(e,r,t){var n=(r-e)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=G8?10:a>=H8?5:a>=j8?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=G8?10:a>=H8?5:a>=j8?2:1)}function W8(e,r,t){var n;return t==="ceil"?n=Math.ceil(e/r):t==="floor"?n=Math.floor(e/r):n=Math.round(e/r),n*r}function Z3(e,r,t){var n=W8(e,t,"floor"),i=W8(r,t,"ceil");n=ZT(n,t),i=ZT(i,t);for(var a=[],o=Math.max((i-n)/(Math.pow(2,12)-1),t),s=n;s<=i;s=s+o){var u=ZT(s,o);a.push(u)}return{min:n,max:i,ticks:a}}function q3(e,r,t){var n,i=e.minLimit,a=e.maxLimit,o=e.min,s=e.max,u=e.tickCount,l=u===void 0?5:u,f=rr(i)?rr(r)?o:r:i,h=rr(a)?rr(t)?s:t:a;if(f>h&&(n=[f,h],h=n[0],f=n[1]),l<=2)return[f,h];for(var p=(h-f)/(l-1),v=[],m=0;m<l;m++)v.push(f+p*m);return v}function Dxe(e){var r=e.min,t=e.max,n=e.tickInterval,i=e.minLimit,a=e.maxLimit,o=Rxe(e);return!rr(i)||!rr(a)?q3(e,up(o),al(o)):n?Z3(r,t,n).ticks:o}function Cx(e){return Math.abs(e)<1e-15?e:parseFloat(e.toFixed(15))}var Bxe=[1,5,2,2.5,4,3],X8=Number.EPSILON*100;function Nxe(e,r){return(e%r+r)%r}function zxe(e){return Math.round(e*1e12)/1e12}function $xe(e,r,t,n,i,a){var o=zl(r),s=P3(r,e),u=0,l=Nxe(n,a);return(l<X8||a-l<X8)&&n<=0&&i>=0&&(u=1),1-s/(o-1)-t+u}function Uxe(e,r,t){var n=zl(r),i=P3(r,e),a=1;return 1-i/(n-1)-t+a}function Vxe(e,r,t,n,i,a){var o=(e-1)/(a-i),s=(r-1)/(Math.max(a,n)-Math.min(t,i));return 2-Math.max(o/s,s/o)}function Gxe(e,r){return e>=r?2-(e-1)/(r-1):1}function Hxe(e,r,t,n){var i=r-e;return 1-.5*(Math.pow(r-n,2)+Math.pow(e-t,2))/Math.pow(.1*i,2)}function jxe(e,r,t){var n=r-e;if(t>n){var i=(t-n)/2;return 1-Math.pow(i,2)/Math.pow(.1*n,2)}return 1}function Wxe(){return 1}function Xxe(e,r,t,n,i,a){t===void 0&&(t=5),n===void 0&&(n=!0),i===void 0&&(i=Bxe),a===void 0&&(a=[.25,.2,.5,.05]);var o=t<0?0:Math.round(t);if(Number.isNaN(e)||Number.isNaN(r)||typeof e!="number"||typeof r!="number"||!o)return{min:0,max:0,ticks:[]};if(r-e<1e-15||o===1)return{min:e,max:r,ticks:[e]};if(r-e>1e148){var s=t||5,u=(r-e)/s;return{min:e,max:r,ticks:Array(s).fill(null).map(function(dt,ct){return Cx(e+u*ct)})}}for(var l={score:-2,lmin:0,lmax:0,lstep:0},f=1;f<1/0;){for(var h=0;h<i.length;h+=1){var p=i[h],v=Uxe(p,i,f);if(a[0]*v+a[1]+a[2]+a[3]<l.score){f=1/0;break}for(var m=2;m<1/0;){var x=Gxe(m,o);if(a[0]*v+a[1]+a[2]*x+a[3]<l.score)break;for(var E=(r-e)/(m+1)/f/p,A=Math.ceil(Math.log10(E));A<1/0;){var L=f*p*Math.pow(10,A),k=jxe(e,r,L*(m-1));if(a[0]*v+a[1]*k+a[2]*x+a[3]<l.score)break;var R=Math.floor(r/L)*f-(m-1)*f,D=Math.ceil(e/L)*f;if(R<=D)for(var s=D-R,$=0;$<=s;$+=1){var j=R+$,H=j*(L/f),ee=H+L*(m-1),U=L,W=$xe(p,i,f,H,ee,U),Q=Hxe(e,r,H,ee),te=Vxe(m,o,e,r,H,ee),ie=Wxe(),ve=a[0]*W+a[1]*Q+a[2]*te+a[3]*ie;ve>l.score&&(!n||H<=e&&ee>=r)&&(l.lmin=H,l.lmax=ee,l.lstep=U,l.score=ve)}A+=1}m+=1}}f+=1}var me=Cx(l.lmax),Re=Cx(l.lmin),We=Cx(l.lstep),je=Math.floor(zxe((me-Re)/We))+1,lt=new Array(je);lt[0]=Cx(Re);for(var h=1;h<je;h++)lt[h]=Cx(lt[h-1]+We);return{min:Math.min(e,up(lt)),max:Math.max(r,al(lt)),ticks:lt}}function Yxe(e){var r=e.min,t=e.max,n=e.tickCount,i=e.nice,a=e.tickInterval,o=e.minLimit,s=e.maxLimit,u=Xxe(r,t,n,i).ticks;return!rr(o)||!rr(s)?q3(e,up(u),al(u)):a?Z3(r,t,a).ticks:u}function Zxe(e){var r=e.base,t=e.tickCount,n=e.min,i=e.max,a=e.values,o,s=Rd(r,i);if(n>0)o=Math.floor(Rd(r,n));else{var u=FK(a,r,i);o=Math.floor(Rd(r,u))}for(var l=s-o,f=Math.ceil(l/t),h=[],p=o;p<s+f;p=p+f)h.push(Math.pow(r,p));return n<=0&&h.unshift(0),h}function zK(e,r,t){if(t===void 0&&(t=5),e===r)return{max:r,min:e,ticks:[e]};var n=t<0?0:Math.round(t);if(n===0)return{max:r,min:e,ticks:[]};var i=1.5,a=.5+1.5*i,o=r-e,s=o/n,u=Math.pow(10,Math.floor(Math.log10(s))),l=u;2*u-s<i*(s-l)&&(l=2*u,5*u-s<a*(s-l)&&(l=5*u,10*u-s<i*(s-l)&&(l=10*u)));for(var f=Math.ceil(r/l),h=Math.floor(e/l),p=Math.max(f*l,r),v=Math.min(h*l,e),m=Math.floor((p-v)/l)+1,x=new Array(m),E=0;E<m;E++)x[E]=Cx(v+E*l);return{min:v,max:p,ticks:x}}function qxe(e){var r=e.exponent,t=e.tickCount,n=Math.ceil(T0(r,e.max)),i=Math.floor(T0(r,e.min)),a=zK(i,n,t).ticks;return a.map(function(o){var s=o>=0?1:-1;return Math.pow(o,r)*s})}function Kxe(e,r){var t=e.length*r;return r===1?e[e.length-1]:r===0?e[0]:t%1!==0?e[Math.ceil(t)-1]:e.length%2===0?(e[t-1]+e[t])/2:e[t]}function Qxe(e){var r=e.tickCount,t=e.values;if(!t||!t.length)return[];for(var n=t.slice().sort(function(s,u){return s-u}),i=[],a=0;a<r;a++){var o=a/(r-1);i.push(Kxe(n,o))}return i}function Jxe(e){var r=e.min,t=e.max,n=e.tickCount,i=e.tickInterval,a=e.minLimit,o=e.maxLimit,s=zK(r,t,n).ticks;return!rr(a)||!rr(o)?q3(e,up(s),al(s)):i?Z3(r,t,i).ticks:s}function e1e(e){var r=e.min,t=e.max,n=e.minTickInterval,i=e.tickInterval,a=e.tickCount;if(i)a=Math.ceil((t-r)/i);else{i=Axe(r,t,a)[1];var o=(t-r)/i,s=o/a;s>1&&(i=i*Math.ceil(s)),n&&i<n&&(i=n)}i=Math.max(Math.floor((t-r)/(Math.pow(2,12)-1)),i);for(var u=[],l=r;l<t+i;l+=i)u.push(l);return u}function t1e(e){var r=NK(JF({showLast:!0},e));return r}function $M(e){return new Date(e).getFullYear()}function r1e(e){return new Date(e,0,1).getTime()}function t5(e){return new Date(e).getMonth()}function n1e(e,r){var t=$M(e),n=$M(r),i=t5(e),a=t5(r);return(n-t)*12+(a-i)%12}function i1e(e,r){return new Date(e,r,1).getTime()}function a1e(e,r){return Math.ceil((r-e)/ay)}function o1e(e,r){return Math.ceil((r-e)/Ux)}function s1e(e,r){return Math.ceil((r-e)/(60*1e3))}function u1e(e){var r=e.min,t=e.max,n=e.minTickInterval,i=e.tickCount,a=e.tickInterval,o=[];a||(a=(t-r)/i,n&&a<n&&(a=n)),a=Math.max(Math.floor((t-r)/(Math.pow(2,12)-1)),a);var s=$M(r);if(a>V8)for(var u=$M(t),l=Math.ceil(a/V8),f=s;f<=u+l;f=f+l)o.push(r1e(f));else if(a>DC)for(var h=Math.ceil(a/DC),p=t5(r),v=n1e(r,t),f=0;f<=v+h;f=f+h)o.push(i1e(s,f+p));else if(a>ay)for(var m=new Date(r),x=m.getFullYear(),E=m.getMonth(),A=m.getDate(),L=Math.ceil(a/ay),k=a1e(r,t),f=0;f<k+L;f=f+L)o.push(new Date(x,E,A+f).getTime());else if(a>Ux)for(var m=new Date(r),x=m.getFullYear(),E=m.getMonth(),L=m.getDate(),R=m.getHours(),D=Math.ceil(a/Ux),$=o1e(r,t),f=0;f<=$+D;f=f+D)o.push(new Date(x,E,L,R+f).getTime());else if(a>$x)for(var j=s1e(r,t),H=Math.ceil(a/$x),f=0;f<=j+H;f=f+H)o.push(r+f*$x);else{var ee=a;ee<Vv&&(ee=Vv);for(var U=Math.floor(r/Vv)*Vv,W=Math.ceil((t-r)/Vv),Q=Math.ceil(ee/Vv),f=0;f<W+Q;f=f+Q)o.push(U+f*Vv)}return o.length>=512&&console.warn("Notice: current ticks length("+o.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+a+") is too small, increase the value to solve the problem!"),o}tm("cat",NK);tm("time-cat",t1e);tm("wilkinson-extended",Yxe);tm("r-pretty",Jxe);tm("time",e1e);tm("time-pretty",u1e);tm("log",Zxe);tm("pow",qxe);tm("quantile",Qxe);tm("d3-linear",Dxe);nm("cat",bI);nm("category",bI);nm("identity",Pxe);nm("linear",CI);nm("log",Mxe);nm("pow",Lxe);nm("time",Ixe);nm("timeCat",Txe);nm("quantize",DK);nm("quantile",kxe);var $K={},UK=function(e){return $K[e.toLowerCase()]},dS=function(e,r){if(UK(e))throw new Error("Attribute type '"+e+"' existed.");$K[e.toLowerCase()]=r};dS("Color",fxe);dS("Opacity",hxe);dS("Position",pxe);dS("Shape",dxe);dS("Size",vxe);var r5=function(e,r){return r5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r5(e,r)};function K3(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");r5(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}function Y8(e,r,t){if(t||arguments.length===2)for(var n=0,i=r.length,a;n<i;n++)(a||!(n in r))&&(a||(a=Array.prototype.slice.call(r,0,n)),a[n]=r[n]);return e.concat(a||Array.prototype.slice.call(r))}var Q3=function(){function e(r){this.type="coordinate",this.isRect=!1,this.isHelix=!1,this.isPolar=!1,this.isReflectX=!1,this.isReflectY=!1;var t=r.start,n=r.end,i=r.matrix,a=i===void 0?[1,0,0,0,1,0,0,0,1]:i,o=r.isTransposed,s=o===void 0?!1:o;this.start=t,this.end=n,this.matrix=a,this.originalMatrix=Y8([],a),this.isTransposed=s}return e.prototype.initial=function(){this.center={x:(this.start.x+this.end.x)/2,y:(this.start.y+this.end.y)/2},this.width=Math.abs(this.end.x-this.start.x),this.height=Math.abs(this.end.y-this.start.y)},e.prototype.update=function(r){Na(this,r),this.initial()},e.prototype.convertDim=function(r,t){var n,i=this[t],a=i.start,o=i.end;return this.isReflect(t)&&(n=[o,a],a=n[0],o=n[1]),a+r*(o-a)},e.prototype.invertDim=function(r,t){var n,i=this[t],a=i.start,o=i.end;return this.isReflect(t)&&(n=[o,a],a=n[0],o=n[1]),(r-a)/(o-a)},e.prototype.applyMatrix=function(r,t,n){n===void 0&&(n=0);var i=this.matrix,a=[r,t,n];return u2(a,a,i),a},e.prototype.invertMatrix=function(r,t,n){n===void 0&&(n=0);var i=this.matrix,a=Eme([0,0,0,0,0,0,0,0,0],i),o=[r,t,n];return a&&u2(o,o,a),o},e.prototype.convert=function(r){var t=this.convertPoint(r),n=t.x,i=t.y,a=this.applyMatrix(n,i,1);return{x:a[0],y:a[1]}},e.prototype.invert=function(r){var t=this.invertMatrix(r.x,r.y,1);return this.invertPoint({x:t[0],y:t[1]})},e.prototype.rotate=function(r){var t=this.matrix,n=this.center;return Rb(t,t,[-n.x,-n.y]),B3(t,t,r),Rb(t,t,[n.x,n.y]),this},e.prototype.reflect=function(r){return r==="x"?this.isReflectX=!this.isReflectX:this.isReflectY=!this.isReflectY,this},e.prototype.scale=function(r,t){var n=this.matrix,i=this.center;return Rb(n,n,[-i.x,-i.y]),Vq(n,n,[r,t]),Rb(n,n,[i.x,i.y]),this},e.prototype.translate=function(r,t){var n=this.matrix;return Rb(n,n,[r,t]),this},e.prototype.transpose=function(){return this.isTransposed=!this.isTransposed,this},e.prototype.getCenter=function(){return this.center},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.getRadius=function(){return this.radius},e.prototype.isReflect=function(r){return r==="x"?this.isReflectX:this.isReflectY},e.prototype.resetMatrix=function(r){this.matrix=r||Y8([],this.originalMatrix)},e}(),VK=function(e){K3(r,e);function r(t){var n=e.call(this,t)||this;return n.isRect=!0,n.type="cartesian",n.initial(),n}return r.prototype.initial=function(){e.prototype.initial.call(this);var t=this.start,n=this.end;this.x={start:t.x,end:n.x},this.y={start:t.y,end:n.y}},r.prototype.convertPoint=function(t){var n,i=t.x,a=t.y;return this.isTransposed&&(n=[a,i],i=n[0],a=n[1]),{x:this.convertDim(i,"x"),y:this.convertDim(a,"y")}},r.prototype.invertPoint=function(t){var n,i=this.invertDim(t.x,"x"),a=this.invertDim(t.y,"y");return this.isTransposed&&(n=[a,i],i=n[0],a=n[1]),{x:i,y:a}},r}(Q3),l1e=function(e){K3(r,e);function r(t){var n=e.call(this,t)||this;n.isHelix=!0,n.type="helix";var i=t.startAngle,a=i===void 0?1.25*Math.PI:i,o=t.endAngle,s=o===void 0?7.25*Math.PI:o,u=t.innerRadius,l=u===void 0?0:u,f=t.radius;return n.startAngle=a,n.endAngle=s,n.innerRadius=l,n.radius=f,n.initial(),n}return r.prototype.initial=function(){e.prototype.initial.call(this);var t=(this.endAngle-this.startAngle)/(2*Math.PI)+1,n=Math.min(this.width,this.height)/2;this.radius&&this.radius>=0&&this.radius<=1&&(n=n*this.radius),this.d=Math.floor(n*(1-this.innerRadius)/t),this.a=this.d/(Math.PI*2),this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*n,end:this.innerRadius*n+this.d*.99}},r.prototype.convertPoint=function(t){var n,i=t.x,a=t.y;this.isTransposed&&(n=[a,i],i=n[0],a=n[1]);var o=this.convertDim(i,"x"),s=this.a*o,u=this.convertDim(a,"y");return{x:this.center.x+Math.cos(o)*(s+u),y:this.center.y+Math.sin(o)*(s+u)}},r.prototype.invertPoint=function(t){var n,i=this.d+this.y.start,a=V0([0,0],[t.x,t.y],[this.center.x,this.center.y]),o=N3(a,[1,0],!0),s=o*this.a;Hb(a)<s&&(s=Hb(a));var u=Math.floor((Hb(a)-s)/i);o=2*u*Math.PI+o;var l=this.a*o,f=Hb(a)-l;f=ac(f,0)?0:f;var h=this.invertDim(o,"x"),p=this.invertDim(f,"y");return h=ac(h,0)?0:h,p=ac(p,0)?0:p,this.isTransposed&&(n=[p,h],h=n[0],p=n[1]),{x:h,y:p}},r}(Q3),c1e=function(e){K3(r,e);function r(t){var n=e.call(this,t)||this;n.isPolar=!0,n.type="polar";var i=t.startAngle,a=i===void 0?-Math.PI/2:i,o=t.endAngle,s=o===void 0?Math.PI*3/2:o,u=t.innerRadius,l=u===void 0?0:u,f=t.radius;return n.startAngle=a,n.endAngle=s,n.innerRadius=l,n.radius=f,n.initial(),n}return r.prototype.initial=function(){for(e.prototype.initial.call(this);this.endAngle<this.startAngle;)this.endAngle+=Math.PI*2;var t=this.getOneBox(),n=t.maxX-t.minX,i=t.maxY-t.minY,a=Math.abs(t.minX)/n,o=Math.abs(t.minY)/i,s;this.height/i>this.width/n?(s=this.width/n,this.circleCenter={x:this.center.x-(.5-a)*this.width,y:this.center.y-(.5-o)*s*i}):(s=this.height/i,this.circleCenter={x:this.center.x-(.5-a)*s*n,y:this.center.y-(.5-o)*this.height}),this.polarRadius=this.radius,this.radius?this.radius>0&&this.radius<=1?this.polarRadius=s*this.radius:(this.radius<=0||this.radius>s)&&(this.polarRadius=s):this.polarRadius=s,this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*this.polarRadius,end:this.polarRadius}},r.prototype.getRadius=function(){return this.polarRadius},r.prototype.convertPoint=function(t){var n,i=this.getCenter(),a=t.x,o=t.y;return this.isTransposed&&(n=[o,a],a=n[0],o=n[1]),a=this.convertDim(a,"x"),o=this.convertDim(o,"y"),{x:i.x+Math.cos(a)*o,y:i.y+Math.sin(a)*o}},r.prototype.invertPoint=function(t){var n,i=this.getCenter(),a=[t.x-i.x,t.y-i.y],o=this,s=o.startAngle,u=o.endAngle;this.isReflect("x")&&(n=[u,s],s=n[0],u=n[1]);var l=[1,0,0,0,1,0,0,0,1];B3(l,l,s);var f=[1,0,0];u2(f,f,l);var h=[f[0],f[1]],p=N3(h,a,u<s);ac(p,Math.PI*2)&&(p=0);var v=Hb(a),m=p/(u-s);m=u-s>0?m:-m;var x=this.invertDim(v,"y"),E={x:0,y:0};return E.x=this.isTransposed?x:m,E.y=this.isTransposed?m:x,E},r.prototype.getCenter=function(){return this.circleCenter},r.prototype.getOneBox=function(){var t=this.startAngle,n=this.endAngle;if(Math.abs(n-t)>=Math.PI*2)return{minX:-1,maxX:1,minY:-1,maxY:1};for(var i=[0,Math.cos(t),Math.cos(n)],a=[0,Math.sin(t),Math.sin(n)],o=Math.min(t,n);o<Math.max(t,n);o+=Math.PI/18)i.push(Math.cos(o)),a.push(Math.sin(o));return{minX:Math.min.apply(Math,i),maxX:Math.max.apply(Math,i),minY:Math.min.apply(Math,a),maxY:Math.max.apply(Math,a)}},r}(Q3),GK={},f1e=function(e){return GK[e.toLowerCase()]},EI=function(e,r){GK[e.toLowerCase()]=r};EI("rect",VK);EI("cartesian",VK);EI("polar",c1e);EI("helix",l1e);var n5=function(e,r){return n5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},n5(e,r)};function os(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");n5(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var kr=function(){return kr=Object.assign||function(r){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},kr.apply(this,arguments)};function J3(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t}function i5(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;for(var n=Array(e),i=0,r=0;r<t;r++)for(var a=arguments[r],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function HK(e,r,t){var n=new fS(r,t);n.target=e,n.propagationPath.push(e),e.emitDelegation(r,n);for(var i=e.getParent();i;)i.emitDelegation(r,n),n.propagationPath.push(i),i=i.getParent()}var jK=[1,0,0,0,1,0,0,0,1];function Kx(e,r,t){if(t===void 0&&(t=jK),!r)return null;var n=yl(t,[["t",-e.x,-e.y],["r",r],["t",e.x,e.y]]);return n}function e4(e,r){return!e.x&&!e.y?null:yl(r||jK,[["t",e.x,e.y]])}function h1e(e){var r=[1,0,0],t=[0,0,0];return u2(t,r,e),Math.atan2(t[1],t[0])}function OA(e,r){var t=[0,0];return zye(t,r,e),t}function p1e(e,r){var t=OA(e,[r.minX,r.minY]),n=OA(e,[r.maxX,r.minY]),i=OA(e,[r.minX,r.maxY]),a=OA(e,[r.maxX,r.maxY]),o=Math.min(t[0],n[0],i[0],a[0]),s=Math.max(t[0],n[0],i[0],a[0]),u=Math.min(t[1],n[1],i[1],a[1]),l=Math.max(t[1],n[1],i[1],a[1]);return{x:o,y:u,minX:o,minY:u,maxX:s,maxY:l,width:s-o,height:l-u}}function WK(e,r,t,n){if(r){var i=Kx({x:t,y:n},r,e.getMatrix());e.setMatrix(i)}}function BC(e,r,t){var n=e4({x:r,y:t});e.attr("matrix",n)}function UM(e){var r=0,t=0,n=0,i=0;return xi(e)?r=t=n=i=e:ar(e)&&(r=e[0],n=rr(e[1])?e[0]:e[1],i=rr(e[2])?e[0]:e[2],t=rr(e[3])?n:e[3]),[r,n,i,t]}function t4(e){for(var r=e.childNodes,t=r.length,n=t-1;n>=0;n--)e.removeChild(r[n])}function d1e(e,r){return!!e.className.match(new RegExp("(\\s|^)"+r+"(\\s|$)"))}function lE(e){var r=e.start,t=e.end,n=Math.min(r.x,t.x),i=Math.min(r.y,t.y),a=Math.max(r.x,t.x),o=Math.max(r.y,t.y);return{x:n,y:i,minX:n,minY:i,maxX:a,maxY:o,width:a-n,height:o-i}}function v1e(e){var r=e.map(function(s){return s.x}),t=e.map(function(s){return s.y}),n=Math.min.apply(Math,r),i=Math.min.apply(Math,t),a=Math.max.apply(Math,r),o=Math.max.apply(Math,t);return{x:n,y:i,minX:n,minY:i,maxX:a,maxY:o,width:a-n,height:o-i}}function SI(e,r,t,n){var i=e+t,a=r+n;return{x:e,y:r,width:t,height:n,minX:e,minY:r,maxX:isNaN(i)?0:i,maxY:isNaN(a)?0:a}}function Vx(e,r,t){return(1-t)*e+r*t}function qb(e,r,t){return{x:e.x+Math.cos(t)*r,y:e.y+Math.sin(t)*r}}function g1e(e,r){var t=r.x-e.x,n=r.y-e.y;return Math.sqrt(t*t+n*n)}var VM=function(e,r,t){return t===void 0&&(t=Math.pow(Number.EPSILON,.5)),[e,r].includes(1/0)?Math.abs(e)===Math.abs(r):Math.abs(e-r)<t};function m1e(e,r){var t=Math.max(e.minX,r.minX),n=Math.max(e.minY,r.minY),i=Math.min(e.maxX,r.maxX),a=Math.min(e.maxY,r.maxY);return SI(t,n,i-t,a-n)}function XK(e){var r=e.getClip(),t=r&&r.getBBox(),n;if(!e.isGroup())n=e.getBBox();else{var i=1/0,a=-1/0,o=1/0,s=-1/0,u=e.getChildren();u.length>0?we(u,function(l){if(l.get("visible")){if(l.isGroup()&&l.get("children").length===0)return!0;var f=XK(l),h=l.applyToMatrix([f.minX,f.minY,1]),p=l.applyToMatrix([f.minX,f.maxY,1]),v=l.applyToMatrix([f.maxX,f.minY,1]),m=l.applyToMatrix([f.maxX,f.maxY,1]),x=Math.min(h[0],p[0],v[0],m[0]),E=Math.max(h[0],p[0],v[0],m[0]),A=Math.min(h[1],p[1],v[1],m[1]),L=Math.max(h[1],p[1],v[1],m[1]);x<i&&(i=x),E>a&&(a=E),A<o&&(o=A),L>s&&(s=L)}}):(i=0,a=0,o=0,s=0),n=SI(i,o,a-i,s-o)}return t?m1e(n,t):n}function y1e(e,r){if(!(!e.getClip()&&!r.getClip())){var t=r.getClip();if(!t){e.setClip(null);return}var n={type:t.get("type"),attrs:t.attr()};e.setClip(n)}}function np(e){return e+"px"}function YK(e,r,t,n){var i=g1e(e,r),a=n/i,o=0;return t==="start"?o=0-a:t==="end"&&(o=1+a),{x:Vx(e.x,r.x,o),y:Vx(e.y,r.y,o)}}var _1e={none:[],point:["x","y"],region:["start","end"],points:["points"],circle:["center","radius","startAngle","endAngle"]},ZK=function(e){os(r,e);function r(t){var n=e.call(this,t)||this;return n.initCfg(),n}return r.prototype.getDefaultCfg=function(){return{id:"",name:"",type:"",locationType:"none",offsetX:0,offsetY:0,animate:!1,capture:!0,updateAutoRender:!1,animateOption:{appear:null,update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},events:null,defaultCfg:{},visible:!0}},r.prototype.clear=function(){},r.prototype.update=function(t){var n=this,i=this.get("defaultCfg")||{};we(t,function(a,o){var s=n.get(o),u=a;s!==a&&(xo(a)&&i[o]&&(u=yn({},i[o],a)),n.set(o,u))}),this.updateInner(t),this.afterUpdate(t)},r.prototype.updateInner=function(t){},r.prototype.afterUpdate=function(t){qg(t,"visible")&&(t.visible?this.show():this.hide()),qg(t,"capture")&&this.setCapture(t.capture)},r.prototype.getLayoutBBox=function(){return this.getBBox()},r.prototype.getLocationType=function(){return this.get("locationType")},r.prototype.getOffset=function(){return{offsetX:this.get("offsetX"),offsetY:this.get("offsetY")}},r.prototype.setOffset=function(t,n){this.update({offsetX:t,offsetY:n})},r.prototype.setLocation=function(t){var n=kr({},t);this.update(n)},r.prototype.getLocation=function(){var t=this,n={},i=this.get("locationType"),a=_1e[i];return we(a,function(o){n[o]=t.get(o)}),n},r.prototype.isList=function(){return!1},r.prototype.isSlider=function(){return!1},r.prototype.init=function(){},r.prototype.initCfg=function(){var t=this,n=this.get("defaultCfg");we(n,function(i,a){var o=t.get(a);if(xo(o)){var s=yn({},i,o);t.set(a,s)}})},r}(aI),ox="update_status",x1e=["visible","tip","delegateObject"],b1e=["container","group","shapesMap","isRegister","isUpdating","destroyed"],df=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{container:null,shapesMap:{},group:null,capture:!0,isRegister:!1,isUpdating:!1,isInit:!0})},r.prototype.remove=function(){this.clear();var t=this.get("group");t.remove()},r.prototype.clear=function(){var t=this.get("group");t.clear(),this.set("shapesMap",{}),this.clearOffScreenCache(),this.set("isInit",!0)},r.prototype.getChildComponentById=function(t){var n=this.getElementById(t),i=n&&n.get("component");return i},r.prototype.getElementById=function(t){return this.get("shapesMap")[t]},r.prototype.getElementByLocalId=function(t){var n=this.getElementId(t);return this.getElementById(n)},r.prototype.getElementsByName=function(t){var n=[];return we(this.get("shapesMap"),function(i){i.get("name")===t&&n.push(i)}),n},r.prototype.getContainer=function(){return this.get("container")},r.prototype.updateInner=function(t){this.offScreenRender(),this.get("updateAutoRender")&&this.render()},r.prototype.render=function(){var t=this.get("offScreenGroup");t||(t=this.offScreenRender());var n=this.get("group");this.updateElements(t,n),this.deleteElements(),this.applyOffset(),this.get("eventInitted")||(this.initEvent(),this.set("eventInitted",!0)),this.set("isInit",!1)},r.prototype.show=function(){var t=this.get("group");t.show(),this.set("visible",!0)},r.prototype.hide=function(){var t=this.get("group");t.hide(),this.set("visible",!1)},r.prototype.setCapture=function(t){var n=this.get("group");n.set("capture",t),this.set("capture",t)},r.prototype.destroy=function(){this.removeEvent(),this.remove(),e.prototype.destroy.call(this)},r.prototype.getBBox=function(){return this.get("group").getCanvasBBox()},r.prototype.getLayoutBBox=function(){var t=this.get("group"),n=this.getInnerLayoutBBox(),i=t.getTotalMatrix();return i&&(n=p1e(i,n)),n},r.prototype.on=function(t,n,i){var a=this.get("group");return a.on(t,n,i),this},r.prototype.off=function(t,n){var i=this.get("group");return i&&i.off(t,n),this},r.prototype.emit=function(t,n){var i=this.get("group");i.emit(t,n)},r.prototype.init=function(){e.prototype.init.call(this),this.get("group")||this.initGroup(),this.offScreenRender()},r.prototype.getInnerLayoutBBox=function(){return this.get("offScreenBBox")||this.get("group").getBBox()},r.prototype.delegateEmit=function(t,n){var i=this.get("group");n.target=i,i.emit(t,n),HK(i,t,n)},r.prototype.createOffScreenGroup=function(){var t=this.get("group"),n=t.getGroupBase(),i=new n({delegateObject:this.getDelegateObject()});return i},r.prototype.applyOffset=function(){var t=this.get("offsetX"),n=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t,y:n})},r.prototype.initGroup=function(){var t=this.get("container");this.set("group",t.addGroup({id:this.get("id"),name:this.get("name"),capture:this.get("capture"),visible:this.get("visible"),isComponent:!0,component:this,delegateObject:this.getDelegateObject()}))},r.prototype.offScreenRender=function(){this.clearOffScreenCache();var t=this.createOffScreenGroup();return this.renderInner(t),this.set("offScreenGroup",t),this.set("offScreenBBox",XK(t)),t},r.prototype.addGroup=function(t,n){this.appendDelegateObject(t,n);var i=t.addGroup(n);return this.get("isRegister")&&this.registerElement(i),i},r.prototype.addShape=function(t,n){this.appendDelegateObject(t,n);var i=t.addShape(n);return this.get("isRegister")&&this.registerElement(i),i},r.prototype.addComponent=function(t,n){var i=n.id,a=n.component,o=J3(n,["id","component"]),s=new a(kr(kr({},o),{id:i,container:t,updateAutoRender:this.get("updateAutoRender")}));return s.init(),s.render(),this.get("isRegister")&&this.registerElement(s.get("group")),s},r.prototype.initEvent=function(){},r.prototype.removeEvent=function(){var t=this.get("group");t.off()},r.prototype.getElementId=function(t){var n=this.get("id"),i=this.get("name");return n+"-"+i+"-"+t},r.prototype.registerElement=function(t){var n=t.get("id");this.get("shapesMap")[n]=t},r.prototype.unregisterElement=function(t){var n=t.get("id");delete this.get("shapesMap")[n]},r.prototype.moveElementTo=function(t,n){var i=e4(n);t.attr("matrix",i)},r.prototype.addAnimation=function(t,n,i){var a=n.attr("opacity");rr(a)&&(a=1),n.attr("opacity",0),n.animate({opacity:a},i)},r.prototype.removeAnimation=function(t,n,i){n.animate({opacity:0},i)},r.prototype.updateAnimation=function(t,n,i,a){n.animate(i,a)},r.prototype.updateElements=function(t,n){var i=this,a=this.get("animate"),o=this.get("animateOption"),s=t.getChildren().slice(0),u;we(s,function(l){var f=l.get("id"),h=i.getElementById(f),p=l.get("name");if(h)if(l.get("isComponent")){var v=l.get("component"),m=h.get("component"),x=lS(v.cfg,YZ(p1(v.cfg),b1e));m.update(x),h.set(ox,"update")}else{var E=i.getReplaceAttrs(h,l);a&&o.update?i.updateAnimation(p,h,E,o.update):h.attr(E),l.isGroup()&&i.updateElements(l,h),we(x1e,function(R){h.set(R,l.get(R))}),y1e(h,l),u=h,h.set(ox,"update")}else{n.add(l);var A=n.getChildren();if(A.splice(A.length-1,1),u){var L=A.indexOf(u);A.splice(L+1,0,l)}else A.unshift(l);if(i.registerElement(l),l.set(ox,"add"),l.get("isComponent")){var v=l.get("component");v.set("container",n)}else l.isGroup()&&i.registerNewGroup(l);if(u=l,a){var k=i.get("isInit")?o.appear:o.enter;k&&i.addAnimation(p,l,k)}}})},r.prototype.clearUpdateStatus=function(t){var n=t.getChildren();we(n,function(i){i.set(ox,null)})},r.prototype.clearOffScreenCache=function(){var t=this.get("offScreenGroup");t&&t.destroy(),this.set("offScreenGroup",null),this.set("offScreenBBox",null)},r.prototype.getDelegateObject=function(){var t,n=this.get("name"),i=(t={},t[n]=this,t.component=this,t);return i},r.prototype.appendDelegateObject=function(t,n){var i=t.get("delegateObject");n.delegateObject||(n.delegateObject={}),Na(n.delegateObject,i)},r.prototype.getReplaceAttrs=function(t,n){var i=t.attr(),a=n.attr();return we(i,function(o,s){a[s]===void 0&&(a[s]=void 0)}),a},r.prototype.registerNewGroup=function(t){var n=this,i=t.getChildren();we(i,function(a){n.registerElement(a),a.set(ox,"add"),a.isGroup()&&n.registerNewGroup(a)})},r.prototype.deleteElements=function(){var t=this,n=this.get("shapesMap"),i=[];we(n,function(s,u){!s.get(ox)||s.destroyed?i.push([u,s]):s.set(ox,null)});var a=this.get("animate"),o=this.get("animateOption");we(i,function(s){var u=s[0],l=s[1];if(!l.destroyed){var f=l.get("name");if(a&&o.leave){var h=Na({callback:function(){t.removeElement(l)}},o.leave);t.removeAnimation(f,l,h)}else t.removeElement(l)}delete n[u]})},r.prototype.removeElement=function(t){if(t.get("isGroup")){var n=t.get("component");n&&n.destroy()}t.remove()},r}(ZK),yR="\u2026";function w1e(e){for(var r=0,t=0;t<e.length;t++)r+=Ex(e,t);return r}function Ex(e,r){return e.charCodeAt(r)>0&&e.charCodeAt(r)<128?1:2}function C1e(e,r,t){t===void 0&&(t="tail");var n=e.length,i="";if(t==="tail"){for(var a=0,o=0;a<r;){var s=Ex(e,o);if(a+s<=r)i+=e[o],a+=Ex(e,o),o++;else break}i+=yR}else if(t==="head"){for(var a=0,o=n-1;a<r;){var s=Ex(e,o);if(a+s<=r)i+=e[o],a+=Ex(e,o),o--;else break}i=yR+i}else{for(var u="",l="",a=0,f=0,h=n-1;a<r;){var p=Ex(e,f),v=!1;p+a<=r&&(u+=e[f],f++,a+=p,v=!0);var m=Ex(e,h);if(m+a<=r&&(l=e[h]+l,a+=m,h--,v=!0),!v)break}i=u+yR+l}return i}var E1e="\u2026",S1e=2,A1e=400;function T1e(e){for(var r=e.map(function(u){var l=u.attr("text");return rr(l)?"":""+l}),t=0,n=0,i=0;i<r.length;i+=1){for(var a=0,o=0;o<=r[i].length;o+=1){var s=r[i].charCodeAt(o);s>=19968&&s<=40869?a+=2:a+=1}a>t&&(t=a,n=i)}return e[n].getBBox().width}function a5(e){if(e.length>A1e)return T1e(e);var r=0;return we(e,function(t){var n=t.getBBox(),i=n.width;r<i&&(r=i)}),r}function M1e(e,r){var t=r.getCanvasBBox();return e?t.width:t.height}function NC(e,r,t,n){var i;n===void 0&&(n="tail");var a=(i=r.attr("text"))!==null&&i!==void 0?i:"";if(n==="tail"){var o=lS(r.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),s=fq(a,t,o,"\u2026");return a!==s?(r.attr("text",s),r.set("tip",a),!0):(r.set("tip",null),!1)}var u=M1e(e,r),l=w1e(a),f=!1;if(t<u){var h=Math.floor(t/u*l)-S1e,p=void 0;h>=0?p=C1e(a,h,n):p=E1e,p&&(r.attr("text",p),f=!0)}return f?r.set("tip",a):r.set("tip",null),f}function AI(e,r){var t=r.x,n=r.y,i=r.content,a=r.style,o=r.id,s=r.name,u=r.rotate,l=r.maxLength,f=r.autoEllipsis,h=r.isVertical,p=r.ellipsisPosition,v=r.background,m=e.addGroup({id:o+"-group",name:s+"-group",attrs:{x:t,y:n}}),x=m.addShape({type:"text",id:o,name:s,attrs:kr({x:0,y:0,text:i},a)}),E=UM(Ie(v,"padding",0));if(l&&f){var A=l-(E[1]+E[3]);NC(!h,x,A,p)}if(v){var L=Ie(v,"style",{}),k=x.getCanvasBBox(),R=k.minX,D=k.minY,$=k.width,j=k.height,H=m.addShape("rect",{id:o+"-bg",name:o+"-bg",attrs:kr({x:R-E[3],y:D-E[0],width:$+E[1]+E[3],height:j+E[0]+E[2]},L)});H.toBack()}BC(m,t,n),WK(m,u,t,n)}var ha={fontFamily:`
  BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`,textColor:"#2C3542",activeTextColor:"#333333",uncheckedColor:"#D8D8D8",lineColor:"#416180",regionColor:"#CCD7EB",verticalAxisRotate:-Math.PI/4,horizontalAxisRotate:Math.PI/4,descriptionIconStroke:"#fff",descriptionIconFill:"rgba(58, 73, 101, .25)"},L1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"line",locationType:"region",start:null,end:null,style:{},text:null,defaultCfg:{style:{fill:ha.textColor,fontSize:12,textAlign:"center",textBaseline:"bottom",fontFamily:ha.fontFamily},text:{position:"center",autoRotate:!0,content:null,offsetX:0,offsetY:0,style:{stroke:ha.lineColor,lineWidth:1}}}})},r.prototype.renderInner=function(t){this.renderLine(t),this.get("text")&&this.renderLabel(t)},r.prototype.renderLine=function(t){var n=this.get("start"),i=this.get("end"),a=this.get("style");this.addShape(t,{type:"line",id:this.getElementId("line"),name:"annotation-line",attrs:kr({x1:n.x,y1:n.y,x2:i.x,y2:i.y},a)})},r.prototype.getLabelPoint=function(t,n,i){var a;return i==="start"?a=0:i==="center"?a=.5:ei(i)&&i.indexOf("%")!==-1?a=parseInt(i,10)/100:xi(i)?a=i:a=1,(a>1||a<0)&&(a=1),{x:Vx(t.x,n.x,a),y:Vx(t.y,n.y,a)}},r.prototype.renderLabel=function(t){var n=this.get("text"),i=this.get("start"),a=this.get("end"),o=n.position,s=n.content,u=n.style,l=n.offsetX,f=n.offsetY,h=n.autoRotate,p=n.maxLength,v=n.autoEllipsis,m=n.ellipsisPosition,x=n.background,E=n.isVertical,A=E===void 0?!1:E,L=this.getLabelPoint(i,a,o),k=L.x+l,R=L.y+f,D={id:this.getElementId("line-text"),name:"annotation-line-text",x:k,y:R,content:s,style:u,maxLength:p,autoEllipsis:v,ellipsisPosition:m,background:x,isVertical:A};if(h){var $=[a.x-i.x,a.y-i.y];D.rotate=Math.atan2($[1],$[0])}AI(t,D)},r}(df),I1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"text",locationType:"point",x:0,y:0,content:"",rotate:null,style:{},background:null,maxLength:null,autoEllipsis:!0,isVertical:!1,ellipsisPosition:"tail",defaultCfg:{style:{fill:ha.textColor,fontSize:12,textAlign:"center",textBaseline:"middle",fontFamily:ha.fontFamily}}})},r.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},r.prototype.renderInner=function(t){var n=this.getLocation(),i=n.x,a=n.y,o=this.get("content"),s=this.get("style"),u=this.getElementId("text"),l=this.get("name")+"-text",f=this.get("maxLength"),h=this.get("autoEllipsis"),p=this.get("isVertical"),v=this.get("ellipsisPosition"),m=this.get("background"),x=this.get("rotate"),E={id:u,name:l,x:i,y:a,content:o,style:s,maxLength:f,autoEllipsis:h,isVertical:p,ellipsisPosition:v,background:m,rotate:x};AI(t,E)},r.prototype.resetLocation=function(){var t=this.getElementByLocalId("text-group");if(t){var n=this.getLocation(),i=n.x,a=n.y,o=this.get("rotate");BC(t,i,a),WK(t,o,i,a)}},r}(df),k1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"arc",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2,style:{stroke:"#999",lineWidth:1}})},r.prototype.renderInner=function(t){this.renderArc(t)},r.prototype.getArcPath=function(){var t=this.getLocation(),n=t.center,i=t.radius,a=t.startAngle,o=t.endAngle,s=qb(n,i,a),u=qb(n,i,o),l=o-a>Math.PI?1:0,f=[["M",s.x,s.y]];if(o-a===Math.PI*2){var h=qb(n,i,a+Math.PI);f.push(["A",i,i,0,l,1,h.x,h.y]),f.push(["A",i,i,0,l,1,u.x,u.y])}else f.push(["A",i,i,0,l,1,u.x,u.y]);return f},r.prototype.renderArc=function(t){var n=this.getArcPath(),i=this.get("style");this.addShape(t,{type:"path",id:this.getElementId("arc"),name:"annotation-arc",attrs:kr({path:n},i)})},r}(df),P1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"region",locationType:"region",start:null,end:null,style:{},defaultCfg:{style:{lineWidth:0,fill:ha.regionColor,opacity:.4}}})},r.prototype.renderInner=function(t){this.renderRegion(t)},r.prototype.renderRegion=function(t){var n=this.get("start"),i=this.get("end"),a=this.get("style"),o=lE({start:n,end:i});this.addShape(t,{type:"rect",id:this.getElementId("region"),name:"annotation-region",attrs:kr({x:o.x,y:o.y,width:o.width,height:o.height},a)})},r}(df),R1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"image",locationType:"region",start:null,end:null,src:null,style:{}})},r.prototype.renderInner=function(t){this.renderImage(t)},r.prototype.getImageAttrs=function(){var t=this.get("start"),n=this.get("end"),i=this.get("style"),a=lE({start:t,end:n}),o=this.get("src");return kr({x:a.x,y:a.y,img:o,width:a.width,height:a.height},i)},r.prototype.renderImage=function(t){this.addShape(t,{type:"image",id:this.getElementId("image"),name:"annotation-image",attrs:this.getImageAttrs()})},r}(df),O1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"dataMarker",locationType:"point",x:0,y:0,point:{},line:{},text:{},direction:"upward",autoAdjust:!0,coordinateBBox:null,defaultCfg:{point:{display:!0,style:{r:3,fill:"#FFFFFF",stroke:"#1890FF",lineWidth:2}},line:{display:!0,length:20,style:{stroke:ha.lineColor,lineWidth:1}},text:{content:"",display:!0,style:{fill:ha.textColor,opacity:.65,fontSize:12,textAlign:"start",fontFamily:ha.fontFamily}}}})},r.prototype.renderInner=function(t){Ie(this.get("line"),"display")&&this.renderLine(t),Ie(this.get("text"),"display")&&this.renderText(t),Ie(this.get("point"),"display")&&this.renderPoint(t),this.get("autoAdjust")&&this.autoAdjust(t)},r.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x")+this.get("offsetX"),y:this.get("y")+this.get("offsetY")})},r.prototype.renderPoint=function(t){var n=this.getShapeAttrs().point;this.addShape(t,{type:"circle",id:this.getElementId("point"),name:"annotation-point",attrs:n})},r.prototype.renderLine=function(t){var n=this.getShapeAttrs().line;this.addShape(t,{type:"path",id:this.getElementId("line"),name:"annotation-line",attrs:n})},r.prototype.renderText=function(t){var n=this.getShapeAttrs().text,i=n.x,a=n.y,o=n.text,s=J3(n,["x","y","text"]),u=this.get("text"),l=u.background,f=u.maxLength,h=u.autoEllipsis,p=u.isVertival,v=u.ellipsisPosition,m={x:i,y:a,id:this.getElementId("text"),name:"annotation-text",content:o,style:s,background:l,maxLength:f,autoEllipsis:h,isVertival:p,ellipsisPosition:v};AI(t,m)},r.prototype.autoAdjust=function(t){var n=this.get("direction"),i=this.get("x"),a=this.get("y"),o=Ie(this.get("line"),"length",0),s=this.get("coordinateBBox"),u=t.getBBox(),l=u.minX,f=u.maxX,h=u.minY,p=u.maxY,v=t.findById(this.getElementId("text-group")),m=t.findById(this.getElementId("text")),x=t.findById(this.getElementId("line"));if(!!s){if(v){if(i+l<=s.minX){var E=s.minX-(i+l);BC(v,v.attr("x")+E,v.attr("y"))}if(i+f>=s.maxX){var E=i+f-s.maxX;BC(v,v.attr("x")-E,v.attr("y"))}}if(n==="upward"&&a+h<=s.minY||n!=="upward"&&a+p>=s.maxY){var A=void 0,L=void 0;n==="upward"&&a+h<=s.minY?(A="top",L=1):(A="bottom",L=-1),m.attr("textBaseline",A),x&&x.attr("path",[["M",0,0],["L",0,o*L]]),BC(v,v.attr("x"),(o+2)*L)}}},r.prototype.getShapeAttrs=function(){var t=Ie(this.get("line"),"display"),n=Ie(this.get("point"),"style",{}),i=Ie(this.get("line"),"style",{}),a=Ie(this.get("text"),"style",{}),o=this.get("direction"),s=t?Ie(this.get("line"),"length",0):0,u=o==="upward"?-1:1;return{point:kr({x:0,y:0},n),line:kr({path:[["M",0,0],["L",0,s*u]]},i),text:kr({x:0,y:(s+2)*u,text:Ie(this.get("text"),"content",""),textBaseline:o==="upward"?"bottom":"top"},a)}},r}(df),F1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"dataRegion",locationType:"points",points:[],lineLength:0,region:{},text:{},defaultCfg:{region:{style:{lineWidth:0,fill:ha.regionColor,opacity:.4}},text:{content:"",style:{textAlign:"center",textBaseline:"bottom",fontSize:12,fill:ha.textColor,fontFamily:ha.fontFamily}}}})},r.prototype.renderInner=function(t){var n=Ie(this.get("region"),"style",{});Ie(this.get("text"),"style",{});var i=this.get("lineLength")||0,a=this.get("points");if(!!a.length){var o=v1e(a),s=[];s.push(["M",a[0].x,o.minY-i]),a.forEach(function(l){s.push(["L",l.x,l.y])}),s.push(["L",a[a.length-1].x,a[a.length-1].y-i]),this.addShape(t,{type:"path",id:this.getElementId("region"),name:"annotation-region",attrs:kr({path:s},n)});var u=kr({id:this.getElementId("text"),name:"annotation-text",x:(o.minX+o.maxX)/2,y:o.minY-i},this.get("text"));AI(t,u)}},r}(df),D1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"regionFilter",locationType:"region",start:null,end:null,color:null,shape:[]})},r.prototype.renderInner=function(t){var n=this,i=this.get("start"),a=this.get("end"),o=this.addGroup(t,{id:this.getElementId("region-filter"),capture:!1});we(this.get("shapes"),function(u,l){var f=u.get("type"),h=Of(u.attr());n.adjustShapeAttrs(h),n.addShape(o,{id:n.getElementId("shape-"+f+"-"+l),capture:!1,type:f,attrs:h})});var s=lE({start:i,end:a});o.setClip({type:"rect",attrs:{x:s.minX,y:s.minY,width:s.width,height:s.height}})},r.prototype.adjustShapeAttrs=function(t){var n=this.get("color");t.fill&&(t.fill=t.fillStyle=n),t.stroke=t.strokeStyle=n},r}(df),B1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"shape",draw:ny})},r.prototype.renderInner=function(t){var n=this.get("render");kn(n)&&n(t)},r}(df),r4=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{container:null,containerTpl:"<div></div>",updateAutoRender:!0,containerClassName:"",parent:null})},r.prototype.getContainer=function(){return this.get("container")},r.prototype.show=function(){var t=this.get("container");t.style.display="",this.set("visible",!0)},r.prototype.hide=function(){var t=this.get("container");t.style.display="none",this.set("visible",!1)},r.prototype.setCapture=function(t){var n=this.getContainer(),i=t?"auto":"none";n.style.pointerEvents=i,this.set("capture",t)},r.prototype.getBBox=function(){var t=this.getContainer(),n=parseFloat(t.style.left)||0,i=parseFloat(t.style.top)||0;return SI(n,i,t.clientWidth,t.clientHeight)},r.prototype.clear=function(){var t=this.get("container");t4(t)},r.prototype.destroy=function(){this.removeEvent(),this.removeDom(),e.prototype.destroy.call(this)},r.prototype.init=function(){e.prototype.init.call(this),this.initContainer(),this.initDom(),this.resetStyles(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible()},r.prototype.initCapture=function(){this.setCapture(this.get("capture"))},r.prototype.initVisible=function(){this.get("visible")?this.show():this.hide()},r.prototype.initDom=function(){},r.prototype.initContainer=function(){var t=this.get("container");if(rr(t)){t=this.createDom();var n=this.get("parent");ei(n)&&(n=document.getElementById(n),this.set("parent",n)),n.appendChild(t),this.get("containerId")&&t.setAttribute("id",this.get("containerId")),this.set("container",t)}else ei(t)&&(t=document.getElementById(t),this.set("container",t));this.get("parent")||this.set("parent",t.parentNode)},r.prototype.resetStyles=function(){var t=this.get("domStyles"),n=this.get("defaultStyles");t?t=yn({},n,t):t=n,this.set("domStyles",t)},r.prototype.applyStyles=function(){var t=this.get("domStyles");if(!!t){var n=this.getContainer();this.applyChildrenStyles(n,t);var i=this.get("containerClassName");if(i&&d1e(n,i)){var a=t[i];es(n,a)}}},r.prototype.applyChildrenStyles=function(t,n){we(n,function(i,a){var o=t.getElementsByClassName(a);we(o,function(s){es(s,i)})})},r.prototype.applyStyle=function(t,n){var i=this.get("domStyles");es(n,i[t])},r.prototype.createDom=function(){var t=this.get("containerTpl");return ly(t)},r.prototype.initEvent=function(){},r.prototype.removeDom=function(){var t=this.get("container");t&&t.parentNode&&t.parentNode.removeChild(t)},r.prototype.removeEvent=function(){},r.prototype.updateInner=function(t){qg(t,"domStyles")&&(this.resetStyles(),this.applyStyles()),this.resetPosition()},r.prototype.resetPosition=function(){},r}(ZK),N1e=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"annotation",type:"html",locationType:"point",x:0,y:0,containerTpl:'<div class="g2-html-annotation" style="position:absolute"></div>',alignX:"left",alignY:"top",html:"",zIndex:7})},r.prototype.render=function(){var t=this.getContainer(),n=this.get("html");t4(t);var i=kn(n)?n(t):n;if(I3(i))t.appendChild(i);else if(ei(i)||xi(i)){var a=ly(""+i);a&&t.appendChild(a)}this.resetPosition()},r.prototype.resetPosition=function(){var t=this.getContainer(),n=this.getLocation(),i=n.x,a=n.y,o=this.get("alignX"),s=this.get("alignY"),u=this.get("offsetX"),l=this.get("offsetY"),f=Gge(t),h=Uge(t),p={x:i,y:a};o==="middle"?p.x-=Math.round(f/2):o==="right"&&(p.x-=Math.round(f)),s==="middle"?p.y-=Math.round(h/2):s==="bottom"&&(p.y-=Math.round(h)),u&&(p.x+=u),l&&(p.y+=l),es(t,{position:"absolute",left:p.x+"px",top:p.y+"px",zIndex:this.get("zIndex")})},r}(r4),z1e=Object.freeze(Object.defineProperty({__proto__:null,Line:L1e,Text:I1e,Arc:k1e,Region:P1e,Image:R1e,DataMarker:O1e,DataRegion:F1e,RegionFilter:D1e,Shape:B1e,Html:N1e},Symbol.toStringTag,{value:"Module"}));function _C(e,r,t){var n=r+"Style",i=null;return we(t,function(a,o){e[o]&&a[n]&&(i||(i={}),Na(i,a[n]))}),i}var qK=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"axis",ticks:[],line:{},tickLine:{},subTickLine:null,title:null,label:{},verticalFactor:1,verticalLimitLength:null,overlapOrder:["autoRotate","autoEllipsis","autoHide"],tickStates:{},optimize:{},defaultCfg:{line:{style:{lineWidth:1,stroke:ha.lineColor}},tickLine:{style:{lineWidth:1,stroke:ha.lineColor},alignTick:!0,length:5,displayWithLabel:!0},subTickLine:{style:{lineWidth:1,stroke:ha.lineColor},count:4,length:2},label:{autoRotate:!0,autoHide:!1,autoEllipsis:!1,style:{fontSize:12,fill:ha.textColor,fontFamily:ha.fontFamily,fontWeight:"normal"},offset:10,offsetX:0,offsetY:0},title:{autoRotate:!0,spacing:5,position:"center",style:{fontSize:12,fill:ha.textColor,textBaseline:"middle",fontFamily:ha.fontFamily,textAlign:"center"},iconStyle:{fill:ha.descriptionIconFill,stroke:ha.descriptionIconStroke},description:""},tickStates:{active:{labelStyle:{fontWeight:500},tickLineStyle:{lineWidth:2}},inactive:{labelStyle:{fill:ha.uncheckedColor}}},optimize:{enable:!0,threshold:400}},theme:{}})},r.prototype.renderInner=function(t){this.get("line")&&this.drawLine(t),this.drawTicks(t),this.get("title")&&this.drawTitle(t)},r.prototype.isList=function(){return!0},r.prototype.getItems=function(){return this.get("ticks")},r.prototype.setItems=function(t){this.update({ticks:t})},r.prototype.updateItem=function(t,n){Na(t,n),this.clear(),this.render()},r.prototype.clearItems=function(){var t=this.getElementByLocalId("label-group");t&&t.clear()},r.prototype.setItemState=function(t,n,i){t[n]=i,this.updateTickStates(t)},r.prototype.hasState=function(t,n){return!!t[n]},r.prototype.getItemStates=function(t){var n=this.get("tickStates"),i=[];return we(n,function(a,o){t[o]&&i.push(o)}),i},r.prototype.clearItemsState=function(t){var n=this,i=this.getItemsByState(t);we(i,function(a){n.setItemState(a,t,!1)})},r.prototype.getItemsByState=function(t){var n=this,i=this.getItems();return kc(i,function(a){return n.hasState(a,t)})},r.prototype.getSidePoint=function(t,n){var i=this,a=i.getSideVector(n,t);return{x:t.x+a[0],y:t.y+a[1]}},r.prototype.getTextAnchor=function(t){var n;return ac(t[0],0)?n="center":t[0]>0?n="start":t[0]<0&&(n="end"),n},r.prototype.getTextBaseline=function(t){var n;return ac(t[1],0)?n="middle":t[1]>0?n="top":t[1]<0&&(n="bottom"),n},r.prototype.processOverlap=function(t){},r.prototype.drawLine=function(t){var n=this.getLinePath(),i=this.get("line");this.addShape(t,{type:"path",id:this.getElementId("line"),name:"axis-line",attrs:Na({path:n},i.style)})},r.prototype.getTickLineItems=function(t){var n=this,i=[],a=this.get("tickLine"),o=a.alignTick,s=a.length,u=1,l=t.length;return l>=2&&(u=t[1].value-t[0].value),we(t,function(f){var h=f.point;o||(h=n.getTickPoint(f.value-u/2));var p=n.getSidePoint(h,s);i.push({startPoint:h,tickValue:f.value,endPoint:p,tickId:f.id,id:"tickline-"+f.id})}),i},r.prototype.getSubTickLineItems=function(t){var n=[],i=this.get("subTickLine"),a=i.count,o=t.length;if(o>=2)for(var s=0;s<o-1;s++)for(var u=t[s],l=t[s+1],f=0;f<a;f++){var h=(f+1)/(a+1),p=(1-h)*u.tickValue+h*l.tickValue,v=this.getTickPoint(p),m=this.getSidePoint(v,i.length);n.push({startPoint:v,endPoint:m,tickValue:p,id:"sub-"+u.id+"-"+f})}return n},r.prototype.getTickLineAttrs=function(t,n,i,a){var o=this.get(n).style,s={points:[t.startPoint,t.endPoint]},u=Ie(this.get("theme"),["tickLine","style"],{});o=kn(o)?Na({},u,o(s,i,a)):o;var l=t.startPoint,f=t.endPoint;return kr({x1:l.x,y1:l.y,x2:f.x,y2:f.y},o)},r.prototype.drawTick=function(t,n,i,a,o){this.addShape(n,{type:"line",id:this.getElementId(t.id),name:"axis-"+i,attrs:this.getTickLineAttrs(t,i,a,o)})},r.prototype.drawTickLines=function(t){var n=this,i=this.get("ticks"),a=this.get("subTickLine"),o=this.getTickLineItems(i),s=this.addGroup(t,{name:"axis-tickline-group",id:this.getElementId("tickline-group")}),u=this.get("tickLine");if(we(o,function(f,h){if(u.displayWithLabel){var p=n.getElementId("label-"+f.tickId);t.findById(p)&&n.drawTick(f,s,"tickLine",h,o)}else n.drawTick(f,s,"tickLine",h,o)}),a){var l=this.getSubTickLineItems(o);we(l,function(f,h){n.drawTick(f,s,"subTickLine",h,l)})}},r.prototype.processTicks=function(){var t=this,n=this.get("ticks");we(n,function(i){i.point=t.getTickPoint(i.value),rr(i.id)&&(i.id=i.name)})},r.prototype.drawTicks=function(t){var n=this;this.optimizeTicks(),this.processTicks(),this.get("label")&&this.drawLabels(t),this.get("tickLine")&&this.drawTickLines(t);var i=this.get("ticks");we(i,function(a){n.applyTickStates(a,t)})},r.prototype.optimizeTicks=function(){var t=this.get("optimize"),n=this.get("ticks");if(t&&t.enable&&t.threshold>0){var i=zl(n);if(i>t.threshold){var a=Math.ceil(i/t.threshold),o=n.filter(function(s,u){return u%a===0});this.set("ticks",o),this.set("originalTicks",n)}}},r.prototype.getLabelAttrs=function(t,n,i){var a=this.get("label"),o=a.offset,s=a.offsetX,u=a.offsetY,l=a.rotate,f=a.formatter,h=this.getSidePoint(t.point,o),p=this.getSideVector(o,h),v=f?f(t.name,t,n):t.name,m=a.style;m=kn(m)?Ie(this.get("theme"),["label","style"],{}):m;var x=Na({x:h.x+s,y:h.y+u,text:v,textAlign:this.getTextAnchor(p),textBaseline:this.getTextBaseline(p)},m);return l&&(x.matrix=Kx(h,l)),x},r.prototype.drawLabels=function(t){var n=this,i=this.get("ticks"),a=this.addGroup(t,{name:"axis-label-group",id:this.getElementId("label-group")});we(i,function(p,v){n.addShape(a,{type:"text",name:"axis-label",id:n.getElementId("label-"+p.id),attrs:n.getLabelAttrs(p,v,i),delegateObject:{tick:p,item:p,index:v}})}),this.processOverlap(a);var o=a.getChildren(),s=Ie(this.get("theme"),["label","style"],{}),u=this.get("label"),l=u.style,f=u.formatter;if(kn(l)){var h=o.map(function(p){return Ie(p.get("delegateObject"),"tick")});we(o,function(p,v){var m=p.get("delegateObject").tick,x=f?f(m.name,m,v):m.name,E=Na({},s,l(x,v,h));p.attr(E)})}},r.prototype.getTitleAttrs=function(){var t=this.get("title"),n=t.style,i=t.position,a=t.offset,o=t.spacing,s=o===void 0?0:o,u=t.autoRotate,l=n.fontSize,f=.5;i==="start"?f=0:i==="end"&&(f=1);var h=this.getTickPoint(f),p=this.getSidePoint(h,a||s+l/2),v=Na({x:p.x,y:p.y,text:t.text},n),m=t.rotate,x=m;if(rr(m)&&u){var E=this.getAxisVector(h),A=[1,0];x=N3(E,A,!0)}if(x){var L=Kx(p,x);v.matrix=L}return v},r.prototype.drawTitle=function(t){var n,i=this.getTitleAttrs(),a=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"axis-title",attrs:i});!((n=this.get("title"))===null||n===void 0)&&n.description&&this.drawDescriptionIcon(t,a,i.matrix)},r.prototype.drawDescriptionIcon=function(t,n,i){var a=this.addGroup(t,{name:"axis-description",id:this.getElementById("description")}),o=n.getBBox(),s=o.maxX,u=o.maxY,l=o.height,f=this.get("title").iconStyle,h=4,p=l/2,v=p/6,m=s+h,x=u-l/2,E=[m+p,x-p],A=E[0],L=E[1],k=[A+p,L+p],R=k[0],D=k[1],$=[A,D+p],j=$[0],H=$[1],ee=[m,L+p],U=ee[0],W=ee[1],Q=[m+p,x-l/4],te=Q[0],ie=Q[1],ve=[te,ie+v],me=ve[0],Re=ve[1],We=[me,Re+v],je=We[0],lt=We[1],dt=[je,lt+p*3/4],ct=dt[0],Tt=dt[1];this.addShape(a,{type:"path",id:this.getElementId("title-description-icon"),name:"axis-title-description-icon",attrs:kr({path:[["M",A,L],["A",p,p,0,0,1,R,D],["A",p,p,0,0,1,j,H],["A",p,p,0,0,1,U,W],["A",p,p,0,0,1,A,L],["M",te,ie],["L",me,Re],["M",je,lt],["L",ct,Tt]],lineWidth:v,matrix:i},f)}),this.addShape(a,{type:"rect",id:this.getElementId("title-description-rect"),name:"axis-title-description-rect",attrs:{x:m,y:x-l/2,width:l,height:l,stroke:"#000",fill:"#000",opacity:0,matrix:i,cursor:"pointer"}})},r.prototype.applyTickStates=function(t,n){var i=this.getItemStates(t);if(i.length){var a=this.get("tickStates"),o=this.getElementId("label-"+t.id),s=n.findById(o);if(s){var u=_C(t,"label",a);u&&s.attr(u)}var l=this.getElementId("tickline-"+t.id),f=n.findById(l);if(f){var h=_C(t,"tickLine",a);h&&f.attr(h)}}},r.prototype.updateTickStates=function(t){var n=this.getItemStates(t),i=this.get("tickStates"),a=this.get("label"),o=this.getElementByLocalId("label-"+t.id),s=this.get("tickLine"),u=this.getElementByLocalId("tickline-"+t.id);if(n.length){if(o){var l=_C(t,"label",i);l&&o.attr(l)}if(u){var f=_C(t,"tickLine",i);f&&u.attr(f)}}else o&&o.attr(a.style),u&&u.attr(s.style)},r}(df);function n4(e,r,t,n){var i=r.getChildren(),a=!1;return we(i,function(o){var s=NC(e,o,t,n);a=a||s}),a}function $1e(){return KK}function U1e(e,r,t){return n4(e,r,t,"head")}function KK(e,r,t){return n4(e,r,t,"tail")}function V1e(e,r,t){return n4(e,r,t,"middle")}var G1e=Object.freeze(Object.defineProperty({__proto__:null,getDefault:$1e,ellipsisHead:U1e,ellipsisTail:KK,ellipsisMiddle:V1e},Symbol.toStringTag,{value:"Module"}));function H1e(e){var r=e.attr("matrix");return r&&r[0]!==1}function QK(e){var r=H1e(e)?h1e(e.attr("matrix")):0;return r%360}function o5(e,r,t,n){var i=!1,a=QK(r),o=Math.abs(e?t.attr("y")-r.attr("y"):t.attr("x")-r.attr("x")),s=(e?t.attr("y")>r.attr("y"):t.attr("x")>r.attr("x"))?r.getBBox():t.getBBox();if(e){var u=Math.abs(Math.cos(a));VM(u,0,Math.PI/180)?i=s.width+n>o:i=s.height/u+n>o}else{var u=Math.abs(Math.sin(a));VM(u,0,Math.PI/180)?i=s.width+n>o:i=s.height/u+n>o}return i}function cE(e,r,t,n){var i=(n==null?void 0:n.minGap)||0,a=r.getChildren().slice().filter(function(v){return v.get("visible")});if(!a.length)return!1;var o=!1;t&&a.reverse();for(var s=a.length,u=a[0],l=u,f=1;f<s;f++){var h=a[f];h.getBBox();var p=o5(e,l,h,i);p?(h.hide(),o=!0):l=h}return o}function JK(e,r,t){var n=(t==null?void 0:t.minGap)||0,i=r.getChildren().slice();if(i.length<2)return!1;var a=!1,o=i[0],s=o.getBBox(),u=i[1],l=i.length,f=QK(o),h=Math.abs(e?u.attr("y")-o.attr("y"):u.attr("x")-o.attr("x")),p=0;if(e){var v=Math.abs(Math.cos(f));if(VM(v,0,Math.PI/180)){var m=a5(i);p=(m+n)/h}else p=(s.height/v+n)/h}else{var v=Math.abs(Math.sin(f));if(VM(v,0,Math.PI/180)){var m=a5(i);p=(m+n)/h}else p=(s.height/v+n)/h}if(p>1){p=Math.ceil(p);for(var x=0;x<l;x++)x%p!==0&&(i[x].hide(),a=!0)}return a}function j1e(){return eQ}function W1e(e,r,t,n){return cE(e,r,!1,n)}function X1e(e,r,t,n){return cE(e,r,!0,n)}function Y1e(e,r,t,n){var i=(n==null?void 0:n.minGap)||0,a=r.getChildren().slice();if(a.length<=2)return!1;for(var o=!1,s=a.length,u=a[0],l=a[s-1],f=u,h=1;h<s-1;h++){var p=a[h];p.getBBox();var v=o5(e,f,p,i);v?(p.hide(),o=!0):f=p}var m=o5(e,f,l,i);return m&&(f.hide(),o=!0),o}function eQ(e,r,t,n){var i=JK(e,r,n);return cE(e,r,!1)&&(i=!0),i}function Z1e(e,r,t,n){var i=r.getChildren().slice(),a=JK(e,r,n);if(i.length>2){var o=i[0],s=i[i.length-1];o.get("visible")||(o.show(),cE(e,r,!1,n)&&(a=!0)),s.get("visible")||(s.show(),cE(e,r,!0,n)&&(a=!0))}return a}var q1e=Object.freeze(Object.defineProperty({__proto__:null,getDefault:j1e,reserveFirst:W1e,reserveLast:X1e,reserveBoth:Y1e,equidistance:eQ,equidistanceWithReverseBoth:Z1e},Symbol.toStringTag,{value:"Module"}));function K1e(e,r){we(e,function(t){var n=t.attr("x"),i=t.attr("y"),a=Kx({x:n,y:i},r);t.attr("matrix",a)})}function tQ(e,r,t,n){var i=r.getChildren();if(!i.length||!e&&i.length<2)return!1;var a=a5(i),o=!1;if(e)o=!!t&&a>t;else{var s=Math.abs(i[1].attr("x")-i[0].attr("x"));o=a>s}if(o){var u=n(t,a);K1e(i,u)}return o}function Q1e(){return rQ}function rQ(e,r,t,n){return tQ(e,r,t,function(){return xi(n)?n:e?ha.verticalAxisRotate:ha.horizontalAxisRotate})}function J1e(e,r,t){return tQ(e,r,t,function(n,i){if(!n)return e?ha.verticalAxisRotate:ha.horizontalAxisRotate;if(e)return-Math.acos(n/i);var a=0;return n>i?a=Math.PI/4:(a=Math.asin(n/i),a>Math.PI/4&&(a=Math.PI/4)),a})}var ebe=Object.freeze(Object.defineProperty({__proto__:null,getDefault:Q1e,fixedAngle:rQ,unfixedAngle:J1e},Symbol.toStringTag,{value:"Module"})),nQ=Object.freeze(Object.defineProperty({__proto__:null,autoHide:q1e,autoRotate:ebe,autoEllipsis:G1e},Symbol.toStringTag,{value:"Module"})),tbe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{type:"line",locationType:"region",start:null,end:null})},r.prototype.getLinePath=function(){var t=this.get("start"),n=this.get("end"),i=[];return i.push(["M",t.x,t.y]),i.push(["L",n.x,n.y]),i},r.prototype.getInnerLayoutBBox=function(){var t=this.get("start"),n=this.get("end"),i=e.prototype.getInnerLayoutBBox.call(this),a=Math.min(t.x,n.x,i.x),o=Math.min(t.y,n.y,i.y),s=Math.max(t.x,n.x,i.maxX),u=Math.max(t.y,n.y,i.maxY);return{x:a,y:o,minX:a,minY:o,maxX:s,maxY:u,width:s-a,height:u-o}},r.prototype.isVertical=function(){var t=this.get("start"),n=this.get("end");return ac(t.x,n.x)},r.prototype.isHorizontal=function(){var t=this.get("start"),n=this.get("end");return ac(t.y,n.y)},r.prototype.getTickPoint=function(t){var n=this,i=n.get("start"),a=n.get("end"),o=a.x-i.x,s=a.y-i.y;return{x:i.x+o*t,y:i.y+s*t}},r.prototype.getSideVector=function(t){var n=this.getAxisVector(),i=Ud([0,0],n),a=this.get("verticalFactor"),o=[i[1],i[0]*-1];return ah([0,0],o,t*a)},r.prototype.getAxisVector=function(){var t=this.get("start"),n=this.get("end");return[n.x-t.x,n.y-t.y]},r.prototype.processOverlap=function(t){var n=this,i=this.isVertical(),a=this.isHorizontal();if(!(!i&&!a)){var o=this.get("label"),s=this.get("title"),u=this.get("verticalLimitLength"),l=o.offset,f=u,h=0,p=0;s&&(h=s.style.fontSize,p=s.spacing),f&&(f=f-l-p-h);var v=this.get("overlapOrder");if(we(v,function(E){o[E]&&n.canProcessOverlap(E)&&n.autoProcessOverlap(E,o[E],t,f)}),s&&rr(s.offset)){var m=t.getCanvasBBox(),x=i?m.width:m.height;s.offset=l+x+p+h/2}}},r.prototype.canProcessOverlap=function(t){var n=this.get("label");return t==="autoRotate"?rr(n.rotate):!0},r.prototype.autoProcessOverlap=function(t,n,i,a){var o=this,s=this.isVertical(),u=!1,l=nQ[t];if(n===!0)this.get("label"),u=l.getDefault()(s,i,a);else if(kn(n))u=n(s,i,a);else if(xo(n)){var f=n;l[f.type]&&(u=l[f.type](s,i,a,f.cfg))}else l[n]&&(u=l[n](s,i,a));if(t==="autoRotate"){if(u){var h=i.getChildren(),p=this.get("verticalFactor");we(h,function(m){var x=m.attr("textAlign");if(x==="center"){var E=p>0?"end":"start";m.attr("textAlign",E)}})}}else if(t==="autoHide"){var v=i.getChildren().slice(0);we(v,function(m){m.get("visible")||(o.get("isRegister")&&o.unregisterElement(m),m.remove())})}},r}(qK),rbe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{type:"circle",locationType:"circle",center:null,radius:null,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},r.prototype.getLinePath=function(){var t=this.get("center"),n=t.x,i=t.y,a=this.get("radius"),o=a,s=this.get("startAngle"),u=this.get("endAngle"),l=[];if(Math.abs(u-s)===Math.PI*2)l=[["M",n,i-o],["A",a,o,0,1,1,n,i+o],["A",a,o,0,1,1,n,i-o],["Z"]];else{var f=this.getCirclePoint(s),h=this.getCirclePoint(u),p=Math.abs(u-s)>Math.PI?1:0,v=s>u?0:1;l=[["M",n,i],["L",f.x,f.y],["A",a,o,0,p,v,h.x,h.y],["L",n,i]]}return l},r.prototype.getTickPoint=function(t){var n=this.get("startAngle"),i=this.get("endAngle"),a=n+(i-n)*t;return this.getCirclePoint(a)},r.prototype.getSideVector=function(t,n){var i=this.get("center"),a=[n.x-i.x,n.y-i.y],o=this.get("verticalFactor"),s=Hb(a);return ah(a,a,o*t/s),a},r.prototype.getAxisVector=function(t){var n=this.get("center"),i=[t.x-n.x,t.y-n.y];return[i[1],-1*i[0]]},r.prototype.getCirclePoint=function(t,n){var i=this.get("center");return n=n||this.get("radius"),{x:i.x+Math.cos(t)*n,y:i.y+Math.sin(t)*n}},r.prototype.canProcessOverlap=function(t){var n=this.get("label");return t==="autoRotate"?rr(n.rotate):!0},r.prototype.processOverlap=function(t){var n=this,i=this.get("label"),a=this.get("title"),o=this.get("verticalLimitLength"),s=i.offset,u=o,l=0,f=0;a&&(l=a.style.fontSize,f=a.spacing),u&&(u=u-s-f-l);var h=this.get("overlapOrder");if(we(h,function(v){i[v]&&n.canProcessOverlap(v)&&n.autoProcessOverlap(v,i[v],t,u)}),a&&rr(a.offset)){var p=t.getCanvasBBox().height;a.offset=s+p+f+l/2}},r.prototype.autoProcessOverlap=function(t,n,i,a){var o=this,s=!1,u=nQ[t];if(a>0)if(n===!0)s=u.getDefault()(!1,i,a);else if(kn(n))s=n(!1,i,a);else if(xo(n)){var l=n;u[l.type]&&(s=u[l.type](!1,i,a,l.cfg))}else u[n]&&(s=u[n](!1,i,a));if(t==="autoRotate"){if(s){var f=i.getChildren(),h=this.get("verticalFactor");we(f,function(v){var m=v.attr("textAlign");if(m==="center"){var x=h>0?"end":"start";v.attr("textAlign",x)}})}}else if(t==="autoHide"){var p=i.getChildren().slice(0);we(p,function(v){v.get("visible")||(o.get("isRegister")&&o.unregisterElement(v),v.remove())})}},r}(qK),i4=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"crosshair",type:"base",line:{},text:null,textBackground:{},capture:!1,defaultCfg:{line:{style:{lineWidth:1,stroke:ha.lineColor}},text:{position:"start",offset:10,autoRotate:!1,content:null,style:{fill:ha.textColor,textAlign:"center",textBaseline:"middle",fontFamily:ha.fontFamily}},textBackground:{padding:5,style:{stroke:ha.lineColor}}}})},r.prototype.renderInner=function(t){this.get("line")&&this.renderLine(t),this.get("text")&&(this.renderText(t),this.renderBackground(t))},r.prototype.renderText=function(t){var n=this.get("text"),i=n.style,a=n.autoRotate,o=n.content;if(!rr(o)){var s=this.getTextPoint(),u=null;if(a){var l=this.getRotateAngle();u=Kx(s,l)}this.addShape(t,{type:"text",name:"crosshair-text",id:this.getElementId("text"),attrs:kr(kr(kr({},s),{text:o,matrix:u}),i)})}},r.prototype.renderLine=function(t){var n=this.getLinePath(),i=this.get("line"),a=i.style;this.addShape(t,{type:"path",name:"crosshair-line",id:this.getElementId("line"),attrs:kr({path:n},a)})},r.prototype.renderBackground=function(t){var n=this.getElementId("text"),i=t.findById(n),a=this.get("textBackground");if(a&&i){var o=i.getBBox(),s=UM(a.padding),u=a.style,l=this.addShape(t,{type:"rect",name:"crosshair-text-background",id:this.getElementId("text-background"),attrs:kr({x:o.x-s[3],y:o.y-s[0],width:o.width+s[1]+s[3],height:o.height+s[0]+s[2],matrix:i.attr("matrix")},u)});l.toBack()}},r}(df),iQ=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{type:"line",locationType:"region",start:null,end:null})},r.prototype.getRotateAngle=function(){var t=this.getLocation(),n=t.start,i=t.end,a=this.get("text").position,o=Math.atan2(i.y-n.y,i.x-n.x),s=a==="start"?o-Math.PI/2:o+Math.PI/2;return s},r.prototype.getTextPoint=function(){var t=this.getLocation(),n=t.start,i=t.end,a=this.get("text"),o=a.position,s=a.offset;return YK(n,i,o,s)},r.prototype.getLinePath=function(){var t=this.getLocation(),n=t.start,i=t.end;return[["M",n.x,n.y],["L",i.x,i.y]]},r}(i4),nbe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{type:"circle",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},r.prototype.getRotateAngle=function(){var t=this.getLocation(),n=t.startAngle,i=t.endAngle,a=this.get("text").position,o=a==="start"?n+Math.PI/2:i-Math.PI/2;return o},r.prototype.getTextPoint=function(){var t=this.get("text"),n=t.position,i=t.offset,a=this.getLocation(),o=a.center,s=a.radius,u=a.startAngle,l=a.endAngle,f=n==="start"?u:l,h=this.getRotateAngle()-Math.PI,p=qb(o,s,f),v=Math.cos(h)*i,m=Math.sin(h)*i;return{x:p.x+v,y:p.y+m}},r.prototype.getLinePath=function(){var t=this.getLocation(),n=t.center,i=t.radius,a=t.startAngle,o=t.endAngle,s=null;if(o-a===Math.PI*2){var u=n.x,l=n.y;s=[["M",u,l-i],["A",i,i,0,1,1,u,l+i],["A",i,i,0,1,1,u,l-i],["Z"]]}else{var f=qb(n,i,a),h=qb(n,i,o),p=Math.abs(o-a)>Math.PI?1:0,v=a>o?0:1;s=[["M",f.x,f.y],["A",i,i,0,p,v,h.x,h.y]]}return s},r}(i4),fE="g2-crosshair",s5=fE+"-line",u5=fE+"-text",Fw,ibe=(Fw={},Fw[""+fE]={position:"relative"},Fw[""+s5]={position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.25)"},Fw[""+u5]={position:"absolute",color:ha.textColor,fontFamily:ha.fontFamily},Fw),abe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"crosshair",type:"html",locationType:"region",start:{x:0,y:0},end:{x:0,y:0},capture:!1,text:null,containerTpl:'<div class="'+fE+'"></div>',crosshairTpl:'<div class="'+s5+'"></div>',textTpl:'<span class="'+u5+'">{content}</span>',domStyles:null,containerClassName:fE,defaultStyles:ibe,defaultCfg:{text:{position:"start",content:null,align:"center",offset:10}}})},r.prototype.render=function(){this.resetText(),this.resetPosition()},r.prototype.initCrossHair=function(){var t=this.getContainer(),n=this.get("crosshairTpl"),i=ly(n);t.appendChild(i),this.applyStyle(s5,i),this.set("crosshairEl",i)},r.prototype.getTextPoint=function(){var t=this.getLocation(),n=t.start,i=t.end,a=this.get("text"),o=a.position,s=a.offset;return YK(n,i,o,s)},r.prototype.resetText=function(){var t=this.get("text"),n=this.get("textEl");if(t){var i=t.content;if(!n){var a=this.getContainer(),o=D2(this.get("textTpl"),t);n=ly(o),a.appendChild(n),this.applyStyle(u5,n),this.set("textEl",n)}n.innerHTML=i}else n&&n.remove()},r.prototype.isVertical=function(t,n){return t.x===n.x},r.prototype.resetPosition=function(){var t=this.get("crosshairEl");t||(this.initCrossHair(),t=this.get("crosshairEl"));var n=this.get("start"),i=this.get("end"),a=Math.min(n.x,i.x),o=Math.min(n.y,i.y);this.isVertical(n,i)?es(t,{width:"1px",height:np(Math.abs(i.y-n.y))}):es(t,{height:"1px",width:np(Math.abs(i.x-n.x))}),es(t,{top:np(o),left:np(a)}),this.alignText()},r.prototype.alignText=function(){var t=this.get("textEl");if(t){var n=this.get("text").align,i=t.clientWidth,a=this.getTextPoint();switch(n){case"center":a.x=a.x-i/2;break;case"right":a.x=a.x-i}es(t,{top:np(a.y),left:np(a.x)})}},r.prototype.updateInner=function(t){qg(t,"text")&&this.resetText(),e.prototype.updateInner.call(this,t)},r}(r4),Z8=Object.freeze(Object.defineProperty({__proto__:null,Line:iQ,Circle:nbe,Base:i4,Html:abe},Symbol.toStringTag,{value:"Module"})),aQ=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"grid",line:{},alternateColor:null,capture:!1,items:[],closed:!1,defaultCfg:{line:{type:"line",style:{lineWidth:1,stroke:ha.lineColor}}}})},r.prototype.getLineType=function(){var t=this.get("line")||this.get("defaultCfg").line;return t.type},r.prototype.renderInner=function(t){this.drawGrid(t)},r.prototype.getAlternatePath=function(t,n){var i=this.getGridPath(t),a=n.slice(0).reverse(),o=this.getGridPath(a,!0),s=this.get("closed");return s?i=i.concat(o):(o[0][0]="L",i=i.concat(o),i.push(["Z"])),i},r.prototype.getPathStyle=function(){return this.get("line").style},r.prototype.drawGrid=function(t){var n=this,i=this.get("line"),a=this.get("items"),o=this.get("alternateColor"),s=null;we(a,function(u,l){var f=u.id||l;if(i){var h=n.getPathStyle();h=kn(h)?h(u,l,a):h;var p=n.getElementId("line-"+f),v=n.getGridPath(u.points);n.addShape(t,{type:"path",name:"grid-line",id:p,attrs:Na({path:v},h)})}if(o&&l>0){var m=n.getElementId("region-"+f),x=l%2===0;if(ei(o))x&&n.drawAlternateRegion(m,t,s.points,u.points,o);else{var E=x?o[1]:o[0];n.drawAlternateRegion(m,t,s.points,u.points,E)}}s=u})},r.prototype.drawAlternateRegion=function(t,n,i,a,o){var s=this.getAlternatePath(i,a);this.addShape(n,{type:"path",id:t,name:"grid-region",attrs:{path:s,fill:o}})},r}(df);function obe(e,r,t,n){var i=t-e,a=n-r;return Math.sqrt(i*i+a*a)}var sbe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{type:"circle",center:null,closed:!0})},r.prototype.getGridPath=function(t,n){var i=this.getLineType(),a=this.get("closed"),o=[];if(t.length)if(i==="circle"){var s=this.get("center"),u=t[0],l=obe(s.x,s.y,u.x,u.y),f=n?0:1;a?(o.push(["M",s.x,s.y-l]),o.push(["A",l,l,0,0,f,s.x,s.y+l]),o.push(["A",l,l,0,0,f,s.x,s.y-l]),o.push(["Z"])):we(t,function(h,p){p===0?o.push(["M",h.x,h.y]):o.push(["A",l,l,0,0,f,h.x,h.y])})}else we(t,function(h,p){p===0?o.push(["M",h.x,h.y]):o.push(["L",h.x,h.y])}),a&&o.push(["Z"]);return o},r}(aQ),ube=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{type:"line"})},r.prototype.getGridPath=function(t){var n=[];return we(t,function(i,a){a===0?n.push(["M",i.x,i.y]):n.push(["L",i.x,i.y])}),n},r}(aQ),oQ=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"legend",layout:"horizontal",locationType:"point",x:0,y:0,offsetX:0,offsetY:0,title:null,background:null})},r.prototype.getLayoutBBox=function(){var t=e.prototype.getLayoutBBox.call(this),n=this.get("maxWidth"),i=this.get("maxHeight"),a=t.width,o=t.height;return n&&(a=Math.min(a,n)),i&&(o=Math.min(o,i)),SI(t.minX,t.minY,a,o)},r.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},r.prototype.resetLocation=function(){var t=this.get("x"),n=this.get("y"),i=this.get("offsetX"),a=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t+i,y:n+a})},r.prototype.applyOffset=function(){this.resetLocation()},r.prototype.getDrawPoint=function(){return this.get("currentPoint")},r.prototype.setDrawPoint=function(t){return this.set("currentPoint",t)},r.prototype.renderInner=function(t){this.resetDraw(),this.get("title")&&this.drawTitle(t),this.drawLegendContent(t),this.get("background")&&this.drawBackground(t)},r.prototype.drawBackground=function(t){var n=this.get("background"),i=t.getBBox(),a=UM(n.padding),o=kr({x:0,y:0,width:i.width+a[1]+a[3],height:i.height+a[0]+a[2]},n.style),s=this.addShape(t,{type:"rect",id:this.getElementId("background"),name:"legend-background",attrs:o});s.toBack()},r.prototype.drawTitle=function(t){var n=this.get("currentPoint"),i=this.get("title"),a=i.spacing,o=i.style,s=i.text,u=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"legend-title",attrs:kr({text:s,x:n.x,y:n.y},o)}),l=u.getBBox();this.set("currentPoint",{x:n.x,y:l.maxY+a})},r.prototype.resetDraw=function(){var t=this.get("background"),n={x:0,y:0};if(t){var i=UM(t.padding);n.x=i[3],n.y=i[0]}this.set("currentPoint",n)},r}(df),_R={marker:{style:{inactiveFill:"#000",inactiveOpacity:.45,fill:"#000",opacity:1,size:12}},text:{style:{fill:"#ccc",fontSize:12}}},FA={fill:ha.textColor,fontSize:12,textAlign:"start",textBaseline:"middle",fontFamily:ha.fontFamily,fontWeight:"normal",lineHeight:12},xR="navigation-arrow-right",bR="navigation-arrow-left",q8={right:90*Math.PI/180,left:(360-90)*Math.PI/180,up:0,down:180*Math.PI/180},lbe=function(e){os(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.currentPageIndex=1,t.totalPagesCnt=1,t.pageWidth=0,t.pageHeight=0,t.startX=0,t.startY=0,t.onNavigationBack=function(){var n=t.getElementByLocalId("item-group");if(t.currentPageIndex>1){t.currentPageIndex-=1,t.updateNavigation();var i=t.getCurrentNavigationMatrix();t.get("animate")?n.animate({matrix:i},100):n.attr({matrix:i})}},t.onNavigationAfter=function(){var n=t.getElementByLocalId("item-group");if(t.currentPageIndex<t.totalPagesCnt){t.currentPageIndex+=1,t.updateNavigation();var i=t.getCurrentNavigationMatrix();t.get("animate")?n.animate({matrix:i},100):n.attr({matrix:i})}},t}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"legend",type:"category",itemSpacing:24,itemMarginBottom:8,maxItemWidth:null,itemWidth:null,itemHeight:null,itemName:{},itemValue:null,maxWidth:null,maxHeight:null,marker:{},radio:null,items:[],itemStates:{},itemBackground:{},pageNavigator:{},defaultCfg:{title:{spacing:5,style:{fill:ha.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}},background:{padding:5,style:{stroke:ha.lineColor}},itemBackground:{style:{opacity:0,fill:"#fff"}},pageNavigator:_R,itemName:{spacing:16,style:FA},marker:{spacing:8,style:{r:6,symbol:"circle"}},itemValue:{alignRight:!1,formatter:null,style:FA,spacing:6},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:ha.uncheckedColor},markerStyle:{fill:ha.uncheckedColor,stroke:ha.uncheckedColor}},inactive:{nameStyle:{fill:ha.uncheckedColor},markerStyle:{opacity:.2}}}}})},r.prototype.isList=function(){return!0},r.prototype.getItems=function(){return this.get("items")},r.prototype.setItems=function(t){this.update({items:t})},r.prototype.updateItem=function(t,n){Na(t,n),this.clear(),this.render()},r.prototype.clearItems=function(){var t=this.getElementByLocalId("item-group");t&&t.clear()},r.prototype.setItemState=function(t,n,i){t[n]=i;var a=this.getElementByLocalId("item-"+t.id);if(a){var o=this.getItems(),s=o.indexOf(t),u=this.createOffScreenGroup(),l=this.drawItem(t,s,this.getItemHeight(),u);this.updateElements(l,a),this.clearUpdateStatus(a)}},r.prototype.hasState=function(t,n){return!!t[n]},r.prototype.getItemStates=function(t){var n=this.get("itemStates"),i=[];return we(n,function(a,o){t[o]&&i.push(o)}),i},r.prototype.clearItemsState=function(t){var n=this,i=this.getItemsByState(t);we(i,function(a){n.setItemState(a,t,!1)})},r.prototype.getItemsByState=function(t){var n=this,i=this.getItems();return kc(i,function(a){return n.hasState(a,t)})},r.prototype.drawLegendContent=function(t){this.processItems(),this.drawItems(t)},r.prototype.processItems=function(){var t=this.get("items");we(t,function(n){n.id||(n.id=n.name)})},r.prototype.drawItems=function(t){var n=this,i=this.addGroup(t,{id:this.getElementId("item-container-group"),name:"legend-item-container-group"}),a=this.addGroup(i,{id:this.getElementId("item-group"),name:"legend-item-group"}),o=this.getItemHeight(),s=this.get("itemWidth"),u=this.get("itemSpacing"),l=this.get("itemMarginBottom"),f=this.get("currentPoint"),h=f.x,p=f.y,v=this.get("layout"),m=this.get("items"),x=!1,E=0,A=this.get("maxWidth"),L=this.get("maxHeight");we(m,function(k,R){var D=n.drawItem(k,R,o,a),$=D.getBBox(),j=s||$.width;j>E&&(E=j),v==="horizontal"?(A&&A<f.x+j-h&&(x=!0,f.x=h,f.y+=o+l),n.moveElementTo(D,f),f.x+=j+u):(L&&L<f.y+o+l-p&&(x=!0,f.x+=E+u,f.y=p,E=0),n.moveElementTo(D,f),f.y+=o+l)}),x&&this.get("flipPage")&&(this.pageHeight=0,this.pageWidth=0,this.totalPagesCnt=1,this.startX=h,this.startY=p,this.adjustNavigation(t,a))},r.prototype.getItemHeight=function(){var t=this.get("itemHeight");if(!t){var n=(this.get("itemName")||{}).style;if(kn(n)){var i=this.getItems();i.forEach(function(a,o){var s=kr(kr({},FA),n(a,o,i)).fontSize;t<s&&(t=s)})}else n&&(t=n.fontSize)}return t},r.prototype.drawMarker=function(t,n,i,a){var o=kr(kr(kr({x:0,y:a/2},n.style),{symbol:Ie(i.marker,"symbol","circle")}),Ie(i.marker,"style",{})),s=this.addShape(t,{type:"marker",id:this.getElementId("item-"+i.id+"-marker"),name:"legend-item-marker",attrs:o}),u=s.getBBox();s.attr("x",u.width/2);var l=s.attr(),f=l.stroke,h=l.fill;return f&&s.set("isStroke",!0),h&&s.set("isFill",!0),s},r.prototype.drawItemText=function(t,n,i,a,o,s,u){var l=i.formatter,f=i.style,h=kr(kr({x:s,y:o/2,text:l?l(a[n],a,u):a[n]},FA),kn(f)?f(a,u,this.getItems()):f);return this.addShape(t,{type:"text",id:this.getElementId("item-"+a.id+"-"+n),name:"legend-item-"+n,attrs:h})},r.prototype.drawRadio=function(t,n,i,a,o){var s,u,l=n.style||{},f=(s=l.r)!==null&&s!==void 0?s:a/2,h=f*3.6/8,p=[o+f,a/2-f],v=p[0],m=p[1],x=[v+f,m+f],E=x[0],A=x[1],L=[v,A+f],k=L[0],R=L[1],D=[o,m+f],$=D[0],j=D[1],H=i.showRadio,ee=kr(kr({path:[["M",v,m],["A",f,f,0,0,1,E,A],["L",E-h,A],["L",E,A],["A",f,f,0,0,1,k,R],["L",k,R-h],["L",k,R],["A",f,f,0,0,1,$,j],["L",$+h,j],["L",$,j],["A",f,f,0,0,1,v,m],["L",v,m+h]],stroke:"#000000",fill:"#ffffff"},l),{opacity:H?(u=l==null?void 0:l.opacity)!==null&&u!==void 0?u:.45:0}),U=this.addShape(t,{type:"path",id:this.getElementId("item-"+i.id+"-radio"),name:"legend-item-radio",attrs:ee});return U.set("tip",n.tip),U},r.prototype.drawItem=function(t,n,i,a){var o="item-"+t.id,s=this.addGroup(a,{name:"legend-item-container",id:this.getElementId("item-container-"+o),delegateObject:{item:t,index:n}}),u=this.addGroup(s,{name:"legend-item",id:this.getElementId(o),delegateObject:{item:t,index:n}}),l=this.get("marker"),f=this.get("itemName"),h=this.get("itemValue"),p=this.get("itemBackground"),v=this.get("radio"),m=this.getLimitItemWidth(),x=0;if(l){var E=this.drawMarker(u,l,t,i),A=l.spacing,L=Ie(t,["marker","spacing"]);xi(L)&&(A=L),x=E.getBBox().maxX+A}if(f){var k=this.drawItemText(u,"name",f,t,i,x,n);m&&NC(!0,k,_s(m-x,0,m)),x=k.getBBox().maxX+f.spacing}if(h){var R=this.drawItemText(u,"value",h,t,i,x,n);m&&(h.alignRight?(R.attr({textAlign:"right",x:m}),NC(!0,R,_s(m-x,0,m),"head")):NC(!0,R,_s(m-x,0,m))),x=R.getBBox().maxX+h.spacing}if(v&&this.drawRadio(u,v,t,i,x),p){var D=u.getBBox(),$=this.addShape(u,{type:"rect",name:"legend-item-background",id:this.getElementId(o+"-background"),attrs:kr({x:0,y:0,width:D.width,height:i},p.style)});$.toBack()}return this.applyItemStates(t,u),u},r.prototype.adjustNavigation=function(t,n){var i=this,a=this.startX,o=this.startY,s=this.get("layout"),u=n.findAll(function(U){return U.get("name")==="legend-item"}),l=this.get("maxWidth"),f=this.get("maxHeight"),h=this.get("itemWidth"),p=this.get("itemSpacing"),v=this.getItemHeight(),m=yn({},_R,this.get("pageNavigator")),x=this.drawNavigation(t,s,"00/00",m),E=x.getBBox(),A={x:a,y:o},L=1,k=0,R=0,D=0,$=this.get("itemMarginBottom");if(s==="horizontal"){var j=this.get("maxRow")||1,H=v+(j===1?0:$);this.pageHeight=H*j,we(u,function(U){var W=U.getBBox(),Q=h||W.width;(k&&k<A.x+Q+p||l<A.x+Q+p+E.width)&&(L===1&&(k=A.x+p,i.pageWidth=k,i.moveElementTo(x,{x:l-p-E.width-E.minX,y:A.y+v/2-E.height/2-E.minY})),L+=1,A.x=a,A.y+=H),i.moveElementTo(U,A),U.getParent().setClip({type:"rect",attrs:{x:A.x,y:A.y,width:Q+p,height:v}}),A.x+=Q+p})}else{we(u,function(U){var W=U.getBBox();W.width>R&&(R=W.width)}),D=R,R+=p,l&&(R=Math.min(l,R),D=Math.min(l,D)),this.pageWidth=R,this.pageHeight=f-Math.max(E.height,v+$);var ee=Math.floor(this.pageHeight/(v+$));we(u,function(U,W){W!==0&&W%ee===0&&(L+=1,A.x+=R,A.y=o),i.moveElementTo(U,A),U.getParent().setClip({type:"rect",attrs:{x:A.x,y:A.y,width:R,height:v}}),A.y+=v+$}),this.totalPagesCnt=L,this.moveElementTo(x,{x:a+D/2-E.width/2-E.minX,y:f-E.height-E.minY})}this.pageHeight&&this.pageWidth&&n.getParent().setClip({type:"rect",attrs:{x:this.startX,y:this.startY,width:this.pageWidth,height:this.pageHeight}}),s==="horizontal"&&this.get("maxRow")?this.totalPagesCnt=Math.ceil(L/this.get("maxRow")):this.totalPagesCnt=L,this.currentPageIndex>this.totalPagesCnt&&(this.currentPageIndex=1),this.updateNavigation(x),n.attr("matrix",this.getCurrentNavigationMatrix())},r.prototype.drawNavigation=function(t,n,i,a){var o={x:0,y:0},s=this.addGroup(t,{id:this.getElementId("navigation-group"),name:"legend-navigation"}),u=Ie(a.marker,"style",{}),l=u.size,f=l===void 0?12:l,h=J3(u,["size"]),p=this.drawArrow(s,o,bR,n==="horizontal"?"up":"left",f,h);p.on("click",this.onNavigationBack);var v=p.getBBox();o.x+=v.width+2;var m=this.addShape(s,{type:"text",id:this.getElementId("navigation-text"),name:"navigation-text",attrs:kr({x:o.x,y:o.y+f/2,text:i,textBaseline:"middle"},Ie(a.text,"style"))}),x=m.getBBox();o.x+=x.width+2;var E=this.drawArrow(s,o,xR,n==="horizontal"?"down":"right",f,h);return E.on("click",this.onNavigationAfter),s},r.prototype.updateNavigation=function(t){var n=yn({},_R,this.get("pageNavigator")),i=n.marker.style,a=i.fill,o=i.opacity,s=i.inactiveFill,u=i.inactiveOpacity,l=this.currentPageIndex+"/"+this.totalPagesCnt,f=t?t.getChildren()[1]:this.getElementByLocalId("navigation-text"),h=t?t.findById(this.getElementId(bR)):this.getElementByLocalId(bR),p=t?t.findById(this.getElementId(xR)):this.getElementByLocalId(xR);f.attr("text",l),h.attr("opacity",this.currentPageIndex===1?u:o),h.attr("fill",this.currentPageIndex===1?s:a),h.attr("cursor",this.currentPageIndex===1?"not-allowed":"pointer"),p.attr("opacity",this.currentPageIndex===this.totalPagesCnt?u:o),p.attr("fill",this.currentPageIndex===this.totalPagesCnt?s:a),p.attr("cursor",this.currentPageIndex===this.totalPagesCnt?"not-allowed":"pointer");var v=h.getBBox().maxX+2;f.attr("x",v),v+=f.getBBox().width+2,this.updateArrowPath(p,{x:v,y:0})},r.prototype.drawArrow=function(t,n,i,a,o,s){var u=n.x,l=n.y,f=this.addShape(t,{type:"path",id:this.getElementId(i),name:i,attrs:kr({size:o,direction:a,path:[["M",u+o/2,l],["L",u,l+o],["L",u+o,l+o],["Z"]],cursor:"pointer"},s)});return f.attr("matrix",Kx({x:u+o/2,y:l+o/2},q8[a])),f},r.prototype.updateArrowPath=function(t,n){var i=n.x,a=n.y,o=t.attr(),s=o.size,u=o.direction,l=Kx({x:i+s/2,y:a+s/2},q8[u]);t.attr("path",[["M",i+s/2,a],["L",i,a+s],["L",i+s,a+s],["Z"]]),t.attr("matrix",l)},r.prototype.getCurrentNavigationMatrix=function(){var t=this,n=t.currentPageIndex,i=t.pageWidth,a=t.pageHeight,o=this.get("layout"),s=o==="horizontal"?{x:0,y:a*(1-n)}:{x:i*(1-n),y:0};return e4(s)},r.prototype.applyItemStates=function(t,n){var i=this.getItemStates(t),a=i.length>0;if(a){var o=n.getChildren(),s=this.get("itemStates");we(o,function(u){var l=u.get("name"),f=l.split("-")[2],h=_C(t,f,s);h&&(u.attr(h),f==="marker"&&!(u.get("isStroke")&&u.get("isFill"))&&(u.get("isStroke")&&u.attr("fill",null),u.get("isFill")&&u.attr("stroke",null)))})}},r.prototype.getLimitItemWidth=function(){var t=this.get("itemWidth"),n=this.get("maxItemWidth");return n?t&&(n=t<=n?t:n):t&&(n=t),n},r}(oQ),cbe=1.4,K8=.4,fbe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{type:"continue",min:0,max:100,value:null,colors:[],track:{},rail:{},label:{},handler:{},slidable:!0,tip:null,step:null,maxWidth:null,maxHeight:null,defaultCfg:{label:{align:"rail",spacing:5,formatter:null,style:{fontSize:12,fill:ha.textColor,textBaseline:"middle",fontFamily:ha.fontFamily}},handler:{size:10,style:{fill:"#fff",stroke:"#333"}},track:{},rail:{type:"color",size:20,defaultLength:100,style:{fill:"#DCDEE2"}},title:{spacing:5,style:{fill:ha.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}}}})},r.prototype.isSlider=function(){return!0},r.prototype.getValue=function(){return this.getCurrentValue()},r.prototype.getRange=function(){return{min:this.get("min"),max:this.get("max")}},r.prototype.setRange=function(t,n){this.update({min:t,max:n})},r.prototype.setValue=function(t){var n=this.getValue();this.set("value",t);var i=this.get("group");this.resetTrackClip(),this.get("slidable")&&this.resetHandlers(i),this.delegateEmit("valuechanged",{originValue:n,value:t})},r.prototype.initEvent=function(){var t=this.get("group");this.bindSliderEvent(t),this.bindRailEvent(t),this.bindTrackEvent(t)},r.prototype.drawLegendContent=function(t){this.drawRail(t),this.drawLabels(t),this.fixedElements(t),this.resetTrack(t),this.resetTrackClip(t),this.get("slidable")&&this.resetHandlers(t)},r.prototype.bindSliderEvent=function(t){this.bindHandlersEvent(t)},r.prototype.bindHandlersEvent=function(t){var n=this;t.on("legend-handler-min:drag",function(i){var a=n.getValueByCanvasPoint(i.x,i.y),o=n.getCurrentValue(),s=o[1];s<a&&(s=a),n.setValue([a,s])}),t.on("legend-handler-max:drag",function(i){var a=n.getValueByCanvasPoint(i.x,i.y),o=n.getCurrentValue(),s=o[0];s>a&&(s=a),n.setValue([s,a])})},r.prototype.bindRailEvent=function(t){},r.prototype.bindTrackEvent=function(t){var n=this,i=null;t.on("legend-track:dragstart",function(a){i={x:a.x,y:a.y}}),t.on("legend-track:drag",function(a){if(!!i){var o=n.getValueByCanvasPoint(i.x,i.y),s=n.getValueByCanvasPoint(a.x,a.y),u=n.getCurrentValue(),l=u[1]-u[0],f=n.getRange(),h=s-o;h<0?u[0]+h>f.min?n.setValue([u[0]+h,u[1]+h]):n.setValue([f.min,f.min+l]):h>0&&(h>0&&u[1]+h<f.max?n.setValue([u[0]+h,u[1]+h]):n.setValue([f.max-l,f.max])),i={x:a.x,y:a.y}}}),t.on("legend-track:dragend",function(a){i=null})},r.prototype.drawLabels=function(t){this.drawLabel("min",t),this.drawLabel("max",t)},r.prototype.drawLabel=function(t,n){var i=this.get("label"),a=i.style,o=i.align,s=i.formatter,u=this.get(t),l=this.getLabelAlignAttrs(t,o),f="label-"+t;this.addShape(n,{type:"text",id:this.getElementId(f),name:"legend-label-"+t,attrs:kr(kr({x:0,y:0,text:kn(s)?s(u):u},a),l)})},r.prototype.getLabelAlignAttrs=function(t,n){var i=this.isVertical(),a="center",o="middle";return i?(a="start",n!=="rail"?t==="min"?o="top":o="bottom":o="top"):n!=="rail"?(o="top",t==="min"?a="start":a="end"):(a="start",o="middle"),{textAlign:a,textBaseline:o}},r.prototype.getRailPath=function(t,n,i,a){var o=this.get("rail"),s=o.size,u=o.defaultLength,l=o.type,f=this.isVertical(),h=u,p=i,v=a;p||(p=f?s:h),v||(v=f?h:s);var m=[];return l==="color"?(m.push(["M",t,n]),m.push(["L",t+p,n]),m.push(["L",t+p,n+v]),m.push(["L",t,n+v]),m.push(["Z"])):(m.push(["M",t+p,n]),m.push(["L",t+p,n+v]),m.push(["L",t,n+v]),m.push(["Z"])),m},r.prototype.drawRail=function(t){var n=this.get("rail"),i=n.style;this.addShape(t,{type:"path",id:this.getElementId("rail"),name:"legend-rail",attrs:kr({path:this.getRailPath(0,0)},i)})},r.prototype.getTrackColor=function(t){var n=t.length;if(!n)return null;if(n===1)return t[0];var i;this.isVertical()?i="l(90)":i="l(0)";for(var a=0;a<n;a++){var o=a/(n-1);i+=" "+o+":"+t[a]}return i},r.prototype.getTrackPath=function(t){var n=this.getRailShape(t),i=n.attr("path");return Of(i)},r.prototype.getClipTrackAttrs=function(t){var n=this.getCurrentValue(),i=n[0],a=n[1],o=this.getRailBBox(t),s=this.getPointByValue(i,t),u=this.getPointByValue(a,t),l=this.isVertical(),f,h,p,v;return l?(f=o.minX,h=s.y,p=o.width,v=u.y-s.y):(f=s.x,h=o.minY,p=u.x-s.x,v=o.height),{x:f,y:h,width:p,height:v}},r.prototype.getTrackAttrs=function(t){var n=this.get("track"),i=this.get("colors"),a=this.getTrackPath(t);return Na({path:a,fill:this.getTrackColor(i)},n.style)},r.prototype.resetTrackClip=function(t){var n=t||this.get("group"),i=this.getElementId("track"),a=n.findById(i),o=a.getClip(),s=this.getClipTrackAttrs(t);o?o.attr(s):a.setClip({type:"rect",attrs:s})},r.prototype.resetTrack=function(t){var n=this.getElementId("track"),i=t.findById(n),a=this.getTrackAttrs(t);i?i.attr(a):this.addShape(t,{type:"path",id:n,draggable:this.get("slidable"),name:"legend-track",attrs:a})},r.prototype.getPointByValue=function(t,n){var i=this.getRange(),a=i.min,o=i.max,s=(t-a)/(o-a),u=this.getRailBBox(n),l=this.isVertical(),f={x:0,y:0};return l?(f.x=u.minX+u.width/2,f.y=Vx(u.minY,u.maxY,s)):(f.x=Vx(u.minX,u.maxX,s),f.y=u.minY+u.height/2),f},r.prototype.getRailShape=function(t){var n=t||this.get("group");return n.findById(this.getElementId("rail"))},r.prototype.getRailBBox=function(t){var n=this.getRailShape(t),i=n.getBBox();return i},r.prototype.getRailCanvasBBox=function(){var t=this.get("group"),n=t.findById(this.getElementId("rail")),i=n.getCanvasBBox();return i},r.prototype.isVertical=function(){return this.get("layout")==="vertical"},r.prototype.getValueByCanvasPoint=function(t,n){var i=this.getRange(),a=i.min,o=i.max,s=this.getRailCanvasBBox(),u=this.isVertical(),l=this.get("step"),f;u?f=(n-s.minY)/s.height:f=(t-s.minX)/s.width;var h=Vx(a,o,f);if(l){var p=Math.round((h-a)/l);h=a+p*l}return h>o&&(h=o),h<a&&(h=a),h},r.prototype.getCurrentValue=function(){var t=this.get("value");if(!t){var n=this.get("values");return n?[Math.max(Math.min.apply(Math,i5(n,[this.get("max")])),this.get("min")),Math.min(Math.max.apply(Math,i5(n,[this.get("min")])),this.get("max"))]:[this.get("min"),this.get("max")]}return t},r.prototype.resetHandlers=function(t){var n=this.getCurrentValue(),i=n[0],a=n[1];this.resetHandler(t,"min",i),this.resetHandler(t,"max",a)},r.prototype.getHandlerPath=function(t,n){var i=this.isVertical(),a=[],o=t.size,s=n.x,u=n.y,l=o*cbe,f=o/2,h=o/6;if(i){var p=s+l*K8;a.push(["M",s,u]),a.push(["L",p,u+f]),a.push(["L",s+l,u+f]),a.push(["L",s+l,u-f]),a.push(["L",p,u-f]),a.push(["Z"]),a.push(["M",p,u+h]),a.push(["L",s+l-2,u+h]),a.push(["M",p,u-h]),a.push(["L",s+l-2,u-h])}else{var v=u+l*K8;a.push(["M",s,u]),a.push(["L",s-f,v]),a.push(["L",s-f,u+l]),a.push(["L",s+f,u+l]),a.push(["L",s+f,v]),a.push(["Z"]),a.push(["M",s-h,v]),a.push(["L",s-h,u+l-2]),a.push(["M",s+h,v]),a.push(["L",s+h,u+l-2])}return a},r.prototype.resetHandler=function(t,n,i){var a=this.getPointByValue(i,t),o=this.get("handler"),s=this.getHandlerPath(o,a),u=this.getElementId("handler-"+n),l=t.findById(u),f=this.isVertical();l?l.attr("path",s):this.addShape(t,{type:"path",name:"legend-handler-"+n,draggable:!0,id:u,attrs:kr(kr({path:s},o.style),{cursor:f?"ns-resize":"ew-resize"})})},r.prototype.fixedElements=function(t){var n=t.findById(this.getElementId("rail")),i=t.findById(this.getElementId("label-min")),a=t.findById(this.getElementId("label-max")),o=this.getDrawPoint();this.isVertical()?this.fixedVertail(i,a,n,o):this.fixedHorizontal(i,a,n,o)},r.prototype.fitRailLength=function(t,n,i,a){var o=this.isVertical(),s=o?"height":"width",u=this.get("label"),l=u.align,f=u.spacing,h=this.get("max"+g_(s));if(h){var p=l==="rail"?i[s]+t[s]+n[s]+f*2:i[s],v=p-h;v>0&&this.changeRailLength(a,s,i[s]-v)}},r.prototype.changeRailLength=function(t,n,i){var a=t.getBBox(),o;n==="height"?o=this.getRailPath(a.x,a.y,a.width,i):o=this.getRailPath(a.x,a.y,i,a.height),t.attr("path",o)},r.prototype.changeRailPosition=function(t,n,i){var a=t.getBBox(),o=this.getRailPath(n,i,a.width,a.height);t.attr("path",o)},r.prototype.fixedHorizontal=function(t,n,i,a){var o=this.get("label"),s=o.align,u=o.spacing,l=i.getBBox(),f=t.getBBox(),h=n.getBBox(),p=l.height;this.fitRailLength(f,h,l,i),l=i.getBBox(),s==="rail"?(t.attr({x:a.x,y:a.y+p/2}),this.changeRailPosition(i,a.x+f.width+u,a.y),n.attr({x:a.x+f.width+l.width+u*2,y:a.y+p/2})):s==="top"?(t.attr({x:a.x,y:a.y}),n.attr({x:a.x+l.width,y:a.y}),this.changeRailPosition(i,a.x,a.y+f.height+u)):(this.changeRailPosition(i,a.x,a.y),t.attr({x:a.x,y:a.y+l.height+u}),n.attr({x:a.x+l.width,y:a.y+l.height+u}))},r.prototype.fixedVertail=function(t,n,i,a){var o=this.get("label"),s=o.align,u=o.spacing,l=i.getBBox(),f=t.getBBox(),h=n.getBBox();if(this.fitRailLength(f,h,l,i),l=i.getBBox(),s==="rail")t.attr({x:a.x,y:a.y}),this.changeRailPosition(i,a.x,a.y+f.height+u),n.attr({x:a.x,y:a.y+f.height+l.height+u*2});else if(s==="right")t.attr({x:a.x+l.width+u,y:a.y}),this.changeRailPosition(i,a.x,a.y),n.attr({x:a.x+l.width+u,y:a.y+l.height});else{var p=Math.max(f.width,h.width);t.attr({x:a.x,y:a.y}),this.changeRailPosition(i,a.x+p+u,a.y),n.attr({x:a.x,y:a.y+l.height})}},r}(oQ),xy="g2-tooltip",by="g2-tooltip-title",hE="g2-tooltip-list",TI="g2-tooltip-list-item",MI="g2-tooltip-marker",LI="g2-tooltip-value",sQ="g2-tooltip-name",a4="g2-tooltip-crosshair-x",o4="g2-tooltip-crosshair-y",hbe=Object.freeze(Object.defineProperty({__proto__:null,CONTAINER_CLASS:xy,TITLE_CLASS:by,LIST_CLASS:hE,LIST_ITEM_CLASS:TI,MARKER_CLASS:MI,VALUE_CLASS:LI,NAME_CLASS:sQ,CROSSHAIR_X:a4,CROSSHAIR_Y:o4},Symbol.toStringTag,{value:"Module"})),kg,pbe=(kg={},kg[""+xy]={position:"absolute",visibility:"visible",zIndex:8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0px 0px 10px #aeaeae",borderRadius:"3px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:ha.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},kg[""+by]={marginBottom:"4px"},kg[""+hE]={margin:"0px",listStyleType:"none",padding:"0px"},kg[""+TI]={listStyleType:"none",marginBottom:"4px"},kg[""+MI]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},kg[""+LI]={display:"inline-block",float:"right",marginLeft:"30px"},kg[""+a4]={position:"absolute",width:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},kg[""+o4]={position:"absolute",height:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},kg);function dbe(e,r,t,n,i){var a={left:e<i.x,right:e+t>i.x+i.width,top:r<i.y,bottom:r+n>i.y+i.height};return a}function vbe(e,r,t,n,i,a){var o=e,s=r;switch(a){case"left":o=e-n-t,s=r-i/2;break;case"right":o=e+t,s=r-i/2;break;case"top":o=e-n/2,s=r-i-t;break;case"bottom":o=e-n/2,s=r+t;break;default:o=e+t,s=r-i-t;break}return{x:o,y:s}}function gbe(e,r,t,n,i,a,o){var s=vbe(e,r,t,n,i,a);if(o){var u=dbe(s.x,s.y,n,i,o);a==="auto"?(u.right&&(s.x=Math.max(0,e-n-t)),u.top&&(s.y=Math.max(0,r-i-t))):a==="top"||a==="bottom"?(u.left&&(s.x=o.x),u.right&&(s.x=o.x+o.width-n),a==="top"&&u.top&&(s.y=r+t),a==="bottom"&&u.bottom&&(s.y=r-i-t)):(u.top&&(s.y=o.y),u.bottom&&(s.y=o.y+o.height-i),a==="left"&&u.left&&(s.x=e+t),a==="right"&&u.right&&(s.x=e-n-t))}return s}function mbe(e,r){var t=!1;return we(r,function(n){if(qg(e,n))return t=!0,!1}),t}var ybe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"tooltip",type:"html",x:0,y:0,items:[],customContent:null,containerTpl:'<div class="'+xy+'"><div class="'+by+'"></div><ul class="'+hE+'"></ul></div>',itemTpl:'<li class="'+TI+`" data-index={index}>
          <span class="`+MI+`" style="background:{color}"></span>
          <span class="`+sQ+`">{name}</span>:
          <span class="`+LI+`">{value}</span>
        </li>`,xCrosshairTpl:'<div class="'+a4+'"></div>',yCrosshairTpl:'<div class="'+o4+'"></div>',title:null,showTitle:!0,region:null,crosshairsRegion:null,containerClassName:xy,crosshairs:null,offset:10,position:"right",domStyles:null,defaultStyles:pbe})},r.prototype.render=function(){this.get("customContent")?this.renderCustomContent():(this.resetTitle(),this.renderItems()),this.resetPosition()},r.prototype.clear=function(){this.clearCrosshairs(),this.setTitle(""),this.clearItemDoms()},r.prototype.show=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!0),es(t,{visibility:"visible"}),this.setCrossHairsVisible(!0))},r.prototype.hide=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!1),es(t,{visibility:"hidden"}),this.setCrossHairsVisible(!1))},r.prototype.getLocation=function(){return{x:this.get("x"),y:this.get("y")}},r.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetPosition()},r.prototype.setCrossHairsVisible=function(t){var n=t?"":"none",i=this.get("xCrosshairDom"),a=this.get("yCrosshairDom");i&&es(i,{display:n}),a&&es(a,{display:n})},r.prototype.initContainer=function(){if(e.prototype.initContainer.call(this),this.get("customContent")){this.get("container")&&this.get("container").remove();var t=this.getHtmlContentNode();this.get("parent").appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()}},r.prototype.updateInner=function(t){this.get("customContent")?this.renderCustomContent():(mbe(t,["title","showTitle"])&&this.resetTitle(),qg(t,"items")&&this.renderItems()),e.prototype.updateInner.call(this,t)},r.prototype.initDom=function(){this.cacheDoms()},r.prototype.removeDom=function(){e.prototype.removeDom.call(this),this.clearCrosshairs()},r.prototype.resetPosition=function(){var t=this.get("x"),n=this.get("y"),i=this.get("offset"),a=this.getOffset(),o=a.offsetX,s=a.offsetY,u=this.get("position"),l=this.get("region"),f=this.getContainer(),h=this.getBBox(),p=h.width,v=h.height,m;l&&(m=lE(l));var x=gbe(t,n,i,p,v,u,m);es(f,{left:np(x.x+o),top:np(x.y+s)}),this.resetCrosshairs()},r.prototype.renderCustomContent=function(){var t=this.getHtmlContentNode(),n=this.get("parent"),i=this.get("container");i&&i.parentNode===n?n.replaceChild(t,i):n.appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()},r.prototype.getHtmlContentNode=function(){var t,n=this.get("customContent");if(n){var i=n(this.get("title"),this.get("items"));I3(i)?t=i:t=ly(i)}return t},r.prototype.cacheDoms=function(){var t=this.getContainer(),n=t.getElementsByClassName(by)[0],i=t.getElementsByClassName(hE)[0];this.set("titleDom",n),this.set("listDom",i)},r.prototype.resetTitle=function(){var t=this.get("title"),n=this.get("showTitle");n&&t?this.setTitle(t):this.setTitle("")},r.prototype.setTitle=function(t){var n=this.get("titleDom");n&&(n.innerText=t)},r.prototype.resetCrosshairs=function(){var t=this.get("crosshairsRegion"),n=this.get("crosshairs");if(!t||!n)this.clearCrosshairs();else{var i=lE(t),a=this.get("xCrosshairDom"),o=this.get("yCrosshairDom");n==="x"?(this.resetCrosshair("x",i),o&&(o.remove(),this.set("yCrosshairDom",null))):n==="y"?(this.resetCrosshair("y",i),a&&(a.remove(),this.set("xCrosshairDom",null))):(this.resetCrosshair("x",i),this.resetCrosshair("y",i)),this.setCrossHairsVisible(this.get("visible"))}},r.prototype.resetCrosshair=function(t,n){var i=this.checkCrosshair(t),a=this.get(t);t==="x"?es(i,{left:np(a),top:np(n.y),height:np(n.height)}):es(i,{top:np(a),left:np(n.x),width:np(n.width)})},r.prototype.checkCrosshair=function(t){var n=t+"CrosshairDom",i=t+"CrosshairTpl",a="CROSSHAIR_"+t.toUpperCase(),o=hbe[a],s=this.get(n),u=this.get("parent");return s||(s=ly(this.get(i)),this.applyStyle(o,s),u.appendChild(s),this.set(n,s)),s},r.prototype.renderItems=function(){this.clearItemDoms();var t=this.get("items"),n=this.get("itemTpl"),i=this.get("listDom");i&&(we(t,function(a){var o=G0.toCSSGradient(a.color),s=kr(kr({},a),{color:o}),u=D2(n,s),l=ly(u);i.appendChild(l)}),this.applyChildrenStyles(i,this.get("domStyles")))},r.prototype.clearItemDoms=function(){this.get("listDom")&&t4(this.get("listDom"))},r.prototype.clearCrosshairs=function(){var t=this.get("xCrosshairDom"),n=this.get("yCrosshairDom");t&&t.remove(),n&&n.remove(),this.set("xCrosshairDom",null),this.set("yCrosshairDom",null)},r}(r4),_be={opacity:0},xbe={stroke:"#C5C5C5",strokeOpacity:.85},bbe={fill:"#CACED4",opacity:.85};function wbe(e){return gu(e,function(r,t){var n=t===0?"M":"L",i=r[0],a=r[1];return[n,i,a]})}function uQ(e){return wbe(e)}function Cbe(e){if(e.length<=2)return uQ(e);var r=[];we(e,function(o){rs(o,r.slice(r.length-2))||r.push(o[0],o[1])});var t=R_e(r,!1),n=up(e),i=n[0],a=n[1];return t.unshift(["M",i,a]),t}function Ebe(e,r,t,n){n===void 0&&(n=!0);var i=new CI({values:e}),a=new bI({values:gu(e,function(s,u){return u})}),o=gu(e,function(s,u){return[a.scale(u)*r,t-i.scale(s)*t]});return n?Cbe(o):uQ(o)}function Sbe(e,r){var t=new CI({values:e}),n=t.max<0?t.max:Math.max(0,t.min);return r-t.scale(n)*r}function Abe(e,r,t,n){var i=i5(e),a=Sbe(n,t);return i.push(["L",r,a]),i.push(["L",0,a]),i.push(["Z"]),i}var Tbe=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"trend",x:0,y:0,width:200,height:16,smooth:!0,isArea:!1,data:[],backgroundStyle:_be,lineStyle:xbe,areaStyle:bbe})},r.prototype.renderInner=function(t){var n=this.cfg,i=n.width,a=n.height,o=n.data,s=n.smooth,u=n.isArea,l=n.backgroundStyle,f=n.lineStyle,h=n.areaStyle;this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:kr({x:0,y:0,width:i,height:a},l)});var p=Ebe(o,i,a,s);if(this.addShape(t,{id:this.getElementId("line"),type:"path",attrs:kr({path:p},f)}),u){var v=Abe(p,i,a,o);this.addShape(t,{id:this.getElementId("area"),type:"path",attrs:kr({path:v},h)})}},r.prototype.applyOffset=function(){var t=this.cfg,n=t.x,i=t.y;this.moveElementTo(this.get("group"),{x:n,y:i})},r}(df),lQ={fill:"#F7F7F7",stroke:"#BFBFBF",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#FFF"},Q8=function(e){os(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"handler",x:0,y:0,width:10,height:24,style:lQ})},r.prototype.renderInner=function(t){var n=this.cfg,i=n.width,a=n.height,o=n.style,s=o.fill,u=o.stroke,l=o.radius,f=o.opacity,h=o.cursor;this.addShape(t,{type:"rect",id:this.getElementId("background"),attrs:{x:0,y:0,width:i,height:a,fill:s,stroke:u,radius:l,opacity:f,cursor:h}});var p=1/3*i,v=2/3*i,m=1/4*a,x=3/4*a;this.addShape(t,{id:this.getElementId("line-left"),type:"line",attrs:{x1:p,y1:m,x2:p,y2:x,stroke:u,cursor:h}}),this.addShape(t,{id:this.getElementId("line-right"),type:"line",attrs:{x1:v,y1:m,x2:v,y2:x,stroke:u,cursor:h}})},r.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},r.prototype.initEvent=function(){this.bindEvents()},r.prototype.bindEvents=function(){var t=this;this.get("group").on("mouseenter",function(){var n=t.get("style").highLightFill;t.getElementByLocalId("background").attr("fill",n),t.draw()}),this.get("group").on("mouseleave",function(){var n=t.get("style").fill;t.getElementByLocalId("background").attr("fill",n),t.draw()})},r.prototype.draw=function(){var t=this.get("container").get("canvas");t&&t.draw()},r}(df),Mbe={fill:"#416180",opacity:.05},Lbe={fill:"#5B8FF9",opacity:.15,cursor:"move"},QT=10,Ibe={width:QT,height:24},kbe={textBaseline:"middle",fill:"#000",opacity:.45},Pbe="sliderchange",Rbe=function(e){os(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.onMouseDown=function(n){return function(i){t.currentTarget=n;var a=i.originalEvent;a.stopPropagation(),a.preventDefault(),t.prevX=Ie(a,"touches.0.pageX",a.pageX),t.prevY=Ie(a,"touches.0.pageY",a.pageY);var o=t.getContainerDOM();o.addEventListener("mousemove",t.onMouseMove),o.addEventListener("mouseup",t.onMouseUp),o.addEventListener("mouseleave",t.onMouseUp),o.addEventListener("touchmove",t.onMouseMove),o.addEventListener("touchend",t.onMouseUp),o.addEventListener("touchcancel",t.onMouseUp)}},t.onMouseMove=function(n){var i=t.cfg.width,a=[t.get("start"),t.get("end")];n.stopPropagation(),n.preventDefault();var o=Ie(n,"touches.0.pageX",n.pageX),s=Ie(n,"touches.0.pageY",n.pageY),u=o-t.prevX,l=t.adjustOffsetRange(u/i);t.updateStartEnd(l),t.updateUI(t.getElementByLocalId("foreground"),t.getElementByLocalId("minText"),t.getElementByLocalId("maxText")),t.prevX=o,t.prevY=s,t.draw(),t.emit(Pbe,[t.get("start"),t.get("end")].sort()),t.delegateEmit("valuechanged",{originValue:a,value:[t.get("start"),t.get("end")]})},t.onMouseUp=function(){t.currentTarget&&(t.currentTarget=void 0);var n=t.getContainerDOM();n&&(n.removeEventListener("mousemove",t.onMouseMove),n.removeEventListener("mouseup",t.onMouseUp),n.removeEventListener("mouseleave",t.onMouseUp),n.removeEventListener("touchmove",t.onMouseMove),n.removeEventListener("touchend",t.onMouseUp),n.removeEventListener("touchcancel",t.onMouseUp))},t}return r.prototype.setRange=function(t,n){this.set("minLimit",t),this.set("maxLimit",n);var i=this.get("start"),a=this.get("end"),o=_s(i,t,n),s=_s(a,t,n);!this.get("isInit")&&(i!==o||a!==s)&&this.setValue([o,s])},r.prototype.getRange=function(){return{min:this.get("minLimit")||0,max:this.get("maxLimit")||1}},r.prototype.setValue=function(t){var n=this.getRange();if(ar(t)&&t.length===2){var i=[this.get("start"),this.get("end")];this.update({start:_s(t[0],n.min,n.max),end:_s(t[1],n.min,n.max)}),this.get("updateAutoRender")||this.render(),this.delegateEmit("valuechanged",{originValue:i,value:t})}},r.prototype.getValue=function(){return[this.get("start"),this.get("end")]},r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"slider",x:0,y:0,width:100,height:16,backgroundStyle:{},foregroundStyle:{},handlerStyle:{},textStyle:{},defaultCfg:{backgroundStyle:Mbe,foregroundStyle:Lbe,handlerStyle:Ibe,textStyle:kbe}})},r.prototype.update=function(t){var n=t.start,i=t.end,a=kr({},t);rr(n)||(a.start=_s(n,0,1)),rr(i)||(a.end=_s(i,0,1)),e.prototype.update.call(this,a),this.minHandler=this.getChildComponentById(this.getElementId("minHandler")),this.maxHandler=this.getChildComponentById(this.getElementId("maxHandler")),this.trend=this.getChildComponentById(this.getElementId("trend"))},r.prototype.init=function(){this.set("start",_s(this.get("start"),0,1)),this.set("end",_s(this.get("end"),0,1)),e.prototype.init.call(this)},r.prototype.render=function(){e.prototype.render.call(this),this.updateUI(this.getElementByLocalId("foreground"),this.getElementByLocalId("minText"),this.getElementByLocalId("maxText"))},r.prototype.renderInner=function(t){var n=this.cfg;n.start,n.end;var i=n.width,a=n.height,o=n.trendCfg,s=o===void 0?{}:o,u=n.minText,l=n.maxText,f=n.backgroundStyle,h=f===void 0?{}:f,p=n.foregroundStyle,v=p===void 0?{}:p,m=n.textStyle,x=m===void 0?{}:m,E=yn({},lQ,this.cfg.handlerStyle);zl(Ie(s,"data"))&&(this.trend=this.addComponent(t,kr({component:Tbe,id:this.getElementId("trend"),x:0,y:0,width:i,height:a},s))),this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:kr({x:0,y:0,width:i,height:a},h)}),this.addShape(t,{id:this.getElementId("minText"),type:"text",attrs:kr({y:a/2,textAlign:"right",text:u,silent:!1},x)}),this.addShape(t,{id:this.getElementId("maxText"),type:"text",attrs:kr({y:a/2,textAlign:"left",text:l,silent:!1},x)}),this.addShape(t,{id:this.getElementId("foreground"),name:"foreground",type:"rect",attrs:kr({y:0,height:a},v)});var A=Ie(E,"width",QT),L=Ie(E,"height",24);this.minHandler=this.addComponent(t,{component:Q8,id:this.getElementId("minHandler"),name:"handler-min",x:0,y:(a-L)/2,width:A,height:L,cursor:"ew-resize",style:E}),this.maxHandler=this.addComponent(t,{component:Q8,id:this.getElementId("maxHandler"),name:"handler-max",x:0,y:(a-L)/2,width:A,height:L,cursor:"ew-resize",style:E})},r.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},r.prototype.initEvent=function(){this.bindEvents()},r.prototype.updateUI=function(t,n,i){var a=this.cfg,o=a.start,s=a.end,u=a.width,l=a.minText,f=a.maxText,h=a.handlerStyle,p=a.height,v=o*u,m=s*u;this.trend&&(this.trend.update({width:u,height:p}),this.get("updateAutoRender")||this.trend.render()),t.attr("x",v),t.attr("width",m-v);var x=Ie(h,"width",QT);n.attr("text",l),i.attr("text",f);var E=this._dodgeText([v,m],n,i),A=E[0],L=E[1];this.minHandler&&(this.minHandler.update({x:v-x/2}),this.get("updateAutoRender")||this.minHandler.render()),we(A,function(k,R){return n.attr(R,k)}),this.maxHandler&&(this.maxHandler.update({x:m-x/2}),this.get("updateAutoRender")||this.maxHandler.render()),we(L,function(k,R){return i.attr(R,k)})},r.prototype.bindEvents=function(){var t=this.get("group");t.on("handler-min:mousedown",this.onMouseDown("minHandler")),t.on("handler-min:touchstart",this.onMouseDown("minHandler")),t.on("handler-max:mousedown",this.onMouseDown("maxHandler")),t.on("handler-max:touchstart",this.onMouseDown("maxHandler"));var n=t.findById(this.getElementId("foreground"));n.on("mousedown",this.onMouseDown("foreground")),n.on("touchstart",this.onMouseDown("foreground"))},r.prototype.adjustOffsetRange=function(t){var n=this.cfg,i=n.start,a=n.end;switch(this.currentTarget){case"minHandler":{var o=0-i,s=1-i;return Math.min(s,Math.max(o,t))}case"maxHandler":{var o=0-a,s=1-a;return Math.min(s,Math.max(o,t))}case"foreground":{var o=0-i,s=1-a;return Math.min(s,Math.max(o,t))}}},r.prototype.updateStartEnd=function(t){var n=this.cfg,i=n.start,a=n.end;switch(this.currentTarget){case"minHandler":i+=t;break;case"maxHandler":a+=t;break;case"foreground":i+=t,a+=t;break}this.set("start",i),this.set("end",a)},r.prototype._dodgeText=function(t,n,i){var a,o,s=this.cfg,u=s.handlerStyle,l=s.width,f=2,h=Ie(u,"width",QT),p=t[0],v=t[1],m=!1;p>v&&(a=[v,p],p=a[0],v=a[1],o=[i,n],n=o[0],i=o[1],m=!0);var x=n.getBBox(),E=i.getBBox(),A=x.width>p-f?{x:p+h/2+f,textAlign:"left"}:{x:p-h/2-f,textAlign:"right"},L=E.width>l-v-f?{x:v-h/2-f,textAlign:"right"}:{x:v+h/2+f,textAlign:"left"};return m?[L,A]:[A,L]},r.prototype.draw=function(){var t=this.get("container"),n=t&&t.get("canvas");n&&n.draw()},r.prototype.getContainerDOM=function(){var t=this.get("container"),n=t&&t.get("canvas");return n&&n.get("container")},r}(df),Obe={trackColor:"rgba(0,0,0,0)",thumbColor:"rgba(0,0,0,0.15)",size:8,lineCap:"round"},wR={default:Obe,hover:{thumbColor:"rgba(0,0,0,0.2)"}},Fbe=function(e){os(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.clearEvents=ny,t.onStartEvent=function(n){return function(i){t.isMobile=n,i.originalEvent.preventDefault();var a=n?Ie(i.originalEvent,"touches.0.clientX"):i.clientX,o=n?Ie(i.originalEvent,"touches.0.clientY"):i.clientY;t.startPos=t.cfg.isHorizontal?a:o,t.bindLaterEvent()}},t.bindLaterEvent=function(){var n=t.getContainerDOM(),i=[];t.isMobile?i=[fb(n,"touchmove",t.onMouseMove),fb(n,"touchend",t.onMouseUp),fb(n,"touchcancel",t.onMouseUp)]:i=[fb(n,"mousemove",t.onMouseMove),fb(n,"mouseup",t.onMouseUp),fb(n,"mouseleave",t.onMouseUp)],t.clearEvents=function(){i.forEach(function(a){a.remove()})}},t.onMouseMove=function(n){var i=t.cfg,a=i.isHorizontal,o=i.thumbOffset;n.preventDefault();var s=t.isMobile?Ie(n,"touches.0.clientX"):n.clientX,u=t.isMobile?Ie(n,"touches.0.clientY"):n.clientY,l=a?s:u,f=l-t.startPos;t.startPos=l,t.updateThumbOffset(o+f)},t.onMouseUp=function(n){n.preventDefault(),t.clearEvents()},t.onTrackClick=function(n){var i=t.cfg,a=i.isHorizontal,o=i.x,s=i.y,u=i.thumbLen,l=t.getContainerDOM(),f=l.getBoundingClientRect(),h=n.clientX,p=n.clientY,v=a?h-f.left-o-u/2:p-f.top-s-u/2,m=t.validateRange(v);t.updateThumbOffset(m)},t.onThumbMouseOver=function(){var n=t.cfg.theme.hover.thumbColor;t.getElementByLocalId("thumb").attr("stroke",n),t.draw()},t.onThumbMouseOut=function(){var n=t.cfg.theme.default.thumbColor;t.getElementByLocalId("thumb").attr("stroke",n),t.draw()},t}return r.prototype.setRange=function(t,n){this.set("minLimit",t),this.set("maxLimit",n);var i=this.getValue(),a=_s(i,t,n);i!==a&&!this.get("isInit")&&this.setValue(a)},r.prototype.getRange=function(){var t=this.get("minLimit")||0,n=this.get("maxLimit")||1;return{min:t,max:n}},r.prototype.setValue=function(t){var n=this.getRange(),i=this.getValue();this.update({thumbOffset:(this.get("trackLen")-this.get("thumbLen"))*_s(t,n.min,n.max)}),this.delegateEmit("valuechange",{originalValue:i,value:this.getValue()})},r.prototype.getValue=function(){return _s(this.get("thumbOffset")/(this.get("trackLen")-this.get("thumbLen")),0,1)},r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return kr(kr({},t),{name:"scrollbar",isHorizontal:!0,minThumbLen:20,thumbOffset:0,theme:wR})},r.prototype.renderInner=function(t){this.renderTrackShape(t),this.renderThumbShape(t)},r.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},r.prototype.initEvent=function(){this.bindEvents()},r.prototype.renderTrackShape=function(t){var n=this.cfg,i=n.trackLen,a=n.theme,o=a===void 0?{default:{}}:a,s=yn({},wR,o).default,u=s.lineCap,l=s.trackColor,f=s.size,h=Ie(this.cfg,"size",f),p=this.get("isHorizontal")?{x1:0+h/2,y1:h/2,x2:i-h/2,y2:h/2,lineWidth:h,stroke:l,lineCap:u}:{x1:h/2,y1:0+h/2,x2:h/2,y2:i-h/2,lineWidth:h,stroke:l,lineCap:u};return this.addShape(t,{id:this.getElementId("track"),name:"track",type:"line",attrs:p})},r.prototype.renderThumbShape=function(t){var n=this.cfg,i=n.thumbOffset,a=n.thumbLen,o=n.theme,s=yn({},wR,o).default,u=s.size,l=s.lineCap,f=s.thumbColor,h=Ie(this.cfg,"size",u),p=this.get("isHorizontal")?{x1:i+h/2,y1:h/2,x2:i+a-h/2,y2:h/2,lineWidth:h,stroke:f,lineCap:l,cursor:"default"}:{x1:h/2,y1:i+h/2,x2:h/2,y2:i+a-h/2,lineWidth:h,stroke:f,lineCap:l,cursor:"default"};return this.addShape(t,{id:this.getElementId("thumb"),name:"thumb",type:"line",attrs:p})},r.prototype.bindEvents=function(){var t=this.get("group");t.on("mousedown",this.onStartEvent(!1)),t.on("mouseup",this.onMouseUp),t.on("touchstart",this.onStartEvent(!0)),t.on("touchend",this.onMouseUp);var n=t.findById(this.getElementId("track"));n.on("click",this.onTrackClick);var i=t.findById(this.getElementId("thumb"));i.on("mouseover",this.onThumbMouseOver),i.on("mouseout",this.onThumbMouseOut)},r.prototype.getContainerDOM=function(){var t=this.get("container"),n=t&&t.get("canvas");return n&&n.get("container")},r.prototype.validateRange=function(t){var n=this.cfg,i=n.thumbLen,a=n.trackLen,o=t;return t+i>a?o=a-i:t+i<i&&(o=0),o},r.prototype.draw=function(){var t=this.get("container"),n=t&&t.get("canvas");n&&n.draw()},r.prototype.updateThumbOffset=function(t){var n=this.cfg,i=n.thumbOffset,a=n.isHorizontal,o=n.thumbLen,s=n.size,u=this.validateRange(t);if(u!==i){var l=this.getElementByLocalId("thumb");a?l.attr({x1:u+s/2,x2:u+o-s/2}):l.attr({y1:u+s/2,y2:u+o-s/2}),this.emitOffsetChange(u)}},r.prototype.emitOffsetChange=function(t){var n=this.cfg,i=n.thumbOffset,a=n.trackLen,o=n.thumbLen;this.cfg.thumbOffset=t,this.emit("scrollchange",{thumbOffset:t,ratio:_s(t/(a-o),0,1)}),this.delegateEmit("valuechange",{originalValue:i,value:t})},r}(df),Dbe=tbe,Bbe=rbe,Nbe=ube,zbe=sbe,J8=lbe,$be=fbe,II=ybe;function Ube(e){if(uh(e))return null;var r=e[0].x,t=e[0].x,n=e[0].y,i=e[0].y;return we(e,function(a){r=r>a.x?a.x:r,t=t<a.x?a.x:t,n=n>a.y?a.y:n,i=i<a.y?a.y:i}),{minX:r,maxX:t,minY:n,maxY:i,centerX:(r+t)/2,centerY:(n+i)/2}}function ez(e){return Array.from(new Set(e)).length===1}function tz(e){return(oh(e)+Ff(e))/2}function il(e,r,t,n){return{x:e+t*Math.cos(n),y:r+t*Math.sin(n)}}function H0(e,r,t,n,i,a){a===void 0&&(a=0);var o=il(e,r,t,n),s=il(e,r,t,i),u=il(e,r,a,n),l=il(e,r,a,i);if(i-n===Math.PI*2){var f=il(e,r,t,n+Math.PI),h=il(e,r,a,n+Math.PI),p=[["M",o.x,o.y],["A",t,t,0,1,1,f.x,f.y],["A",t,t,0,1,1,s.x,s.y],["M",u.x,u.y]];return a&&(p.push(["A",a,a,0,1,0,h.x,h.y]),p.push(["A",a,a,0,1,0,l.x,l.y])),p.push(["M",o.x,o.y]),p.push(["Z"]),p}var v=i-n<=Math.PI?0:1,m=[["M",o.x,o.y],["A",t,t,0,v,1,s.x,s.y],["L",l.x,l.y]];return a&&m.push(["A",a,a,0,v,0,u.x,u.y]),m.push(["L",o.x,o.y]),m.push(["Z"]),m}function cQ(e,r,t,n,i){var a=il(e,r,t,n),o=il(e,r,t,i);if(ac(i-n,Math.PI*2)){var s=il(e,r,t,n+Math.PI);return[["M",a.x,a.y],["A",t,t,0,1,1,s.x,s.y],["A",t,t,0,1,1,a.x,a.y],["A",t,t,0,1,0,s.x,s.y],["A",t,t,0,1,0,a.x,a.y],["Z"]]}var u=i-n<=Math.PI?0:1;return[["M",a.x,a.y],["A",t,t,0,u,1,o.x,o.y]]}function pE(e,r){var t=e.points,n=Ube(t),i,a,o=r.startAngle,s=r.endAngle,u=s-o;return r.isTransposed?(i=n.maxY*u,a=n.minY*u):(i=n.maxX*u,a=n.minX*u),i+=o,a+=o,{startAngle:a,endAngle:i}}function Vbe(e,r){if(xi(e)&&xi(r))return[e,r];if(e=e,r=r,ez(e)||ez(r))return[tz(e),tz(r)];for(var t=-1,n=0,i=0,a,o=e.length-1,s,u=0;++t<e.length;)a=o,o=t,u+=s=e[a]*r[o]-e[o]*r[a],n+=(e[a]+e[o])*s,i+=(r[a]+r[o])*s;return u*=3,[n/u,i/u]}function fQ(e,r){var t=e.attr(),n=r.attr();return we(t,function(i,a){n[a]===void 0&&(n[a]=void 0)}),n}function jb(e,r,t){var n=Math.min(r,t),i=Math.max(r,t);return e>=n&&e<=i}function Gbe(e,r,t){if(ei(e))return e.padEnd(r,t);if(ar(e)){var n=e.length;if(n<r)for(var i=r-n,a=0;a<i;a++)e.push(t)}return e}function ip(e,r){return typeof e=="object"&&r.forEach(function(t){delete e[t]}),e}function L0(e,r,t){var n,i;r===void 0&&(r=[]),t===void 0&&(t=new Map);try{for(var a=so(e),o=a.next();!o.done;o=a.next()){var s=o.value;t.has(s)||(r.push(s),t.set(s,!0))}}catch(u){n={error:u}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return r}var sh=function(){function e(r,t,n,i){r===void 0&&(r=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=r,this.y=t,this.height=i,this.width=n}return e.fromRange=function(r,t,n,i){return new e(r,t,n-r,i-t)},e.fromObject=function(r){return new e(r.minX,r.minY,r.width,r.height)},Object.defineProperty(e.prototype,"minX",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxX",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minY",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxY",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tl",{get:function(){return{x:this.x,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tr",{get:function(){return{x:this.maxX,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bl",{get:function(){return{x:this.x,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"br",{get:function(){return{x:this.maxX,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return{x:this.x+this.width/2,y:this.minY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return{x:this.maxX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return{x:this.x+this.width/2,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return{x:this.minX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(r){return this.x===r.x&&this.y===r.y&&this.width===r.width&&this.height===r.height},e.prototype.contains=function(r){return r.minX>=this.minX&&r.maxX<=this.maxX&&r.minY>=this.minY&&r.maxY<=this.maxY},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.add=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=this.clone();return we(r,function(i){n.x=Math.min(i.x,n.x),n.y=Math.min(i.y,n.y),n.width=Math.max(i.maxX,n.maxX)-n.x,n.height=Math.max(i.maxY,n.maxY)-n.y}),n},e.prototype.merge=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=this.clone();return we(r,function(i){n.x=Math.max(i.x,n.x),n.y=Math.max(i.y,n.y),n.width=Math.min(i.maxX,n.maxX)-n.x,n.height=Math.min(i.maxY,n.maxY)-n.y}),n},e.prototype.cut=function(r,t){var n=r.width,i=r.height;switch(t){case en.TOP:case en.TOP_LEFT:case en.TOP_RIGHT:return e.fromRange(this.minX,this.minY+i,this.maxX,this.maxY);case en.RIGHT:case en.RIGHT_TOP:case en.RIGHT_BOTTOM:return e.fromRange(this.minX,this.minY,this.maxX-n,this.maxY);case en.BOTTOM:case en.BOTTOM_LEFT:case en.BOTTOM_RIGHT:return e.fromRange(this.minX,this.minY,this.maxX,this.maxY-i);case en.LEFT:case en.LEFT_TOP:case en.LEFT_BOTTOM:return e.fromRange(this.minX+n,this.minY,this.maxX,this.maxY);default:return this}},e.prototype.shrink=function(r){var t=jn(r,4),n=t[0],i=t[1],a=t[2],o=t[3];return new e(this.x+o,this.y+n,this.width-o-i,this.height-n-a)},e.prototype.expand=function(r){var t=jn(r,4),n=t[0],i=t[1],a=t[2],o=t[3];return new e(this.x-o,this.y-n,this.width+o+i,this.height+n+a)},e.prototype.exceed=function(r){return[Math.max(-this.minY+r.minY,0),Math.max(this.maxX-r.maxX,0),Math.max(this.maxY-r.maxY,0),Math.max(-this.minX+r.minX,0)]},e.prototype.collide=function(r){return this.minX<r.maxX&&this.maxX>r.minX&&this.minY<r.maxY&&this.maxY>r.minY},e.prototype.size=function(){return this.width*this.height},e.prototype.isPointIn=function(r){return r.x>=this.minX&&r.x<=this.maxX&&r.y>=this.minY&&r.y<=this.maxY},e}();function Hbe(e){return[[e.minX,e.minY],[e.maxX,e.minY],[e.maxX,e.maxY],[e.minX,e.maxY]]}function vS(e){if(e.isPolar&&!e.isTransposed)return(e.endAngle-e.startAngle)*e.getRadius();var r=e.convert({x:0,y:0}),t=e.convert({x:1,y:0});return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))}function jbe(e){if(e.isPolar){var r=e.startAngle,t=e.endAngle;return t-r===Math.PI*2}return!1}function kI(e,r){var t=e.getCenter();return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))}function Wbe(e,r){var t=!1;if(e)if(e.type==="theta"){var n=e.start,i=e.end;t=jb(r.x,n.x,i.x)&&jb(r.y,n.y,i.y)}else{var a=e.invert(r);t=jb(a.x,0,1)&&jb(a.y,0,1)}return t}function p2(e,r){var t=e.getCenter();return Math.atan2(r.y-t.y,r.x-t.x)}function s4(e,r){r===void 0&&(r=0);var t=e.start,n=e.end,i=e.getWidth(),a=e.getHeight();if(e.isPolar){var o=e.startAngle,s=e.endAngle,u=e.getCenter(),l=e.getRadius();return{type:"path",startState:{path:H0(u.x,u.y,l+r,o,o)},endState:function(h){var p=(s-o)*h+o,v=H0(u.x,u.y,l+r,o,p);return{path:v}},attrs:{path:H0(u.x,u.y,l+r,o,s)}}}var f;return e.isTransposed?f={height:a+r*2}:f={width:i+r*2},{type:"rect",startState:{x:t.x-r,y:n.y-r,width:e.isTransposed?i+r*2:0,height:e.isTransposed?0:a+r*2},endState:f,attrs:{x:t.x-r,y:n.y-r,width:i+r*2,height:a+r*2}}}function Xbe(e,r){r===void 0&&(r=0);var t=e.start,n=e.end,i=e.getWidth(),a=e.getHeight(),o=Math.min(t.x,n.x),s=Math.min(t.y,n.y);return sh.fromRange(o-r,s-r,o+i+r,s+a+r)}var Ybe=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]+)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/;function Zbe(e){var r="linear";return Ybe.test(e)?r="timeCat":ei(e)&&(r="cat"),r}function hQ(e,r,t,n){return r===void 0&&(r={}),r.type?r.type:e.type!=="identity"&&Vb.includes(t)&&["interval"].includes(n)||e.isCategory?"cat":e.type}function qbe(e,r,t){var n=r||[];if(xi(e)||rr(ZZ(n,e))&&uh(t)){var i=e5("identity");return new i({field:e.toString(),values:[e]})}var a=Gd(n,e),o=Ie(t,"type",Zbe(a[0])),s=e5(o);return new s(Xe({field:e,values:a},t))}function Kbe(e,r){if(e.type!=="identity"&&r.type!=="identity"){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);e.change(t)}}function dE(e){return e.alias||e.field}function pQ(e,r,t){var n=e.values,i=n.length,a;if(i===1)a=[.5,1];else{var o=1,s=0;jbe(r)?r.isTransposed?(o=Ie(t,"widthRatio.multiplePie",1/1.3),s=1/i*o,a=[s/2,1-s/2]):a=[0,1-1/i]:(s=1/i/2,a=[s,1-s])}return a}function Qbe(e){var r=e.values.filter(function(t){return!rr(t)&&!isNaN(t)});return Math.max.apply(Math,vu(vu([],jn(r),!1),[rr(e.max)?-1/0:e.max],!1))}function Jbe(e){var r,t;switch(e){case en.TOP:r={x:0,y:1},t={x:1,y:1};break;case en.RIGHT:r={x:1,y:0},t={x:1,y:1};break;case en.BOTTOM:r={x:0,y:0},t={x:1,y:0};break;case en.LEFT:r={x:0,y:0},t={x:0,y:1};break;default:r=t={x:0,y:0}}return{start:r,end:t}}function e2e(e){var r,t;return e.isTransposed?(r={x:0,y:0},t={x:1,y:0}):(r={x:0,y:0},t={x:0,y:1}),{start:r,end:t}}function DA(e,r){var t={start:{x:0,y:0},end:{x:0,y:0}};e.isRect?t=Jbe(r):e.isPolar&&(t=e2e(e));var n=t.start,i=t.end;return{start:e.convert(n),end:e.convert(i)}}function dQ(e){var r=e.start,t=e.end;return r.x===t.x}function rz(e,r){var t=e.start,n=e.end,i=dQ(e);return i?(t.y-n.y)*(r.x-t.x)>0?1:-1:(n.x-t.x)*(t.y-r.y)>0?-1:1}function BA(e,r){var t=Ie(e,["components","axis"],{});return yn({},Ie(t,["common"],{}),yn({},Ie(t,[r],{})))}function nz(e,r,t){var n=Ie(e,["components","axis"],{});return yn({},Ie(n,["common","title"],{}),yn({},Ie(n,[r,"title"],{})),t)}function CR(e){var r=e.x,t=e.y,n=e.circleCenter,i=t.start>t.end,a=e.isTransposed?e.convert({x:i?0:1,y:0}):e.convert({x:0,y:i?0:1}),o=[a.x-n.x,a.y-n.y],s=[1,0],u=a.y>n.y?VF(o,s):VF(o,s)*-1,l=u+(r.end-r.start),f=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2));return{center:n,radius:f,startAngle:u,endAngle:l}}function GM(e,r){return Zx(e)?e===!1?!1:{}:Ie(e,[r])}function iz(e,r){return Ie(e,"position",r)}function az(e,r){return Ie(r,["title","text"],dE(e))}var $2=function(){function e(r,t){this.destroyed=!1,this.facets=[],this.view=r,this.cfg=yn({},this.getDefaultCfg(),t)}return e.prototype.init=function(){this.container||(this.container=this.createContainer());var r=this.view.getData();this.facets=this.generateFacets(r)},e.prototype.render=function(){this.renderViews()},e.prototype.update=function(){},e.prototype.clear=function(){this.clearFacetViews()},e.prototype.destroy=function(){this.clear(),this.container&&(this.container.remove(!0),this.container=void 0),this.destroyed=!0,this.view=void 0,this.facets=[]},e.prototype.facetToView=function(r){var t=r.region,n=r.data,i=r.padding,a=i===void 0?this.cfg.padding:i,o=this.view.createView({region:t,padding:a});o.data(n||[]),r.view=o,this.beforeEachView(o,r);var s=this.cfg.eachView;return s&&s(o,r),this.afterEachView(o,r),o},e.prototype.createContainer=function(){var r=this.view.getLayer(Vu.FORE);return r.addGroup()},e.prototype.renderViews=function(){this.createFacetViews()},e.prototype.createFacetViews=function(){var r=this;return this.facets.map(function(t){return r.facetToView(t)})},e.prototype.clearFacetViews=function(){var r=this;we(this.facets,function(t){t.view&&(r.view.removeView(t.view),t.view=void 0)})},e.prototype.parseSpacing=function(){var r=this.view.viewBBox,t=r.width,n=r.height,i=this.cfg.spacing;return i.map(function(a,o){return xi(a)?a/(o===0?t:n):parseFloat(a)/100})},e.prototype.getFieldValues=function(r,t){var n=[],i={};return we(r,function(a){var o=a[t];!rr(o)&&!i[o]&&(n.push(o),i[o]=!0)}),n},e.prototype.getRegion=function(r,t,n,i){var a=jn(this.parseSpacing(),2),o=a[0],s=a[1],u=(1+o)/(t===0?1:t)-o,l=(1+s)/(r===0?1:r)-s,f={x:(u+o)*n,y:(l+s)*i},h={x:f.x+u,y:f.y+l};return{start:f,end:h}},e.prototype.getDefaultCfg=function(){return{eachView:void 0,showTitle:!0,spacing:[0,0],padding:10,fields:[]}},e.prototype.getDefaultTitleCfg=function(){var r=this.view.getTheme().fontFamily;return{style:{fontSize:14,fill:"#666",fontFamily:r}}},e.prototype.processAxis=function(r,t){var n=r.getOptions(),i=n.coordinate,a=r.geometries,o=Ie(i,"type","rect");if(o==="rect"&&a.length){rr(n.axes)&&(n.axes={});var s=n.axes,u=jn(a[0].getXYFields(),2),l=u[0],f=u[1],h=GM(s,l),p=GM(s,f);h!==!1&&(n.axes[l]=this.getXAxisOption(l,s,h,t)),p!==!1&&(n.axes[f]=this.getYAxisOption(f,s,p,t))}},e.prototype.getFacetDataFilter=function(r){return function(t){return eI(r,function(n){var i=n.field,a=n.value;return!rr(a)&&i?t[i]===a:!0})}},e}(),vQ={},t2e=function(e){return vQ[d1(e)]},U2=function(e,r){vQ[d1(e)]=r},Vs=function(){function e(r,t){this.context=r,this.cfg=t,r.addAction(this)}return e.prototype.applyCfg=function(r){Na(this,r)},e.prototype.init=function(){this.applyCfg(this.cfg)},e.prototype.destroy=function(){this.context.removeAction(this),this.context=null},e}(),r2e=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.execute=function(){this.callback&&this.callback(this.context)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.callback=null},r}(Vs),u4={};function n2e(e,r){var t=u4[e],n=null;if(t){var i=t.ActionClass,a=t.cfg;n=new i(r,a),n.name=e,n.init()}return n}function PI(e){var r=u4[e];return Ie(r,"ActionClass")}function hi(e,r,t){u4[e]={ActionClass:r,cfg:t}}function i2e(e,r){var t=new r2e(r);return t.callback=e,t.name="callback",t}function a2e(e,r){var t=[];if(e.length){t.push(["M",e[0].x,e[0].y]);for(var n=1,i=e.length;n<i;n+=1){var a=e[n];t.push(["L",a.x,a.y])}r&&t.push(["Z"])}return t}function l5(e,r){for(var t=[e[0]],n=1,i=e.length;n<i;n=n+2){var a=r.convert({x:e[n],y:e[n+1]});t.push(a.x,a.y)}return t}function gQ(e,r){var t=r.isTransposed,n=e[1],i=e[6],a=e[7],o=r.convert({x:i,y:a}),s=t?0:1;return["A",n,n,0,0,s,o.x,o.y]}function o2e(e,r,t){var n=t.isTransposed,i=t.startAngle,a=t.endAngle,o=e[0].toLowerCase()==="a"?{x:e[6],y:e[7]}:{x:e[1],y:e[2]},s={x:r[1],y:r[2]},u=[],l=n?"y":"x",f=Math.abs(s[l]-o[l])*(a-i),h=s[l]>=o[l]?1:0,p=f>Math.PI?1:0,v=t.convert(s),m=kI(t,v);if(m>=.5)if(f===Math.PI*2){var x={x:(s.x+o.x)/2,y:(s.y+o.y)/2},E=t.convert(x);u.push(["A",m,m,0,p,h,E.x,E.y]),u.push(["A",m,m,0,p,h,v.x,v.y])}else u.push(["A",m,m,0,p,h,v.x,v.y]);return u}function s2e(e){we(e,function(r,t){var n=r;if(n[0].toLowerCase()==="a"){var i=e[t-1],a=e[t+1];a&&a[0].toLowerCase()==="a"?i&&i[0].toLowerCase()==="l"&&(i[0]="M"):i&&i[0].toLowerCase()==="a"&&a&&a[0].toLowerCase()==="l"&&(a[0]="M")}})}var u2e=function(e,r,t,n){var i,a=[],o=!!n,s,u,l,f,h,p,v;if(o){i=jn(n,2),l=i[0],f=i[1];for(var m=0,x=e.length;m<x;m++){var E=e[m];l=Ac([0,0],l,E),f=Tc([0,0],f,E)}}for(var m=0,A=e.length;m<A;m++){var E=e[m];if(m===0&&!t)v=E;else if(m===A-1&&!t)p=E,a.push(v),a.push(p);else{s=e[t?m?m-1:A-1:m-1],u=e[t?(m+1)%A:m+1];var L=[0,0];L=Xp(L,u,s),L=ah(L,L,r);var k=c2(E,s),R=c2(E,u),D=k+R;D!==0&&(k/=D,R/=D);var $=ah([0,0],L,-k),j=ah([0,0],L,R);p=Xo([0,0],E,$),h=Xo([0,0],E,j),h=Ac([0,0],h,Tc([0,0],u,E)),h=Tc([0,0],h,Ac([0,0],u,E)),$=Xp([0,0],h,E),$=ah([0,0],$,-k/R),p=Xo([0,0],E,$),p=Ac([0,0],p,Tc([0,0],s,E)),p=Tc([0,0],p,Ac([0,0],s,E)),j=Xp([0,0],E,p),j=ah([0,0],j,R/k),h=Xo([0,0],E,j),o&&(p=Tc([0,0],p,l),p=Ac([0,0],p,f),h=Tc([0,0],h,l),h=Ac([0,0],h,f)),a.push(v),a.push(p),v=h}}return t&&a.push(a.shift()),a};function mQ(e,r,t){for(var n=!!r,i=[],a=0,o=e.length;a<o;a+=2)i.push([e[a],e[a+1]]);for(var s=u2e(i,.4,n,t),u=i.length,l=[],f,h,p,a=0;a<u-1;a++)f=s[a*2],h=s[a*2+1],p=i[a+1],l.push(["C",f[0],f[1],h[0],h[1],p[0],p[1]]);return n&&(f=s[u],h=s[u+1],p=i[0],l.push(["C",f[0],f[1],h[0],h[1],p[0],p[1]])),l}function gS(e,r){return a2e(e,r)}function HM(e,r,t){var n=[],i=e[0],a=null;if(e.length<=2)return gS(e,r);for(var o=0,s=e.length;o<s;o++){var u=e[o];(!a||!(a.x===u.x&&a.y===u.y))&&(n.push(u.x),n.push(u.y),a=u)}var l=t||[[0,0],[1,1]],f=mQ(n,r,l);return f.unshift(["M",i.x,i.y]),f}function l2e(e,r){var t=[];return we(r,function(n){var i=n[0];switch(i.toLowerCase()){case"m":case"l":case"c":t.push(l5(n,e));break;case"a":t.push(gQ(n,e));break;case"z":default:t.push(n);break}}),t}function c2e(e,r){var t=[],n,i,a,o;return we(r,function(s,u){var l=s[0];switch(l.toLowerCase()){case"m":case"c":case"q":t.push(l5(s,e));break;case"l":n=r[u-1],i=s,a=e.isTransposed,o=a?n[n.length-2]===i[1]:n[n.length-1]===i[2],o?t=t.concat(o2e(n,i,e)):t.push(l5(s,e));break;case"a":t.push(gQ(s,e));break;case"z":default:t.push(s);break}}),s2e(t),t}function yQ(e,r){var t=e.event,n=t.target,i=n.getCanvasBBox();return i.width>=r||i.height>=r?i:null}function f2e(e,r){var t=e.event,n=t.target,i=n.getCanvasBBox();return i.width>=r||i.height>=r?n.attr("path"):null}function J0(e){var r=e.event,t,n=r.target;return n&&(t=n.get("element")),t}function Qx(e){var r=e.event,t=r.target,n;return t&&(n=t.get("delegateObject")),n}function _Q(e){var r=e.event.gEvent;return!(r&&r.fromShape&&r.toShape&&r.fromShape.get("element")===r.toShape.get("element"))}function vE(e){return e&&e.component&&e.component.isList()}function xQ(e){return e&&e.component&&e.component.isSlider()}function gE(e){var r=e.event,t=r.target;return t&&t.get("name")==="mask"}function l4(e,r){var t=e.event.target;if(t.get("type")==="path"){var n=f2e(e,r);return n?d2e(e.view,n):void 0}var i=yQ(e,r);return i?c4(e.view,i):null}function bQ(e,r,t){var n=yQ(e,t);if(!n)return null;var i=e.view,a=c5(i,r,{x:n.x,y:n.y}),o=c5(i,r,{x:n.maxX,y:n.maxY}),s={minX:a.x,minY:a.y,maxX:o.x,maxY:o.y};return c4(r,s)}function Lc(e){var r=e.geometries,t=[];return we(r,function(n){var i=n.elements;t=t.concat(i)}),e.views&&e.views.length&&we(e.views,function(n){t=t.concat(Lc(n))}),t}function h2e(e,r,t){var n=Lc(e);return n.filter(function(i){return qv(i,r)===t})}function wQ(e,r){var t=e.geometries,n=[];return we(t,function(i){var a=i.getElementsBy(function(o){return o.hasState(r)});n=n.concat(a)}),n}function qv(e,r){var t=e.getModel(),n=t.data,i;return ar(n)?i=n[0][r]:i=n[r],i}function p2e(e,r){return!(r.minX>e.maxX||r.maxX<e.minX||r.minY>e.maxY||r.maxY<e.minY)}function c4(e,r){var t=Lc(e),n=[];return we(t,function(i){var a=i.shape,o=a.getCanvasBBox();p2e(r,o)&&n.push(i)}),n}function oz(e){var r=[];return we(e,function(t){var n=t[0];if(n!=="A")for(var i=1;i<t.length;i=i+2)r.push([t[i],t[i+1]]);else{var a=t.length;r.push([t[a-2],t[a-1]])}}),r}function d2e(e,r){var t=Lc(e),n=oz(r),i=t.filter(function(a){var o=a.shape,s;if(o.get("type")==="path")s=oz(o.attr("path"));else{var u=o.getCanvasBBox();s=Hbe(u)}return G_e(n,s)});return i}function CQ(e){return e.getComponents().map(function(r){return r.component})}function f4(e,r){var t=r.x-e.x,n=r.y-e.y;return Math.sqrt(t*t+n*n)}function v2e(e,r){if(e.length<=2)return gS(e,!1);var t=e[0],n=[];we(e,function(a){n.push(a.x),n.push(a.y)});var i=mQ(n,r,null);return i.unshift(["M",t.x,t.y]),i}function sz(e,r){return e.x<=r.x&&e.maxX>=r.x&&e.y<=r.y&&e.maxY>r.y}function Yg(e){var r=e.parent,t=null;return r&&(t=r.views.filter(function(n){return n!==e})),t}function g2e(e,r){var t=e.getCoordinate();return t.invert(r)}function c5(e,r,t){var n=g2e(e,t);return r.getCoordinate().convert(n)}function EQ(e,r,t,n){var i=!1;return we(e,function(a){if(a[t]===r[t]&&a[n]===r[n])return i=!0,!1}),i}function d2(e,r){var t=e.getScaleByField(r);return!t&&e.views&&we(e.views,function(n){if(t=d2(n,r),t)return!1}),t}var m2e=function(){function e(r){this.actions=[],this.event=null,this.cacheMap={},this.view=r}return e.prototype.cache=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(r.length===1)return this.cacheMap[r[0]];r.length===2&&(this.cacheMap[r[0]]=r[1])},e.prototype.getAction=function(r){return this.actions.find(function(t){return t.name===r})},e.prototype.addAction=function(r){this.actions.push(r)},e.prototype.removeAction=function(r){var t=this.actions,n=this.actions.indexOf(r);n>=0&&t.splice(n,1)},e.prototype.getCurrentPoint=function(){var r=this.event;if(r)if(r.target instanceof HTMLElement){var t=this.view.getCanvas(),n=t.getPointByClient(r.clientX,r.clientY);return n}else return{x:r.x,y:r.y};return null},e.prototype.getCurrentShape=function(){return Ie(this.event,["gEvent","shape"])},e.prototype.isInPlot=function(){var r=this.getCurrentPoint();return r?this.view.isPointInPlot(r):!1},e.prototype.isInShape=function(r){var t=this.getCurrentShape();return t?t.get("name")===r:!1},e.prototype.isInComponent=function(r){var t=CQ(this.view),n=this.getCurrentPoint();return n?!!t.find(function(i){var a=i.getBBox();return r?i.get("name")===r&&sz(a,n):sz(a,n)}):!1},e.prototype.destroy=function(){we(this.actions.slice(),function(r){r.destroy()}),this.view=null,this.event=null,this.actions=null,this.cacheMap=null},e}(),y2e=function(){function e(r,t){this.view=r,this.cfg=t}return e.prototype.init=function(){this.initEvents()},e.prototype.initEvents=function(){},e.prototype.clearEvents=function(){},e.prototype.destroy=function(){this.clearEvents()},e}();function uz(e,r,t){var n=e.split(":"),i=n[0],a=r.getAction(i)||n2e(i,r);if(!a)throw new Error("There is no action named ".concat(i));var o=n[1];return{action:a,methodName:o,arg:t}}function lz(e){var r=e.action,t=e.methodName,n=e.arg;if(r[t])r[t](n);else throw new Error("Action(".concat(r.name,") doesn't have a method called ").concat(t))}var Up={START:"start",SHOW_ENABLE:"showEnable",END:"end",ROLLBACK:"rollback",PROCESSING:"processing"},_2e=function(e){Rn(r,e);function r(t,n){var i=e.call(this,t,n)||this;return i.callbackCaches={},i.emitCaches={},i.steps=n,i}return r.prototype.init=function(){this.initContext(),e.prototype.init.call(this)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.steps=null,this.context&&(this.context.destroy(),this.context=null),this.callbackCaches=null,this.view=null},r.prototype.initEvents=function(){var t=this;we(this.steps,function(n,i){we(n,function(a){var o=t.getActionCallback(i,a);o&&t.bindEvent(a.trigger,o)})})},r.prototype.clearEvents=function(){var t=this;we(this.steps,function(n,i){we(n,function(a){var o=t.getActionCallback(i,a);o&&t.offEvent(a.trigger,o)})})},r.prototype.initContext=function(){var t=this.view,n=new m2e(t);this.context=n;var i=this.steps;we(i,function(a){we(a,function(o){if(kn(o.action))o.actionObject={action:i2e(o.action,n),methodName:"execute"};else if(ei(o.action))o.actionObject=uz(o.action,n,o.arg);else if(ar(o.action)){var s=o.action,u=ar(o.arg)?o.arg:[o.arg];o.actionObject=[],we(s,function(l,f){o.actionObject.push(uz(l,n,u[f]))})}})})},r.prototype.isAllowStep=function(t){var n=this.currentStepName,i=this.steps;if(n===t||t===Up.SHOW_ENABLE)return!0;if(t===Up.PROCESSING)return n===Up.START;if(t===Up.START)return n!==Up.PROCESSING;if(t===Up.END)return n===Up.PROCESSING||n===Up.START;if(t===Up.ROLLBACK){if(i[Up.END])return n===Up.END;if(n===Up.START)return!0}return!1},r.prototype.isAllowExecute=function(t,n){if(this.isAllowStep(t)){var i=this.getKey(t,n);return n.once&&this.emitCaches[i]?!1:n.isEnable?n.isEnable(this.context):!0}return!1},r.prototype.enterStep=function(t){this.currentStepName=t,this.emitCaches={}},r.prototype.afterExecute=function(t,n){t!==Up.SHOW_ENABLE&&this.currentStepName!==t&&this.enterStep(t);var i=this.getKey(t,n);this.emitCaches[i]=!0},r.prototype.getKey=function(t,n){return t+n.trigger+n.action},r.prototype.getActionCallback=function(t,n){var i=this,a=this.context,o=this.callbackCaches,s=n.actionObject;if(n.action&&s){var u=this.getKey(t,n);if(!o[u]){var l=function(f){a.event=f,i.isAllowExecute(t,n)?(ar(s)?we(s,function(h){a.event=f,lz(h)}):(a.event=f,lz(s)),i.afterExecute(t,n),n.callback&&(a.event=f,n.callback(a))):a.event=null};n.debounce?o[u]=k3(l,n.debounce.wait,n.debounce.immediate):n.throttle?o[u]=nI(l,n.throttle.wait,{leading:n.throttle.leading,trailing:n.throttle.trailing}):o[u]=l}return o[u]}return null},r.prototype.bindEvent=function(t,n){var i=t.split(":");i[0]==="window"?window.addEventListener(i[1],n):i[0]==="document"?document.addEventListener(i[1],n):this.view.on(t,n)},r.prototype.offEvent=function(t,n){var i=t.split(":");i[0]==="window"?window.removeEventListener(i[1],n):i[0]==="document"?document.removeEventListener(i[1],n):this.view.off(t,n)},r}(y2e),SQ={};function x2e(e){return SQ[d1(e)]}function $i(e,r){SQ[d1(e)]=r}function b2e(e,r,t){var n=x2e(e);if(!n)return null;if(Wv(n)){var i=Na(Of(n),t);return new _2e(r,i)}else{var a=n;return new a(r,t)}}function w2e(e){return{title:{autoRotate:!0,position:"center",spacing:e.axisTitleSpacing,style:{fill:e.axisTitleTextFillColor,fontSize:e.axisTitleTextFontSize,lineHeight:e.axisTitleTextLineHeight,textBaseline:"middle",fontFamily:e.fontFamily},iconStyle:{fill:e.axisDescriptionIconFillColor}},label:{autoRotate:!1,autoEllipsis:!1,autoHide:{type:"equidistance",cfg:{minGap:6}},offset:e.axisLabelOffset,style:{fill:e.axisLabelFillColor,fontSize:e.axisLabelFontSize,lineHeight:e.axisLabelLineHeight,fontFamily:e.fontFamily}},line:{style:{lineWidth:e.axisLineBorder,stroke:e.axisLineBorderColor}},grid:{line:{type:"line",style:{stroke:e.axisGridBorderColor,lineWidth:e.axisGridBorder,lineDash:e.axisGridLineDash}},alignTick:!0,animate:!0},tickLine:{style:{lineWidth:e.axisTickLineBorder,stroke:e.axisTickLineBorderColor},alignTick:!0,length:e.axisTickLineLength},subTickLine:null,animate:!0}}function C2e(e){return{title:null,marker:{symbol:"circle",spacing:e.legendMarkerSpacing,style:{r:e.legendCircleMarkerSize,fill:e.legendMarkerColor}},itemName:{spacing:5,style:{fill:e.legendItemNameFillColor,fontFamily:e.fontFamily,fontSize:e.legendItemNameFontSize,lineHeight:e.legendItemNameLineHeight,fontWeight:e.legendItemNameFontWeight,textAlign:"start",textBaseline:"middle"}},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:"#D8D8D8"},markerStyle:{fill:"#D8D8D8",stroke:"#D8D8D8"}},inactive:{nameStyle:{fill:"#D8D8D8"},markerStyle:{opacity:.2}}},flipPage:!0,pageNavigator:{marker:{style:{size:e.legendPageNavigatorMarkerSize,inactiveFill:e.legendPageNavigatorMarkerInactiveFillColor,inactiveOpacity:e.legendPageNavigatorMarkerInactiveFillOpacity,fill:e.legendPageNavigatorMarkerFillColor,opacity:e.legendPageNavigatorMarkerFillOpacity}},text:{style:{fill:e.legendPageNavigatorTextFillColor,fontSize:e.legendPageNavigatorTextFontSize}}},animate:!1,maxItemWidth:200,itemSpacing:e.legendItemSpacing,itemMarginBottom:e.legendItemMarginBottom,padding:e.legendPadding}}function AQ(e){var r,t={point:{default:{fill:e.pointFillColor,r:e.pointSize,stroke:e.pointBorderColor,lineWidth:e.pointBorder,fillOpacity:e.pointFillOpacity},active:{stroke:e.pointActiveBorderColor,lineWidth:e.pointActiveBorder},selected:{stroke:e.pointSelectedBorderColor,lineWidth:e.pointSelectedBorder},inactive:{fillOpacity:e.pointInactiveFillOpacity,strokeOpacity:e.pointInactiveBorderOpacity}},hollowPoint:{default:{fill:e.hollowPointFillColor,lineWidth:e.hollowPointBorder,stroke:e.hollowPointBorderColor,strokeOpacity:e.hollowPointBorderOpacity,r:e.hollowPointSize},active:{stroke:e.hollowPointActiveBorderColor,strokeOpacity:e.hollowPointActiveBorderOpacity},selected:{lineWidth:e.hollowPointSelectedBorder,stroke:e.hollowPointSelectedBorderColor,strokeOpacity:e.hollowPointSelectedBorderOpacity},inactive:{strokeOpacity:e.hollowPointInactiveBorderOpacity}},area:{default:{fill:e.areaFillColor,fillOpacity:e.areaFillOpacity,stroke:null},active:{fillOpacity:e.areaActiveFillOpacity},selected:{fillOpacity:e.areaSelectedFillOpacity},inactive:{fillOpacity:e.areaInactiveFillOpacity}},hollowArea:{default:{fill:null,stroke:e.hollowAreaBorderColor,lineWidth:e.hollowAreaBorder,strokeOpacity:e.hollowAreaBorderOpacity},active:{fill:null,lineWidth:e.hollowAreaActiveBorder},selected:{fill:null,lineWidth:e.hollowAreaSelectedBorder},inactive:{strokeOpacity:e.hollowAreaInactiveBorderOpacity}},interval:{default:{fill:e.intervalFillColor,fillOpacity:e.intervalFillOpacity},active:{stroke:e.intervalActiveBorderColor,lineWidth:e.intervalActiveBorder},selected:{stroke:e.intervalSelectedBorderColor,lineWidth:e.intervalSelectedBorder},inactive:{fillOpacity:e.intervalInactiveFillOpacity,strokeOpacity:e.intervalInactiveBorderOpacity}},hollowInterval:{default:{fill:e.hollowIntervalFillColor,stroke:e.hollowIntervalBorderColor,lineWidth:e.hollowIntervalBorder,strokeOpacity:e.hollowIntervalBorderOpacity},active:{stroke:e.hollowIntervalActiveBorderColor,lineWidth:e.hollowIntervalActiveBorder,strokeOpacity:e.hollowIntervalActiveBorderOpacity},selected:{stroke:e.hollowIntervalSelectedBorderColor,lineWidth:e.hollowIntervalSelectedBorder,strokeOpacity:e.hollowIntervalSelectedBorderOpacity},inactive:{stroke:e.hollowIntervalInactiveBorderColor,lineWidth:e.hollowIntervalInactiveBorder,strokeOpacity:e.hollowIntervalInactiveBorderOpacity}},line:{default:{stroke:e.lineBorderColor,lineWidth:e.lineBorder,strokeOpacity:e.lineBorderOpacity,fill:null,lineAppendWidth:10,lineCap:"round",lineJoin:"round"},active:{lineWidth:e.lineActiveBorder},selected:{lineWidth:e.lineSelectedBorder},inactive:{strokeOpacity:e.lineInactiveBorderOpacity}}},n=w2e(e),i=C2e(e);return{background:e.backgroundColor,defaultColor:e.brandColor,subColor:e.subColor,semanticRed:e.paletteSemanticRed,semanticGreen:e.paletteSemanticGreen,padding:"auto",fontFamily:e.fontFamily,columnWidthRatio:1/2,maxColumnWidth:null,minColumnWidth:null,roseWidthRatio:.9999999,multiplePieWidthRatio:1/1.3,colors10:e.paletteQualitative10,colors20:e.paletteQualitative20,sequenceColors:e.paletteSequence,shapes:{point:["hollow-circle","hollow-square","hollow-bowtie","hollow-diamond","hollow-hexagon","hollow-triangle","hollow-triangle-down","circle","square","bowtie","diamond","hexagon","triangle","triangle-down","cross","tick","plus","hyphen","line"],line:["line","dash","dot","smooth"],area:["area","smooth","line","smooth-line"],interval:["rect","hollow-rect","line","tick"]},sizes:[1,10],geometries:{interval:{rect:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:function(a){var o=a.geometry.coordinate;if(o.isPolar&&o.isTransposed){var s=pE(a.getModel(),o),u=s.startAngle,l=s.endAngle,f=(u+l)/2,h=7.5,p=h*Math.cos(f),v=h*Math.sin(f);return{matrix:yl(null,[["t",p,v]])}}return t.interval.selected}}},"hollow-rect":{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},line:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},tick:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},funnel:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}},pyramid:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},line:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},dot:{default:{style:Xe(Xe({},t.line.default),{lineCap:null,lineDash:[1,1]})},active:{style:Xe(Xe({},t.line.active),{lineCap:null,lineDash:[1,1]})},inactive:{style:Xe(Xe({},t.line.inactive),{lineCap:null,lineDash:[1,1]})},selected:{style:Xe(Xe({},t.line.selected),{lineCap:null,lineDash:[1,1]})}},dash:{default:{style:Xe(Xe({},t.line.default),{lineCap:null,lineDash:[5.5,1]})},active:{style:Xe(Xe({},t.line.active),{lineCap:null,lineDash:[5.5,1]})},inactive:{style:Xe(Xe({},t.line.inactive),{lineCap:null,lineDash:[5.5,1]})},selected:{style:Xe(Xe({},t.line.selected),{lineCap:null,lineDash:[5.5,1]})}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hvh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},polygon:{polygon:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},point:{circle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},square:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},bowtie:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},diamond:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},hexagon:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},triangle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"triangle-down":{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"hollow-circle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-square":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-bowtie":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-diamond":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-hexagon":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle-down":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},cross:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},tick:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},plus:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},hyphen:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},line:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}}},area:{area:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},smooth:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},line:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"smooth-line":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}},schema:{candle:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},box:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}}},edge:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},arc:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},violin:{violin:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hollow:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"hollow-smooth":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}}},components:{axis:{common:n,top:{position:"top",grid:null,title:null,verticalLimitLength:1/2},bottom:{position:"bottom",grid:null,title:null,verticalLimitLength:1/2},left:{position:"left",title:null,line:null,tickLine:null,verticalLimitLength:1/3},right:{position:"right",title:null,line:null,tickLine:null,verticalLimitLength:1/3},circle:{title:null,grid:yn({},n.grid,{line:{type:"line"}})},radius:{title:null,grid:yn({},n.grid,{line:{type:"circle"}})}},legend:{common:i,right:{layout:"vertical",padding:e.legendVerticalPadding},left:{layout:"vertical",padding:e.legendVerticalPadding},top:{layout:"horizontal",padding:e.legendHorizontalPadding},bottom:{layout:"horizontal",padding:e.legendHorizontalPadding},continuous:{title:null,background:null,track:{},rail:{type:"color",size:e.sliderRailHeight,defaultLength:e.sliderRailWidth,style:{fill:e.sliderRailFillColor,stroke:e.sliderRailBorderColor,lineWidth:e.sliderRailBorder}},label:{align:"rail",spacing:4,formatter:null,style:{fill:e.sliderLabelTextFillColor,fontSize:e.sliderLabelTextFontSize,lineHeight:e.sliderLabelTextLineHeight,textBaseline:"middle",fontFamily:e.fontFamily}},handler:{size:e.sliderHandlerWidth,style:{fill:e.sliderHandlerFillColor,stroke:e.sliderHandlerBorderColor}},slidable:!0,padding:i.padding}},tooltip:{showContent:!0,follow:!0,showCrosshairs:!1,showMarkers:!0,shared:!1,enterable:!1,position:"auto",marker:{symbol:"circle",stroke:"#fff",shadowBlur:10,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0,0,0,0.09)",lineWidth:2,r:4},crosshairs:{line:{style:{stroke:e.tooltipCrosshairsBorderColor,lineWidth:e.tooltipCrosshairsBorder}},text:null,textBackground:{padding:2,style:{fill:"rgba(0, 0, 0, 0.25)",lineWidth:0,stroke:null}},follow:!1},domStyles:(r={},r["".concat(xy)]={position:"absolute",visibility:"hidden",zIndex:8,transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:e.tooltipContainerFillColor,opacity:e.tooltipContainerFillOpacity,boxShadow:e.tooltipContainerShadow,borderRadius:"".concat(e.tooltipContainerBorderRadius,"px"),color:e.tooltipTextFillColor,fontSize:"".concat(e.tooltipTextFontSize,"px"),fontFamily:e.fontFamily,lineHeight:"".concat(e.tooltipTextLineHeight,"px"),padding:"0 12px 0 12px"},r["".concat(by)]={marginBottom:"12px",marginTop:"12px"},r["".concat(hE)]={margin:0,listStyleType:"none",padding:0},r["".concat(TI)]={listStyleType:"none",padding:0,marginBottom:"12px",marginTop:"12px",marginLeft:0,marginRight:0},r["".concat(MI)]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},r["".concat(LI)]={display:"inline-block",float:"right",marginLeft:"30px"},r)},annotation:{arc:{style:{stroke:e.annotationArcBorderColor,lineWidth:e.annotationArcBorder},animate:!0},line:{style:{stroke:e.annotationLineBorderColor,lineDash:e.annotationLineDash,lineWidth:e.annotationLineBorder},text:{position:"start",autoRotate:!0,style:{fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,textAlign:"start",fontFamily:e.fontFamily,textBaseline:"bottom"}},animate:!0},text:{style:{fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,textBaseline:"middle",textAlign:"start",fontFamily:e.fontFamily},animate:!0},region:{top:!1,style:{lineWidth:e.annotationRegionBorder,stroke:e.annotationRegionBorderColor,fill:e.annotationRegionFillColor,fillOpacity:e.annotationRegionFillOpacity},animate:!0},image:{top:!1,animate:!0},dataMarker:{top:!0,point:{style:{r:3,stroke:e.brandColor,lineWidth:2}},line:{style:{stroke:e.annotationLineBorderColor,lineWidth:e.annotationLineBorder},length:e.annotationDataMarkerLineLength},text:{style:{textAlign:"start",fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,fontFamily:e.fontFamily}},direction:"upward",autoAdjust:!0,animate:!0},dataRegion:{style:{region:{fill:e.annotationRegionFillColor,fillOpacity:e.annotationRegionFillOpacity},text:{textAlign:"center",textBaseline:"bottom",fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,fontFamily:e.fontFamily}},animate:!0}},slider:{common:{padding:[8,8,8,8],backgroundStyle:{fill:e.cSliderBackgroundFillColor,opacity:e.cSliderBackgroundFillOpacity},foregroundStyle:{fill:e.cSliderForegroundFillColor,opacity:e.cSliderForegroundFillOpacity},handlerStyle:{width:e.cSliderHandlerWidth,height:e.cSliderHandlerHeight,fill:e.cSliderHandlerFillColor,opacity:e.cSliderHandlerFillOpacity,stroke:e.cSliderHandlerBorderColor,lineWidth:e.cSliderHandlerBorder,radius:e.cSliderHandlerBorderRadius,highLightFill:e.cSliderHandlerHighlightFillColor},textStyle:{fill:e.cSliderTextFillColor,opacity:e.cSliderTextFillOpacity,fontSize:e.cSliderTextFontSize,lineHeight:e.cSliderTextLineHeight,fontWeight:e.cSliderTextFontWeight,stroke:e.cSliderTextBorderColor,lineWidth:e.cSliderTextBorder}}},scrollbar:{common:{padding:[8,8,8,8]},default:{style:{trackColor:e.scrollbarTrackFillColor,thumbColor:e.scrollbarThumbFillColor}},hover:{style:{thumbColor:e.scrollbarThumbHighlightFillColor}}}},labels:{offset:12,style:{fill:e.labelFillColor,fontSize:e.labelFontSize,fontFamily:e.fontFamily,stroke:e.labelBorderColor,lineWidth:e.labelBorder},fillColorDark:e.labelFillColorDark,fillColorLight:e.labelFillColorLight,autoRotate:!0},innerLabels:{style:{fill:e.innerLabelFillColor,fontSize:e.innerLabelFontSize,fontFamily:e.fontFamily,stroke:e.innerLabelBorderColor,lineWidth:e.innerLabelBorder},autoRotate:!0},overflowLabels:{style:{fill:e.overflowLabelFillColor,fontSize:e.overflowLabelFontSize,fontFamily:e.fontFamily,stroke:e.overflowLabelBorderColor,lineWidth:e.overflowLabelBorder}},pieLabels:{labelHeight:14,offset:10,labelLine:{style:{lineWidth:e.labelLineBorder}},autoRotate:!0}}}var Eo={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},hb={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},E2e=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],S2e=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],A2e=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],TQ=function(e){e===void 0&&(e={});var r=e.paletteQualitative10,t=r===void 0?E2e:r,n=e.paletteQualitative20,i=n===void 0?S2e:n,a=e.brandColor,o=a===void 0?t[0]:a,s={backgroundColor:"transparent",brandColor:o,subColor:"rgba(0,0,0,0.05)",paletteQualitative10:t,paletteQualitative20:i,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:A2e,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:Eo[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:Eo[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:hb[85],axisTickLineBorderColor:Eo[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:Eo[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:Eo[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:Eo[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:Eo[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:o,legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:Eo[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:Eo[100],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:Eo[100],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:Eo[45],legendPageNavigatorTextFontSize:12,sliderRailFillColor:Eo[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:Eo[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:Eo[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:Eo[25],annotationArcBorderColor:Eo[15],annotationArcBorder:1,annotationLineBorderColor:Eo[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:Eo[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:Eo[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:Eo[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"rgb(255, 255, 255)",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 0px 10px #aeaeae",tooltipContainerBorderRadius:3,tooltipTextFillColor:Eo[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:Eo[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:hb[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:Eo[65],overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:hb[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:Eo[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#000",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(0,0,0,0)",scrollbarThumbFillColor:"rgba(0,0,0,0.15)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.2)",pointFillColor:o,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:hb[100],pointBorderOpacity:1,pointActiveBorderColor:Eo[100],pointSelectedBorder:2,pointSelectedBorderColor:Eo[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:o,hollowPointBorderOpacity:.95,hollowPointFillColor:hb[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:Eo[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:Eo[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:o,lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:o,areaFillOpacity:.25,areaActiveFillColor:o,areaActiveFillOpacity:.5,areaSelectedFillColor:o,areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:o,hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:Eo[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:Eo[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:o,intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:Eo[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:Eo[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:o,hollowIntervalBorderOpacity:1,hollowIntervalFillColor:hb[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:Eo[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:Eo[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return Xe(Xe({},s),e)};TQ();function jM(e){var r=e.styleSheet,t=r===void 0?{}:r,n=tp(e,["styleSheet"]),i=TQ(t);return yn({},AQ(i),n)}var T2e=jM({}),f5={default:T2e};function zC(e){return Ie(f5,d1(e),f5.default)}function M2e(e,r){f5[d1(e)]=jM(r)}function cz(e,r,t){var n=t.translate(e),i=t.translate(r);return ac(n,i)}function L2e(e,r){var t=r.coordinate,n=r.getXScale(),i=n.range,a=i[i.length-1],o=i[0],s=t.invert(e),u=s.x;return t.isPolar&&u>(1+a)/2&&(u=o),n.translate(n.invert(u))}function fz(e,r,t){var n=t.coordinate,i=t.getYScale(),a=i.field,o=n.invert(r),s=i.invert(o.y),u=$d(e,function(l){var f=l[Wo];return f[a][0]<=s&&f[a][1]>=s});return u||e[e.length-1]}var I2e=v1(function(e){if(e.isCategory)return 1;for(var r=e.values,t=r.length,n=e.translate(r[0]),i=n,a=0;a<t;a++){var o=r[a],s=e.translate(o);s<n&&(n=s),s>i&&(i=s)}return(i-n)/(t-1)});function k2e(e,r,t){var n=r.getAttribute("position"),i=n.getFields(),a=r.scales,o=kn(t)||!t?i[0]:t,s=a[o],u=s?s.getText(e[o]):e[o]||o;return kn(t)?t(u,e):u}function P2e(e){var r=F2(e.attributes);return kc(r,function(t){return Ug(Vb,t.type)})}function MQ(e){var r,t,n=P2e(e),i;try{for(var a=so(n),o=a.next();!o.done;o=a.next()){var s=o.value,u=s.getScale(s.type);if(u&&u.isLinear){var l=Ie(e.scaleDefs,u.field),f=hQ(u,l,s.type,e.type);if(f!=="cat"){i=u;break}}}}catch(v){r={error:v}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(r)throw r.error}}var h=e.getXScale(),p=e.getYScale();return i||p||h}function R2e(e,r){var t=r.field,n=e[t];if(ar(n)){var i=n.map(function(a){return r.getText(a)});return i.join("-")}return r.getText(n)}function O2e(e,r){var t,n=r.getGroupScales();if(n.length&&(t=n[0]),t){var i=t.field;return t.getText(e[i])}var a=MQ(r);return dE(a)}function LQ(e,r,t){if(r.length===0)return null;var n=t.type,i=t.getXScale(),a=t.getYScale(),o=i.field,s=a.field,u=null;if(n==="heatmap"||n==="point"){for(var l=t.coordinate,f=l.invert(e),h=i.invert(f.x),p=a.invert(f.y),v=1/0,m=0;m<r.length;m++){var x=r[m],E=x[Wo],A=Math.pow(E[o]-h,2)+Math.pow(E[s]-p,2);A<v&&(v=A,u=x)}return u}var L=r[0],k=r[r.length-1],R=L2e(e,t),D=L[Wo][o],$=L[Wo][s],j=k[Wo][o],H=a.isLinear&&ar($);if(ar(D)){for(var m=0;m<r.length;m++){var ee=r[m],E=ee[Wo];if(i.translate(E[o][0])<=R&&i.translate(E[o][1])>=R)if(H)ar(u)||(u=[]),u.push(ee);else{u=ee;break}}ar(u)&&(u=fz(u,e,t))}else{var U=void 0;if(!i.isLinear&&i.type!=="timeCat"){for(var m=0;m<r.length;m++){var ee=r[m],E=ee[Wo];if(cz(E[o],R,i))if(H)ar(u)||(u=[]),u.push(ee);else{u=ee;break}else i.translate(E[o])<=R&&(k=ee,U=r[m+1])}ar(u)&&(u=fz(u,e,t))}else{if((R>i.translate(j)||R<i.translate(D))&&(R>i.max||R<i.min))return null;for(var W=0,Q=r.length-1,te=void 0;W<=Q;){te=Math.floor((W+Q)/2);var ie=r[te][Wo][o];if(cz(ie,R,i))return r[te];i.translate(ie)<=i.translate(R)?(W=te+1,k=r[te],U=r[te+1]):(Q===0&&(k=r[0]),Q=te-1)}}k&&U&&Math.abs(i.translate(k[Wo][o])-R)>Math.abs(i.translate(U[Wo][o])-R)&&(k=U)}var ve=I2e(t.getXScale());return!u&&Math.abs(i.translate(k[Wo][o])-R)<=ve/2&&(u=k),u}function h4(e,r,t,n){var i,a;t===void 0&&(t=""),n===void 0&&(n=!1);var o=e[Wo],s=k2e(o,r,t),u=r.tooltipOption,l=r.theme.defaultColor,f=[],h,p;function v(ee,U){if(n||!rr(U)&&U!==""){var W={title:s,data:o,mappingData:e,name:ee,value:U,color:e.color||l,marker:!0};f.push(W)}}if(xo(u)){var m=u.fields,x=u.callback;if(x){var E=m.map(function(ee){return e[Wo][ee]}),A=x.apply(void 0,vu([],jn(E),!1)),L=Xe({data:e[Wo],mappingData:e,title:s,color:e.color||l,marker:!0},A);f.push(L)}else{var k=r.scales;try{for(var R=so(m),D=R.next();!D.done;D=R.next()){var $=D.value;if(!rr(o[$])){var j=k[$];h=dE(j),p=j.getText(o[$]),v(h,p)}}}catch(ee){i={error:ee}}finally{try{D&&!D.done&&(a=R.return)&&a.call(R)}finally{if(i)throw i.error}}}}else{var H=MQ(r);p=R2e(o,H),h=O2e(o,r),v(h,p)}return f}function hz(e,r,t,n){var i,a,o=n.showNil,s=[],u=e.dataArray;if(!uh(u)){e.sort(u);try{for(var l=so(u),f=l.next();!f.done;f=l.next()){var h=f.value,p=LQ(r,h,e);if(p){var v=e.getElementId(p),m=e.elementsMap[v];if(e.type==="heatmap"||m.visible){var x=h4(p,e,t,o);x.length&&s.push(x)}}}}catch(E){i={error:E}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}return s}function pz(e,r,t,n){var i=n.showNil,a=[],o=e.container,s=o.getShape(r.x,r.y);if(s&&s.get("visible")&&s.get("origin")){var u=s.get("origin").mappingData,l=h4(u,e,t,i);l.length&&a.push(l)}return a}function h5(e,r,t){var n,i,a=[],o=e.geometries,s=t.shared,u=t.title,l=t.reversed;try{for(var f=so(o),h=f.next();!h.done;h=f.next()){var p=h.value;if(p.visible&&p.tooltipOption!==!1){var v=p.type,m=void 0;["point","edge","polygon"].includes(v)?m=pz(p,r,u,t):["area","line","path","heatmap"].includes(v)||s!==!1?m=hz(p,r,u,t):m=pz(p,r,u,t),m.length&&(l&&m.reverse(),a.push(m))}}}catch(x){n={error:x}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}return a}function F2e(e,r,t){var n,i,a=h5(e,r,t);try{for(var o=so(e.views),s=o.next();!s.done;s=o.next()){var u=s.value;a=a.concat(h5(u,r,t))}}catch(l){n={error:l}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}function D2e(e){return!xi(e)&&!ar(e)}function p4(e){e===void 0&&(e=0);var r=ar(e)?e:[e];switch(r.length){case 0:r=[0,0,0,0];break;case 1:r=new Array(4).fill(r[0]);break;case 2:r=vu(vu([],jn(r),!1),jn(r),!1);break;case 3:r=vu(vu([],jn(r),!1),[r[1]],!1);break;default:r=r.slice(0,4);break}return r}var d4={};function m1(e,r){d4[e]=r}function B2e(){return Object.keys(d4)}function N2e(e){return d4[e]}var z2e=function(){function e(r){this.option=this.wrapperOption(r)}return e.prototype.update=function(r){return this.option=this.wrapperOption(r),this},e.prototype.hasAction=function(r){var t=this.option.actions;return uS(t,function(n){return n[0]===r})},e.prototype.create=function(r,t){var n=this.option,i=n.type,a=n.cfg,o=i==="theta",s=Xe({start:r,end:t},a),u=f1e(o?"polar":i);return this.coordinate=new u(s),this.coordinate.type=i,o&&(this.hasAction("transpose")||this.transpose()),this.execActions(),this.coordinate},e.prototype.adjust=function(r,t){return this.coordinate.update({start:r,end:t}),this.coordinate.resetMatrix(),this.execActions(["scale","rotate","translate"]),this.coordinate},e.prototype.rotate=function(r){return this.option.actions.push(["rotate",r]),this},e.prototype.reflect=function(r){return this.option.actions.push(["reflect",r]),this},e.prototype.scale=function(r,t){return this.option.actions.push(["scale",r,t]),this},e.prototype.transpose=function(){return this.option.actions.push(["transpose"]),this},e.prototype.getOption=function(){return this.option},e.prototype.getCoordinate=function(){return this.coordinate},e.prototype.wrapperOption=function(r){return Xe({type:"rect",actions:[],cfg:{}},r)},e.prototype.execActions=function(r){var t=this,n=this.option.actions;we(n,function(i){var a,o=jn(i),s=o[0],u=o.slice(1),l=rr(r)?!0:r.includes(s);l&&(a=t.coordinate)[s].apply(a,vu([],jn(u),!1))})},e}(),ru=function(){function e(r,t,n){this.view=r,this.gEvent=t,this.data=n,this.type=t.type}return e.fromData=function(r,t,n){return new e(r,new fS(t,{}),n)},Object.defineProperty(e.prototype,"target",{get:function(){return this.gEvent.target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"event",{get:function(){return this.gEvent.originalEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.gEvent.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.gEvent.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientX",{get:function(){return this.gEvent.clientX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.gEvent.clientY},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"[Event (type=".concat(this.type,")]")},e.prototype.clone=function(){return new e(this.view,this.gEvent,this.data)},e}();function $2e(e){var r=e.getController("axis"),t=e.getController("legend"),n=e.getController("annotation"),i=e.getController("slider"),a=e.getController("scrollbar");[r,i,a,t,n].forEach(function(o){o&&o.layout()})}var U2e=function(){function e(){this.scales=new Map,this.syncScales=new Map}return e.prototype.createScale=function(r,t,n,i){var a=n,o=this.getScaleMeta(i);if(t.length===0&&o){var s=o.scale,u={type:s.type};s.isCategory&&(u.values=s.values),a=yn(u,o.scaleDef,n)}var l=qbe(r,t,a);return this.cacheScale(l,n,i),l},e.prototype.sync=function(r,t){var n=this;this.syncScales.forEach(function(i,a){var o=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,u=[];we(i,function(l){var f=n.getScale(l);s=xi(f.max)?Math.max(s,f.max):s,o=xi(f.min)?Math.min(o,f.min):o,we(f.values,function(h){u.includes(h)||u.push(h)})}),we(i,function(l){var f=n.getScale(l);if(f.isContinuous)f.change({min:o,max:s,values:u});else if(f.isCategory){var h=f.range,p=n.getScaleMeta(l);u&&!Ie(p,["scaleDef","range"])&&(h=pQ(yn({},f,{values:u}),r,t)),f.change({values:u,range:h})}})})},e.prototype.cacheScale=function(r,t,n){var i=this.getScaleMeta(n);i&&i.scale.type===r.type?(Kbe(i.scale,r),i.scaleDef=t):(i={key:n,scale:r,scaleDef:t},this.scales.set(n,i));var a=this.getSyncKey(i);if(i.syncKey=a,this.removeFromSyncScales(n),a){var o=this.syncScales.get(a);o||(o=[],this.syncScales.set(a,o)),o.push(n)}},e.prototype.getScale=function(r){var t=this.getScaleMeta(r);if(!t){var n=al(r.split("-")),i=this.syncScales.get(n);i&&i.length&&(t=this.getScaleMeta(i[0]))}return t&&t.scale},e.prototype.deleteScale=function(r){var t=this.getScaleMeta(r);if(t){var n=t.syncKey,i=this.syncScales.get(n);if(i&&i.length){var a=i.indexOf(r);a!==-1&&i.splice(a,1)}}this.scales.delete(r)},e.prototype.clear=function(){this.scales.clear(),this.syncScales.clear()},e.prototype.removeFromSyncScales=function(r){var t=this;this.syncScales.forEach(function(n,i){var a=n.indexOf(r);if(a!==-1)return n.splice(a,1),n.length===0&&t.syncScales.delete(i),!1})},e.prototype.getSyncKey=function(r){var t=r.scale,n=r.scaleDef,i=t.field,a=Ie(n,["sync"]);return a===!0?i:a===!1?void 0:a},e.prototype.getScaleMeta=function(r){return this.scales.get(r)},e}(),JT=function(){function e(r,t,n,i){r===void 0&&(r=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),this.top=r,this.right=t,this.bottom=n,this.left=i}return e.instance=function(r,t,n,i){return r===void 0&&(r=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),new e(r,t,n,i)},e.prototype.max=function(r){var t=jn(r,4),n=t[0],i=t[1],a=t[2],o=t[3];return this.top=Math.max(this.top,n),this.right=Math.max(this.right,i),this.bottom=Math.max(this.bottom,a),this.left=Math.max(this.left,o),this},e.prototype.shrink=function(r){var t=jn(r,4),n=t[0],i=t[1],a=t[2],o=t[3];return this.top+=n,this.right+=i,this.bottom+=a,this.left+=o,this},e.prototype.inc=function(r,t){var n=r.width,i=r.height;switch(t){case en.TOP:case en.TOP_LEFT:case en.TOP_RIGHT:this.top+=i;break;case en.RIGHT:case en.RIGHT_TOP:case en.RIGHT_BOTTOM:this.right+=n;break;case en.BOTTOM:case en.BOTTOM_LEFT:case en.BOTTOM_RIGHT:this.bottom+=i;break;case en.LEFT:case en.LEFT_TOP:case en.LEFT_BOTTOM:this.left+=n;break}return this},e.prototype.getPadding=function(){return[this.top,this.right,this.bottom,this.left]},e.prototype.clone=function(){return new(e.bind.apply(e,vu([void 0],jn(this.getPadding()),!1)))},e}();function V2e(e){var r=e.padding;if(!D2e(r))return new(JT.bind.apply(JT,vu([void 0],jn(p4(r)),!1)));var t=e.viewBBox,n=new JT,i=[],a=[],o=[];return we(e.getComponents(),function(s){var u=s.type;u===ic.AXIS?i.push(s):[ic.LEGEND,ic.SLIDER,ic.SCROLLBAR].includes(u)?a.push(s):u!==ic.GRID&&u!==ic.TOOLTIP&&o.push(s)}),we(i,function(s){var u=s.component,l=u.getLayoutBBox(),f=new sh(l.x,l.y,l.width,l.height),h=f.exceed(t);n.max(h)}),we(a,function(s){var u=s.component,l=s.direction,f=u.getLayoutBBox(),h=u.get("padding"),p=new sh(f.x,f.y,f.width,f.height).expand(h);n.inc(p,l)}),we(o,function(s){var u=s.component,l=s.direction,f=u.getLayoutBBox(),h=new sh(f.x,f.y,f.width,f.height);n.inc(h,l)}),n}function G2e(e,r,t){var n=t.instance();r.forEach(function(i){i.autoPadding=n.max(i.autoPadding.getPadding())})}var IQ=function(e){Rn(r,e);function r(t){var n=e.call(this,{visible:t.visible})||this;n.views=[],n.geometries=[],n.controllers=[],n.interactions={},n.limitInPlot=!1,n.options={data:[],animate:!0},n.usedControllers=B2e(),n.scalePool=new U2e,n.layoutFunc=$2e,n.isPreMouseInPlot=!1,n.isDataChanged=!1,n.isCoordinateChanged=!1,n.createdScaleKeys=new Map,n.onCanvasEvent=function(k){var R=k.name;if(!R.includes(":")){var D=n.createViewEvent(k);n.doPlotEvent(D),n.emit(R,D)}},n.onDelegateEvents=function(k){var R=k.name;if(!!R.includes(":")){var D=n.createViewEvent(k);n.emit(R,D)}};var i=t.id,a=i===void 0?Iy("view"):i,o=t.parent,s=t.canvas,u=t.backgroundGroup,l=t.middleGroup,f=t.foregroundGroup,h=t.region,p=h===void 0?{start:{x:0,y:0},end:{x:1,y:1}}:h,v=t.padding,m=t.appendPadding,x=t.theme,E=t.options,A=t.limitInPlot,L=t.syncViewPadding;return n.parent=o,n.canvas=s,n.backgroundGroup=u,n.middleGroup=l,n.foregroundGroup=f,n.region=p,n.padding=v,n.appendPadding=m,n.options=Xe(Xe({},n.options),E),n.limitInPlot=A,n.id=a,n.syncViewPadding=L,n.themeObject=xo(x)?yn({},zC("default"),jM(x)):zC(x),n.init(),n}return r.prototype.setLayout=function(t){this.layoutFunc=t},r.prototype.init=function(){this.calculateViewBBox(),this.initEvents(),this.initComponentController(),this.initOptions()},r.prototype.render=function(t,n){t===void 0&&(t=!1),this.emit(ra.BEFORE_RENDER,ru.fromData(this,ra.BEFORE_RENDER,n)),this.paint(t),this.emit(ra.AFTER_RENDER,ru.fromData(this,ra.AFTER_RENDER,n)),this.visible===!1&&this.changeVisible(!1)},r.prototype.clear=function(){var t=this;this.emit(ra.BEFORE_CLEAR),this.filteredData=[],this.coordinateInstance=void 0,this.isDataChanged=!1,this.isCoordinateChanged=!1;for(var n=this.geometries,i=0;i<n.length;i++)n[i].clear(),n[i].container.remove(!0),n[i].labelsContainer.remove(!0);this.geometries=[];for(var a=this.controllers,i=0;i<a.length;i++)a[i].name==="annotation"?a[i].clear(!0):a[i].clear();this.createdScaleKeys.forEach(function(s,u){t.getRootView().scalePool.deleteScale(u)}),this.createdScaleKeys.clear();for(var o=this.views,i=0;i<o.length;i++)o[i].clear();this.emit(ra.AFTER_CLEAR)},r.prototype.destroy=function(){this.emit(ra.BEFORE_DESTROY);var t=this.interactions;we(t,function(s){s&&s.destroy()}),this.clear();for(var n=this.controllers,i=0,a=n.length;i<a;i++){var o=n[i];o.destroy()}this.backgroundGroup.remove(!0),this.middleGroup.remove(!0),this.foregroundGroup.remove(!0),e.prototype.destroy.call(this)},r.prototype.changeVisible=function(t){e.prototype.changeVisible.call(this,t);for(var n=this.geometries,i=0,a=n.length;i<a;i++){var o=n[i];o.changeVisible(t)}for(var s=this.controllers,i=0,a=s.length;i<a;i++){var u=s[i];u.changeVisible(t)}return this.foregroundGroup.set("visible",t),this.middleGroup.set("visible",t),this.backgroundGroup.set("visible",t),this.getCanvas().draw(),this},r.prototype.data=function(t){return nl(this.options,"data",t),this.isDataChanged=!0,this},r.prototype.source=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.data() instead."),this.data(t)},r.prototype.filter=function(t,n){return kn(n)?(nl(this.options,["filters",t],n),this):(!n&&Ie(this.options,["filters",t])&&delete this.options.filters[t],this)},r.prototype.axis=function(t,n){return Zx(t)?nl(this.options,["axes"],t):nl(this.options,["axes",t],n),this},r.prototype.legend=function(t,n){return Zx(t)?nl(this.options,["legends"],t):ei(t)?(nl(this.options,["legends",t],n),Wv(n)&&(n==null?void 0:n.selected)&&nl(this.options,["filters",t],function(i){var a;return(a=n==null?void 0:n.selected[i])!==null&&a!==void 0?a:!0})):nl(this.options,["legends"],t),this},r.prototype.scale=function(t,n){var i=this;return ei(t)?nl(this.options,["scales",t],n):xo(t)&&we(t,function(a,o){nl(i.options,["scales",o],a)}),this},r.prototype.tooltip=function(t){return nl(this.options,"tooltip",t),this},r.prototype.annotation=function(){return this.getController("annotation")},r.prototype.guide=function(){return console.warn("This method will be removed at G2 V4.1. Please use chart.annotation() instead."),this.annotation()},r.prototype.coordinate=function(t,n){return ei(t)?nl(this.options,"coordinate",{type:t,cfg:n}):nl(this.options,"coordinate",t),this.coordinateController.update(this.options.coordinate),this.coordinateController},r.prototype.coord=function(t,n){return console.warn("This method will be removed at G2 V4.1. Please use chart.coordinate() instead."),this.coordinate(t,n)},r.prototype.facet=function(t,n){this.facetInstance&&this.facetInstance.destroy();var i=t2e(t);if(!i)throw new Error("facet '".concat(t,"' is not exist!"));return this.facetInstance=new i(this,Xe(Xe({},n),{type:t})),this},r.prototype.animate=function(t){return nl(this.options,"animate",t),this},r.prototype.updateOptions=function(t){return this.clear(),Na(this.options,t),this.views.forEach(function(n){return n.destroy()}),this.views=[],this.initOptions(),this.coordinateBBox=this.viewBBox,this},r.prototype.option=function(t,n){if(r.prototype[t])throw new Error(`Can't use built in variable name "`.concat(t,'", please change another one.'));return nl(this.options,t,n),this},r.prototype.theme=function(t){return this.themeObject=xo(t)?yn({},this.themeObject,jM(t)):zC(t),this},r.prototype.interaction=function(t,n){var i=this.interactions[t];i&&i.destroy();var a=b2e(t,this,n);return a&&(a.init(),this.interactions[t]=a),this},r.prototype.removeInteraction=function(t){var n=this.interactions[t];n&&(n.destroy(),this.interactions[t]=void 0)},r.prototype.changeData=function(t){this.isDataChanged=!0,this.emit(ra.BEFORE_CHANGE_DATA,ru.fromData(this,ra.BEFORE_CHANGE_DATA,null)),this.data(t),this.paint(!0);for(var n=this.views,i=0,a=n.length;i<a;i++){var o=n[i];o.changeData(t)}this.emit(ra.AFTER_CHANGE_DATA,ru.fromData(this,ra.AFTER_CHANGE_DATA,null))},r.prototype.createView=function(t){this.parent&&this.parent.parent&&console.warn("The view nesting recursive feature will be removed at G2 V4.1. Please avoid to use it.");var n={data:this.options.data,scales:Of(this.options.scales),axes:Of(this.options.axes),coordinate:Of(this.coordinateController.getOption()),tooltip:Of(this.options.tooltip),legends:Of(this.options.legends),animate:this.options.animate,visible:this.visible},i=new r(Xe(Xe({parent:this,canvas:this.canvas,backgroundGroup:this.backgroundGroup.addGroup({zIndex:Xb.BG}),middleGroup:this.middleGroup.addGroup({zIndex:Xb.MID}),foregroundGroup:this.foregroundGroup.addGroup({zIndex:Xb.FORE}),theme:this.themeObject,padding:this.padding},t),{options:Xe(Xe({},n),Ie(t,"options",{}))}));return this.views.push(i),i},r.prototype.view=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.createView() instead."),this.createView(t)},r.prototype.removeView=function(t){var n=JZ(this.views,function(i){return i===t})[0];return n&&n.destroy(),n},r.prototype.getCoordinate=function(){return this.coordinateInstance},r.prototype.getTheme=function(){return this.themeObject},r.prototype.getXScale=function(){var t=this.geometries[0];return t?t.getXScale():null},r.prototype.getYScales=function(){var t={},n=[];return this.geometries.forEach(function(i){var a=i.getYScale(),o=a.field;t[o]||(t[o]=!0,n.push(a))}),n},r.prototype.getScalesByDim=function(t){for(var n=this.geometries,i={},a=0,o=n.length;a<o;a++){var s=n[a],u=t==="x"?s.getXScale():s.getYScale();u&&!i[u.field]&&(i[u.field]=u)}return i},r.prototype.getScale=function(t,n){var i=n||this.getScaleKey(t);return this.getRootView().scalePool.getScale(i)},r.prototype.getScaleByField=function(t,n){return this.getScale(t,n)},r.prototype.getOptions=function(){return this.options},r.prototype.getData=function(){return this.filteredData},r.prototype.getOriginalData=function(){return this.options.data},r.prototype.getPadding=function(){return this.autoPadding.getPadding()},r.prototype.getGeometries=function(){return this.geometries},r.prototype.getElements=function(){return cf(this.geometries,function(t,n){return t.concat(n.getElements())},[])},r.prototype.getElementsBy=function(t){return this.getElements().filter(function(n){return t(n)})},r.prototype.getLayer=function(t){return t===Vu.BG?this.backgroundGroup:t===Vu.MID?this.middleGroup:t===Vu.FORE?this.foregroundGroup:this.foregroundGroup},r.prototype.isPointInPlot=function(t){return Wbe(this.getCoordinate(),t)},r.prototype.getLegendAttributes=function(){return pp(this.geometries.map(function(t){return t.getGroupAttributes()}))},r.prototype.getGroupScales=function(){var t=this.geometries.map(function(n){return n.getGroupScales()});return L0(pp(t))},r.prototype.getCanvas=function(){return this.getRootView().canvas},r.prototype.getRootView=function(){for(var t=this;;){if(t.parent){t=t.parent;continue}break}return t},r.prototype.getXY=function(t){var n=this.getCoordinate(),i=this.getScalesByDim("x"),a=this.getScalesByDim("y"),o,s;if(we(t,function(u,l){i[l]&&(o=i[l].scale(u)),a[l]&&(s=a[l].scale(u))}),!rr(o)&&!rr(s))return n.convert({x:o,y:s})},r.prototype.getController=function(t){return $d(this.controllers,function(n){return n.name===t})},r.prototype.showTooltip=function(t){var n=this.getController("tooltip");return n&&n.showTooltip(t),this},r.prototype.hideTooltip=function(){var t=this.getController("tooltip");return t&&t.hideTooltip(),this},r.prototype.lockTooltip=function(){var t=this.getController("tooltip");return t&&t.lockTooltip(),this},r.prototype.unlockTooltip=function(){var t=this.getController("tooltip");return t&&t.unlockTooltip(),this},r.prototype.isTooltipLocked=function(){var t=this.getController("tooltip");return t&&t.isTooltipLocked()},r.prototype.getTooltipItems=function(t){var n=this.getController("tooltip");return n?n.getTooltipItems(t):[]},r.prototype.getSnapRecords=function(t){for(var n=this.geometries,i=[],a=0,o=n.length;a<o;a++){var s=n[a],u=s.dataArray;s.sort(u);for(var l=void 0,f=0,h=u.length;f<h;f++){var p=u[f];l=LQ(t,p,s),l&&i.push(l)}}for(var v=this.views,a=0,o=v.length;a<o;a++){var m=v[a],x=m.getSnapRecords(t);i=i.concat(x)}return i},r.prototype.getComponents=function(){for(var t=[],n=this.controllers,i=0,a=n.length;i<a;i++){var o=n[i];t=t.concat(o.getComponents())}return t},r.prototype.filterData=function(t){var n=this.options.filters;return zl(n)===0?t:kc(t,function(i,a){var o=Object.keys(n);return o.every(function(s){var u=n[s];return u(i[s],i,a)})})},r.prototype.filterFieldData=function(t,n){var i=this.options.filters,a=Ie(i,t);return R0(a)?n:n.filter(function(o,s){return a(o[t],o,s)})},r.prototype.adjustCoordinate=function(){var t=this.getCoordinate(),n=t.start,i=t.end,a=this.coordinateBBox.bl,o=this.coordinateBBox.tr;if(rs(n,a)&&rs(i,o)){this.isCoordinateChanged=!1;return}this.isCoordinateChanged=!0,this.coordinateInstance=this.coordinateController.adjust(a,o)},r.prototype.paint=function(t){this.renderDataRecursive(t),this.syncScale(),this.emit(ra.BEFORE_PAINT),this.renderPaddingRecursive(t),this.renderLayoutRecursive(t),this.renderBackgroundStyleShape(),this.renderPaintRecursive(t),this.emit(ra.AFTER_PAINT),this.isDataChanged=!1},r.prototype.renderBackgroundStyleShape=function(){if(!this.parent){var t=Ie(this.themeObject,"background");if(t){this.backgroundStyleRectShape||(this.backgroundStyleRectShape=this.backgroundGroup.addShape("rect",{attrs:{},zIndex:-1,capture:!1}),this.backgroundStyleRectShape.toBack());var n=this.viewBBox,i=n.x,a=n.y,o=n.width,s=n.height;this.backgroundStyleRectShape.attr({fill:t,x:i,y:a,width:o,height:s})}else this.backgroundStyleRectShape&&(this.backgroundStyleRectShape.remove(!0),this.backgroundStyleRectShape=void 0)}},r.prototype.renderPaddingRecursive=function(t){this.calculateViewBBox(),this.adjustCoordinate(),this.initComponents(t),this.autoPadding=V2e(this).shrink(p4(this.appendPadding)),this.coordinateBBox=this.viewBBox.shrink(this.autoPadding.getPadding()),this.adjustCoordinate();var n=this.controllers.find(function(u){return u.name==="tooltip"});n.update();for(var i=this.views,a=0,o=i.length;a<o;a++){var s=i[a];s.renderPaddingRecursive(t)}},r.prototype.renderLayoutRecursive=function(t){var n=this.syncViewPadding===!0?G2e:kn(this.syncViewPadding)?this.syncViewPadding:void 0;n&&(n(this,this.views,JT),this.views.forEach(function(u){u.coordinateBBox=u.viewBBox.shrink(u.autoPadding.getPadding()),u.adjustCoordinate()})),this.doLayout();for(var i=this.views,a=0,o=i.length;a<o;a++){var s=i[a];s.renderLayoutRecursive(t)}},r.prototype.renderPaintRecursive=function(t){var n=this.middleGroup;if(this.limitInPlot){var i=s4(this.coordinateInstance),a=i.type,o=i.attrs;n.setClip({type:a,attrs:o})}else n.setClip(void 0);this.paintGeometries(t),this.renderComponents(t);for(var s=this.views,u=0,l=s.length;u<l;u++){var f=s[u];f.renderPaintRecursive(t)}},r.prototype.createScale=function(t,n,i,a){var o=Ie(this.options.scales,[t]),s=Xe(Xe({},o),i);return this.parent?this.parent.createScale(t,n,s,a):this.scalePool.createScale(t,n,s,a)},r.prototype.renderDataRecursive=function(t){this.doFilterData(),this.createCoordinate(),this.initGeometries(t),this.renderFacet(t);for(var n=this.views,i=0,a=n.length;i<a;i++){var o=n[i];o.renderDataRecursive(t)}},r.prototype.calculateViewBBox=function(){var t,n,i,a;if(this.parent){var o=this.parent.coordinateBBox;t=o.x,n=o.y,i=o.width,a=o.height}else t=0,n=0,i=this.canvas.get("width"),a=this.canvas.get("height");var s=this.region,u=s.start,l=s.end,f=new sh(t+i*u.x,n+a*u.y,i*(l.x-u.x),a*(l.y-u.y));(!this.viewBBox||!this.viewBBox.isEqual(f))&&(this.viewBBox=new sh(t+i*u.x,n+a*u.y,i*(l.x-u.x),a*(l.y-u.y))),this.coordinateBBox=this.viewBBox},r.prototype.initEvents=function(){this.foregroundGroup.on("*",this.onDelegateEvents),this.middleGroup.on("*",this.onDelegateEvents),this.backgroundGroup.on("*",this.onDelegateEvents),this.canvas.on("*",this.onCanvasEvent)},r.prototype.initComponentController=function(){for(var t=this.usedControllers,n=0,i=t.length;n<i;n++){var a=t[n],o=N2e(a);o&&this.controllers.push(new o(this))}},r.prototype.createViewEvent=function(t){var n=t.shape,i=t.name,a=n?n.get("origin"):null,o=new ru(this,t,a);return o.type=i,o},r.prototype.doPlotEvent=function(t){var n=t.type,i=t.x,a=t.y,o={x:i,y:a},s=["mousedown","mouseup","mousemove","mouseleave","mousewheel","touchstart","touchmove","touchend","touchcancel","click","dblclick","contextmenu"];if(s.includes(n)){var u=this.isPointInPlot(o),l=t.clone();if(u){var f="plot:".concat(n);l.type=f,this.emit(f,l),(n==="mouseleave"||n==="touchend")&&(this.isPreMouseInPlot=!1)}n==="mousemove"||n==="touchmove"?(this.isPreMouseInPlot&&!u?(n==="mousemove"&&(l.type=Qh.MOUSE_LEAVE,this.emit(Qh.MOUSE_LEAVE,l)),l.type=Qh.LEAVE,this.emit(Qh.LEAVE,l)):!this.isPreMouseInPlot&&u&&(n==="mousemove"&&(l.type=Qh.MOUSE_ENTER,this.emit(Qh.MOUSE_ENTER,l)),l.type=Qh.ENTER,this.emit(Qh.ENTER,l)),this.isPreMouseInPlot=u):(n==="mouseleave"||n==="touchend")&&this.isPreMouseInPlot&&(n==="mouseleave"&&(l.type=Qh.MOUSE_LEAVE,this.emit(Qh.MOUSE_LEAVE,l)),l.type=Qh.LEAVE,this.emit(Qh.LEAVE,l),this.isPreMouseInPlot=!1)}},r.prototype.doFilterData=function(){var t=this.options.data;this.filteredData=this.filterData(t)},r.prototype.initGeometries=function(t){this.createOrUpdateScales();for(var n=this.getCoordinate(),i=Ie(this.options,"scales",{}),a=this.geometries,o=0,s=a.length;o<s;o++){var u=a[o];u.scales=this.getGeometryScales();var l={coordinate:n,scaleDefs:i,data:this.filteredData,theme:this.themeObject,isDataChanged:this.isDataChanged,isCoordinateChanged:this.isCoordinateChanged};t?u.update(l):u.init(l)}this.adjustScales()},r.prototype.createOrUpdateScales=function(){for(var t=this.getScaleFields(),n=this.getGroupedFields(),i=this.getOptions(),a=i.data,o=i.scales,s=o===void 0?{}:o,u=this.filteredData,l=0,f=t.length;l<f;l++){var h=t[l],p=s[h],v=this.getScaleKey(h);this.createScale(h,n.includes(h)?a:u,p,v),this.createdScaleKeys.set(v,!0)}},r.prototype.syncScale=function(){this.getRootView().scalePool.sync(this.getCoordinate(),this.theme)},r.prototype.getGeometryScales=function(){for(var t=this.getScaleFields(),n={},i=0;i<t.length;i++){var a=t[i];n[a]=this.getScaleByField(a)}return n},r.prototype.getScaleFields=function(){for(var t=[],n=new Map,i=this.geometries,a=0;a<i.length;a++){var o=i[a],s=o.getScaleFields();L0(s,t,n)}return t},r.prototype.getGroupedFields=function(){for(var t=[],n=new Map,i=this.geometries,a=0;a<i.length;a++){var o=i[a],s=o.getGroupFields();L0(s,t,n)}return t},r.prototype.adjustScales=function(){this.adjustCategoryScaleRange()},r.prototype.adjustCategoryScaleRange=function(){var t=this,n=vu([this.getXScale()],jn(this.getYScales()),!1).filter(function(o){return!!o}),i=this.getCoordinate(),a=this.options.scales;we(n,function(o){var s=o.field,u=o.values,l=o.isCategory,f=o.isIdentity;(l||f)&&u&&!Ie(a,[s,"range"])&&(o.range=pQ(o,i,t.theme))})},r.prototype.initComponents=function(t){for(var n=this.controllers,i=0;i<n.length;i++){var a=n[i];t?a.update():(a.clear(),a.render())}},r.prototype.doLayout=function(){this.layoutFunc(this)},r.prototype.createCoordinate=function(){var t=this.coordinateBBox.bl,n=this.coordinateBBox.tr;this.coordinateInstance=this.coordinateController.create(t,n)},r.prototype.paintGeometries=function(t){for(var n=this.options.animate,i=this.getCoordinate(),a={x:this.viewBBox.x,y:this.viewBBox.y,minX:this.viewBBox.minX,minY:this.viewBBox.minY,maxX:this.viewBBox.maxX,maxY:this.viewBBox.maxY,width:this.viewBBox.width,height:this.viewBBox.height},o=this.geometries,s=0;s<o.length;s++){var u=o[s];u.coordinate=i,u.canvasRegion=a,n||u.animate(!1),u.paint(t)}},r.prototype.renderComponents=function(t){for(var n=this.getComponents(),i=0;i<n.length;i++){var a=n[i];a.component.render()}},r.prototype.renderFacet=function(t){this.facetInstance&&(t?this.facetInstance.update():(this.facetInstance.clear(),this.facetInstance.init(),this.facetInstance.render()))},r.prototype.initOptions=function(){var t=this,n=this.options,i=n.geometries,a=i===void 0?[]:i,o=n.interactions,s=o===void 0?[]:o,u=n.views,l=u===void 0?[]:u,f=n.annotations,h=f===void 0?[]:f,p=n.coordinate,v=n.events,m=n.facets;this.coordinateController?p&&this.coordinateController.update(p):this.coordinateController=new z2e(p);for(var x=0;x<a.length;x++){var E=a[x];this.createGeometry(E)}for(var A=0;A<s.length;A++){var L=s[A],k=L.type,R=L.cfg;this.interaction(k,R)}for(var D=0;D<l.length;D++){var $=l[D];this.createView($)}for(var j=this.getController("annotation"),H=0;H<h.length;H++){var ee=h[H];j.annotation(ee)}v&&we(v,function(U,W){t.on(W,U)}),m&&we(m,function(U){var W=U.type,Q=tp(U,["type"]);t.facet(W,Q)})},r.prototype.createGeometry=function(t){var n=t.type,i=t.cfg,a=i===void 0?{}:i;if(this[n]){var o=this[n](a);we(t,function(s,u){kn(o[u])&&o[u](s)})}},r.prototype.getScaleKey=function(t){return"".concat(this.id,"-").concat(t)},r}(R3);function im(e,r){IQ.prototype[e.toLowerCase()]=function(t){t===void 0&&(t={});var n=Xe({container:this.middleGroup.addGroup(),labelsContainer:this.foregroundGroup.addGroup()},t),i=new r(n);return this.geometries.push(i),i}}var H2e=function(e){Rn(r,e);function r(t){var n=this,i=t.container,a=t.width,o=t.height,s=t.autoFit,u=s===void 0?!1:s,l=t.padding,f=t.appendPadding,h=t.renderer,p=h===void 0?"canvas":h,v=t.pixelRatio,m=t.localRefresh,x=m===void 0?!0:m,E=t.visible,A=E===void 0?!0:E,L=t.supportCSSTransform,k=L===void 0?!1:L,R=t.defaultInteractions,D=R===void 0?["tooltip","legend-filter","legend-active","continuous-filter","ellipsis-text","axis-description"]:R,$=t.options,j=t.limitInPlot,H=t.theme,ee=t.syncViewPadding,U=ei(i)?document.getElementById(i):i,W=ly('<div style="position:relative;"></div>');U.appendChild(W);var Q=k7(U,u,a,o),te=Nge(p),ie=new te.Canvas(Xe({container:W,pixelRatio:v,localRefresh:x,supportCSSTransform:k},Q));return n=e.call(this,{parent:null,canvas:ie,backgroundGroup:ie.addGroup({zIndex:Xb.BG}),middleGroup:ie.addGroup({zIndex:Xb.MID}),foregroundGroup:ie.addGroup({zIndex:Xb.FORE}),padding:l,appendPadding:f,visible:A,options:$,limitInPlot:j,theme:H,syncViewPadding:ee})||this,n.onResize=k3(function(){n.forceFit()},300),n.ele=U,n.canvas=ie,n.width=Q.width,n.height=Q.height,n.autoFit=u,n.localRefresh=x,n.renderer=p,n.wrapperElement=W,n.updateCanvasStyle(),n.bindAutoFit(),n.initDefaultInteractions(D),n}return r.prototype.initDefaultInteractions=function(t){var n=this;we(t,function(i){n.interaction(i)})},r.prototype.aria=function(t){var n="aria-label";t===!1?this.ele.removeAttribute(n):this.ele.setAttribute(n,t.label)},r.prototype.changeSize=function(t,n){return this.width===t&&this.height===n?this:(this.emit(ra.BEFORE_CHANGE_SIZE),this.width=t,this.height=n,this.canvas.changeSize(t,n),this.render(!0),this.emit(ra.AFTER_CHANGE_SIZE),this)},r.prototype.clear=function(){e.prototype.clear.call(this),this.aria(!1)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.unbindAutoFit(),this.canvas.destroy(),jge(this.wrapperElement),this.wrapperElement=null},r.prototype.changeVisible=function(t){return e.prototype.changeVisible.call(this,t),this.wrapperElement.style.display=t?"":"none",this},r.prototype.forceFit=function(){if(!this.destroyed){var t=k7(this.ele,!0,this.width,this.height),n=t.width,i=t.height;this.changeSize(n,i)}},r.prototype.updateCanvasStyle=function(){es(this.canvas.get("el"),{display:"inline-block",verticalAlign:"middle"})},r.prototype.bindAutoFit=function(){this.autoFit&&window.addEventListener("resize",this.onResize)},r.prototype.unbindAutoFit=function(){this.autoFit&&window.removeEventListener("resize",this.onResize)},r}(IQ),V2=function(){function e(r){this.visible=!0,this.components=[],this.view=r}return e.prototype.clear=function(r){we(this.components,function(t){t.component.destroy()}),this.components=[]},e.prototype.destroy=function(){this.clear()},e.prototype.getComponents=function(){return this.components},e.prototype.changeVisible=function(r){this.visible!==r&&(this.components.forEach(function(t){r?t.component.show():t.component.hide()}),this.visible=r)},e}();function j2e(e){for(var r=[],t=function(i){var a=e[i],o=$d(r,function(s){return s.color===a.color&&s.name===a.name&&s.value===a.value&&s.title===a.title});o||r.push(a)},n=0;n<e.length;n++)t(n);return r}var kQ=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.isLocked=!1,t}return Object.defineProperty(r.prototype,"name",{get:function(){return"tooltip"},enumerable:!1,configurable:!0}),r.prototype.init=function(){},r.prototype.isVisible=function(){var t=this.view.getOptions().tooltip;return t!==!1},r.prototype.render=function(){},r.prototype.showTooltip=function(t){if(this.point=t,!!this.isVisible()){var n=this.view,i=this.getTooltipItems(t);if(!i.length){this.hideTooltip();return}var a=this.getTitle(i),o={x:i[0].x,y:i[0].y};n.emit("tooltip:show",ru.fromData(n,"tooltip:show",Xe({items:i,title:a},t)));var s=this.getTooltipCfg(),u=s.follow,l=s.showMarkers,f=s.showCrosshairs,h=s.showContent,p=s.marker,v=this.items,m=this.title;if(!rs(m,a)||!rs(v,i)?(n.emit("tooltip:change",ru.fromData(n,"tooltip:change",Xe({items:i,title:a},t))),(kn(h)?h(i):h)&&(this.tooltip||this.renderTooltip(),this.tooltip.update(Na({},s,{items:this.getItemsAfterProcess(i),title:a},u?t:{})),this.tooltip.show()),l&&this.renderTooltipMarkers(i,p)):(this.tooltip&&u&&(this.tooltip.update(t),this.tooltip.show()),this.tooltipMarkersGroup&&this.tooltipMarkersGroup.show()),this.items=i,this.title=a,f){var x=Ie(s,["crosshairs","follow"],!1);this.renderCrosshairs(x?t:o,s)}}},r.prototype.hideTooltip=function(){var t=this.getTooltipCfg().follow;if(!t){this.point=null;return}var n=this.tooltipMarkersGroup;n&&n.hide();var i=this.xCrosshair,a=this.yCrosshair;i&&i.hide(),a&&a.hide();var o=this.tooltip;o&&o.hide(),this.view.emit("tooltip:hide",ru.fromData(this.view,"tooltip:hide",{})),this.point=null},r.prototype.lockTooltip=function(){this.isLocked=!0,this.tooltip&&this.tooltip.setCapture(!0)},r.prototype.unlockTooltip=function(){this.isLocked=!1;var t=this.getTooltipCfg();this.tooltip&&this.tooltip.setCapture(t.capture)},r.prototype.isTooltipLocked=function(){return this.isLocked},r.prototype.clear=function(){var t=this,n=t.tooltip,i=t.xCrosshair,a=t.yCrosshair,o=t.tooltipMarkersGroup;n&&(n.hide(),n.clear()),i&&i.clear(),a&&a.clear(),o&&o.clear(),n!=null&&n.get("customContent")&&(this.tooltip.destroy(),this.tooltip=null),this.title=null,this.items=null},r.prototype.destroy=function(){this.tooltip&&this.tooltip.destroy(),this.xCrosshair&&this.xCrosshair.destroy(),this.yCrosshair&&this.yCrosshair.destroy(),this.guideGroup&&this.guideGroup.remove(!0),this.reset()},r.prototype.reset=function(){this.items=null,this.title=null,this.tooltipMarkersGroup=null,this.tooltipCrosshairsGroup=null,this.xCrosshair=null,this.yCrosshair=null,this.tooltip=null,this.guideGroup=null,this.isLocked=!1,this.point=null},r.prototype.changeVisible=function(t){if(this.visible!==t){var n=this,i=n.tooltip,a=n.tooltipMarkersGroup,o=n.xCrosshair,s=n.yCrosshair;t?(i&&i.show(),a&&a.show(),o&&o.show(),s&&s.show()):(i&&i.hide(),a&&a.hide(),o&&o.hide(),s&&s.hide()),this.visible=t}},r.prototype.getTooltipItems=function(t){var n,i,a,o,s,u,l=this.findItemsFromView(this.view,t);if(l.length){l=pp(l);try{for(var f=so(l),h=f.next();!h.done;h=f.next()){var p=h.value;try{for(var v=(a=void 0,so(p)),m=v.next();!m.done;m=v.next()){var x=m.value,E=x.mappingData,A=E.x,L=E.y;x.x=ar(A)?A[A.length-1]:A,x.y=ar(L)?L[L.length-1]:L}}catch(U){a={error:U}}finally{try{m&&!m.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}}}catch(U){n={error:U}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}var k=this.getTooltipCfg().shared;if(k===!1&&l.length>1){var R=l[0],D=Math.abs(t.y-R[0].y);try{for(var $=so(l),j=$.next();!j.done;j=$.next()){var H=j.value,ee=Math.abs(t.y-H[0].y);ee<=D&&(R=H,D=ee)}}catch(U){s={error:U}}finally{try{j&&!j.done&&(u=$.return)&&u.call($)}finally{if(s)throw s.error}}l=[R]}return j2e(pp(l))}return[]},r.prototype.layout=function(){},r.prototype.update=function(){if(this.point&&this.showTooltip(this.point),this.tooltip){var t=this.view.getCanvas();this.tooltip.set("region",{start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}})}},r.prototype.isCursorEntered=function(t){if(this.tooltip){var n=this.tooltip.getContainer(),i=this.tooltip.get("capture");if(n&&i){var a=n.getBoundingClientRect(),o=a.x,s=a.y,u=a.width,l=a.height;return new sh(o,s,u,l).isPointIn(t)}}return!1},r.prototype.getTooltipCfg=function(){var t=this.view,n=t.getOptions().tooltip,i=this.processCustomContent(n),a=t.getTheme(),o=Ie(a,["components","tooltip"],{}),s=Ie(i,"enterable",o.enterable);return yn({},o,i,{capture:!!(s||this.isLocked)})},r.prototype.processCustomContent=function(t){if(Zx(t)||!Ie(t,"customContent"))return t;var n=t.customContent,i=function(a,o){var s=n(a,o)||"";return ei(s)?'<div class="g2-tooltip">'+s+"</div>":s};return Xe(Xe({},t),{customContent:i})},r.prototype.getTitle=function(t){var n=t[0].title||t[0].name;return this.title=n,n},r.prototype.renderTooltip=function(){var t=this.view.getCanvas(),n={start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}},i=this.getTooltipCfg(),a=new II(Xe(Xe({parent:t.get("el").parentNode,region:n},i),{visible:!1,crosshairs:null}));a.init(),this.tooltip=a},r.prototype.renderTooltipMarkers=function(t,n){var i,a,o=this.getTooltipMarkersGroup(),s=this.view.getRootView(),u=s.limitInPlot;try{for(var l=so(t),f=l.next();!f.done;f=l.next()){var h=f.value,p=h.x,v=h.y;if(u||(o==null?void 0:o.getClip())){var m=s4(s.getCoordinate()),x=m.type,E=m.attrs;o==null||o.setClip({type:x,attrs:E})}else o==null||o.setClip(void 0);var A=this.view.getTheme(),L=Ie(A,["components","tooltip","marker"],{}),k=Xe(Xe({fill:h.color,symbol:"circle",shadowColor:h.color},kn(n)?Xe(Xe({},L),n(h)):n),{x:p,y:v});o.addShape("marker",{attrs:k})}}catch(R){i={error:R}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}},r.prototype.renderCrosshairs=function(t,n){var i=Ie(n,["crosshairs","type"],"x");i==="x"?(this.yCrosshair&&this.yCrosshair.hide(),this.renderXCrosshairs(t,n)):i==="y"?(this.xCrosshair&&this.xCrosshair.hide(),this.renderYCrosshairs(t,n)):i==="xy"&&(this.renderXCrosshairs(t,n),this.renderYCrosshairs(t,n))},r.prototype.renderXCrosshairs=function(t,n){var i=this.getViewWithGeometry(this.view).getCoordinate(),a,o;if(i.isRect)i.isTransposed?(a={x:i.start.x,y:t.y},o={x:i.end.x,y:t.y}):(a={x:t.x,y:i.end.y},o={x:t.x,y:i.start.y});else{var s=p2(i,t),u=i.getCenter(),l=i.getRadius();o=il(u.x,u.y,l,s),a=u}var f=yn({start:a,end:o,container:this.getTooltipCrosshairsGroup()},Ie(n,"crosshairs",{}),this.getCrosshairsText("x",t,n));delete f.type;var h=this.xCrosshair;h?h.update(f):(h=new iQ(f),h.init()),h.render(),h.show(),this.xCrosshair=h},r.prototype.renderYCrosshairs=function(t,n){var i=this.getViewWithGeometry(this.view).getCoordinate(),a,o;if(i.isRect){var s=void 0,u=void 0;i.isTransposed?(s={x:t.x,y:i.end.y},u={x:t.x,y:i.start.y}):(s={x:i.start.x,y:t.y},u={x:i.end.x,y:t.y}),a={start:s,end:u},o="Line"}else a={center:i.getCenter(),radius:kI(i,t),startAngle:i.startAngle,endAngle:i.endAngle},o="Circle";a=yn({container:this.getTooltipCrosshairsGroup()},a,Ie(n,"crosshairs",{}),this.getCrosshairsText("y",t,n)),delete a.type;var l=this.yCrosshair;l?i.isRect&&l.get("type")==="circle"||!i.isRect&&l.get("type")==="line"?(l=new Z8[o](a),l.init()):l.update(a):(l=new Z8[o](a),l.init()),l.render(),l.show(),this.yCrosshair=l},r.prototype.getCrosshairsText=function(t,n,i){var a=Ie(i,["crosshairs","text"]),o=Ie(i,["crosshairs","follow"]),s=this.items;if(a){var u=this.getViewWithGeometry(this.view),l=s[0],f=u.getXScale(),h=u.getYScales()[0],p=void 0,v=void 0;if(o){var m=this.view.getCoordinate().invert(n);p=f.invert(m.x),v=h.invert(m.y)}else p=l.data[f.field],v=l.data[h.field];var x=t==="x"?p:v;return kn(a)?a=a(t,x,s,n):a.content=x,{text:a}}},r.prototype.getGuideGroup=function(){if(!this.guideGroup){var t=this.view.foregroundGroup;this.guideGroup=t.addGroup({name:"tooltipGuide",capture:!1})}return this.guideGroup},r.prototype.getTooltipMarkersGroup=function(){var t=this.tooltipMarkersGroup;return t&&!t.destroyed?(t.clear(),t.show()):(t=this.getGuideGroup().addGroup({name:"tooltipMarkersGroup"}),t.toFront(),this.tooltipMarkersGroup=t),t},r.prototype.getTooltipCrosshairsGroup=function(){var t=this.tooltipCrosshairsGroup;return t||(t=this.getGuideGroup().addGroup({name:"tooltipCrosshairsGroup",capture:!1}),t.toBack(),this.tooltipCrosshairsGroup=t),t},r.prototype.findItemsFromView=function(t,n){var i,a;if(t.getOptions().tooltip===!1)return[];var o=this.getTooltipCfg(),s=h5(t,n,o);try{for(var u=so(t.views),l=u.next();!l.done;l=u.next()){var f=l.value;s=s.concat(this.findItemsFromView(f,n))}}catch(h){i={error:h}}finally{try{l&&!l.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}return s},r.prototype.getViewWithGeometry=function(t){var n=this;return t.geometries.length?t:$d(t.views,function(i){return n.getViewWithGeometry(i)})},r.prototype.getItemsAfterProcess=function(t){var n=this.getTooltipCfg().customItems,i=n||function(a){return a};return i(t)},r}(V2),PQ={};function RQ(e){return PQ[e.toLowerCase()]}function td(e,r){PQ[e.toLowerCase()]=r}var v2={appear:{duration:450,easing:"easeQuadOut"},update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},W2e={interval:function(e){return{enter:{animation:e.isRect?e.isTransposed?"scale-in-x":"scale-in-y":"fade-in"},update:{animation:e.isPolar&&e.isTransposed?"sector-path-update":null},leave:{animation:"fade-out"}}},line:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},path:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},point:{appear:{animation:"zoom-in"},enter:{animation:"zoom-in"},leave:{animation:"zoom-out"}},area:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},polygon:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},schema:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},edge:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},label:{appear:{animation:"fade-in",delay:450},enter:{animation:"fade-in"},update:{animation:"position-update"},leave:{animation:"fade-out"}}},dz={line:function(){return{animation:"wave-in"}},area:function(){return{animation:"wave-in"}},path:function(){return{animation:"fade-in"}},interval:function(e){var r;return e.isRect?r=e.isTransposed?"grow-in-x":"grow-in-y":(r="grow-in-xy",e.isPolar&&e.isTransposed&&(r="wave-in")),{animation:r}},schema:function(e){var r;return e.isRect?r=e.isTransposed?"grow-in-x":"grow-in-y":r="grow-in-xy",{animation:r}},polygon:function(){return{animation:"fade-in",duration:500}},edge:function(){return{animation:"fade-in"}}};function X2e(e,r){return{delay:kn(e.delay)?e.delay(r):e.delay,easing:kn(e.easing)?e.easing(r):e.easing,duration:kn(e.duration)?e.duration(r):e.duration,callback:e.callback,repeat:e.repeat}}function OQ(e,r,t){var n=W2e[e];return n&&(kn(n)&&(n=n(r)),n=yn({},v2,n),t)?n[t]:n}function Kb(e,r,t){var n=Ie(e.get("origin"),"data",Wo),i=r.animation,a=X2e(r,n);if(i){var o=RQ(i);o&&o(e,a,t)}else e.animate(t.toAttrs,a)}function Y2e(e,r,t,n,i){if(dz[t]){var a=dz[t](n),o=RQ(Ie(a,"animation",""));if(o){var s=Xe(Xe(Xe({},v2.appear),a),r);e.stopAnimate(),o(e,s,{coordinate:n,minYPoint:i,toAttrs:null})}}}var v4="element-background",FQ=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;n.labelShape=[],n.states=[];var i=t.shapeFactory,a=t.container,o=t.offscreenGroup,s=t.elementIndex,u=t.visible,l=u===void 0?!0:u;return n.shapeFactory=i,n.container=a,n.offscreenGroup=o,n.visible=l,n.elementIndex=s,n}return r.prototype.draw=function(t,n){n===void 0&&(n=!1),this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.drawShape(t,n),this.visible===!1&&this.changeVisible(!1)},r.prototype.update=function(t){var n=this,i=n.shapeFactory,a=n.shape;if(!!a){this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.setShapeInfo(a,t);var o=this.getOffscreenGroup(),s=i.drawShape(this.shapeType,t,o);s.cfg.data=this.data,s.cfg.origin=t,s.cfg.element=this,this.syncShapeStyle(a,s,this.getStates(),this.getAnimateCfg("update"))}},r.prototype.destroy=function(){var t=this,n=t.shapeFactory,i=t.shape;if(i){var a=this.getAnimateCfg("leave");a?Kb(i,a,{coordinate:n.coordinate,toAttrs:Xe({},i.attr())}):i.remove(!0)}this.states=[],this.shapeFactory=void 0,this.container=void 0,this.shape=void 0,this.animate=void 0,this.geometry=void 0,this.labelShape=[],this.model=void 0,this.data=void 0,this.offscreenGroup=void 0,this.statesStyle=void 0,e.prototype.destroy.call(this)},r.prototype.changeVisible=function(t){e.prototype.changeVisible.call(this,t),t?(this.shape&&this.shape.show(),this.labelShape&&this.labelShape.forEach(function(n){n.show()})):(this.shape&&this.shape.hide(),this.labelShape&&this.labelShape.forEach(function(n){n.hide()}))},r.prototype.setState=function(t,n){var i=this,a=i.states,o=i.shapeFactory,s=i.model,u=i.shape,l=i.shapeType,f=a.indexOf(t);if(n){if(f>-1)return;a.push(t),(t==="active"||t==="selected")&&(u==null||u.toFront())}else{if(f===-1)return;if(a.splice(f,1),t==="active"||t==="selected"){var h=this.geometry,p=h.sortZIndex,v=h.zIndexReversed,m=v?this.geometry.elements.length-this.elementIndex:this.elementIndex;p?u.setZIndex(m):u.set("zIndex",m)}}var x=o.drawShape(l,s,this.getOffscreenGroup());a.length?this.syncShapeStyle(u,x,a,null):this.syncShapeStyle(u,x,["reset"],null),x.remove(!0);var E={state:t,stateStatus:n,element:this,target:this.container};this.container.emit("statechange",E),HK(this.shape,"statechange",E)},r.prototype.clearStates=function(){var t=this,n=this.states;we(n,function(i){t.setState(i,!1)}),this.states=[]},r.prototype.hasState=function(t){return this.states.includes(t)},r.prototype.getStates=function(){return this.states},r.prototype.getData=function(){return this.data},r.prototype.getModel=function(){return this.model},r.prototype.getBBox=function(){var t=this,n=t.shape,i=t.labelShape,a={x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};return n&&(a=n.getCanvasBBox()),i&&i.forEach(function(o){var s=o.getCanvasBBox();a.x=Math.min(s.x,a.x),a.y=Math.min(s.y,a.y),a.minX=Math.min(s.minX,a.minX),a.minY=Math.min(s.minY,a.minY),a.maxX=Math.max(s.maxX,a.maxX),a.maxY=Math.max(s.maxY,a.maxY)}),a.width=a.maxX-a.minX,a.height=a.maxY-a.minY,a},r.prototype.getStatesStyle=function(){if(!this.statesStyle){var t=this,n=t.shapeType,i=t.geometry,a=t.shapeFactory,o=i.stateOption,s=a.defaultShapeType,u=a.theme[n]||a.theme[s];this.statesStyle=yn({},u,o)}return this.statesStyle},r.prototype.getStateStyle=function(t,n){var i=this.getStatesStyle(),a=Ie(i,[t,"style"],{}),o=a[n]||a;return kn(o)?o(this):o},r.prototype.getAnimateCfg=function(t){var n=this,i=this.animate;if(i){var a=i[t];return a&&Xe(Xe({},a),{callback:function(){var o;kn(a.callback)&&a.callback(),(o=n.geometry)===null||o===void 0||o.emit(U0.AFTER_DRAW_ANIMATE)}})}return null},r.prototype.drawShape=function(t,n){var i;n===void 0&&(n=!1);var a=this,o=a.shapeFactory,s=a.container,u=a.shapeType;if(this.shape=o.drawShape(u,t,s),this.shape){this.setShapeInfo(this.shape,t);var l=this.shape.cfg.name;l?ei(l)&&(this.shape.cfg.name=["element",l]):this.shape.cfg.name=["element",this.shapeFactory.geometryType];var f=n?"enter":"appear",h=this.getAnimateCfg(f);h&&((i=this.geometry)===null||i===void 0||i.emit(U0.BEFORE_DRAW_ANIMATE),Kb(this.shape,h,{coordinate:o.coordinate,toAttrs:Xe({},this.shape.attr())}))}},r.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},r.prototype.setShapeInfo=function(t,n){var i=this;if(t.cfg.origin=n,t.cfg.element=this,t.isGroup()){var a=t.get("children");a.forEach(function(o){i.setShapeInfo(o,n)})}},r.prototype.syncShapeStyle=function(t,n,i,a,o){var s=this,u;if(i===void 0&&(i=[]),o===void 0&&(o=0),!(!t||!n)){var l=t.get("clipShape"),f=n.get("clipShape");if(this.syncShapeStyle(l,f,i,a),t.isGroup())for(var h=t.get("children"),p=n.get("children"),v=0;v<h.length;v++)this.syncShapeStyle(h[v],p[v],i,a,o+v);else{if(!uh(i)&&!rs(i,["reset"])){var m=t.get("name");ar(m)&&(m=m[1]),we(i,function(E){if(n.get("name")!==v4){var A=s.getStateStyle(E,m||o);n.attr(A)}})}var x=fQ(t,n);this.animate?a?((u=this.geometry)===null||u===void 0||u.emit(U0.BEFORE_DRAW_ANIMATE),Kb(t,a,{coordinate:this.shapeFactory.coordinate,toAttrs:x,shapeModel:this.model})):uh(i)?t.attr(x):(t.stopAnimate(),t.animate(x,{duration:300})):t.attr(x)}}},r.prototype.getShapeType=function(t){var n=Ie(t,"shape");return ar(n)?n[0]:n},r}(R3),DQ={},BQ={};function Z2e(e){return DQ[e.toLowerCase()]}function mS(e,r){DQ[e.toLowerCase()]=r}function q2e(e){return BQ[e.toLowerCase()]}function mp(e,r){BQ[e.toLowerCase()]=r}var K2e={coordinate:null,defaultShapeType:null,theme:null,getShapePoints:function(e,r){var t=this.getShape(e);return t.getPoints?t.getPoints(r):this.getDefaultPoints(r)},getShape:function(e){var r=this[e]||this[this.defaultShapeType];return r.coordinate=this.coordinate,r},getDefaultPoints:function(){return[]},getDefaultStyle:function(e){return Ie(e,[this.defaultShapeType,"default","style"],{})},getMarker:function(e,r){var t=this.getShape(e);if(!t.getMarker){var n=this.defaultShapeType;t=this.getShape(n)}var i=this.theme,a=Ie(i,[e,"default"],{}),o=t.getMarker(r);return yn({},a,o)},drawShape:function(e,r,t){var n=this.getShape(e);return n.draw(r,t)}},Q2e={coordinate:null,parsePath:function(e){var r=this.coordinate,t=W3(e);return r.isPolar?t=c2e(r,t):t=l2e(r,t),t},parsePoint:function(e){var r=this.coordinate;return r.convert(e)},parsePoints:function(e){var r=this.coordinate;return e.map(function(t){return r.convert(t)})},draw:function(e,r){}},g4={};function __(e,r){var t=g_(e),n=Xe(Xe(Xe({},K2e),r),{geometryType:e});return g4[t]=n,n}function lo(e,r,t){var n=g_(e),i=g4[n],a=Xe(Xe({},Q2e),t);return i[r]=a,a}function vz(e){var r=g_(e);return g4[r]}function J2e(e,r,t){var n,i;if(t===void 0&&(t={}),!r)return[e];var a=T3(e,r),o=[];if(r.length===1&&t[r[0]]){var s=t[r[0]];try{for(var u=so(s),l=u.next();!l.done;l=u.next()){var f=l.value,h=a["_".concat(f)];h&&o.push(h)}}catch(m){n={error:m}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}else for(var p in a)if(a.hasOwnProperty(p)){var v=a[p];o.push(v)}return o}function NQ(e,r){return uS(["color","shape","size","x","y","isInCircle","data","style","defaultStyle","points","mappingData"],function(t){return!rs(e[t],r[t])})}function Dw(e){return ar(e)?e:e.split("*")}function zQ(e,r){for(var t=[],n=[],i=[],a=new Map,o=0;o<r.length;o++){var s=r[o];e[s]?n.push(s):t.push(s),a.set(s,!0)}return Object.keys(e).forEach(function(u){a.has(u)||i.push(u)}),{added:t,updated:n,removed:i}}var x_=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;n.type="base",n.attributes={},n.elements=[],n.elementsMap={},n.animateOption=!0,n.attributeOption={},n.lastElementsMap={},n.generatePoints=!1,n.beforeMappingData=null,n.adjusts={},n.idFields=[],n.hasSorted=!1,n.isCoordinateChanged=!1;var i=t.container,a=t.labelsContainer,o=t.coordinate,s=t.data,u=t.sortable,l=u===void 0?!1:u,f=t.visible,h=f===void 0?!0:f,p=t.theme,v=t.scales,m=v===void 0?{}:v,x=t.scaleDefs,E=x===void 0?{}:x,A=t.intervalPadding,L=t.dodgePadding,k=t.maxColumnWidth,R=t.minColumnWidth,D=t.columnWidthRatio,$=t.roseWidthRatio,j=t.multiplePieWidthRatio,H=t.zIndexReversed,ee=t.sortZIndex,U=t.useDeferredLabel;return n.container=i,n.labelsContainer=a,n.coordinate=o,n.data=s,n.sortable=l,n.visible=h,n.userTheme=p,n.scales=m,n.scaleDefs=E,n.intervalPadding=A,n.dodgePadding=L,n.maxColumnWidth=k,n.minColumnWidth=R,n.columnWidthRatio=D,n.roseWidthRatio=$,n.multiplePieWidthRatio=j,n.zIndexReversed=H,n.sortZIndex=ee,n.useDeferredLabel=U?typeof U=="number"?U:1/0:null,n}return r.prototype.position=function(t){var n=t;Wv(t)||(n={fields:Dw(t)});var i=Ie(n,"fields");return i.length===1&&(i.unshift("1"),nl(n,"fields",i)),nl(this.attributeOption,"position",n),this},r.prototype.color=function(t,n){return this.createAttrOption("color",t,n),this},r.prototype.shape=function(t,n){return this.createAttrOption("shape",t,n),this},r.prototype.size=function(t,n){return this.createAttrOption("size",t,n),this},r.prototype.adjust=function(t){var n=t;return(ei(t)||Wv(t))&&(n=[t]),we(n,function(i,a){xo(i)||(n[a]={type:i})}),this.adjustOption=n,this},r.prototype.style=function(t,n){if(ei(t)){var i=Dw(t);this.styleOption={fields:i,callback:n}}else{var a=t,i=a.fields,o=a.callback,s=a.cfg;i||o||s?this.styleOption=t:this.styleOption={cfg:t}}return this},r.prototype.tooltip=function(t,n){if(ei(t)){var i=Dw(t);this.tooltipOption={fields:i,callback:n}}else this.tooltipOption=t;return this},r.prototype.animate=function(t){return this.animateOption=t,this},r.prototype.label=function(t,n,i){if(ei(t)){var a={},o=Dw(t);a.fields=o,kn(n)?a.callback=n:Wv(n)&&(a.cfg=n),i&&(a.cfg=i),this.labelOption=a}else this.labelOption=t;return this},r.prototype.state=function(t){return this.stateOption=t,this},r.prototype.customInfo=function(t){return this.customOption=t,this},r.prototype.init=function(t){t===void 0&&(t={}),this.setCfg(t),this.initAttributes(),this.processData(this.data),this.adjustScale()},r.prototype.update=function(t){t===void 0&&(t={});var n=t.data,i=t.isDataChanged,a=t.isCoordinateChanged,o=this,s=o.attributeOption,u=o.lastAttributeOption;rs(s,u)?n&&(i||!rs(n,this.data))?(this.setCfg(t),this.initAttributes(),this.processData(n)):this.setCfg(t):this.init(t),this.adjustScale(),this.isCoordinateChanged=a},r.prototype.paint=function(t){var n=this;t===void 0&&(t=!1),this.animateOption&&(this.animateOption=yn({},OQ(this.type,this.coordinate),this.animateOption)),this.defaultSize=void 0,this.elementsMap={},this.elements=[];var i=this.getOffscreenGroup();i.clear();var a=this.beforeMappingData,o=this.beforeMapping(a);this.dataArray=new Array(o.length);for(var s=0;s<o.length;s++){var u=o[s];this.dataArray[s]=this.mapping(u)}if(this.updateElements(this.dataArray,t),this.lastElementsMap=this.elementsMap,this.canDoGroupAnimation(t)){var l=this.container,f=this.type,h=this.coordinate,p=Ie(this.animateOption,"appear"),v=this.getYScale(),m=h.convert({x:0,y:v.scale(this.getYMinValue())});Y2e(l,p,f,h,m)}if(this.labelOption){var x=this.useDeferredLabel,E=function(){return n.renderLabels(pp(n.dataArray),t)}.bind(this);if(typeof x=="number"){var A=typeof x=="number"&&x!==1/0?x:0;if(!window.requestIdleCallback)setTimeout(E,A);else{var L=A&&A!==1/0?{timeout:A}:void 0;window.requestIdleCallback(E,L)}}else E()}this.lastAttributeOption=Xe({},this.attributeOption),this.visible===!1&&this.changeVisible(!1)},r.prototype.clear=function(){var t=this,n=t.container,i=t.geometryLabel,a=t.offscreenGroup;n&&n.clear(),i&&i.clear(),a&&a.clear(),this.scaleDefs=void 0,this.attributes={},this.scales={},this.elementsMap={},this.lastElementsMap={},this.elements=[],this.adjusts={},this.dataArray=null,this.beforeMappingData=null,this.lastAttributeOption=void 0,this.defaultSize=void 0,this.idFields=[],this.groupScales=void 0,this.hasSorted=!1,this.isCoordinateChanged=!1},r.prototype.destroy=function(){this.clear();var t=this.container;t.remove(!0),this.offscreenGroup&&(this.offscreenGroup.remove(!0),this.offscreenGroup=null),this.geometryLabel&&(this.geometryLabel.destroy(),this.geometryLabel=null),this.theme=void 0,this.shapeFactory=void 0,e.prototype.destroy.call(this)},r.prototype.getGroupScales=function(){return this.groupScales},r.prototype.getAttribute=function(t){return this.attributes[t]},r.prototype.getXScale=function(){return this.getAttribute("position").scales[0]},r.prototype.getYScale=function(){return this.getAttribute("position").scales[1]},r.prototype.getGroupAttributes=function(){var t=[];return we(this.attributes,function(n){Vb.includes(n.type)&&t.push(n)}),t},r.prototype.getDefaultValue=function(t){var n,i=this.getAttribute(t);return i&&uh(i.scales)&&(n=i.values[0]),n},r.prototype.getAttributeValues=function(t,n){for(var i=[],a=t.scales,o=0,s=a.length;o<s;o++){var u=a[o],l=u.field;u.isIdentity?i.push(u.values):i.push(n[l])}return t.mapping.apply(t,vu([],jn(i),!1))},r.prototype.getAdjust=function(t){return this.adjusts[t]},r.prototype.getCoordinate=function(){return this.coordinate},r.prototype.getData=function(){return this.data},r.prototype.getShapeMarker=function(t,n){var i=this.getShapeFactory();return i.getMarker(t,n)},r.prototype.getElementsBy=function(t){return this.elements.filter(function(n){return t(n)})},r.prototype.getElements=function(){return this.elements},r.prototype.getElementId=function(t){t=ar(t)?t[0]:t;var n=t[Wo];if(this.idFields.length){for(var i=n[this.idFields[0]],a=1;a<this.idFields.length;a++)i+="-"+n[this.idFields[a]];return i}var o=this.type,s=this.getXScale(),u=this.getYScale(),l=s.field||"x",f=u.field||"y",h=n[f],p;s.type==="identity"?p=s.values[0]:p=n[l];var v;o==="interval"||o==="schema"?v="".concat(p):o==="line"||o==="area"||o==="path"?v=o:v="".concat(p,"-").concat(h);for(var m=this.groupScales,a=0,x=m.length;a<x;a++){var E=m[a],A=E.field;v="".concat(v,"-").concat(n[A])}var L=this.getAdjust("dodge");if(L){var k=L.dodgeBy;k&&(v="".concat(v,"-").concat(n[k]))}return this.getAdjust("jitter")&&(v="".concat(v,"-").concat(t.x,"-").concat(t.y)),v},r.prototype.getScaleFields=function(){var t=[],n=new Map,i=this,a=i.attributeOption,o=i.labelOption,s=i.tooltipOption;for(var u in a)if(a.hasOwnProperty(u)){var l=a[u];l.fields?L0(l.fields,t,n):l.values&&L0(l.values,t,n)}return o&&o.fields&&L0(o.fields,t,n),xo(s)&&s.fields&&L0(s.fields,t,n),t},r.prototype.changeVisible=function(t){e.prototype.changeVisible.call(this,t);for(var n=this.elements,i=0,a=n.length;i<a;i++){var o=n[i];o.changeVisible(t)}t?(this.container&&this.container.show(),this.labelsContainer&&this.labelsContainer.show()):(this.container&&this.container.hide(),this.labelsContainer&&this.labelsContainer.hide())},r.prototype.getFields=function(){var t=new Map,n=[];return Object.values(this.attributeOption).forEach(function(i){var a=(i==null?void 0:i.fields)||[];a.forEach(function(o){t.has(o)||n.push(o),t.set(o,!0)})},[]),n},r.prototype.getGroupFields=function(){for(var t=[],n=new Map,i=0,a=Vb.length;i<a;i++){var o=Vb[i],s=this.attributeOption[o];s&&s.fields&&L0(s.fields,t,n)}return t},r.prototype.getXYFields=function(){var t=jn(this.attributeOption.position.fields,2),n=t[0],i=t[1];return[n,i]},r.prototype.getXField=function(){return Ie(this.getXYFields(),[0])},r.prototype.getYField=function(){return Ie(this.getXYFields(),[1])},r.prototype.getShapes=function(){return this.elements.map(function(t){return t.shape})},r.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},r.prototype.sort=function(t){if(!this.hasSorted)for(var n=this.getXScale(),i=n.field,a=0;a<t.length;a++){var o=t[a];o.sort(function(s,u){return n.translate(s[Wo][i])-n.translate(u[Wo][i])})}this.hasSorted=!0},r.prototype.adjustScale=function(){var t=this.getYScale();t&&this.getAdjust("stack")&&this.updateStackRange(t,this.beforeMappingData)},r.prototype.getShapeFactory=function(){var t=this.shapeType;if(!!vz(t))return this.shapeFactory||(this.shapeFactory=Of(vz(t))),this.shapeFactory.coordinate=this.coordinate,this.shapeFactory.theme=this.theme.geometries[t]||{},this.shapeFactory},r.prototype.createShapePointsCfg=function(t){var n=this.getXScale(),i=this.getYScale(),a=this.normalizeValues(t[n.field],n),o;return i?o=this.normalizeValues(t[i.field],i):o=t.y?t.y:.1,{x:a,y:o,y0:i?i.scale(this.getYMinValue()):void 0}},r.prototype.createElement=function(t,n,i){i===void 0&&(i=!1);var a=this.container,o=this.getDrawCfg(t),s=this.getShapeFactory(),u=new FQ({shapeFactory:s,container:a,offscreenGroup:this.getOffscreenGroup(),elementIndex:n});return u.animate=this.animateOption,u.geometry=this,u.draw(o,i),u},r.prototype.getDrawCfg=function(t){var n=t[Wo],i={mappingData:t,data:n,x:t.x,y:t.y,color:t.color,size:t.size,isInCircle:this.coordinate.isPolar,customInfo:this.customOption},a=t.shape;!a&&this.getShapeFactory()&&(a=this.getShapeFactory().defaultShapeType),i.shape=a;var o=this.theme.geometries[this.shapeType];i.defaultStyle=Ie(o,[a,"default"],{}).style,!i.defaultStyle&&this.getShapeFactory()&&(i.defaultStyle=this.getShapeFactory().getDefaultStyle(o));var s=this.styleOption;return s&&(i.style=this.getStyleCfg(s,n)),this.generatePoints&&(i.points=t.points,i.nextPoints=t.nextPoints),i},r.prototype.updateElements=function(t,n){var i,a,o,s,u,l;n===void 0&&(n=!1);for(var f=new Map,h=[],p=new Map,v=0,m=0;m<t.length;m++)for(var x=t[m],E=0;E<x.length;E++){var A=x[E],L=this.getElementId(A),k=f.has(L)?"".concat(L,"-").concat(m,"-").concat(E):L;h.push(k),f.set(k,A),p.set(k,v),v++}this.elements=new Array(v);var R=zQ(this.lastElementsMap,h),D=R.added,$=R.updated,j=R.removed;try{for(var H=so(D),ee=H.next();!ee.done;ee=H.next()){var L=ee.value,A=f.get(L),m=p.get(L),U=this.createElement(A,m,n);this.elements[m]=U,this.elementsMap[L]=U,U.shape&&U.shape.set("zIndex",this.zIndexReversed?this.elements.length-m:m)}}catch(Re){i={error:Re}}finally{try{ee&&!ee.done&&(a=H.return)&&a.call(H)}finally{if(i)throw i.error}}try{for(var W=so($),Q=W.next();!Q.done;Q=W.next()){var L=Q.value,U=this.lastElementsMap[L],A=f.get(L),te=this.getDrawCfg(A),ie=U.getModel(),m=p.get(L);(this.isCoordinateChanged||NQ(te,ie))&&(U.animate=this.animateOption,U.update(te)),this.elements[m]=U,this.elementsMap[L]=U,U.shape&&U.shape.set("zIndex",this.zIndexReversed?this.elements.length-m:m)}}catch(Re){o={error:Re}}finally{try{Q&&!Q.done&&(s=W.return)&&s.call(W)}finally{if(o)throw o.error}}this.container&&this.container.sort();try{for(var ve=so(j),me=ve.next();!me.done;me=ve.next()){var L=me.value,U=this.lastElementsMap[L];U.animate=this.animateOption,U.destroy()}}catch(Re){u={error:Re}}finally{try{me&&!me.done&&(l=ve.return)&&l.call(ve)}finally{if(u)throw u.error}}},r.prototype.getLabelType=function(){var t=this,n=t.labelOption,i=t.coordinate,a=t.type,o=i.type,s=i.isTransposed,u=Ie(n,["cfg","type"]);return u||(o==="polar"?u=s?"pie":"polar":o==="theta"?u="pie":a==="interval"||a==="polygon"?u="interval":u="base"),u},r.prototype.getYMinValue=function(){var t=this.getYScale(),n=t.min,i=t.max,a;return n>=0?a=n:i<=0?a=i:a=0,a},r.prototype.createAttrOption=function(t,n,i){if(rr(n)||xo(n))xo(n)&&rs(Object.keys(n),["values"])?nl(this.attributeOption,t,{fields:n.values}):nl(this.attributeOption,t,n);else{var a={};xi(n)?a.values=[n]:a.fields=Dw(n),i&&(kn(i)?a.callback=i:a.values=i),nl(this.attributeOption,t,a)}},r.prototype.initAttributes=function(){var t=this,n=this,i=n.attributes,a=n.attributeOption,o=n.theme,s=n.shapeType;this.groupScales=[];var u={},l=function(p){if(a.hasOwnProperty(p)){var v=a[p];if(!v)return{value:void 0};var m=Xe({},v),x=m.callback,E=m.values,A=m.fields,L=A===void 0?[]:A,k=L.map(function(D){var $=t.scales[D];if(!u[D]&&Vb.includes(p)){var j=hQ($,Ie(t.scaleDefs,D),p,t.type);j==="cat"&&(t.groupScales.push($),u[D]=!0)}return $});m.scales=k,p!=="position"&&k.length===1&&k[0].type==="identity"?m.values=k[0].values:!x&&!E&&(p==="size"?m.values=o.sizes:p==="shape"?m.values=o.shapes[s]||[]:p==="color"&&(k.length?m.values=k[0].values.length<=10?o.colors10:o.colors20:m.values=o.colors10));var R=UK(p);i[p]=new R(m)}};for(var f in a){var h=l(f);if(typeof h=="object")return h.value}},r.prototype.processData=function(t){var n,i;this.hasSorted=!1;for(var a=this.getAttribute("position").scales,o=a.filter(function(j){return j.isCategory}),s=this.groupData(t),u=[],l=0,f=s.length;l<f;l++){for(var h=s[l],p=[],v=0,m=h.length;v<m;v++){var x=h[v],E={};for(var A in x)E[A]=x[A];E[Wo]=x;try{for(var L=(n=void 0,so(o)),k=L.next();!k.done;k=L.next()){var R=k.value,D=R.field;E[D]=R.translate(E[D])}}catch(j){n={error:j}}finally{try{k&&!k.done&&(i=L.return)&&i.call(L)}finally{if(n)throw n.error}}p.push(E)}u.push(p)}var $=this.adjustData(u);return this.beforeMappingData=$,$},r.prototype.adjustData=function(t){var n=this.adjustOption,i=this,a=i.intervalPadding,o=i.dodgePadding,s=i.theme,u=this.maxColumnWidth||s.maxColumnWidth,l=this.minColumnWidth||s.minColumnWidth,f=this.columnWidthRatio||s.columnWidthRatio,h=t;if(n){var p=this.getXScale(),v=this.getYScale(),m=p.field,x=v?v.field:null,E=vS(this.coordinate),A=p.values.length,L=this.getAttribute("size"),k=void 0;L&&(k=L.values[0]);for(var R=0,D=n.length;R<D;R++){var $=n[R],j=Xe({xField:m,yField:x,intervalPadding:a,dodgePadding:o,xDimensionLength:E,groupNum:A,defaultSize:k,maxColumnWidth:u,minColumnWidth:l,columnWidthRatio:f},$),H=$.type;if(H==="dodge"){var ee=[];if(p.isCategory||p.type==="identity")ee.push("x");else if(!v)ee.push("y");else throw new Error("dodge is not support linear attribute, please use category attribute!");j.adjustNames=ee,j.dodgeRatio=f}else if(H==="stack"){var U=this.coordinate;if(!v){j.height=U.getHeight();var W=this.getDefaultValue("size")||3;j.size=W}!U.isTransposed&&rr(j.reverseOrder)&&(j.reverseOrder=!0)}var Q=_K(H);j.dimValuesMap={},p&&p.values&&(j.dimValuesMap[p.field]=p.values.map(function(ie){return p.translate(ie)}));var te=new Q(j);h=te.process(h),this.adjusts[H]=te}}return h},r.prototype.groupData=function(t){for(var n=this.getGroupScales(),i=this.scaleDefs,a={},o=[],s=0;s<n.length;s++){var u=n[s],l=u.field;o.push(l),Ie(i,[l,"values"])&&(a[l]=i[l].values)}return J2e(t,o,a)},r.prototype.updateStackRange=function(t,n){for(var i=pp(n),a=t.field,o=t.min,s=t.max,u=0;u<i.length;u++){var l=i[u],f=Math.min.apply(null,l[a]),h=Math.max.apply(null,l[a]);f<o&&(o=f),h>s&&(s=h)}var p=this.scaleDefs,v={};o<t.min&&!Ie(p,[a,"min"])&&(v.min=o),s>t.max&&!Ie(p,[a,"max"])&&(v.max=s),t.change(v)},r.prototype.beforeMapping=function(t){var n=t;if(this.sortable&&this.sort(n),this.generatePoints)for(var i=0,a=n.length;i<a;i++){var o=n[i];this.generateShapePoints(o);var s=n[i+1];s&&(this.generateShapePoints(s),o[0].nextPoints=s[0].points)}return n},r.prototype.generateShapePoints=function(t){for(var n=this.getShapeFactory(),i=this.getAttribute("shape"),a=0;a<t.length;a++){var o=t[a],s=this.createShapePointsCfg(o),u=i?this.getAttributeValues(i,o):null,l=n.getShapePoints(u,s);o.points=l}},r.prototype.normalizeValues=function(t,n){var i=[];if(ar(t))for(var a=0;a<t.length;a++){var o=t[a];i.push(n.scale(o))}else i=n.scale(t);return i},r.prototype.mapping=function(t){for(var n=this.attributes,i=[],a=0;a<t.length;a++){var o=t[a],s={_origin:o[Wo],points:o.points,nextPoints:o.nextPoints};for(var u in n)if(n.hasOwnProperty(u)){var l=n[u],f=l.names,h=this.getAttributeValues(l,o);if(f.length>1)for(var p=0;p<h.length;p+=1){var v=h[p],m=f[p];s[m]=ar(v)&&v.length===1?v[0]:v}else s[f[0]]=h.length===1?h[0]:h}this.convertPoint(s),i.push(s)}return i},r.prototype.convertPoint=function(t){var n=t.x,i=t.y,a,o,s,u=this.coordinate;if(ar(n)&&ar(i)){a=[],o=[];for(var l=0,f=0,h=n.length,p=i.length;l<h&&f<p;l+=1,f+=1)s=u.convert({x:n[l],y:i[f]}),a.push(s.x),o.push(s.y)}else if(ar(i)){o=[];for(var v=0;v<i.length;v++){var m=i[v];s=u.convert({x:n,y:m}),a&&a!==s.x?(ar(a)||(a=[a]),a.push(s.x)):a=s.x,o.push(s.y)}}else if(ar(n)){a=[];for(var v=0;v<n.length;v++){var x=n[v];s=u.convert({x,y:i}),o&&o!==s.y?(ar(o)||(o=[o]),o.push(s.y)):o=s.y,a.push(s.x)}}else{var E=u.convert({x:n,y:i});a=E.x,o=E.y}t.x=a,t.y=o},r.prototype.getStyleCfg=function(t,n){var i=t.fields,a=i===void 0?[]:i,o=t.callback,s=t.cfg;if(s)return s;var u=a.map(function(l){return n[l]});return o.apply(void 0,vu([],jn(u),!1))},r.prototype.setCfg=function(t){var n=this,i=t.coordinate,a=t.data,o=t.theme,s=t.scaleDefs;i&&(this.coordinate=i),a&&(this.data=a),s&&(this.scaleDefs=s,this.idFields=[],we(s,function(u,l){u&&u.key&&n.idFields.push(l)})),o&&(this.theme=this.userTheme?yn({},o,this.userTheme):o)},r.prototype.renderLabels=function(t,n){return n===void 0&&(n=!1),tE(this,void 0,void 0,function(){var i,a,o,s,u,l,f,h,p,v,m,x,E=this;return rE(this,function(A){switch(A.label){case 0:return i=this.geometryLabel,this.emit(U0.BEFORE_RENDER_LABEL),i||(a=this.getLabelType(),o=Z2e(a),i=new o(this),this.geometryLabel=i),[4,i.render(t,n)];case 1:A.sent(),s=i.labelsRenderer.shapesMap,u=new Map,we(s,function(L,k){for(var R=L.getChildren()||[],D=0;D<R.length;D++){var $=R[D],j=E.elementsMap[$.get("elementId")||k.split(" ")[0]];if(j){$.cfg.name=["element","label"],$.cfg.element=j;var H=u.get(j)||new Set;H.add(L),u.set(j,H)}}});try{for(l=so(u.entries()),f=l.next();!f.done;f=l.next())h=jn(f.value,2),p=h[0],v=h[1],p.labelShape=vu([],jn(v),!1)}catch(L){m={error:L}}finally{try{f&&!f.done&&(x=l.return)&&x.call(l)}finally{if(m)throw m.error}}return this.emit(U0.AFTER_RENDER_LABEL),[2]}})})},r.prototype.canDoGroupAnimation=function(t){return!t&&this.animateOption&&(Ie(this.animateOption,"appear")===void 0||Ie(this.animateOption,"appear")&&Ie(this.animateOption,["appear","animation"])===void 0)},r}(R3),RI=yl;function yS(e,r,t){var n=RI(e.getMatrix(),[["t",r,t]]);e.setMatrix(n)}function ewe(e,r){var t=e.attr(),n=t.x,i=t.y,a=RI(e.getMatrix(),[["t",-n,-i],["r",r],["t",n,i]]);return a}function m4(e,r){var t=ewe(e,r);e.setMatrix(t)}function twe(e,r){var t=e.getBBox(),n=(t.minX+t.maxX)/2,i=(t.minY+t.maxY)/2;e.applyToMatrix([n,i,1]);var a=RI(e.getMatrix(),[["t",-n,-i],["s",r,r],["t",n,i]]);e.setMatrix(a)}function e_(e){return e.find(function(r){return r.get("type")==="text"})}function $Q(e,r,t){t===void 0&&(t=[0,0,0,0]);var n=e&&e.getChildren()[0];if(n){var i=n.clone();r!=null&&r.rotate&&m4(i,-r.rotate);var a=i.getCanvasBBox(),o=a.x,s=a.y,u=a.width,l=a.height;i.destroy();var f=t;return rr(f)?f=[2,2,2,2]:xi(f)&&(f=new Array(4).fill(f)),{x:o-f[3],y:s-f[0],width:u+f[1]+f[3],height:l+f[0]+f[2],rotation:(r==null?void 0:r.rotate)||0}}return{x:0,y:0,width:0,height:0,rotation:0}}function rwe(e,r,t){t===void 0&&(t=0);var n=Math.max(0,Math.min(e.x+e.width+t,r.x+r.width+t)-Math.max(e.x-t,r.x-t)),i=Math.max(0,Math.min(e.y+e.height+t,r.y+r.height+t)-Math.max(e.y-t,r.y-t));return n*i}function nwe(e,r){var t=e.getBBox();return uS(r,function(n){var i=n.getBBox();return rwe(t,i,2)>0})}function UQ(e,r,t){var n=t.data,i=t.origin,a=t.animateCfg,o=t.coordinate,s=Ie(a,"update");e.set("data",n),e.set("origin",i),e.set("animateCfg",a),e.set("coordinate",o),e.set("visible",r.get("visible")),(e.getChildren()||[]).forEach(function(u,l){var f=r.getChildByIndex(l);if(!f)e.removeChild(u),u.remove(!0);else{u.set("data",n),u.set("origin",i),u.set("animateCfg",a),u.set("coordinate",o);var h=fQ(u,f);s?Kb(u,s,{toAttrs:h,coordinate:o}):u.attr(h),f.isGroup()&&UQ(u,f,t)}}),we(r.getChildren(),function(u,l){l>=e.getCount()&&(u.destroyed||e.add(u))})}var iwe=function(){function e(r){this.shapesMap={};var t=r.layout,n=r.container;this.layout=t,this.container=n}return e.prototype.render=function(r,t,n){return n===void 0&&(n=!1),tE(this,void 0,void 0,function(){var i,a,o,s,u,l,f,h,p=this;return rE(this,function(v){switch(v.label){case 0:if(i={},a=this.createOffscreenGroup(),!r.length)return[3,2];try{for(o=so(r),s=o.next();!s.done;s=o.next())u=s.value,u&&(i[u.id]=this.renderLabel(u,a))}catch(m){f={error:m}}finally{try{s&&!s.done&&(h=o.return)&&h.call(o)}finally{if(f)throw f.error}}return[4,this.doLayout(r,t,i)];case 1:v.sent(),this.renderLabelLine(r,i),this.renderLabelBackground(r,i),this.adjustLabel(r,i),v.label=2;case 2:return l=this.shapesMap,we(i,function(m,x){if(m.destroyed)delete i[x];else{if(l[x]){var E=m.get("data"),A=m.get("origin"),L=m.get("coordinate"),k=m.get("animateCfg"),R=l[x];UQ(R,i[x],{data:E,origin:A,animateCfg:k,coordinate:L}),i[x]=R}else{if(p.container.destroyed)return;p.container.add(m);var D=Ie(m.get("animateCfg"),n?"enter":"appear");D&&Kb(m,D,{toAttrs:Xe({},m.attr()),coordinate:m.get("coordinate")})}delete l[x]}}),we(l,function(m){var x=Ie(m.get("animateCfg"),"leave");x?Kb(m,x,{toAttrs:null,coordinate:m.get("coordinate")}):m.remove(!0)}),this.shapesMap=i,a.destroy(),[2]}})})},e.prototype.clear=function(){this.container.clear(),this.shapesMap={}},e.prototype.destroy=function(){this.container.destroy(),this.shapesMap=null},e.prototype.renderLabel=function(r,t){var n=r.id,i=r.elementId,a=r.data,o=r.mappingData,s=r.coordinate,u=r.animate,l=r.content,f=r.capture,h={id:n,elementId:i,capture:f,data:a,origin:Xe(Xe({},o),{data:o[Wo]}),coordinate:s},p=t.addGroup(Xe({name:"label",animateCfg:this.animate===!1||u===null||u===!1?!1:yn({},this.animate,u)},h)),v;if(l.isGroup&&l.isGroup()||l.isShape&&l.isShape()){var m=l.getCanvasBBox(),x=m.width,E=m.height,A=Ie(r,"textAlign","left"),L=r.x,k=r.y-E/2;A==="center"?L=L-x/2:(A==="right"||A==="end")&&(L=L-x),yS(l,L,k),v=l,p.add(l)}else{var R=Ie(r,["style","fill"]);v=p.addShape("text",Xe({attrs:Xe(Xe({x:r.x,y:r.y,textAlign:r.textAlign,textBaseline:Ie(r,"textBaseline","middle"),text:r.content},r.style),{fill:iq(R)?r.color:R})},h))}return r.rotate&&m4(v,r.rotate),p},e.prototype.doLayout=function(r,t,n){return tE(this,void 0,void 0,function(){var i,a=this;return rE(this,function(o){switch(o.label){case 0:return this.layout?(i=ar(this.layout)?this.layout:[this.layout],[4,Promise.all(i.map(function(s){var u=q2e(Ie(s,"type",""));if(!!u){var l=[],f=[];return we(n,function(h,p){l.push(h),f.push(t[h.get("elementId")])}),u(r,l,f,a.region,s.cfg)}}))]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype.renderLabelLine=function(r,t){we(r,function(n){var i=Ie(n,"coordinate");if(!(!n||!i)){var a=i.getCenter(),o=i.getRadius();if(!!n.labelLine){var s=Ie(n,"labelLine",{}),u=n.id,l=s.path;if(!l){var f=il(a.x,a.y,o,n.angle);l=[["M",f.x,f.y],["L",n.x,n.y]]}var h=t[u];h.destroyed||h.addShape("path",{capture:!1,attrs:Xe({path:l,stroke:n.color?n.color:Ie(n,["style","fill"],"#000"),fill:null},s.style),id:u,origin:n.mappingData,data:n.data,coordinate:n.coordinate})}}})},e.prototype.renderLabelBackground=function(r,t){we(r,function(n){var i=Ie(n,"coordinate"),a=Ie(n,"background");if(!(!a||!i)){var o=n.id,s=t[o];if(!s.destroyed){var u=s.getChildren()[0];if(u){var l=$Q(s,n,a.padding),f=l.rotation,h=tp(l,["rotation"]),p=s.addShape("rect",{attrs:Xe(Xe({},h),a.style||{}),id:o,origin:n.mappingData,data:n.data,coordinate:n.coordinate});if(p.setZIndex(-1),f){var v=u.getMatrix();p.setMatrix(v)}}}}})},e.prototype.createOffscreenGroup=function(){var r=this.container,t=r.getGroupBase(),n=new t({});return n},e.prototype.adjustLabel=function(r,t){we(r,function(n){if(n){var i=n.id,a=t[i];if(!a.destroyed){var o=a.findAll(function(s){return s.get("type")!=="path"});we(o,function(s){s&&(n.offsetX&&s.attr("x",s.attr("x")+n.offsetX),n.offsetY&&s.attr("y",s.attr("y")+n.offsetY))})}}})},e}();function gz(e){var r=0;return we(e,function(t){r+=t}),r/e.length}var OI=function(){function e(r){this.geometry=r}return e.prototype.getLabelItems=function(r){var t=this,n=[],i=this.getLabelCfgs(r);return we(r,function(a,o){var s=i[o];if(!s||rr(a.x)||rr(a.y)){n.push(null);return}var u=ar(s.content)?s.content:[s.content];s.content=u;var l=u.length;we(u,function(f,h){if(rr(f)||f===""){n.push(null);return}var p=Xe(Xe({},s),t.getLabelPoint(s,a,h));p.textAlign||(p.textAlign=t.getLabelAlign(p,h,l)),p.offset<=0&&(p.labelLine=null),n.push(p)})}),n},e.prototype.render=function(r,t){return t===void 0&&(t=!1),tE(this,void 0,void 0,function(){var n,i,a;return rE(this,function(o){switch(o.label){case 0:return n=this.getLabelItems(r),i=this.getLabelsRenderer(),a=this.getGeometryShapes(),[4,i.render(n,a,t)];case 1:return o.sent(),[2]}})})},e.prototype.clear=function(){var r=this.labelsRenderer;r&&r.clear()},e.prototype.destroy=function(){var r=this.labelsRenderer;r&&r.destroy(),this.labelsRenderer=null},e.prototype.getCoordinate=function(){return this.geometry.coordinate},e.prototype.getDefaultLabelCfg=function(r,t){var n=this.geometry,i=n.type,a=n.theme;return i==="polygon"||i==="interval"&&t==="middle"||r<0&&!["line","point","path"].includes(i)?Ie(a,"innerLabels",{}):Ie(a,"labels",{})},e.prototype.getThemedLabelCfg=function(r){var t=this.geometry,n=this.getDefaultLabelCfg(),i=t.type,a=t.theme,o;return i==="polygon"||r.offset<0&&!["line","point","path"].includes(i)?o=yn({},n,a.innerLabels,r):o=yn({},n,a.labels,r),o},e.prototype.setLabelPosition=function(r,t,n,i){},e.prototype.getLabelOffset=function(r){var t=this.getCoordinate(),n=this.getOffsetVector(r);return t.isTransposed?n[0]:n[1]},e.prototype.getLabelOffsetPoint=function(r,t,n){var i=r.offset,a=this.getCoordinate(),o=a.isTransposed,s=o?"x":"y",u=o?1:-1,l={x:0,y:0};return t>0||n===1?l[s]=i*u:l[s]=i*u*-1,l},e.prototype.getLabelPoint=function(r,t,n){var i=this.getCoordinate(),a=r.content.length;function o(E,A,L){L===void 0&&(L=!1);var k=E;return ar(k)&&(r.content.length===1?L?k=gz(k):k.length<=2?k=k[E.length-1]:k=gz(k):k=k[A]),k}var s={content:r.content[n],x:0,y:0,start:{x:0,y:0},color:"#fff"},u=ar(t.shape)?t.shape[0]:t.shape,l=u==="funnel"||u==="pyramid";if(this.geometry.type==="polygon"){var f=Vbe(t.x,t.y);s.x=f[0],s.y=f[1]}else this.geometry.type==="interval"&&!l?(s.x=o(t.x,n,!0),s.y=o(t.y,n)):(s.x=o(t.x,n),s.y=o(t.y,n));if(l){var h=Ie(t,"nextPoints"),p=Ie(t,"points");if(h){var v=i.convert(p[1]),m=i.convert(h[1]);s.x=(v.x+m.x)/2,s.y=(v.y+m.y)/2}else if(u==="pyramid"){var v=i.convert(p[1]),m=i.convert(p[2]);s.x=(v.x+m.x)/2,s.y=(v.y+m.y)/2}}r.position&&this.setLabelPosition(s,t,n,r.position);var x=this.getLabelOffsetPoint(r,n,a);return s.start={x:s.x,y:s.y},s.x+=x.x,s.y+=x.y,s.color=t.color,s},e.prototype.getLabelAlign=function(r,t,n){var i="center",a=this.getCoordinate();if(a.isTransposed){var o=r.offset;o<0?i="right":o===0?i="center":i="left",n>1&&t===0&&(i==="right"?i="left":i==="left"&&(i="right"))}return i},e.prototype.getLabelId=function(r){var t=this.geometry,n=t.type,i=t.getXScale(),a=t.getYScale(),o=r[Wo],s=t.getElementId(r);return n==="line"||n==="area"?s+=" ".concat(o[i.field]):n==="path"&&(s+=" ".concat(o[i.field],"-").concat(o[a.field])),s},e.prototype.getLabelsRenderer=function(){var r=this.geometry,t=r.labelsContainer,n=r.labelOption,i=r.canvasRegion,a=r.animateOption,o=this.geometry.coordinate,s=this.labelsRenderer;return s||(s=new iwe({container:t,layout:Ie(n,["cfg","layout"],{type:this.defaultLayout})}),this.labelsRenderer=s),s.region=i,s.animate=a?OQ("label",o):!1,s},e.prototype.getLabelCfgs=function(r){var t=this,n=this.geometry,i=n.labelOption,a=n.scales,o=n.coordinate,s=i,u=s.fields,l=s.callback,f=s.cfg,h=u.map(function(v){return a[v]}),p=[];return we(r,function(v,m){var x=v[Wo],E=t.getLabelText(x,h),A;if(l){var L=u.map(function(j){return x[j]});if(A=l.apply(void 0,vu([],jn(L),!1)),rr(A)){p.push(null);return}}var k=Xe(Xe({id:t.getLabelId(v),elementId:t.geometry.getElementId(v),data:x,mappingData:v,coordinate:o},f),A);kn(k.position)&&(k.position=k.position(x,v,m));var R=t.getLabelOffset(k.offset||0),D=t.getDefaultLabelCfg(R,k.position);k=yn({},D,k),k.offset=t.getLabelOffset(k.offset||0);var $=k.content;kn($)?k.content=$(x,v,m):R0($)&&(k.content=E[0]),p.push(k)}),p},e.prototype.getLabelText=function(r,t){var n=[];return we(t,function(i){var a=r[i.field];ar(a)?a=a.map(function(o){return i.getText(o)}):a=i.getText(a),rr(a)||a===""?n.push(null):n.push(a)}),n},e.prototype.getOffsetVector=function(r){r===void 0&&(r=0);var t=this.getCoordinate(),n=0;return xi(r)&&(n=r),t.isTransposed?t.applyMatrix(n,0):t.applyMatrix(0,n)},e.prototype.getGeometryShapes=function(){var r=this.geometry,t={};return we(r.elementsMap,function(n,i){t[i]=n.shape}),we(r.getOffscreenGroup().getChildren(),function(n){var i=r.getElementId(n.get("origin").mappingData);t[i]=n}),t},e}();function p5(e,r,t){if(!e)return t;var n;if(e.callback&&e.callback.length>1){var i=Array(e.callback.length-1).fill("");n=e.mapping.apply(e,vu([r],jn(i),!1)).join("")}else n=e.mapping(r).join("");return n||t}var Jx={hexagon:function(e,r,t){var n=t/2*Math.sqrt(3);return[["M",e,r-t],["L",e+n,r-t/2],["L",e+n,r+t/2],["L",e,r+t],["L",e-n,r+t/2],["L",e-n,r-t/2],["Z"]]},bowtie:function(e,r,t){var n=t-1.5;return[["M",e-t,r-n],["L",e+t,r+n],["L",e+t,r-n],["L",e-t,r+n],["Z"]]},cross:function(e,r,t){return[["M",e-t,r-t],["L",e+t,r+t],["M",e+t,r-t],["L",e-t,r+t]]},tick:function(e,r,t){return[["M",e-t/2,r-t],["L",e+t/2,r-t],["M",e,r-t],["L",e,r+t],["M",e-t/2,r+t],["L",e+t/2,r+t]]},plus:function(e,r,t){return[["M",e-t,r],["L",e+t,r],["M",e,r-t],["L",e,r+t]]},hyphen:function(e,r,t){return[["M",e-t,r],["L",e+t,r]]},line:function(e,r,t){return[["M",e,r-t],["L",e,r+t]]}},awe=["line","cross","tick","plus","hyphen"];function owe(e,r){return kn(r)?r(e):yn({},e,r)}function swe(e,r){var t=e.symbol;if(ei(t)&&awe.indexOf(t)!==-1){var n=Ie(e,"style",{}),i=Ie(n,"lineWidth",1),a=n.stroke||n.fill||r;e.style=yn({},e.style,{lineWidth:i,stroke:a,fill:null})}}function VQ(e){var r=e.symbol;ei(r)&&Jx[r]&&(e.symbol=Jx[r])}function ER(e){return e.startsWith(en.LEFT)||e.startsWith(en.RIGHT)?"vertical":"horizontal"}function GQ(e,r,t,n,i){var a=t.getScale(t.type);if(a.isCategory){var o=a.field,s=r.getAttribute("color"),u=r.getAttribute("shape"),l=e.getTheme().defaultColor,f=r.coordinate.isPolar;return a.getTicks().map(function(h,p){var v,m=h.text,x=h.value,E=m,A=a.invert(x),L=e.filterFieldData(o,[(v={},v[o]=A,v)]).length===0;we(e.views,function(j){var H;j.filterFieldData(o,[(H={},H[o]=A,H)]).length||(L=!0)});var k=p5(s,A,l),R=p5(u,A,"point"),D=r.getShapeMarker(R,{color:k,isInPolar:f}),$=i;return kn($)&&($=$(E,p,Xe({name:E,value:A},yn({},n,D)))),D=yn({},n,D,ip(Xe({},$),["style"])),swe(D,k),$&&$.style&&(D.style=owe(D.style,$.style)),VQ(D),{id:A,name:E,value:A,marker:D,unchecked:L}})}return[]}function uwe(e,r,t){return t.map(function(n,i){var a=r;kn(a)&&(a=a(n.name,i,yn({},e,n)));var o=kn(n.marker)?n.marker(n.name,i,yn({},e,n)):n.marker,s=yn({},e,a,o);return VQ(s),n.marker=s,n})}function mz(e,r){var t=Ie(e,["components","legend"],{});return yn({},Ie(t,["common"],{}),yn({},Ie(t,[r],{})))}function SR(e){return e?!1:e==null||isNaN(e)}function yz(e){if(ar(e))return SR(e[1].y);var r=e.y;return ar(r)?SR(r[0]):SR(r)}function FI(e,r,t){if(r===void 0&&(r=!1),t===void 0&&(t=!0),!e.length||e.length===1&&!t)return[];if(r){for(var n=[],i=0,a=e.length;i<a;i++){var o=e[i];yz(o)||n.push(o)}return[n]}for(var s=[],u=[],i=0,a=e.length;i<a;i++){var o=e[i];yz(o)?u.length&&(u.length===1&&!t||s.push(u),u=[]):u.push(o)}return u.length&&s.push(u),s}function HQ(e){for(var r=[],t=0;t<e.length;t++){var n=e[t];if(n){var i=t===0?"M":"L";r.push([i,n.x,n.y])}}var a=e[0];return a&&(r.push(["L",a.x,a.y]),r.push(["z"])),r}function jQ(e){for(var r=e.length/2,t=[],n=[],i=0;i<e.length;i++)i<r?t.push(e[i]):n.push(e[i]);var a=HM(t,!1),o=HM(n,!1);n.length&&a.push(["L",n[0].x,n[0].y]),o.shift();var s=a.concat(o);return t.length&&s.push(["L",t[0].x,t[0].y]),s.push(["z"]),s}function Wu(e,r,t,n){n===void 0&&(n="");var i=e.style,a=i===void 0?{}:i,o=e.defaultStyle,s=e.color,u=e.size,l=Xe(Xe({},o),a);return s&&(r&&(a.stroke||(l.stroke=s)),t&&(a.fill||(l.fill=s))),n&&rr(a[n])&&!rr(u)&&(l[n]=u),l}function WQ(e){return yn({},{fill:"#CCD6EC",fillOpacity:.3},Ie(e,["background","style"]))}function y4(e){var r=e.x,t=ar(e.y)?e.y:[e.y];return t.map(function(n,i){return{x:ar(r)?r[i]:r,y:n}})}var lwe={line:function(e,r,t){return[["M",e-t,r],["L",e+t,r]]},dot:function(e,r,t){return[["M",e-t,r],["L",e+t,r]]},dash:function(e,r,t){return[["M",e-t,r],["L",e+t,r]]},smooth:function(e,r,t){return[["M",e-t,r],["A",t/2,t/2,0,1,1,e,r],["A",t/2,t/2,0,1,0,e+t,r]]},hv:function(e,r,t){return[["M",e-t-1,r-2.5],["L",e,r-2.5],["L",e,r+2.5],["L",e+t+1,r+2.5]]},vh:function(e,r,t){return[["M",e-t-1,r+2.5],["L",e,r+2.5],["L",e,r-2.5],["L",e+t+1,r-2.5]]},hvh:function(e,r,t){return[["M",e-(t+1),r+2.5],["L",e-t/2,r+2.5],["L",e-t/2,r-2.5],["L",e+t/2,r-2.5],["L",e+t/2,r+2.5],["L",e+t+1,r+2.5]]},vhv:function(e,r){return[["M",e-5,r+2.5],["L",e-5,r],["L",e,r],["L",e,r-3],["L",e,r+3],["L",e+6.5,r+3]]}};function XQ(e,r){var t=e.color;return{symbol:lwe[r],style:{lineWidth:2,r:6,stroke:t}}}function cwe(e,r,t){for(var n=e.isStack,i=e.connectNulls,a=e.isInCircle,o=e.showSinglePoint,s=Wu(e,!0,!1,"lineWidth"),u=FI(e.points,i,o),l=[],f=0,h=u.length;f<h;f++){var p=u[f];l=l.concat(YQ(p,a,n,r,t,s))}return s.path=l,s}function d5(e,r,t,n,i){if(e.length===1)return[["M",e[0].x,e[0].y-i.lineWidth/2],["L",e[0].x,e[0].y],["L",e[0].x,e[0].y+i.lineWidth/2]];var a;return t?(r&&e.length&&e.push({x:e[0].x,y:e[0].y}),a=HM(e,!1,n)):(a=gS(e,!1),r&&a.push(["Z"])),a}function fwe(e,r,t,n,i,a){var o=[],s=[];we(e,function(f){var h=y4(f);o.push(h[1]),s.push(h[0])});var u=d5(o,r,n,i,a),l=d5(s,r,n,i,a);return t?u:u.concat(l)}function YQ(e,r,t,n,i,a){if(e.length){var o=e[0];return ar(o.y)?fwe(e,r,t,n,i,a):d5(e,r,n,i,a)}return[]}__("line",{defaultShapeType:"line"});we(["line","dot","dash","smooth"],function(e){lo("line",e,{draw:function(r,t){var n=e==="smooth",i;if(n){var a=this.coordinate,o=a.start,s=a.end;i=[[o.x,s.y],[s.x,o.y]]}var u=cwe(r,n,i),l=t.addShape({type:"path",attrs:u,name:"line",capture:!n});return l},getMarker:function(r){return XQ(r,e)}})});var dp={getLegendItems:GQ,translate:yS,rotate:m4,zoom:twe,transform:RI,getAngle:pE,getSectorPath:H0,polarToCartesian:il,getDelegationObject:Qx,getTooltipItems:h4,getMappingValue:p5,getPath:YQ,getPathPoints:FI},u0={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},Go={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Bv=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],hwe=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],pwe=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],dwe=function(e){e===void 0&&(e={});var r=e.paletteQualitative10,t=r===void 0?Bv:r,n=e.paletteQualitative20,i=n===void 0?hwe:n,a=e.brandColor,o=a===void 0?t[0]:a,s={backgroundColor:"#141414",brandColor:o,subColor:"rgba(255,255,255,0.05)",paletteQualitative10:t,paletteQualitative20:i,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:pwe,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:Go[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:Go[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:u0[85],axisTickLineBorderColor:Go[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:Go[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:Go[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:Go[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:Go[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:Bv[0],legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:Go[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendSpacing:16,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:Go[45],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:Go[45],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:Go[65],legendPageNavigatorTextFontSize:12,sliderRailFillColor:Go[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:Go[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:u0[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:u0[25],annotationArcBorderColor:Go[15],annotationArcBorder:1,annotationLineBorderColor:Go[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:Go[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:Go[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:Go[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"#1f1f1f",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 2px 4px rgba(0,0,0,.5)",tooltipContainerBorderRadius:3,tooltipTextFillColor:Go[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:Go[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:u0[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:Go[65],overflowLabelFillColorDark:"#2c3542",overflowLabelFillColorLight:"#ffffff",overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:u0[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:Go[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#fff",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(255,255,255,0.65)",scrollbarThumbFillColor:"rgba(0,0,0,0.35)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.45)",pointFillColor:Bv[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:u0[100],pointBorderOpacity:1,pointActiveBorderColor:Go[100],pointSelectedBorder:2,pointSelectedBorderColor:Go[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:Bv[0],hollowPointBorderOpacity:.95,hollowPointFillColor:u0[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:Go[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:Go[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:Bv[0],lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:Bv[0],areaFillOpacity:.25,areaActiveFillColor:Bv[0],areaActiveFillOpacity:.5,areaSelectedFillColor:Bv[0],areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:Bv[0],hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:Go[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:Go[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:Bv[0],intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:Go[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:Go[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:Bv[0],hollowIntervalBorderOpacity:1,hollowIntervalFillColor:u0[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:Go[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:Go[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return Xe(Xe({},s),e)},vwe=dwe(),v5=function(e,r){return v5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},v5(e,r)};function rd(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");v5(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Hu=function(){return Hu=Object.assign||function(r){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},Hu.apply(this,arguments)};function gwe(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t}function mwe(){return window?window.devicePixelRatio:1}function ZQ(e,r,t,n){var i=e-t,a=r-n;return Math.sqrt(i*i+a*a)}function Px(e,r,t,n,i,a){return i>=e&&i<=e+t&&a>=r&&a<=r+n}function mE(e,r){return!(r.minX>e.maxX||r.maxX<e.minX||r.minY>e.maxY||r.maxY<e.minY)}function ywe(e,r){return!e||!r?e||r:{minX:Math.min(e.minX,r.minX),minY:Math.min(e.minY,r.minY),maxX:Math.max(e.maxX,r.maxX),maxY:Math.max(e.maxY,r.maxY)}}function _z(e,r){return e[0]===r[0]&&e[1]===r[1]}var _we=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,xwe=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,bwe=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,qQ=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function KQ(e,r){var t=e.match(qQ);we(t,function(n){var i=n.split(":");r.addColorStop(i[0],i[1])})}function wwe(e,r,t){var n=_we.exec(t),i=parseFloat(n[1])%360*(Math.PI/180),a=n[2],o=r.getBBox(),s,u;i>=0&&i<1/2*Math.PI?(s={x:o.minX,y:o.minY},u={x:o.maxX,y:o.maxY}):1/2*Math.PI<=i&&i<Math.PI?(s={x:o.maxX,y:o.minY},u={x:o.minX,y:o.maxY}):Math.PI<=i&&i<3/2*Math.PI?(s={x:o.maxX,y:o.maxY},u={x:o.minX,y:o.minY}):(s={x:o.minX,y:o.maxY},u={x:o.maxX,y:o.minY});var l=Math.tan(i),f=l*l,h=(u.x-s.x+l*(u.y-s.y))/(f+1)+s.x,p=l*(u.x-s.x+l*(u.y-s.y))/(f+1)+s.y,v=e.createLinearGradient(s.x,s.y,h,p);return KQ(a,v),v}function Cwe(e,r,t){var n=xwe.exec(t),i=parseFloat(n[1]),a=parseFloat(n[2]),o=parseFloat(n[3]),s=n[4];if(o===0){var u=s.match(qQ);return u[u.length-1].split(":")[1]}var l=r.getBBox(),f=l.maxX-l.minX,h=l.maxY-l.minY,p=Math.sqrt(f*f+h*h)/2,v=e.createRadialGradient(l.minX+f*i,l.minY+h*a,0,l.minX+f/2,l.minY+h/2,o*p);return KQ(s,v),v}function Ewe(e,r,t){if(r.get("patternSource")&&r.get("patternSource")===t)return r.get("pattern");var n,i,a=bwe.exec(t),o=a[1],s=a[2];function u(){n=e.createPattern(i,o),r.set("pattern",n),r.set("patternSource",t)}switch(o){case"a":o="repeat";break;case"x":o="repeat-x";break;case"y":o="repeat-y";break;case"n":o="no-repeat";break;default:o="no-repeat"}return i=new Image,s.match(/^data:/i)||(i.crossOrigin="Anonymous"),i.src=s,i.complete?u():(i.onload=u,i.src=i.src),n}function Swe(e,r,t){var n=r.getBBox();if(isNaN(n.x)||isNaN(n.y)||isNaN(n.width)||isNaN(n.height))return t;if(ei(t)){if(t[1]==="("||t[2]==="("){if(t[0]==="l")return wwe(e,r,t);if(t[0]==="r")return Cwe(e,r,t);if(t[0]==="p")return Ewe(e,r,t)}return t}if(t instanceof CanvasPattern)return t}function Awe(e){var r=0,t=0,n=0,i=0;return ar(e)?e.length===1?r=t=n=i=e[0]:e.length===2?(r=n=e[0],t=i=e[1]):e.length===3?(r=e[0],t=i=e[1],n=e[2]):(r=e[0],t=e[1],n=e[2],i=e[3]):r=t=n=i=e,[r,t,n,i]}function NA(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function g5(e,r){return NA(e)*NA(r)?(e[0]*r[0]+e[1]*r[1])/(NA(e)*NA(r)):1}function xz(e,r){return(e[0]*r[1]<e[1]*r[0]?-1:1)*Math.acos(g5(e,r))}function WM(e,r){var t=r[1],n=r[2],i=tI(rI(r[3]),Math.PI*2),a=r[4],o=r[5],s=e[0],u=e[1],l=r[6],f=r[7],h=Math.cos(i)*(s-l)/2+Math.sin(i)*(u-f)/2,p=-1*Math.sin(i)*(s-l)/2+Math.cos(i)*(u-f)/2,v=h*h/(t*t)+p*p/(n*n);v>1&&(t*=Math.sqrt(v),n*=Math.sqrt(v));var m=t*t*(p*p)+n*n*(h*h),x=m?Math.sqrt((t*t*(n*n)-m)/m):1;a===o&&(x*=-1),isNaN(x)&&(x=0);var E=n?x*t*p/n:0,A=t?x*-n*h/t:0,L=(s+l)/2+Math.cos(i)*E-Math.sin(i)*A,k=(u+f)/2+Math.sin(i)*E+Math.cos(i)*A,R=[(h-E)/t,(p-A)/n],D=[(-1*h-E)/t,(-1*p-A)/n],$=xz([1,0],R),j=xz(R,D);return g5(R,D)<=-1&&(j=Math.PI),g5(R,D)>=1&&(j=0),o===0&&j>0&&(j=j-2*Math.PI),o===1&&j<0&&(j=j+2*Math.PI),{cx:L,cy:k,rx:_z(e,[l,f])?0:t,ry:_z(e,[l,f])?0:n,startAngle:$,endAngle:$+j,xRotation:i,arcFlag:a,sweepFlag:o}}var XM=Math.sin,YM=Math.cos,_4=Math.atan2,zA=Math.PI;function QQ(e,r,t,n,i,a,o){var s=r.stroke,u=r.lineWidth,l=t-i,f=n-a,h=_4(f,l),p=new E4({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*YM(zA/6)+","+10*XM(zA/6)+" L0,0 L"+10*YM(zA/6)+",-"+10*XM(zA/6),stroke:s,lineWidth:u}});p.translate(i,a),p.rotateAtPoint(i,a,h),e.set(o?"startArrowShape":"endArrowShape",p)}function JQ(e,r,t,n,i,a,o){var s=r.startArrow,u=r.endArrow,l=r.stroke,f=r.lineWidth,h=o?s:u,p=h.d,v=h.fill,m=h.stroke,x=h.lineWidth,E=gwe(h,["d","fill","stroke","lineWidth"]),A=t-i,L=n-a,k=_4(L,A);p&&(i=i-YM(k)*p,a=a-XM(k)*p);var R=new E4({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:Hu(Hu({},E),{stroke:m||l,lineWidth:x||f,fill:v})});R.translate(i,a),R.rotateAtPoint(i,a,k),e.set(o?"startArrowShape":"endArrowShape",R)}function Gx(e,r,t,n,i){var a=_4(n-r,t-e);return{dx:YM(a)*i,dy:XM(a)*i}}function x4(e,r,t,n,i,a){typeof r.startArrow=="object"?JQ(e,r,t,n,i,a,!0):r.startArrow?QQ(e,r,t,n,i,a,!0):e.set("startArrowShape",null)}function b4(e,r,t,n,i,a){typeof r.endArrow=="object"?JQ(e,r,t,n,i,a,!1):r.endArrow?QQ(e,r,t,n,i,a,!1):e.set("startArrowShape",null)}var bz={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function g2(e,r){var t=r.attr();for(var n in t){var i=t[n],a=bz[n]?bz[n]:n;a==="matrix"&&i?e.transform(i[0],i[1],i[3],i[4],i[6],i[7]):a==="lineDash"&&e.setLineDash?ar(i)&&e.setLineDash(i):(a==="strokeStyle"||a==="fillStyle"?i=Swe(e,r,i):a==="globalAlpha"&&(i=i*e.globalAlpha),e[a]=i)}}function m5(e,r,t){for(var n=0;n<r.length;n++){var i=r[n];i.cfg.visible?i.draw(e,t):i.skipDraw()}}function Twe(e,r,t){var n=e.get("refreshElements");we(n,function(i){if(i!==e)for(var a=i.cfg.parent;a&&a!==e&&!a.cfg.refresh;)a.cfg.refresh=!0,a=a.cfg.parent}),n[0]===e?w4(r):y5(r,t)}function y5(e,r){for(var t=0;t<e.length;t++){var n=e[t];if(n.cfg.visible)if(n.cfg.hasChanged)n.cfg.refresh=!0,n.isGroup()&&w4(n.cfg.children);else if(n.cfg.refresh)n.isGroup()&&y5(n.cfg.children,r);else{var i=Mwe(n,r);n.cfg.refresh=i,i&&n.isGroup()&&y5(n.cfg.children,r)}}}function eJ(e){for(var r=0;r<e.length;r++){var t=e[r];t.cfg.hasChanged=!1,t.isGroup()&&!t.destroyed&&eJ(t.cfg.children)}}function w4(e,r){for(var t=0;t<e.length;t++){var n=e[t];n.cfg.refresh=!0,n.isGroup()&&w4(n.get("children"))}}function Mwe(e,r){var t=e.cfg.cacheCanvasBBox,n=e.cfg.isInView&&t&&mE(t,r);return n}function tJ(e,r,t,n){var i=t.path,a=t.startArrow,o=t.endArrow;if(!!i){var s=[0,0],u=[0,0],l={dx:0,dy:0};r.beginPath();for(var f=0;f<i.length;f++){var h=i[f],p=h[0];if(f===0&&a&&a.d){var v=e.getStartTangent();l=Gx(v[0][0],v[0][1],v[1][0],v[1][1],a.d)}else if(f===i.length-2&&i[f+1][0]==="Z"&&o&&o.d){var m=i[f+1];if(m[0]==="Z"){var v=e.getEndTangent();l=Gx(v[0][0],v[0][1],v[1][0],v[1][1],o.d)}}else if(f===i.length-1&&o&&o.d&&i[0]!=="Z"){var v=e.getEndTangent();l=Gx(v[0][0],v[0][1],v[1][0],v[1][1],o.d)}var x=l.dx,E=l.dy;switch(p){case"M":r.moveTo(h[1]-x,h[2]-E),u=[h[1],h[2]];break;case"L":r.lineTo(h[1]-x,h[2]-E);break;case"Q":r.quadraticCurveTo(h[1],h[2],h[3]-x,h[4]-E);break;case"C":r.bezierCurveTo(h[1],h[2],h[3],h[4],h[5]-x,h[6]-E);break;case"A":{var A=void 0;n?(A=n[f],A||(A=WM(s,h),n[f]=A)):A=WM(s,h);var L=A.cx,k=A.cy,R=A.rx,D=A.ry,$=A.startAngle,j=A.endAngle,H=A.xRotation,ee=A.sweepFlag;if(r.ellipse)r.ellipse(L,k,R,D,H,$,j,1-ee);else{var U=R>D?R:D,W=R>D?1:R/D,Q=R>D?D/R:1;r.translate(L,k),r.rotate(H),r.scale(W,Q),r.arc(0,0,U,$,j,1-ee),r.scale(1/W,1/Q),r.rotate(-H),r.translate(-L,-k)}break}case"Z":r.closePath();break}if(p==="Z")s=u;else{var te=h.length;s=[h[te-2],h[te-1]]}}}}function rJ(e,r){var t=e.get("canvas");t&&(r==="remove"&&(e._cacheCanvasBBox=e.get("cacheCanvasBBox")),e.get("hasChanged")||(e.set("hasChanged",!0),e.cfg.parent&&e.cfg.parent.get("hasChanged")||(t.refreshElement(e,r,t),t.get("autoDraw")&&t.draw())))}function Lwe(e){var r;if(e.destroyed)r=e._cacheCanvasBBox;else{var t=e.get("cacheCanvasBBox"),n=t&&!!(t.width&&t.height),i=e.getCanvasBBox(),a=i&&!!(i.width&&i.height);n&&a?r=ywe(t,i):n?r=t:a&&(r=i)}return r}function Iwe(e){if(!e.length)return null;var r=[],t=[],n=[],i=[];return we(e,function(a){var o=Lwe(a);o&&(r.push(o.minX),t.push(o.minY),n.push(o.maxX),i.push(o.maxY))}),{minX:oh(r),minY:oh(t),maxX:Ff(n),maxY:Ff(i)}}function kwe(e,r){return!e||!r||!mE(e,r)?null:{minX:Math.max(e.minX,r.minX),minY:Math.max(e.minY,r.minY),maxX:Math.min(e.maxX,r.maxX),maxY:Math.min(e.maxY,r.maxY)}}var C4=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.onCanvasChange=function(t){rJ(this,t)},r.prototype.getShapeBase=function(){return qL},r.prototype.getGroupBase=function(){return r},r.prototype._applyClip=function(t,n){n&&(t.save(),g2(t,n),n.createPath(t),t.restore(),t.clip(),n._afterDraw())},r.prototype.cacheCanvasBBox=function(){var t=this.cfg.children,n=[],i=[];we(t,function(p){var v=p.cfg.cacheCanvasBBox;v&&p.cfg.isInView&&(n.push(v.minX,v.maxX),i.push(v.minY,v.maxY))});var a=null;if(n.length){var o=oh(n),s=Ff(n),u=oh(i),l=Ff(i);a={minX:o,minY:u,x:o,y:u,maxX:s,maxY:l,width:s-o,height:l-u};var f=this.cfg.canvas;if(f){var h=f.getViewRange();this.set("isInView",mE(a,h))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",a)},r.prototype.draw=function(t,n){var i=this.cfg.children,a=n?this.cfg.refresh:!0;i.length&&a&&(t.save(),g2(t,this),this._applyClip(t,this.getClip()),m5(t,i,n),t.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},r.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},r}(hI),Pwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},r.prototype.getShapeBase=function(){return qL},r.prototype.getGroupBase=function(){return C4},r.prototype.onCanvasChange=function(t){rJ(this,t)},r.prototype.calculateBBox=function(){var t=this.get("type"),n=this.getHitLineWidth(),i=dI(t),a=i(this),o=n/2,s=a.x-o,u=a.y-o,l=a.x+a.width+o,f=a.y+a.height+o;return{x:s,minX:s,y:u,minY:u,width:a.width+n,height:a.height+n,maxX:l,maxY:f}},r.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},r.prototype.isStroke=function(){return!!this.attrs.stroke},r.prototype._applyClip=function(t,n){n&&(t.save(),g2(t,n),n.createPath(t),t.restore(),t.clip(),n._afterDraw())},r.prototype.draw=function(t,n){var i=this.cfg.clipShape;if(n){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var a=this.getCanvasBBox();if(!mE(n,a)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}t.save(),g2(t,this),this._applyClip(t,i),this.drawPath(t),t.restore(),this._afterDraw()},r.prototype.getCanvasViewBox=function(){var t=this.cfg.canvas;return t?t.getViewRange():null},r.prototype.cacheCanvasBBox=function(){var t=this.getCanvasViewBox();if(t){var n=this.getCanvasBBox(),i=mE(n,t);this.set("isInView",i),i?this.set("cacheCanvasBBox",n):this.set("cacheCanvasBBox",null)}},r.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},r.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},r.prototype.drawPath=function(t){this.createPath(t),this.strokeAndFill(t),this.afterDrawPath(t)},r.prototype.fill=function(t){t.fill()},r.prototype.stroke=function(t){t.stroke()},r.prototype.strokeAndFill=function(t){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isFill()&&(!rr(s)&&s!==1?(t.globalAlpha=s,this.fill(t),t.globalAlpha=a):this.fill(t)),this.isStroke()&&i>0&&(!rr(o)&&o!==1&&(t.globalAlpha=o),this.stroke(t)),this.afterDrawPath(t)},r.prototype.createPath=function(t){},r.prototype.afterDrawPath=function(t){},r.prototype.isInShape=function(t,n){var i=this.isStroke(),a=this.isFill(),o=this.getHitLineWidth();return this.isInStrokeOrPath(t,n,i,a,o)},r.prototype.isInStrokeOrPath=function(t,n,i,a,o){return!1},r.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var t=this.attrs;return t.lineWidth+t.lineAppendWidth},r}(pI),Jv=Pwe,Rwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{x:0,y:0,r:0})},r.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr(),u=s.x,l=s.y,f=s.r,h=o/2,p=ZQ(u,l,t,n);return a&&i?p<=f+h:a?p<=f:i?p>=f-h&&p<=f+h:!1},r.prototype.createPath=function(t){var n=this.attr(),i=n.x,a=n.y,o=n.r;t.beginPath(),t.arc(i,a,o,0,Math.PI*2,!1),t.closePath()},r}(Jv),Owe=Rwe;function $A(e,r,t,n){return e/(t*t)+r/(n*n)}var Fwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{x:0,y:0,rx:0,ry:0})},r.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr(),u=o/2,l=s.x,f=s.y,h=s.rx,p=s.ry,v=(t-l)*(t-l),m=(n-f)*(n-f);return a&&i?$A(v,m,h+u,p+u)<=1:a?$A(v,m,h,p)<=1:i?$A(v,m,h-u,p-u)>=1&&$A(v,m,h+u,p+u)<=1:!1},r.prototype.createPath=function(t){var n=this.attr(),i=n.x,a=n.y,o=n.rx,s=n.ry;if(t.beginPath(),t.ellipse)t.ellipse(i,a,o,s,0,0,Math.PI*2,!1);else{var u=o>s?o:s,l=o>s?1:o/s,f=o>s?s/o:1;t.save(),t.translate(i,a),t.scale(l,f),t.arc(0,0,u,0,Math.PI*2),t.restore(),t.closePath()}},r}(Jv),Dwe=Fwe;function wz(e){return e instanceof HTMLElement&&ei(e.nodeName)&&e.nodeName.toUpperCase()==="CANVAS"}var Bwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{x:0,y:0,width:0,height:0})},r.prototype.initAttrs=function(t){this._setImage(t.img)},r.prototype.isStroke=function(){return!1},r.prototype.isOnlyHitBox=function(){return!0},r.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var t=this.get("canvas");t?t.draw():this.createPath(this.get("context"))}},r.prototype._setImage=function(t){var n=this,i=this.attrs;if(ei(t)){var a=new Image;a.onload=function(){if(n.destroyed)return!1;n.attr("img",a),n.set("loading",!1),n._afterLoading();var o=n.get("callback");o&&o.call(n)},a.crossOrigin="Anonymous",a.src=t,this.set("loading",!0)}else t instanceof Image?(i.width||(i.width=t.width),i.height||(i.height=t.height)):wz(t)&&(i.width||(i.width=Number(t.getAttribute("width"))),i.height||(i.height,Number(t.getAttribute("height"))))},r.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),t==="img"&&this._setImage(n)},r.prototype.createPath=function(t){if(this.get("loading")){this.set("toDraw",!0),this.set("context",t);return}var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,u=n.sx,l=n.sy,f=n.swidth,h=n.sheight,p=n.img;(p instanceof Image||wz(p))&&(!rr(u)&&!rr(l)&&!rr(f)&&!rr(h)?t.drawImage(p,u,l,f,h,i,a,o,s):t.drawImage(p,i,a,o,s))},r}(Jv),Nwe=Bwe;function D0(e,r,t,n,i,a,o){var s=Math.min(e,t),u=Math.max(e,t),l=Math.min(r,n),f=Math.max(r,n),h=i/2;return a>=s-h&&a<=u+h&&o>=l-h&&o<=f+h?Mc.pointToLine(e,r,t,n,a,o)<=i/2:!1}var zwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},r.prototype.initAttrs=function(t){this.setArrow()},r.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),this.setArrow()},r.prototype.setArrow=function(){var t=this.attr(),n=t.x1,i=t.y1,a=t.x2,o=t.y2,s=t.startArrow,u=t.endArrow;s&&x4(this,t,a,o,n,i),u&&b4(this,t,n,i,a,o)},r.prototype.isInStrokeOrPath=function(t,n,i,a,o){if(!i||!o)return!1;var s=this.attr(),u=s.x1,l=s.y1,f=s.x2,h=s.y2;return D0(u,l,f,h,o,t,n)},r.prototype.createPath=function(t){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2,u=n.startArrow,l=n.endArrow,f={dx:0,dy:0},h={dx:0,dy:0};u&&u.d&&(f=Gx(i,a,o,s,n.startArrow.d)),l&&l.d&&(h=Gx(i,a,o,s,n.endArrow.d)),t.beginPath(),t.moveTo(i+f.dx,a+f.dy),t.lineTo(o-h.dx,s-h.dy)},r.prototype.afterDrawPath=function(t){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(t),i&&i.draw(t)},r.prototype.getTotalLength=function(){var t=this.attr(),n=t.x1,i=t.y1,a=t.x2,o=t.y2;return Mc.length(n,i,a,o)},r.prototype.getPoint=function(t){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2;return Mc.pointAt(i,a,o,s,t)},r}(Jv),$we=zwe,Uwe={circle:function(e,r,t){return[["M",e-t,r],["A",t,t,0,1,0,e+t,r],["A",t,t,0,1,0,e-t,r]]},square:function(e,r,t){return[["M",e-t,r-t],["L",e+t,r-t],["L",e+t,r+t],["L",e-t,r+t],["Z"]]},diamond:function(e,r,t){return[["M",e-t,r],["L",e,r-t],["L",e+t,r],["L",e,r+t],["Z"]]},triangle:function(e,r,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,r+n],["L",e,r-n],["L",e+t,r+n],["Z"]]},"triangle-down":function(e,r,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,r-n],["L",e+t,r-n],["L",e,r+n],["Z"]]}},Vwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.initAttrs=function(t){this._resetParamsCache()},r.prototype._resetParamsCache=function(){this.set("paramsCache",{})},r.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),["symbol","x","y","r","radius"].indexOf(t)!==-1&&this._resetParamsCache()},r.prototype.isOnlyHitBox=function(){return!0},r.prototype._getR=function(t){return rr(t.r)?t.radius:t.r},r.prototype._getPath=function(){var t=this.attr(),n=t.x,i=t.y,a=t.symbol||"circle",o=this._getR(t),s,u;if(kn(a))s=a,u=s(n,i,o),u=gK(u);else{if(s=r.Symbols[a],!s)return console.warn(a+" marker is not supported."),null;u=s(n,i,o)}return u},r.prototype.createPath=function(t){var n=this._getPath(),i=this.get("paramsCache");tJ(this,t,{path:n},i)},r.Symbols=Uwe,r}(Jv),Gwe=Vwe;function nJ(e,r,t){var n=gI();return e.createPath(n),n.isPointInPath(r,t)}var Hwe=1e-6;function AR(e){return Math.abs(e)<Hwe?0:e<0?-1:1}function jwe(e,r,t){return(t[0]-e[0])*(r[1]-e[1])===(r[0]-e[0])*(t[1]-e[1])&&Math.min(e[0],r[0])<=t[0]&&t[0]<=Math.max(e[0],r[0])&&Math.min(e[1],r[1])<=t[1]&&t[1]<=Math.max(e[1],r[1])}function iJ(e,r,t){var n=!1,i=e.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=e[a],s=e[(a+1)%i];if(jwe(o,s,[r,t]))return!0;AR(o[1]-t)>0!=AR(s[1]-t)>0&&AR(r-(t-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(n=!n)}return n}function xC(e,r,t,n,i,a,o,s){var u=(Math.atan2(s-r,o-e)+Math.PI*2)%(Math.PI*2);if(u<n||u>i)return!1;var l={x:e+t*Math.cos(u),y:r+t*Math.sin(u)};return ZQ(l.x,l.y,o,s)<=a/2}var Wwe=yl;function Xwe(e){for(var r=!1,t=e.length,n=0;n<t;n++){var i=e[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){r=!0;break}}return r}function Ywe(e,r,t,n,i){for(var a=!1,o=r/2,s=0;s<e.length;s++){var u=e[s],l=u.currentPoint,f=u.params,h=u.prePoint,p=u.box;if(!(p&&!Px(p.x-o,p.y-o,p.width+r,p.height+r,t,n))){switch(u.command){case"L":case"Z":a=D0(h[0],h[1],l[0],l[1],r,t,n);break;case"Q":var v=hK.pointDistance(h[0],h[1],f[1],f[2],f[3],f[4],t,n);a=v<=r/2;break;case"C":var m=RC.pointDistance(h[0],h[1],f[1],f[2],f[3],f[4],f[5],f[6],t,n,i);a=m<=r/2;break;case"A":var x=u.arcParams,E=x.cx,A=x.cy,L=x.rx,k=x.ry,R=x.startAngle,D=x.endAngle,$=x.xRotation,j=[t,n,1],H=L>k?L:k,ee=L>k?1:L/k,U=L>k?k/L:1,W=Wwe(null,[["t",-E,-A],["r",-$],["s",1/ee,1/U]]);u2(j,j,W),a=xC(0,0,H,R,D,r,j[0],j[1]);break}if(a)break}}return a}function Zwe(e){for(var r=e.length,t=[],n=[],i=[],a=0;a<r;a++){var o=e[a],s=o[0];s==="M"?(i.length&&(n.push(i),i=[]),i.push([o[1],o[2]])):s==="Z"?i.length&&(t.push(i),i=[]):i.push([o[1],o[2]])}return i.length>0&&n.push(i),{polygons:t,polylines:n}}var UA=Hu({hasArc:Xwe,extractPolygons:Zwe,isPointInStroke:Ywe},O3);function Cz(e,r,t){for(var n=!1,i=0;i<e.length;i++){var a=e[i];if(n=iJ(a,r,t),n)break}return n}var qwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{startArrow:!1,endArrow:!1})},r.prototype.initAttrs=function(t){this._setPathArr(t.path),this.setArrow()},r.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),t==="path"&&this._setPathArr(n),this.setArrow()},r.prototype._setPathArr=function(t){this.attrs.path=gK(t);var n=UA.hasArc(t);this.set("hasArc",n),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},r.prototype.getSegments=function(){var t=this.get("segements");return t||(t=mK(this.attr("path")),this.set("segments",t)),t},r.prototype.setArrow=function(){var t=this.attr(),n=t.startArrow,i=t.endArrow;if(n){var a=this.getStartTangent();x4(this,t,a[0][0],a[0][1],a[1][0],a[1][1])}if(i){var a=this.getEndTangent();b4(this,t,a[0][0],a[0][1],a[1][0],a[1][1])}},r.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.getSegments(),u=this.get("hasArc"),l=!1;if(i){var f=this.getTotalLength();l=UA.isPointInStroke(s,o,t,n,f)}if(!l&&a)if(u)l=nJ(this,t,n);else{var h=this.attr("path"),p=UA.extractPolygons(h);l=Cz(p.polygons,t,n)||Cz(p.polylines,t,n)}return l},r.prototype.createPath=function(t){var n=this.attr(),i=this.get("paramsCache");tJ(this,t,n,i)},r.prototype.afterDrawPath=function(t){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(t),i&&i.draw(t)},r.prototype.getTotalLength=function(){var t=this.get("totalLength");return rr(t)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):t},r.prototype.getPoint=function(t){var n=this.get("tCache");n||(this._calculateCurve(),this._setTcache(),n=this.get("tCache"));var i,a,o=this.get("curve");if(!n||n.length===0)return o?{x:o[0][1],y:o[0][2]}:null;we(n,function(f,h){t>=f[0]&&t<=f[1]&&(i=(t-f[0])/(f[1]-f[0]),a=h)});var s=o[a];if(rr(s)||rr(a))return null;var u=s.length,l=o[a+1];return RC.pointAt(s[u-2],s[u-1],l[1],l[2],l[3],l[4],l[5],l[6],i)},r.prototype._calculateCurve=function(){var t=this.attr().path;this.set("curve",UA.pathToCurve(t))},r.prototype._setTcache=function(){var t=0,n=0,i=[],a,o,s,u,l=this.get("curve");if(!!l){if(we(l,function(f,h){s=l[h+1],u=f.length,s&&(t+=RC.length(f[u-2],f[u-1],s[1],s[2],s[3],s[4],s[5],s[6])||0)}),this.set("totalLength",t),t===0){this.set("tCache",[]);return}we(l,function(f,h){s=l[h+1],u=f.length,s&&(a=[],a[0]=n/t,o=RC.length(f[u-2],f[u-1],s[1],s[2],s[3],s[4],s[5],s[6]),n+=o||0,a[1]=n/t,i.push(a))}),this.set("tCache",i)}},r.prototype.getStartTangent=function(){var t=this.getSegments(),n;if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([a[0],a[1]]),n.push([i[0],i[1]]))}return n},r.prototype.getEndTangent=function(){var t=this.getSegments(),n=t.length,i;if(n>1){var a=t[n-2].currentPoint,o=t[n-1].currentPoint,s=t[n-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},r}(Jv),E4=qwe;function aJ(e,r,t,n,i){var a=e.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=e[o][0],u=e[o][1],l=e[o+1][0],f=e[o+1][1];if(D0(s,u,l,f,r,t,n))return!0}if(i){var h=e[0],p=e[a-1];if(D0(h[0],h[1],p[0],p[1],r,t,n))return!0}return!1}var Kwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr().points,u=!1;return i&&(u=aJ(s,o,t,n,!0)),!u&&a&&(u=iJ(s,t,n)),u},r.prototype.createPath=function(t){var n=this.attr(),i=n.points;if(!(i.length<2)){t.beginPath();for(var a=0;a<i.length;a++){var o=i[a];a===0?t.moveTo(o[0],o[1]):t.lineTo(o[0],o[1])}t.closePath()}},r}(Jv),Qwe=Kwe,Jwe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{startArrow:!1,endArrow:!1})},r.prototype.initAttrs=function(t){this.setArrow()},r.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),this.setArrow(),["points"].indexOf(t)!==-1&&this._resetCache()},r.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},r.prototype.setArrow=function(){var t=this.attr(),n=this.attrs,i=n.points,a=n.startArrow,o=n.endArrow,s=i.length,u=i[0][0],l=i[0][1],f=i[s-1][0],h=i[s-1][1];a&&x4(this,t,i[1][0],i[1][1],u,l),o&&b4(this,t,i[s-2][0],i[s-2][1],f,h)},r.prototype.isFill=function(){return!1},r.prototype.isInStrokeOrPath=function(t,n,i,a,o){if(!i||!o)return!1;var s=this.attr().points;return aJ(s,o,t,n,!1)},r.prototype.isStroke=function(){return!0},r.prototype.createPath=function(t){var n=this.attr(),i=n.points,a=n.startArrow,o=n.endArrow,s=i.length;if(!(i.length<2)){var u=i[0][0],l=i[0][1],f=i[s-1][0],h=i[s-1][1];if(a&&a.d){var p=Gx(u,l,i[1][0],i[1][1],a.d);u+=p.dx,l+=p.dy}if(o&&o.d){var p=Gx(i[s-2][0],i[s-2][1],f,h,o.d);f-=p.dx,h-=p.dy}t.beginPath(),t.moveTo(u,l);for(var v=0;v<s-1;v++){var m=i[v];t.lineTo(m[0],m[1])}t.lineTo(f,h)}},r.prototype.afterDrawPath=function(t){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(t),i&&i.draw(t)},r.prototype.getTotalLength=function(){var t=this.attr().points,n=this.get("totalLength");return rr(n)?(this.set("totalLength",vK.length(t)),this.get("totalLength")):n},r.prototype.getPoint=function(t){var n=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var a,o;return we(i,function(s,u){t>=s[0]&&t<=s[1]&&(a=(t-s[0])/(s[1]-s[0]),o=u)}),Mc.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],a)},r.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var n=this.getTotalLength();if(!(n<=0)){var i=0,a=[],o,s;we(t,function(u,l){t[l+1]&&(o=[],o[0]=i/n,s=Mc.length(u[0],u[1],t[l+1][0],t[l+1][1]),i+=s,o[1]=i/n,a.push(o))}),this.set("tCache",a)}}},r.prototype.getStartTangent=function(){var t=this.attr().points,n=[];return n.push([t[1][0],t[1][1]]),n.push([t[0][0],t[0][1]]),n},r.prototype.getEndTangent=function(){var t=this.attr().points,n=t.length-1,i=[];return i.push([t[n-1][0],t[n-1][1]]),i.push([t[n][0],t[n][1]]),i},r}(Jv),eCe=Jwe;function tCe(e,r,t,n,i,a,o){var s=i/2;return Px(e-s,r-s,t,i,a,o)||Px(e+t-s,r-s,i,n,a,o)||Px(e+s,r+n-s,t,i,a,o)||Px(e-s,r+s,i,n,a,o)}function rCe(e,r,t,n,i,a,o,s){return D0(e+i,r,e+t-i,r,a,o,s)||D0(e+t,r+i,e+t,r+n-i,a,o,s)||D0(e+t-i,r+n,e+i,r+n,a,o,s)||D0(e,r+n-i,e,r+i,a,o,s)||xC(e+t-i,r+i,i,1.5*Math.PI,2*Math.PI,a,o,s)||xC(e+t-i,r+n-i,i,0,.5*Math.PI,a,o,s)||xC(e+i,r+n-i,i,.5*Math.PI,Math.PI,a,o,s)||xC(e+i,r+i,i,Math.PI,1.5*Math.PI,a,o,s)}var nCe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{x:0,y:0,width:0,height:0,radius:0})},r.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr(),u=s.x,l=s.y,f=s.width,h=s.height,p=s.radius;if(p){var m=!1;return i&&(m=rCe(u,l,f,h,p,o,t,n)),!m&&a&&(m=nJ(this,t,n)),m}else{var v=o/2;if(a&&i)return Px(u-v,l-v,f+v,h+v,t,n);if(a)return Px(u,l,f,h,t,n);if(i)return tCe(u,l,f,h,o,t,n)}},r.prototype.createPath=function(t){var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,u=n.radius;if(t.beginPath(),u===0)t.rect(i,a,o,s);else{var l=Awe(u),f=l[0],h=l[1],p=l[2],v=l[3];t.moveTo(i+f,a),t.lineTo(i+o-h,a),h!==0&&t.arc(i+o-h,a+h,h,-Math.PI/2,0),t.lineTo(i+o,a+s-p),p!==0&&t.arc(i+o-p,a+s-p,p,0,Math.PI/2),t.lineTo(i+v,a+s),v!==0&&t.arc(i+v,a+s-v,v,Math.PI/2,Math.PI),t.lineTo(i,a+f),f!==0&&t.arc(i+f,a+f,f,Math.PI,Math.PI*1.5),t.closePath()}},r}(Jv),iCe=nCe,aCe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return Hu(Hu({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},r.prototype.isOnlyHitBox=function(){return!0},r.prototype.initAttrs=function(t){this._assembleFont(),t.text&&this._setText(t.text)},r.prototype._assembleFont=function(){var t=this.attrs;t.font=yI(t)},r.prototype._setText=function(t){var n=null;ei(t)&&t.indexOf(`
`)!==-1&&(n=t.split(`
`)),this.set("textArr",n)},r.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),t.startsWith("font")&&this._assembleFont(),t==="text"&&this._setText(n)},r.prototype._getSpaceingY=function(){var t=this.attrs,n=t.lineHeight,i=t.fontSize*1;return n?n-i:i*.14},r.prototype._drawTextArr=function(t,n,i){var a=this.attrs,o=a.textBaseline,s=a.x,u=a.y,l=a.fontSize*1,f=this._getSpaceingY(),h=mI(a.text,a.fontSize,a.lineHeight),p;we(n,function(v,m){p=u+m*(f+l)-h+l,o==="middle"&&(p+=h-l-(h-l)/2),o==="top"&&(p+=h-l),rr(v)||(i?t.fillText(v,s,p):t.strokeText(v,s,p))})},r.prototype._drawText=function(t,n){var i=this.attr(),a=i.x,o=i.y,s=this.get("textArr");if(s)this._drawTextArr(t,s,n);else{var u=i.text;rr(u)||(n?t.fillText(u,a,o):t.strokeText(u,a,o))}},r.prototype.strokeAndFill=function(t){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isStroke()&&i>0&&(!rr(o)&&o!==1&&(t.globalAlpha=a),this.stroke(t)),this.isFill()&&(!rr(s)&&s!==1?(t.globalAlpha=s,this.fill(t),t.globalAlpha=a):this.fill(t)),this.afterDrawPath(t)},r.prototype.fill=function(t){this._drawText(t,!0)},r.prototype.stroke=function(t){this._drawText(t,!1)},r}(Jv),oCe=aCe;function sCe(e,r){if(r){var t=lI(r);return iy(t,e)}return e}function oJ(e,r,t){var n=e.getTotalMatrix();if(n){var i=sCe([r,t,1],n),a=i[0],o=i[1];return[a,o]}return[r,t]}function Ez(e,r,t){if(e.isCanvas&&e.isCanvas())return!0;if(!nE(e)||e.cfg.isInView===!1)return!1;if(e.cfg.clipShape){var n=oJ(e,r,t),i=n[0],a=n[1];if(e.isClipped(i,a))return!1}var o=e.cfg.cacheCanvasBBox||e.getCanvasBBox();return r>=o.minX&&r<=o.maxX&&t>=o.minY&&t<=o.maxY}function sJ(e,r,t){if(!Ez(e,r,t))return null;for(var n=null,i=e.getChildren(),a=i.length,o=a-1;o>=0;o--){var s=i[o];if(s.isGroup())n=sJ(s,r,t);else if(Ez(s,r,t)){var u=s,l=oJ(s,r,t),f=l[0],h=l[1];u.isInShape(f,h)&&(n=s)}if(n)break}return n}var uCe=function(e){rd(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.renderer="canvas",t.autoDraw=!0,t.localRefresh=!0,t.refreshElements=[],t.clipView=!0,t.quickHit=!1,t},r.prototype.onCanvasChange=function(t){(t==="attr"||t==="sort"||t==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},r.prototype.getShapeBase=function(){return qL},r.prototype.getGroupBase=function(){return C4},r.prototype.getPixelRatio=function(){var t=this.get("pixelRatio")||mwe();return t>=1?Math.ceil(t):1},r.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},r.prototype.createDom=function(){var t=document.createElement("canvas"),n=t.getContext("2d");return this.set("context",n),t},r.prototype.setDOMSize=function(t,n){e.prototype.setDOMSize.call(this,t,n);var i=this.get("context"),a=this.get("el"),o=this.getPixelRatio();a.width=o*t,a.height=o*n,o>1&&i.scale(o,o)},r.prototype.clear=function(){e.prototype.clear.call(this),this._clearFrame();var t=this.get("context"),n=this.get("el");t.clearRect(0,0,n.width,n.height)},r.prototype.getShape=function(t,n){var i;return this.get("quickHit")?i=sJ(this,t,n):i=e.prototype.getShape.call(this,t,n,null),i},r.prototype._getRefreshRegion=function(){var t=this.get("refreshElements"),n=this.getViewRange(),i;if(t.length&&t[0]===this)i=n;else if(i=Iwe(t),i){i.minX=Math.floor(i.minX),i.minY=Math.floor(i.minY),i.maxX=Math.ceil(i.maxX),i.maxY=Math.ceil(i.maxY),i.maxY+=1;var a=this.get("clipView");a&&(i=kwe(i,n))}return i},r.prototype.refreshElement=function(t){var n=this.get("refreshElements");n.push(t)},r.prototype._clearFrame=function(){var t=this.get("drawFrame");t&&(sq(t),this.set("drawFrame",null),this.set("refreshElements",[]))},r.prototype.draw=function(){var t=this.get("drawFrame");this.get("autoDraw")&&t||this._startDraw()},r.prototype._drawAll=function(){var t=this.get("context"),n=this.get("el"),i=this.getChildren();t.clearRect(0,0,n.width,n.height),g2(t,this),m5(t,i),this.set("refreshElements",[])},r.prototype._drawRegion=function(){var t=this.get("context"),n=this.get("refreshElements"),i=this.getChildren(),a=this._getRefreshRegion();a?(t.clearRect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),t.save(),t.beginPath(),t.rect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),t.clip(),g2(t,this),Twe(this,i,a),m5(t,i,a),t.restore()):n.length&&eJ(n),we(n,function(o){o.get("hasChanged")&&o.set("hasChanged",!1)}),this.set("refreshElements",[])},r.prototype._startDraw=function(){var t=this,n=this.get("drawFrame");n||(n=oq(function(){t.get("localRefresh")?t._drawRegion():t._drawAll(),t.set("drawFrame",null)}),this.set("drawFrame",n))},r.prototype.skipDraw=function(){},r.prototype.removeDom=function(){var t=this.get("el");t.width=0,t.height=0,t.parentNode.removeChild(t)},r}(fI),lCe="0.5.12",cCe=Object.freeze(Object.defineProperty({__proto__:null,Shape:qL,version:lCe,Canvas:uCe,Group:C4,getArcParams:WM,Event:fS,Base:aI,AbstractCanvas:fI,AbstractGroup:hI,AbstractShape:pI,getBBoxMethod:dI,registerBBox:qd,getTextHeight:mI,assembleFont:yI,isAllowCapture:nE,multiplyVec2:iy,invert:lI,getOffScreenContext:gI,registerEasing:oK,PathUtil:O3},Symbol.toStringTag,{value:"Module"})),_5=function(e,r){return _5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},_5(e,r)};function yp(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");_5(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var sl=function(){return sl=Object.assign||function(r){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},sl.apply(this,arguments)},x5={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},eo={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"};function Hd(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function uJ(e){var r=x5[e.type],t=e.getParent();if(!r)throw new Error("the type "+e.type+" is not supported by svg");var n=Hd(r);if(e.get("id")&&(n.id=e.get("id")),e.set("el",n),e.set("attrs",{}),t){var i=t.get("el");i||(i=t.createDom(),t.set("el",i)),i.appendChild(n)}return n}function lJ(e,r){var t=e.get("el"),n=cq(t.children).sort(r),i=document.createDocumentFragment();n.forEach(function(a){i.appendChild(a)}),t.appendChild(i)}function fCe(e,r){var t=e.parentNode,n=Array.from(t.childNodes).filter(function(s){return s.nodeType===1&&s.nodeName.toLowerCase()!=="defs"}),i=n[r],a=n.indexOf(e);if(i){if(a>r)t.insertBefore(e,i);else if(a<r){var o=n[r+1];o?t.insertBefore(e,o):t.appendChild(e)}}else t.appendChild(e)}function hCe(e,r){var t=e.cfg.el,n=e.attr(),i={dx:n.shadowOffsetX,dy:n.shadowOffsetY,blur:n.shadowBlur,color:n.shadowColor};if(!i.dx&&!i.dy&&!i.blur&&!i.color)t.removeAttribute("filter");else{var a=r.find("filter",i);a||(a=r.addShadow(i)),t.setAttribute("filter","url(#"+a+")")}}function _S(e){var r=e.attr().matrix;if(r){for(var t=e.cfg.el,n=[],i=0;i<9;i+=3)n.push(r[i]+","+r[i+1]);n=n.join(","),n.indexOf("NaN")===-1?t.setAttribute("transform","matrix("+n+")"):console.warn("invalid matrix:",r)}}function yE(e,r){var t=e.getClip(),n=e.get("el");if(!t)n.removeAttribute("clip-path");else if(t&&!n.hasAttribute("clip-path")){uJ(t),t.createPath(r);var i=r.addClip(t);n.setAttribute("clip-path","url(#"+i+")")}}function cJ(e,r){r.forEach(function(t){t.draw(e)})}function fJ(e,r){var t=e.get("canvas");if(t&&t.get("autoDraw")){var n=t.get("context"),i=e.getParent(),a=i?i.getChildren():[t],o=e.get("el");if(r==="remove"){var s=e.get("isClipShape");if(s){var u=o&&o.parentNode,l=u&&u.parentNode;u&&l&&l.removeChild(u)}else o&&o.parentNode&&o.parentNode.removeChild(o)}else if(r==="show")o.setAttribute("visibility","visible");else if(r==="hide")o.setAttribute("visibility","hidden");else if(r==="zIndex")fCe(o,a.indexOf(e));else if(r==="sort"){var f=e.get("children");f&&f.length&&lJ(e,function(h,p){return f.indexOf(h)-f.indexOf(p)?1:0})}else r==="clear"?o&&(o.innerHTML=""):r==="matrix"?_S(e):r==="clip"?yE(e,n):r==="attr"||r==="add"&&e.draw(n)}}var S4=function(e){yp(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.isEntityGroup=function(){return!0},r.prototype.createDom=function(){var t=Hd("g");this.set("el",t);var n=this.getParent();if(n){var i=n.get("el");i||(i=n.createDom(),n.set("el",i)),i.appendChild(t)}return t},r.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.createPath(i,t)}},r.prototype.onCanvasChange=function(t){fJ(this,t)},r.prototype.getShapeBase=function(){return KL},r.prototype.getGroupBase=function(){return r},r.prototype.draw=function(t){var n=this.getChildren(),i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||this.createDom(),yE(this,t),this.createPath(t),n.length&&cJ(t,n))},r.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");we(n||i,function(o,s){eo[s]&&a.setAttribute(eo[s],o)}),_S(this)},r}(hI),pCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="svg",t.canFill=!1,t.canStroke=!1,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},r.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.draw(i,t)}},r.prototype.getShapeBase=function(){return KL},r.prototype.getGroupBase=function(){return S4},r.prototype.onCanvasChange=function(t){fJ(this,t)},r.prototype.calculateBBox=function(){var t=this.get("el"),n=null;if(t)n=t.getBBox();else{var i=dI(this.get("type"));i&&(n=i(this))}if(n){var a=n.x,o=n.y,s=n.width,u=n.height,l=this.getHitLineWidth(),f=l/2,h=a-f,p=o-f,v=a+s+f,m=o+u+f;return{x:h,y:p,minX:h,minY:p,maxX:v,maxY:m,width:s+l,height:u+l}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},r.prototype.isFill=function(){var t=this.attr(),n=t.fill,i=t.fillStyle;return(n||i||this.isClipShape())&&this.canFill},r.prototype.isStroke=function(){var t=this.attr(),n=t.stroke,i=t.strokeStyle;return(n||i)&&this.canStroke},r.prototype.draw=function(t,n){var i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||uJ(this),yE(this,t),this.createPath(t,n),this.shadow(t,n),this.strokeAndFill(t,n),this.transform(n))},r.prototype.createPath=function(t,n){},r.prototype.strokeAndFill=function(t,n){var i=n||this.attr(),a=i.fill,o=i.fillStyle,s=i.stroke,u=i.strokeStyle,l=i.fillOpacity,f=i.strokeOpacity,h=i.lineWidth,p=this.get("el");this.canFill&&(n?"fill"in i?this._setColor(t,"fill",a):"fillStyle"in i&&this._setColor(t,"fill",o):this._setColor(t,"fill",a||o),l&&p.setAttribute(eo.fillOpacity,l)),this.canStroke&&h>0&&(n?"stroke"in i?this._setColor(t,"stroke",s):"strokeStyle"in i&&this._setColor(t,"stroke",u):this._setColor(t,"stroke",s||u),f&&p.setAttribute(eo.strokeOpacity,f),h&&p.setAttribute(eo.lineWidth,h))},r.prototype._setColor=function(t,n,i){var a=this.get("el");if(!i){a.setAttribute(eo[n],"none");return}if(i=i.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(i)){var o=t.find("gradient",i);o||(o=t.addGradient(i)),a.setAttribute(eo[n],"url(#"+o+")")}else if(/^[p,P]{1}[\s]*\(/.test(i)){var o=t.find("pattern",i);o||(o=t.addPattern(i)),a.setAttribute(eo[n],"url(#"+o+")")}else a.setAttribute(eo[n],i)},r.prototype.shadow=function(t,n){var i=this.attr(),a=n||i,o=a.shadowOffsetX,s=a.shadowOffsetY,u=a.shadowBlur,l=a.shadowColor;(o||s||u||l)&&hCe(this,t)},r.prototype.transform=function(t){var n=this.attr(),i=(t||n).matrix;i&&_S(this)},r.prototype.isInShape=function(t,n){return this.isPointInPath(t,n)},r.prototype.isPointInPath=function(t,n){var i=this.get("el"),a=this.get("canvas"),o=a.get("el").getBoundingClientRect(),s=t+o.left,u=n+o.top,l=document.elementFromPoint(s,u);return!!(l&&l.isEqualNode(i))},r.prototype.getHitLineWidth=function(){var t=this.attrs,n=t.lineWidth,i=t.lineAppendWidth;return this.isStroke()?n+i:0},r}(pI),Kd=pCe,dCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="circle",t.canFill=!0,t.canStroke=!0,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{x:0,y:0,r:0})},r.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");we(n||i,function(o,s){s==="x"||s==="y"?a.setAttribute("c"+s,o):eo[s]&&a.setAttribute(eo[s],o)})},r}(Kd),vCe=dCe,gCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="dom",t.canFill=!1,t.canStroke=!1,t}return r.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");if(we(n||i,function(l,f){eo[f]&&a.setAttribute(eo[f],l)}),typeof i.html=="function"){var o=i.html.call(this,i);if(o instanceof Element||o instanceof HTMLDocument){for(var s=a.childNodes,u=s.length-1;u>=0;u--)a.removeChild(s[u]);a.appendChild(o)}else a.innerHTML=o}else a.innerHTML=i.html},r}(Kd),mCe=gCe,yCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="ellipse",t.canFill=!0,t.canStroke=!0,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{x:0,y:0,rx:0,ry:0})},r.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");we(n||i,function(o,s){s==="x"||s==="y"?a.setAttribute("c"+s,o):eo[s]&&a.setAttribute(eo[s],o)})},r}(Kd),_Ce=yCe,xCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="image",t.canFill=!1,t.canStroke=!1,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{x:0,y:0,width:0,height:0})},r.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el");we(n||a,function(s,u){u==="img"?i._setImage(a.img):eo[u]&&o.setAttribute(eo[u],s)})},r.prototype.setAttr=function(t,n){this.attrs[t]=n,t==="img"&&this._setImage(n)},r.prototype._setImage=function(t){var n=this.attr(),i=this.get("el");if(ei(t))i.setAttribute("href",t);else if(t instanceof window.Image)n.width||(i.setAttribute("width",t.width),this.attr("width",t.width)),n.height||(i.setAttribute("height",t.height),this.attr("height",t.height)),i.setAttribute("href",t.src);else if(t instanceof HTMLElement&&ei(t.nodeName)&&t.nodeName.toUpperCase()==="CANVAS")i.setAttribute("href",t.toDataURL());else if(t instanceof ImageData){var a=document.createElement("canvas");a.setAttribute("width",""+t.width),a.setAttribute("height",""+t.height),a.getContext("2d").putImageData(t,0,0),n.width||(i.setAttribute("width",""+t.width),this.attr("width",t.width)),n.height||(i.setAttribute("height",""+t.height),this.attr("height",t.height)),i.setAttribute("href",a.toDataURL())}},r}(Kd),bCe=xCe,wCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="line",t.canFill=!1,t.canStroke=!0,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},r.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");we(n||i,function(o,s){if(s==="startArrow"||s==="endArrow")if(o){var u=xo(o)?t.addArrow(i,eo[s]):t.getDefaultArrow(i,eo[s]);a.setAttribute(eo[s],"url(#"+u+")")}else a.removeAttribute(eo[s]);else eo[s]&&a.setAttribute(eo[s],o)})},r.prototype.getTotalLength=function(){var t=this.attr(),n=t.x1,i=t.y1,a=t.x2,o=t.y2;return Mc.length(n,i,a,o)},r.prototype.getPoint=function(t){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2;return Mc.pointAt(i,a,o,s,t)},r}(Kd),CCe=wCe,VA={circle:function(e,r,t){return[["M",e,r],["m",-t,0],["a",t,t,0,1,0,t*2,0],["a",t,t,0,1,0,-t*2,0]]},square:function(e,r,t){return[["M",e-t,r-t],["L",e+t,r-t],["L",e+t,r+t],["L",e-t,r+t],["Z"]]},diamond:function(e,r,t){return[["M",e-t,r],["L",e,r-t],["L",e+t,r],["L",e,r+t],["Z"]]},triangle:function(e,r,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,r+n],["L",e,r-n],["L",e+t,r+n],["z"]]},triangleDown:function(e,r,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,r-n],["L",e+t,r-n],["L",e,r+n],["Z"]]}},Sz={get:function(e){return VA[e]},register:function(e,r){VA[e]=r},remove:function(e){delete VA[e]},getAll:function(){return VA}},ECe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="marker",t.canFill=!0,t.canStroke=!0,t}return r.prototype.createPath=function(t){var n=this.get("el");n.setAttribute("d",this._assembleMarker())},r.prototype._assembleMarker=function(){var t=this._getPath();return ar(t)?t.map(function(n){return n.join(" ")}).join(""):t},r.prototype._getPath=function(){var t=this.attr(),n=t.x,i=t.y,a=t.r||t.radius,o=t.symbol||"circle",s;return kn(o)?s=o:s=Sz.get(o),s?s(n,i,a):(console.warn(s+" symbol is not exist."),null)},r.symbolsFactory=Sz,r}(Kd),SCe=ECe,ACe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="path",t.canFill=!0,t.canStroke=!0,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{startArrow:!1,endArrow:!1})},r.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el");we(n||a,function(s,u){if(u==="path"&&ar(s))o.setAttribute("d",i._formatPath(s));else if(u==="startArrow"||u==="endArrow")if(s){var l=xo(s)?t.addArrow(a,eo[u]):t.getDefaultArrow(a,eo[u]);o.setAttribute(eo[u],"url(#"+l+")")}else o.removeAttribute(eo[u]);else eo[u]&&o.setAttribute(eo[u],s)})},r.prototype._formatPath=function(t){var n=t.map(function(i){return i.join(" ")}).join("");return~n.indexOf("NaN")?"":n},r.prototype.getTotalLength=function(){var t=this.get("el");return t?t.getTotalLength():null},r.prototype.getPoint=function(t){var n=this.get("el"),i=this.getTotalLength();if(i===0)return null;var a=n?n.getPointAtLength(t*i):null;return a?{x:a.x,y:a.y}:null},r}(Kd),TCe=ACe,MCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="polygon",t.canFill=!0,t.canStroke=!0,t}return r.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");we(n||i,function(o,s){s==="points"&&ar(o)&&o.length>=2?a.setAttribute("points",o.map(function(u){return u[0]+","+u[1]}).join(" ")):eo[s]&&a.setAttribute(eo[s],o)})},r}(Kd),LCe=MCe,ICe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="polyline",t.canFill=!0,t.canStroke=!0,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{startArrow:!1,endArrow:!1})},r.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),["points"].indexOf(t)!==-1&&this._resetCache()},r.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},r.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");we(n||i,function(o,s){s==="points"&&ar(o)&&o.length>=2?a.setAttribute("points",o.map(function(u){return u[0]+","+u[1]}).join(" ")):eo[s]&&a.setAttribute(eo[s],o)})},r.prototype.getTotalLength=function(){var t=this.attr().points,n=this.get("totalLength");return rr(n)?(this.set("totalLength",vK.length(t)),this.get("totalLength")):n},r.prototype.getPoint=function(t){var n=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var a,o;return we(i,function(s,u){t>=s[0]&&t<=s[1]&&(a=(t-s[0])/(s[1]-s[0]),o=u)}),Mc.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],a)},r.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var n=this.getTotalLength();if(!(n<=0)){var i=0,a=[],o,s;we(t,function(u,l){t[l+1]&&(o=[],o[0]=i/n,s=Mc.length(u[0],u[1],t[l+1][0],t[l+1][1]),i+=s,o[1]=i/n,a.push(o))}),this.set("tCache",a)}}},r.prototype.getStartTangent=function(){var t=this.attr().points,n=[];return n.push([t[1][0],t[1][1]]),n.push([t[0][0],t[0][1]]),n},r.prototype.getEndTangent=function(){var t=this.attr().points,n=t.length-1,i=[];return i.push([t[n-1][0],t[n-1][1]]),i.push([t[n][0],t[n][1]]),i},r}(Kd),kCe=ICe;function PCe(e){var r=0,t=0,n=0,i=0;return ar(e)?e.length===1?r=t=n=i=e[0]:e.length===2?(r=n=e[0],t=i=e[1]):e.length===3?(r=e[0],t=i=e[1],n=e[2]):(r=e[0],t=e[1],n=e[2],i=e[3]):r=t=n=i=e,{r1:r,r2:t,r3:n,r4:i}}var RCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="rect",t.canFill=!0,t.canStroke=!0,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{x:0,y:0,width:0,height:0,radius:0})},r.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el"),s=!1,u=["x","y","width","height","radius"];we(n||a,function(l,f){u.indexOf(f)!==-1&&!s?(o.setAttribute("d",i._assembleRect(a)),s=!0):u.indexOf(f)===-1&&eo[f]&&o.setAttribute(eo[f],l)})},r.prototype._assembleRect=function(t){var n=t.x,i=t.y,a=t.width,o=t.height,s=t.radius;if(!s)return"M "+n+","+i+" l "+a+",0 l 0,"+o+" l"+-a+" 0 z";var u=PCe(s);ar(s)?s.length===1?u.r1=u.r2=u.r3=u.r4=s[0]:s.length===2?(u.r1=u.r3=s[0],u.r2=u.r4=s[1]):s.length===3?(u.r1=s[0],u.r2=u.r4=s[1],u.r3=s[2]):(u.r1=s[0],u.r2=s[1],u.r3=s[2],u.r4=s[3]):u.r1=u.r2=u.r3=u.r4=s;var l=[["M "+(n+u.r1)+","+i],["l "+(a-u.r1-u.r2)+",0"],["a "+u.r2+","+u.r2+",0,0,1,"+u.r2+","+u.r2],["l 0,"+(o-u.r2-u.r3)],["a "+u.r3+","+u.r3+",0,0,1,"+-u.r3+","+u.r3],["l "+(u.r3+u.r4-a)+",0"],["a "+u.r4+","+u.r4+",0,0,1,"+-u.r4+","+-u.r4],["l 0,"+(u.r4+u.r1-o)],["a "+u.r1+","+u.r1+",0,0,1,"+u.r1+","+-u.r1],["z"]];return l.join(" ")},r}(Kd),OCe=RCe,Az=.3,FCe={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},DCe={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},BCe={left:"left",start:"left",center:"middle",right:"end",end:"end"},NCe=function(e){yp(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="text",t.canFill=!0,t.canStroke=!0,t}return r.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return sl(sl({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},r.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el");this._setFont(),we(n||a,function(s,u){u==="text"?i._setText(""+s):u==="matrix"&&s?_S(i):eo[u]&&o.setAttribute(eo[u],s)}),o.setAttribute("paint-order","stroke"),o.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},r.prototype._setFont=function(){var t=this.get("el"),n=this.attr(),i=n.textBaseline,a=n.textAlign,o=Cq();o&&o.name==="firefox"?t.setAttribute("dominant-baseline",DCe[i]||"alphabetic"):t.setAttribute("alignment-baseline",FCe[i]||"baseline"),t.setAttribute("text-anchor",BCe[a]||"left")},r.prototype._setText=function(t){var n=this.get("el"),i=this.attr(),a=i.x,o=i.textBaseline,s=o===void 0?"bottom":o;if(!t)n.innerHTML="";else if(~t.indexOf(`
`)){var u=t.split(`
`),l=u.length-1,f="";we(u,function(h,p){p===0?s==="alphabetic"?f+='<tspan x="'+a+'" dy="'+-l+'em">'+h+"</tspan>":s==="top"?f+='<tspan x="'+a+'" dy="0.9em">'+h+"</tspan>":s==="middle"?f+='<tspan x="'+a+'" dy="'+-(l-1)/2+'em">'+h+"</tspan>":s==="bottom"?f+='<tspan x="'+a+'" dy="-'+(l+Az)+'em">'+h+"</tspan>":s==="hanging"&&(f+='<tspan x="'+a+'" dy="'+(-(l-1)-Az)+'em">'+h+"</tspan>"):f+='<tspan x="'+a+'" dy="1em">'+h+"</tspan>"}),n.innerHTML=f}else n.innerHTML=t},r}(Kd),zCe=NCe,$Ce=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,UCe=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,VCe=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function hJ(e){var r=e.match(VCe);if(!r)return"";var t="";return r.sort(function(n,i){return n=n.split(":"),i=i.split(":"),Number(n[0])-Number(i[0])}),we(r,function(n){n=n.split(":"),t+='<stop offset="'+n[0]+'" stop-color="'+n[1]+'"></stop>'}),t}function GCe(e,r){var t=$Ce.exec(e),n=tI(rI(parseFloat(t[1])),Math.PI*2),i=t[2],a,o;n>=0&&n<.5*Math.PI?(a={x:0,y:0},o={x:1,y:1}):.5*Math.PI<=n&&n<Math.PI?(a={x:1,y:0},o={x:0,y:1}):Math.PI<=n&&n<1.5*Math.PI?(a={x:1,y:1},o={x:0,y:0}):(a={x:0,y:1},o={x:1,y:0});var s=Math.tan(n),u=s*s,l=(o.x-a.x+s*(o.y-a.y))/(u+1)+a.x,f=s*(o.x-a.x+s*(o.y-a.y))/(u+1)+a.y;r.setAttribute("x1",a.x),r.setAttribute("y1",a.y),r.setAttribute("x2",l),r.setAttribute("y2",f),r.innerHTML=hJ(i)}function HCe(e,r){var t=UCe.exec(e),n=parseFloat(t[1]),i=parseFloat(t[2]),a=parseFloat(t[3]),o=t[4];r.setAttribute("cx",n),r.setAttribute("cy",i),r.setAttribute("r",a),r.innerHTML=hJ(o)}var jCe=function(){function e(r){this.cfg={};var t=null,n=Iy("gradient_");return r.toLowerCase()[0]==="l"?(t=Hd("linearGradient"),GCe(r,t)):(t=Hd("radialGradient"),HCe(r,t)),t.setAttribute("id",n),this.el=t,this.id=n,this.cfg=r,this}return e.prototype.match=function(r,t){return this.cfg===t},e}(),WCe={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},XCe={x:"-40%",y:"-40%",width:"200%",height:"200%"},YCe=function(){function e(r){this.type="filter",this.cfg={},this.type="filter";var t=Hd("filter");return we(XCe,function(n,i){t.setAttribute(i,n)}),this.el=t,this.id=Iy("filter_"),this.el.id=this.id,this.cfg=r,this._parseShadow(r,t),this}return e.prototype.match=function(r,t){if(this.type!==r)return!1;var n=!0,i=this.cfg;return we(Object.keys(i),function(a){if(i[a]!==t[a])return n=!1,!1}),n},e.prototype.update=function(r,t){var n=this.cfg;return n[WCe[r]]=t,this._parseShadow(n,this.el),this},e.prototype._parseShadow=function(r,t){var n=`<feDropShadow
      dx="`+(r.dx||0)+`"
      dy="`+(r.dy||0)+`"
      stdDeviation="`+(r.blur?r.blur/10:0)+`"
      flood-color="`+(r.color?r.color:"#000")+`"
      flood-opacity="`+(r.opacity?r.opacity:1)+`"
      />`;t.innerHTML=n},e}(),Tz=function(){function e(r,t){this.cfg={};var n=Hd("marker"),i=Iy("marker_");n.setAttribute("id",i);var a=Hd("path");a.setAttribute("stroke",r.stroke||"none"),a.setAttribute("fill",r.fill||"none"),n.appendChild(a),n.setAttribute("overflow","visible"),n.setAttribute("orient","auto-start-reverse"),this.el=n,this.child=a,this.id=i;var o=r[t==="marker-start"?"startArrow":"endArrow"];return this.stroke=r.stroke||"#000",o===!0?this._setDefaultPath(t,a):(this.cfg=o,this._setMarker(r.lineWidth,a)),this}return e.prototype.match=function(){return!1},e.prototype._setDefaultPath=function(r,t){var n=this.el;t.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),n.setAttribute("refX",""+10*Math.cos(Math.PI/6)),n.setAttribute("refY",""+5)},e.prototype._setMarker=function(r,t){var n=this.el,i=this.cfg.path,a=this.cfg.d;ar(i)&&(i=i.map(function(o){return o.join(" ")}).join("")),t.setAttribute("d",i),n.appendChild(t),a&&n.setAttribute("refX",""+a/r)},e.prototype.update=function(r){var t=this.child;t.attr?t.attr("fill",r):t.setAttribute("fill",r)},e}(),ZCe=function(){function e(r){this.type="clip",this.cfg={};var t=Hd("clipPath");this.el=t,this.id=Iy("clip_"),t.id=this.id;var n=r.cfg.el;return t.appendChild(n),this.cfg=r,this}return e.prototype.match=function(){return!1},e.prototype.remove=function(){var r=this.el;r.parentNode.removeChild(r)},e}(),qCe=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,KCe=function(){function e(r){this.cfg={};var t=Hd("pattern");t.setAttribute("patternUnits","userSpaceOnUse");var n=Hd("image");t.appendChild(n);var i=Iy("pattern_");t.id=i,this.el=t,this.id=i,this.cfg=r;var a=qCe.exec(r),o=a[2];n.setAttribute("href",o);var s=new Image;o.match(/^data:/i)||(s.crossOrigin="Anonymous"),s.src=o;function u(){t.setAttribute("width",""+s.width),t.setAttribute("height",""+s.height)}return s.complete?u():(s.onload=u,s.src=s.src),this}return e.prototype.match=function(r,t){return this.cfg===t},e}(),QCe=function(){function e(r){var t=Hd("defs"),n=Iy("defs_");t.id=n,r.appendChild(t),this.children=[],this.defaultArrow={},this.el=t,this.canvas=r}return e.prototype.find=function(r,t){for(var n=this.children,i=null,a=0;a<n.length;a++)if(n[a].match(r,t)){i=n[a].id;break}return i},e.prototype.findById=function(r){for(var t=this.children,n=null,i=0;i<t.length;i++)if(t[i].id===r){n=t[i];break}return n},e.prototype.add=function(r){this.children.push(r),r.canvas=this.canvas,r.parent=this},e.prototype.getDefaultArrow=function(r,t){var n=r.stroke||r.strokeStyle;if(this.defaultArrow[n])return this.defaultArrow[n].id;var i=new Tz(r,t);return this.defaultArrow[n]=i,this.el.appendChild(i.el),this.add(i),i.id},e.prototype.addGradient=function(r){var t=new jCe(r);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addArrow=function(r,t){var n=new Tz(r,t);return this.el.appendChild(n.el),this.add(n),n.id},e.prototype.addShadow=function(r){var t=new YCe(r);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addPattern=function(r){var t=new KCe(r);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addClip=function(r){var t=new ZCe(r);return this.el.appendChild(t.el),this.add(t),t.id},e}(),JCe=function(e){yp(r,e);function r(t){return e.call(this,sl(sl({},t),{autoDraw:!0,renderer:"svg"}))||this}return r.prototype.getShapeBase=function(){return KL},r.prototype.getGroupBase=function(){return S4},r.prototype.getShape=function(t,n,i){var a=i.target||i.srcElement;if(!x5[a.tagName]){for(var o=a.parentNode;o&&!x5[o.tagName];)o=o.parentNode;a=o}return this.find(function(s){return s.get("el")===a})},r.prototype.createDom=function(){var t=Hd("svg"),n=new QCe(t);return t.setAttribute("width",""+this.get("width")),t.setAttribute("height",""+this.get("height")),this.set("context",n),t},r.prototype.onCanvasChange=function(t){var n=this.get("context"),i=this.get("el");if(t==="sort"){var a=this.get("children");a&&a.length&&lJ(this,function(s,u){return a.indexOf(s)-a.indexOf(u)?1:0})}else if(t==="clear"){if(i){i.innerHTML="";var o=n.el;o.innerHTML="",i.appendChild(o)}}else t==="matrix"?_S(this):t==="clip"?yE(this,n):t==="changeSize"&&(i.setAttribute("width",""+this.get("width")),i.setAttribute("height",""+this.get("height")))},r.prototype.draw=function(){var t=this.get("context"),n=this.getChildren();yE(this,t),n.length&&cJ(t,n)},r}(fI),eEe="0.5.6",tEe=Object.freeze(Object.defineProperty({__proto__:null,Shape:KL,version:eEe,Canvas:JCe,Group:S4,Event:fS,Base:aI,AbstractCanvas:fI,AbstractGroup:hI,AbstractShape:pI,getBBoxMethod:dI,registerBBox:qd,getTextHeight:mI,assembleFont:yI,isAllowCapture:nE,multiplyVec2:iy,invert:lI,getOffScreenContext:gI,registerEasing:oK,PathUtil:O3},Symbol.toStringTag,{value:"Module"})),A4=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;n.type="path",n.shapeType="line";var i=t.connectNulls,a=i===void 0?!1:i,o=t.showSinglePoint,s=o===void 0?!0:o;return n.connectNulls=a,n.showSinglePoint=s,n}return r.prototype.updateElements=function(t,n){var i,a,o,s,u,l;n===void 0&&(n=!1);for(var f=new Map,h=new Map,p=[],v=0,m=0;m<t.length;m++){var x=t[m],E=this.getElementId(x);p.push(E),f.set(E,x),h.set(E,v),v++}this.elements=new Array(v);var A=zQ(this.lastElementsMap,p),L=A.added,k=A.updated,R=A.removed;try{for(var D=so(L),$=D.next();!$.done;$=D.next()){var E=$.value,x=f.get(E),j=this.getShapeFactory(),H=this.getShapeInfo(x),m=h.get(E),ee=new FQ({shapeFactory:j,container:this.container,offscreenGroup:this.getOffscreenGroup(),elementIndex:m});ee.geometry=this,ee.animate=this.animateOption,ee.draw(H,n),this.elementsMap[E]=ee,this.elements[m]=ee}}catch(ve){i={error:ve}}finally{try{$&&!$.done&&(a=D.return)&&a.call(D)}finally{if(i)throw i.error}}try{for(var U=so(k),W=U.next();!W.done;W=U.next()){var E=W.value,x=f.get(E),ee=this.lastElementsMap[E],m=h.get(E),H=this.getShapeInfo(x),Q=ee.getModel();(this.isCoordinateChanged||NQ(Q,H))&&(ee.animate=this.animateOption,ee.update(H)),this.elementsMap[E]=ee,this.elements[m]=ee}}catch(ve){o={error:ve}}finally{try{W&&!W.done&&(s=U.return)&&s.call(U)}finally{if(o)throw o.error}}try{for(var te=so(R),ie=te.next();!ie.done;ie=te.next()){var E=ie.value,ee=this.lastElementsMap[E];ee.animate=this.animateOption,ee.destroy()}}catch(ve){u={error:ve}}finally{try{ie&&!ie.done&&(l=te.return)&&l.call(te)}finally{if(u)throw u.error}}},r.prototype.getPointsAndData=function(t){for(var n=[],i=[],a=0,o=t.length;a<o;a++){var s=t[a];n.push({x:s.x,y:s.y}),i.push(s[Wo])}return{points:n,data:i}},r.prototype.getShapeInfo=function(t){var n=this.getDrawCfg(t[0]),i=this.getPointsAndData(t),a=i.points,o=i.data;return n.mappingData=t,n.data=o,n.isStack=!!this.getAdjust("stack"),n.points=a,n.connectNulls=this.connectNulls,n.showSinglePoint=this.showSinglePoint,n},r}(x_);function rEe(e,r,t,n,i){var a=[];if(e.length){for(var o=[],s=[],u=0,l=e.length;u<l;u++){var f=e[u];o.push(f[1]),s.push(f[0])}s=s.reverse(),we([o,s],function(h,p){var v=[],m=n.parsePoints(h),x=m[0];o.length===1&&s.length===1?v=p===0?[["M",x.x-.5,x.y],["L",x.x+.5,x.y]]:[["L",x.x+.5,x.y],["L",x.x-.5,x.y]]:(r&&m.push({x:x.x,y:x.y}),t?v=HM(m,!1,i):v=gS(m,!1),p>0&&(v[0][0]="L")),a=a.concat(v)}),a.push(["Z"])}return a}function DI(e,r,t,n,i){for(var a=Wu(e,r,!r,"lineWidth"),o=e.connectNulls,s=e.isInCircle,u=e.points,l=e.showSinglePoint,f=FI(u,o,l),h=[],p=0,v=f.length;p<v;p++){var m=f[p];h=h.concat(rEe(m,s,t,n,i))}return a.path=h,a}function pJ(e){var r=e.start,t=e.end;return[[r.x,t.y],[t.x,r.y]]}__("area",{defaultShapeType:"area",getDefaultPoints:function(e){var r=e.x,t=e.y0,n=ar(e.y)?e.y:[t,e.y];return n.map(function(i){return{x:r,y:i}})}});lo("area","area",{draw:function(e,r){var t=DI(e,!1,!1,this),n=r.addShape({type:"path",attrs:t,name:"area"});return n},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){return i===void 0&&(i=5.5),[["M",t-i,n-4],["L",t+i,n-4],["L",t+i,n+4],["L",t-i,n+4],["Z"]]},style:{r:5,fill:r,fillOpacity:1}}}});var nEe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;n.type="area",n.shapeType="area",n.generatePoints=!0,n.startOnZero=!0;var i=t.startOnZero,a=i===void 0?!0:i,o=t.sortable,s=o===void 0?!1:o,u=t.showSinglePoint,l=u===void 0?!1:u;return n.startOnZero=a,n.sortable=s,n.showSinglePoint=l,n}return r.prototype.getPointsAndData=function(t){for(var n=[],i=[],a=0,o=t.length;a<o;a++){var s=t[a];n.push(s.points),i.push(s[Wo])}return{points:n,data:i}},r.prototype.getYMinValue=function(){if(this.startOnZero)return e.prototype.getYMinValue.call(this);var t=this.getYScale();return t.min},r}(A4);__("edge",{defaultShapeType:"line",getDefaultPoints:function(e){return y4(e)}});lo("edge","line",{draw:function(e,r){var t=Wu(e,!0,!1,"lineWidth"),n=gS(this.parsePoints(e.points),this.coordinate.isPolar);return r.addShape("path",{attrs:Xe(Xe({},t),{path:n})})},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});var iEe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="edge",t.shapeType="edge",t.generatePoints=!0,t}return r}(x_),aEe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="heatmap",t.paletteCache={},t}return r.prototype.updateElements=function(t,n){for(var i=0;i<t.length;i++){var a=t[i],o=this.prepareRange(a),s=this.prepareSize(),u=Ie(this.styleOption,["cfg","shadowBlur"]);xi(u)||(u=s/2),this.prepareGreyScaleBlurredCircle(s,u),this.drawWithRange(a,o,s,u)}},r.prototype.color=function(t,n){return this.createAttrOption("color",t,typeof n!="function"?n:""),this},r.prototype.clear=function(){e.prototype.clear.call(this),this.clearShadowCanvasCtx(),this.paletteCache={}},r.prototype.prepareRange=function(t){var n=this.getAttribute("color"),i=n.getFields()[0],a=1/0,o=-1/0;return t.forEach(function(s){var u=s[Wo][i];u>o&&(o=u),u<a&&(a=u)}),a===o&&(a=o-1),[a,o]},r.prototype.prepareSize=function(){var t=this.getDefaultValue("size");return xi(t)||(t=this.getDefaultSize()),t},r.prototype.prepareGreyScaleBlurredCircle=function(t,n){var i=this.getGrayScaleBlurredCanvas(),a=t+n,o=i.getContext("2d");i.width=i.height=a*2,o.clearRect(0,0,i.width,i.height),o.shadowOffsetX=o.shadowOffsetY=a*2,o.shadowBlur=n,o.shadowColor="black",o.beginPath(),o.arc(-a,-a,t,0,Math.PI*2,!0),o.closePath(),o.fill()},r.prototype.drawWithRange=function(t,n,i,a){var o,s,u=this.coordinate,l=u.start,f=u.end,h=this.coordinate.getWidth(),p=this.coordinate.getHeight(),v=this.getAttribute("color"),m=v.getFields()[0];this.clearShadowCanvasCtx();var x=this.getShadowCanvasCtx();n&&(t=t.filter(function(U){return U[Wo][m]<=n[1]&&U[Wo][m]>=n[0]}));var E=this.scales[m];try{for(var A=so(t),L=A.next();!L.done;L=A.next()){var k=L.value,R=this.getDrawCfg(k),D=R.x,$=R.y,j=E.scale(k[Wo][m]);this.drawGrayScaleBlurredCircle(D-l.x,$-f.y,i+a,j,x)}}catch(U){o={error:U}}finally{try{L&&!L.done&&(s=A.return)&&s.call(A)}finally{if(o)throw o.error}}var H=x.getImageData(0,0,h,p);this.clearShadowCanvasCtx(),this.colorize(H),x.putImageData(H,0,0);var ee=this.getImageShape();ee.attr("x",l.x),ee.attr("y",f.y),ee.attr("width",h),ee.attr("height",p),ee.attr("img",x.canvas),ee.set("origin",this.getShapeInfo(t))},r.prototype.getDefaultSize=function(){var t=this.getAttribute("position"),n=this.coordinate;return Math.min(n.getWidth()/(t.scales[0].ticks.length*4),n.getHeight()/(t.scales[1].ticks.length*4))},r.prototype.clearShadowCanvasCtx=function(){var t=this.getShadowCanvasCtx();t.clearRect(0,0,t.canvas.width,t.canvas.height)},r.prototype.getShadowCanvasCtx=function(){var t=this.shadowCanvas;return t||(t=document.createElement("canvas"),this.shadowCanvas=t),t.width=this.coordinate.getWidth(),t.height=this.coordinate.getHeight(),t.getContext("2d")},r.prototype.getGrayScaleBlurredCanvas=function(){return this.grayScaleBlurredCanvas||(this.grayScaleBlurredCanvas=document.createElement("canvas")),this.grayScaleBlurredCanvas},r.prototype.drawGrayScaleBlurredCircle=function(t,n,i,a,o){var s=this.getGrayScaleBlurredCanvas();o.globalAlpha=a,o.drawImage(s,t-i,n-i)},r.prototype.colorize=function(t){for(var n=this.getAttribute("color"),i=t.data,a=this.paletteCache,o=3;o<i.length;o+=4){var s=i[o];if(xi(s)){var u=a[s]?a[s]:G0.rgb2arr(n.gradient(s/256));i[o-3]=u[0],i[o-2]=u[1],i[o-1]=u[2],i[o]=s}}},r.prototype.getImageShape=function(){var t=this.imageShape;if(t)return t;var n=this.container;return t=n.addShape({type:"image",attrs:{}}),this.imageShape=t,t},r.prototype.getShapeInfo=function(t){var n=this.getDrawCfg(t[0]),i=t.map(function(a){return a[Wo]});return Xe(Xe({},n),{mappingData:t,data:i})},r}(x_);function T4(e){var r,t,n=e.x,i=e.y,a=e.y0,o=e.size,s,u;ar(i)?(r=jn(i,2),s=r[0],u=r[1]):(s=a,u=i);var l,f;ar(n)?(t=jn(n,2),l=t[0],f=t[1]):(l=n-o/2,f=n+o/2);var h=[{x:l,y:s},{x:l,y:u}];return h.push({x:f,y:u},{x:f,y:s}),h}function M4(e,r){r===void 0&&(r=!0);var t=[],n=e[0];t.push(["M",n.x,n.y]);for(var i=1,a=e.length;i<a;i++)t.push(["L",e[i].x,e[i].y]);return r&&(t.push(["L",n.x,n.y]),t.push(["z"])),t}function dJ(e,r){var t=0,n=0,i=0,a=0;return ar(e)?e.length===1?t=n=i=a=e[0]:e.length===2?(t=i=e[0],n=a=e[1]):e.length===3?(t=e[0],n=a=e[1],i=e[2]):(t=e[0],n=e[1],i=e[2],a=e[3]):t=n=i=a=e,t+n>r&&(t=t?r/(1+n/t):0,n=r-t),i+a>r&&(i=i?r/(1+a/i):0,a=r-i),[t||0,n||0,i||0,a||0]}function vJ(e,r,t){var n=[];if(t.isRect){var i=t.isTransposed?{x:t.start.x,y:r[0].y}:{x:r[0].x,y:t.start.y},a=t.isTransposed?{x:t.end.x,y:r[2].y}:{x:r[3].x,y:t.end.y},o=Ie(e,["background","style","radius"]);if(o){var s=t.isTransposed?Math.abs(r[0].y-r[2].y):r[2].x-r[1].x,u=t.isTransposed?t.getWidth():t.getHeight(),l=jn(dJ(o,Math.min(s,u)),4),f=l[0],h=l[1],p=l[2],v=l[3],m=t.isTransposed&&t.isReflect("y"),x=m?0:1,E=function($){return m?-$:$};n.push(["M",i.x,a.y+E(f)]),f!==0&&n.push(["A",f,f,0,0,x,i.x+f,a.y]),n.push(["L",a.x-h,a.y]),h!==0&&n.push(["A",h,h,0,0,x,a.x,a.y+E(h)]),n.push(["L",a.x,i.y-E(p)]),p!==0&&n.push(["A",p,p,0,0,x,a.x-p,i.y]),n.push(["L",i.x+v,i.y]),v!==0&&n.push(["A",v,v,0,0,x,i.x,i.y-E(v)])}else n.push(["M",i.x,i.y]),n.push(["L",a.x,i.y]),n.push(["L",a.x,a.y]),n.push(["L",i.x,a.y]),n.push(["L",i.x,i.y]);n.push(["z"])}if(t.isPolar){var A=t.getCenter(),L=pE(e,t),k=L.startAngle,R=L.endAngle;if(t.type!=="theta"&&!t.isTransposed)n=H0(A.x,A.y,t.getRadius(),k,R);else{var D=function(H){return Math.pow(H,2)},f=Math.sqrt(D(A.x-r[0].x)+D(A.y-r[0].y)),h=Math.sqrt(D(A.x-r[2].x)+D(A.y-r[2].y));n=H0(A.x,A.y,f,t.startAngle,t.endAngle,h)}}return n}function oEe(e,r,t){var n=t.getWidth(),i=t.getHeight(),a=t.type==="rect",o=[],s=(e[2].x-e[1].x)/2,u=t.isTransposed?s*i/n:s*n/i;return r==="round"?(a?(o.push(["M",e[0].x,e[0].y+u]),o.push(["L",e[1].x,e[1].y-u]),o.push(["A",s,s,0,0,1,e[2].x,e[2].y-u]),o.push(["L",e[3].x,e[3].y+u]),o.push(["A",s,s,0,0,1,e[0].x,e[0].y+u])):(o.push(["M",e[0].x,e[0].y]),o.push(["L",e[1].x,e[1].y]),o.push(["A",s,s,0,0,1,e[2].x,e[2].y]),o.push(["L",e[3].x,e[3].y]),o.push(["A",s,s,0,0,1,e[0].x,e[0].y])),o.push(["z"])):o=M4(e),o}function gJ(e,r,t){var n=[];return rr(r)?t?n.push(["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["L",(e[2].x+e[3].x)/2,(e[2].y+e[3].y)/2],["Z"]):n.push(["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["L",e[2].x,e[2].y],["L",e[3].x,e[3].y],["Z"]):n.push(["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["L",r[1].x,r[1].y],["L",r[0].x,r[0].y],["Z"]),n}function Bw(e,r){return[r,e]}function sEe(e,r,t){var n,i,a,o,s,u,l,f=jn(vu([],jn(e),!1),4),h=f[0],p=f[1],v=f[2],m=f[3],x=jn(typeof t=="number"?Array(4).fill(t):t,4),E=x[0],A=x[1],L=x[2],k=x[3];r.isTransposed&&(n=jn(Bw(p,m),2),p=n[0],m=n[1]),r.isReflect("y")&&(i=jn(Bw(h,p),2),h=i[0],p=i[1],a=jn(Bw(v,m),2),v=a[0],m=a[1]),r.isReflect("x")&&(o=jn(Bw(h,m),2),h=o[0],m=o[1],s=jn(Bw(p,v),2),p=s[0],v=s[1]);var R=[],D=function($){return Math.abs($)};return u=jn(dJ([E,A,L,k],Math.min(D(m.x-h.x),D(p.y-h.y))).map(function($){return D($)}),4),E=u[0],A=u[1],L=u[2],k=u[3],r.isTransposed&&(l=jn([k,E,A,L],4),E=l[0],A=l[1],L=l[2],k=l[3]),h.y<p.y?(R.push(["M",m.x,m.y+L]),L!==0&&R.push(["A",L,L,0,0,0,m.x-L,m.y]),R.push(["L",h.x+k,h.y]),k!==0&&R.push(["A",k,k,0,0,0,h.x,h.y+k]),R.push(["L",p.x,p.y-E]),E!==0&&R.push(["A",E,E,0,0,0,p.x+E,p.y]),R.push(["L",v.x-A,v.y]),A!==0&&R.push(["A",A,A,0,0,0,v.x,v.y-A]),R.push(["L",m.x,m.y+L]),R.push(["z"])):m.x<h.x?(R.push(["M",v.x+A,v.y]),A!==0&&R.push(["A",A,A,0,0,0,v.x,v.y+A]),R.push(["L",m.x,m.y-L]),L!==0&&R.push(["A",L,L,0,0,0,m.x+L,m.y]),R.push(["L",h.x-k,h.y]),k!==0&&R.push(["A",k,k,0,0,0,h.x,h.y-k]),R.push(["L",p.x,p.y+E]),E!==0&&R.push(["A",E,E,0,0,0,p.x-E,p.y]),R.push(["L",v.x+A,v.y]),R.push(["z"])):(R.push(["M",p.x,p.y+E]),E!==0&&R.push(["A",E,E,0,0,1,p.x+E,p.y]),R.push(["L",v.x-A,v.y]),A!==0&&R.push(["A",A,A,0,0,1,v.x,v.y+A]),R.push(["L",m.x,m.y-L]),L!==0&&R.push(["A",L,L,0,0,1,m.x-L,m.y]),R.push(["L",h.x+k,h.y]),k!==0&&R.push(["A",k,k,0,0,1,h.x,h.y-k]),R.push(["L",p.x,p.y+E]),R.push(["z"])),R}__("interval",{defaultShapeType:"rect",getDefaultPoints:function(e){return T4(e)}});lo("interval","rect",{draw:function(e,r){var t=Wu(e,!1,!0),n=r,i=e==null?void 0:e.background;if(i){n=r.addGroup({name:"interval-group"});var a=WQ(e),o=vJ(e,this.parsePoints(e.points),this.coordinate);n.addShape("path",{attrs:Xe(Xe({},a),{path:o}),zIndex:-1,name:v4})}var s;t.radius&&this.coordinate.isRect?s=sEe(this.parsePoints(e.points),this.coordinate,t.radius):s=this.parsePath(oEe(e.points,t.lineCap,this.coordinate));var u=n.addShape("path",{attrs:Xe(Xe({},t),{path:s}),name:"interval"});return i?n:u},getMarker:function(e){var r=e.color,t=e.isInPolar;return t?{symbol:"circle",style:{r:4.5,fill:r}}:{symbol:"square",style:{r:4,fill:r}}}});function uEe(e,r){var t=e.length,n=e;ei(n[0])&&(n=e.map(function(s){return r.translate(s)}));for(var i=n[1]-n[0],a=2;a<t;a++){var o=n[a]-n[a-1];i>o&&(i=o)}return i}function lEe(e,r){if(r){var t=pp(e),n=Gd(t,r);return n.length}return e.length}function L4(e){var r=e.theme,t=e.coordinate,n=e.getXScale(),i=n.values,a=e.beforeMappingData,o=i.length,s=vS(e.coordinate),u=e.intervalPadding,l=e.dodgePadding,f=e.maxColumnWidth||r.maxColumnWidth,h=e.minColumnWidth||r.minColumnWidth,p=e.columnWidthRatio||r.columnWidthRatio,v=e.multiplePieWidthRatio||r.multiplePieWidthRatio,m=e.roseWidthRatio||r.roseWidthRatio;if(n.isLinear&&i.length>1){i.sort();var x=uEe(i,n);o=(n.max-n.min)/x,i.length>o&&(o=i.length)}var E=n.range,A=1/o,L=1;if(t.isPolar?t.isTransposed&&o>1?L=v:L=m:(n.isLinear&&(A*=E[1]-E[0]),L=p),!rr(u)&&u>=0){var k=u/s;A=(1-(o-1)*k)/o}else A*=L;if(e.getAdjust("dodge")){var R=e.getAdjust("dodge"),D=R.dodgeBy,$=lEe(a,D);if(!rr(l)&&l>=0){var j=l/s;A=(A-j*($-1))/$}else!rr(u)&&u>=0&&(A*=L),A=A/$;A=A>=0?A:0}if(!rr(f)&&f>=0){var H=f/s;A>H&&(A=H)}if(!rr(h)&&h>=0){var ee=h/s;A<ee&&(A=ee)}return A}var cEe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;n.type="interval",n.shapeType="interval",n.generatePoints=!0;var i=t.background;return n.background=i,n}return r.prototype.createShapePointsCfg=function(t){var n=e.prototype.createShapePointsCfg.call(this,t),i,a=this.getAttribute("size");if(a){i=this.getAttributeValues(a,t)[0];var o=this.coordinate,s=vS(o);i=i/s}else this.defaultSize||(this.defaultSize=L4(this)),i=this.defaultSize;return n.size=i,n},r.prototype.adjustScale=function(){e.prototype.adjustScale.call(this);var t=this.getYScale();if(this.coordinate.type==="theta")t.change({nice:!1,min:0,max:Qbe(t)});else{var n=this.scaleDefs,i=t.field,a=t.min,o=t.max,s=t.type;s!=="time"&&(a>0&&!Ie(n,[i,"min"])&&t.change({min:0}),o<=0&&!Ie(n,[i,"max"])&&t.change({max:0}))}},r.prototype.getDrawCfg=function(t){var n=e.prototype.getDrawCfg.call(this,t);return n.background=this.background,n},r}(x_),fEe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;n.type="line";var i=t.sortable,a=i===void 0?!1:i;return n.sortable=a,n}return r}(A4),mJ=["circle","square","bowtie","diamond","hexagon","triangle","triangle-down"],hEe=["cross","tick","plus","hyphen","line"];function I4(e,r,t,n,i){var a,o,s=Wu(r,i,!i,"r"),u=e.parsePoints(r.points),l=u[0];if(r.isStack)l=u[1];else if(u.length>1){var f=t.addGroup();try{for(var h=so(u),p=h.next();!p.done;p=h.next()){var v=p.value;f.addShape({type:"marker",attrs:Xe(Xe(Xe({},s),{symbol:Jx[n]||n}),v)})}}catch(m){a={error:m}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}return f}return t.addShape({type:"marker",attrs:Xe(Xe(Xe({},s),{symbol:Jx[n]||n}),l)})}__("point",{defaultShapeType:"hollow-circle",getDefaultPoints:function(e){return y4(e)}});we(mJ,function(e){lo("point","hollow-".concat(e),{draw:function(r,t){return I4(this,r,t,e,!0)},getMarker:function(r){var t=r.color;return{symbol:Jx[e]||e,style:{r:4.5,stroke:t,fill:null}}}})});var pEe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="point",t.shapeType="point",t.generatePoints=!0,t}return r.prototype.getDrawCfg=function(t){var n=e.prototype.getDrawCfg.call(this,t);return Xe(Xe({},n),{isStack:!!this.getAdjust("stack")})},r}(x_);function dEe(e){for(var r=e[0],t=1,n=[["M",r.x,r.y]];t<e.length;){var i=e[t];(i.x!==e[t-1].x||i.y!==e[t-1].y)&&(n.push(["L",i.x,i.y]),i.x===r.x&&i.y===r.y&&t<e.length-1&&(r=e[t+1],n.push(["Z"]),n.push(["M",r.x,r.y]),t++)),t++}return rs(al(n),r)||n.push(["L",r.x,r.y]),n.push(["Z"]),n}__("polygon",{defaultShapeType:"polygon",getDefaultPoints:function(e){var r=[];return we(e.x,function(t,n){var i=e.y[n];r.push({x:t,y:i})}),r}});lo("polygon","polygon",{draw:function(e,r){if(!uh(e.points)){var t=Wu(e,!0,!0),n=this.parsePath(dEe(e.points));return r.addShape("path",{attrs:Xe(Xe({},t),{path:n}),name:"polygon"})}},getMarker:function(e){var r=e.color;return{symbol:"square",style:{r:4,fill:r}}}});var vEe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="polygon",t.shapeType="polygon",t.generatePoints=!0,t}return r.prototype.createShapePointsCfg=function(t){var n=e.prototype.createShapePointsCfg.call(this,t),i=n.x,a=n.y,o;if(!(ar(i)&&ar(a))){var s=this.getXScale(),u=this.getYScale(),l=s.values.length,f=u.values.length,h=.5*1/l,p=.5*1/f;s.isCategory&&u.isCategory?(i=[i-h,i-h,i+h,i+h],a=[a-p,a+p,a+p,a-p]):ar(i)?(o=i,i=[o[0],o[0],o[1],o[1]],a=[a-p/2,a+p/2,a+p/2,a-p/2]):ar(a)&&(o=a,a=[o[0],o[1],o[1],o[0]],i=[i-h/2,i-h/2,i+h/2,i+h/2]),n.x=i,n.y=a}return n},r}(x_);__("schema",{defaultShapeType:""});var gEe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="schema",t.shapeType="schema",t.generatePoints=!0,t}return r.prototype.createShapePointsCfg=function(t){var n=e.prototype.createShapePointsCfg.call(this,t),i,a=this.getAttribute("size");if(a){i=this.getAttributeValues(a,t)[0];var o=this.coordinate,s=vS(o);i=i/s}else this.defaultSize||(this.defaultSize=L4(this)),i=this.defaultSize;return n.size=i,n},r}(x_);function mEe(e){if(!ar(e))return[];var r=Ff(e);return gu(e,function(t){return t/r})}__("violin",{defaultShapeType:"violin",getDefaultPoints:function(e){var r=e.size/2,t=[],n=mEe(e._size);return we(e.y,function(i,a){var o=n[a]*r,s=a===0,u=a===e.y.length-1;t.push({isMin:s,isMax:u,x:e.x-o,y:i}),t.unshift({isMin:s,isMax:u,x:e.x+o,y:i})}),t}});lo("violin","violin",{draw:function(e,r){var t=Wu(e,!0,!0),n=this.parsePath(HQ(e.points));return r.addShape("path",{attrs:Xe(Xe({},t),{path:n}),name:"violin"})},getMarker:function(e){var r=e.color;return{symbol:"circle",style:{r:4,fill:r}}}});var yEe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="violin",t.shapeType="violin",t.generatePoints=!0,t}return r.prototype.createShapePointsCfg=function(t){var n=e.prototype.createShapePointsCfg.call(this,t),i,a=this.getAttribute("size");if(a){i=this.getAttributeValues(a,t)[0];var o=this.coordinate,s=vS(o);i=i/s}else this.defaultSize||(this.defaultSize=L4(this)),i=this.defaultSize;return n.size=i,n._size=Ie(t[Wo],[this._sizeField]),n},r.prototype.initAttributes=function(){var t=this.attributeOption,n=t.size?t.size.fields[0]:this._sizeField?this._sizeField:"size";this._sizeField=n,delete t.size,e.prototype.initAttributes.call(this)},r}(x_);lo("area","line",{draw:function(e,r){var t=DI(e,!0,!1,this),n=r.addShape({type:"path",attrs:t,name:"area"});return n},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){return i===void 0&&(i=5.5),[["M",t-i,n-4],["L",t+i,n-4],["L",t+i,n+4],["L",t-i,n+4],["Z"]]},style:{r:5,stroke:r,fill:null}}}});lo("area","smooth",{draw:function(e,r){var t=this.coordinate,n=DI(e,!1,!0,this,pJ(t)),i=r.addShape({type:"path",attrs:n,name:"area"});return i},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){return i===void 0&&(i=5.5),[["M",t-i,n-4],["L",t+i,n-4],["L",t+i,n+4],["L",t-i,n+4],["Z"]]},style:{r:5,fill:r,fillOpacity:1}}}});lo("area","smooth-line",{draw:function(e,r){var t=this.coordinate,n=DI(e,!0,!0,this,pJ(t)),i=r.addShape({type:"path",attrs:n,name:"area"});return i},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){return i===void 0&&(i=5.5),[["M",t-i,n-4],["L",t+i,n-4],["L",t+i,n+4],["L",t-i,n+4],["Z"]]},style:{r:5,stroke:r,fill:null}}}});function b5(e,r){return["C",e.x*1/2+r.x*1/2,e.y,e.x*1/2+r.x*1/2,r.y,r.x,r.y]}function w5(e,r){var t=[];t.push({x:r.x,y:r.y}),t.push(e);var n=["Q"];return we(t,function(i){n.push(i.x,i.y)}),n}function _Ee(e,r,t){var n=w5(r,t),i=[["M",e.x,e.y]];return i.push(n),i}function xEe(e,r){var t=w5(e[1],r),n=w5(e[3],r),i=[["M",e[0].x,e[0].y]];return i.push(n),i.push(["L",e[3].x,e[3].y]),i.push(["L",e[2].x,e[2].y]),i.push(t),i.push(["L",e[1].x,e[1].y]),i.push(["L",e[0].x,e[0].y]),i.push(["Z"]),i}lo("edge","arc",{draw:function(e,r){var t=Wu(e,!0,!1,"lineWidth"),n=e.points,i=n.length>2?"weight":"normal",a;if(e.isInCircle){var o={x:0,y:1};return i==="normal"?a=_Ee(n[0],n[1],o):(t.fill=t.stroke,a=xEe(n,o)),a=this.parsePath(a),r.addShape("path",{attrs:Xe(Xe({},t),{path:a})})}else{if(i==="normal")return n=this.parsePoints(n),a=cQ((n[1].x+n[0].x)/2,n[0].y,Math.abs(n[1].x-n[0].x)/2,Math.PI,Math.PI*2),r.addShape("path",{attrs:Xe(Xe({},t),{path:a})});var s=b5(n[1],n[3]),u=b5(n[2],n[0]);return a=[["M",n[0].x,n[0].y],["L",n[1].x,n[1].y],s,["L",n[3].x,n[3].y],["L",n[2].x,n[2].y],u,["Z"]],a=this.parsePath(a),t.fill=t.stroke,r.addShape("path",{attrs:Xe(Xe({},t),{path:a})})}},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});function bEe(e,r){var t=b5(e,r),n=[["M",e.x,e.y]];return n.push(t),n}lo("edge","smooth",{draw:function(e,r){var t=Wu(e,!0,!1,"lineWidth"),n=e.points,i=this.parsePath(bEe(n[0],n[1]));return r.addShape("path",{attrs:Xe(Xe({},t),{path:i})})},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});var GA=1/3;function wEe(e,r){var t=[];t.push({x:e.x,y:e.y*(1-GA)+r.y*GA}),t.push({x:r.x,y:e.y*(1-GA)+r.y*GA}),t.push(r);var n=[["M",e.x,e.y]];return we(t,function(i){n.push(["L",i.x,i.y])}),n}lo("edge","vhv",{draw:function(e,r){var t=Wu(e,!0,!1,"lineWidth"),n=e.points,i=this.parsePath(wEe(n[0],n[1]));return r.addShape("path",{attrs:Xe(Xe({},t),{path:i})})},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});lo("interval","funnel",{getPoints:function(e){return e.size=e.size*2,T4(e)},draw:function(e,r){var t=Wu(e,!1,!0),n=this.parsePath(gJ(e.points,e.nextPoints,!1)),i=r.addShape("path",{attrs:Xe(Xe({},t),{path:n}),name:"interval"});return i},getMarker:function(e){var r=e.color;return{symbol:"square",style:{r:4,fill:r}}}});lo("interval","hollow-rect",{draw:function(e,r){var t=Wu(e,!0,!1),n=r,i=e==null?void 0:e.background;if(i){n=r.addGroup();var a=WQ(e),o=vJ(e,this.parsePoints(e.points),this.coordinate);n.addShape("path",{attrs:Xe(Xe({},a),{path:o}),zIndex:-1,name:v4})}var s=this.parsePath(M4(e.points)),u=n.addShape("path",{attrs:Xe(Xe({},t),{path:s}),name:"interval"});return i?n:u},getMarker:function(e){var r=e.color,t=e.isInPolar;return t?{symbol:"circle",style:{r:4.5,stroke:r,fill:null}}:{symbol:"square",style:{r:4,stroke:r,fill:null}}}});function CEe(e){var r=e.x,t=e.y,n=e.y0;return ar(t)?t.map(function(i,a){return{x:ar(r)?r[a]:r,y:i}}):[{x:r,y:n},{x:r,y:t}]}lo("interval","line",{getPoints:function(e){return CEe(e)},draw:function(e,r){var t=Wu(e,!0,!1,"lineWidth"),n=ip(Xe({},t),["fill"]),i=this.parsePath(M4(e.points,!1)),a=r.addShape("path",{attrs:Xe(Xe({},n),{path:i}),name:"interval"});return a},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){return[["M",t,n-i],["L",t,n+i]]},style:{r:5,stroke:r}}}});lo("interval","pyramid",{getPoints:function(e){return e.size=e.size*2,T4(e)},draw:function(e,r){var t=Wu(e,!1,!0),n=this.parsePath(gJ(e.points,e.nextPoints,!0)),i=r.addShape("path",{attrs:Xe(Xe({},t),{path:n}),name:"interval"});return i},getMarker:function(e){var r=e.color;return{symbol:"square",style:{r:4,fill:r}}}});function EEe(e){var r,t=e.x,n=e.y,i=e.y0,a=e.size,o,s;ar(n)?(r=jn(n,2),o=r[0],s=r[1]):(o=i,s=n);var u=t+a/2,l=t-a/2;return[{x:t,y:o},{x:t,y:s},{x:l,y:o},{x:u,y:o},{x:l,y:s},{x:u,y:s}]}function SEe(e){return[["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["M",e[2].x,e[2].y],["L",e[3].x,e[3].y],["M",e[4].x,e[4].y],["L",e[5].x,e[5].y]]}lo("interval","tick",{getPoints:function(e){return EEe(e)},draw:function(e,r){var t=Wu(e,!0,!1),n=this.parsePath(SEe(e.points)),i=r.addShape("path",{attrs:Xe(Xe({},t),{path:n}),name:"interval"});return i},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){return[["M",t-i/2,n-i],["L",t+i/2,n-i],["M",t,n-i],["L",t,n+i],["M",t-i/2,n+i],["L",t+i/2,n+i]]},style:{r:5,stroke:r}}}});var AEe=function(e,r,t){var n=e.x,i=e.y,a=r.x,o=r.y,s;switch(t){case"hv":s=[{x:a,y:i}];break;case"vh":s=[{x:n,y:o}];break;case"hvh":var u=(a+n)/2;s=[{x:u,y:i},{x:u,y:o}];break;case"vhv":var l=(i+o)/2;s=[{x:n,y:l},{x:a,y:l}];break}return s};function TEe(e,r){var t=[];return we(e,function(n,i){var a=e[i+1];if(t.push(n),a){var o=AEe(n,a,r);t=t.concat(o)}}),t}function MEe(e){return e.map(function(r,t){return t===0?["M",r.x,r.y]:["L",r.x,r.y]})}function LEe(e,r){var t=FI(e.points,e.connectNulls,e.showSinglePoint),n=[];return we(t,function(i){var a=TEe(i,r);n=n.concat(MEe(a))}),Xe(Xe({},Wu(e,!0,!1,"lineWidth")),{path:n})}we(["hv","vh","hvh","vhv"],function(e){lo("line",e,{draw:function(r,t){var n=LEe(r,e),i=t.addShape({type:"path",attrs:n,name:"line"});return i},getMarker:function(r){return XQ(r,e)}})});we(hEe,function(e){lo("point",e,{draw:function(r,t){return I4(this,r,t,e,!0)},getMarker:function(r){var t=r.color;return{symbol:Jx[e],style:{r:4.5,stroke:t,fill:null}}}})});lo("point","image",{draw:function(e,r){var t,n,i=Wu(e,!1,!1,"r").r,a=this.parsePoints(e.points),o=a[0];if(e.isStack)o=a[1];else if(a.length>1){var s=r.addGroup();try{for(var u=so(a),l=u.next();!l.done;l=u.next()){var f=l.value;s.addShape("image",{attrs:{x:f.x-i/2,y:f.y-i,width:i,height:i,img:e.shape[1]}})}}catch(h){t={error:h}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return s}return r.addShape("image",{attrs:{x:o.x-i/2,y:o.y-i,width:i,height:i,img:e.shape[1]}})},getMarker:function(e){var r=e.color;return{symbol:"circle",style:{r:4.5,fill:r}}}});we(mJ,function(e){lo("point",e,{draw:function(r,t){return I4(this,r,t,e,!1)},getMarker:function(r){var t=r.color;return{symbol:Jx[e]||e,style:{r:4.5,fill:t}}}})});function Mz(e){var r=ar(e)?e:[e],t=r[0],n=r[r.length-1],i=r.length>1?r[1]:t,a=r.length>3?r[3]:n,o=r.length>2?r[2]:i;return{min:t,max:n,min1:i,max1:a,median:o}}function Lz(e,r,t){var n=t/2,i;if(ar(r)){var a=Mz(r),o=a.min,s=a.max,u=a.median,l=a.min1,f=a.max1,h=e-n,p=e+n;i=[[h,s],[p,s],[e,s],[e,f],[h,l],[h,f],[p,f],[p,l],[e,l],[e,o],[h,o],[p,o],[h,u],[p,u]]}else{r=rr(r)?.5:r;var v=Mz(e),o=v.min,s=v.max,u=v.median,l=v.min1,f=v.max1,m=r-n,x=r+n;i=[[o,m],[o,x],[o,r],[l,r],[l,m],[l,x],[f,x],[f,m],[f,r],[s,r],[s,m],[s,x],[u,m],[u,x]]}return i.map(function(E){return{x:E[0],y:E[1]}})}function IEe(e){return[["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["M",e[2].x,e[2].y],["L",e[3].x,e[3].y],["M",e[4].x,e[4].y],["L",e[5].x,e[5].y],["L",e[6].x,e[6].y],["L",e[7].x,e[7].y],["L",e[4].x,e[4].y],["Z"],["M",e[8].x,e[8].y],["L",e[9].x,e[9].y],["M",e[10].x,e[10].y],["L",e[11].x,e[11].y],["M",e[12].x,e[12].y],["L",e[13].x,e[13].y]]}lo("schema","box",{getPoints:function(e){var r=e.x,t=e.y,n=e.size;return Lz(r,t,n)},draw:function(e,r){var t=Wu(e,!0,!1),n=this.parsePath(IEe(e.points)),i=r.addShape("path",{attrs:Xe(Xe({},t),{path:n,name:"schema"})});return i},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){var a=[n-6,n-3,n,n+3,n+6],o=Lz(t,a,i);return[["M",o[0].x+1,o[0].y],["L",o[1].x-1,o[1].y],["M",o[2].x,o[2].y],["L",o[3].x,o[3].y],["M",o[4].x,o[4].y],["L",o[5].x,o[5].y],["L",o[6].x,o[6].y],["L",o[7].x,o[7].y],["L",o[4].x,o[4].y],["Z"],["M",o[8].x,o[8].y],["L",o[9].x,o[9].y],["M",o[10].x+1,o[10].y],["L",o[11].x-1,o[11].y],["M",o[12].x,o[12].y],["L",o[13].x,o[13].y]]},style:{r:6,lineWidth:1,stroke:r}}}});function kEe(e){var r=ar(e)?e:[e],t=r.sort(function(n,i){return i-n});return Gbe(t,4,t[t.length-1])}function Iz(e,r,t){var n=kEe(r);return[{x:e,y:n[0]},{x:e,y:n[1]},{x:e-t/2,y:n[2]},{x:e-t/2,y:n[1]},{x:e+t/2,y:n[1]},{x:e+t/2,y:n[2]},{x:e,y:n[2]},{x:e,y:n[3]}]}function PEe(e){return[["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["M",e[2].x,e[2].y],["L",e[3].x,e[3].y],["L",e[4].x,e[4].y],["L",e[5].x,e[5].y],["Z"],["M",e[6].x,e[6].y],["L",e[7].x,e[7].y]]}lo("schema","candle",{getPoints:function(e){var r=e.x,t=e.y,n=e.size;return Iz(r,t,n)},draw:function(e,r){var t=Wu(e,!0,!0),n=this.parsePath(PEe(e.points)),i=r.addShape("path",{attrs:Xe(Xe({},t),{path:n,name:"schema"})});return i},getMarker:function(e){var r=e.color;return{symbol:function(t,n,i){var a=[n+7.5,n+3,n-3,n-7.5],o=Iz(t,a,i);return[["M",o[0].x,o[0].y],["L",o[1].x,o[1].y],["M",o[2].x,o[2].y],["L",o[3].x,o[3].y],["L",o[4].x,o[4].y],["L",o[5].x,o[5].y],["Z"],["M",o[6].x,o[6].y],["L",o[7].x,o[7].y]]},style:{lineWidth:1,stroke:r,fill:r,r:6}}}});function REe(e,r){var t=Math.abs(e[0].x-e[2].x),n=Math.abs(e[0].y-e[2].y),i=Math.min(t,n);r&&(i=_s(r,0,Math.min(t,n))),i=i/2;var a=(e[0].x+e[2].x)/2,o=(e[0].y+e[2].y)/2;return{x:a-i,y:o-i,width:i*2,height:i*2}}lo("polygon","square",{draw:function(e,r){if(!uh(e.points)){var t=Wu(e,!0,!0),n=this.parsePoints(e.points);return r.addShape("rect",{attrs:Xe(Xe({},t),REe(n,e.size)),name:"polygon"})}},getMarker:function(e){var r=e.color;return{symbol:"square",style:{r:4,fill:r}}}});lo("violin","smooth",{draw:function(e,r){var t=Wu(e,!0,!0),n=this.parsePath(jQ(e.points));return r.addShape("path",{attrs:Xe(Xe({},t),{path:n})})},getMarker:function(e){var r=e.color;return{symbol:"circle",style:{stroke:null,r:4,fill:r}}}});lo("violin","hollow",{draw:function(e,r){var t=Wu(e,!0,!1),n=this.parsePath(HQ(e.points));return r.addShape("path",{attrs:Xe(Xe({},t),{path:n})})},getMarker:function(e){var r=e.color;return{symbol:"circle",style:{r:4,fill:null,stroke:r}}}});lo("violin","hollow-smooth",{draw:function(e,r){var t=Wu(e,!0,!1),n=this.parsePath(jQ(e.points));return r.addShape("path",{attrs:Xe(Xe({},t),{path:n})})},getMarker:function(e){var r=e.color;return{symbol:"circle",style:{r:4,fill:null,stroke:r}}}});var OEe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getLabelValueDir=function(t){var n="y",i=t.points;return i[0][n]<=i[2][n]?1:-1},r.prototype.getLabelOffsetPoint=function(t,n,i,a){var o,s=e.prototype.getLabelOffsetPoint.call(this,t,n,i),u=this.getCoordinate(),l=u.isTransposed,f=l?"x":"y",h=this.getLabelValueDir(t.mappingData);return s=Xe(Xe({},s),(o={},o[f]=s[f]*h,o)),u.isReflect("x")&&(s=Xe(Xe({},s),{x:s.x*-1})),u.isReflect("y")&&(s=Xe(Xe({},s),{y:s.y*-1})),s},r.prototype.getThemedLabelCfg=function(t){var n=this.geometry,i=this.getDefaultLabelCfg(),a=n.theme;return yn({},i,a.labels,t.position==="middle"?{offset:0}:{},t)},r.prototype.setLabelPosition=function(t,n,i,a){var o=this.getCoordinate(),s=o.isTransposed,u=n.points,l=o.convert(u[0]),f=o.convert(u[2]),h=this.getLabelValueDir(n),p,v,m,x,E=ar(n.shape)?n.shape[0]:n.shape;if(E==="funnel"||E==="pyramid"){var A=Ie(n,"nextPoints"),L=Ie(n,"points");if(A){var k=o.convert(L[0]),R=o.convert(L[1]),D=o.convert(A[0]),$=o.convert(A[1]);s?(p=Math.min(D.y,k.y),m=Math.max(D.y,k.y),v=(R.x+$.x)/2,x=(k.x+D.x)/2):(p=Math.min((R.y+$.y)/2,(k.y+D.y)/2),m=Math.max((R.y+$.y)/2,(k.y+D.y)/2),v=$.x,x=k.x)}else p=Math.min(f.y,l.y),m=Math.max(f.y,l.y),v=f.x,x=l.x}else p=Math.min(f.y,l.y),m=Math.max(f.y,l.y),v=f.x,x=l.x;switch(a){case"right":t.x=v,t.y=(p+m)/2,t.textAlign=Ie(t,"textAlign",h>0?"left":"right");break;case"left":t.x=x,t.y=(p+m)/2,t.textAlign=Ie(t,"textAlign",h>0?"left":"right");break;case"bottom":s&&(t.x=(v+x)/2),t.y=m,t.textAlign=Ie(t,"textAlign","center"),t.textBaseline=Ie(t,"textBaseline",h>0?"bottom":"top");break;case"middle":s&&(t.x=(v+x)/2),t.y=(p+m)/2,t.textAlign=Ie(t,"textAlign","center"),t.textBaseline=Ie(t,"textBaseline","middle");break;case"top":s&&(t.x=(v+x)/2),t.y=p,t.textAlign=Ie(t,"textAlign","center"),t.textBaseline=Ie(t,"textBaseline",h>0?"bottom":"top");break}},r}(OI),HA=Math.PI/2,yJ=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getLabelOffset=function(t){var n=this.getCoordinate(),i=0;if(xi(t))i=t;else if(ei(t)&&t.indexOf("%")!==-1){var a=n.getRadius();n.innerRadius>0&&(a=a*(1-n.innerRadius)),i=parseFloat(t)*.01*a}return i},r.prototype.getLabelItems=function(t){var n=e.prototype.getLabelItems.call(this,t),i=this.geometry.getYScale();return gu(n,function(a){if(a&&i){var o=i.scale(Ie(a.data,i.field));return Xe(Xe({},a),{percent:o})}return a})},r.prototype.getLabelAlign=function(t){var n=this.getCoordinate(),i;if(t.labelEmit)i=t.angle<=Math.PI/2&&t.angle>=-Math.PI/2?"left":"right";else if(!n.isTransposed)i="center";else{var a=n.getCenter(),o=t.offset;Math.abs(t.x-a.x)<1?i="center":t.angle>Math.PI||t.angle<=0?i=o>0?"left":"right":i=o>0?"right":"left"}return i},r.prototype.getLabelPoint=function(t,n,i){var a=1,o,s=t.content[i];this.isToMiddle(n)?o=this.getMiddlePoint(n.points):(t.content.length===1&&i===0?i=1:i===0&&(a=-1),o=this.getArcPoint(n,i));var u=t.offset*a,l=this.getPointAngle(o),f=t.labelEmit,h=this.getCirclePoint(l,u,o,f);return h.r===0?h.content="":(h.content=s,h.angle=l,h.color=n.color),h.rotate=t.autoRotate?this.getLabelRotate(l,u,f):t.rotate,h.start={x:o.x,y:o.y},h},r.prototype.getArcPoint=function(t,n){return n===void 0&&(n=0),!ar(t.x)&&!ar(t.y)?{x:t.x,y:t.y}:{x:ar(t.x)?t.x[n]:t.x,y:ar(t.y)?t.y[n]:t.y}},r.prototype.getPointAngle=function(t){return p2(this.getCoordinate(),t)},r.prototype.getCirclePoint=function(t,n,i,a){var o=this.getCoordinate(),s=o.getCenter(),u=kI(o,i);if(u===0)return Xe(Xe({},s),{r:u});var l=t;if(o.isTransposed&&u>n&&!a){var f=Math.asin(n/(2*u));l=t+f*2}else u=u+n;return{x:s.x+u*Math.cos(l),y:s.y+u*Math.sin(l),r:u}},r.prototype.getLabelRotate=function(t,n,i){var a=t+HA;return i&&(a-=HA),a&&(a>HA?a=a-Math.PI:a<-HA&&(a=a+Math.PI)),a},r.prototype.getMiddlePoint=function(t){var n=this.getCoordinate(),i=t.length,a={x:0,y:0};return we(t,function(o){a.x+=o.x,a.y+=o.y}),a.x/=i,a.y/=i,a=n.convert(a),a},r.prototype.isToMiddle=function(t){return t.x.length>2},r}(OI),FEe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.defaultLayout="distribute",t}return r.prototype.getDefaultLabelCfg=function(t,n){var i=e.prototype.getDefaultLabelCfg.call(this,t,n);return yn({},i,Ie(this.geometry.theme,"pieLabels",{}))},r.prototype.getLabelOffset=function(t){return e.prototype.getLabelOffset.call(this,t)||0},r.prototype.getLabelRotate=function(t,n,i){var a;return n<0&&(a=t,a>Math.PI/2&&(a=a-Math.PI),a<-Math.PI/2&&(a=a+Math.PI)),a},r.prototype.getLabelAlign=function(t){var n=this.getCoordinate(),i=n.getCenter(),a;return t.angle<=Math.PI/2&&t.x>=i.x?a="left":a="right",t.offset<=0&&(a==="right"?a="left":a="right"),a},r.prototype.getArcPoint=function(t){return t},r.prototype.getPointAngle=function(t){var n=this.getCoordinate(),i={x:ar(t.x)?t.x[0]:t.x,y:t.y[0]},a={x:ar(t.x)?t.x[1]:t.x,y:t.y[1]},o,s=p2(n,i);if(t.points&&t.points[0].y===t.points[1].y)o=s;else{var u=p2(n,a);s>=u&&(u=u+Math.PI*2),o=s+(u-s)/2}return o},r.prototype.getCirclePoint=function(t,n){var i=this.getCoordinate(),a=i.getCenter(),o=i.getRadius()+n;return Xe(Xe({},il(a.x,a.y,o,t)),{angle:t,r:o})},r}(yJ),kz=4;function DEe(e,r,t,n,i,a){var o,s,u=!0,l=n.start,f=n.end,h=Math.min(l.y,f.y),p=Math.abs(l.y-f.y),v,m=0,x=Number.MIN_VALUE,E=r.map(function(j){return j.y>m&&(m=j.y),j.y<x&&(x=j.y),{size:t,targets:[j.y-h]}});for(x-=h,m-h>p&&(p=m-h);u;)for(E.forEach(function(j){var H=(Math.min.apply(x,j.targets)+Math.max.apply(x,j.targets))/2;j.pos=Math.min(Math.max(x,H-j.size/2),p-j.size)}),u=!1,v=E.length;v--;)if(v>0){var A=E[v-1],L=E[v];A.pos+A.size>L.pos&&(A.size+=L.size,A.targets=A.targets.concat(L.targets),A.pos+A.size>p&&(A.pos=p-A.size),E.splice(v,1),u=!0)}v=0,E.forEach(function(j){var H=h+t/2;j.targets.forEach(function(){r[v].y=j.pos+H,H+=t,v++})});var k={};try{for(var R=so(e),D=R.next();!D.done;D=R.next()){var $=D.value;k[$.get("id")]=$}}catch(j){o={error:j}}finally{try{D&&!D.done&&(s=R.return)&&s.call(R)}finally{if(o)throw o.error}}r.forEach(function(j){var H=j.r*j.r,ee=Math.pow(Math.abs(j.y-i.y),2);if(H<ee)j.x=i.x;else{var U=Math.sqrt(H-ee);a?j.x=i.x+U:j.x=i.x-U}var W=k[j.id];W.attr("x",j.x),W.attr("y",j.y);var Q=$d(W.getChildren(),function(te){return te.get("type")==="text"});Q&&(Q.attr("y",j.y),Q.attr("x",j.x))})}function BEe(e,r,t,n){if(!(!e.length||!r.length)){var i=e[0]?e[0].offset:0,a=r[0].get("coordinate"),o=a.getRadius(),s=a.getCenter();if(i>0){var u=14,l=o+i,f=l*2+u*2,h={start:a.start,end:a.end},p=[[],[]];e.forEach(function(v){!v||(v.textAlign==="right"?p[0].push(v):p[1].push(v))}),p.forEach(function(v,m){var x=f/u;v.length>x&&(v.sort(function(E,A){return A["..percent"]-E["..percent"]}),v.splice(x,v.length-x)),v.sort(function(E,A){return E.y-A.y}),DEe(r,v,u,h,s,m)})}we(e,function(v){if(v&&v.labelLine){var m=v.offset,x=v.angle,E=il(s.x,s.y,o,x),A=il(s.x,s.y,o+m/2,x),L=v.x+Ie(v,"offsetX",0),k=v.y+Ie(v,"offsetY",0),R={x:L-Math.cos(x)*kz,y:k-Math.sin(x)*kz};xo(v.labelLine)||(v.labelLine={}),v.labelLine.path=["M ".concat(E.x),"".concat(E.y," Q").concat(A.x),"".concat(A.y," ").concat(R.x),R.y].join(",")}})}}function _J(e,r,t){var n=e.filter(function(m){return!m.invisible});n.sort(function(m,x){return m.y-x.y});var i=!0,a=t.minY,o=t.maxY,s=Math.abs(a-o),u,l=0,f=Number.MIN_VALUE,h=n.map(function(m){return m.y>l&&(l=m.y),m.y<f&&(f=m.y),{content:m.content,size:r,targets:[m.y-a],pos:null}});for(f-=a,l-a>s&&(s=l-a);i;)for(h.forEach(function(m){var x=(Math.min.apply(f,m.targets)+Math.max.apply(f,m.targets))/2;m.pos=Math.min(Math.max(f,x-m.size/2),s-m.size),m.pos=Math.max(0,m.pos)}),i=!1,u=h.length;u--;)if(u>0){var p=h[u-1],v=h[u];p.pos+p.size>v.pos&&(p.size+=v.size,p.targets=p.targets.concat(v.targets),p.pos+p.size>s&&(p.pos=s-p.size),h.splice(u,1),i=!0)}u=0,h.forEach(function(m){var x=a+r/2;m.targets.forEach(function(){n[u].y=m.pos+x,x+=r,u++})})}var Pz=4;function NEe(e,r){var t=r.getCenter(),n=r.getRadius();if(e&&e.labelLine){var i=e.angle,a=e.offset,o=il(t.x,t.y,n,i),s=e.x+Ie(e,"offsetX",0)*(Math.cos(i)>0?1:-1),u=e.y+Ie(e,"offsetY",0)*(Math.sin(i)>0?1:-1),l={x:s-Math.cos(i)*Pz,y:u-Math.sin(i)*Pz},f=e.labelLine.smooth,h=[],p=l.x-t.x,v=l.y-t.y,m=Math.atan(v/p);if(p<0&&(m+=Math.PI),f===!1){xo(e.labelLine)||(e.labelLine={});var x=0;(i<0&&i>-Math.PI/2||i>Math.PI*1.5)&&l.y>o.y&&(x=1),i>=0&&i<Math.PI/2&&l.y>o.y&&(x=1),i>=Math.PI/2&&i<Math.PI&&o.y>l.y&&(x=1),(i<-Math.PI/2||i>=Math.PI&&i<Math.PI*1.5)&&o.y>l.y&&(x=1);var E=a/2>4?4:Math.max(a/2-1,0),A=il(t.x,t.y,n+E,i),L=il(t.x,t.y,n+a/2,m),k=0;h.push("M ".concat(o.x," ").concat(o.y)),h.push("L ".concat(A.x," ").concat(A.y)),h.push("A ".concat(t.x," ").concat(t.y," 0 ").concat(k," ").concat(x," ").concat(L.x," ").concat(L.y)),h.push("L ".concat(l.x," ").concat(l.y))}else{var A=il(t.x,t.y,n+(a/2>4?4:Math.max(a/2-1,0)),i),R=o.x<t.x?1:-1;h.push("M ".concat(l.x," ").concat(l.y));var D=(o.y-t.y)/(o.x-t.x),$=(l.y-t.y)/(l.x-t.x);Math.abs(D-$)>Math.pow(Math.E,-16)&&h.push.apply(h,["C",l.x+R*4,l.y,2*A.x-o.x,2*A.y-o.y,o.x,o.y]),h.push("L ".concat(o.x," ").concat(o.y))}e.labelLine.path=h.join(" ")}}function zEe(e,r,t,n){var i,a,o=kc(e,function(H){return!rr(H)}),s=r[0]&&r[0].get("coordinate");if(!!s){var u=s.getCenter(),l=s.getRadius(),f={};try{for(var h=so(r),p=h.next();!p.done;p=h.next()){var v=p.value;f[v.get("id")]=v}}catch(H){i={error:H}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}var m=Ie(o[0],"labelHeight",14),x=Ie(o[0],"offset",0);if(!(x<=0)){var E="left",A="right",L=lp(o,function(H){return H.x<u.x?E:A}),k=s.start,R=s.end,D=Math.min((l+x+m)*2,s.getHeight()),$=D/2,j={minX:k.x,maxX:R.x,minY:u.y-$,maxY:u.y+$};we(L,function(H,ee){var U=Math.floor(D/m);H.length>U&&(H.sort(function(W,Q){return Q.percent-W.percent}),we(H,function(W,Q){Q+1>U&&(f[W.id].set("visible",!1),W.invisible=!0)})),_J(H,m,j)}),we(L,function(H,ee){we(H,function(U){var W=ee===A,Q=f[U.id],te=Q.getChildByIndex(0);if(te){var ie=l+x,ve=U.y-u.y,me=Math.pow(ie,2),Re=Math.pow(ve,2),We=me-Re>0?me-Re:0,je=Math.sqrt(We),lt=Math.abs(Math.cos(U.angle)*ie);W?U.x=u.x+Math.max(je,lt):U.x=u.x-Math.max(je,lt)}te&&(te.attr("y",U.y),te.attr("x",U.x)),NEe(U,s)})})}}}var C5=4,$Ee=4,Rz=4;function UEe(e,r,t){var n=r.getCenter(),i=r.getRadius(),a={x:e.x-(t?Rz:-Rz),y:e.y},o=il(n.x,n.y,i+C5,e.angle),s={x:a.x,y:a.y},u={x:o.x,y:o.y},l=il(n.x,n.y,i,e.angle),f="";if(a.y!==o.y){var h=t?4:-4;s.y=a.y,e.angle<0&&e.angle>=-Math.PI/2&&(s.x=Math.max(o.x,a.x-h),a.y<o.y?u.y=s.y:(u.y=o.y,u.x=Math.max(u.x,s.x-h))),e.angle>0&&e.angle<Math.PI/2&&(s.x=Math.max(o.x,a.x-h),a.y>o.y?u.y=s.y:(u.y=o.y,u.x=Math.max(u.x,s.x-h))),e.angle>Math.PI/2&&(s.x=Math.min(o.x,a.x-h),a.y>o.y?u.y=s.y:(u.y=o.y,u.x=Math.min(u.x,s.x-h))),e.angle<-Math.PI/2&&(s.x=Math.min(o.x,a.x-h),a.y<o.y?u.y=s.y:(u.y=o.y,u.x=Math.min(u.x,s.x-h)))}f=["M ".concat(a.x,",").concat(a.y),"L ".concat(s.x,",").concat(s.y),"L ".concat(u.x,",").concat(u.y),"L ".concat(o.x,",").concat(o.y),"L ".concat(l.x,",").concat(l.y)].join(" "),e.labelLine=yn({},e.labelLine,{path:f})}function VEe(e,r,t,n){var i,a,o=r[0]&&r[0].get("coordinate");if(!!o){var s=o.getCenter(),u=o.getRadius(),l={};try{for(var f=so(r),h=f.next();!h.done;h=f.next()){var p=h.value;l[p.get("id")]=p}}catch(H){i={error:H}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}var v=Ie(e[0],"labelHeight",14),m=Math.max(Ie(e[0],"offset",0),C5);we(e,function(H){if(!!H){var ee=Ie(l,[H.id]);if(!!ee){var U=H.x>s.x||H.x===s.x&&H.y>s.y,W=rr(H.offsetX)?$Ee:H.offsetX,Q=il(s.x,s.y,u+C5,H.angle),te=m+W;H.x=s.x+(U?1:-1)*(u+te),H.y=Q.y}}});var x=o.start,E=o.end,A="left",L="right",k=lp(e,function(H){return H.x<s.x?A:L}),R=(u+m)*2+v;we(k,function(H){var ee=H.length*v;ee>R&&(R=Math.min(ee,Math.abs(x.y-E.y)))});var D={minX:x.x,maxX:E.x,minY:s.y-R/2,maxY:s.y+R/2};we(k,function(H,ee){var U=R/v;H.length>U&&(H.sort(function(W,Q){return Q.percent-W.percent}),we(H,function(W,Q){Q>U&&(l[W.id].set("visible",!1),W.invisible=!0)})),_J(H,v,D)});var $=D.minY,j=D.maxY;we(k,function(H,ee){var U=ee===L;we(H,function(W){var Q=Ie(l,W&&[W.id]);if(!!Q){if(W.y<$||W.y>j){Q.set("visible",!1);return}var te=Q.getChildByIndex(0),ie=te.getCanvasBBox(),ve={x:U?ie.x:ie.maxX,y:ie.y+ie.height/2};yS(te,W.x-ve.x,W.y-ve.y),W.labelLine&&UEe(W,o,U)}})})}}function GEe(e,r,t,n){we(r,function(i){var a=n.minX,o=n.minY,s=n.maxX,u=n.maxY,l=i.getCanvasBBox(),f=l.minX,h=l.minY,p=l.maxX,v=l.maxY,m=l.x,x=l.y,E=l.width,A=l.height,L=m,k=x;(f<a||p<a)&&(L=a),(h<o||v<o)&&(k=o),f>s?L=s-E:p>s&&(L=L-(p-s)),h>u?k=u-A:v>u&&(k=k-(v-u)),(L!==m||k!==x)&&yS(i,L-m,k-x)})}function HEe(e,r,t,n){we(r,function(i,a){var o=i.getCanvasBBox(),s=t[a].getBBox();(o.minX<s.minX||o.minY<s.minY||o.maxX>s.maxX||o.maxY>s.maxY)&&i.remove(!0)})}var jEe=100,xJ=function(){function e(r){r===void 0&&(r={}),this.bitmap={};var t=r.xGap,n=t===void 0?1:t,i=r.yGap,a=i===void 0?8:i;this.xGap=n,this.yGap=a}return e.prototype.hasGap=function(r){for(var t=!0,n=this.bitmap,i=Math.round(r.minX),a=Math.round(r.maxX),o=Math.round(r.minY),s=Math.round(r.maxY),u=i;u<=a;u+=1){if(!n[u]){n[u]={};continue}if(u===i||u===a){for(var l=o;l<=s;l++)if(n[u][l]){t=!1;break}}else if(n[u][o]||n[u][s]){t=!1;break}}return t},e.prototype.fillGap=function(r){for(var t=this.bitmap,n=Math.round(r.minX),i=Math.round(r.maxX),a=Math.round(r.minY),o=Math.round(r.maxY),s=n;s<=i;s+=1)t[s]||(t[s]={});for(var s=n;s<=i;s+=this.xGap){for(var u=a;u<=o;u+=this.yGap)t[s][u]=!0;t[s][o]=!0}if(this.yGap!==1)for(var s=a;s<=o;s+=1)t[n][s]=!0,t[i][s]=!0;if(this.xGap!==1)for(var s=n;s<=i;s+=1)t[s][a]=!0,t[s][o]=!0},e.prototype.destroy=function(){this.bitmap={}},e}();function WEe(e,r,t){t===void 0&&(t=jEe);var n=-1,i=e.attr(),a=i.x,o=i.y,s=e.getCanvasBBox(),u=Math.sqrt(s.width*s.width+s.height*s.height),l,f=-n,h=0,p=0,v=function(A){var L=A*.1;return[L*Math.cos(L),L*Math.sin(L)]};if(r.hasGap(s))return r.fillGap(s),!0;for(var m=!1,x=0,E={};Math.min(Math.abs(h),Math.abs(p))<u&&x<t;)if(l=v(f+=n),h=~~l[0],p=~~l[1],!(!h&&!p||E["".concat(h,"-").concat(p)])&&(e.attr({x:a+h,y:o+p}),h+p<0&&e.attr("textAlign","right"),x++,r.hasGap(e.getCanvasBBox()))){r.fillGap(e.getCanvasBBox()),m=!0,E["".concat(h,"-").concat(p)]=!0;break}return m}function XEe(e,r,t,n){var i=e.getCanvasBBox(),a=i.width,o=i.height,s={x:r,y:t,textAlign:"center"};switch(n){case 0:s.y-=o+1,s.x+=1,s.textAlign="left";break;case 1:s.y-=o+1,s.x-=1,s.textAlign="right";break;case 2:s.y+=o+1,s.x-=1,s.textAlign="right";break;case 3:s.y+=o+1,s.x+=1,s.textAlign="left";break;case 5:s.y-=o*2+2;break;case 6:s.y+=o*2+2;break;case 7:s.x+=a+1,s.textAlign="left";break;case 8:s.x-=a+1,s.textAlign="right";break}return e.attr(s),e.getCanvasBBox()}function YEe(e,r,t,n){var i=new xJ;we(r,function(a){var o=a.find(function(s){return s.get("type")==="text"});WEe(o,i)||a.remove(!0)}),i.destroy()}function ZEe(e,r,t,n){var i=new xJ;we(r,function(a){for(var o=a.find(function(v){return v.get("type")==="text"}),s=o.attr(),u=s.x,l=s.y,f=!1,h=0;h<=8;h++){var p=XEe(o,u,l,h);if(i.hasGap(p)){i.fillGap(p),f=!0;break}}f||a.remove(!0)}),i.destroy()}function qEe(e,r){return(e[0]||0)*(r[0]||0)+(e[1]||0)*(r[1]||0)+(e[2]||0)*(r[2]||0)}function Oz(e){if(e.length>4)return[];var r=function(i,a){return[a.x-i.x,a.y-i.y]},t=r(e[0],e[1]),n=r(e[1],e[2]);return[t,n]}function jA(e,r,t){r===void 0&&(r=0),t===void 0&&(t={x:0,y:0});var n=e.x,i=e.y;return{x:(n-t.x)*Math.cos(-r)+(i-t.y)*Math.sin(-r)+t.x,y:(t.x-n)*Math.sin(-r)+(i-t.y)*Math.cos(-r)+t.y}}function Fz(e){var r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],t=e.rotation;return t?[jA(r[0],t,r[0]),jA(r[1],t,r[0]),jA(r[2],t,r[0]),jA(r[3],t,r[0])]:r}function Dz(e,r){if(e.length>4)return{min:0,max:0};var t=[];return e.forEach(function(n){t.push(qEe([n.x,n.y],r))}),{min:Math.min.apply(Math,vu([],jn(t),!1)),max:Math.max.apply(Math,vu([],jn(t),!1))}}function KEe(e,r){return e.max>r.min&&e.min<r.max}function QEe(e){return typeof e=="number"&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0}function Bz(e){return["x","y","width","height"].every(function(r){return QEe(e[r])})}function JEe(e,r,t){return t===void 0&&(t=0),!(r.x>e.x+e.width+t||r.x+r.width<e.x-t||r.y>e.y+e.height+t||r.y+r.height<e.y-t)}function eSe(e,r,t){if(t===void 0&&(t=0),!Bz(e)||!Bz(r))return!1;if(!e.rotation&&!r.rotation)return JEe(e,r,t);for(var n=Fz(e),i=Fz(r),a=Oz(n).concat(Oz(i)),o=0;o<a.length;o++){var s=a[o],u=Dz(n,s),l=Dz(i,s);if(!KEe(u,l))return!1}return!0}var tSe=function(){function e(r){var t=this;this.queue=[],this.worker=new Worker(r),this.worker.onmessage=function(n){var i;(i=t.queue.shift())===null||i===void 0||i.resolve(n)},this.worker.onmessageerror=function(n){var i;console.warn("[AntV G2] Web worker is not available"),(i=t.queue.shift())===null||i===void 0||i.reject(n)}}return e.prototype.post=function(r,t){var n=this;return new Promise(function(i,a){n.queue.push({resolve:i,reject:a});try{n.worker.postMessage(r)}catch{console.warn("[AntV G2] Web worker is not available"),kn(t)&&t()}})},e.prototype.destroy=function(){this.worker.terminate()},e}();function rSe(e){if(typeof window!="undefined"){var r;try{r=new Blob([e.toString()],{type:"application/javascript"})}catch{r=new window.BlobBuilder,r.append(e.toString()),r=r.getBlob()}return new tSe(URL.createObjectURL(r))}}var nSe=function(e){function r(){function l(k,R){return(k[0]||0)*(R[0]||0)+(k[1]||0)*(R[1]||0)+(k[2]||0)*(R[2]||0)}function f(k){if(k.length>4)return[];var R=function(j,H){return[H.x-j.x,H.y-j.y]},D=R(k[0],k[1]),$=R(k[1],k[2]);return[D,$]}function h(k,R,D){R===void 0&&(R=0),D===void 0&&(D={x:0,y:0});var $=k.x,j=k.y;return{x:($-D.x)*Math.cos(-R)+(j-D.y)*Math.sin(-R)+D.x,y:(D.x-$)*Math.sin(-R)+(j-D.y)*Math.cos(-R)+D.y}}function p(k){var R=[{x:k.x,y:k.y},{x:k.x+k.width,y:k.y},{x:k.x+k.width,y:k.y+k.height},{x:k.x,y:k.y+k.height}],D=k.rotation;return D?[h(R[0],D,R[0]),h(R[1],D,R[0]),h(R[2],D,R[0]),h(R[3],D,R[0])]:R}function v(k,R){if(k.length>4)return{min:0,max:0};var D=[];return k.forEach(function($){D.push(l([$.x,$.y],R))}),{min:Math.min.apply(null,D),max:Math.max.apply(null,D)}}function m(k,R){return k.max>R.min&&k.min<R.max}function x(k){return typeof k=="number"&&!Number.isNaN(k)&&k!==1/0&&k!==-1/0}function E(k){return["x","y","width","height"].every(function(R){return x(k[R])})}function A(k,R,D){return D===void 0&&(D=0),!(R.x>k.x+k.width+D||R.x+R.width<k.x-D||R.y>k.y+k.height+D||R.y+R.height<k.y-D)}function L(k,R,D){if(D===void 0&&(D=0),!E(k)||!E(R))return!1;if(!k.rotation&&!R.rotation)return A(k,R,D);for(var $=p(k),j=p(R),H=f($).concat(f(j)),ee=0;ee<H.length;ee++){var U=H[ee],W=v($,U),Q=v(j,U);if(!m(W,Q))return!1}return!0}return{intersect:L}}var t=r().intersect;function n(l){for(var f=l.slice(),h=0;h<f.length;h++){var p=f[h];if(p.visible)for(var v=h+1;v<f.length;v++){var m=f[v];p!==m&&m.visible&&t(p,m)&&(m.visible=!1)}}return f}var i={"hide-overlap":n};try{var a=JSON.parse(e.data);if(!a||!a.type||!i[a.type])return;var o=a.type,s=a.items,u=i[o](s);self.postMessage(u)}catch(l){throw l}},iSe=`
   self.onmessage = `.concat(nSe.toString(),`
`),TR=function(e){for(var r=e.slice(),t=0;t<r.length;t++){var n=r[t];if(n.visible)for(var i=t+1;i<r.length;i++){var a=r[i];n!==a&&a.visible&&eSe(n,a)&&(a.visible=!1)}}return r},MR=new Map,Nz=rSe(iSe);function aSe(e,r,t,n){return tE(this,void 0,void 0,function(){var i,a,o,s,u,l;return rE(this,function(f){switch(f.label){case 0:return i=r.map(function(h,p){return Xe(Xe({},$Q(h,e[p],Ie(e[p],"background.padding"))),{visible:!0})}),a=JSON.stringify(i),o=function(h){return MR.set(a,h),we(h,function(p,v){var m=p.visible,x=r[v];m?x==null||x.show():x==null||x.hide()}),h},MR.get(a)?(o(MR.get(a)),[3,7]):[3,1];case 1:if(!Nz)return[3,6];f.label=2;case 2:return f.trys.push([2,4,,5]),s=JSON.stringify({type:"hide-overlap",items:i}),[4,Nz.post(s,function(){return o(TR(i))})];case 3:return u=f.sent(),o(Array.isArray(u.data)?u.data:[]),[3,5];case 4:return l=f.sent(),console.error(l),o(TR(i)),[3,5];case 5:return[3,7];case 6:o(TR(i)),f.label=7;case 7:return[2]}})})}var zz={"#5B8FF9":!0},oSe=function(e){var r=G0.toRGB(e).toUpperCase();if(zz[r])return zz[r];var t=jn(G0.rgb2arr(r),3),n=t[0],i=t[1],a=t[2],o=(n*299+i*587+a*114)/1e3<128;return o};function sSe(e,r,t){if(t.length!==0){var n=t[0].get("element"),i=n.geometry.theme,a=i.labels||{},o=a.fillColorLight,s=a.fillColorDark;t.forEach(function(u,l){var f=r[l],h=f.find(function(A){return A.get("type")==="text"}),p=sh.fromObject(u.getBBox()),v=sh.fromObject(h.getCanvasBBox()),m=!p.contains(v),x=u.attr("fill"),E=oSe(x);m?h.attr(i.overflowLabels.style):E?o&&h.attr("fill",o):s&&h.attr("fill",s)})}}function uSe(e,r,t){var n=e.coordinate,i=e_(r),a=sh.fromObject(i.getCanvasBBox()),o=sh.fromObject(t.getBBox());return n.isTransposed?o.height>=a.height:o.width>=a.width}function lSe(e,r,t){var n=!!e.getAdjust("stack");return n||r.every(function(i,a){var o=t[a];return uSe(e,i,o)})}function cSe(e,r,t){var n=e.coordinate,i=sh.fromObject(t.getBBox()),a=e_(r);n.isTransposed?a.attr({x:i.minX+i.width/2,textAlign:"center"}):a.attr({y:i.minY+i.height/2,textBaseline:"middle"})}function fSe(e,r,t){var n;if(t.length!==0){var i=(n=t[0])===null||n===void 0?void 0:n.get("element"),a=i==null?void 0:i.geometry;if(!(!a||a.type!=="interval")){var o=lSe(a,r,t);o&&t.forEach(function(s,u){var l=r[u];cSe(a,l,s)})}}}function hSe(e){var r=500,t=[],n=Math.max(Math.floor(e.length/r),1);return we(e,function(i,a){a%n===0?t.push(i):i.set("visible",!1)}),t}function pSe(e,r,t){var n;if(t.length!==0){var i=(n=t[0])===null||n===void 0?void 0:n.get("element"),a=i==null?void 0:i.geometry;if(!(!a||a.type!=="interval")){var o=hSe(r),s=jn(a.getXYFields(),1),u=s[0],l=[],f=[],h=lp(o,function(E){return E.get("data")[u]}),p=Z0(gu(o,function(E){return E.get("data")[u]})),v;o.forEach(function(E){E.set("visible",!0)});var m=function(E){E&&(E.length&&f.push(E.pop()),f.push.apply(f,vu([],jn(E),!1)))};for(zl(p)>0&&(v=p.shift(),m(h[v])),zl(p)>0&&(v=p.pop(),m(h[v])),we(p.reverse(),function(E){m(h[E])});f.length>0;){var x=f.shift();x.get("visible")&&(nwe(x,l)?x.set("visible",!1):l.push(x))}}}}function dSe(e,r){var t=e.getXYFields()[1],n=[],i=r.sort(function(a,o){return a.get("data")[t]-a.get("data")[t]});return i.length>0&&n.push(i.shift()),i.length>0&&n.push(i.pop()),n.push.apply(n,vu([],jn(i),!1)),n}function bJ(e,r,t){return e.some(function(n){return t(n,r)})}function vSe(e,r,t){t===void 0&&(t=0);var n=Math.max(0,Math.min(e.x+e.width+t,r.x+r.width+t)-Math.max(e.x-t,r.x-t)),i=Math.max(0,Math.min(e.y+e.height+t,r.y+r.height+t)-Math.max(e.y-t,r.y-t));return n*i}function $z(e,r){return bJ(e,r,function(t,n){var i=e_(t),a=e_(n);return vSe(i.getCanvasBBox(),a.getCanvasBBox(),2)>0})}function gSe(e,r,t,n,i){var a,o;if(t.length!==0){var s=(a=t[0])===null||a===void 0?void 0:a.get("element"),u=s==null?void 0:s.geometry;if(!(!u||u.type!=="point")){var l=jn(u.getXYFields(),2),f=l[0],h=l[1],p=lp(r,function(x){return x.get("data")[f]}),v=[],m=i&&i.offset||((o=e[0])===null||o===void 0?void 0:o.offset)||12;gu(p1(p).reverse(),function(x){for(var E=dSe(u,p[x]);E.length;){var A=E.shift(),L=e_(A);if(bJ(v,A,function(D,$){return D.get("data")[f]===$.get("data")[f]&&D.get("data")[h]===$.get("data")[h]})){L.set("visible",!1);continue}var k=$z(v,A),R=!1;if(k&&(L.attr("y",L.attr("y")+2*m),R=$z(v,A)),R){L.set("visible",!1);continue}v.push(A)}})}}}function mSe(e,r){var t=e.getXYFields()[1],n=[],i=r.sort(function(a,o){return a.get("data")[t]-a.get("data")[t]});return i.length>0&&n.push(i.shift()),i.length>0&&n.push(i.pop()),n.push.apply(n,vu([],jn(i),!1)),n}function wJ(e,r,t){return e.some(function(n){return t(n,r)})}function ySe(e,r,t){t===void 0&&(t=0);var n=Math.max(0,Math.min(e.x+e.width+t,r.x+r.width+t)-Math.max(e.x-t,r.x-t)),i=Math.max(0,Math.min(e.y+e.height+t,r.y+r.height+t)-Math.max(e.y-t,r.y-t));return n*i}function Uz(e,r){return wJ(e,r,function(t,n){var i=e_(t),a=e_(n);return ySe(i.getCanvasBBox(),a.getCanvasBBox(),2)>0})}function _Se(e,r,t,n,i){var a,o;if(t.length!==0){var s=(a=t[0])===null||a===void 0?void 0:a.get("element"),u=s==null?void 0:s.geometry;if(!(!u||["path","line","area"].indexOf(u.type)<0)){var l=jn(u.getXYFields(),2),f=l[0],h=l[1],p=lp(r,function(x){return x.get("data")[f]}),v=[],m=i&&i.offset||((o=e[0])===null||o===void 0?void 0:o.offset)||12;gu(p1(p).reverse(),function(x){for(var E=mSe(u,p[x]);E.length;){var A=E.shift(),L=e_(A);if(wJ(v,A,function(D,$){return D.get("data")[f]===$.get("data")[f]&&D.get("data")[h]===$.get("data")[h]})){L.set("visible",!1);continue}var k=Uz(v,A),R=!1;if(k&&(L.attr("y",L.attr("y")+2*m),R=Uz(v,A)),R){L.set("visible",!1);continue}v.push(A)}})}}}var LR;function xSe(){return LR||(LR=document.createElement("canvas").getContext("2d")),LR}var WA=v1(function(e,r){r===void 0&&(r={});var t=r.fontSize,n=r.fontFamily,i=r.fontWeight,a=r.fontStyle,o=r.fontVariant,s=xSe();return s.font=[a,o,i,"".concat(t,"px"),n].join(" "),s.measureText(ei(e)?e:"").width},function(e,r){return r===void 0&&(r={}),vu([e],jn(F2(r)),!1).join("")}),bSe=function(e,r,t){var n=16,i=WA("...",t),a;ei(e)?a=e:a=v_(e);var o=r,s=[],u,l;if(WA(e,t)<=r)return e;for(;u=a.substr(0,n),l=WA(u,t),!(l+i>o&&l>o);)if(s.push(u),o-=l,a=a.substr(n),!a)return s.join("");for(;u=a.substr(0,1),l=WA(u,t),!(l+i>o);)if(s.push(u),o-=l,a=a.substr(1),!a)return s.join("");return"".concat(s.join(""),"...")};function wSe(e,r,t,n,i){if(!(r.length<=0)){var a=(i==null?void 0:i.direction)||["top","right","bottom","left"],o=(i==null?void 0:i.action)||"translate",s=(i==null?void 0:i.margin)||0,u=r[0].get("coordinate");if(!!u){var l=Xbe(u,s),f=l.minX,h=l.minY,p=l.maxX,v=l.maxY;we(r,function(m){var x=m.getCanvasBBox(),E=x.minX,A=x.minY,L=x.maxX,k=x.maxY,R=x.x,D=x.y,$=x.width,j=x.height,H=R,ee=D;if(a.indexOf("left")>=0&&(E<f||L<f)&&(H=f),a.indexOf("top")>=0&&(A<h||k<h)&&(ee=h),a.indexOf("right")>=0&&(E>p?H=p-$:L>p&&(H=H-(L-p))),a.indexOf("bottom")>=0&&(A>v?ee=v-j:k>v&&(ee=ee-(k-v))),H!==R||ee!==D){var U=H-R;if(o==="translate")yS(m,U,ee-D);else if(o==="ellipsis"){var W=m.findAll(function(Q){return Q.get("type")==="text"});W.forEach(function(Q){var te=lS(Q.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),ie=Q.getCanvasBBox(),ve=bSe(Q.attr("text"),ie.width-Math.abs(U),te);Q.attr("text",ve)})}else m.hide()}})}}}function CSe(e,r,t){var n={fillOpacity:rr(e.attr("fillOpacity"))?1:e.attr("fillOpacity"),strokeOpacity:rr(e.attr("strokeOpacity"))?1:e.attr("strokeOpacity"),opacity:rr(e.attr("opacity"))?1:e.attr("opacity")};e.attr({fillOpacity:0,strokeOpacity:0,opacity:0}),e.animate(n,r)}function ESe(e,r,t){var n={fillOpacity:0,strokeOpacity:0,opacity:0},i=r.easing,a=r.duration,o=r.delay;e.animate(n,a,i,function(){e.remove(!0)},o)}function SSe(e,r,t){var n,i=jn(r,2),a=i[0],o=i[1];return e.applyToMatrix([a,o,1]),t==="x"?(e.setMatrix(yl(e.getMatrix(),[["t",-a,-o],["s",.01,1],["t",a,o]])),n=yl(e.getMatrix(),[["t",-a,-o],["s",100,1],["t",a,o]])):t==="y"?(e.setMatrix(yl(e.getMatrix(),[["t",-a,-o],["s",1,.01],["t",a,o]])),n=yl(e.getMatrix(),[["t",-a,-o],["s",1,100],["t",a,o]])):t==="xy"&&(e.setMatrix(yl(e.getMatrix(),[["t",-a,-o],["s",.01,.01],["t",a,o]])),n=yl(e.getMatrix(),[["t",-a,-o],["s",100,100],["t",a,o]])),n}function k4(e,r,t,n,i){var a=t.start,o=t.end,s=t.getWidth(),u=t.getHeight(),l,f;i==="y"?(l=a.x+s/2,f=n.y<a.y?n.y:a.y):i==="x"?(l=n.x>a.x?n.x:a.x,f=a.y+u/2):i==="xy"&&(t.isPolar?(l=t.getCenter().x,f=t.getCenter().y):(l=(a.x+o.x)/2,f=(a.y+o.y)/2));var h=SSe(e,[l,f],i);e.animate({matrix:h},r)}function ASe(e,r,t){var n=t.coordinate,i=t.minYPoint;k4(e,r,n,i,"x")}function TSe(e,r,t){var n=t.coordinate,i=t.minYPoint;k4(e,r,n,i,"y")}function MSe(e,r,t){var n=t.coordinate,i=t.minYPoint;k4(e,r,n,i,"xy")}function LSe(e,r,t){var n=e.getTotalLength();e.attr("lineDash",[n]),e.animate(function(i){return{lineDashOffset:(1-i)*n}},r)}function ISe(e,r,t){var n=t.toAttrs,i=n.x,a=n.y;delete n.x,delete n.y,e.attr(n),e.animate({x:i,y:a},r)}function kSe(e,r,t){var n=e.getBBox(),i=e.get("origin").mappingData,a=i.points,o=a[0].y-a[1].y>0?n.maxX:n.minX,s=(n.minY+n.maxY)/2;e.applyToMatrix([o,s,1]);var u=yl(e.getMatrix(),[["t",-o,-s],["s",.01,1],["t",o,s]]);e.setMatrix(u),e.animate({matrix:yl(e.getMatrix(),[["t",-o,-s],["s",100,1],["t",o,s]])},r)}function PSe(e,r,t){var n=e.getBBox(),i=e.get("origin").mappingData,a=(n.minX+n.maxX)/2,o=i.points,s=o[0].y-o[1].y<=0?n.maxY:n.minY;e.applyToMatrix([a,s,1]);var u=yl(e.getMatrix(),[["t",-a,-s],["s",1,.01],["t",a,s]]);e.setMatrix(u),e.animate({matrix:yl(e.getMatrix(),[["t",-a,-s],["s",1,100],["t",a,s]])},r)}function Vz(e,r){var t,n=WM(e,r),i=n.startAngle,a=n.endAngle;return!ac(i,-Math.PI*.5)&&i<-Math.PI*.5&&(i+=Math.PI*2),!ac(a,-Math.PI*.5)&&a<-Math.PI*.5&&(a+=Math.PI*2),r[5]===0&&(t=jn([a,i],2),i=t[0],a=t[1]),ac(i,Math.PI*1.5)&&(i=Math.PI*-.5),ac(a,Math.PI*-.5)&&!ac(i,a)&&(a=Math.PI*1.5),{startAngle:i,endAngle:a}}function Gz(e){var r;return e[0]==="M"||e[0]==="L"?r=[e[1],e[2]]:(e[0]==="a"||e[0]==="A"||e[0]==="C")&&(r=[e[e.length-2],e[e.length-1]]),r}function Hz(e){var r,t,n,i=e.filter(function(k){return k[0]==="A"||k[0]==="a"});if(i.length===0)return{startAngle:0,endAngle:0,radius:0,innerRadius:0};var a=i[0],o=i.length>1?i[1]:i[0],s=e.indexOf(a),u=e.indexOf(o),l=Gz(e[s-1]),f=Gz(e[u-1]),h=Vz(l,a),p=h.startAngle,v=h.endAngle,m=Vz(f,o),x=m.startAngle,E=m.endAngle;ac(p,x)&&ac(v,E)?(t=p,n=v):(t=Math.min(p,x),n=Math.max(v,E));var A=a[1],L=i[i.length-1][1];return A<L?(r=jn([L,A],2),A=r[0],L=r[1]):A===L&&(L=0),{startAngle:t,endAngle:n,radius:A,innerRadius:L}}function RSe(e,r,t){var n=t.toAttrs,i=t.coordinate,a=n.path||[],o=a.map(function(L){return L[0]});if(!(a.length<1)){var s=Hz(a),u=s.startAngle,l=s.endAngle,f=s.radius,h=s.innerRadius,p=Hz(e.attr("path")),v=p.startAngle,m=p.endAngle,x=i.getCenter(),E=u-v,A=l-m;if(E===0&&A===0){e.attr("path",a);return}e.animate(function(L){var k=v+L*E,R=m+L*A;return Xe(Xe({},n),{path:rs(o,["M","A","A","Z"])?cQ(x.x,x.y,f,k,R):H0(x.x,x.y,f,k,R,h)})},Xe(Xe({},r),{callback:function(){e.attr("path",a)}}))}}function OSe(e,r,t){var n=s4(t.coordinate,20),i=n.type,a=n.startState,o=n.endState,s=e.setClip({type:i,attrs:a});t.toAttrs&&e.attr(t.toAttrs),s.animate(o,Xe(Xe({},r),{callback:function(){e&&!e.get("destroyed")&&e.set("clipShape",null),s.remove(!0)}}))}function P4(e,r,t){if(e.isGroup())we(e.getChildren(),function(s){P4(s,r,t)});else{var n=e.getBBox(),i=(n.minX+n.maxX)/2,a=(n.minY+n.maxY)/2;if(e.applyToMatrix([i,a,1]),t==="zoomIn"){var o=yl(e.getMatrix(),[["t",-i,-a],["s",.01,.01],["t",i,a]]);e.setMatrix(o),e.animate({matrix:yl(e.getMatrix(),[["t",-i,-a],["s",100,100],["t",i,a]])},r)}else e.animate({matrix:yl(e.getMatrix(),[["t",-i,-a],["s",.01,.01],["t",i,a]])},Xe(Xe({},r),{callback:function(){e.remove(!0)}}))}}function FSe(e,r,t){P4(e,r,"zoomIn")}function DSe(e,r,t){P4(e,r,"zoomOut")}function wy(e){return[en.TOP,en.BOTTOM].includes(e)?{offsetX:0,offsetY:e===en.TOP?-8:8,style:{textAlign:"center",textBaseline:e===en.TOP?"bottom":"top"}}:[en.LEFT,en.RIGHT].includes(e)?{offsetX:e===en.LEFT?-8:8,offsetY:0,style:{textAlign:e===en.LEFT?"right":"left",textBaseline:"middle",rotate:Math.PI/2}}:{}}function IR(e,r,t){return{x:e.x+r*Math.cos(t),y:e.y+r*Math.sin(t)}}var BSe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){return yn({},e.prototype.getDefaultCfg.call(this),{type:"circle",showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this)})},r.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},r.prototype.getRegion=function(t,n){var i=.5,a={x:.5,y:.5},o=Math.PI*2/t,s=-1*Math.PI/2+o*n,u=i/(1+1/Math.sin(o/2)),l=IR(a,i-u,s),f=Math.PI*5/4,h=Math.PI*1/4;return{start:IR(l,u,f),end:IR(l,u,h)}},r.prototype.afterEachView=function(t,n){this.processAxis(t,n)},r.prototype.beforeEachView=function(t,n){},r.prototype.generateFacets=function(t){var n=this,i=this.cfg,a=i.fields,o=i.type,s=jn(a,1),u=s[0];if(!u)throw new Error("No `fields` specified!");var l=this.getFieldValues(t,u),f=l.length,h=[];return l.forEach(function(p,v){var m=[{field:u,value:p,values:l}],x=kc(t,n.getFacetDataFilter(m)),E={type:o,data:x,region:n.getRegion(f,v),columnValue:p,columnField:u,columnIndex:v,columnValuesLength:f,rowValue:null,rowField:null,rowIndex:0,rowValuesLength:1};h.push(E)}),h},r.prototype.getXAxisOption=function(t,n,i,a){return i},r.prototype.getYAxisOption=function(t,n,i,a){return i},r.prototype.renderTitle=function(){var t=this;we(this.facets,function(n){var i=n.columnValue,a=n.view,o=Ie(t.cfg.title,"formatter"),s=yn({position:["50%","0%"],content:o?o(i):i},wy(en.TOP),t.cfg.title);a.annotation().text(s)})},r}($2),NSe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){return yn({},e.prototype.getDefaultCfg.call(this),{type:"list",cols:null,showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this)})},r.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},r.prototype.afterEachView=function(t,n){this.processAxis(t,n)},r.prototype.beforeEachView=function(t,n){},r.prototype.generateFacets=function(t){var n=this,i=this.cfg.fields,a=this.cfg.cols,o=jn(i,1),s=o[0];if(!s)throw new Error("No `fields` specified!");var u=this.getFieldValues(t,s),l=u.length;a=a||l;var f=this.getPageCount(l,a),h=[];return u.forEach(function(p,v){var m=n.getRowCol(v,a),x=m.row,E=m.col,A=[{field:s,value:p,values:u}],L=kc(t,n.getFacetDataFilter(A)),k={type:n.cfg.type,data:L,region:n.getRegion(f,a,E,x),columnValue:p,rowValue:p,columnField:s,rowField:null,columnIndex:E,rowIndex:x,columnValuesLength:a,rowValuesLength:f,total:l};h.push(k)}),h},r.prototype.getXAxisOption=function(t,n,i,a){return a.rowIndex!==a.rowValuesLength-1&&a.columnValuesLength*a.rowIndex+a.columnIndex+1+a.columnValuesLength<=a.total?Xe(Xe({},i),{label:null,title:null}):i},r.prototype.getYAxisOption=function(t,n,i,a){return a.columnIndex!==0?Xe(Xe({},i),{title:null,label:null}):i},r.prototype.renderTitle=function(){var t=this;we(this.facets,function(n){var i=n.columnValue,a=n.view,o=Ie(t.cfg.title,"formatter"),s=yn({position:["50%","0%"],content:o?o(i):i},wy(en.TOP),t.cfg.title);a.annotation().text(s)})},r.prototype.getPageCount=function(t,n){return Math.floor((t+n-1)/n)},r.prototype.getRowCol=function(t,n){var i=Math.floor(t/n),a=t%n;return{row:i,col:a}},r}($2),zSe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){return yn({},e.prototype.getDefaultCfg.call(this),{type:"matrix",showTitle:!1,columnTitle:Xe({},e.prototype.getDefaultTitleCfg.call(this)),rowTitle:Xe({},e.prototype.getDefaultTitleCfg.call(this))})},r.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},r.prototype.afterEachView=function(t,n){this.processAxis(t,n)},r.prototype.beforeEachView=function(t,n){},r.prototype.generateFacets=function(t){for(var n=this.cfg,i=n.fields,a=n.type,o=i.length,s=o,u=[],l=0;l<s;l++)for(var f=i[l],h=0;h<o;h++){var p=i[h],v={type:a,data:t,region:this.getRegion(o,s,l,h),columnValue:f,rowValue:p,columnField:f,rowField:p,columnIndex:l,rowIndex:h,columnValuesLength:s,rowValuesLength:o};u.push(v)}return u},r.prototype.getXAxisOption=function(t,n,i,a){return a.rowIndex!==a.rowValuesLength-1?Xe(Xe({},i),{label:null,title:null}):i},r.prototype.getYAxisOption=function(t,n,i,a){return a.columnIndex!==0?Xe(Xe({},i),{title:null,label:null}):i},r.prototype.renderTitle=function(){var t=this;we(this.facets,function(n,i){var a=n.columnIndex,o=n.rowIndex,s=n.columnValuesLength;n.rowValuesLength;var u=n.columnValue,l=n.rowValue,f=n.view;if(o===0){var h=Ie(t.cfg.columnTitle,"formatter"),p=yn({position:["50%","0%"],content:h?h(u):u},wy(en.TOP),t.cfg.columnTitle);f.annotation().text(p)}if(a===s-1){var h=Ie(t.cfg.rowTitle,"formatter"),p=yn({position:["100%","50%"],content:h?h(l):l},wy(en.RIGHT),t.cfg.rowTitle);f.annotation().text(p)}})},r}($2),$Se=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultCfg=function(){return yn({},e.prototype.getDefaultCfg.call(this),{type:"mirror",showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this),transpose:!1})},r.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},r.prototype.beforeEachView=function(t,n){this.cfg.transpose?n.columnIndex%2===0?t.coordinate().transpose().reflect("x"):t.coordinate().transpose():n.rowIndex%2!==0&&t.coordinate().reflect("y")},r.prototype.afterEachView=function(t,n){this.processAxis(t,n)},r.prototype.generateFacets=function(t){var n=this,i=jn(this.cfg.fields,1),a=i[0],o=[],s=1,u=1,l=[""],f=[""],h,p;return this.cfg.transpose?(h=a,l=this.getFieldValues(t,h).slice(0,2),s=l.length):(p=a,f=this.getFieldValues(t,p).slice(0,2),u=f.length),l.forEach(function(v,m){f.forEach(function(x,E){var A=[{field:h,value:v,values:l},{field:p,value:x,values:f}],L=kc(t,n.getFacetDataFilter(A)),k={type:n.cfg.type,data:L,region:n.getRegion(u,s,m,E),columnValue:v,rowValue:x,columnField:h,rowField:p,columnIndex:m,rowIndex:E,columnValuesLength:s,rowValuesLength:u};o.push(k)})}),o},r.prototype.getXAxisOption=function(t,n,i,a){return a.columnIndex===1||a.rowIndex===1?Xe(Xe({},i),{label:null,title:null}):i},r.prototype.getYAxisOption=function(t,n,i,a){return i},r.prototype.renderTitle=function(){var t=this;we(this.facets,function(n,i){var a=n.columnValue,o=n.rowValue,s=n.view,u=Ie(t.cfg.title,"formatter");if(t.cfg.transpose){var l=yn({position:["50%","0%"],content:u?u(a):a},wy(en.TOP),t.cfg.title);s.annotation().text(l)}else{var l=yn({position:["100%","50%"],content:u?u(o):o},wy(en.RIGHT),t.cfg.title);s.annotation().text(l)}})},r}($2),USe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.afterEachView=function(t,n){this.processAxis(t,n)},r.prototype.beforeEachView=function(t,n){},r.prototype.getDefaultCfg=function(){return yn({},e.prototype.getDefaultCfg.call(this),{type:"rect",columnTitle:Xe({},e.prototype.getDefaultTitleCfg.call(this)),rowTitle:Xe({},e.prototype.getDefaultTitleCfg.call(this))})},r.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},r.prototype.generateFacets=function(t){var n=this,i=jn(this.cfg.fields,2),a=i[0],o=i[1],s=[],u=1,l=1,f=[""],h=[""];return a&&(f=this.getFieldValues(t,a),u=f.length),o&&(h=this.getFieldValues(t,o),l=h.length),f.forEach(function(p,v){h.forEach(function(m,x){var E=[{field:a,value:p,values:f},{field:o,value:m,values:h}],A=kc(t,n.getFacetDataFilter(E)),L={type:n.cfg.type,data:A,region:n.getRegion(l,u,v,x),columnValue:p,rowValue:m,columnField:a,rowField:o,columnIndex:v,rowIndex:x,columnValuesLength:u,rowValuesLength:l};s.push(L)})}),s},r.prototype.renderTitle=function(){var t=this;we(this.facets,function(n,i){var a=n.columnIndex,o=n.rowIndex,s=n.columnValuesLength,u=n.columnValue,l=n.rowValue,f=n.view;if(o===0){var h=Ie(t.cfg.columnTitle,"formatter"),p=yn({position:["50%","0%"],content:h?h(u):u},wy(en.TOP),t.cfg.columnTitle);f.annotation().text(p)}if(a===s-1){var h=Ie(t.cfg.rowTitle,"formatter"),p=yn({position:["100%","50%"],content:h?h(l):l},wy(en.RIGHT),t.cfg.rowTitle);f.annotation().text(p)}})},r.prototype.getXAxisOption=function(t,n,i,a){return a.rowIndex!==a.rowValuesLength-1?Xe(Xe({},i),{title:null,label:null}):a.columnIndex!==Math.floor((a.columnValuesLength-1)/2)?Xe(Xe({},i),{title:null}):i},r.prototype.getYAxisOption=function(t,n,i,a){return a.columnIndex!==0?Xe(Xe({},i),{title:null,label:null}):a.rowIndex!==Math.floor((a.rowValuesLength-1)/2)?Xe(Xe({},i),{title:null}):i},r}($2),VSe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.afterChartRender=function(){t.facets&&t.cfg.line&&(t.container.clear(),t.drawLines(t.facets))},t}return r.prototype.afterEachView=function(t,n){this.processAxis(t,n)},r.prototype.beforeEachView=function(t,n){},r.prototype.init=function(){e.prototype.init.call(this),this.view.on(ra.AFTER_RENDER,this.afterChartRender)},r.prototype.getDefaultCfg=function(){return yn({},e.prototype.getDefaultCfg.call(this),{type:"tree",line:{style:{lineWidth:1,stroke:"#ddd"},smooth:!1},showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this)})},r.prototype.generateFacets=function(t){var n=this.cfg.fields;if(!n.length)throw new Error("Please specify for the fields for rootFacet!");var i=[],a={type:this.cfg.type,data:t,region:null,rowValuesLength:this.getRows(),columnValuesLength:1,rowIndex:0,columnIndex:0,rowField:"",columnField:"",rowValue:"",columnValue:""};return i.push(a),a.children=this.getChildFacets(t,1,i),this.setRegion(i),i},r.prototype.setRegion=function(t){var n=this;this.forceColIndex(t),t.forEach(function(i){i.region=n.getRegion(i.rowValuesLength,i.columnValuesLength,i.columnIndex,i.rowIndex)})},r.prototype.getRegion=function(t,n,i,a){var o=1/n,s=1/t,u={x:o*i,y:s*a},l={x:u.x+o,y:u.y+s*2/3};return{start:u,end:l}},r.prototype.forceColIndex=function(t){var n,i,a=this,o=[],s=0;t.forEach(function(m){a.isLeaf(m)&&(o.push(m),m.columnIndex=s,s++)}),o.forEach(function(m){m.columnValuesLength=o.length});for(var u=this.cfg.fields.length,l=u-1;l>=0;l--){var f=this.getFacetsByLevel(t,l);try{for(var h=(n=void 0,so(f)),p=h.next();!p.done;p=h.next()){var v=p.value;this.isLeaf(v)||(v.originColIndex=v.columnIndex,v.columnIndex=this.getRegionIndex(v.children),v.columnValuesLength=o.length)}}catch(m){n={error:m}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}},r.prototype.getFacetsByLevel=function(t,n){var i=[];return t.forEach(function(a){a.rowIndex===n&&i.push(a)}),i},r.prototype.getRegionIndex=function(t){var n=t[0],i=t[t.length-1];return(i.columnIndex-n.columnIndex)/2+n.columnIndex},r.prototype.isLeaf=function(t){return!t.children||!t.children.length},r.prototype.getRows=function(){return this.cfg.fields.length+1},r.prototype.getChildFacets=function(t,n,i){var a=this,o=this.cfg.fields,s=o.length;if(!(s<n)){var u=[],l=o[n-1],f=this.getFieldValues(t,l);return f.forEach(function(h,p){var v=[{field:l,value:h,values:f}],m=t.filter(a.getFacetDataFilter(v));if(m.length){var x={type:a.cfg.type,data:m,region:null,columnValue:h,rowValue:"",columnField:l,rowField:"",columnIndex:p,rowValuesLength:a.getRows(),columnValuesLength:1,rowIndex:n,children:a.getChildFacets(m,n+1,i)};u.push(x),i.push(x)}}),u}},r.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},r.prototype.renderTitle=function(){var t=this;we(this.facets,function(n){var i=n.columnValue,a=n.view,o=Ie(t.cfg.title,"formatter"),s=yn({position:["50%","0%"],content:o?o(i):i},wy(en.TOP),t.cfg.title);a.annotation().text(s)})},r.prototype.drawLines=function(t){var n=this;t.forEach(function(i){if(!n.isLeaf(i)){var a=i.children;n.addFacetLines(i,a)}})},r.prototype.addFacetLines=function(t,n){var i=this,a=t.view,o=a.coordinateBBox,s={x:o.x+o.width/2,y:o.y+o.height};n.forEach(function(u){var l=u.view.coordinateBBox,f={x:l.bl.x+(l.tr.x-l.bl.x)/2,y:l.tr.y},h={x:s.x,y:s.y+(f.y-s.y)/2},p={x:f.x,y:h.y};i.drawLine([s,h,p,f])})},r.prototype.getPath=function(t){var n=[],i=this.cfg.line.smooth;return i?(n.push(["M",t[0].x,t[0].y]),n.push(["C",t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y])):t.forEach(function(a,o){o===0?n.push(["M",a.x,a.y]):n.push(["L",a.x,a.y])}),n},r.prototype.drawLine=function(t){var n=this.getPath(t),i=this.cfg.line.style;this.container.addShape("path",{attrs:Na({path:n},i)})},r.prototype.getXAxisOption=function(t,n,i,a){return a.rowIndex!==a.rowValuesLength-1?Xe(Xe({},i),{title:null,label:null}):i},r.prototype.getYAxisOption=function(t,n,i,a){return a.originColIndex!==0&&a.columnIndex!==0?Xe(Xe({},i),{title:null,label:null}):i},r}($2);function jz(e){var r=vu([],jn(e),!1);r.sort(function(n,i){return n-i});var t=r.length;return t===0?0:t%2===1?r[(t-1)/2]:(r[t/2]+r[t/2-1])/2}function GSe(e){var r=cf(e,function(t,n){return t+=isNaN(n)||!xi(n)?0:n},0);return e.length===0?0:r/e.length}function XA(e,r){if(!r)return null;var t;switch(e){case"start":return 0;case"center":return .5;case"end":return 1;case"median":{t=r.isCategory?jz(r.values.map(function(n,i){return i})):jz(r.values);break}case"mean":{t=r.isCategory?(r.values.length-1)/2:GSe(r.values);break}case"min":t=r.isCategory?0:r[e];break;case"max":t=r.isCategory?r.values.length-1:r[e];break;default:t=e;break}return r.scale(t)}var YA=["regionFilter","shape"],HSe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;return n.cache=new Map,n.foregroundContainer=n.view.getLayer(Vu.FORE).addGroup(),n.backgroundContainer=n.view.getLayer(Vu.BG).addGroup(),n.option=[],n}return Object.defineProperty(r.prototype,"name",{get:function(){return"annotation"},enumerable:!1,configurable:!0}),r.prototype.init=function(){},r.prototype.layout=function(){this.update()},r.prototype.render=function(){},r.prototype.update=function(){var t=this;this.onAfterRender(function(){var i=new Map;we(t.option,function(a){if(Ug(YA,a.type)){var o=t.updateOrCreate(a);o&&i.set(t.getCacheKey(a),o)}}),t.cache=t.syncCache(i)});var n=new Map;we(this.option,function(i){if(!Ug(YA,i.type)){var a=t.updateOrCreate(i);a&&n.set(t.getCacheKey(i),a)}}),this.cache=this.syncCache(n)},r.prototype.clear=function(t){t===void 0&&(t=!1),e.prototype.clear.call(this),this.clearComponents(),this.foregroundContainer.clear(),this.backgroundContainer.clear(),t&&(this.option=[])},r.prototype.destroy=function(){this.clear(!0),this.foregroundContainer.remove(!0),this.backgroundContainer.remove(!0)},r.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(n){t.push(n)}),t},r.prototype.clearComponents=function(){this.getComponents().forEach(function(t){t.component.destroy()}),this.cache.clear()},r.prototype.onAfterRender=function(t){var n=!1;this.view.getOptions().animate&&this.view.geometries.forEach(function(i){i.animateOption&&(i.once(U0.AFTER_DRAW_ANIMATE,function(){t()}),n=!0)}),n||this.view.getRootView().once(ra.AFTER_RENDER,function(){t()})},r.prototype.createAnnotation=function(t){var n=t.type,i=z1e[g_(n)];if(i){var a=this.getAnnotationTheme(n),o=this.getAnnotationCfg(n,t,a);if(!o)return null;var s=new i(o);return{component:s,layer:this.isTop(o)?Vu.FORE:Vu.BG,direction:en.NONE,type:ic.ANNOTATION,extra:t}}},r.prototype.annotation=function(t){this.option.push(t)},r.prototype.arc=function(t){return this.annotation(Xe({type:"arc"},t)),this},r.prototype.image=function(t){return this.annotation(Xe({type:"image"},t)),this},r.prototype.line=function(t){return this.annotation(Xe({type:"line"},t)),this},r.prototype.region=function(t){return this.annotation(Xe({type:"region"},t)),this},r.prototype.text=function(t){return this.annotation(Xe({type:"text"},t)),this},r.prototype.dataMarker=function(t){return this.annotation(Xe({type:"dataMarker"},t)),this},r.prototype.dataRegion=function(t){this.annotation(Xe({type:"dataRegion"},t))},r.prototype.regionFilter=function(t){this.annotation(Xe({type:"regionFilter"},t))},r.prototype.shape=function(t){this.annotation(Xe({type:"shape"},t))},r.prototype.html=function(t){this.annotation(Xe({type:"html"},t))},r.prototype.parsePosition=function(t){var n,i,a=this.view.getXScale(),o=this.view.getScalesByDim("y"),s=kn(t)?t.call(null,a,o):t,u=0,l=0;if(ar(s)){var f=jn(s,2),h=f[0],p=f[1];if(ei(h)&&h.indexOf("%")!==-1&&!isNaN(h.slice(0,-1)))return this.parsePercentPosition(s);u=XA(h,a),l=XA(p,Object.values(o)[0])}else if(!rr(s))try{for(var v=so(p1(s)),m=v.next();!m.done;m=v.next()){var x=m.value,E=s[x];x===a.field&&(u=XA(E,a)),o[x]&&(l=XA(E,o[x]))}}catch(A){n={error:A}}finally{try{m&&!m.done&&(i=v.return)&&i.call(v)}finally{if(n)throw n.error}}return isNaN(u)||isNaN(l)?null:this.view.getCoordinate().convert({x:u,y:l})},r.prototype.getRegionPoints=function(t,n){var i=this,a=this.view.getXScale(),o=this.view.getScalesByDim("y"),s=Object.values(o)[0],u=a.field,l=this.view.getData(),f=ar(t)?t[0]:t[u],h=ar(n)?n[0]:n[u],p=[],v;return we(l,function(m,x){if(m[u]===f&&(v=x),x>=v){var E=i.parsePosition([m[u],m[s.field]]);E&&p.push(E)}if(m[u]===h)return!1}),p},r.prototype.parsePercentPosition=function(t){var n=parseFloat(t[0])/100,i=parseFloat(t[1])/100,a=this.view.getCoordinate(),o=a.start,s=a.end,u={x:Math.min(o.x,s.x),y:Math.min(o.y,s.y)},l=a.getWidth()*n+u.x,f=a.getHeight()*i+u.y;return{x:l,y:f}},r.prototype.getCoordinateBBox=function(){var t=this.view.getCoordinate(),n=t.start,i=t.end,a=t.getWidth(),o=t.getHeight(),s={x:Math.min(n.x,i.x),y:Math.min(n.y,i.y)};return{x:s.x,y:s.y,minX:s.x,minY:s.y,maxX:s.x+a,maxY:s.y+o,width:a,height:o}},r.prototype.getAnnotationCfg=function(t,n,i){var a=this,o=this.view.getCoordinate(),s=this.view.getCanvas(),u={};if(rr(n))return null;var l=n.start,f=n.end,h=n.position,p=this.parsePosition(l),v=this.parsePosition(f),m=this.parsePosition(h);if(["arc","image","line","region","regionFilter"].includes(t)&&(!p||!v))return null;if(["text","dataMarker","html"].includes(t)&&!m)return null;if(t==="arc"){var x=n;x.start,x.end;var E=tp(x,["start","end"]),A=p2(o,p),L=p2(o,v);A>L&&(L=Math.PI*2+L),u=Xe(Xe({},E),{center:o.getCenter(),radius:kI(o,p),startAngle:A,endAngle:L})}else if(t==="image"){var k=n;k.start,k.end;var E=tp(k,["start","end"]);u=Xe(Xe({},E),{start:p,end:v,src:n.src})}else if(t==="line"){var R=n;R.start,R.end;var E=tp(R,["start","end"]);u=Xe(Xe({},E),{start:p,end:v,text:Ie(n,"text",null)})}else if(t==="region"){var D=n;D.start,D.end;var E=tp(D,["start","end"]);u=Xe(Xe({},E),{start:p,end:v})}else if(t==="text"){var $=this.view.getData(),j=n;j.position;var H=j.content,E=tp(j,["position","content"]),ee=H;kn(H)&&(ee=H($)),u=Xe(Xe(Xe({},m),E),{content:ee})}else if(t==="dataMarker"){var U=n;U.position;var W=U.point,Q=U.line,te=U.text,ie=U.autoAdjust,ve=U.direction,E=tp(U,["position","point","line","text","autoAdjust","direction"]);u=Xe(Xe(Xe({},E),m),{coordinateBBox:this.getCoordinateBBox(),point:W,line:Q,text:te,autoAdjust:ie,direction:ve})}else if(t==="dataRegion"){var me=n,Re=me.start,We=me.end,je=me.region,te=me.text,lt=me.lineLength,E=tp(me,["start","end","region","text","lineLength"]);u=Xe(Xe({},E),{points:this.getRegionPoints(Re,We),region:je,text:te,lineLength:lt})}else if(t==="regionFilter"){var dt=n;dt.start,dt.end;var ct=dt.apply,Tt=dt.color,E=tp(dt,["start","end","apply","color"]),It=this.view.geometries,Lt=[],rn=function(Fn){!Fn||(Fn.isGroup()?Fn.getChildren().forEach(function(Ai){return rn(Ai)}):Lt.push(Fn))};we(It,function(Fn){ct?Ug(ct,Fn.type)&&we(Fn.elements,function(Ai){rn(Ai.shape)}):we(Fn.elements,function(Ai){rn(Ai.shape)})}),u=Xe(Xe({},E),{color:Tt,shapes:Lt,start:p,end:v})}else if(t==="shape"){var wn=n,zn=wn.render,Zt=tp(wn,["render"]),nn=function(Si){if(kn(n.render))return zn(Si,a.view,{parsePosition:a.parsePosition.bind(a)})};u=Xe(Xe({},Zt),{render:nn})}else if(t==="html"){var mn=n,zt=mn.html;mn.position;var Zt=tp(mn,["html","position"]),Vr=function(Fn){return kn(zt)?zt(Fn,a.view):zt};u=Xe(Xe(Xe({},Zt),m),{parent:s.get("el").parentNode,html:Vr})}var On=yn({},i,Xe(Xe({},u),{top:n.top,style:n.style,offsetX:n.offsetX,offsetY:n.offsetY}));return t!=="html"&&(On.container=this.getComponentContainer(On)),On.animate=this.view.getOptions().animate&&On.animate&&Ie(n,"animate",On.animate),On.animateOption=yn({},v2,On.animateOption,n.animateOption),On},r.prototype.isTop=function(t){return Ie(t,"top",!0)},r.prototype.getComponentContainer=function(t){return this.isTop(t)?this.foregroundContainer:this.backgroundContainer},r.prototype.getAnnotationTheme=function(t){return Ie(this.view.getTheme(),["components","annotation",t],{})},r.prototype.updateOrCreate=function(t){var n=this.cache.get(this.getCacheKey(t));if(n){var i=t.type,a=this.getAnnotationTheme(i),o=this.getAnnotationCfg(i,t,a);o&&ip(o,["container"]),n.component.update(Xe(Xe({},o||{}),{visible:!!o})),Ug(YA,t.type)&&n.component.render()}else n=this.createAnnotation(t),n&&(n.component.init(),Ug(YA,t.type)&&n.component.render());return n},r.prototype.syncCache=function(t){var n=this,i=new Map(this.cache);return t.forEach(function(a,o){i.set(o,a)}),i.forEach(function(a,o){$d(n.option,function(s){return o===n.getCacheKey(s)})||(a.component.destroy(),i.delete(o))}),i},r.prototype.getCacheKey=function(t){return t},r}(V2);function Wz(e,r){var t=yn({},Ie(e,["components","axis","common"]),Ie(e,["components","axis",r]));return Ie(t,["grid"],{})}function ZA(e,r,t,n){var i=[],a=r.getTicks();return e.isPolar&&a.push({value:1,text:"",tickValue:""}),a.reduce(function(o,s,u){var l=s.value;if(n)i.push({points:[e.convert(t==="y"?{x:0,y:l}:{x:l,y:0}),e.convert(t==="y"?{x:1,y:l}:{x:l,y:1})]});else if(u){var f=o.value,h=(f+l)/2;i.push({points:[e.convert(t==="y"?{x:0,y:h}:{x:h,y:0}),e.convert(t==="y"?{x:1,y:h}:{x:h,y:1})]})}return s},a[0]),i}function kR(e,r,t,n,i){var a=r.values.length,o=[],s=t.getTicks();return s.reduce(function(u,l){var f=u?u.value:l.value,h=l.value,p=(f+h)/2;return i==="x"?o.push({points:[e.convert({x:n?h:p,y:0}),e.convert({x:n?h:p,y:1})]}):o.push({points:gu(Array(a+1),function(v,m){return e.convert({x:m/a,y:n?h:p})})}),l},s[0]),o}function Xz(e,r){var t=Ie(r,"grid");if(t===null)return!1;var n=Ie(e,"grid");return!(t===void 0&&n===null)}var l0=["container"],Yz=Xe(Xe({},v2),{appear:null}),jSe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;return n.cache=new Map,n.gridContainer=n.view.getLayer(Vu.BG).addGroup(),n.gridForeContainer=n.view.getLayer(Vu.FORE).addGroup(),n.axisContainer=n.view.getLayer(Vu.BG).addGroup(),n.axisForeContainer=n.view.getLayer(Vu.FORE).addGroup(),n}return Object.defineProperty(r.prototype,"name",{get:function(){return"axis"},enumerable:!1,configurable:!0}),r.prototype.init=function(){},r.prototype.render=function(){this.update()},r.prototype.layout=function(){var t=this,n=this.view.getCoordinate();we(this.getComponents(),function(i){var a=i.component,o=i.direction,s=i.type,u=i.extra,l=u.dim,f=u.scale,h=u.alignTick,p;if(s===ic.AXIS)n.isPolar?l==="x"?p=n.isTransposed?DA(n,o):CR(n):l==="y"&&(p=n.isTransposed?CR(n):DA(n,o)):p=DA(n,o);else if(s===ic.GRID)if(n.isPolar){var v=void 0;n.isTransposed?v=l==="x"?kR(n,t.view.getYScales()[0],f,h,l):ZA(n,f,l,h):v=l==="x"?ZA(n,f,l,h):kR(n,t.view.getXScale(),f,h,l),p={items:v,center:t.view.getCoordinate().getCenter()}}else p={items:ZA(n,f,l,h)};a.update(p)})},r.prototype.update=function(){this.option=this.view.getOptions().axes;var t=new Map;this.updateXAxes(t),this.updateYAxes(t);var n=new Map;this.cache.forEach(function(i,a){t.has(a)?n.set(a,i):i.component.destroy()}),this.cache=n},r.prototype.clear=function(){e.prototype.clear.call(this),this.cache.clear(),this.gridContainer.clear(),this.gridForeContainer.clear(),this.axisContainer.clear(),this.axisForeContainer.clear()},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.gridContainer.remove(!0),this.gridForeContainer.remove(!0),this.axisContainer.remove(!0),this.axisForeContainer.remove(!0)},r.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(n){t.push(n)}),t},r.prototype.updateXAxes=function(t){var n=this.view.getXScale();if(!(!n||n.isIdentity)){var i=GM(this.option,n.field);if(i!==!1){var a=iz(i,en.BOTTOM),o=Vu.BG,s="x",u=this.view.getCoordinate(),l=this.getId("axis",n.field),f=this.getId("grid",n.field);if(u.isRect){var h=this.cache.get(l);if(h){var p=this.getLineAxisCfg(n,i,a);ip(p,l0),h.component.update(p),t.set(l,h)}else h=this.createLineAxis(n,i,o,a,s),this.cache.set(l,h),t.set(l,h);var v=this.cache.get(f);if(v){var p=this.getLineGridCfg(n,i,a,s);ip(p,l0),v.component.update(p),t.set(f,v)}else v=this.createLineGrid(n,i,o,a,s),v&&(this.cache.set(f,v),t.set(f,v))}else if(u.isPolar){var h=this.cache.get(l);if(h){var p=u.isTransposed?this.getLineAxisCfg(n,i,en.RADIUS):this.getCircleAxisCfg(n,i,a);ip(p,l0),h.component.update(p),t.set(l,h)}else{if(u.isTransposed){if(R0(i))return;h=this.createLineAxis(n,i,o,en.RADIUS,s)}else h=this.createCircleAxis(n,i,o,a,s);this.cache.set(l,h),t.set(l,h)}var v=this.cache.get(f);if(v){var p=u.isTransposed?this.getCircleGridCfg(n,i,en.RADIUS,s):this.getLineGridCfg(n,i,en.CIRCLE,s);ip(p,l0),v.component.update(p),t.set(f,v)}else{if(u.isTransposed){if(R0(i))return;v=this.createCircleGrid(n,i,o,en.RADIUS,s)}else v=this.createLineGrid(n,i,o,en.CIRCLE,s);v&&(this.cache.set(f,v),t.set(f,v))}}}}},r.prototype.updateYAxes=function(t){var n=this,i=this.view.getYScales();we(i,function(a,o){if(!(!a||a.isIdentity)){var s=a.field,u=GM(n.option,s);if(u!==!1){var l=Vu.BG,f="y",h=n.getId("axis",s),p=n.getId("grid",s),v=n.view.getCoordinate();if(v.isRect){var m=iz(u,o===0?en.LEFT:en.RIGHT),x=n.cache.get(h);if(x){var E=n.getLineAxisCfg(a,u,m);ip(E,l0),x.component.update(E),t.set(h,x)}else x=n.createLineAxis(a,u,l,m,f),n.cache.set(h,x),t.set(h,x);var A=n.cache.get(p);if(A){var E=n.getLineGridCfg(a,u,m,f);ip(E,l0),A.component.update(E),t.set(p,A)}else A=n.createLineGrid(a,u,l,m,f),A&&(n.cache.set(p,A),t.set(p,A))}else if(v.isPolar){var x=n.cache.get(h);if(x){var E=v.isTransposed?n.getCircleAxisCfg(a,u,en.CIRCLE):n.getLineAxisCfg(a,u,en.RADIUS);ip(E,l0),x.component.update(E),t.set(h,x)}else{if(v.isTransposed){if(R0(u))return;x=n.createCircleAxis(a,u,l,en.CIRCLE,f)}else x=n.createLineAxis(a,u,l,en.RADIUS,f);n.cache.set(h,x),t.set(h,x)}var A=n.cache.get(p);if(A){var E=v.isTransposed?n.getLineGridCfg(a,u,en.CIRCLE,f):n.getCircleGridCfg(a,u,en.RADIUS,f);ip(E,l0),A.component.update(E),t.set(p,A)}else{if(v.isTransposed){if(R0(u))return;A=n.createLineGrid(a,u,l,en.CIRCLE,f)}else A=n.createCircleGrid(a,u,l,en.RADIUS,f);A&&(n.cache.set(p,A),t.set(p,A))}}}}})},r.prototype.createLineAxis=function(t,n,i,a,o){var s={component:new Dbe(this.getLineAxisCfg(t,n,a)),layer:i,direction:a===en.RADIUS?en.NONE:a,type:ic.AXIS,extra:{dim:o,scale:t}};return s.component.set("field",t.field),s.component.init(),s},r.prototype.createLineGrid=function(t,n,i,a,o){var s=this.getLineGridCfg(t,n,a,o);if(s){var u={component:new Nbe(s),layer:i,direction:en.NONE,type:ic.GRID,extra:{dim:o,scale:t,alignTick:Ie(s,"alignTick",!0)}};return u.component.init(),u}},r.prototype.createCircleAxis=function(t,n,i,a,o){var s={component:new Bbe(this.getCircleAxisCfg(t,n,a)),layer:i,direction:a,type:ic.AXIS,extra:{dim:o,scale:t}};return s.component.set("field",t.field),s.component.init(),s},r.prototype.createCircleGrid=function(t,n,i,a,o){var s=this.getCircleGridCfg(t,n,a,o);if(s){var u={component:new zbe(s),layer:i,direction:en.NONE,type:ic.GRID,extra:{dim:o,scale:t,alignTick:Ie(s,"alignTick",!0)}};return u.component.init(),u}},r.prototype.getLineAxisCfg=function(t,n,i){var a=Ie(n,["top"])?this.axisForeContainer:this.axisContainer,o=this.view.getCoordinate(),s=DA(o,i),u=az(t,n),l=BA(this.view.getTheme(),i),f=Ie(n,["title"])?yn({title:{style:{text:u}}},{title:nz(this.view.getTheme(),i,n.title)},n):n,h=yn(Xe(Xe({container:a},s),{ticks:t.getTicks().map(function(k){return{id:"".concat(k.tickValue),name:k.text,value:k.value}}),verticalFactor:o.isPolar?rz(s,o.getCenter())*-1:rz(s,o.getCenter()),theme:l}),l,f),p=this.getAnimateCfg(h),v=p.animate,m=p.animateOption;h.animateOption=m,h.animate=v;var x=dQ(s),E=Ie(h,"verticalLimitLength",x?1/3:1/2);if(E<=1){var A=this.view.getCanvas().get("width"),L=this.view.getCanvas().get("height");h.verticalLimitLength=E*(x?A:L)}return h},r.prototype.getLineGridCfg=function(t,n,i,a){if(!!Xz(BA(this.view.getTheme(),i),n)){var o=Wz(this.view.getTheme(),i),s=yn({container:Ie(n,["top"])?this.gridForeContainer:this.gridContainer},o,Ie(n,"grid"),this.getAnimateCfg(n));return s.items=ZA(this.view.getCoordinate(),t,a,Ie(s,"alignTick",!0)),s}},r.prototype.getCircleAxisCfg=function(t,n,i){var a=Ie(n,["top"])?this.axisForeContainer:this.axisContainer,o=this.view.getCoordinate(),s=t.getTicks().map(function(x){return{id:"".concat(x.tickValue),name:x.text,value:x.value}});!t.isCategory&&Math.abs(o.endAngle-o.startAngle)===Math.PI*2&&s.pop();var u=az(t,n),l=BA(this.view.getTheme(),en.CIRCLE),f=Ie(n,["title"])?yn({title:{style:{text:u}}},{title:nz(this.view.getTheme(),i,n.title)},n):n,h=yn(Xe(Xe({container:a},CR(this.view.getCoordinate())),{ticks:s,verticalFactor:1,theme:l}),l,f),p=this.getAnimateCfg(h),v=p.animate,m=p.animateOption;return h.animate=v,h.animateOption=m,h},r.prototype.getCircleGridCfg=function(t,n,i,a){if(!!Xz(BA(this.view.getTheme(),i),n)){var o=Wz(this.view.getTheme(),en.RADIUS),s=yn({container:Ie(n,["top"])?this.gridForeContainer:this.gridContainer,center:this.view.getCoordinate().getCenter()},o,Ie(n,"grid"),this.getAnimateCfg(n)),u=Ie(s,"alignTick",!0),l=a==="x"?this.view.getYScales()[0]:this.view.getXScale();return s.items=kR(this.view.getCoordinate(),l,t,u,a),s}},r.prototype.getId=function(t,n){var i=this.view.getCoordinate();return"".concat(t,"-").concat(n,"-").concat(i.type)},r.prototype.getAnimateCfg=function(t){return{animate:this.view.getOptions().animate&&Ie(t,"animate"),animateOption:t&&t.animateOption?yn({},Yz,t.animateOption):Yz}},r}(V2);function B0(e,r,t){return t===en.TOP?[e.minX+e.width/2-r.width/2,e.minY]:t===en.BOTTOM?[e.minX+e.width/2-r.width/2,e.maxY-r.height]:t===en.LEFT?[e.minX,e.minY+e.height/2-r.height/2]:t===en.RIGHT?[e.maxX-r.width,e.minY+e.height/2-r.height/2]:t===en.TOP_LEFT||t===en.LEFT_TOP?[e.tl.x,e.tl.y]:t===en.TOP_RIGHT||t===en.RIGHT_TOP?[e.tr.x-r.width,e.tr.y]:t===en.BOTTOM_LEFT||t===en.LEFT_BOTTOM?[e.bl.x,e.bl.y-r.height]:t===en.BOTTOM_RIGHT||t===en.RIGHT_BOTTOM?[e.br.x-r.width,e.br.y-r.height]:[0,0]}function Zz(e,r){return Zx(e)?e===!1?!1:{}:Ie(e,[r],e)}function qA(e){return Ie(e,"position",en.BOTTOM)}var WSe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;return n.container=n.view.getLayer(Vu.FORE).addGroup(),n}return Object.defineProperty(r.prototype,"name",{get:function(){return"legend"},enumerable:!1,configurable:!0}),r.prototype.init=function(){},r.prototype.render=function(){this.update()},r.prototype.layout=function(){var t=this;this.layoutBBox=this.view.viewBBox,we(this.components,function(n){var i=n.component,a=n.direction,o=ER(a),s=i.get("maxWidthRatio"),u=i.get("maxHeightRatio"),l=t.getCategoryLegendSizeCfg(o,s,u),f=i.get("maxWidth"),h=i.get("maxHeight");i.update({maxWidth:Math.min(l.maxWidth,f||0),maxHeight:Math.min(l.maxHeight,h||0)});var p=i.get("padding"),v=i.getLayoutBBox(),m=new sh(v.x,v.y,v.width,v.height).expand(p),x=jn(B0(t.view.viewBBox,m,a),2),E=x[0],A=x[1],L=jn(B0(t.layoutBBox,m,a),2),k=L[0],R=L[1],D=0,$=0;a.startsWith("top")||a.startsWith("bottom")?(D=E,$=R):(D=k,$=A),i.setLocation({x:D+p[3],y:$+p[0]}),t.layoutBBox=t.layoutBBox.cut(m,a)})},r.prototype.update=function(){var t=this;this.option=this.view.getOptions().legends;var n={},i=function(p,v,m){var x=t.getId(m.field),E=t.getComponentById(x);if(E){var A=void 0,L=Zz(t.option,m.field);L!==!1&&(Ie(L,"custom")?A=t.getCategoryCfg(p,v,m,L,!0):m.isLinear?A=t.getContinuousCfg(p,v,m,L):m.isCategory&&(A=t.getCategoryCfg(p,v,m,L))),A&&(ip(A,["container"]),E.direction=qA(L),E.component.update(A),n[x]=!0)}else{var k=t.createFieldLegend(p,v,m);k&&(k.component.init(),t.components.push(k),n[x]=!0)}};if(Ie(this.option,"custom")){var a="global-custom",o=this.getComponentById(a);if(o){var s=this.getCategoryCfg(void 0,void 0,void 0,this.option,!0);ip(s,["container"]),o.component.update(s),n[a]=!0}else{var u=this.createCustomLegend(void 0,void 0,void 0,this.option);if(u){u.init();var l=Vu.FORE,f=qA(this.option);this.components.push({id:a,component:u,layer:l,direction:f,type:ic.LEGEND,extra:void 0}),n[a]=!0}}}else this.loopLegends(i);var h=[];we(this.getComponents(),function(p){n[p.id]?h.push(p):p.component.destroy()}),this.components=h},r.prototype.clear=function(){e.prototype.clear.call(this),this.container.clear()},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.container.remove(!0)},r.prototype.getGeometries=function(t){var n=this,i=t.geometries;return we(t.views,function(a){i=i.concat(n.getGeometries(a))}),i},r.prototype.loopLegends=function(t){var n=this.view.getRootView()===this.view;if(!!n){var i=this.getGeometries(this.view),a={};we(i,function(o){var s=o.getGroupAttributes();we(s,function(u){var l=u.getScale(u.type);!l||l.type==="identity"||a[l.field]||(t(o,u,l),a[l.field]=!0)})})}},r.prototype.createFieldLegend=function(t,n,i){var a,o=Zz(this.option,i.field),s=Vu.FORE,u=qA(o);if(o!==!1&&(Ie(o,"custom")?a=this.createCustomLegend(t,n,i,o):i.isLinear?a=this.createContinuousLegend(t,n,i,o):i.isCategory&&(a=this.createCategoryLegend(t,n,i,o))),a)return a.set("field",i.field),{id:this.getId(i.field),component:a,layer:s,direction:u,type:ic.LEGEND,extra:{scale:i}}},r.prototype.createCustomLegend=function(t,n,i,a){var o=this.getCategoryCfg(t,n,i,a,!0);return new J8(o)},r.prototype.createContinuousLegend=function(t,n,i,a){var o=this.getContinuousCfg(t,n,i,ip(a,["value"]));return new $be(o)},r.prototype.createCategoryLegend=function(t,n,i,a){var o=this.getCategoryCfg(t,n,i,a);return new J8(o)},r.prototype.getContinuousCfg=function(t,n,i,a){var o=i.getTicks(),s=$d(o,function(x){return x.value===0}),u=$d(o,function(x){return x.value===1}),l=o.map(function(x){var E=x.value,A=x.tickValue,L=n.mapping(i.invert(E)).join("");return{value:A,attrValue:L,color:L,scaleValue:E}});s||l.push({value:i.min,attrValue:n.mapping(i.invert(0)).join(""),color:n.mapping(i.invert(0)).join(""),scaleValue:0}),u||l.push({value:i.max,attrValue:n.mapping(i.invert(1)).join(""),color:n.mapping(i.invert(1)).join(""),scaleValue:1}),l.sort(function(x,E){return x.value-E.value});var f={min:up(l).value,max:al(l).value,colors:[],rail:{type:n.type},track:{}};n.type==="size"&&(f.track={style:{fill:n.type==="size"?this.view.getTheme().defaultColor:void 0}}),n.type==="color"&&(f.colors=l.map(function(x){return x.attrValue}));var h=this.container,p=qA(a),v=ER(p),m=Ie(a,"title");return m&&(m=yn({text:dE(i)},m)),f.container=h,f.layout=v,f.title=m,f.animateOption=v2,this.mergeLegendCfg(f,a,"continuous")},r.prototype.getCategoryCfg=function(t,n,i,a,o){var s=this.container,u=Ie(a,"position",en.BOTTOM),l=mz(this.view.getTheme(),u),f=Ie(l,["marker"]),h=Ie(a,"marker"),p=ER(u),v=Ie(l,["pageNavigator"]),m=Ie(a,"pageNavigator"),x=o?uwe(f,h,a.items):GQ(this.view,t,n,f,h),E=Ie(a,"title");E&&(E=yn({text:i?dE(i):""},E));var A=Ie(a,"maxWidthRatio"),L=Ie(a,"maxHeightRatio"),k=this.getCategoryLegendSizeCfg(p,A,L);k.container=s,k.layout=p,k.items=x,k.title=E,k.animateOption=v2,k.pageNavigator=yn({},v,m);var R=this.mergeLegendCfg(k,a,u);R.reversed&&R.items.reverse();var D=Ie(R,"maxItemWidth");return D&&D<=1&&(R.maxItemWidth=this.view.viewBBox.width*D),R},r.prototype.mergeLegendCfg=function(t,n,i){var a=i.split("-")[0],o=mz(this.view.getTheme(),a);return yn({},o,t,n)},r.prototype.getId=function(t){return"".concat(this.name,"-").concat(t)},r.prototype.getComponentById=function(t){return $d(this.components,function(n){return n.id===t})},r.prototype.getCategoryLegendSizeCfg=function(t,n,i){n===void 0&&(n=L7),i===void 0&&(i=L7);var a=this.view.viewBBox,o=a.width,s=a.height;return t==="vertical"?{maxWidth:o*n,maxHeight:s}:{maxWidth:o,maxHeight:s*i}},r}(V2),XSe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;return n.onChangeFn=ny,n.resetMeasure=function(){n.clear()},n.onValueChange=function(i){var a=jn(i,2),o=a[0],s=a[1];n.start=o,n.end=s,n.changeViewData(o,s)},n.container=n.view.getLayer(Vu.FORE).addGroup(),n.onChangeFn=nI(n.onValueChange,20,{leading:!0}),n.width=0,n.view.on(ra.BEFORE_CHANGE_DATA,n.resetMeasure),n.view.on(ra.BEFORE_CHANGE_SIZE,n.resetMeasure),n}return Object.defineProperty(r.prototype,"name",{get:function(){return"slider"},enumerable:!1,configurable:!0}),r.prototype.destroy=function(){e.prototype.destroy.call(this),this.view.off(ra.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(ra.BEFORE_CHANGE_SIZE,this.resetMeasure)},r.prototype.init=function(){},r.prototype.render=function(){this.option=this.view.getOptions().slider;var t=this.getSliderCfg(),n=t.start,i=t.end;rr(this.start)&&(this.start=n,this.end=i);var a=this.view.getOptions().data;this.option&&!uh(a)?this.slider?this.slider=this.updateSlider():(this.slider=this.createSlider(),this.slider.component.on("sliderchange",this.onChangeFn)):this.slider&&(this.slider.component.destroy(),this.slider=void 0)},r.prototype.layout=function(){var t=this;if(this.option&&!this.width&&(this.measureSlider(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.start,t.end)},0)),this.slider){var n=this.view.coordinateBBox.width,i=this.slider.component.get("padding"),a=jn(i,4),o=a[0];a[1],a[2];var s=a[3],u=this.slider.component.getLayoutBBox(),l=new sh(u.x,u.y,Math.min(u.width,n),u.height).expand(i),f=this.getMinMaxText(this.start,this.end),h=f.minText,p=f.maxText,v=jn(B0(this.view.viewBBox,l,en.BOTTOM),2);v[0];var m=v[1],x=jn(B0(this.view.coordinateBBox,l,en.BOTTOM),2),E=x[0];x[1],this.slider.component.update(Xe(Xe({},this.getSliderCfg()),{x:E+s,y:m+o,width:this.width,start:this.start,end:this.end,minText:h,maxText:p})),this.view.viewBBox=this.view.viewBBox.cut(l,en.BOTTOM)}},r.prototype.update=function(){this.render()},r.prototype.createSlider=function(){var t=this.getSliderCfg(),n=new Rbe(Xe({container:this.container},t));return n.init(),{component:n,layer:Vu.FORE,direction:en.BOTTOM,type:ic.SLIDER}},r.prototype.updateSlider=function(){var t=this.getSliderCfg();if(this.width){var n=this.getMinMaxText(this.start,this.end),i=n.minText,a=n.maxText;t=Xe(Xe({},t),{width:this.width,start:this.start,end:this.end,minText:i,maxText:a})}return this.slider.component.update(t),this.slider},r.prototype.measureSlider=function(){var t=this.getSliderCfg().width;this.width=t},r.prototype.getSliderCfg=function(){var t={height:16,start:0,end:1,minText:"",maxText:"",x:0,y:0,width:this.view.coordinateBBox.width};if(xo(this.option)){var n=Xe({data:this.getData()},Ie(this.option,"trendCfg",{}));t=yn({},t,this.getThemeOptions(),this.option),t=Xe(Xe({},t),{trendCfg:n})}return t.start=_s(Math.min(rr(t.start)?0:t.start,rr(t.end)?1:t.end),0,1),t.end=_s(Math.max(rr(t.start)?0:t.start,rr(t.end)?1:t.end),0,1),t},r.prototype.getData=function(){var t=this.view.getOptions().data,n=jn(this.view.getYScales(),1),i=n[0],a=this.view.getGroupScales();if(a.length){var o=a[0],s=o.field,u=o.ticks;return t.reduce(function(l,f){return f[s]===u[0]&&l.push(f[i.field]),l},[])}return t.map(function(l){return l[i.field]||0})},r.prototype.getThemeOptions=function(){var t=this.view.getTheme();return Ie(t,["components","slider","common"],{})},r.prototype.getMinMaxText=function(t,n){var i=this.view.getOptions().data,a=this.view.getXScale(),o=Gd(i,a.field);a.isLinear&&(o=o.sort());var s=o,u=zl(i);if(!a||!u)return{};var l=zl(s),f=Math.round(t*(l-1)),h=Math.round(n*(l-1)),p=Ie(s,[f]),v=Ie(s,[h]),m=this.getSliderCfg().formatter;return m&&(p=m(p,i[f],f),v=m(v,i[h],h)),{minText:p,maxText:v}},r.prototype.changeViewData=function(t,n){var i=this.view.getOptions().data,a=this.view.getXScale(),o=zl(i);if(!(!a||!o)){var s=Gd(i,a.field),u=this.view.getXScale().isLinear?s.sort(function(v,m){return Number(v)-Number(m)}):s,l=u,f=zl(l),h=Math.round(t*(f-1)),p=Math.round(n*(f-1));this.view.filter(a.field,function(v,m){var x=l.indexOf(v);return x>-1?jb(x,h,p):!0}),this.view.render(!0)}},r.prototype.getComponents=function(){return this.slider?[this.slider]:[]},r.prototype.clear=function(){this.slider&&(this.slider.component.destroy(),this.slider=void 0),this.width=0,this.start=void 0,this.end=void 0},r}(V2),KA=0,qz=8,YSe=32,ZSe=20,qSe=function(e){Rn(r,e);function r(t){var n=e.call(this,t)||this;return n.onChangeFn=ny,n.resetMeasure=function(){n.clear()},n.onValueChange=function(i){var a=i.ratio,o=n.getValidScrollbarCfg().animate;n.ratio=_s(a,0,1);var s=n.view.getOptions().animate;o||n.view.animate(!1),n.changeViewData(n.getScrollRange(),!0),n.view.animate(s)},n.container=n.view.getLayer(Vu.FORE).addGroup(),n.onChangeFn=nI(n.onValueChange,20,{leading:!0}),n.trackLen=0,n.thumbLen=0,n.ratio=0,n.view.on(ra.BEFORE_CHANGE_DATA,n.resetMeasure),n.view.on(ra.BEFORE_CHANGE_SIZE,n.resetMeasure),n}return Object.defineProperty(r.prototype,"name",{get:function(){return"scrollbar"},enumerable:!1,configurable:!0}),r.prototype.destroy=function(){e.prototype.destroy.call(this),this.view.off(ra.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(ra.BEFORE_CHANGE_SIZE,this.resetMeasure)},r.prototype.init=function(){},r.prototype.render=function(){this.option=this.view.getOptions().scrollbar,this.option?this.scrollbar?this.scrollbar=this.updateScrollbar():(this.scrollbar=this.createScrollbar(),this.scrollbar.component.on("scrollchange",this.onChangeFn)):this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0)},r.prototype.layout=function(){var t=this;if(this.option&&!this.trackLen&&(this.measureScrollbar(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.getScrollRange(),!0)})),this.scrollbar){var n=this.view.coordinateBBox.width,i=this.scrollbar.component.get("padding"),a=this.scrollbar.component.getLayoutBBox(),o=new sh(a.x,a.y,Math.min(a.width,n),a.height).expand(i),s=this.getScrollbarComponentCfg(),u=void 0,l=void 0;if(s.isHorizontal){var f=jn(B0(this.view.viewBBox,o,en.BOTTOM),2);f[0];var h=f[1],p=jn(B0(this.view.coordinateBBox,o,en.BOTTOM),2),v=p[0];p[1],u=v,l=h}else{var m=jn(B0(this.view.viewBBox,o,en.RIGHT),2);m[0];var h=m[1],x=jn(B0(this.view.viewBBox,o,en.RIGHT),2),v=x[0];x[1],u=v,l=h}u+=i[3],l+=i[0],this.trackLen?this.scrollbar.component.update(Xe(Xe({},s),{x:u,y:l,trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio})):this.scrollbar.component.update(Xe(Xe({},s),{x:u,y:l})),this.view.viewBBox=this.view.viewBBox.cut(o,s.isHorizontal?en.BOTTOM:en.RIGHT)}},r.prototype.update=function(){this.render()},r.prototype.getComponents=function(){return this.scrollbar?[this.scrollbar]:[]},r.prototype.clear=function(){this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0),this.trackLen=0,this.thumbLen=0,this.ratio=0,this.cnt=0,this.step=0,this.data=void 0,this.xScaleCfg=void 0,this.yScalesCfg=[]},r.prototype.setValue=function(t){this.onValueChange({ratio:t})},r.prototype.getValue=function(){return this.ratio},r.prototype.getThemeOptions=function(){var t=this.view.getTheme();return Ie(t,["components","scrollbar","common"],{})},r.prototype.getScrollbarTheme=function(t){var n=Ie(this.view.getTheme(),["components","scrollbar"]),i=t||{},a=i.thumbHighlightColor,o=tp(i,["thumbHighlightColor"]);return{default:yn({},Ie(n,["default","style"],{}),o),hover:yn({},Ie(n,["hover","style"],{}),{thumbColor:a})}},r.prototype.measureScrollbar=function(){var t=this.view.getXScale(),n=this.view.getYScales().slice();this.data=this.getScrollbarData(),this.step=this.getStep(),this.cnt=this.getCnt();var i=this.getScrollbarComponentCfg(),a=i.trackLen,o=i.thumbLen;this.trackLen=a,this.thumbLen=o,this.xScaleCfg={field:t.field,values:t.values||[]},this.yScalesCfg=n},r.prototype.getScrollRange=function(){var t=Math.floor((this.cnt-this.step)*_s(this.ratio,0,1)),n=Math.min(t+this.step-1,this.cnt-1);return[t,n]},r.prototype.changeViewData=function(t,n){var i=this,a=jn(t,2),o=a[0],s=a[1],u=this.getValidScrollbarCfg().type,l=u!=="vertical",f=Gd(this.data,this.xScaleCfg.field),h=this.view.getXScale().isLinear?f.sort(function(v,m){return Number(v)-Number(m)}):f,p=l?h:h.reverse();this.yScalesCfg.forEach(function(v){i.view.scale(v.field,{formatter:v.formatter,type:v.type,min:v.min,max:v.max,tickMethod:v.tickMethod})}),this.view.filter(this.xScaleCfg.field,function(v){var m=p.indexOf(v);return m>-1?jb(m,o,s):!0}),this.view.render(!0)},r.prototype.createScrollbar=function(){var t=this.getValidScrollbarCfg().type,n=t!=="vertical",i=new Fbe(Xe(Xe({container:this.container},this.getScrollbarComponentCfg()),{x:0,y:0}));return i.init(),{component:i,layer:Vu.FORE,direction:n?en.BOTTOM:en.RIGHT,type:ic.SCROLLBAR}},r.prototype.updateScrollbar=function(){var t=this.getScrollbarComponentCfg(),n=this.trackLen?Xe(Xe({},t),{trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio}):Xe({},t);return this.scrollbar.component.update(n),this.scrollbar},r.prototype.getStep=function(){if(this.step)return this.step;var t=this.view.coordinateBBox,n=this.getValidScrollbarCfg(),i=n.type,a=n.categorySize,o=i!=="vertical";return Math.floor((o?t.width:t.height)/a)},r.prototype.getCnt=function(){if(this.cnt)return this.cnt;var t=this.view.getXScale(),n=this.getScrollbarData(),i=Gd(n,t.field);return zl(i)},r.prototype.getScrollbarComponentCfg=function(){var t=this.view,n=t.coordinateBBox,i=t.viewBBox,a=this.getValidScrollbarCfg(),o=a.type,s=a.padding,u=a.width,l=a.height,f=a.style,h=o!=="vertical",p=jn(s,4),v=p[0],m=p[1],x=p[2],E=p[3],A=h?{x:n.minX+E,y:i.maxY-l-x}:{x:i.maxX-u-m,y:n.minY+v},L=this.getStep(),k=this.getCnt(),R=h?n.width-E-m:n.height-v-x,D=Math.max(R*_s(L/k,0,1),ZSe);return Xe(Xe({},this.getThemeOptions()),{x:A.x,y:A.y,size:h?l:u,isHorizontal:h,trackLen:R,thumbLen:D,thumbOffset:0,theme:this.getScrollbarTheme(f)})},r.prototype.getValidScrollbarCfg=function(){var t={type:"horizontal",categorySize:YSe,width:qz,height:qz,padding:[0,0,0,0],animate:!0,style:{}};return xo(this.option)&&(t=Xe(Xe({},t),this.option)),(!xo(this.option)||!this.option.padding)&&(t.padding=t.type==="horizontal"?[KA,0,KA,0]:[0,KA,0,KA]),t},r.prototype.getScrollbarData=function(){var t=this.view.getCoordinate(),n=this.getValidScrollbarCfg(),i=this.view.getOptions().data||[];return t.isReflect("y")&&n.type==="vertical"&&(i=vu([],jn(i),!1).reverse()),i},r}(V2),KSe={fill:"#CCD6EC",opacity:.3};function QSe(e,r,t){var n,i,a,o,s,u,l=F2e(e,r,t);if(l.length){l=pp(l);try{for(var f=so(l),h=f.next();!h.done;h=f.next()){var p=h.value;try{for(var v=(a=void 0,so(p)),m=v.next();!m.done;m=v.next()){var x=m.value,E=x.mappingData,A=E.x,L=E.y;x.x=ar(A)?A[A.length-1]:A,x.y=ar(L)?L[L.length-1]:L}}catch(U){a={error:U}}finally{try{m&&!m.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}}}catch(U){n={error:U}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}var k=t.shared;if(k===!1&&l.length>1){var R=l[0],D=Math.abs(r.y-R[0].y);try{for(var $=so(l),j=$.next();!j.done;j=$.next()){var H=j.value,ee=Math.abs(r.y-H[0].y);ee<=D&&(R=H,D=ee)}}catch(U){s={error:U}}finally{try{j&&!j.done&&(u=$.return)&&u.call($)}finally{if(s)throw s.error}}l=[R]}return Z0(pp(l))}return[]}var JSe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.show=function(t){var n=this.context.view,i=this.context.event,a=n.getController("tooltip").getTooltipCfg(),o=QSe(n,{x:i.x,y:i.y},a);if(!rs(o,this.items)&&(this.items=o,o.length)){var s=n.getXScale().field,u=o[0].data[s],l=[],f=n.geometries;if(we(f,function(We){if(We.type==="interval"||We.type==="schema"){var je=We.getElementsBy(function(lt){var dt=lt.getData();return dt[s]===u});l=l.concat(je)}}),l.length){var h=n.getCoordinate(),p=l[0].shape.getCanvasBBox(),v=l[0].shape.getCanvasBBox(),m=p;we(l,function(We){var je=We.shape.getCanvasBBox();h.isTransposed?(je.minY<p.minY&&(p=je),je.maxY>v.maxY&&(v=je)):(je.minX<p.minX&&(p=je),je.maxX>v.maxX&&(v=je)),m.x=Math.min(je.minX,m.minX),m.y=Math.min(je.minY,m.minY),m.width=Math.max(je.maxX,m.maxX)-m.x,m.height=Math.max(je.maxY,m.maxY)-m.y});var x=n.backgroundGroup,E=n.coordinateBBox,A=void 0;if(h.isRect){var L=n.getXScale(),k=t||{},R=k.appendRatio,D=k.appendWidth;rr(D)&&(R=rr(R)?L.isLinear?0:.25:R,D=h.isTransposed?R*v.height:R*p.width);var $=void 0,j=void 0,H=void 0,ee=void 0;h.isTransposed?($=E.minX,j=Math.min(v.minY,p.minY)-D,H=E.width,ee=m.height+D*2):($=Math.min(p.minX,v.minX)-D,j=E.minY,H=m.width+D*2,ee=E.height),A=[["M",$,j],["L",$+H,j],["L",$+H,j+ee],["L",$,j+ee],["Z"]]}else{var U=up(l),W=al(l),Q=pE(U.getModel(),h).startAngle,te=pE(W.getModel(),h).endAngle,ie=h.getCenter(),ve=h.getRadius(),me=h.innerRadius*ve;A=H0(ie.x,ie.y,ve,Q,te,me)}if(this.regionPath)this.regionPath.attr("path",A),this.regionPath.show();else{var Re=Ie(t,"style",KSe);this.regionPath=x.addShape({type:"path",name:"active-region",capture:!1,attrs:Xe(Xe({},Re),{path:A})})}}}},r.prototype.hide=function(){this.regionPath&&this.regionPath.hide(),this.items=null},r.prototype.destroy=function(){this.hide(),this.regionPath&&this.regionPath.remove(!0),e.prototype.destroy.call(this)},r}(Vs),CJ=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.timeStamp=0,t}return r.prototype.show=function(){var t=this.context,n=t.event,i=t.view,a=i.isTooltipLocked();if(!a){var o=this.timeStamp,s=+new Date,u=Ie(t.view.getOptions(),"tooltip.showDelay",16);if(s-o>u){var l=this.location,f={x:n.x,y:n.y};(!l||!rs(l,f))&&this.showTooltip(i,f),this.timeStamp=s,this.location=f}}},r.prototype.hide=function(){var t=this.context.view,n=t.getController("tooltip"),i=this.context.event,a=i.clientX,o=i.clientY;n.isCursorEntered({x:a,y:o})||t.isTooltipLocked()||(this.hideTooltip(t),this.location=null)},r.prototype.showTooltip=function(t,n){t.showTooltip(n)},r.prototype.hideTooltip=function(t){t.hideTooltip()},r}(Vs),eAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.showTooltip=function(t,n){var i=Yg(t);we(i,function(a){var o=c5(t,a,n);a.showTooltip(o)})},r.prototype.hideTooltip=function(t){var n=Yg(t);we(n,function(i){i.hideTooltip()})},r}(CJ),tAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.timeStamp=0,t}return r.prototype.destroy=function(){e.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},r.prototype.show=function(){var t=this.context,n=t.event,i=this.timeStamp,a=+new Date;if(a-i>16){var o=this.location,s={x:n.x,y:n.y};(!o||!rs(o,s))&&this.showTooltip(s),this.timeStamp=a,this.location=s}},r.prototype.hide=function(){this.hideTooltip(),this.location=null},r.prototype.showTooltip=function(t){var n=this.context,i=n.event,a=i.target;if(a&&a.get("tip")){this.tooltip||this.renderTooltip();var o=a.get("tip");this.tooltip.update(Xe({title:o},t)),this.tooltip.show()}},r.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},r.prototype.renderTooltip=function(){var t,n=this.context.view,i=n.canvas,a={start:{x:0,y:0},end:{x:i.get("width"),y:i.get("height")}},o=n.getTheme(),s=Ie(o,["components","tooltip","domStyles"],{}),u=new II({parent:i.get("el").parentNode,region:a,visible:!1,crosshairs:null,domStyles:Xe({},yn({},s,(t={},t[xy]={"max-width":"50%"},t[by]={"word-break":"break-all"},t)))});u.init(),u.setCapture(!1),this.tooltip=u},r}(Vs),R4=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="",t}return r.prototype.hasState=function(t){return t.hasState(this.stateName)},r.prototype.setElementState=function(t,n){t.setState(this.stateName,n)},r.prototype.setState=function(){this.setStateEnable(!0)},r.prototype.clear=function(){var t=this.context.view;this.clearViewState(t)},r.prototype.clearViewState=function(t){var n=this,i=wQ(t,this.stateName);we(i,function(a){n.setElementState(a,!1)})},r}(Vs);function Kz(e){return Ie(e.get("delegateObject"),"item")}var O4=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.ignoreListItemStates=["unchecked"],t}return r.prototype.isItemIgnore=function(t,n){var i=this.ignoreListItemStates,a=i.filter(function(o){return n.hasState(t,o)});return!!a.length},r.prototype.setStateByComponent=function(t,n,i){var a=this.context.view,o=t.get("field"),s=Lc(a);this.setElementsStateByItem(s,o,n,i)},r.prototype.setStateByElement=function(t,n){this.setElementState(t,n)},r.prototype.isMathItem=function(t,n,i){var a=this.context.view,o=d2(a,n),s=qv(t,n);return!rr(s)&&i.name===o.getText(s)},r.prototype.setElementsStateByItem=function(t,n,i,a){var o=this;we(t,function(s){o.isMathItem(s,n,i)&&s.setState(o.stateName,a)})},r.prototype.setStateEnable=function(t){var n=J0(this.context);if(n)_Q(this.context)&&this.setStateByElement(n,t);else{var i=Qx(this.context);if(vE(i)){var a=i.item,o=i.component;if(a&&o&&!this.isItemIgnore(a,o)){var s=this.context.event.gEvent;if(s&&s.fromShape&&s.toShape&&Kz(s.fromShape)===Kz(s.toShape))return;this.setStateByComponent(o,a,t)}}}},r.prototype.toggle=function(){var t=J0(this.context);if(t){var n=t.hasState(this.stateName);this.setElementState(t,!n)}},r.prototype.reset=function(){this.setStateEnable(!1)},r}(R4),rAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="active",t}return r.prototype.active=function(){this.setState()},r}(O4),nAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.cache={},t}return r.prototype.getColorScale=function(t,n){var i=n.geometry.getAttribute("color");if(!i)return null;var a=t.getScaleByField(i.getFields()[0]);return a},r.prototype.getLinkPath=function(t,n){var i=this.context.view,a=i.getCoordinate().isTransposed,o=t.shape.getCanvasBBox(),s=n.shape.getCanvasBBox(),u=a?[["M",o.minX,o.minY],["L",s.minX,s.maxY],["L",s.maxX,s.maxY],["L",o.maxX,o.minY],["Z"]]:[["M",o.maxX,o.minY],["L",s.minX,s.minY],["L",s.minX,s.maxY],["L",o.maxX,o.maxY],["Z"]];return u},r.prototype.addLinkShape=function(t,n,i,a){var o={opacity:.4,fill:n.shape.attr("fill")};t.addShape({type:"path",attrs:Xe(Xe({},yn({},o,kn(a)?a(o,n):a)),{path:this.getLinkPath(n,i)})})},r.prototype.linkByElement=function(t,n){var i=this,a=this.context.view,o=this.getColorScale(a,t);if(!!o){var s=qv(t,o.field);if(!this.cache[s]){var u=h2e(a,o.field,s),l=this.linkGroup,f=l.addGroup();this.cache[s]=f;var h=u.length;we(u,function(p,v){if(v<h-1){var m=u[v+1];i.addLinkShape(f,p,m,n)}})}}},r.prototype.removeLink=function(t){var n=this.getColorScale(this.context.view,t);if(!!n){var i=qv(t,n.field);this.cache[i]&&(this.cache[i].remove(),this.cache[i]=null)}},r.prototype.link=function(t){var n=this.context;this.linkGroup||(this.linkGroup=n.view.foregroundGroup.addGroup({id:"link-by-color-group",capture:!1}));var i=J0(n);i&&this.linkByElement(i,t==null?void 0:t.style)},r.prototype.unlink=function(){var t=J0(this.context);t&&this.removeLink(t)},r.prototype.clear=function(){this.linkGroup&&this.linkGroup.clear(),this.cache={}},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.linkGroup&&this.linkGroup.remove()},r}(Vs),F4=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.startPoint=null,t.endPoint=null,t.isStarted=!1,t.effectSiblings=!1,t.effectByRecord=!1,t}return r.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},r.prototype.start=function(){this.clear(),this.startPoint=this.getCurrentPoint(),this.isStarted=!0},r.prototype.getIntersectElements=function(){var t=null;if(gE(this.context))t=l4(this.context,10);else{var n=this.startPoint,i=this.isStarted?this.getCurrentPoint():this.endPoint;if(!n||!i)return;var a={minX:Math.min(n.x,i.x),minY:Math.min(n.y,i.y),maxX:Math.max(n.x,i.x),maxY:Math.max(n.y,i.y)},o=this.context.view;t=c4(o,a)}return t},r.prototype.setStateEnable=function(t){if(this.effectSiblings&&!this.effectByRecord)this.setSiblingsState(t);else{var n=Lc(this.context.view),i=this.getIntersectElements();i&&i.length?this.effectByRecord?this.setSiblingsStateByRecord(i,t):this.setElementsState(i,t,n):this.clear()}},r.prototype.setSiblingsStateByRecord=function(t,n){var i=this,a=this.context.view,o=Yg(a),s=t.map(function(f){return f.getModel().data}),u=a.getXScale().field,l=a.getYScales()[0].field;we(o,function(f){var h=Lc(f),p=h.filter(function(v){var m=v.getModel().data;return EQ(s,m,u,l)});i.setElementsState(p,n,h)})},r.prototype.setSiblingsState=function(t){var n=this,i=this.context.view,a=Yg(i);gE(this.context)&&we(a,function(o){var s=Lc(o),u=bQ(n.context,o,10);u&&u.length?n.setElementsState(u,t,s):n.clearViewState(o)})},r.prototype.setElementsState=function(t,n,i){var a=this;we(i,function(o){t.includes(o)?a.setElementState(o,n):a.setElementState(o,!1)})},r.prototype.end=function(){this.isStarted=!1,this.endPoint=this.getCurrentPoint()},r.prototype.clear=function(){var t=this,n=this.context.view;if(this.effectSiblings){var i=Yg(n);we(i,function(a){t.clearViewState(a)})}else this.clearViewState(n)},r}(R4),iAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="active",t}return r.prototype.active=function(){this.setState()},r}(F4),D4=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.setStateEnable=function(t){var n=J0(this.context);if(n){if(!_Q(this.context))return;t?(this.clear(),this.setElementState(n,!0)):this.hasState(n)&&this.setElementState(n,!1)}},r.prototype.toggle=function(){var t=J0(this.context);if(t){var n=this.hasState(t);n||this.clear(),this.setElementState(t,!n)}},r.prototype.reset=function(){this.setStateEnable(!1)},r}(R4),aAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="active",t}return r.prototype.active=function(){this.setState()},r}(D4),$C="inactive",UC="active";function B4(e){var r=Lc(e);we(r,function(t){t.hasState(UC)&&t.setState(UC,!1),t.hasState($C)&&t.setState($C,!1)})}function EJ(e,r,t){we(e,function(n){r(n)?(n.hasState($C)&&n.setState($C,!1),n.setState(UC,t)):(n.hasState(UC)&&n.setState(UC,!1),n.setState($C,t))})}var Rx=LM.INACTIVE,Km=LM.ACTIVE,N4=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName=Km,t}return r.prototype.setElementsStateByItem=function(t,n,i,a){var o=this,s=function(u){return o.isMathItem(u,n,i)};this.setHighlightBy(t,s,a)},r.prototype.setElementHighlight=function(t,n){n(t)?(t.hasState(Rx)&&t.setState(Rx,!1),t.setState(Km,!0)):t.hasState(Km)||t.setState(Rx,!0)},r.prototype.setHighlightBy=function(t,n,i){var a=this;if(i)we(t,function(u){a.setElementHighlight(u,n)});else{var o=wQ(this.context.view,Km),s=!0;we(o,function(u){if(!n(u))return s=!1,!1}),s?this.clear():we(t,function(u){n(u)&&(u.hasState(Km)&&u.setState(Km,!1),u.setState(Rx,!0))})}},r.prototype.setElementState=function(t,n){var i=this.context.view,a=Lc(i);this.setHighlightBy(a,function(o){return t===o},n)},r.prototype.highlight=function(){this.setState()},r.prototype.clear=function(){var t=this.context.view;B4(t)},r}(O4),oAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.setStateByElement=function(t,n){var i=this.context.view,a=t.geometry.getAttribute("color");if(!!a){var o=i.getScaleByField(a.getFields()[0]),s=qv(t,o.field),u=Lc(i),l=u.filter(function(f){return qv(f,o.field)===s});this.setHighlightBy(u,function(f){return l.includes(f)},n)}},r}(N4),sAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.setElementHighlight=function(t,n){n(t)?(t.hasState(Rx)&&t.setState(Rx,!1),t.setState(Km,!0)):(t.setState(Rx,!0),t.hasState(Km)&&t.setState(Km,!1))},r.prototype.setStateByElement=function(t,n){var i=this.context.view,a=i.getXScale(),o=qv(t,a.field),s=Lc(i),u=s.filter(function(l){return qv(l,a.field)===o});this.setHighlightBy(s,function(l){return u.includes(l)},n)},r.prototype.toggle=function(){var t=J0(this.context);if(t){var n=t.hasState(this.stateName);this.setStateByElement(t,!n)}},r}(N4),Ng;(function(e){e.BEFORE_HIGHLIGHT="element-range-highlight:beforehighlight",e.AFTER_HIGHLIGHT="element-range-highlight:afterhighlight",e.BEFORE_CLEAR="element-range-highlight:beforeclear",e.AFTER_CLEAR="element-range-highlight:afterclear"})(Ng||(Ng={}));var SJ=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="active",t}return r.prototype.clearViewState=function(t){B4(t)},r.prototype.highlight=function(){var t=this.context,n=t.view,i=t.event,a=this.getIntersectElements(),o={view:n,event:i,highlightElements:a};n.emit(Ng.BEFORE_HIGHLIGHT,ru.fromData(n,Ng.BEFORE_HIGHLIGHT,o)),this.setState(),n.emit(Ng.AFTER_HIGHLIGHT,ru.fromData(n,Ng.AFTER_HIGHLIGHT,o))},r.prototype.clear=function(){var t=this.context.view;t.emit(Ng.BEFORE_CLEAR,ru.fromData(t,Ng.BEFORE_CLEAR,{})),e.prototype.clear.call(this),t.emit(Ng.AFTER_CLEAR,ru.fromData(t,Ng.AFTER_CLEAR,{}))},r.prototype.setElementsState=function(t,n,i){EJ(i,function(a){return t.indexOf(a)>=0},n)},r}(F4),uAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="active",t}return r.prototype.highlight=function(){this.setState()},r.prototype.setElementState=function(t,n){var i=this.context.view,a=Lc(i);EJ(a,function(o){return t===o},n)},r.prototype.clear=function(){var t=this.context.view;B4(t)},r}(D4),lAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="selected",t}return r.prototype.selected=function(){this.setState()},r}(F4),cAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="selected",t}return r.prototype.selected=function(){this.setState()},r}(O4),fAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="selected",t}return r.prototype.selected=function(){this.setState()},r}(D4),y1=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="",t.ignoreItemStates=[],t}return r.prototype.getTriggerListInfo=function(){var t=Qx(this.context),n=null;return vE(t)&&(n={item:t.item,list:t.component}),n},r.prototype.getAllowComponents=function(){var t=this,n=this.context.view,i=CQ(n),a=[];return we(i,function(o){o.isList()&&t.allowSetStateByElement(o)&&a.push(o)}),a},r.prototype.hasState=function(t,n){return t.hasState(n,this.stateName)},r.prototype.clearAllComponentsState=function(){var t=this,n=this.getAllowComponents();we(n,function(i){i.clearItemsState(t.stateName)})},r.prototype.allowSetStateByElement=function(t){var n=t.get("field");if(!n)return!1;if(this.cfg&&this.cfg.componentNames){var i=t.get("name");if(this.cfg.componentNames.indexOf(i)===-1)return!1}var a=this.context.view,o=d2(a,n);return o&&o.isCategory},r.prototype.allowSetStateByItem=function(t,n){var i=this.ignoreItemStates;if(i.length){var a=i.filter(function(o){return n.hasState(t,o)});return a.length===0}return!0},r.prototype.setStateByElement=function(t,n,i){var a=t.get("field"),o=this.context.view,s=d2(o,a),u=qv(n,a),l=s.getText(u);this.setItemsState(t,l,i)},r.prototype.setStateEnable=function(t){var n=this,i=J0(this.context);if(i){var a=this.getAllowComponents();we(a,function(l){n.setStateByElement(l,i,t)})}else{var o=Qx(this.context);if(vE(o)){var s=o.item,u=o.component;this.allowSetStateByElement(u)&&this.allowSetStateByItem(s,u)&&this.setItemState(u,s,t)}}},r.prototype.setItemsState=function(t,n,i){var a=this,o=t.getItems();we(o,function(s){s.name===n&&a.setItemState(t,s,i)})},r.prototype.setItemState=function(t,n,i){t.setItemState(n,this.stateName,i)},r.prototype.setState=function(){this.setStateEnable(!0)},r.prototype.reset=function(){this.setStateEnable(!1)},r.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var n=t.list,i=t.item,a=this.hasState(n,i);this.setItemState(n,i,!a)}},r.prototype.clear=function(){var t=this.getTriggerListInfo();t?t.list.clearItemsState(this.stateName):this.clearAllComponentsState()},r}(Vs),hAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="active",t}return r.prototype.active=function(){this.setState()},r}(y1),Qz="inactive",Jz="active";function pAe(e){var r=e.getItems();we(r,function(t){e.hasState(t,Jz)&&e.setItemState(t,Jz,!1),e.hasState(t,Qz)&&e.setItemState(t,Qz,!1)})}var Nw="inactive",sx="active",z4=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName=sx,t.ignoreItemStates=["unchecked"],t}return r.prototype.setItemsState=function(t,n,i){this.setHighlightBy(t,function(a){return a.name===n},i)},r.prototype.setItemState=function(t,n,i){t.getItems(),this.setHighlightBy(t,function(a){return a===n},i)},r.prototype.setHighlightBy=function(t,n,i){var a=t.getItems();if(i)we(a,function(u){n(u)?(t.hasState(u,Nw)&&t.setItemState(u,Nw,!1),t.setItemState(u,sx,!0)):t.hasState(u,sx)||t.setItemState(u,Nw,!0)});else{var o=t.getItemsByState(sx),s=!0;we(o,function(u){if(!n(u))return s=!1,!1}),s?this.clear():we(a,function(u){n(u)&&(t.hasState(u,sx)&&t.setItemState(u,sx,!1),t.setItemState(u,Nw,!0))})}},r.prototype.highlight=function(){this.setState()},r.prototype.clear=function(){var t=this.getTriggerListInfo();if(t)pAe(t.list);else{var n=this.getAllowComponents();we(n,function(i){i.clearItemsState(sx),i.clearItemsState(Nw)})}},r}(y1),dAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="selected",t}return r.prototype.selected=function(){this.setState()},r}(y1),vAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName="unchecked",t}return r.prototype.unchecked=function(){this.setState()},r}(y1),pb="unchecked",QA="checked",gAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.stateName=QA,t}return r.prototype.setItemState=function(t,n,i){this.setCheckedBy(t,function(a){return a===n},i)},r.prototype.setCheckedBy=function(t,n,i){var a=t.getItems();i&&we(a,function(o){n(o)?(t.hasState(o,pb)&&t.setItemState(o,pb,!1),t.setItemState(o,QA,!0)):t.hasState(o,QA)||t.setItemState(o,pb,!0)})},r.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var n=t.list,i=t.item,a=!uS(n.getItems(),function(o){return n.hasState(o,pb)});a||n.hasState(i,pb)?this.setItemState(n,i,!0):this.reset()}},r.prototype.checked=function(){this.setState()},r.prototype.reset=function(){var t=this.getAllowComponents();we(t,function(n){n.clearItemsState(QA),n.clearItemsState(pb)})},r}(y1),db="unchecked",mAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.toggle=function(){var t,n,i,a,o,s,u,l,f=this.getTriggerListInfo();if(f!=null&&f.item){var h=f.list,p=f.item,v=h.getItems(),m=v.filter(function(U){return!h.hasState(U,db)}),x=v.filter(function(U){return h.hasState(U,db)}),E=m[0];if(v.length===m.length)try{for(var A=so(v),L=A.next();!L.done;L=A.next()){var k=L.value;h.setItemState(k,db,k.id!==p.id)}}catch(U){t={error:U}}finally{try{L&&!L.done&&(n=A.return)&&n.call(A)}finally{if(t)throw t.error}}else if(v.length-x.length===1)if(E.id===p.id)try{for(var R=so(v),D=R.next();!D.done;D=R.next()){var k=D.value;h.setItemState(k,db,!1)}}catch(U){i={error:U}}finally{try{D&&!D.done&&(a=R.return)&&a.call(R)}finally{if(i)throw i.error}}else try{for(var $=so(v),j=$.next();!j.done;j=$.next()){var k=j.value;h.setItemState(k,db,k.id!==p.id)}}catch(U){o={error:U}}finally{try{j&&!j.done&&(s=$.return)&&s.call($)}finally{if(o)throw o.error}}else try{for(var H=so(v),ee=H.next();!ee.done;ee=H.next()){var k=ee.value;h.setItemState(k,db,k.id!==p.id)}}catch(U){u={error:U}}finally{try{ee&&!ee.done&&(l=H.return)&&l.call(H)}finally{if(u)throw u.error}}}},r}(y1),e9="showRadio",PR="legend-radio-tip",yAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.timeStamp=0,t}return r.prototype.show=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var n=t.list,i=t.item;n.setItemState(i,e9,!0)}},r.prototype.hide=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var n=t.list,i=t.item;n.setItemState(i,e9,!1)}},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},r.prototype.showTip=function(){var t=this.context,n=t.event,i=this.timeStamp,a=+new Date,o=this.context.event.target;if(a-i>16&&o.get("name")==="legend-item-radio"){var s=this.location,u={x:n.x,y:n.y};this.timeStamp=a,this.location=u,(!s||!rs(s,u))&&this.showTooltip(u)}},r.prototype.hideTip=function(){this.hideTooltip(),this.location=null},r.prototype.showTooltip=function(t){var n=this.context,i=n.event,a=i.target;if(a&&a.get("tip")){this.tooltip||this.renderTooltip();var o=n.view.getCanvas().get("el").getBoundingClientRect(),s=o.x,u=o.y;this.tooltip.update(Xe(Xe({title:a.get("tip")},t),{x:t.x+s,y:t.y+u})),this.tooltip.show()}},r.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},r.prototype.renderTooltip=function(){var t,n=(t={},t[xy]={padding:"6px 8px",transform:"translate(-50%, -80%)",background:"rgba(0,0,0,0.75)",color:"#fff","border-radius":"2px","z-index":100},t[by]={"font-size":"12px","line-height":"14px","margin-bottom":0,"word-break":"break-all"},t);document.getElementById(PR)&&document.body.removeChild(document.getElementById(PR));var i=new II({parent:document.body,region:null,visible:!1,crosshairs:null,domStyles:n,containerId:PR});i.init(),i.setCapture(!1),this.tooltip=i},r}(y1),$4=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.maskShape=null,t.points=[],t.starting=!1,t.moving=!1,t.preMovePoint=null,t.shapeType="path",t}return r.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},r.prototype.emitEvent=function(t){var n="mask:".concat(t),i=this.context.view,a=this.context.event;i.emit(n,{target:this.maskShape,shape:this.maskShape,points:this.points,x:a.x,y:a.y})},r.prototype.createMask=function(){var t=this.context.view,n=this.getMaskAttrs(),i=t.foregroundGroup.addShape({type:this.shapeType,name:"mask",draggable:!0,attrs:Xe({fill:"#C5D4EB",opacity:.3},n)});return i},r.prototype.getMaskPath=function(){return[]},r.prototype.show=function(){this.maskShape&&(this.maskShape.show(),this.emitEvent("show"))},r.prototype.start=function(t){this.starting=!0,this.moving=!1,this.points=[this.getCurrentPoint()],this.maskShape||(this.maskShape=this.createMask(),this.maskShape.set("capture",!1)),this.updateMask(t==null?void 0:t.maskStyle),this.emitEvent("start")},r.prototype.moveStart=function(){this.moving=!0,this.preMovePoint=this.getCurrentPoint()},r.prototype.move=function(){if(!(!this.moving||!this.maskShape)){var t=this.getCurrentPoint(),n=this.preMovePoint,i=t.x-n.x,a=t.y-n.y,o=this.points;we(o,function(s){s.x+=i,s.y+=a}),this.updateMask(),this.emitEvent("change"),this.preMovePoint=t}},r.prototype.updateMask=function(t){var n=yn({},this.getMaskAttrs(),t);this.maskShape.attr(n)},r.prototype.moveEnd=function(){this.moving=!1,this.preMovePoint=null},r.prototype.end=function(){this.starting=!1,this.emitEvent("end"),this.maskShape&&this.maskShape.set("capture",!0)},r.prototype.hide=function(){this.maskShape&&(this.maskShape.hide(),this.emitEvent("hide"))},r.prototype.resize=function(){this.starting&&this.maskShape&&(this.points.push(this.getCurrentPoint()),this.updateMask(),this.emitEvent("change"))},r.prototype.destroy=function(){this.points=[],this.maskShape&&this.maskShape.remove(),this.maskShape=null,this.preMovePoint=null,e.prototype.destroy.call(this)},r}(Vs),_Ae=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.shapeType="circle",t}return r.prototype.getMaskAttrs=function(){var t=this.points,n=al(this.points),i=0,a=0,o=0;if(t.length){var s=t[0];i=f4(s,n)/2,a=(n.x+s.x)/2,o=(n.y+s.y)/2}return{x:a,y:o,r:i}},r}($4),AJ=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.shapeType="rect",t}return r.prototype.getRegion=function(){var t=this.points;return{start:up(t),end:al(t)}},r.prototype.getMaskAttrs=function(){var t=this.getRegion(),n=t.start,i=t.end,a=Math.min(n.x,i.x),o=Math.min(n.y,i.y),s=Math.abs(i.x-n.x),u=Math.abs(i.y-n.y);return{x:a,y:o,width:s,height:u}},r}($4);function t9(e){e.x=_s(e.x,0,1),e.y=_s(e.y,0,1)}var TJ=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.dim="x",t.inPlot=!0,t}return r.prototype.getRegion=function(){var t=null,n=null,i=this.points,a=this.dim,o=this.context.view.getCoordinate(),s=o.invert(up(i)),u=o.invert(al(i));return this.inPlot&&(t9(s),t9(u)),a==="x"?(t=o.convert({x:s.x,y:0}),n=o.convert({x:u.x,y:1})):(t=o.convert({x:0,y:s.y}),n=o.convert({x:1,y:u.y})),{start:t,end:n}},r}(AJ),MJ=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getMaskPath=function(){var t=this.points,n=[];return t.length&&(we(t,function(i,a){a===0?n.push(["M",i.x,i.y]):n.push(["L",i.x,i.y])}),n.push(["L",t[0].x,t[0].y])),n},r.prototype.getMaskAttrs=function(){return{path:this.getMaskPath()}},r.prototype.addPoint=function(){this.resize()},r}($4),xAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getMaskPath=function(){var t=this.points;return v2e(t,!0)},r}(MJ),bAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.setCursor=function(t){var n=this.context.view;n.getCanvas().setCursor(t)},r.prototype.default=function(){this.setCursor("default")},r.prototype.pointer=function(){this.setCursor("pointer")},r.prototype.move=function(){this.setCursor("move")},r.prototype.crosshair=function(){this.setCursor("crosshair")},r.prototype.wait=function(){this.setCursor("wait")},r.prototype.help=function(){this.setCursor("help")},r.prototype.text=function(){this.setCursor("text")},r.prototype.eResize=function(){this.setCursor("e-resize")},r.prototype.wResize=function(){this.setCursor("w-resize")},r.prototype.nResize=function(){this.setCursor("n-resize")},r.prototype.sResize=function(){this.setCursor("s-resize")},r.prototype.neResize=function(){this.setCursor("ne-resize")},r.prototype.nwResize=function(){this.setCursor("nw-resize")},r.prototype.seResize=function(){this.setCursor("se-resize")},r.prototype.swResize=function(){this.setCursor("sw-resize")},r.prototype.nsResize=function(){this.setCursor("ns-resize")},r.prototype.ewResize=function(){this.setCursor("ew-resize")},r.prototype.zoomIn=function(){this.setCursor("zoom-in")},r.prototype.zoomOut=function(){this.setCursor("zoom-out")},r}(Vs),wAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.filterView=function(t,n,i){var a=this;t.getScaleByField(n)&&t.filter(n,i),t.views&&t.views.length&&we(t.views,function(o){a.filterView(o,n,i)})},r.prototype.filter=function(){var t=Qx(this.context);if(t){var n=this.context.view,i=t.component,a=i.get("field");if(vE(t)){if(a){var o=i.getItemsByState("unchecked"),s=d2(n,a),u=o.map(function(v){return v.name});u.length?this.filterView(n,a,function(v){var m=s.getText(v);return!u.includes(m)}):this.filterView(n,a,null),n.render(!0)}}else if(xQ(t)){var l=i.getValue(),f=jn(l,2),h=f[0],p=f[1];this.filterView(n,a,function(v){return v>=h&&v<=p}),n.render(!0)}}},r}(Vs);function r9(e,r,t,n){var i=Math.min(t[r],n[r]),a=Math.max(t[r],n[r]),o=jn(e.range,2),s=o[0],u=o[1];if(i<s&&(i=s),a>u&&(a=u),i===u&&a===u)return null;var l=e.invert(i),f=e.invert(a);if(e.isCategory){var h=e.values.indexOf(l),p=e.values.indexOf(f),v=e.values.slice(h,p+1);return function(m){return v.includes(m)}}else return function(m){return m>=l&&m<=f}}var rp;(function(e){e.FILTER="brush-filter-processing",e.RESET="brush-filter-reset",e.BEFORE_FILTER="brush-filter:beforefilter",e.AFTER_FILTER="brush-filter:afterfilter",e.BEFORE_RESET="brush-filter:beforereset",e.AFTER_RESET="brush-filter:afterreset"})(rp||(rp={}));var BI=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.dims=["x","y"],t.startPoint=null,t.isStarted=!1,t}return r.prototype.hasDim=function(t){return this.dims.includes(t)},r.prototype.start=function(){var t=this.context;this.isStarted=!0,this.startPoint=t.getCurrentPoint()},r.prototype.filter=function(){var t,n;if(gE(this.context)){var i=this.context.event.target,a=i.getCanvasBBox();t={x:a.x,y:a.y},n={x:a.maxX,y:a.maxY}}else{if(!this.isStarted)return;t=this.startPoint,n=this.context.getCurrentPoint()}if(!(Math.abs(t.x-n.x)<5||Math.abs(t.x-n.y)<5)){var o=this.context,s=o.view,u=o.event,l={view:s,event:u,dims:this.dims};s.emit(rp.BEFORE_FILTER,ru.fromData(s,rp.BEFORE_FILTER,l));var f=s.getCoordinate(),h=f.invert(n),p=f.invert(t);if(this.hasDim("x")){var v=s.getXScale(),m=r9(v,"x",h,p);this.filterView(s,v.field,m)}if(this.hasDim("y")){var x=s.getYScales()[0],m=r9(x,"y",h,p);this.filterView(s,x.field,m)}this.reRender(s,{source:rp.FILTER}),s.emit(rp.AFTER_FILTER,ru.fromData(s,rp.AFTER_FILTER,l))}},r.prototype.end=function(){this.isStarted=!1},r.prototype.reset=function(){var t=this.context.view;if(t.emit(rp.BEFORE_RESET,ru.fromData(t,rp.BEFORE_RESET,{})),this.isStarted=!1,this.hasDim("x")){var n=t.getXScale();this.filterView(t,n.field,null)}if(this.hasDim("y")){var i=t.getYScales()[0];this.filterView(t,i.field,null)}this.reRender(t,{source:rp.RESET}),t.emit(rp.AFTER_RESET,ru.fromData(t,rp.AFTER_RESET,{}))},r.prototype.filterView=function(t,n,i){t.filter(n,i)},r.prototype.reRender=function(t,n){t.render(!0,n)},r}(Vs),U4=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.filterView=function(t,n,i){var a=Yg(t);we(a,function(o){o.filter(n,i)})},r.prototype.reRender=function(t){var n=Yg(t);we(n,function(i){i.render(!0)})},r}(BI),CAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.filter=function(){var t=Qx(this.context),n=this.context.view,i=Lc(n);if(gE(this.context)){var a=l4(this.context,10);a&&we(i,function(x){a.includes(x)?x.show():x.hide()})}else if(t){var o=t.component,s=o.get("field");if(vE(t)){if(s){var u=o.getItemsByState("unchecked"),l=d2(n,s),f=u.map(function(x){return x.name});we(i,function(x){var E=qv(x,s),A=l.getText(E);f.indexOf(A)>=0?x.hide():x.show()})}}else if(xQ(t)){var h=o.getValue(),p=jn(h,2),v=p[0],m=p[1];we(i,function(x){var E=qv(x,s);E>=v&&E<=m?x.show():x.hide()})}}},r.prototype.clear=function(){var t=Lc(this.context.view);we(t,function(n){n.show()})},r.prototype.reset=function(){this.clear()},r}(Vs),LJ=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.byRecord=!1,t}return r.prototype.filter=function(){gE(this.context)&&(this.byRecord?this.filterByRecord():this.filterByBBox())},r.prototype.filterByRecord=function(){var t=this.context.view,n=l4(this.context,10);if(!!n){var i=t.getXScale().field,a=t.getYScales()[0].field,o=n.map(function(u){return u.getModel().data}),s=Yg(t);we(s,function(u){var l=Lc(u);we(l,function(f){var h=f.getModel().data;EQ(o,h,i,a)?f.show():f.hide()})})}},r.prototype.filterByBBox=function(){var t=this,n=this.context.view,i=Yg(n);we(i,function(a){var o=bQ(t.context,a,10),s=Lc(a);o&&we(s,function(u){o.includes(u)?u.show():u.hide()})})},r.prototype.reset=function(){var t=Yg(this.context.view);we(t,function(n){var i=Lc(n);we(i,function(a){a.show()})})},r}(Vs),EAe=10,SAe=5,AAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg={name:"button",text:"button",textStyle:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"},padding:[8,10],style:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},activeStyle:{fill:"#e6e6e6"}},t}return r.prototype.getButtonCfg=function(){return yn(this.buttonCfg,this.cfg)},r.prototype.drawButton=function(){var t=this.getButtonCfg(),n=this.context.view.foregroundGroup.addGroup({name:t.name}),i=n.addShape({type:"text",name:"button-text",attrs:Xe({text:t.text},t.textStyle)}),a=i.getBBox(),o=p4(t.padding),s=n.addShape({type:"rect",name:"button-rect",attrs:Xe({x:a.x-o[3],y:a.y-o[0],width:a.width+o[1]+o[3],height:a.height+o[0]+o[2]},t.style)});s.toBack(),n.on("mouseenter",function(){s.attr(t.activeStyle)}),n.on("mouseleave",function(){s.attr(t.style)}),this.buttonGroup=n},r.prototype.resetPosition=function(){var t=this.context.view,n=t.getCoordinate(),i=n.convert({x:1,y:1}),a=this.buttonGroup,o=a.getBBox(),s=yl(null,[["t",i.x-o.width-EAe,i.y+o.height+SAe]]);a.setMatrix(s)},r.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},r.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},r.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),e.prototype.destroy.call(this)},r}(Vs),TAe=4,MAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.starting=!1,t.dragStart=!1,t}return r.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint()},r.prototype.drag=function(){if(!!this.startPoint){var t=this.context.getCurrentPoint(),n=this.context.view,i=this.context.event;this.dragStart?n.emit("drag",{target:i.target,x:i.x,y:i.y}):f4(t,this.startPoint)>TAe&&(n.emit("dragstart",{target:i.target,x:i.x,y:i.y}),this.dragStart=!0)}},r.prototype.end=function(){if(this.dragStart){var t=this.context.view,n=this.context.event;t.emit("dragend",{target:n.target,x:n.x,y:n.y})}this.starting=!1,this.dragStart=!1},r}(Vs),LAe=5,IAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.starting=!1,t.isMoving=!1,t.startPoint=null,t.startMatrix=null,t}return r.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint(),this.startMatrix=this.context.view.middleGroup.getMatrix()},r.prototype.move=function(){if(!!this.starting){var t=this.startPoint,n=this.context.getCurrentPoint(),i=f4(t,n);if(i>LAe&&!this.isMoving&&(this.isMoving=!0),this.isMoving){var a=this.context.view,o=yl(this.startMatrix,[["t",n.x-t.x,n.y-t.y]]);a.backgroundGroup.setMatrix(o),a.foregroundGroup.setMatrix(o),a.middleGroup.setMatrix(o)}}},r.prototype.end=function(){this.isMoving&&(this.isMoving=!1),this.startMatrix=null,this.starting=!1,this.startPoint=null},r.prototype.reset=function(){this.starting=!1,this.startPoint=null,this.isMoving=!1;var t=this.context.view;t.backgroundGroup.resetMatrix(),t.foregroundGroup.resetMatrix(),t.middleGroup.resetMatrix(),this.isMoving=!1},r}(Vs),n9="x",i9="y",IJ=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.dims=[n9,i9],t.cfgFields=["dims"],t.cacheScaleDefs={},t}return r.prototype.hasDim=function(t){return this.dims.includes(t)},r.prototype.getScale=function(t){var n=this.context.view;return t==="x"?n.getXScale():n.getYScales()[0]},r.prototype.resetDim=function(t){var n=this.context.view;if(this.hasDim(t)&&this.cacheScaleDefs[t]){var i=this.getScale(t);n.scale(i.field,this.cacheScaleDefs[t]),this.cacheScaleDefs[t]=null}},r.prototype.reset=function(){this.resetDim(n9),this.resetDim(i9);var t=this.context.view;t.render(!0)},r}(Vs),kAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.startPoint=null,t.starting=!1,t.startCache={},t}return r.prototype.start=function(){var t=this;this.startPoint=this.context.getCurrentPoint(),this.starting=!0;var n=this.dims;we(n,function(i){var a=t.getScale(i),o=a.min,s=a.max,u=a.values;t.startCache[i]={min:o,max:s,values:u}})},r.prototype.end=function(){this.startPoint=null,this.starting=!1,this.startCache={}},r.prototype.translate=function(){var t=this;if(!!this.starting){var n=this.startPoint,i=this.context.view.getCoordinate(),a=this.context.getCurrentPoint(),o=i.invert(n),s=i.invert(a),u=s.x-o.x,l=s.y-o.y,f=this.context.view,h=this.dims;we(h,function(p){t.translateDim(p,{x:u*-1,y:l*-1})}),f.render(!0)}},r.prototype.translateDim=function(t,n){if(this.hasDim(t)){var i=this.getScale(t);i.isLinear&&this.translateLinear(t,i,n)}},r.prototype.translateLinear=function(t,n,i){var a=this.context.view,o=this.startCache[t],s=o.min,u=o.max,l=u-s,f=i[t]*l;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:n.nice,min:s,max:u}),a.scale(n.field,{nice:!1,min:s+f,max:u+f})},r.prototype.reset=function(){e.prototype.reset.call(this),this.startPoint=null,this.starting=!1},r}(IJ),PAe=function(e){Rn(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.zoomRatio=.05,t}return r.prototype.zoomIn=function(){this.zoom(this.zoomRatio)},r.prototype.zoom=function(t){var n=this,i=this.dims;we(i,function(a){n.zoomDim(a,t)}),this.context.view.render(!0)},r.prototype.zoomOut=function(){this.zoom(-1*this.zoomRatio)},r.prototype.zoomDim=function(t,n){if(this.hasDim(t)){var i=this.getScale(t);i.isLinear&&this.zoomLinear(t,i,n)}},r.prototype.zoomLinear=function(t,n,i){var a=this.context.view;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:n.nice,min:n.min,max:n.max});var o=this.cacheScaleDefs[t],s=o.max-o.min,u=n.min,l=n.max,f=i*s,h=u-f,p=l+f,v=p-h,m=v/s;p>h&&m<100&&m>.01&&a.scale(n.field,{nice:!1,min:u-f,max:l+f})},r}(IJ);function RAe(e){var r=e.gEvent.originalEvent;return r.deltaY>0}var OAe=1,FAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.scroll=function(t){var n=this.context,i=n.view,a=n.event;if(!!i.getOptions().scrollbar){var o=(t==null?void 0:t.wheelDelta)||OAe,s=i.getController("scrollbar"),u=i.getXScale(),l=i.getOptions().data,f=zl(Gd(l,u.field)),h=zl(u.values),p=s.getValue(),v=Math.floor((f-h)*p),m=v+(RAe(a)?o:-o),x=o/(f-h)/1e4,E=_s(m/(f-h)+x,0,1);s.setValue(E)}},r}(Vs),DAe="aixs-description-tooltip",BAe=function(e){Rn(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.show=function(){var t=this.context,n=Qx(t).axis,i=n.cfg.title,a=i.description,o=i.text,s=i.descriptionTooltipStyle,u=t.event,l=u.x,f=u.y;this.tooltip||this.renderTooltip(),this.tooltip.update({title:o||"",customContent:function(){return`
          <div class="`.concat(xy,'" style={').concat(s,`}>
            <div class="`).concat(by,`">
              \u5B57\u6BB5\u8BF4\u660E\uFF1A`).concat(a,`
            </div>
          </div>
        `)},x:l,y:f}),this.tooltip.show()},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},r.prototype.hide=function(){this.tooltip&&this.tooltip.hide()},r.prototype.renderTooltip=function(){var t,n=this.context.view,i=n.canvas,a={start:{x:0,y:0},end:{x:i.get("width"),y:i.get("height")}},o=new II({parent:i.get("el").parentNode,region:a,visible:!1,containerId:DAe,domStyles:Xe({},yn({},(t={},t[xy]={"max-width":"50%",padding:"10px","line-height":"15px","font-size":"12px",color:"rgba(0, 0, 0, .65)"},t[by]={"word-break":"break-all","margin-bottom":"3px"},t)))});o.init(),o.setCapture(!1),this.tooltip=o},r}(Vs);M2e("dark",AQ(vwe));dq("canvas",cCe);dq("svg",tEe);im("Polygon",vEe);im("Interval",cEe);im("Schema",gEe);im("Path",A4);im("Point",pEe);im("Line",fEe);im("Area",nEe);im("Edge",iEe);im("Heatmap",aEe);im("Violin",yEe);mS("base",OI);mS("interval",OEe);mS("pie",FEe);mS("polar",yJ);mp("overlap",ZEe);mp("distribute",BEe);mp("fixed-overlap",YEe);mp("hide-overlap",aSe);mp("limit-in-shape",HEe);mp("limit-in-canvas",GEe);mp("limit-in-plot",wSe);mp("pie-outer",zEe);mp("adjust-color",sSe);mp("interval-adjust-position",fSe);mp("interval-hide-overlap",pSe);mp("point-adjust-position",gSe);mp("pie-spider",VEe);mp("path-adjust-position",_Se);td("fade-in",CSe);td("fade-out",ESe);td("grow-in-x",ASe);td("grow-in-xy",MSe);td("grow-in-y",TSe);td("scale-in-x",kSe);td("scale-in-y",PSe);td("wave-in",OSe);td("zoom-in",FSe);td("zoom-out",DSe);td("position-update",ISe);td("sector-path-update",RSe);td("path-in",LSe);U2("rect",USe);U2("mirror",$Se);U2("list",NSe);U2("matrix",zSe);U2("circle",BSe);U2("tree",VSe);m1("axis",jSe);m1("legend",WSe);m1("tooltip",kQ);m1("annotation",HSe);m1("slider",XSe);m1("scrollbar",qSe);hi("tooltip",CJ);hi("sibling-tooltip",eAe);hi("ellipsis-text",tAe);hi("element-active",rAe);hi("element-single-active",aAe);hi("element-range-active",iAe);hi("element-highlight",N4);hi("element-highlight-by-x",sAe);hi("element-highlight-by-color",oAe);hi("element-single-highlight",uAe);hi("element-range-highlight",SJ);hi("element-sibling-highlight",SJ,{effectSiblings:!0,effectByRecord:!0});hi("element-selected",cAe);hi("element-single-selected",fAe);hi("element-range-selected",lAe);hi("element-link-by-color",nAe);hi("active-region",JSe);hi("list-active",hAe);hi("list-selected",dAe);hi("list-highlight",z4);hi("list-unchecked",vAe);hi("list-checked",gAe);hi("list-focus",mAe);hi("list-radio",yAe);hi("legend-item-highlight",z4,{componentNames:["legend"]});hi("axis-label-highlight",z4,{componentNames:["axis"]});hi("axis-description",BAe);hi("rect-mask",AJ);hi("x-rect-mask",TJ,{dim:"x"});hi("y-rect-mask",TJ,{dim:"y"});hi("circle-mask",_Ae);hi("path-mask",MJ);hi("smooth-path-mask",xAe);hi("cursor",bAe);hi("data-filter",wAe);hi("brush",BI);hi("brush-x",BI,{dims:["x"]});hi("brush-y",BI,{dims:["y"]});hi("sibling-filter",U4);hi("sibling-x-filter",U4);hi("sibling-y-filter",U4);hi("element-filter",CAe);hi("element-sibling-filter",LJ);hi("element-sibling-filter-record",LJ,{byRecord:!0});hi("view-drag",MAe);hi("view-move",IAe);hi("scale-translate",kAe);hi("scale-zoom",PAe);hi("reset-button",AAe,{name:"reset-button",text:"reset"});hi("mousewheel-scroll",FAe);function j0(e){return e.isInPlot()}$i("tooltip",{start:[{trigger:"plot:mousemove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"plot:touchmove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseleave",action:"tooltip:hide"},{trigger:"plot:leave",action:"tooltip:hide"},{trigger:"plot:touchend",action:"tooltip:hide"}]});$i("ellipsis-text",{start:[{trigger:"legend-item-name:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"legend-item-name:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"legend-item-name:mouseleave",action:"ellipsis-text:hide"},{trigger:"legend-item-name:touchend",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseleave",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseout",action:"ellipsis-text:hide"},{trigger:"axis-label:touchend",action:"ellipsis-text:hide"}]});$i("element-active",{start:[{trigger:"element:mouseenter",action:"element-active:active"}],end:[{trigger:"element:mouseleave",action:"element-active:reset"}]});$i("element-selected",{start:[{trigger:"element:click",action:"element-selected:toggle"}]});$i("element-highlight",{start:[{trigger:"element:mouseenter",action:"element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight:reset"}]});$i("element-highlight-by-x",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-x:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-x:reset"}]});$i("element-highlight-by-color",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-color:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-color:reset"}]});$i("legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","element-active:reset"]}]});$i("legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","element-highlight:reset"]}]});$i("axis-label-highlight",{start:[{trigger:"axis-label:mouseenter",action:["axis-label-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"axis-label:mouseleave",action:["axis-label-highlight:reset","element-highlight:reset"]}]});$i("element-list-highlight",{start:[{trigger:"element:mouseenter",action:["list-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"element:mouseleave",action:["list-highlight:reset","element-highlight:reset"]}]});$i("element-range-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(e){return!e.isInShape("mask")},action:["rect-mask:start","rect-mask:show"]},{trigger:"mask:dragstart",action:["rect-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:drag",action:["rect-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end"]},{trigger:"mask:dragend",action:["rect-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(e){return!e.isInPlot()},action:["element-range-highlight:clear","rect-mask:end","rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","rect-mask:hide"]}]});$i("brush",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:j0,action:["brush:start","rect-mask:start","rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:j0,action:["rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:j0,action:["brush:filter","brush:end","rect-mask:end","rect-mask:hide","reset-button:show"]}],rollback:[{trigger:"reset-button:click",action:["brush:reset","reset-button:hide","cursor:crosshair"]}]});$i("brush-visible",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"plot:mousedown",action:["rect-mask:start","rect-mask:show"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end","rect-mask:hide","element-filter:filter","element-range-highlight:clear"]}],rollback:[{trigger:"dblclick",action:["element-filter:clear"]}]});$i("brush-x",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:j0,action:["brush-x:start","x-rect-mask:start","x-rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:j0,action:["x-rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:j0,action:["brush-x:filter","brush-x:end","x-rect-mask:end","x-rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]});$i("element-path-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:j0,action:"path-mask:start"},{trigger:"mousedown",isEnable:j0,action:"path-mask:show"}],processing:[{trigger:"mousemove",action:"path-mask:addPoint"}],end:[{trigger:"mouseup",action:"path-mask:end"}],rollback:[{trigger:"dblclick",action:"path-mask:hide"}]});$i("element-single-selected",{start:[{trigger:"element:click",action:"element-single-selected:toggle"}]});$i("legend-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:["cursor:pointer","list-radio:show"]},{trigger:"legend-item:mouseleave",action:["cursor:default","list-radio:hide"]}],start:[{trigger:"legend-item:click",isEnable:function(e){return!e.isInShape("legend-item-radio")},action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","data-filter:filter","list-radio:show"]},{trigger:"legend-item-radio:mouseenter",action:["list-radio:showTip"]},{trigger:"legend-item-radio:mouseleave",action:["list-radio:hideTip"]},{trigger:"legend-item-radio:click",action:["list-focus:toggle","data-filter:filter","list-radio:show"]}]});$i("continuous-filter",{start:[{trigger:"legend:valuechanged",action:"data-filter:filter"}]});$i("continuous-visible-filter",{start:[{trigger:"legend:valuechanged",action:"element-filter:filter"}]});$i("legend-visible-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:"cursor:pointer"},{trigger:"legend-item:mouseleave",action:"cursor:default"}],start:[{trigger:"legend-item:click",action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","element-filter:filter"]}]});$i("active-region",{start:[{trigger:"plot:mousemove",action:"active-region:show"}],end:[{trigger:"plot:mouseleave",action:"active-region:hide"}]});$i("axis-description",{start:[{trigger:"axis-description:mousemove",action:"axis-description:show"}],end:[{trigger:"axis-description:mouseleave",action:"axis-description:hide"}]});function a9(e){return e.gEvent.preventDefault(),e.gEvent.originalEvent.deltaY>0}$i("view-zoom",{start:[{trigger:"plot:mousewheel",isEnable:function(e){return a9(e.event)},action:"scale-zoom:zoomOut",throttle:{wait:100,leading:!0,trailing:!1}},{trigger:"plot:mousewheel",isEnable:function(e){return!a9(e.event)},action:"scale-zoom:zoomIn",throttle:{wait:100,leading:!0,trailing:!1}}]});$i("sibling-tooltip",{start:[{trigger:"plot:mousemove",action:"sibling-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"sibling-tooltip:hide"}]});$i("plot-mousewheel-scroll",{start:[{trigger:"plot:mousewheel",action:"mousewheel-scroll:scroll"}]});function Ei(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return function(t){return e.reduce(function(n,i){return i(n)},t)}}function Ao(e,r){var t={};return e!==null&&typeof e=="object"&&r.forEach(function(n){var i=e[n];i!==void 0&&(t[n]=i)}),t}function kJ(e,r){return r?cf(r,function(t,n,i){return t.replace(new RegExp("{\\s*"+i+"\\s*}","g"),n)},e):e}var E5=function(e,r){return E5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},E5(e,r)};function ji(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");E5(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var nt=function(){return nt=Object.assign||function(r){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},nt.apply(this,arguments)};function fh(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t}function nu(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;for(var n=Array(e),i=0,r=0;r<t;r++)for(var a=arguments[r],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}var Kv;(function(e){e.ERROR="error",e.WARN="warn",e.INFO="log"})(Kv||(Kv={}));var NAe="AntV/G2Plot";function zAe(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var n=0;return NAe+": "+e.replace(/%s/g,function(){return""+r[n++]})}function Cy(e,r,t){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];r||console[e](zAe.apply(void 0,nu([t],n)))}function S5(e){if(!e)return{width:0,height:0};var r=getComputedStyle(e);return{width:(e.clientWidth||parseInt(r.width,10))-parseInt(r.paddingLeft,10)-parseInt(r.paddingRight,10),height:(e.clientHeight||parseInt(r.height,10))-parseInt(r.paddingTop,10)-parseInt(r.paddingBottom,10)}}function hf(e,r){return e.geometries.find(function(t){return t.type===r})}function ZM(e){return cf(e.geometries,function(r,t){return r.concat(t.elements)},[])}function _E(e){return Ie(e,["views","length"],0)<=0?ZM(e):cf(e.views,function(r,t){return r.concat(_E(t))},ZM(e))}function $Ae(e){return Ie(e,["views","length"],0)<=0?e.geometries:cf(e.views,function(r,t){return r.concat(t.geometries)},e.geometries)}function aa(e,r){return e.views.find(function(t){return t.id===r})}function bC(e){var r=e.parent;return r?r.views:[]}function o9(e){return bC(e).filter(function(r){return r!==e})}function uc(e){if(!Zd(e,"Object"))return e;var r=nt({},e);return r.formatter&&!r.content&&(r.content=r.formatter),r}function UAe(e,r){var t=[];if(e.length){t.push(["M",e[0].x,e[0].y]);for(var n=1,i=e.length;n<i;n+=1){var a=e[n];t.push(["L",a.x,a.y])}r&&t.push(["Z"])}return t}var VAe=function(e,r,t,n){var i=[],a,o,s=!!n,u,l;if(s){u=[1/0,1/0],l=[-1/0,-1/0];for(var f=0,h=e.length;f<h;f++){var p=e[f];u=Ac([0,0],u,p),l=Tc([0,0],l,p)}u=Ac([0,0],u,n[0]),l=Tc([0,0],l,n[1])}for(var f=0,v=e.length;f<v;f++){var p=e[f];if(t)a=e[f?f-1:v-1],o=e[(f+1)%v];else if(f===0||f===v-1){i.push(p);continue}else a=e[f-1],o=e[f+1];var m=[0,0];m=Xp(m,o,a),m=ah(m,m,r);var x=c2(p,a),E=c2(p,o),A=x+E;A!==0&&(x/=A,E/=A);var L=ah([0,0],m,-x),k=ah([0,0],m,E),R=Xo([0,0],p,L),D=Xo([0,0],p,k);s&&(R=Tc([0,0],R,u),R=Ac([0,0],R,l),D=Tc([0,0],D,u),D=Ac([0,0],D,l)),i.push(R),i.push(D)}return t&&i.push(i.shift()),i};function GAe(e,r,t){for(var n=!!r,i=[],a=0,o=e.length;a<o;a+=2)i.push([e[a],e[a+1]]);for(var s=VAe(i,.4,n,t),u=i.length,l=[],f,h,p,a=0;a<u-1;a++)f=s[a*2],h=s[a*2+1],p=i[a+1],l.push(["C",f[0],f[1],h[0],h[1],p[0],p[1]]);return n&&(f=s[u],h=s[u+1],p=i[0],l.push(["C",f[0],f[1],h[0],h[1],p[0],p[1]])),l}function HAe(e,r,t){var n=[],i=e[0],a=null;if(e.length<=2)return UAe(e,r);for(var o=0,s=e.length;o<s;o++){var u=e[o];(!a||!(a.x===u.x&&a.y===u.y))&&(n.push(u.x),n.push(u.y),a=u)}var l=t||[[0,0],[1,1]],f=GAe(n,r,l);return f.unshift(["M",i.x,i.y]),f}var jAe=5,WAe={}.toString,PJ=function(e,r){return WAe.call(e)==="[object "+r+"]"},XAe=function(e){return PJ(e,"Array")},YAe=function(e){return typeof e=="object"&&e!==null},s9=function(e){if(!YAe(e)||!PJ(e,"Object"))return!1;for(var r=e;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r},RJ=function(e,r,t,n){t=t||0,n=n||jAe;for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){var a=r[i];a?s9(a)?(s9(e[i])||(e[i]={}),t<n?RJ(e[i],a,t+1,n):e[i]=r[i]):XAe(a)?(e[i]=[],e[i]=e[i].concat(a)):e[i]=a:e[i]=a}},Dt=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=0;n<r.length;n+=1)RJ(e,r[n]);return e};function u9(e){if(!e)return e;var r=e.match(/(([A-Z]{0,1}[a-z]*[^A-Z])|([A-Z]{1}))/g);return r.map(function(t){return t.toLowerCase()}).join("-")}function OJ(e){var r={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",display:"flex",justifyContent:"center",alignItems:"center"},t=["stroke","lineWidth","shadowColor","strokeOpacity","shadowBlur","shadowOffsetX","shadowOffsetY","fill"];Ie(e,"fill")&&(r.color=e.fill);var n=Ao(e,t),i=n.shadowColor,a=n.shadowBlur,o=a===void 0?0:a,s=n.shadowOffsetX,u=s===void 0?0:s,l=n.shadowOffsetY,f=l===void 0?0:l;r["text-shadow"]=""+[i,u+"px",f+"px",o+"px"].join(" ");var h=Ao(e,t),p=h.stroke,v=h.lineWidth,m=v===void 0?0:v;return r["-webkit-text-stroke"]=""+[m+"px",p].join(" "),we(e,function(x,E){["fontSize"].includes(E)&&xi(x)?r[u9(E)]=x+"px":E&&!t.includes(E)&&(r[u9(E)]=""+x)}),r}function FJ(e,r){e.style["pointer-events"]="none",we(r,function(t,n){n&&t&&(e.style[n]=t)})}var NI=function(e,r,t){var n=r.statistic,i=r.plotType,a=n.title,o=n.content;[a,o].forEach(function(s,u){if(!!s){var l="";u===0?l=o?"translate(-50%, -100%)":"translate(-50%, -50%)":l=a?"translate(-50%, 0)":"translate(-50%, -50%)";var f=kn(s.style)?s.style(t):s.style;e.annotation().html(nt({position:["50%","50%"],html:function(h,p){var v=p.getCoordinate(),m=0;if(i==="pie"||i==="ring-progress")m=v.getRadius()*v.innerRadius*2;else if(i==="liquid"){var x=Ie(p.geometries,[0,"elements",0,"shape"]);if(x){var E=x.find(function(R){return R.get("name")==="wrap"}),A=E.getCanvasBBox().width;m=A}}else m||(m=v.getWidth());FJ(h,nt({width:m+"px",transform:l},OJ(f)));var L=p.getData();if(s.customHtml)return s.customHtml(h,p,t,L);var k=s.content;return s.formatter&&(k=s.formatter(t,L)),k?ei(k)?k:""+k:"<div></div>"},key:(u===0?"top":"bottom")+"-statistic"},Ao(s,["offsetX","offsetY","rotate","style","formatter"])))}})},ZAe=function(e,r,t){var n=r.statistic,i=n.title,a=n.content;[i,a].forEach(function(o){if(!!o){var s=kn(o.style)?o.style(t):o.style;e.annotation().html(nt({position:["50%","100%"],html:function(u,l){var f=l.getCoordinate(),h=l.views[0].getCoordinate(),p=h.getCenter(),v=h.getRadius(),m=Math.max(Math.sin(h.startAngle),Math.sin(h.endAngle))*v,x=p.y+m-f.y.start-parseFloat(Ie(s,"fontSize",0)),E=f.getRadius()*f.innerRadius*2;FJ(u,nt({width:E+"px",transform:"translate(-50%, "+x+"px)"},OJ(s)));var A=l.getData();if(o.customHtml)return o.customHtml(u,l,t,A);var L=o.content;return o.formatter&&(L=o.formatter(t,A)),L?ei(L)?L:""+L:"<div></div>"}},Ao(o,["offsetX","offsetY","rotate","style","formatter"])))}})},RR;function qAe(){return RR||(RR=document.createElement("canvas").getContext("2d")),RR}v1(function(e,r){r===void 0&&(r={});var t=r.fontSize,n=r.fontFamily,i=n===void 0?"sans-serif":n,a=r.fontWeight,o=r.fontStyle,s=r.fontVariant,u=qAe();u.font=[o,a,s,t+"px",i].join(" ");var l=u.measureText(ei(e)?e:"");return l.width},function(e,r){return r===void 0&&(r={}),nu([e],F2(r)).join("")});function e1(e){return typeof e=="number"&&!isNaN(e)}function KAe(e,r,t){var n=Math.min(r,t),i=Math.max(r,t);return e>=n&&e<=i}function V4(e,r){if(!e)return{};var t=e.filter(function(a){var o=Ie(a,[r]);return xi(o)&&!isNaN(o)}),n=t.every(function(a){return Ie(a,[r])>=0}),i=t.every(function(a){return Ie(a,[r])<=0});return n?{min:0}:i?{max:0}:{}}function DJ(e,r,t,n,i){if(i===void 0&&(i=[]),!Array.isArray(e))return{nodes:[],links:[]};var a=[],o={},s=-1;return e.forEach(function(u){var l=u[r],f=u[t],h=u[n],p=Ao(u,i);o[l]||(o[l]=nt({id:++s,name:l},p)),o[f]||(o[f]=nt({id:++s,name:f},p)),a.push(nt({source:o[l].id,target:o[f].id,value:h},p))}),{nodes:Object.values(o).sort(function(u,l){return u.id-l.id}),links:a}}function m2(e,r){var t=kc(e,function(n){var i=n[r];return i===null||typeof i=="number"&&!isNaN(i)});return Cy(Kv.WARN,t.length===e.length,"illegal data existed in chart data."),t}function t_(e){if(xi(e))return[e,e,e,e];if(ar(e)){var r=e.length;if(r===1)return[e[0],e[0],e[0],e[0]];if(r===2)return[e[0],e[1],e[0],e[1]];if(r===3)return[e[0],e[1],e[2],e[1]];if(r===4)return e}return[0,0,0,0]}function zI(e,r,t){r===void 0&&(r="bottom"),t===void 0&&(t=25);var n=t_(e),i=[r.startsWith("top")?t:0,r.startsWith("right")?t:0,r.startsWith("bottom")?t:0,r.startsWith("left")?t:0];return[n[0]+i[0],n[1]+i[1],n[2]+i[2],n[3]+i[3]]}function G4(e){var r=e.map(function(n){return t_(n)}),t=[0,0,0,0];return r.length>0&&(t=t.map(function(n,i){return r.forEach(function(a,o){n+=r[o][i]}),n})),t}var QAe={locale:"en-US"},eM={};function BJ(e,r){eM[e]=r}function $I(e){return{get:function(r,t){return kJ(Ie(eM[e],r)||Ie(eM[QAe.locale],r)||Ie(eM["en-US"],r)||r,t)}}}var JAe={locale:"en-US",general:{increase:"Increase",decrease:"Decrease",root:"Root"},statistic:{total:"Total"},conversionTag:{label:"Rate"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"Total"}},eTe={locale:"zh-CN",general:{increase:"\u589E\u52A0",decrease:"\u51CF\u5C11",root:"\u521D\u59CB"},statistic:{total:"\u603B\u8BA1"},conversionTag:{label:"\u8F6C\u5316\u7387"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"\u603B\u8BA1"}},Hx={},y2={},NJ={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=1,t=function(){return"".concat(r++)};e.default=t})(NJ);var UI={},VI={},H4={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,a=null;return function(){for(var o=this,s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];clearTimeout(a),a=setTimeout(function(){n.apply(o,u)},i)}};e.default=r})(H4);var fy={};Object.defineProperty(fy,"__esModule",{value:!0});fy.SensorTabIndex=fy.SensorClassName=fy.SizeSensorId=void 0;var tTe="size-sensor-id";fy.SizeSensorId=tTe;var rTe="size-sensor-object";fy.SensorClassName=rTe;var nTe="-1";fy.SensorTabIndex=nTe;Object.defineProperty(VI,"__esModule",{value:!0});VI.createSensor=void 0;var iTe=aTe(H4),l9=fy;function aTe(e){return e&&e.__esModule?e:{default:e}}var oTe=function(r){var t=void 0,n=[],i=function(){getComputedStyle(r).position==="static"&&(r.style.position="relative");var f=document.createElement("object");return f.onload=function(){f.contentDocument.defaultView.addEventListener("resize",a),a()},f.style.display="block",f.style.position="absolute",f.style.top="0",f.style.left="0",f.style.height="100%",f.style.width="100%",f.style.overflow="hidden",f.style.pointerEvents="none",f.style.zIndex="-1",f.style.opacity="0",f.setAttribute("class",l9.SensorClassName),f.setAttribute("tabindex",l9.SensorTabIndex),f.type="text/html",r.appendChild(f),f.data="about:blank",f},a=(0,iTe.default)(function(){n.forEach(function(l){l(r)})}),o=function(f){t||(t=i()),n.indexOf(f)===-1&&n.push(f)},s=function(){t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",a),t.parentNode.removeChild(t),t=void 0,n=[])},u=function(f){var h=n.indexOf(f);h!==-1&&n.splice(h,1),n.length===0&&t&&s()};return{element:r,bind:o,destroy:s,unbind:u}};VI.createSensor=oTe;var GI={};Object.defineProperty(GI,"__esModule",{value:!0});GI.createSensor=void 0;var sTe=uTe(H4);function uTe(e){return e&&e.__esModule?e:{default:e}}var lTe=function(r){var t=void 0,n=[],i=(0,sTe.default)(function(){n.forEach(function(l){l(r)})}),a=function(){var f=new ResizeObserver(i);return f.observe(r),i(),f},o=function(f){t||(t=a()),n.indexOf(f)===-1&&n.push(f)},s=function(){t.disconnect(),n=[],t=void 0},u=function(f){var h=n.indexOf(f);h!==-1&&n.splice(h,1),n.length===0&&t&&s()};return{element:r,bind:o,destroy:s,unbind:u}};GI.createSensor=lTe;Object.defineProperty(UI,"__esModule",{value:!0});UI.createSensor=void 0;var cTe=VI,fTe=GI,hTe=typeof ResizeObserver!="undefined"?fTe.createSensor:cTe.createSensor;UI.createSensor=hTe;Object.defineProperty(y2,"__esModule",{value:!0});y2.removeSensor=y2.getSensor=void 0;var pTe=vTe(NJ),dTe=UI,qM=fy;function vTe(e){return e&&e.__esModule?e:{default:e}}var VC={},gTe=function(r){var t=r.getAttribute(qM.SizeSensorId);if(t&&VC[t])return VC[t];var n=(0,pTe.default)();r.setAttribute(qM.SizeSensorId,n);var i=(0,dTe.createSensor)(r);return VC[n]=i,i};y2.getSensor=gTe;var mTe=function(r){var t=r.element.getAttribute(qM.SizeSensorId);r.element.removeAttribute(qM.SizeSensorId),r.destroy(),t&&VC[t]&&delete VC[t]};y2.removeSensor=mTe;Object.defineProperty(Hx,"__esModule",{value:!0});Hx.ver=Hx.clear=zJ=Hx.bind=void 0;var A5=y2,yTe=function(r,t){var n=(0,A5.getSensor)(r);return n.bind(t),function(){n.unbind(t)}},zJ=Hx.bind=yTe,_Te=function(r){var t=(0,A5.getSensor)(r);(0,A5.removeSensor)(t)};Hx.clear=_Te;var xTe="1.0.1";Hx.ver=xTe;var c9="data-chart-source-type",$J=["padding","appendPadding","renderer","pixelRatio","syncViewPadding","supportCSSTransform","limitInPlot"],Ui=function(e){ji(r,e);function r(t,n){var i=e.call(this)||this;return i.container=typeof t=="string"?document.getElementById(t):t,i.options=Dt({},i.getDefaultOptions(),n),i.createG2(),i.bindEvents(),i}return r.getDefaultOptions=function(){return{renderer:"canvas",xAxis:{nice:!0,label:{autoRotate:!1,autoHide:{type:"equidistance",cfg:{minGap:6}}}},yAxis:{nice:!0,label:{autoHide:!0,autoRotate:!1}},animation:!0}},r.prototype.createG2=function(){var t=this.options,n=t.width,i=t.height,a=t.defaultInteractions;this.chart=new H2e(nt(nt(nt(nt({container:this.container,autoFit:!1},this.getChartSize(n,i)),{localRefresh:!1}),Ao(this.options,$J)),{defaultInteractions:a})),this.container.setAttribute(c9,"G2Plot")},r.prototype.getChartSize=function(t,n){var i=S5(this.container);return{width:t||i.width||400,height:n||i.height||400}},r.prototype.bindEvents=function(){var t=this;this.chart&&this.chart.on("*",function(n){n!=null&&n.type&&t.emit(n.type,n)})},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.render=function(){this.chart.clear(),this.chart.options={data:[],animate:!0},this.chart.views=[],this.execAdaptor(),this.chart.render(),this.bindSizeSensor()},r.prototype.update=function(t){this.updateOption(t),this.render()},r.prototype.updateOption=function(t){this.options=Dt({},this.options,t)},r.prototype.setState=function(t,n,i){i===void 0&&(i=!0);var a=_E(this.chart);we(a,function(o){n(o.getData())&&o.setState(t,i)})},r.prototype.getStates=function(){var t=_E(this.chart),n=[];return we(t,function(i){var a=i.getData(),o=i.getStates();we(o,function(s){n.push({data:a,state:s,geometry:i.geometry,element:i})})}),n},r.prototype.changeData=function(t){this.update({data:t})},r.prototype.changeSize=function(t,n){this.chart.changeSize(t,n)},r.prototype.addAnnotations=function(t,n){n=n||this.chart;var i=nu(t),a=n.getController("annotation"),o=a.getComponents().map(function(l){return l.extra});a.clear(!0);for(var s=function(l){var f=o[l],h=i.findIndex(function(p){return p.id&&p.id===f.id});h!==-1&&(f=Dt({},f,i[h]),i.splice(h,1)),a.annotation(f)},u=0;u<o.length;u++)s(u);i.forEach(function(l){return a.annotation(l)}),n.render(!0)},r.prototype.removeAnnotations=function(t){var n=this.chart.getController("annotation"),i=n.getComponents().map(function(s){return s.extra});n.clear(!0);for(var a=function(s){var u=i[s];t.find(function(l){return l.id&&l.id===u.id})||n.annotation(u)},o=0;o<i.length;o++)a(o);this.chart.render(!0)},r.prototype.destroy=function(){this.unbindSizeSensor(),this.chart.destroy(),this.off(),this.container.removeAttribute(c9)},r.prototype.execAdaptor=function(){var t=this.getSchemaAdaptor(),n=this.options,i=n.padding,a=n.appendPadding;this.chart.padding=i,this.chart.appendPadding=a,t({chart:this.chart,options:this.options})},r.prototype.triggerResize=function(){this.chart.forceFit()},r.prototype.bindSizeSensor=function(){var t=this;if(!this.unbind){var n=this.options.autoFit,i=n===void 0?!0:n;i&&(this.unbind=zJ(this.container,function(){var a=S5(t.container),o=a.width,s=a.height;(o!==t.chart.width||s!==t.chart.height)&&t.triggerResize()}))}},r.prototype.unbindSizeSensor=function(){this.unbind&&(this.unbind(),this.unbind=void 0)},r}(iI),sp=["type","alias","tickCount","tickInterval","min","max","nice","minLimit","maxLimit","range","tickMethod","base","exponent","mask","sync"];function HI(){return typeof window=="object"?window==null?void 0:window.devicePixelRatio:2}function j4(e,r){r===void 0&&(r=e);var t=document.createElement("canvas"),n=HI();t.width=e*n,t.height=r*n,t.style.width=e+"px",t.style.height=r+"px";var i=t.getContext("2d");return i.scale(n,n),t}function W4(e,r,t,n){n===void 0&&(n=t);var i=r.backgroundColor,a=r.opacity;e.globalAlpha=a,e.fillStyle=i,e.beginPath(),e.fillRect(0,0,t,n),e.closePath()}function UJ(e,r,t){var n=e+r;return t?n*2:n}function VJ(e,r){var t=r?[[e*.25,e*.25],[e*.75,e*.75]]:[[e*.5,e*.5]];return t}function X4(e,r){var t=r*Math.PI/180,n={a:Math.cos(t)*(1/e),b:Math.sin(t)*(1/e),c:-Math.sin(t)*(1/e),d:Math.cos(t)*(1/e),e:0,f:0};return n}var bTe={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function wTe(e,r,t,n){var i=r.size,a=r.fill,o=r.lineWidth,s=r.stroke,u=r.fillOpacity;e.beginPath(),e.globalAlpha=u,e.fillStyle=a,e.strokeStyle=s,e.lineWidth=o,e.arc(t,n,i/2,0,2*Math.PI,!1),e.fill(),o&&e.stroke(),e.closePath()}function CTe(e){var r=Dt({},bTe,e),t=r.size,n=r.padding,i=r.isStagger,a=r.rotation,o=UJ(t,n,i),s=VJ(o,i),u=j4(o,o),l=u.getContext("2d");W4(l,r,o);for(var f=0,h=s;f<h.length;f++){var p=h[f],v=p[0],m=p[1];wTe(l,r,v,m)}var x=l.createPattern(u,"repeat");if(x){var E=HI(),A=X4(E,a);x.setTransform(A)}return x}var ETe={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function STe(e,r,t){var n=r.stroke,i=r.lineWidth,a=r.strokeOpacity,o=new Path2D(t);e.globalAlpha=a,e.lineCap="square",e.strokeStyle=i?n:"transparent",e.lineWidth=i,e.stroke(o)}function ATe(e){var r=Dt({},ETe,e),t=r.spacing,n=r.rotation,i=r.lineWidth,a=t+i||1,o=t+i||1,s=`
            M 0 0 L `+a+` 0
            M 0 `+o+" L "+a+" "+o+`
            `,u=j4(a,o),l=u.getContext("2d");W4(l,r,a,o),STe(l,r,s);var f=l.createPattern(u,"repeat");if(f){var h=HI(),p=X4(h,n);f.setTransform(p)}return f}var TTe={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function MTe(e,r,t,n){var i=r.stroke,a=r.size,o=r.fill,s=r.lineWidth,u=r.fillOpacity;e.globalAlpha=u,e.strokeStyle=i,e.lineWidth=s,e.fillStyle=o,e.strokeRect(t-a/2,n-a/2,a,a),e.fillRect(t-a/2,n-a/2,a,a)}function LTe(e){var r=Dt({},TTe,e),t=r.size,n=r.padding,i=r.isStagger,a=r.rotation,o=UJ(t,n,i),s=VJ(o,i),u=j4(o,o),l=u.getContext("2d");W4(l,r,o);for(var f=0,h=s;f<h.length;f++){var p=h[f],v=p[0],m=p[1];MTe(l,r,v,m)}var x=l.createPattern(u,"repeat");if(x){var E=HI(),A=X4(E,a);x.setTransform(A)}return x}function ITe(e){var r=e.type,t=e.cfg,n;switch(r){case"dot":n=CTe(t);break;case"line":n=ATe(t);break;case"square":n=LTe(t);break}return n}function nd(e){var r=this;return function(t){var n,i=t.options,a=t.chart,o=i.pattern;if(!o)return t;var s=function(u){for(var l,f,h,p=[],v=1;v<arguments.length;v++)p[v-1]=arguments[v];var m=a.getTheme().defaultColor,x=m,E=(f=(l=a.geometries)===null||l===void 0?void 0:l[0])===null||f===void 0?void 0:f.getAttribute("color");if(E){var A=E.getFields()[0],L=Ie(u,A);x=dp.getMappingValue(E,L,((h=E.values)===null||h===void 0?void 0:h[0])||m)}var k=o;typeof o=="function"&&(k=o.call(r,u,x)),k instanceof CanvasPattern||(k=ITe(Dt({},{cfg:{backgroundColor:x}},k)));var R=i[e];return nt(nt({},typeof R=="function"?R.call.apply(R,nu([r,u],p)):R||{}),{fill:k||x})};return Dt({},t,{options:(n={},n[e]=s,n)})}}function G2(e){var r=e.chart,t=e.options,n=t.legend,i=t.colorField,a=t.seriesField;return n===!1?r.legend(!1):(i||a)&&r.legend(i||a,n),e}function Ul(e){var r=e.chart,t=e.options,n=t.tooltip;return n!==void 0&&r.tooltip(n),e}function ks(e){var r=e.chart,t=e.options,n=t.interactions;return we(n,function(i){i.enable===!1?r.removeInteraction(i.type):r.interaction(i.type,i.cfg||{})}),e}function Po(e){var r=e.chart,t=e.options,n=t.animation;return typeof n=="boolean"?r.animate(n):r.animate(!0),we(r.geometries,function(i){i.animate(n)}),e}function Xa(e){var r=e.chart,t=e.options,n=t.theme;return n&&r.theme(n),e}function b_(e){var r=e.chart,t=e.options,n=t.state;return n&&we(r.geometries,function(i){i.state(n)}),e}function xS(e){var r=e.chart,t=e.options,n=t.slider;return r.option("slider",n),e}function Y4(e){var r=e.chart,t=e.options,n=t.scrollbar;return r.option("scrollbar",n),e}function ku(e,r){return function(t){var n=t.chart,i=t.options,a={};return we(e,function(o,s){a[s]=Ao(o,sp)}),a=Dt({},r,i.meta,a),n.scale(a),t}}function mu(e){return function(r){var t=r.chart,n=r.options,i=t.getController("annotation");return we(nu(n.annotations||[],e||[]),function(a){i.annotation(a)}),r}}function t1(e){var r=e.chart,t=e.options,n=t.yAxis,i=t.limitInPlot,a=i;return xo(n)&&rr(i)&&(Object.values(Ao(n,["min","max","minLimit","maxLimit"])).some(function(o){return!rr(o)})?a=!0:a=!1),r.limitInPlot=a,e}function GJ(e){return e===void 0&&(e="rect"),function(r){var t=r.chart,n=r.options,i=n.coordinate,a=Array.from(i||[]).map(function(o){return o.type==="reflectX"?["reflect","x"]:o.type==="reflectY"?["reflect","y"]:o.type==="transpose"?["transpose"]:null}).filter(function(o){return!!o});return a.length!==0&&t.coordinate({type:e,actions:a}),r}}function Qd(e,r){if(e===!1)return{fields:!1};var t=Ie(e,"fields"),n=Ie(e,"formatter");return n&&!t&&(t=r),{fields:t,formatter:n}}function JA(e,r){var t=e.type,n=e.xField,i=e.yField,a=e.colorField,o=e.shapeField,s=e.sizeField,u=e.styleField,l=e.rawFields,f=l===void 0?[]:l,h=[];if(r==="color")h=nu([a||n],f);else if(r==="shape")h=nu([o||n],f);else if(r==="size")h=nu([s||n],f);else{h=nu([n,i,a,o,s,u],f);var p=["x","y","color","shape","size","style"].indexOf(r),v=h[p];h.splice(p,1),h.unshift(v)}var m=Z0(h.filter(function(E){return!!E})),x=t==="line"&&[n,i].includes(m.join("*"))?"":m.join("*");return{mappingFields:m,tileMappingField:x}}function Ob(e,r){if(!!r)return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i={};return e.forEach(function(a,o){i[a]=t[o]}),delete i.undefined,r(i)}}function _p(e){var r=e.chart,t=e.options,n=t.type,i=t.args,a=t.mapping,o=t.xField,s=t.yField,u=t.colorField,l=t.shapeField,f=t.sizeField,h=t.tooltipFields,p=t.label,v=t.state,m=t.customInfo;if(!a)return e;var x=a.color,E=a.shape,A=a.size,L=a.style,k=a.tooltip,R=r[n](i).position(o+"*"+s);if(ei(x))u?R.color(u,x):R.color(x);else if(kn(x)){var D=JA(t,"color"),$=D.mappingFields,j=D.tileMappingField;R.color(j,Ob($,x))}else u&&R.color(u,x);if(ei(E))l?R.shape(l,[E]):R.shape(E);else if(kn(E)){var H=JA(t,"shape"),$=H.mappingFields,j=H.tileMappingField;R.shape(j,Ob($,E))}else l&&R.shape(l,E);if(xi(A))f?R.size(f,A):R.size(A);else if(kn(A)){var ee=JA(t,"size"),$=ee.mappingFields,j=ee.tileMappingField;R.size(j,Ob($,A))}else f&&R.size(f,A);if(kn(L)){var U=JA(t,"style"),$=U.mappingFields,j=U.tileMappingField;R.style(j,Ob($,L))}else xo(L)&&R.style(L);if(h===!1?R.tooltip(!1):uh(h)||R.tooltip(h.join("*"),Ob(h,k)),p===!1)R.label(!1);else if(p){var W=p.callback,Q=p.fields,te=fh(p,["callback","fields"]);R.label({fields:Q||[s],callback:W,cfg:uc(te)})}return v&&R.state(v),m&&R.customInfo(m),[o,s].filter(function(ie){return ie!==u}).forEach(function(ie){r.legend(ie,!1)}),nt(nt({},e),{ext:{geometry:R}})}function jI(e){var r=e.options,t=r.area,n=r.xField,i=r.yField,a=r.seriesField,o=r.smooth,s=r.tooltip,u=r.useDeferredLabel,l=Qd(s,[n,i,a]),f=l.fields,h=l.formatter;return t?_p(Dt({},e,{options:{type:"area",colorField:a,tooltipFields:f,mapping:nt({shape:o?"smooth":"area",tooltip:h},t),args:{useDeferredLabel:u}}})):e}function H2(e){var r=e.options,t=r.line,n=r.stepType,i=r.xField,a=r.yField,o=r.seriesField,s=r.smooth,u=r.connectNulls,l=r.tooltip,f=r.useDeferredLabel,h=Qd(l,[i,a,o]),p=h.fields,v=h.formatter;return t?_p(Dt({},e,{options:{type:"line",colorField:o,tooltipFields:p,mapping:yn({shape:n||(s?"smooth":"line"),tooltip:v},t),args:{connectNulls:u,useDeferredLabel:f}}})):e}function id(e){var r=e.options,t=r.point,n=r.xField,i=r.yField,a=r.seriesField,o=r.sizeField,s=r.shapeField,u=r.tooltip,l=r.useDeferredLabel,f=Qd(u,[n,i,a,o,s]),h=f.fields,p=f.formatter;return t?_p(Dt({},e,{options:{type:"point",colorField:a,shapeField:s,tooltipFields:h,mapping:nt({tooltip:p},t),args:{useDeferredLabel:l}}})):e}function kTe(e){var r=e.chart,t=e.options,n=e.ext,i=t.seriesField,a=t.isGroup,o=t.isStack,s=t.marginRatio,u=t.widthRatio,l=t.groupField,f=t.theme,h=[];if(i&&(a&&h.push({type:"dodge",dodgeBy:l||i,marginRatio:s}),o&&h.push({type:"stack",marginRatio:s})),h.length&&(n==null?void 0:n.geometry)){var p=n==null?void 0:n.geometry;p.adjust(h)}return rr(u)||r.theme(Dt({},xo(f)?f:zC(f),{columnWidthRatio:u})),e}function pf(e){var r=e.options,t=r.xField,n=r.yField,i=r.interval,a=r.seriesField,o=r.tooltip,s=r.minColumnWidth,u=r.maxColumnWidth,l=r.columnBackground,f=r.dodgePadding,h=r.intervalPadding,p=r.useDeferredLabel,v=Qd(o,[t,n,a]),m=v.fields,x=v.formatter,E=(i?_p(Dt({},e,{options:{type:"interval",colorField:a,tooltipFields:m,mapping:nt({tooltip:x},i),args:{dodgePadding:f,intervalPadding:h,minColumnWidth:s,maxColumnWidth:u,background:l,useDeferredLabel:p}}})):e).ext;return kTe(nt(nt({},e),{ext:E}))}function WI(e){var r=e.options,t=r.polygon,n=r.xField,i=r.yField,a=r.seriesField,o=r.tooltip,s=r.useDeferredLabel,u=Qd(o,[n,i,a]),l=u.fields,f=u.formatter;return t?_p(Dt({},e,{options:{type:"polygon",colorField:a,tooltipFields:l,mapping:nt({tooltip:f},t),args:{useDeferredLabel:s}}})):e}function HJ(e){var r=e.options,t=r.edge,n=r.xField,i=r.yField,a=r.seriesField,o=r.tooltip,s=r.useDeferredLabel,u=Qd(o,[n,i,a]),l=u.fields,f=u.formatter;return t?_p(Dt({},e,{options:{type:"edge",colorField:a,tooltipFields:l,mapping:nt({tooltip:f},t),args:{useDeferredLabel:s}}})):e}function Z4(e){var r=e.options,t=r.schema,n=r.xField,i=r.yField,a=r.seriesField,o=r.tooltip,s=r.useDeferredLabel,u=Qd(o,[n,i,a]),l=u.fields,f=u.formatter;return t?_p(Dt({},e,{options:{type:"schema",colorField:a,tooltipFields:l,mapping:nt({tooltip:f},t),args:{useDeferredLabel:s}}})):e}function PTe(e){var r=e.options,t=r.violin,n=r.xField,i=r.yField,a=r.seriesField,o=r.sizeField,s=r.tooltip,u=Qd(s,[n,i,a,o]),l=u.fields,f=u.formatter;return t?_p(Dt({},e,{options:{type:"violin",colorField:a,tooltipFields:l,mapping:nt({tooltip:f},t)}})):e}function RTe(e){var r=e.chart,t=e.options,n=t.data,i=t.color,a=t.lineStyle,o=t.lineShape,s=t.point,u=t.area,l=t.seriesField,f=s==null?void 0:s.state,h=u==null?void 0:u.state;r.data(n);var p=Dt({},e,{options:{shapeField:l,line:{color:i,style:a,shape:o},point:s&&nt({color:i,shape:"circle"},s),area:u&&nt({color:i},u),label:void 0}}),v=Dt({},p,{options:{tooltip:!1,state:f}}),m=Dt({},p,{options:{tooltip:!1,state:h}});return H2(p),id(v),jI(m),e}function XI(e){var r,t,n=e.options,i=n.xAxis,a=n.yAxis,o=n.xField,s=n.yField,u=n.data;return Ei(ku((r={},r[o]=i,r[s]=a,r),(t={},t[o]={type:"cat"},t[s]=V4(u,s),t)))(e)}function OTe(e){var r=e.chart,t=e.options,n=t.reflect;if(n){var i=n;ar(i)||(i=[i]);var a=i.map(function(o){return["reflect",o]});r.coordinate({type:"rect",actions:a})}return e}function jJ(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return n===!1?r.axis(a,!1):r.axis(a,n),i===!1?r.axis(o,!1):r.axis(o,i),e}function WJ(e){var r=e.chart,t=e.options,n=t.legend,i=t.seriesField;return n&&i?r.legend(i,n):n===!1&&r.legend(!1),e}function FTe(e){var r=e.chart,t=e.options,n=t.label,i=t.yField,a=hf(r,"line");if(!n)a.label(!1);else{var o=n.callback,s=fh(n,["callback"]);a.label({fields:[i],callback:o,cfg:nt({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},uc(s))})}return e}function DTe(e){var r=e.chart,t=e.options,n=t.isStack;return n&&we(r.geometries,function(i){i.adjust("stack")}),e}function XJ(e){return Ei(RTe,XI,DTe,Xa,OTe,jJ,WJ,Ul,FTe,xS,Y4,ks,Po,mu(),t1)(e)}var BTe=Dt({},Ui.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},legend:{position:"top-left",radio:{}},isStack:!1}),NTe=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.active=function(){var t=this.getView(),n=this.context.event;if(n.data){var i=n.data.items,a=t.geometries.filter(function(o){return o.type==="point"});we(a,function(o){we(o.elements,function(s){var u=S3(i,function(l){return l.data===s.data})!==-1;s.setState("active",u)})})}},r.prototype.reset=function(){var t=this.getView(),n=t.geometries.filter(function(i){return i.type==="point"});we(n,function(i){we(i.elements,function(a){a.setState("active",!1)})})},r.prototype.getView=function(){return this.context.view},r}(Vs);hi("marker-active",NTe);$i("marker-active",{start:[{trigger:"tooltip:show",action:"marker-active:active"}],end:[{trigger:"tooltip:hide",action:"marker-active:reset"}]});var YJ=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="line",t}return r.getDefaultOptions=function(){return BTe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this,i=n.chart,a=n.options;XI({chart:i,options:a}),this.chart.changeData(t)},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return XJ},r}(Ui);function ZJ(e,r,t,n){var i=cf(e,function(a,o){var s=o[t],u=a.has(s)?a.get(s):0,l=o[r];return u=e1(l)?u+l:u,a.set(s,u),a},new Map);return gu(e,function(a){var o,s=a[r],u=a[t],l=e1(s)&&i.get(u)!==0?s/i.get(u):0;return nt(nt({},a),(o={},o[n]=l,o))})}function zTe(e,r,t,n){var i=cf(e,function(a,o){var s=cf(t,function(f,h){return""+f+o[h]},""),u=a.has(s)?a.get(s):0,l=o[r];return u=e1(l)?u+l:u,a.set(s,u),a},new Map);return gu(e,function(a){var o,s=a[r],u=cf(t,function(f,h){return""+f+a[h]},""),l=e1(s)&&i.get(u)!==0?s/i.get(u):0;return nt(nt({},a),(o={},o[n]=l,o))})}function bS(e,r,t,n,i){return i?ZJ(e,r,t,n):e}function $Te(e){var r=e.chart,t=e.options,n=t.data,i=t.areaStyle,a=t.color,o=t.point,s=t.line,u=t.isPercent,l=t.xField,f=t.yField,h=t.tooltip,p=t.seriesField,v=t.startOnZero,m=o==null?void 0:o.state,x=bS(n,f,l,f,u);r.data(x);var E=u?nt({formatter:function(R){return{name:R[p]||R[l],value:(Number(R[f])*100).toFixed(2)+"%"}}},h):h,A=Dt({},e,{options:{area:{color:a,style:i},point:o&&nt({color:a},o),tooltip:E,label:void 0,args:{startOnZero:v}}}),L={chart:r,options:Dt({line:{size:2}},cS(t,["state"]),{line:s&&nt({color:a},s),sizeField:p,state:s==null?void 0:s.state,tooltip:!1,label:void 0,args:{startOnZero:v}})},k=Dt({},A,{options:{tooltip:!1,state:m}});return jI(A),H2(L),id(k),e}function UTe(e){var r=e.chart,t=e.options,n=t.label,i=t.yField,a=hf(r,"area");if(!n)a.label(!1);else{var o=n.callback,s=fh(n,["callback"]);a.label({fields:[i],callback:o,cfg:nt({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},uc(s))})}return e}function VTe(e){var r=e.chart,t=e.options,n=t.isStack,i=t.isPercent,a=t.seriesField;return(i||n)&&a&&we(r.geometries,function(o){o.adjust("stack")}),e}function qJ(e){return Ei(Xa,nd("areaStyle"),GJ("rect"),$Te,XI,VTe,jJ,WJ,Ul,UTe,xS,mu(),ks,Po,t1)(e)}var GTe=Dt({},Ui.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},isStack:!0,line:{},legend:{position:"top-left",radio:{}}}),HTe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="area",t}return r.getDefaultOptions=function(){return GTe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this.options,i=n.isPercent,a=n.xField,o=n.yField,s=this,u=s.chart,l=s.options;XI({chart:u,options:l}),this.chart.changeData(bS(t,o,a,o,i))},r.prototype.getSchemaAdaptor=function(){return qJ},r}(Ui);function KJ(e,r){return!xi(e)||!xi(r)?"-":e===r?"100%":e===0?"\u221E":r===0?"-\u221E":(100*r/e).toFixed(2)+"%"}function jTe(e,r){return Dt({size:r?32:80,spacing:r?8:12,offset:r?32:0,arrow:e.arrow!==!1&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:e.text!==!1&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:KJ}},e)}function KM(e,r){return gu(r.getModel().points,function(t){return e.convertPoint(t)})}function WTe(e,r,t){var n=e.view,i=e.geometry,a=e.group,o=e.options,s=e.horizontal,u=o.offset,l=o.size,f=o.arrow,h=n.getCoordinate(),p=KM(h,r)[3],v=KM(h,t)[0],m=v.y-p.y,x=v.x-p.x;if(typeof f!="boolean"){var E=f.headSize,A=o.spacing,L;s?(x-E)/2<A?(A=Math.max(1,(x-E)/2),L=[[p.x+A,p.y-u],[p.x+A,p.y-u-l],[v.x-A,v.y-u-l/2]]):L=[[p.x+A,p.y-u],[p.x+A,p.y-u-l],[v.x-A-E,v.y-u-l],[v.x-A,v.y-u-l/2],[v.x-A-E,v.y-u]]:(m-E)/2<A?(A=Math.max(1,(m-E)/2),L=[[p.x+u,p.y+A],[p.x+u+l,p.y+A],[v.x+u+l/2,v.y-A]]):L=[[p.x+u,p.y+A],[p.x+u+l,p.y+A],[v.x+u+l,v.y-A-E],[v.x+u+l/2,v.y-A],[v.x+u,v.y-A-E]],a.addShape("polygon",{id:n.id+"-conversion-tag-arrow-"+i.getElementId(r.getModel().mappingData),name:"conversion-tag-arrow",origin:{element:r,nextElement:t},attrs:nt(nt({},f.style||{}),{points:L})})}}function XTe(e,r,t){var n,i,a,o=e.view,s=e.geometry,u=e.group,l=e.options,f=e.field,h=e.horizontal,p=l.offset,v=l.size;if(typeof l.text!="boolean"){var m=o.getCoordinate(),x=((n=l.text)===null||n===void 0?void 0:n.formatter)&&((i=l.text)===null||i===void 0?void 0:i.formatter(r.getData()[f],t.getData()[f])),E=KM(m,r)[h?3:0],A=KM(m,t)[h?0:3],L=u.addShape("text",{id:o.id+"-conversion-tag-text-"+s.getElementId(r.getModel().mappingData),name:"conversion-tag-text",origin:{element:r,nextElement:t},attrs:nt(nt({},((a=l.text)===null||a===void 0?void 0:a.style)||{}),{text:x,x:h?(E.x+A.x)/2:E.x+p+v/2,y:h?E.y-p-v/2:(E.y+A.y)/2})});if(h){var k=A.x-E.x,R=L.getBBox().width;if(R>k){var D=R/x.length,$=Math.max(1,Math.ceil(k/D)-1),j=x.slice(0,$)+"...";L.attr("text",j)}}}}function YTe(e,r,t){WTe(e,r,t),XTe(e,r,t)}function ZTe(e,r,t){return r===void 0&&(r=!0),t===void 0&&(t=!1),function(n){var i=n.options,a=n.chart,o=i.conversionTag,s=i.theme;return o&&!t&&(a.theme(Dt({},xo(s)?s:zC(s),{columnWidthRatio:1/3})),a.annotation().shape({render:function(u,l){var f=u.addGroup({id:a.id+"-conversion-tag-group",name:"conversion-tag-group"}),h=$d(a.geometries,function(m){return m.type==="interval"}),p={view:l,geometry:h,group:f,field:e,horizontal:r,options:jTe(o,r)},v=h.elements;we(v,function(m,x){x>0&&YTe(p,v[x-1],m)})}})),n}}var jx={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},q4=function(e,r){return e==="hover"?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:r}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:r}]}]};$i(jx.hover,{start:q4(jx.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]});$i(jx.click,{start:q4(jx.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});function qTe(e){return e===void 0&&(e=!1),function(r){var t=r.chart,n=r.options,i=n.connectedArea,a=function(){t.removeInteraction(jx.hover),t.removeInteraction(jx.click)};if(!e&&i){var o=i.trigger||"hover";a(),t.interaction(jx[o],{start:q4(o,i.style)})}else a();return r}}var KTe=10,QTe=5,JTe={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}},eMe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg=nt({name:"button"},JTe),t}return r.prototype.getButtonCfg=function(){var t=this.context.view,n=Ie(t,["interactions","filter-action","cfg","buttonConfig"]);return Dt(this.buttonCfg,n,this.cfg)},r.prototype.drawButton=function(){var t=this.getButtonCfg(),n=this.context.view.foregroundGroup.addGroup({name:t.name}),i=this.drawText(n);this.drawBackground(n,i.getBBox()),this.buttonGroup=n},r.prototype.drawText=function(t){var n,i=this.getButtonCfg();return t.addShape({type:"text",name:"button-text",attrs:nt({text:i.text},(n=i.textStyle)===null||n===void 0?void 0:n.default)})},r.prototype.drawBackground=function(t,n){var i,a=this.getButtonCfg(),o=t_(a.padding),s=t.addShape({type:"rect",name:"button-rect",attrs:nt({x:n.x-o[3],y:n.y-o[0],width:n.width+o[1]+o[3],height:n.height+o[0]+o[2]},(i=a.buttonStyle)===null||i===void 0?void 0:i.default)});return s.toBack(),t.on("mouseenter",function(){var u;s.attr((u=a.buttonStyle)===null||u===void 0?void 0:u.active)}),t.on("mouseleave",function(){var u;s.attr((u=a.buttonStyle)===null||u===void 0?void 0:u.default)}),s},r.prototype.resetPosition=function(){var t=this.context.view,n=t.getCoordinate(),i=n.convert({x:1,y:1}),a=this.buttonGroup,o=a.getBBox(),s=dp.transform(null,[["t",i.x-o.width-KTe,i.y+o.height+QTe]]);a.setMatrix(s)},r.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},r.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},r.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),e.prototype.destroy.call(this)},r}(Vs);hi("brush-reset-button",eMe,{name:"brush-reset-button"});$i("filter-action",{});function Gm(e){return e.isInPlot()}function _1(e,r,t){var n=t||{},i=n.mask,a=n.isStartEnable,o=r||"rect";switch(e){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:a||Gm,action:["brush:start",o+"-mask:start",o+"-mask:show"],arg:[null,{maskStyle:i==null?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Gm,action:[o+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Gm,action:["brush:filter","brush:end",o+"-mask:end",o+"-mask:hide","brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:default",isEnable:function(s){return a?!a(s):!1}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:a||function(s){return!s.isInShape("mask")},action:[o+"-mask:start",o+"-mask:show"],arg:[{maskStyle:i==null?void 0:i.style}]},{trigger:"mask:dragstart",action:[o+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[o+"-mask:resize"]},{trigger:"mask:drag",action:[o+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[o+"-mask:end"]},{trigger:"mask:dragend",action:[o+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(s){return!s.isInPlot()},action:["element-range-highlight:clear",o+"-mask:end",o+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",o+"-mask:hide"]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:a||Gm,action:["brush-x:start",o+"-mask:start",o+"-mask:show"],arg:[null,{maskStyle:i==null?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Gm,action:[o+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Gm,action:["brush-x:filter","brush-x:end",o+"-mask:end",o+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:a||function(s){return!s.isInShape("mask")},action:[o+"-mask:start",o+"-mask:show"],arg:[{maskStyle:i==null?void 0:i.style}]},{trigger:"mask:dragstart",action:[o+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[o+"-mask:resize"]},{trigger:"mask:drag",action:[o+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[o+"-mask:end"]},{trigger:"mask:dragend",action:[o+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(s){return!s.isInPlot()},action:["element-range-highlight:clear",o+"-mask:end",o+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",o+"-mask:hide"]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:a||Gm,action:["brush-y:start",o+"-mask:start",o+"-mask:show"],arg:[null,{maskStyle:i==null?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Gm,action:[o+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Gm,action:["brush-y:filter","brush-y:end",o+"-mask:end",o+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:a||function(s){return!s.isInShape("mask")},action:[o+"-mask:start",o+"-mask:show"],arg:[{maskStyle:i==null?void 0:i.style}]},{trigger:"mask:dragstart",action:[o+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[o+"-mask:resize"]},{trigger:"mask:drag",action:[o+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[o+"-mask:end"]},{trigger:"mask:dragend",action:[o+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(s){return!s.isInPlot()},action:["element-range-highlight:clear",o+"-mask:end",o+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",o+"-mask:hide"]}]};default:return{}}}$i("brush",_1("brush"));$i("brush-highlight",_1("brush-highlight"));$i("brush-x",_1("brush-x","x-rect"));$i("brush-y",_1("brush-y","y-rect"));$i("brush-x-highlight",_1("brush-x-highlight","x-rect"));$i("brush-y-highlight",_1("brush-y-highlight","y-rect"));var f9=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function QJ(e){var r=e.options,t=r.brush,n=kc(r.interactions||[],function(i){return f9.indexOf(i.type)===-1});return t!=null&&t.enabled&&(f9.forEach(function(i){var a=!1;switch(t.type){case"x-rect":a=i===(t.action==="highlight"?"brush-x-highlight":"brush-x");break;case"y-rect":a=i===(t.action==="highlight"?"brush-y-highlight":"brush-y");break;default:a=i===(t.action==="highlight"?"brush-highlight":"brush");break}var o={type:i,enable:a};t&&(o.cfg=_1(i,t.type,t)),n.push(o)}),(t==null?void 0:t.action)!=="highlight"&&n.push({type:"filter-action",cfg:{buttonConfig:t.button}})),Dt({},e,{options:{interactions:n}})}function tMe(e){var r=e.options,t=r.legend,n=r.seriesField,i=r.isStack;return n?t!==!1&&(t=nt({position:i?"right-top":"top-left"},t)):t=!1,e.options.legend=t,e}function rMe(e){var r=e.chart,t=e.options,n=t.data,i=t.columnStyle,a=t.color,o=t.columnWidthRatio,s=t.isPercent,u=t.isGroup,l=t.isStack,f=t.xField,h=t.yField,p=t.seriesField,v=t.groupField,m=t.tooltip,x=t.shape,E=s&&u&&l?zTe(n,h,[f,v],h):bS(n,h,f,h,s),A=[];l&&p&&!u?E.forEach(function(R){var D=A.find(function($){return $[f]===R[f]&&$[p]===R[p]});D?D[h]+=R[h]||0:A.push(nt({},R))}):A=E,r.data(A);var L=s?nt({formatter:function(R){return{name:u&&l?R[p]+" - "+R[v]:R[p]||R[f],value:(Number(R[h])*100).toFixed(2)+"%"}}},m):m,k=Dt({},e,{options:{data:A,widthRatio:o,tooltip:L,interval:{shape:x,style:i,color:a}}});return pf(k),k}function K4(e){var r,t,n=e.options,i=n.xAxis,a=n.yAxis,o=n.xField,s=n.yField,u=n.data,l=n.isPercent,f=l?{max:1,min:0,minLimit:0,maxLimit:1}:{};return Ei(ku((r={},r[o]=i,r[s]=a,r),(t={},t[o]={type:"cat"},t[s]=nt(nt({},V4(u,s)),f),t)))(e)}function nMe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return n===!1?r.axis(a,!1):r.axis(a,n),i===!1?r.axis(o,!1):r.axis(o,i),e}function iMe(e){var r=e.chart,t=e.options,n=t.legend,i=t.seriesField;return n&&i?r.legend(i,n):n===!1&&r.legend(!1),e}function aMe(e){var r=e.chart,t=e.options,n=t.label,i=t.yField,a=t.isRange,o=hf(r,"interval");if(!n)o.label(!1);else{var s=n.callback,u=fh(n,["callback"]);o.label({fields:[i],callback:s,cfg:nt({layout:u!=null&&u.position?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},uc(a?nt({content:function(l){var f;return(f=l[i])===null||f===void 0?void 0:f.join("-")}},u):u))})}return e}function oMe(e){var r=e.chart,t=e.options,n=t.tooltip,i=t.isGroup,a=t.isStack,o=t.groupField,s=t.data,u=t.xField,l=t.yField,f=t.seriesField;if(n===!1)r.tooltip(!1);else{var h=n;if(i&&a){var p=(h==null?void 0:h.formatter)||function(v){return{name:v[f]+" - "+v[o],value:v[l]}};h=nt(nt({},h),{customItems:function(v){var m=[];return we(v,function(x){var E=kc(s,function(A){return E3(A,Ao(x.data,[u,f]))});E.forEach(function(A){m.push(nt(nt(nt({},x),{value:A[l],data:A,mappingData:{_origin:A}}),p(A)))})}),m}})}r.tooltip(h)}return e}function YI(e,r){r===void 0&&(r=!1);var t=e.options,n=t.seriesField;return Ei(tMe,Xa,nd("columnStyle"),b_,GJ("rect"),rMe,K4,nMe,iMe,oMe,xS,Y4,aMe,QJ,ks,Po,mu(),ZTe(t.yField,!r,!!n),qTe(!t.isStack),t1)(e)}var sMe=Dt({},Ui.getDefaultOptions(),{columnWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),JJ=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="column",t}return r.getDefaultOptions=function(){return sMe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this.options,i=n.yField,a=n.xField,o=n.isPercent,s=this,u=s.chart,l=s.options;K4({chart:u,options:l}),this.chart.changeData(bS(t,i,a,i,o))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return YI},r}(Ui);function uMe(e){var r=e.options,t=r.xField,n=r.yField,i=r.xAxis,a=r.yAxis,o={left:"bottom",right:"top",top:"left",bottom:"right"},s=a!==!1?nt({position:o[(a==null?void 0:a.position)||"left"]},a):!1,u=i!==!1?nt({position:o[(i==null?void 0:i.position)||"bottom"]},i):!1;return nt(nt({},e),{options:nt(nt({},r),{xField:n,yField:t,xAxis:s,yAxis:u})})}function lMe(e){var r=e.options,t=r.label;return t&&!t.position&&(t.position="left",t.layout||(t.layout=[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}])),Dt({},e,{options:{label:t}})}function cMe(e){var r=e.options,t=r.seriesField,n=r.isStack,i=r.legend;return t?i!==!1&&(i=nt({position:n?"top-left":"right-top"},i||{})):i=!1,Dt({},e,{options:{legend:i}})}function fMe(e){var r=e.options,t=[{type:"transpose"},{type:"reflectY"}].concat(r.coordinate||[]);return Dt({},e,{options:{coordinate:t}})}function hMe(e){var r=e.chart,t=e.options,n=t.barStyle,i=t.barWidthRatio,a=t.minBarWidth,o=t.maxBarWidth,s=t.barBackground;return YI({chart:r,options:nt(nt({},t),{columnStyle:n,columnWidthRatio:i,minColumnWidth:a,maxColumnWidth:o,columnBackground:s})},!0)}function eee(e){return Ei(uMe,lMe,cMe,Ul,fMe,hMe)(e)}var pMe=Dt({},Ui.getDefaultOptions(),{barWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),dMe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="bar",t}return r.getDefaultOptions=function(){return pMe},r.prototype.changeData=function(t){var n,i;this.updateOption({data:t});var a=this,o=a.chart,s=a.options,u=s.isPercent,l=s.xField,f=s.yField,h=s.xAxis,p=s.yAxis;n=[f,l],l=n[0],f=n[1],i=[p,h],h=i[0],p=i[1];var v=nt(nt({},s),{xField:l,yField:f,yAxis:p,xAxis:h});K4({chart:o,options:v}),o.changeData(bS(t,l,f,l,u))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return eee},r}(Ui),tee=Dt({},Ui.getDefaultOptions(),{legend:{position:"right",radio:{}},tooltip:{shared:!1,showTitle:!1,showMarkers:!1},label:{layout:{type:"limit-in-plot",cfg:{action:"ellipsis"}}},pieStyle:{stroke:"white",lineWidth:1},statistic:{title:{style:{fontWeight:300,color:"#4B535E",textAlign:"center",fontSize:"20px",lineHeight:1}},content:{style:{fontWeight:"bold",color:"rgba(44,53,66,0.85)",textAlign:"center",fontSize:"32px",lineHeight:1}}},theme:{components:{annotation:{text:{animate:!1}}}}});function vMe(e,r){var t=null;return we(e,function(n){typeof n[r]=="number"&&(t+=n[r])}),t}function gMe(e,r){var t;switch(e){case"inner":return t="-30%",ei(r)&&r.endsWith("%")?parseFloat(r)*.01>0?t:r:r<0?r:t;case"outer":return t=12,ei(r)&&r.endsWith("%")?parseFloat(r)*.01<0?t:r:r>0?r:t;default:return r}}function QM(e,r){return eI(m2(e,r),function(t){return t[r]===0})}var mMe=[1,0,0,0,1,0,0,0,1];function T5(e,r){var t=nu(r||mMe);return dp.transform(t,e)}var yMe=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getActiveElements=function(){var t=dp.getDelegationObject(this.context);if(t){var n=this.context.view,i=t.component,a=t.item,o=i.get("field");if(o){var s=n.geometries[0].elements;return s.filter(function(u){return u.getModel().data[o]===a.value})}}return[]},r.prototype.getActiveElementLabels=function(){var t=this.context.view,n=this.getActiveElements(),i=t.geometries[0].labelsContainer.getChildren();return i.filter(function(a){return n.find(function(o){return rs(o.getData(),a.get("data"))})})},r.prototype.transfrom=function(t){t===void 0&&(t=7.5);var n=this.getActiveElements(),i=this.getActiveElementLabels();n.forEach(function(a,o){var s=i[o],u=a.geometry.coordinate;if(u.isPolar&&u.isTransposed){var l=dp.getAngle(a.getModel(),u),f=l.startAngle,h=l.endAngle,p=(f+h)/2,v=t,m=v*Math.cos(p),x=v*Math.sin(p);a.shape.setMatrix(T5([["t",m,x]])),s.setMatrix(T5([["t",m,x]]))}})},r.prototype.active=function(){this.transfrom()},r.prototype.reset=function(){this.transfrom(0)},r}(Vs);function _Me(e){var r=e.event,t,n=r.target;return n&&(t=n.get("element")),t}var xMe=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getAnnotations=function(t){var n=t||this.context.view;return n.getController("annotation").option},r.prototype.getInitialAnnotation=function(){return this.initialAnnotation},r.prototype.init=function(){var t=this,n=this.context.view;n.removeInteraction("tooltip"),n.on("afterchangesize",function(){var i=t.getAnnotations(n);t.initialAnnotation=i})},r.prototype.change=function(t){var n=this.context,i=n.view,a=n.event;this.initialAnnotation||(this.initialAnnotation=this.getAnnotations());var o=Ie(a,["data","data"]);if(a.type.match("legend-item")){var s=dp.getDelegationObject(this.context),u=i.getGroupedFields()[0];if(s&&u){var l=s.item;o=i.getData().find(function(v){return v[u]===l.value})}}if(o){var f=Ie(t,"annotations",[]),h=Ie(t,"statistic",{});i.getController("annotation").clear(!0),we(f,function(v){typeof v=="object"&&i.annotation()[v.type](v)}),NI(i,{statistic:h,plotType:"pie"},o),i.render(!0)}var p=_Me(this.context);p&&p.shape.toFront()},r.prototype.reset=function(){var t=this.context.view,n=t.getController("annotation");n.clear(!0);var i=this.getInitialAnnotation();we(i,function(a){t.annotation()[a.type](a)}),t.render(!0)},r}(Vs),ree="pie-statistic";hi(ree,xMe);$i("pie-statistic-active",{start:[{trigger:"element:mouseenter",action:"pie-statistic:change"}],end:[{trigger:"element:mouseleave",action:"pie-statistic:reset"}]});hi("pie-legend",yMe);$i("pie-legend-active",{start:[{trigger:"legend-item:mouseenter",action:"pie-legend:active"}],end:[{trigger:"legend-item:mouseleave",action:"pie-legend:reset"}]});function bMe(e){var r=e.chart,t=e.options,n=t.data,i=t.angleField,a=t.colorField,o=t.color,s=t.pieStyle,u=m2(n,i);if(QM(u,i)){var l="$$percentage$$";u=u.map(function(h){var p;return nt(nt({},h),(p={},p[l]=1/u.length,p))}),r.data(u);var f=Dt({},e,{options:{xField:"1",yField:l,seriesField:a,isStack:!0,interval:{color:o,style:s},args:{zIndexReversed:!0,sortZIndex:!0}}});pf(f)}else{r.data(u);var f=Dt({},e,{options:{xField:"1",yField:i,seriesField:a,isStack:!0,interval:{color:o,style:s},args:{zIndexReversed:!0,sortZIndex:!0}}});pf(f)}return e}function wMe(e){var r,t=e.chart,n=e.options,i=n.meta,a=n.colorField,o=Dt({},i);return t.scale(o,(r={},r[a]={type:"cat"},r)),e}function CMe(e){var r=e.chart,t=e.options,n=t.radius,i=t.innerRadius,a=t.startAngle,o=t.endAngle;return r.coordinate({type:"theta",cfg:{radius:n,innerRadius:i,startAngle:a,endAngle:o}}),e}function EMe(e){var r=e.chart,t=e.options,n=t.label,i=t.colorField,a=t.angleField,o=r.geometries[0];if(!n)o.label(!1);else{var s=n.callback,u=fh(n,["callback"]),l=uc(u);if(l.content){var f=l.content;l.content=function(m,x,E){var A=m[i],L=m[a],k=r.getScaleByField(a),R=k==null?void 0:k.scale(L);return kn(f)?f(nt(nt({},m),{percent:R}),x,E):ei(f)?kJ(f,{value:L,name:A,percentage:xi(R)&&!rr(L)?(R*100).toFixed(2)+"%":null}):f}}var h={inner:"",outer:"pie-outer",spider:"pie-spider"},p=l.type?h[l.type]:"pie-outer",v=l.layout?ar(l.layout)?l.layout:[l.layout]:[];l.layout=(p?[{type:p}]:[]).concat(v),o.label({fields:i?[a,i]:[a],callback:s,cfg:nt(nt({},l),{offset:gMe(l.type,l.offset),type:"pie"})})}return e}function nee(e){var r=e.innerRadius,t=e.statistic,n=e.angleField,i=e.colorField,a=e.meta,o=e.locale,s=$I(o);if(r&&t){var u=Dt({},tee.statistic,t),l=u.title,f=u.content;return l!==!1&&(l=Dt({},{formatter:function(h){var p=h?h[i]:rr(l.content)?s.get(["statistic","total"]):l.content,v=Ie(a,[i,"formatter"])||function(m){return m};return v(p)}},l)),f!==!1&&(f=Dt({},{formatter:function(h,p){var v=h?h[n]:vMe(p,n),m=Ie(a,[n,"formatter"])||function(x){return x};return h||rr(f.content)?m(v):f.content}},f)),Dt({},{statistic:{title:l,content:f}},e)}return e}function iee(e){var r=e.chart,t=e.options,n=nee(t),i=n.innerRadius,a=n.statistic;return r.getController("annotation").clear(!0),Ei(mu())(e),i&&a&&NI(r,{statistic:a,plotType:"pie"}),e}function SMe(e){var r=e.chart,t=e.options,n=t.tooltip,i=t.colorField,a=t.angleField,o=t.data;if(n===!1)r.tooltip(n);else if(r.tooltip(Dt({},n,{shared:!1})),QM(o,a)){var s=Ie(n,"fields"),u=Ie(n,"formatter");uh(Ie(n,"fields"))&&(s=[i,a],u=u||function(l){return{name:l[i],value:v_(l[a])}}),r.geometries[0].tooltip(s.join("*"),Ob(s,u))}return e}function AMe(e){var r=e.chart,t=e.options,n=nee(t),i=n.interactions,a=n.statistic,o=n.annotations;return we(i,function(s){var u,l;if(s.enable===!1)r.removeInteraction(s.type);else if(s.type==="pie-statistic-active"){var f=[];!((u=s.cfg)===null||u===void 0)&&u.start||(f=[{trigger:"element:mouseenter",action:ree+":change",arg:{statistic:a,annotations:o}}]),we((l=s.cfg)===null||l===void 0?void 0:l.start,function(h){f.push(nt(nt({},h),{arg:{statistic:a,annotations:o}}))}),r.interaction(s.type,Dt({},s.cfg,{start:f}))}else r.interaction(s.type,s.cfg||{})}),e}function aee(e){return Ei(nd("pieStyle"),bMe,wMe,Xa,CMe,G2,SMe,EMe,b_,iee,AMe,Po)(e)}var TMe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="pie",t}return r.getDefaultOptions=function(){return tee},r.prototype.changeData=function(t){this.chart.emit(ra.BEFORE_CHANGE_DATA,ru.fromData(this.chart,ra.BEFORE_CHANGE_DATA,null));var n=this.options,i=this.options.angleField,a=m2(n.data,i),o=m2(t,i);QM(a,i)||QM(o,i)?this.update({data:t}):(this.updateOption({data:t}),this.chart.data(o),iee({chart:this.chart,options:this.options}),this.chart.render(!0)),this.chart.emit(ra.AFTER_CHANGE_DATA,ru.fromData(this.chart,ra.AFTER_CHANGE_DATA,null))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return aee},r}(Ui);function MMe(e){var r=e.chart,t=e.options,n=t.data,i=t.sectorStyle,a=t.color;return r.data(n),Ei(pf)(Dt({},e,{options:{marginRatio:1,interval:{style:i,color:a}}})),e}function LMe(e){var r=e.chart,t=e.options,n=t.label,i=t.xField,a=hf(r,"interval");if(n===!1)a.label(!1);else if(xo(n)){var o=n.callback,s=n.fields,u=fh(n,["callback","fields"]),l=u.offset,f=u.layout;(l===void 0||l>=0)&&(f=f?ar(f)?f:[f]:[],u.layout=kc(f,function(h){return h.type!=="limit-in-shape"}),u.layout.length||delete u.layout),a.label({fields:s||[i],callback:o,cfg:uc(u)})}else Cy(Kv.WARN,n===null,"the label option must be an Object."),a.label({fields:[i]});return e}function IMe(e){var r=e.chart,t=e.options,n=t.legend,i=t.seriesField;return n===!1?r.legend(!1):i&&r.legend(i,n),e}function kMe(e){var r=e.chart,t=e.options,n=t.radius,i=t.innerRadius,a=t.startAngle,o=t.endAngle;return r.coordinate({type:"polar",cfg:{radius:n,innerRadius:i,startAngle:a,endAngle:o}}),e}function PMe(e){var r,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return Ei(ku((r={},r[a]=n,r[o]=i,r)))(e)}function RMe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return n?r.axis(a,n):r.axis(a,!1),i?r.axis(o,i):r.axis(o,!1),e}function OMe(e){Ei(nd("sectorStyle"),MMe,PMe,LMe,kMe,RMe,IMe,Ul,ks,Po,Xa,mu(),b_)(e)}var FMe=Dt({},Ui.getDefaultOptions(),{xAxis:!1,yAxis:!1,legend:{position:"right",radio:{}},sectorStyle:{stroke:"#fff",lineWidth:1},label:{layout:{type:"limit-in-shape"}},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="rose",t}return r.getDefaultOptions=function(){return FMe},r.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return OMe},r})(Ui);var DMe={font:function(){return"serif"},padding:1,size:[500,500],spiral:"archimedean",timeInterval:3e3};function BMe(e,r){return r=Na({},DMe,r),NMe(e,r)}function NMe(e,r){var t=KMe();["font","fontSize","fontWeight","padding","rotate","size","spiral","timeInterval","random"].forEach(function(u){rr(r[u])||t[u](r[u])}),t.words(e),r.imageMask&&t.createMask(r.imageMask);var n=t.start(),i=n._tags;i.forEach(function(u){u.x+=r.size[0]/2,u.y+=r.size[1]/2});var a=r.size,o=a[0],s=a[1];return i.push({text:"",value:0,x:0,y:0,opacity:0}),i.push({text:"",value:0,x:o,y:s,opacity:0}),i}var OR=Math.PI/180,wC=1<<11>>5,tM=1<<11;function zMe(e){return e.text}function $Me(){return"serif"}function h9(){return"normal"}function UMe(e){return e.value}function VMe(){return~~(Math.random()*2)*90}function GMe(){return 1}function HMe(e,r,t,n){if(!r.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(wC<<5)/a,tM/a);var o=0,s=0,u=0,l=t.length;for(--n;++n<l;){r=t[n],i.save(),i.font=r.style+" "+r.weight+" "+~~((r.size+1)/a)+"px "+r.font;var f=i.measureText(r.text+"m").width*a,h=r.size<<1;if(r.rotate){var p=Math.sin(r.rotate*OR),v=Math.cos(r.rotate*OR),m=f*v,x=f*p,E=h*v,A=h*p;f=Math.max(Math.abs(m+A),Math.abs(m-A))+31>>5<<5,h=~~Math.max(Math.abs(x+E),Math.abs(x-E))}else f=f+31>>5<<5;if(h>u&&(u=h),o+f>=wC<<5&&(o=0,s+=u,u=0),s+h>=tM)break;i.translate((o+(f>>1))/a,(s+(h>>1))/a),r.rotate&&i.rotate(r.rotate*OR),i.fillText(r.text,0,0),r.padding&&(i.lineWidth=2*r.padding,i.strokeText(r.text,0,0)),i.restore(),r.width=f,r.height=h,r.xoff=o,r.yoff=s,r.x1=f>>1,r.y1=h>>1,r.x0=-r.x1,r.y0=-r.y1,r.hasText=!0,o+=f}for(var L=i.getImageData(0,0,(wC<<5)/a,tM/a).data,k=[];--n>=0;)if(r=t[n],!!r.hasText){for(var f=r.width,R=f>>5,h=r.y1-r.y0,D=0;D<h*R;D++)k[D]=0;if(o=r.xoff,o==null)return;s=r.yoff;for(var $=0,j=-1,H=0;H<h;H++){for(var D=0;D<f;D++){var ee=R*H+(D>>5),U=L[(s+H)*(wC<<5)+(o+D)<<2]?1<<31-D%32:0;k[ee]|=U,$|=U}$?j=H:(r.y0++,h--,H--,s++)}r.y1=r.y0+j,r.sprite=k.slice(0,(r.y1-r.y0)*R)}}}function jMe(e,r,t){t>>=5;for(var n=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,s=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*t+(a>>5),f,h=0;h<u;h++){f=0;for(var p=0;p<=i;p++)if((f<<s|(p<i?(f=n[h*i+p])>>>o:0))&r[l+p])return!0;l+=t}return!1}function WMe(e,r){var t=e[0],n=e[1];r.x+r.x0<t.x&&(t.x=r.x+r.x0),r.y+r.y0<t.y&&(t.y=r.y+r.y0),r.x+r.x1>n.x&&(n.x=r.x+r.x1),r.y+r.y1>n.y&&(n.y=r.y+r.y1)}function XMe(e,r){return e.x+e.x1>r[0].x&&e.x+e.x0<r[1].x&&e.y+e.y1>r[0].y&&e.y+e.y0<r[1].y}function oee(e){var r=e[0]/e[1];return function(t){return[r*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function YMe(e){var r=4,t=r*e[0]/e[1],n=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:n+=t;break;case 1:i+=r;break;case 2:n-=t;break;default:i-=r;break}return[n,i]}}function p9(e){for(var r=[],t=-1;++t<e;)r[t]=0;return r}function ZMe(){return document.createElement("canvas")}function $g(e){return kn(e)?e:function(){return e}}var qMe={archimedean:oee,rectangular:YMe};function KMe(){var e=[256,256],r=$Me,t=UMe,n=h9,i=VMe,a=GMe,o=oee,s=Math.random,u=[],l=1/0,f=zMe,h=h9,p=ZMe,v={};v.start=function(){var E=e[0],A=e[1],L=m(p()),k=v.board?v.board:p9((e[0]>>5)*e[1]),R=u.length,D=[],$=u.map(function(U,W,Q){return U.text=f.call(this,U,W,Q),U.font=r.call(this,U,W,Q),U.style=h.call(this,U,W,Q),U.weight=n.call(this,U,W,Q),U.rotate=i.call(this,U,W,Q),U.size=~~t.call(this,U,W,Q),U.padding=a.call(this,U,W,Q),U}).sort(function(U,W){return W.size-U.size}),j=-1,H=v.board?[{x:0,y:0},{x:E,y:A}]:null;ee();function ee(){for(var U=Date.now();Date.now()-U<l&&++j<R;){var W=$[j];W.x=E*(s()+.5)>>1,W.y=A*(s()+.5)>>1,HMe(L,W,$,j),W.hasText&&x(k,W,H)&&(D.push(W),H?v.hasImage||WMe(H,W):H=[{x:W.x+W.x0,y:W.y+W.y0},{x:W.x+W.x1,y:W.y+W.y1}],W.x-=e[0]>>1,W.y-=e[1]>>1)}v._tags=D,v._bounds=H}return v};function m(E){E.width=E.height=1;var A=Math.sqrt(E.getContext("2d").getImageData(0,0,1,1).data.length>>2);E.width=(wC<<5)/A,E.height=tM/A;var L=E.getContext("2d");return L.fillStyle=L.strokeStyle="red",L.textAlign="center",{context:L,ratio:A}}function x(E,A,L){for(var k=A.x,R=A.y,D=Math.sqrt(e[0]*e[0]+e[1]*e[1]),$=o(e),j=s()<.5?1:-1,H,ee=-j,U,W;(H=$(ee+=j))&&(U=~~H[0],W=~~H[1],!(Math.min(Math.abs(U),Math.abs(W))>=D));)if(A.x=k+U,A.y=R+W,!(A.x+A.x0<0||A.y+A.y0<0||A.x+A.x1>e[0]||A.y+A.y1>e[1])&&(!L||!jMe(A,E,e[0]))&&(!L||XMe(A,L))){for(var Q=A.sprite,te=A.width>>5,ie=e[0]>>5,ve=A.x-(te<<4),me=ve&127,Re=32-me,We=A.y1-A.y0,je=void 0,lt=(A.y+A.y0)*ie+(ve>>5),dt=0;dt<We;dt++){je=0;for(var ct=0;ct<=te;ct++)E[lt+ct]|=je<<Re|(ct<te?(je=Q[dt*te+ct])>>>me:0);lt+=ie}return delete A.sprite,!0}return!1}return v.createMask=function(E){var A=document.createElement("canvas"),L=e[0],k=e[1];if(!(!L||!k)){var R=L>>5,D=p9((L>>5)*k);A.width=L,A.height=k;var $=A.getContext("2d");$.drawImage(E,0,0,E.width,E.height,0,0,L,k);for(var j=$.getImageData(0,0,L,k).data,H=0;H<k;H++)for(var ee=0;ee<L;ee++){var U=R*H+(ee>>5),W=H*L+ee<<2,Q=j[W]>=250&&j[W+1]>=250&&j[W+2]>=250,te=Q?1<<31-ee%32:0;D[U]|=te}v.board=D,v.hasImage=!0}},v.timeInterval=function(E){l=E==null?1/0:E},v.words=function(E){u=E},v.size=function(E){e=[+E[0],+E[1]]},v.font=function(E){r=$g(E)},v.fontWeight=function(E){n=$g(E)},v.rotate=function(E){i=$g(E)},v.spiral=function(E){o=qMe[E]||E},v.fontSize=function(E){t=$g(E)},v.padding=function(E){a=$g(E)},v.random=function(E){s=$g(E)},v}function see(e){var r=e.options,t=e.chart,n=t,i=n.width,a=n.height,o=n.padding,s=n.appendPadding,u=n.ele,l=r.data,f=r.imageMask,h=r.wordField,p=r.weightField,v=r.colorField,m=r.wordStyle,x=r.timeInterval,E=r.random,A=r.spiral,L=r.autoFit,k=L===void 0?!0:L,R=r.placementStrategy;if(!l||!l.length)return[];var D=m.fontFamily,$=m.fontWeight,j=m.padding,H=m.fontSize,ee=rLe(l,p),U=[aLe(ee),oLe(ee)],W=l.map(function(ie){return{text:ie[h],value:ie[p],color:ie[v],datum:ie}}),Q={imageMask:f,font:D,fontSize:tLe(H,U),fontWeight:$,size:QMe({width:i,height:a,padding:o,appendPadding:s,autoFit:k,container:u}),padding:j,timeInterval:x,random:E,spiral:A,rotate:nLe(r)};if(kn(R)){var te=W.map(function(ie,ve,me){return nt(nt(nt({},ie),{hasText:!!ie.text,font:$g(Q.font)(ie,ve,me),weight:$g(Q.fontWeight)(ie,ve,me),rotate:$g(Q.rotate)(ie,ve,me),size:$g(Q.fontSize)(ie,ve,me),style:"normal"}),R.call(t,ie,ve,me))});return te.push({text:"",value:0,x:0,y:0,opacity:0}),te.push({text:"",value:0,x:Q.size[0],y:Q.size[1],opacity:0}),te}return BMe(W,Q)}function QMe(e){var r=e.width,t=e.height,n=e.container,i=e.autoFit,a=e.padding,o=e.appendPadding;if(i){var s=S5(n);r=s.width,t=s.height}r=r||400,t=t||400;var u=JMe({padding:a,appendPadding:o}),l=u[0],f=u[1],h=u[2],p=u[3],v=[r-(p+f),t-(l+h)];return v}function JMe(e){var r=t_(e.padding),t=t_(e.appendPadding),n=r[0]+t[0],i=r[1]+t[1],a=r[2]+t[2],o=r[3]+t[3];return[n,i,a,o]}function eLe(e){return new Promise(function(r,t){if(e instanceof HTMLImageElement){r(e);return}if(ei(e)){var n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){r(n)},n.onerror=function(){Cy(Kv.ERROR,!1,"image %s load failed !!!",e),t()};return}Cy(Kv.WARN,e===void 0,"The type of imageMask option must be String or HTMLImageElement."),t()})}function tLe(e,r){if(kn(e))return e;if(ar(e)){var t=e[0],n=e[1];if(!r)return function(){return(n+t)/2};var i=r[0],a=r[1];return a===i?function(){return(n+t)/2}:function(s){var u=s.value;return(n-t)/(a-i)*(u-i)+t}}return function(){return e}}function rLe(e,r){return e.map(function(t){return t[r]}).filter(function(t){return typeof t=="number"&&!isNaN(t)})}function nLe(e){var r=iLe(e),t=r.rotation,n=r.rotationSteps;if(!ar(t))return t;var i=t[0],a=t[1],o=n===1?0:(a-i)/(n-1);return function(){return a===i?a:Math.floor(Math.random()*n)*o}}function iLe(e){var r=e.wordStyle.rotationSteps;return r<1&&(Cy(Kv.WARN,!1,"The rotationSteps option must be greater than or equal to 1."),r=1),{rotation:e.wordStyle.rotation,rotationSteps:r}}function aLe(e){return Math.min.apply(Math,e)}function oLe(e){return Math.max.apply(Math,e)}var Q4="color",sLe=Dt({},Ui.getDefaultOptions(),{timeInterval:2e3,legend:!1,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!1,fields:["text","value",Q4],formatter:function(e){return{name:e.text,value:e.value}}},wordStyle:{fontFamily:"Verdana",fontWeight:"normal",padding:1,fontSize:[12,60],rotation:[0,90],rotationSteps:2,rotateRatio:.5}});function uLe(e){var r=e.chart,t=e.options,n=t.colorField,i=t.color,a=see(e);r.data(a);var o=Dt({},e,{options:{xField:"x",yField:"y",seriesField:n&&Q4,rawFields:kn(i)&&nu(Ie(t,"rawFields",[]),["datum"]),point:{color:i,shape:"word-cloud"}}}),s=id(o).ext;return s.geometry.label(!1),r.coordinate().reflect("y"),r.axis(!1),e}function lLe(e){return Ei(ku({x:{nice:!1},y:{nice:!1}}))(e)}function cLe(e){var r=e.chart,t=e.options,n=t.legend,i=t.colorField;return n===!1?r.legend(!1):i&&r.legend(Q4,n),e}function fLe(e){Ei(uLe,lLe,Ul,cLe,ks,Po,Xa,b_)(e)}lo("point","word-cloud",{draw:function(e,r){var t=e.x,n=e.y,i=r.addShape("text",{attrs:nt(nt({},hLe(e)),{x:t,y:n})}),a=e.data.rotate;return typeof a=="number"&&dp.rotate(i,a*Math.PI/180),i}});function hLe(e){return{fontSize:e.data.size,text:e.data.text,textAlign:"center",fontFamily:e.data.font,fontWeight:e.data.weight,fill:e.color||e.defaultStyle.stroke,textBaseline:"alphabetic"}}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="word-cloud",t}return r.getDefaultOptions=function(){return sLe},r.prototype.changeData=function(t){this.updateOption({data:t}),this.options.imageMask?this.render():this.chart.changeData(see({chart:this.chart,options:this.options}))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.render=function(){var t=this;return new Promise(function(n){var i=t.options.imageMask;if(!i){e.prototype.render.call(t),n();return}var a=function(o){t.options=nt(nt({},t.options),{imageMask:o||null}),e.prototype.render.call(t),n()};eLe(i).then(a).catch(a)})},r.prototype.getSchemaAdaptor=function(){return fLe},r.prototype.triggerResize=function(){var t=this;this.chart.destroyed||(this.execAdaptor(),window.setTimeout(function(){e.prototype.triggerResize.call(t)}))},r})(Ui);function r_(e,r){return pLe(e)||dLe(e,r)||vLe()}function pLe(e){if(Array.isArray(e))return e}function dLe(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(u){i=!0,a=u}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return t}function vLe(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function J4(e,r,t,n){e=e.filter(function(m,x){var E=r(m,x),A=t(m,x);return E!=null&&isFinite(E)&&A!=null&&isFinite(A)}),n&&e.sort(function(m,x){return r(m)-r(x)});for(var i=e.length,a=new Float64Array(i),o=new Float64Array(i),s=0,u=0,l,f,h,p=0;p<i;)h=e[p],a[p]=l=+r(h,p,e),o[p]=f=+t(h,p,e),++p,s+=(l-s)/p,u+=(f-u)/p;for(var v=0;v<i;++v)a[v]-=s,o[v]-=u;return[a,o,s,u]}function x1(e,r,t,n){for(var i=0,a=0,o=e.length;a<o;a++){var s=e[a],u=+r(s,a,e),l=+t(s,a,e);u!=null&&isFinite(u)&&l!=null&&isFinite(l)&&n(u,l,i++)}}function j2(e,r,t,n,i){var a=0,o=0;return x1(e,r,t,function(s,u){var l=u-i(s),f=u-n;a+=l*l,o+=f*f}),1-a/o}function d9(e){return Math.atan2(e[1][1]-e[0][1],e[1][0]-e[0][0])*180/Math.PI}function gLe(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}function wS(e,r,t){for(var n=Math.log(r-e)*Math.LOG10E+1|0,i=1*Math.pow(10,-n/2-1),a=1e4,o=[u(e),u(r)],s=0;l(o)&&s<a;);return o;function u(f){return[f,t(f)]}function l(f){s++;for(var h=f.length,p=!1,v=0;v<h-1;v++){var m=f[v],x=f[v+1],E=gLe([m,x]),A=u(E[0]),L=d9([m,E]),k=d9([m,A]),R=Math.abs(L-k);R>i&&(f.splice(v+1,0,A),p=!0)}return p}}function CS(e,r,t,n){var i=n-e*e,a=Math.abs(i)<1e-24?0:(t-e*r)/i,o=r-a*e;return[o,a]}function mLe(){var e=function(a){return a[0]},r=function(a){return a[1]},t;function n(i){var a=0,o=0,s=0,u=0,l=0,f=0,h=t?+t[0]:1/0,p=t?+t[1]:-1/0;x1(i,e,r,function(k,R){var D=Math.log(R),$=k*R;++a,o+=(R-o)/a,u+=($-u)/a,f+=(k*$-f)/a,s+=(R*D-s)/a,l+=($*D-l)/a,t||(k<h&&(h=k),k>p&&(p=k))});var v=CS(u/o,s/o,l/o,f/o),m=r_(v,2),x=m[0],E=m[1];x=Math.exp(x);var A=function(R){return x*Math.exp(E*R)},L=wS(h,p,A);return L.a=x,L.b=E,L.predict=A,L.rSquared=j2(i,e,r,o,A),L}return n.domain=function(i){return arguments.length?(t=i,n):t},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(r=i,n):r},n}function uee(){var e=function(a){return a[0]},r=function(a){return a[1]},t;function n(i){var a=0,o=0,s=0,u=0,l=0,f=t?+t[0]:1/0,h=t?+t[1]:-1/0;x1(i,e,r,function(L,k){++a,o+=(L-o)/a,s+=(k-s)/a,u+=(L*k-u)/a,l+=(L*L-l)/a,t||(L<f&&(f=L),L>h&&(h=L))});var p=CS(o,s,u,l),v=r_(p,2),m=v[0],x=v[1],E=function(k){return x*k+m},A=[[f,E(f)],[h,E(h)]];return A.a=x,A.b=m,A.predict=E,A.rSquared=j2(i,e,r,s,E),A}return n.domain=function(i){return arguments.length?(t=i,n):t},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(r=i,n):r},n}function yLe(e){e.sort(function(t,n){return t-n});var r=e.length/2;return r%1===0?(e[r-1]+e[r])/2:e[Math.floor(r)]}var v9=2,g9=1e-12;function _Le(){var e=function(a){return a[0]},r=function(a){return a[1]},t=.3;function n(i){for(var a=J4(i,e,r,!0),o=r_(a,4),s=o[0],u=o[1],l=o[2],f=o[3],h=s.length,p=Math.max(2,~~(t*h)),v=new Float64Array(h),m=new Float64Array(h),x=new Float64Array(h).fill(1),E=-1;++E<=v9;){for(var A=[0,p-1],L=0;L<h;++L){for(var k=s[L],R=A[0],D=A[1],$=k-s[R]>s[D]-k?R:D,j=0,H=0,ee=0,U=0,W=0,Q=1/Math.abs(s[$]-k||1),te=R;te<=D;++te){var ie=s[te],ve=u[te],me=xLe(Math.abs(k-ie)*Q)*x[te],Re=ie*me;j+=me,H+=Re,ee+=ve*me,U+=ve*Re,W+=ie*Re}var We=CS(H/j,ee/j,U/j,W/j),je=r_(We,2),lt=je[0],dt=je[1];v[L]=lt+dt*k,m[L]=Math.abs(u[L]-v[L]),bLe(s,L+1,A)}if(E===v9)break;var ct=yLe(m);if(Math.abs(ct)<g9)break;for(var Tt=0,It,Lt;Tt<h;++Tt)It=m[Tt]/(6*ct),x[Tt]=It>=1?g9:(Lt=1-It*It)*Lt}return wLe(s,v,l,f)}return n.bandwidth=function(i){return arguments.length?(t=i,n):t},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(r=i,n):r},n}function xLe(e){return(e=1-e*e*e)*e*e}function bLe(e,r,t){var n=e[r],i=t[0],a=t[1]+1;if(!(a>=e.length))for(;r>i&&e[a]-n<=n-e[i];)t[0]=++i,t[1]=a,++a}function wLe(e,r,t,n){for(var i=e.length,a=[],o=0,s=0,u=[],l;o<i;++o)l=e[o]+t,u[0]===l?u[1]+=(r[o]-u[1])/++s:(s=0,u[1]+=n,u=[l,r[o]],a.push(u));return u[1]+=n,a}function CLe(){var e=function(o){return o[0]},r=function(o){return o[1]},t=Math.E,n;function i(a){var o=0,s=0,u=0,l=0,f=0,h=n?+n[0]:1/0,p=n?+n[1]:-1/0,v=Math.log(t);x1(a,e,r,function(R,D){var $=Math.log(R)/v;++o,s+=($-s)/o,u+=(D-u)/o,l+=($*D-l)/o,f+=($*$-f)/o,n||(R<h&&(h=R),R>p&&(p=R))});var m=CS(s,u,l,f),x=r_(m,2),E=x[0],A=x[1],L=function(D){return A*Math.log(D)/v+E},k=wS(h,p,L);return k.a=A,k.b=E,k.predict=L,k.rSquared=j2(a,e,r,u,L),k}return i.domain=function(a){return arguments.length?(n=a,i):n},i.x=function(a){return arguments.length?(e=a,i):e},i.y=function(a){return arguments.length?(r=a,i):r},i.base=function(a){return arguments.length?(t=a,i):t},i}function lee(){var e=function(a){return a[0]},r=function(a){return a[1]},t;function n(i){var a=J4(i,e,r),o=r_(a,4),s=o[0],u=o[1],l=o[2],f=o[3],h=s.length,p=0,v=0,m=0,x=0,E=0,A,L,k,R;for(A=0;A<h;)L=s[A],k=u[A++],R=L*L,p+=(R-p)/A,v+=(R*L-v)/A,m+=(R*R-m)/A,x+=(L*k-x)/A,E+=(R*k-E)/A;var D=0,$=0,j=t?+t[0]:1/0,H=t?+t[1]:-1/0;x1(i,e,r,function(me,Re){$++,D+=(Re-D)/$,t||(me<j&&(j=me),me>H&&(H=me))});var ee=m-p*p,U=p*ee-v*v,W=(E*p-x*v)/U,Q=(x*ee-E*v)/U,te=-W*p,ie=function(Re){return Re=Re-l,W*Re*Re+Q*Re+te+f},ve=wS(j,H,ie);return ve.a=W,ve.b=Q-2*W*l,ve.c=te-Q*l+W*l*l+f,ve.predict=ie,ve.rSquared=j2(i,e,r,D,ie),ve}return n.domain=function(i){return arguments.length?(t=i,n):t},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(r=i,n):r},n}function ELe(){var e=function(o){return o[0]},r=function(o){return o[1]},t=3,n;function i(a){if(t===1){var o=uee().x(e).y(r).domain(n)(a);return o.coefficients=[o.b,o.a],delete o.a,delete o.b,o}if(t===2){var s=lee().x(e).y(r).domain(n)(a);return s.coefficients=[s.c,s.b,s.a],delete s.a,delete s.b,delete s.c,s}var u=J4(a,e,r),l=r_(u,4),f=l[0],h=l[1],p=l[2],v=l[3],m=f.length,x=[],E=[],A=t+1,L=0,k=0,R=n?+n[0]:1/0,D=n?+n[1]:-1/0;x1(a,e,r,function(ie,ve){++k,L+=(ve-L)/k,n||(ie<R&&(R=ie),ie>D&&(D=ie))});var $,j,H,ee,U;for($=0;$<A;++$){for(H=0,ee=0;H<m;++H)ee+=Math.pow(f[H],$)*h[H];for(x.push(ee),U=new Float64Array(A),j=0;j<A;++j){for(H=0,ee=0;H<m;++H)ee+=Math.pow(f[H],$+j);U[j]=ee}E.push(U)}E.push(x);var W=ALe(E),Q=function(ve){ve-=p;var me=v+W[0]+W[1]*ve+W[2]*ve*ve;for($=3;$<A;++$)me+=W[$]*Math.pow(ve,$);return me},te=wS(R,D,Q);return te.coefficients=SLe(A,W,-p,v),te.predict=Q,te.rSquared=j2(a,e,r,L,Q),te}return i.domain=function(a){return arguments.length?(n=a,i):n},i.x=function(a){return arguments.length?(e=a,i):e},i.y=function(a){return arguments.length?(r=a,i):r},i.order=function(a){return arguments.length?(t=a,i):t},i}function SLe(e,r,t,n){var i=Array(e),a,o,s,u;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a)for(s=r[a],u=1,i[a]+=s,o=1;o<=a;++o)u*=(a+1-o)/o,i[a-o]+=s*Math.pow(t,o)*u;return i[0]+=n,i}function ALe(e){var r=e.length-1,t=[],n,i,a,o,s;for(n=0;n<r;++n){for(o=n,i=n+1;i<r;++i)Math.abs(e[n][i])>Math.abs(e[n][o])&&(o=i);for(a=n;a<r+1;++a)s=e[a][n],e[a][n]=e[a][o],e[a][o]=s;for(i=n+1;i<r;++i)for(a=r;a>=n;a--)e[a][i]-=e[a][n]*e[n][i]/e[n][n]}for(i=r-1;i>=0;--i){for(s=0,a=i+1;a<r;++a)s+=e[a][i]*t[a];t[i]=(e[r][i]-s)/e[i][i]}return t}function TLe(){var e=function(a){return a[0]},r=function(a){return a[1]},t;function n(i){var a=0,o=0,s=0,u=0,l=0,f=0,h=t?+t[0]:1/0,p=t?+t[1]:-1/0;x1(i,e,r,function(k,R){var D=Math.log(k),$=Math.log(R);++a,o+=(D-o)/a,s+=($-s)/a,u+=(D*$-u)/a,l+=(D*D-l)/a,f+=(R-f)/a,t||(k<h&&(h=k),k>p&&(p=k))});var v=CS(o,s,u,l),m=r_(v,2),x=m[0],E=m[1];x=Math.exp(x);var A=function(R){return x*Math.pow(R,E)},L=wS(h,p,A);return L.a=x,L.b=E,L.predict=A,L.rSquared=j2(i,e,r,f,A),L}return n.domain=function(i){return arguments.length?(t=i,n):t},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(r=i,n):r},n}var MLe={exp:mLe,linear:uee,loess:_Le,log:CLe,poly:ELe,pow:TLe,quad:lee};function LLe(e,r){var t=10,n={regionStyle:[{position:{start:[e,"max"],end:["max",r]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:["min","max"],end:[e,r]},style:{fill:"#a3dda1",opacity:.4}},{position:{start:["min",r],end:[e,"min"]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:[e,r],end:["max","min"]},style:{fill:"#a3dda1",opacity:.4}}],lineStyle:{stroke:"#9ba29a",lineWidth:1},labelStyle:[{position:["max",r],offsetX:-t,offsetY:-t,style:{textAlign:"right",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",r],offsetX:t,offsetY:-t,style:{textAlign:"left",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",r],offsetX:t,offsetY:t,style:{textAlign:"left",textBaseline:"top",fontSize:14,fill:"#ccc"}},{position:["max",r],offsetX:-t,offsetY:t,style:{textAlign:"right",textBaseline:"top",fontSize:14,fill:"#ccc"}}]};return n}var ILe=function(e,r){var t=r.view,n=r.options,i=n.xField,a=n.yField,o=t.getScaleByField(i),s=t.getScaleByField(a),u=e.map(function(l){return t.getCoordinate().convert({x:o.scale(l[0]),y:s.scale(l[1])})});return HAe(u,!1)},kLe=function(e){var r=e.options,t=r.xField,n=r.yField,i=r.data,a=r.regressionLine,o=a.type,s=o===void 0?"linear":o,u=a.algorithm,l;if(u)l=ar(u)?u:u(i);else{var f=MLe[s]().x(function(h){return h[t]}).y(function(h){return h[n]});l=f(i)}return ILe(l,e)},PLe=function(e){var r,t=e.meta,n=t===void 0?{}:t,i=e.xField,a=e.yField,o=e.data,s=o[0][i],u=o[0][a],l=s>0,f=u>0;function h(p,v){var m=Ie(n,[p]);function x(A){return Ie(m,A)}var E={};return v==="x"?(xi(s)&&(xi(x("min"))||(E.min=l?0:s*2),xi(x("max"))||(E.max=l?s*2:0)),E):(xi(u)&&(xi(x("min"))||(E.min=f?0:u*2),xi(x("max"))||(E.max=f?u*2:0)),E)}return nt(nt({},n),(r={},r[i]=nt(nt({},n[i]),h(i,"x")),r[a]=nt(nt({},n[a]),h(a,"y")),r))};function cee(e){var r=e.data,t=r===void 0?[]:r,n=e.xField,i=e.yField;if(t.length){for(var a=!0,o=!0,s=t[0],u=void 0,l=1;l<t.length&&(u=t[l],s[n]!==u[n]&&(a=!1),s[i]!==u[i]&&(o=!1),!(!a&&!o));l++)s=u;var f=[];a&&f.push(n),o&&f.push(i);var h=Ao(PLe(e),f);return Dt({},e,{meta:h})}return e}function RLe(e){var r=e.chart,t=e.options,n=t.data,i=t.type,a=t.color,o=t.shape,s=t.pointStyle,u=t.shapeField,l=t.colorField,f=t.xField,h=t.yField,p=t.sizeField,v=t.size,m=t.tooltip;p&&(v||(v=[2,8]),xi(v)&&(v=[v,v])),m&&!m.fields&&(m=nt(nt({},m),{fields:[f,h,l,p,u]})),r.data(n),id(Dt({},e,{options:{seriesField:l,point:{color:a,shape:o,size:v,style:s},tooltip:m}}));var x=hf(r,"point");return i&&x.adjust(i),e}function rM(e){var r,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField,s=cee(t);return Ei(ku((r={},r[a]=n,r[o]=i,r)))(Dt({},e,{options:s}))}function OLe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return r.axis(a,n),r.axis(o,i),e}function FLe(e){var r=e.chart,t=e.options,n=t.legend,i=t.colorField,a=t.shapeField,o=t.sizeField,s=t.shapeLegend,u=t.sizeLegend,l=n!==!1;return i&&r.legend(i,l?n:!1),a&&(s?r.legend(a,s):r.legend(a,s===!1?!1:n)),o&&r.legend(o,u||!1),!l&&!s&&!u&&r.legend(!1),e}function DLe(e){var r=e.chart,t=e.options,n=t.label,i=t.yField,a=hf(r,"point");if(!n)a.label(!1);else{var o=n.callback,s=fh(n,["callback"]);a.label({fields:[i],callback:o,cfg:uc(s)})}return e}function BLe(e){var r=e.options,t=r.quadrant,n=[];if(t){var i=t.xBaseline,a=i===void 0?0:i,o=t.yBaseline,s=o===void 0?0:o,u=t.labels,l=t.regionStyle,f=t.lineStyle,h=LLe(a,s),p=new Array(4).join(",").split(",");p.forEach(function(v,m){n.push(nt(nt({type:"region",top:!1},h.regionStyle[m].position),{style:Dt({},h.regionStyle[m].style,l==null?void 0:l[m])}),nt({type:"text",top:!0},Dt({},h.labelStyle[m],u==null?void 0:u[m])))}),n.push({type:"line",top:!1,start:["min",s],end:["max",s],style:Dt({},h.lineStyle,f)},{type:"line",top:!1,start:[a,"min"],end:[a,"max"],style:Dt({},h.lineStyle,f)})}return Ei(mu(n))(e)}function NLe(e){var r=e.options,t=e.chart,n=r.regressionLine;if(n){var i=n.style,a=n.top,o=a===void 0?!1:a,s={stroke:"#9ba29a",lineWidth:2,opacity:.5};t.annotation().shape({top:o,render:function(u,l){var f=u.addGroup({id:t.id+"-regression-line",name:"regression-line-group"}),h=kLe({view:l,options:r});f.addShape("path",{name:"regression-line",attrs:nt(nt({path:h},s),i)})}})}return e}function zLe(e){var r=e.chart,t=e.options,n=t.tooltip;return n?r.tooltip(n):n===!1&&r.tooltip(!1),e}function fee(e){return Ei(RLe,rM,OLe,FLe,zLe,DLe,QJ,xS,Y4,ks,BLe,Po,Xa,NLe)(e)}var $Le=Dt({},Ui.getDefaultOptions(),{size:4,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!0,crosshairs:{type:"xy"}}});$i("drag-move",{start:[{trigger:"plot:mousedown",action:"scale-translate:start"}],processing:[{trigger:"plot:mousemove",action:"scale-translate:translate",throttle:{wait:100,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseup",action:"scale-translate:end"}]});var ULe=function(e){ji(r,e);function r(t,n){var i=e.call(this,t,n)||this;return i.type="scatter",i.on(ra.BEFORE_RENDER,function(a){var o,s,u=i,l=u.options,f=u.chart;if(((o=a.data)===null||o===void 0?void 0:o.source)===rp.FILTER){var h=i.chart.filterData(i.chart.getData());rM({chart:f,options:nt(nt({},l),{data:h})})}((s=a.data)===null||s===void 0?void 0:s.source)===rp.RESET&&rM({chart:f,options:l})}),i}return r.getDefaultOptions=function(){return $Le},r.prototype.changeData=function(t){this.updateOption(cee(Dt({},this.options,{data:t})));var n=this,i=n.options,a=n.chart;rM({chart:a,options:i}),this.chart.changeData(t)},r.prototype.getSchemaAdaptor=function(){return fee},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r}(Ui);function VLe(e){var r=e.chart,t=e.options,n=t.data,i=t.lineStyle,a=t.color,o=t.point,s=t.area;r.data(n);var u=Dt({},e,{options:{line:{style:i,color:a},point:o&&nt({color:a},o),area:s&&nt({color:a},s),label:void 0}}),l=Dt({},u,{options:{tooltip:!1}}),f=(o==null?void 0:o.state)||t.state,h=Dt({},u,{options:{tooltip:!1,state:f}});return H2(u),id(h),jI(l),e}function GLe(e){var r,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return Ei(ku((r={},r[a]=n,r[o]=i,r)))(e)}function HLe(e){var r=e.chart,t=e.options,n=t.radius,i=t.startAngle,a=t.endAngle;return r.coordinate("polar",{radius:n,startAngle:i,endAngle:a}),e}function jLe(e){var r=e.chart,t=e.options,n=t.xField,i=t.xAxis,a=t.yField,o=t.yAxis;return r.axis(n,i),r.axis(a,o),e}function WLe(e){var r=e.chart,t=e.options,n=t.label,i=t.yField,a=hf(r,"line");if(!n)a.label(!1);else{var o=n.callback,s=fh(n,["callback"]);a.label({fields:[i],callback:o,cfg:uc(s)})}return e}function XLe(e){return Ei(VLe,GLe,Xa,HLe,jLe,G2,Ul,WLe,ks,Po,mu())(e)}var YLe=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"name",{get:function(){return"radar-tooltip"},enumerable:!1,configurable:!0}),r.prototype.getTooltipItems=function(t){var n=this.getTooltipCfg(),i=n.shared,a=n.title,o=e.prototype.getTooltipItems.call(this,t);if(o.length>0){var s=this.view.geometries[0],u=s.dataArray,l=o[0].name,f=[];return u.forEach(function(h){h.forEach(function(p){var v=dp.getTooltipItems(p,s),m=v[0];if(!i&&m&&m.name===l){var x=rr(a)?l:a;f.push(nt(nt({},m),{name:m.title,title:x}))}else if(i&&m){var x=rr(a)?m.name||l:a;f.push(nt(nt({},m),{name:m.title,title:x}))}})}),f}return[]},r}(kQ);m1("radar-tooltip",YLe);var ZLe=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.init=function(){var t=this.context.view;t.removeInteraction("tooltip")},r.prototype.show=function(){var t=this.context.event,n=this.getTooltipController();n.showTooltip({x:t.x,y:t.y})},r.prototype.hide=function(){var t=this.getTooltipController();t.hideTooltip()},r.prototype.getTooltipController=function(){var t=this.context.view;return t.getController("radar-tooltip")},r}(Vs);hi("radar-tooltip",ZLe);$i("radar-tooltip",{start:[{trigger:"plot:mousemove",action:"radar-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"radar-tooltip:hide"}]});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="radar",t}return r.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},r.prototype.getDefaultOptions=function(){return Dt({},e.prototype.getDefaultOptions.call(this),{xAxis:{label:{offset:15},grid:{line:{type:"line"}}},yAxis:{grid:{line:{type:"circle"}}},legend:{position:"top"},tooltip:{shared:!0,showCrosshairs:!0,showMarkers:!0,crosshairs:{type:"xy",line:{style:{stroke:"#565656",lineDash:[4]}},follow:!0}}})},r.prototype.getSchemaAdaptor=function(){return XLe},r})(Ui);var _2;(function(e){e.Left="Left",e.Right="Right"})(_2||(_2={}));var r1;(function(e){e.Line="line",e.Column="column"})(r1||(r1={}));var ad="left-axes-view",od="right-axes-view",hee={nice:!0,label:{autoHide:!0,autoRotate:!1}},qLe=nt(nt({},hee),{position:"left"}),KLe=nt(nt({},hee),{position:"right",grid:null});function M5(e){return Ie(e,"geometry")===r1.Line}function eB(e){return Ie(e,"geometry")===r1.Column}function m9(e,r,t){return eB(t)?Dt({},{geometry:r1.Column,label:t.label&&t.isRange?{content:function(n){var i;return(i=n[r])===null||i===void 0?void 0:i.join("-")}}:void 0},t):nt({geometry:r1.Line},t)}function y9(e,r){var t=e[0],n=e[1];if(ar(r)){var i=r[0],a=r[1];return[i,a]}var o=Ie(r,t),s=Ie(r,n);return[o,s]}function _9(e,r){return r===_2.Left?e===!1?!1:Dt({},qLe,e):r===_2.Right?e===!1?!1:Dt({},KLe,e):e}function x9(e){var r=e.view,t=e.geometryOption,n=e.yField,i=e.legend,a=Ie(i,"marker"),o=hf(r,M5(t)?"line":"interval");if(!t.seriesField){var s=Ie(r,"options.scales."+n+".alias")||n,u=o.getAttribute("color"),l=r.getTheme().defaultColor;u&&(l=dp.getMappingValue(u,s,Ie(u,["values",0],l)));var f=(kn(a)?a:!uh(a)&&Dt({},{style:{stroke:l,fill:l}},a))||(M5(t)?{symbol:function(p,v,m){return[["M",p-m,v],["L",p+m,v]]},style:{lineWidth:2,r:6,stroke:l}}:{symbol:"square",style:{fill:l}});return[{value:n,name:s,marker:f,isGeometry:!0,viewId:r.id}]}var h=o.getGroupAttributes();return cf(h,function(p,v){var m=dp.getLegendItems(r,o,v,r.getTheme(),a);return p.concat(m)},[])}function QLe(e){var r=e.options,t=e.chart,n=r.geometryOption,i=n.isStack,a=n.color,o=n.seriesField,s=n.groupField,u=n.isGroup,l=["xField","yField"];if(M5(n)){H2(Dt({},e,{options:nt(nt(nt({},Ao(r,l)),n),{line:{color:n.color,style:n.lineStyle}})})),id(Dt({},e,{options:nt(nt(nt({},Ao(r,l)),n),{point:n.point&&nt({color:a,shape:"circle"},n.point)})}));var f=[];u&&f.push({type:"dodge",dodgeBy:s||o,customOffset:0}),i&&f.push({type:"stack"}),f.length&&we(t.geometries,function(h){h.adjust(f)})}return eB(n)&&YI(Dt({},e,{options:nt(nt(nt({},Ao(r,l)),n),{widthRatio:n.columnWidthRatio,interval:nt(nt({},Ao(n,["color"])),{style:n.columnStyle})})})),e}var b9=function(e,r){var t=r[0],n=r[1],i=e.getOptions().data,a=e.getXScale(),o=zl(i);if(!(!a||!o)){var s=Gd(i,a.field),u=s,l=zl(u),f=Math.floor(t*(l-1)),h=Math.floor(n*(l-1));e.filter(a.field,function(p){var v=u.indexOf(p);return v>-1?KAe(v,f,h):!0}),e.getRootView().render(!0)}};function JLe(e){var r,t=e.options,n=t.geometryOptions,i=n===void 0?[]:n,a=t.xField,o=t.yField,s=eI(i,function(u){var l=u.geometry;return l===r1.Line||l===void 0});return Dt({},{options:{geometryOptions:[],meta:(r={},r[a]={type:"cat",sync:!0,range:s?[0,1]:void 0},r),tooltip:{showMarkers:s,showCrosshairs:s,shared:!0,crosshairs:{type:"x"}},interactions:s?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},e,{options:{yAxis:y9(o,t.yAxis),geometryOptions:[m9(a,o[0],i[0]),m9(a,o[1],i[1])],annotations:y9(o,t.annotations)}})}function eIe(e){var r,t,n=e.chart,i=e.options,a=i.geometryOptions,o={line:0,column:1},s=[{type:(r=a[0])===null||r===void 0?void 0:r.geometry,id:ad},{type:(t=a[1])===null||t===void 0?void 0:t.geometry,id:od}];return s.sort(function(u,l){return-o[u.type]+o[l.type]}).forEach(function(u){return n.createView({id:u.id})}),e}function tIe(e){var r=e.chart,t=e.options,n=t.xField,i=t.yField,a=t.geometryOptions,o=t.data,s=t.tooltip,u=[nt(nt({},a[0]),{id:ad,data:o[0],yField:i[0]}),nt(nt({},a[1]),{id:od,data:o[1],yField:i[1]})];return u.forEach(function(l){var f=l.id,h=l.data,p=l.yField,v=eB(l)&&l.isPercent,m=v?ZJ(h,p,n,p):h,x=aa(r,f).data(m),E=v?nt({formatter:function(A){return{name:A[l.seriesField]||p,value:(Number(A[p])*100).toFixed(2)+"%"}}},s):s;QLe({chart:x,options:{xField:n,yField:p,tooltip:E,geometryOption:l}})}),e}function rIe(e){var r,t=e.chart,n=e.options,i=n.geometryOptions,a=((r=t.getTheme())===null||r===void 0?void 0:r.colors10)||[],o=0;return t.once("beforepaint",function(){we(i,function(s,u){var l=aa(t,u===0?ad:od);if(!s.color){var f=l.getGroupScales(),h=Ie(f,[0,"values","length"],1),p=a.slice(o,o+h).concat(u===0?[]:a);l.geometries.forEach(function(v){s.seriesField?v.color(s.seriesField,p):v.color(p[0])}),o+=h}}),t.render(!0)}),e}function nIe(e){var r,t,n=e.chart,i=e.options,a=i.xAxis,o=i.yAxis,s=i.xField,u=i.yField;return ku((r={},r[s]=a,r[u[0]]=o[0],r))(Dt({},e,{chart:aa(n,ad)})),ku((t={},t[s]=a,t[u[1]]=o[1],t))(Dt({},e,{chart:aa(n,od)})),e}function iIe(e){var r=e.chart,t=e.options,n=aa(r,ad),i=aa(r,od),a=t.xField,o=t.yField,s=t.xAxis,u=t.yAxis;return r.axis(a,!1),r.axis(o[0],!1),r.axis(o[1],!1),n.axis(a,s),n.axis(o[0],_9(u[0],_2.Left)),i.axis(a,!1),i.axis(o[1],_9(u[1],_2.Right)),e}function aIe(e){var r=e.chart,t=e.options,n=t.tooltip,i=aa(r,ad),a=aa(r,od);return r.tooltip(n),i.tooltip({shared:!0}),a.tooltip({shared:!0}),e}function oIe(e){var r=e.chart;return ks(Dt({},e,{chart:aa(r,ad)})),ks(Dt({},e,{chart:aa(r,od)})),e}function sIe(e){var r=e.chart,t=e.options,n=t.annotations,i=Ie(n,[0]),a=Ie(n,[1]);return mu(i)(Dt({},e,{chart:aa(r,ad),options:{annotations:i}})),mu(a)(Dt({},e,{chart:aa(r,od),options:{annotations:a}})),e}function uIe(e){var r=e.chart;return Xa(Dt({},e,{chart:aa(r,ad)})),Xa(Dt({},e,{chart:aa(r,od)})),Xa(e),e}function lIe(e){var r=e.chart;return Po(Dt({},e,{chart:aa(r,ad)})),Po(Dt({},e,{chart:aa(r,od)})),e}function cIe(e){var r=e.chart,t=e.options,n=t.yAxis;return t1(Dt({},e,{chart:aa(r,ad),options:{yAxis:n[0]}})),t1(Dt({},e,{chart:aa(r,od),options:{yAxis:n[1]}})),e}function fIe(e){var r=e.chart,t=e.options,n=t.legend,i=t.geometryOptions,a=t.yField,o=t.data,s=aa(r,ad),u=aa(r,od);if(n===!1)r.legend(!1);else if(xo(n)&&n.custom===!0)r.legend(n);else{var l=Ie(i,[0,"legend"],n),f=Ie(i,[1,"legend"],n);r.once("beforepaint",function(){var h=o[0].length?x9({view:s,geometryOption:i[0],yField:a[0],legend:l}):[],p=o[1].length?x9({view:u,geometryOption:i[1],yField:a[1],legend:f}):[];r.legend(Dt({},n,{custom:!0,items:h.concat(p)}))}),i[0].seriesField&&s.legend(i[0].seriesField,l),i[1].seriesField&&u.legend(i[1].seriesField,f),r.on("legend-item:click",function(h){var p=Ie(h,"gEvent.delegateObject",{});if(p&&p.item){var v=p.item,m=v.value,x=v.isGeometry,E=v.viewId;if(x){var A=S3(a,function(R){return R===m});if(A>-1){var L=Ie(aa(r,E),"geometries");we(L,function(R){R.changeVisible(!p.item.unchecked)})}}else{var k=Ie(r.getController("legend"),"option.items",[]);we(r.views,function(R){var D=R.getGroupScales();we(D,function($){$.values&&$.values.indexOf(m)>-1&&R.filter($.field,function(j){var H=$d(k,function(ee){return ee.value===j});return!H.unchecked})}),r.render(!0)})}}})}return e}function hIe(e){var r=e.chart,t=e.options,n=t.slider,i=aa(r,ad),a=aa(r,od);return n&&(i.option("slider",n),i.on("slider:valuechanged",function(o){var s=o.event,u=s.value,l=s.originValue;rs(u,l)||b9(a,u)}),r.once("afterpaint",function(){if(!Zx(n)){var o=n.start,s=n.end;(o||s)&&b9(a,[o,s])}})),e}function pIe(e){return Ei(JLe,eIe,uIe,tIe,nIe,iIe,cIe,aIe,oIe,sIe,lIe,rIe,fIe,hIe)(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="dual-axes",t}return r.prototype.getDefaultOptions=function(){return Dt({},e.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},r.prototype.getSchemaAdaptor=function(){return pIe},r})(Ui);var xE="x",Qb="y",pee={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(e,r){return""+Ie(r,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}},showCrosshairs:!0,crosshairs:{type:"x"}},dIe={appendPadding:2,tooltip:nt({},pee),animation:{}};function b1(e){return gu(e||[],function(r,t){return{x:""+t,y:r}})}function vIe(e){var r=e.chart,t=e.options,n=t.data,i=t.color,a=t.areaStyle,o=t.point,s=t.line,u=o==null?void 0:o.state,l=b1(n);r.data(l);var f=Dt({},e,{options:{xField:xE,yField:Qb,area:{color:i,style:a},line:s,point:o}}),h=Dt({},f,{options:{tooltip:!1}}),p=Dt({},f,{options:{tooltip:!1,state:u}});return jI(f),H2(h),id(p),r.axis(!1),r.legend(!1),e}function W2(e){var r,t,n=e.options,i=n.xAxis,a=n.yAxis,o=n.data,s=b1(o);return Ei(ku((r={},r[xE]=i,r[Qb]=a,r),(t={},t[xE]={type:"cat"},t[Qb]=V4(s,Qb),t)))(e)}function dee(e){return Ei(nd("areaStyle"),vIe,W2,Ul,Xa,Po,mu())(e)}function gIe(e){var r=e.chart,t=e.options,n=t.data,i=t.color,a=t.lineStyle,o=t.point,s=o==null?void 0:o.state,u=b1(n);r.data(u);var l=Dt({},e,{options:{xField:xE,yField:Qb,line:{color:i,style:a},point:o}}),f=Dt({},l,{options:{tooltip:!1,state:s}});return H2(l),id(f),r.axis(!1),r.legend(!1),e}function vee(e){return Ei(gIe,W2,Xa,Ul,Po,mu())(e)}var mIe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="tiny-line",t}return r.getDefaultOptions=function(){return dIe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this,i=n.chart,a=n.options;W2({chart:i,options:a}),i.changeData(b1(t))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return vee},r}(Ui);function yIe(e){var r=e.chart,t=e.options,n=t.data,i=t.color,a=t.columnStyle,o=t.columnWidthRatio,s=b1(n);r.data(s);var u=Dt({},e,{options:{xField:xE,yField:Qb,widthRatio:o,interval:{style:a,color:i}}});return pf(u),r.axis(!1),r.legend(!1),r.interaction("element-active"),e}function gee(e){return Ei(Xa,nd("columnStyle"),yIe,W2,Ul,Po,mu())(e)}var _Ie={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(e,r){return""+Ie(r,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}}},xIe={appendPadding:2,tooltip:nt({},_Ie),animation:{}},bIe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="tiny-column",t}return r.getDefaultOptions=function(){return xIe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this,i=n.chart,a=n.options;W2({chart:i,options:a}),i.changeData(b1(t))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return gee},r}(Ui),wIe={appendPadding:2,tooltip:nt({},pee),color:"l(90) 0:#E5EDFE 1:#ffffff",areaStyle:{fillOpacity:.6},line:{size:1,color:"#5B8FF9"},animation:{}},CIe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="tiny-area",t}return r.getDefaultOptions=function(){return wIe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this,i=n.chart,a=n.options;W2({chart:i,options:a}),i.changeData(b1(t))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return dee},r}(Ui);function w9(e,r,t){if(t===1)return[0,r];var n=Math.floor(e/r);return[r*n,r*(n+1)]}function EIe(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}function mee(e,r,t,n,i){var a=Of(e);eq(a,r);var o=Gd(a,r),s=A3(o),u=s.max-s.min,l=t;if(!t&&n&&(l=n>1?u/(n-1):s.max),!t&&!n){var f=EIe(o);l=u/f}var h={},p=lp(a,i);uh(p)?we(a,function(m){var x=m[r],E=w9(x,l,n),A=E[0]+"-"+E[1];qg(h,A)||(h[A]={range:E,count:0}),h[A].count+=1}):Object.keys(p).forEach(function(m){we(p[m],function(x){var E=x[r],A=w9(E,l,n),L=A[0]+"-"+A[1],k=L+"-"+m;qg(h,k)||(h[k]={range:A,count:0},h[k][i]=m),h[k].count+=1})});var v=[];return we(h,function(m){v.push(m)}),v}var JM="range",bE="count",SIe=Dt({},Ui.getDefaultOptions(),{columnStyle:{stroke:"#FFFFFF"},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]});function AIe(e){var r=e.chart,t=e.options,n=t.data,i=t.binField,a=t.binNumber,o=t.binWidth,s=t.color,u=t.stackField,l=t.legend,f=t.columnStyle,h=mee(n,i,o,a,u);r.data(h);var p=Dt({},e,{options:{xField:JM,yField:bE,seriesField:u,isStack:!0,interval:{color:s,style:f}}});return pf(p),l&&u&&r.legend(u,l),e}function TIe(e){var r,t=e.options,n=t.xAxis,i=t.yAxis;return Ei(ku((r={},r[JM]=n,r[bE]=i,r)))(e)}function MIe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis;return n===!1?r.axis(JM,!1):r.axis(JM,n),i===!1?r.axis(bE,!1):r.axis(bE,i),e}function LIe(e){var r=e.chart,t=e.options,n=t.label,i=hf(r,"interval");if(!n)i.label(!1);else{var a=n.callback,o=fh(n,["callback"]);i.label({fields:[bE],callback:a,cfg:uc(o)})}return e}function yee(e){return Ei(Xa,nd("columnStyle"),AIe,TIe,MIe,b_,LIe,Ul,ks,Po)(e)}var IIe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="histogram",t}return r.getDefaultOptions=function(){return SIe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this.options,i=n.binField,a=n.binNumber,o=n.binWidth,s=n.stackField;this.chart.changeData(mee(t,i,o,a,s))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return yee},r}(Ui),_ee=["#FAAD14","#E8EDF3"],kIe={percent:.2,color:_ee,animation:{}};function tB(e){var r=_s(e1(e)?e:0,0,1);return[{type:"current",percent:r},{type:"target",percent:1-r}]}function xee(e){var r=e.chart,t=e.options,n=t.percent,i=t.progressStyle,a=t.color,o=t.barWidthRatio;r.data(tB(n));var s=Dt({},e,{options:{xField:"1",yField:"percent",seriesField:"type",isStack:!0,widthRatio:o,interval:{style:i,color:ei(a)?[a,_ee[1]]:a},args:{zIndexReversed:!0,sortZIndex:!0}}});return pf(s),r.tooltip(!1),r.axis(!1),r.legend(!1),e}function PIe(e){var r=e.chart;return r.coordinate("rect").transpose(),e}function bee(e){return Ei(xee,ku({}),PIe,Po,Xa,mu())(e)}var RIe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="process",t}return r.getDefaultOptions=function(){return kIe},r.prototype.changeData=function(t){this.updateOption({percent:t}),this.chart.changeData(tB(t))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return bee},r}(Ui);function OIe(e){var r=e.chart,t=e.options,n=t.innerRadius,i=t.radius;return r.coordinate("theta",{innerRadius:n,radius:i}),e}function wee(e,r){var t=e.chart,n=e.options,i=n.innerRadius,a=n.statistic,o=n.percent,s=n.meta;if(t.getController("annotation").clear(!0),i&&a){var u=Ie(s,["percent","formatter"])||function(f){return(f*100).toFixed(2)+"%"},l=a.content;l&&(l=Dt({},l,{content:rr(l.content)?u(o):l.content})),NI(t,{statistic:nt(nt({},a),{content:l}),plotType:"ring-progress"},{percent:o})}return r&&t.render(!0),e}function Cee(e){return Ei(xee,ku({}),OIe,wee,Po,Xa,mu())(e)}var FIe={percent:.2,innerRadius:.8,radius:.98,color:["#FAAD14","#E8EDF3"],statistic:{title:!1,content:{style:{fontSize:"14px",fontWeight:300,fill:"#4D4D4D",textAlign:"center",textBaseline:"middle"}}},animation:{}},DIe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="ring-process",t}return r.getDefaultOptions=function(){return FIe},r.prototype.changeData=function(t){this.chart.emit(ra.BEFORE_CHANGE_DATA,ru.fromData(this.chart,ra.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(tB(t)),wee({chart:this.chart,options:this.options},!0),this.chart.emit(ra.AFTER_CHANGE_DATA,ru.fromData(this.chart,ra.AFTER_CHANGE_DATA,null))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return Cee},r}(Ui);function BIe(e){var r=e.chart,t=e.options,n=t.data,i=t.type,a=t.xField,o=t.yField,s=t.colorField,u=t.sizeField,l=t.sizeRatio,f=t.shape,h=t.color,p=t.tooltip,v=t.heatmapStyle;r.data(n);var m="polygon";i==="density"&&(m="heatmap");var x=Qd(p,[a,o,s]),E=x.fields,A=x.formatter,L=1;return(l||l===0)&&(!f&&!u?console.warn("sizeRatio is not in effect: Must define shape or sizeField first"):l<0||l>1?console.warn("sizeRatio is not in effect: It must be a number in [0,1]"):L=l),_p(Dt({},e,{options:{type:m,colorField:s,tooltipFields:E,shapeField:u||"",label:void 0,mapping:{tooltip:A,shape:f&&(u?function(k){var R=n.map(function(j){return j[u]}),D=Math.min.apply(Math,R),$=Math.max.apply(Math,R);return[f,(Ie(k,u)-D)/($-D),L]}:function(){return[f,1,L]}),color:h||s&&r.getTheme().sequenceColors.join("-"),style:v}}})),e}function NIe(e){var r,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return Ei(ku((r={},r[a]=n,r[o]=i,r)))(e)}function zIe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return n===!1?r.axis(a,!1):r.axis(a,n),i===!1?r.axis(o,!1):r.axis(o,i),e}function $Ie(e){var r=e.chart,t=e.options,n=t.legend,i=t.colorField,a=t.sizeField,o=t.sizeLegend,s=n!==!1;return i&&r.legend(i,s?n:!1),a&&r.legend(a,o===void 0?n:o),!s&&!o&&r.legend(!1),e}function UIe(e){var r=e.chart,t=e.options,n=t.label,i=t.colorField,a=t.type,o=hf(r,a==="density"?"heatmap":"polygon");if(!n)o.label(!1);else if(i){var s=n.callback,u=fh(n,["callback"]);o.label({fields:[i],callback:s,cfg:uc(u)})}return e}function VIe(e){var r=e.chart,t=e.options,n=t.coordinate,i=t.reflect;return n&&r.coordinate({type:n.type||"rect",cfg:n.cfg}),i&&r.coordinate().reflect(i),e}function GIe(e){return Ei(Xa,nd("heatmapStyle"),NIe,VIe,BIe,zIe,$Ie,Ul,UIe,mu(),ks,Po,b_)(e)}var HIe=Dt({},Ui.getDefaultOptions(),{type:"polygon",legend:!1,coordinate:{type:"rect"},xAxis:{tickLine:null,line:null,grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}},yAxis:{grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}}});lo("polygon","circle",{draw:function(e,r){var t,n,i=e.x,a=e.y,o=this.parsePoints(e.points),s=Math.abs(o[2].x-o[1].x),u=Math.abs(o[1].y-o[0].y),l=Math.min(s,u)/2,f=Number(e.shape[1]),h=Number(e.shape[2]),p=Math.sqrt(h),v=l*p*Math.sqrt(f),m=((t=e.style)===null||t===void 0?void 0:t.fill)||e.color||((n=e.defaultStyle)===null||n===void 0?void 0:n.fill),x=r.addShape("circle",{attrs:nt(nt(nt({x:i,y:a,r:v},e.defaultStyle),e.style),{fill:m})});return x}});lo("polygon","square",{draw:function(e,r){var t,n,i=e.x,a=e.y,o=this.parsePoints(e.points),s=Math.abs(o[2].x-o[1].x),u=Math.abs(o[1].y-o[0].y),l=Math.min(s,u),f=Number(e.shape[1]),h=Number(e.shape[2]),p=Math.sqrt(h),v=l*p*Math.sqrt(f),m=((t=e.style)===null||t===void 0?void 0:t.fill)||e.color||((n=e.defaultStyle)===null||n===void 0?void 0:n.fill),x=r.addShape("rect",{attrs:nt(nt(nt({x:i-v/2,y:a-v/2,width:v,height:v},e.defaultStyle),e.style),{fill:m})});return x}});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="heatmap",t}return r.getDefaultOptions=function(){return HIe},r.prototype.getSchemaAdaptor=function(){return GIe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r})(Ui);var FR,x2="$$range$$",jIe="low-q1-median-q3-high",WIe="$$y_outliers$$",Eee="outliers_view",XIe=Dt({},Ui.getDefaultOptions(),{meta:(FR={},FR[x2]={min:0,alias:jIe},FR),interactions:[{type:"active-region"}],tooltip:{showMarkers:!1,shared:!0},boxStyle:{lineWidth:1}}),See=function(e,r){var t=e;if(Array.isArray(r)){var n=r[0],i=r[1],a=r[2],o=r[3],s=r[4];t=gu(e,function(u){return u[x2]=[u[n],u[i],u[a],u[o],u[s]],u})}return t};function YIe(e){var r=e.chart,t=e.options,n=t.xField,i=t.yField,a=t.groupField,o=t.color,s=t.tooltip,u=t.boxStyle;r.data(See(t.data,i));var l=ar(i)?x2:i,f=i?ar(i)?i:[i]:[],h=s;h!==!1&&(h=Dt({},{fields:ar(i)?i:[]},h));var p=Z4(Dt({},e,{options:{xField:n,yField:l,seriesField:a,tooltip:h,rawFields:f,label:!1,schema:{shape:"box",color:o,style:u}}})).ext;return a&&p.geometry.adjust("dodge"),e}function ZIe(e){var r=e.chart,t=e.options,n=t.xField,i=t.data,a=t.outliersField,o=t.outliersStyle,s=t.padding,u=t.label;if(!a)return e;var l=r.createView({padding:s,id:Eee}),f=i.reduce(function(h,p){var v=p[a];return v.forEach(function(m){var x;return h.push(nt(nt({},p),(x={},x[a]=m,x)))}),h},[]);return l.data(f),id({chart:l,options:{xField:n,yField:a,point:{shape:"circle",style:o},label:u}}),l.axis(!1),e}function qIe(e){var r,t,n=e.chart,i=e.options,a=i.meta,o=i.xAxis,s=i.yAxis,u=i.xField,l=i.yField,f=i.outliersField,h=Array.isArray(l)?x2:l,p={};if(f){var v=WIe;p=(r={},r[f]={sync:v,nice:!0},r[h]={sync:v,nice:!0},r)}var m=Dt(p,a,(t={},t[u]=Ao(o,sp),t[h]=Ao(s,sp),t));return n.scale(m),e}function KIe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField,s=Array.isArray(o)?x2:o;return n===!1?r.axis(a,!1):r.axis(a,n),i===!1?r.axis(x2,!1):r.axis(s,i),e}function QIe(e){var r=e.chart,t=e.options,n=t.legend,i=t.groupField;return i?n?r.legend(i,n):r.legend(i,{position:"bottom"}):r.legend(!1),e}function JIe(e){return Ei(YIe,ZIe,qIe,KIe,QIe,Ul,ks,Po,Xa)(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="box",t}return r.getDefaultOptions=function(){return XIe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this.options.yField,i=this.chart.views.find(function(a){return a.id===Eee});i&&i.data(t),this.chart.changeData(See(t,n))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return JIe},r})(Ui);var Aee={exports:{}},Tee={exports:{}};(function(e){var r=e.exports;e.exports.isNumber=function(t){return typeof t=="number"},e.exports.findMin=function(t){if(t.length===0)return 1/0;for(var n=t[0],i=1;i<t.length;i++)n=Math.min(n,t[i]);return n},e.exports.findMax=function(t){if(t.length===0)return-1/0;for(var n=t[0],i=1;i<t.length;i++)n=Math.max(n,t[i]);return n},e.exports.findMinMulti=function(t){for(var n=r.findMin(t[0]),i=1;i<t.length;i++)n=Math.min(n,r.findMin(t[i]));return n},e.exports.findMaxMulti=function(t){for(var n=r.findMax(t[0]),i=1;i<t.length;i++)n=Math.max(n,r.findMax(t[i]));return n},e.exports.inside=function(t,n,i){return t<=i&&i<=n}})(Tee);(function(e){var r=50,t=2,n=Math.log(2),i=e.exports,a=Tee.exports;function o(u){return 1-Math.abs(u)}e.exports.getUnifiedMinMax=function(u,l){return i.getUnifiedMinMaxMulti([u],l)},e.exports.getUnifiedMinMaxMulti=function(u,l){l=l||{};var f=!1,h=!1,p=a.isNumber(l.width)?l.width:t,v=a.isNumber(l.size)?l.size:r,m=a.isNumber(l.min)?l.min:(f=!0,a.findMinMulti(u)),x=a.isNumber(l.max)?l.max:(h=!0,a.findMaxMulti(u)),E=x-m,A=E/(v-1);return f&&(m=m-2*p*A),h&&(x=x+2*p*A),{min:m,max:x}},e.exports.create=function(u,l){if(l=l||{},!u||u.length===0)return[];var f=a.isNumber(l.size)?l.size:r,h=a.isNumber(l.width)?l.width:t,p=i.getUnifiedMinMax(u,{size:f,width:h,min:l.min,max:l.max}),v=p.min,m=p.max,x=m-v,E=x/(f-1);if(x===0)return[{x:v,y:1}];for(var A=[],L=0;L<f;L++)A.push({x:v+L*E,y:0});var k=function(W){return Math.floor((W-v)/E)},R=s(o,h),D=R[h],$=R[h-1]-R[h-2],j=0;u.forEach(function(W){var Q=k(W);if(!(Q+h<0||Q-h>=A.length)){var te=Math.max(Q-h,0),ie=Q,ve=Math.min(Q+h,A.length-1),me=te-(Q-h),Re=Q+h-ve,We=R[-h-1+me]||0,je=R[-h-1+Re]||0,lt=D/(D-We-je);me>0&&(j+=lt*(me-1)*$);var dt=Math.max(0,Q-h+1);a.inside(0,A.length-1,dt)&&(A[dt].y+=lt*1*$),a.inside(0,A.length-1,ie+1)&&(A[ie+1].y-=lt*2*$),a.inside(0,A.length-1,ve+1)&&(A[ve+1].y+=lt*1*$)}});var H=j,ee=0,U=0;return A.forEach(function(W){ee+=W.y,H+=ee,W.y=H,U+=H}),U>0&&A.forEach(function(W){W.y/=U}),A};function s(u,l){for(var f={},h=0,p=-l;p<=l;p++)h+=u(p/l),f[p]=h;return f}e.exports.getExpectedValueFromPdf=function(u){if(!(!u||u.length===0)){var l=0;return u.forEach(function(f){l+=f.x*f.y}),l}},e.exports.getXWithLeftTailArea=function(u,l){if(!(!u||u.length===0)){for(var f=0,h=0,p=0;p<u.length&&(h=p,f+=u[p].y,!(f>=l));p++);return u[h].x}},e.exports.getPerplexity=function(u){if(!(!u||u.length===0)){var l=0;return u.forEach(function(f){var h=Math.log(f.y);isFinite(h)&&(l+=f.y*h)}),l=-l/n,Math.pow(2,l)}}})(Aee);var eke=Aee.exports;function C9(e,r){var t=e.length*r;if(e.length===0)throw new Error("quantile requires at least one data point.");if(r<0||r>1)throw new Error("quantiles must be between 0 and 1");return r===1?e[e.length-1]:r===0?e[0]:t%1!==0?e[Math.ceil(t)-1]:e.length%2===0?(e[t-1]+e[t])/2:e[t]}function zw(e,r,t){var n=e[r];e[r]=e[t],e[t]=n}function nM(e,r,t,n){for(t=t||0,n=n||e.length-1;n>t;){if(n-t>600){var i=n-t+1,a=r-t+1,o=Math.log(i),s=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*s*(i-s)/i);a-i/2<0&&(u*=-1);var l=Math.max(t,Math.floor(r-a*s/i+u)),f=Math.min(n,Math.floor(r+(i-a)*s/i+u));nM(e,r,l,f)}var h=e[r],p=t,v=n;for(zw(e,t,r),e[n]>h&&zw(e,t,n);p<v;){for(zw(e,p,v),p++,v--;e[p]<h;)p++;for(;e[v]>h;)v--}e[t]===h?zw(e,t,v):(v++,zw(e,v,n)),v<=r&&(t=v+1),r<=v&&(n=v-1)}}function $w(e,r){var t=e.slice();if(Array.isArray(r)){tke(t,r);for(var n=[],i=0;i<r.length;i++)n[i]=C9(t,r[i]);return n}else{var a=Lee(t.length,r);return Mee(t,a,0,t.length-1),C9(t,r)}}function Mee(e,r,t,n){r%1===0?nM(e,r,t,n):(r=Math.floor(r),nM(e,r,t,n),nM(e,r+1,r+1,n))}function tke(e,r){for(var t=[0],n=0;n<r.length;n++)t.push(Lee(e.length,r[n]));t.push(e.length-1),t.sort(rke);for(var i=[0,t.length-1];i.length;){var a=Math.ceil(i.pop()),o=Math.floor(i.pop());if(!(a-o<=1)){var s=Math.floor((o+a)/2);Mee(e,t[s],Math.floor(t[o]),Math.ceil(t[a])),i.push(o,s,s,a)}}}function rke(e,r){return e-r}function Lee(e,r){var t=e*r;return r===1?e-1:r===0?0:t%1!==0?Math.ceil(t)-1:e%2===0?t-.5:t}var E9=function(e){return{low:oh(e),high:Ff(e),q1:$w(e,.25),q3:$w(e,.75),median:$w(e,[.5]),minMax:[oh(e),Ff(e)],quantile:[$w(e,.25),$w(e,.75)]}},S9=function(e,r){var t=eke.create(e,r);return{violinSize:t.map(function(n){return n.y}),violinY:t.map(function(n){return n.x})}},Iee=function(e){var r=e.xField,t=e.yField,n=e.seriesField,i=e.data,a=e.kde,o={min:a.min,max:a.max,size:a.sampleSize,width:a.width};if(!n){var s=lp(i,r);return Object.keys(s).map(function(f){var h=s[f],p=h.map(function(v){return v[t]});return nt(nt({x:f},S9(p,o)),E9(p))})}var u=[],l=lp(i,n);return Object.keys(l).forEach(function(f){var h=lp(l[f],r);return Object.keys(h).forEach(function(p){var v,m=h[p],x=m.map(function(E){return E[t]});u.push(nt(nt((v={x:p},v[n]=f,v),S9(x,o)),E9(x)))})}),u},Od="x",Ox="violinY",nke="violinSize",kee="minMax",Pee="quantile",Ree="median",rB="violin_view",ike="min_max_view",ake="quantile_view",oke="median_view",ske=Dt({},Ui.getDefaultOptions(),{syncViewPadding:!0,kde:{type:"triangular",sampleSize:32,width:3},violinStyle:{lineWidth:1,fillOpacity:.3,strokeOpacity:.75},xAxis:{grid:{line:null},tickLine:{alignTick:!1}},yAxis:{grid:{line:{style:{lineWidth:.5,lineDash:[4,4]}}}},legend:{position:"top-left"},tooltip:{showMarkers:!1}}),iM=["low","high","q1","q3","median"],aM=[{type:"dodge",marginRatio:1/32}];function uke(e){var r=e.chart,t=e.options;return r.data(Iee(t)),e}function lke(e){var r=e.chart,t=e.options,n=t.seriesField,i=t.color,a=t.shape,o=a===void 0?"violin":a,s=t.violinStyle,u=t.tooltip,l=t.state,f=r.createView({id:rB});return PTe({chart:f,options:{xField:Od,yField:Ox,seriesField:n||Od,sizeField:nke,tooltip:nt({fields:iM},u),violin:{style:s,color:i,shape:o},state:l}}),f.geometries[0].adjust(aM),e}function cke(e){var r=e.chart,t=e.options,n=t.seriesField,i=t.color,a=t.tooltip,o=t.box;if(o===!1)return e;var s=r.createView({id:ike});pf({chart:s,options:{xField:Od,yField:kee,seriesField:n||Od,tooltip:nt({fields:iM},a),state:typeof o=="object"?o.state:{},interval:{color:i,size:1,style:{lineWidth:0}}}}),s.geometries[0].adjust(aM);var u=r.createView({id:ake});pf({chart:u,options:{xField:Od,yField:Pee,seriesField:n||Od,tooltip:nt({fields:iM},a),state:typeof o=="object"?o.state:{},interval:{color:i,size:8,style:{fillOpacity:1}}}}),u.geometries[0].adjust(aM);var l=r.createView({id:oke});return id({chart:l,options:{xField:Od,yField:Ree,seriesField:n||Od,tooltip:nt({fields:iM},a),state:typeof o=="object"?o.state:{},point:{color:i,size:1,style:{fill:"white",lineWidth:0}}}}),l.geometries[0].adjust(aM),u.axis(!1),s.axis(!1),l.axis(!1),l.legend(!1),s.legend(!1),u.legend(!1),e}function fke(e){var r,t=e.chart,n=e.options,i=n.meta,a=n.xAxis,o=n.yAxis,s={},u=Dt(s,i,(r={},r[Od]=nt(nt({sync:!0},Ao(a,sp)),{type:"cat"}),r[Ox]=nt({sync:!0},Ao(o,sp)),r[kee]=nt({sync:Ox},Ao(o,sp)),r[Pee]=nt({sync:Ox},Ao(o,sp)),r[Ree]=nt({sync:Ox},Ao(o,sp)),r));return t.scale(u),e}function hke(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=aa(r,rB);return n===!1?a.axis(Od,!1):a.axis(Od,n),i===!1?a.axis(Ox,!1):a.axis(Ox,i),r.axis(!1),e}function pke(e){var r=e.chart,t=e.options,n=t.legend,i=t.seriesField,a=t.shape;if(n===!1)r.legend(!1);else{var o=i||Od,s=cS(n,["selected"]);(!a||!a.startsWith("hollow"))&&(Ie(s,["marker","style","lineWidth"])||nl(s,["marker","style","lineWidth"],0)),r.legend(o,s),Ie(n,"selected")&&we(r.views,function(u){return u.legend(o,n)})}return e}function dke(e){var r=e.chart,t=aa(r,rB);return mu()(nt(nt({},e),{chart:t})),e}function vke(e){var r=e.chart,t=e.options,n=t.animation;return we(r.views,function(i){typeof n=="boolean"?i.animate(n):i.animate(!0),we(i.geometries,function(a){a.animate(n)})}),e}function gke(e){return Ei(Xa,uke,lke,cke,fke,Ul,hke,pke,ks,dke,vke)(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="violin",t}return r.getDefaultOptions=function(){return ske},r.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(Iee(this.options))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return gke},r})(Ui);var mke=function(e){return function(r,t){var n=[];return n[0]=e(r[0],t[0]),n[1]=e(r[1],t[1]),n[2]=e(r[2],t[2]),n}},A9={normal:function(e){return e},multiply:function(e,r){return e*r/255},screen:function(e,r){return 255*(1-(1-e/255)*(1-r/255))},overlay:function(e,r){return r<128?2*e*r/255:255*(1-2*(1-e/255)*(1-r/255))},darken:function(e,r){return e>r?r:e},lighten:function(e,r){return e>r?e:r},dodge:function(e,r){return e===255?255:(e=255*(r/255)/(1-e/255),e>255?255:e)},burn:function(e,r){return r===255?255:e===0?0:255*(1-Math.min(1,(1-r/255)/(e/255)))}},yke=function(e){if(!A9[e])throw new Error("unknown blend mode "+e);return A9[e]};function _ke(e,r,t){t===void 0&&(t="normal");var n=mke(yke(t))(eT(e),eT(r)),i=eT(e),a=i[0],o=i[1],s=i[2],u=i[3],l=eT(r),f=l[0],h=l[1],p=l[2],v=l[3],m=Number((u+v*(1-u)).toFixed(2)),x=Math.round((u*(1-v)*(a/255)+u*v*(n[0]/255)+(1-u)*v*(f/255))/m*255),E=Math.round((u*(1-v)*(o/255)+u*v*(n[1]/255)+(1-u)*v*(h/255))/m*255),A=Math.round((u*(1-v)*(s/255)+u*v*(n[2]/255)+(1-u)*v*(p/255))/m*255);return"rgba("+x+", "+E+", "+A+", "+m+")"}function eT(e){var r=e.replace("/s+/g",""),t;return typeof r=="string"&&!r.startsWith("rgba")&&!r.startsWith("#")?t=G0.rgb2arr(G0.toRGB(r)).concat([1]):(r.startsWith("rgba")&&(t=r.replace("rgba(","").replace(")","").split(",")),r.startsWith("#")&&(t=G0.rgb2arr(r).concat([1])),t.map(function(n,i){return i===3?Number(n):n|0}))}function xke(e,r,t,n){n=n||{};var i=n.maxIterations||100,a=n.tolerance||1e-10,o=e(r),s=e(t),u=t-r;if(o*s>0)throw"Initial bisect points must have opposite signs";if(o===0)return r;if(s===0)return t;for(var l=0;l<i;++l){u/=2;var f=r+u,h=e(f);if(h*o>=0&&(r=f),Math.abs(u)<a||h===0)return f}return r+u}function L5(e){for(var r=new Array(e),t=0;t<e;++t)r[t]=0;return r}function T9(e,r){return L5(e).map(function(){return L5(r)})}function Jb(e,r){for(var t=0,n=0;n<e.length;++n)t+=e[n]*r[n];return t}function I5(e){return Math.sqrt(Jb(e,e))}function k5(e,r,t){for(var n=0;n<r.length;++n)e[n]=r[n]*t}function ty(e,r,t,n,i){for(var a=0;a<e.length;++a)e[a]=r*t[a]+n*i[a]}function Oee(e,r,t){t=t||{};var n=t.maxIterations||r.length*200,i=t.nonZeroDelta||1.05,a=t.zeroDelta||.001,o=t.minErrorDelta||1e-6,s=t.minErrorDelta||1e-5,u=t.rho!==void 0?t.rho:1,l=t.chi!==void 0?t.chi:2,f=t.psi!==void 0?t.psi:-.5,h=t.sigma!==void 0?t.sigma:.5,p,v=r.length,m=new Array(v+1);m[0]=r,m[0].fx=e(r),m[0].id=0;for(var x=0;x<v;++x){var E=r.slice();E[x]=E[x]?E[x]*i:a,m[x+1]=E,m[x+1].fx=e(E),m[x+1].id=x+1}function A(Q){for(var te=0;te<Q.length;te++)m[v][te]=Q[te];m[v].fx=Q.fx}for(var L=function(Q,te){return Q.fx-te.fx},k=r.slice(),R=r.slice(),D=r.slice(),$=r.slice(),j=0;j<n;++j){if(m.sort(L),t.history){var H=m.map(function(Q){var te=Q.slice();return te.fx=Q.fx,te.id=Q.id,te});H.sort(function(Q,te){return Q.id-te.id}),t.history.push({x:m[0].slice(),fx:m[0].fx,simplex:H})}for(p=0,x=0;x<v;++x)p=Math.max(p,Math.abs(m[0][x]-m[1][x]));if(Math.abs(m[0].fx-m[v].fx)<o&&p<s)break;for(x=0;x<v;++x){k[x]=0;for(var ee=0;ee<v;++ee)k[x]+=m[ee][x];k[x]/=v}var U=m[v];if(ty(R,1+u,k,-u,U),R.fx=e(R),R.fx<m[0].fx)ty($,1+l,k,-l,U),$.fx=e($),$.fx<R.fx?A($):A(R);else if(R.fx>=m[v-1].fx){var W=!1;if(R.fx>U.fx?(ty(D,1+f,k,-f,U),D.fx=e(D),D.fx<U.fx?A(D):W=!0):(ty(D,1-f*u,k,f*u,U),D.fx=e(D),D.fx<R.fx?A(D):W=!0),W){if(h>=1)break;for(x=1;x<m.length;++x)ty(m[x],1-h,m[0],h,m[x]),m[x].fx=e(m[x])}}else A(R)}return m.sort(L),{fx:m[0].fx,x:m[0]}}function bke(e,r,t,n,i,a,o){var s=t.fx,u=Jb(t.fxprime,r),l=s,f=s,h=u,p=0;i=i||1,a=a||1e-6,o=o||.1;function v(x,E,A){for(var L=0;L<16;++L)if(i=(x+E)/2,ty(n.x,1,t.x,i,r),l=n.fx=e(n.x,n.fxprime),h=Jb(n.fxprime,r),l>s+a*i*u||l>=A)E=i;else{if(Math.abs(h)<=-o*u)return i;h*(E-x)>=0&&(E=x),x=i,A=l}return 0}for(var m=0;m<10;++m){if(ty(n.x,1,t.x,i,r),l=n.fx=e(n.x,n.fxprime),h=Jb(n.fxprime,r),l>s+a*i*u||m&&l>=f)return v(p,i,f);if(Math.abs(h)<=-o*u)return i;if(h>=0)return v(i,p,l);f=l,p=i,i*=2}return i}function wke(e,r,t){var n={x:r.slice(),fx:0,fxprime:r.slice()},i={x:r.slice(),fx:0,fxprime:r.slice()},a=r.slice(),o,s,u=1,l;t=t||{},l=t.maxIterations||r.length*20,n.fx=e(n.x,n.fxprime),o=n.fxprime.slice(),k5(o,n.fxprime,-1);for(var f=0;f<l;++f){if(u=bke(e,o,n,i,u),t.history&&t.history.push({x:n.x.slice(),fx:n.fx,fxprime:n.fxprime.slice(),alpha:u}),!u)k5(o,n.fxprime,-1);else{ty(a,1,i.fxprime,-1,n.fxprime);var h=Jb(n.fxprime,n.fxprime),p=Math.max(0,Jb(a,i.fxprime)/h);ty(o,p,o,-1,i.fxprime),s=n,n=i,i=s}if(I5(n.fxprime)<=1e-5)break}return t.history&&t.history.push({x:n.x.slice(),fx:n.fx,fxprime:n.fxprime.slice(),alpha:u}),n}var Fee=1e-10;function nB(e,r){var t=Eke(e),n=t.filter(function(j){return Cke(j,e)}),i=0,a=0,o,s=[];if(n.length>1){var u=Nee(n);for(o=0;o<n.length;++o){var l=n[o];l.angle=Math.atan2(l.x-u.x,l.y-u.y)}n.sort(function(j,H){return H.angle-j.angle});var f=n[n.length-1];for(o=0;o<n.length;++o){var h=n[o];a+=(f.x+h.x)*(h.y-f.y);for(var p={x:(h.x+f.x)/2,y:(h.y+f.y)/2},v=null,m=0;m<h.parentIndex.length;++m)if(f.parentIndex.indexOf(h.parentIndex[m])>-1){var x=e[h.parentIndex[m]],E=Math.atan2(h.x-x.x,h.y-x.y),A=Math.atan2(f.x-x.x,f.y-x.y),L=A-E;L<0&&(L+=2*Math.PI);var k=A-L/2,R=Xv(p,{x:x.x+x.radius*Math.sin(k),y:x.y+x.radius*Math.cos(k)});R>x.radius*2&&(R=x.radius*2),(v===null||v.width>R)&&(v={circle:x,width:R,p1:h,p2:f})}v!==null&&(s.push(v),i+=P5(v.circle.radius,v.width),f=h)}}else{var D=e[0];for(o=1;o<e.length;++o)e[o].radius<D.radius&&(D=e[o]);var $=!1;for(o=0;o<e.length;++o)if(Xv(e[o],D)>Math.abs(D.radius-e[o].radius)){$=!0;break}$?i=a=0:(i=D.radius*D.radius*Math.PI,s.push({circle:D,p1:{x:D.x,y:D.y+D.radius},p2:{x:D.x-Fee,y:D.y+D.radius},width:D.radius*2}))}return a/=2,r&&(r.area=i+a,r.arcArea=i,r.polygonArea=a,r.arcs=s,r.innerPoints=n,r.intersectionPoints=t),i+a}function Cke(e,r){for(var t=0;t<r.length;++t)if(Xv(e,r[t])>r[t].radius+Fee)return!1;return!0}function Eke(e){for(var r=[],t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)for(var i=Bee(e[t],e[n]),a=0;a<i.length;++a){var o=i[a];o.parentIndex=[t,n],r.push(o)}return r}function P5(e,r){return e*e*Math.acos(1-r/e)-(e-r)*Math.sqrt(r*(2*e-r))}function Xv(e,r){return Math.sqrt((e.x-r.x)*(e.x-r.x)+(e.y-r.y)*(e.y-r.y))}function Dee(e,r,t){if(t>=e+r)return 0;if(t<=Math.abs(e-r))return Math.PI*Math.min(e,r)*Math.min(e,r);var n=e-(t*t-r*r+e*e)/(2*t),i=r-(t*t-e*e+r*r)/(2*t);return P5(e,n)+P5(r,i)}function Bee(e,r){var t=Xv(e,r),n=e.radius,i=r.radius;if(t>=n+i||t<=Math.abs(n-i))return[];var a=(n*n-i*i+t*t)/(2*t),o=Math.sqrt(n*n-a*a),s=e.x+a*(r.x-e.x)/t,u=e.y+a*(r.y-e.y)/t,l=-(r.y-e.y)*(o/t),f=-(r.x-e.x)*(o/t);return[{x:s+l,y:u-f},{x:s-l,y:u+f}]}function Nee(e){for(var r={x:0,y:0},t=0;t<e.length;++t)r.x+=e[t].x,r.y+=e[t].y;return r.x/=e.length,r.y/=e.length,r}function Ske(e,r){r=r||{},r.maxIterations=r.maxIterations||500;var t=r.initialLayout||Lke,n=r.lossFunction||iB;e=Ake(e);var i=t(e,r),a=[],o=[],s;for(s in i)i.hasOwnProperty(s)&&(a.push(i[s].x),a.push(i[s].y),o.push(s));for(var u=Oee(function(h){for(var p={},v=0;v<o.length;++v){var m=o[v];p[m]={x:h[2*v],y:h[2*v+1],radius:i[m].radius}}return n(p,e)},a,r),l=u.x,f=0;f<o.length;++f)s=o[f],i[s].x=l[2*f],i[s].y=l[2*f+1];return i}var zee=1e-10;function R5(e,r,t){return Math.min(e,r)*Math.min(e,r)*Math.PI<=t+zee?Math.abs(e-r):xke(function(n){return Dee(e,r,n)-t},0,e+r)}function Ake(e){e=e.slice();var r=[],t={},n,i,a,o;for(n=0;n<e.length;++n){var s=e[n];s.sets.length==1?r.push(s.sets[0]):s.sets.length==2&&(a=s.sets[0],o=s.sets[1],t[[a,o]]=!0,t[[o,a]]=!0)}for(r.sort(function(u,l){return u>l?1:-1}),n=0;n<r.length;++n)for(a=r[n],i=n+1;i<r.length;++i)o=r[i],[a,o]in t||e.push({sets:[a,o],size:0});return e}function Tke(e,r,t){var n=T9(r.length,r.length),i=T9(r.length,r.length);return e.filter(function(a){return a.sets.length==2}).map(function(a){var o=t[a.sets[0]],s=t[a.sets[1]],u=Math.sqrt(r[o].size/Math.PI),l=Math.sqrt(r[s].size/Math.PI),f=R5(u,l,a.size);n[o][s]=n[s][o]=f;var h=0;a.size+1e-10>=Math.min(r[o].size,r[s].size)?h=1:a.size<=1e-10&&(h=-1),i[o][s]=i[s][o]=h}),{distances:n,constraints:i}}function Mke(e,r,t,n){var i=0,a;for(a=0;a<r.length;++a)r[a]=0;for(a=0;a<t.length;++a)for(var o=e[2*a],s=e[2*a+1],u=a+1;u<t.length;++u){var l=e[2*u],f=e[2*u+1],h=t[a][u],p=n[a][u],v=(l-o)*(l-o)+(f-s)*(f-s),m=Math.sqrt(v),x=v-h*h;p>0&&m<=h||p<0&&m>=h||(i+=2*x*x,r[2*a]+=4*x*(o-l),r[2*a+1]+=4*x*(s-f),r[2*u]+=4*x*(l-o),r[2*u+1]+=4*x*(f-s))}return i}function Lke(e,r){var t=kke(e,r),n=r.lossFunction||iB;if(e.length>=8){var i=Ike(e,r),a=n(i,e),o=n(t,e);a+1e-8<o&&(t=i)}return t}function Ike(e,r){r=r||{};var t=r.restarts||10,n=[],i={},a;for(a=0;a<e.length;++a){var o=e[a];o.sets.length==1&&(i[o.sets[0]]=n.length,n.push(o))}var s=Tke(e,n,i),u=s.distances,l=s.constraints,f=I5(u.map(I5))/u.length;u=u.map(function(L){return L.map(function(k){return k/f})});var h=function(L,k){return Mke(L,k,u,l)},p,v;for(a=0;a<t;++a){var m=L5(u.length*2).map(Math.random);v=wke(h,m,r),(!p||v.fx<p.fx)&&(p=v)}var x=p.x,E={};for(a=0;a<n.length;++a){var A=n[a];E[A.sets[0]]={x:x[2*a]*f,y:x[2*a+1]*f,radius:Math.sqrt(A.size/Math.PI)}}if(r.history)for(a=0;a<r.history.length;++a)k5(r.history[a].x,f);return E}function kke(e,r){for(var t=r&&r.lossFunction?r.lossFunction:iB,n={},i={},a,o=0;o<e.length;++o){var s=e[o];s.sets.length==1&&(a=s.sets[0],n[a]={x:1e10,y:1e10,rowid:Object.keys(n).length,size:s.size,radius:Math.sqrt(s.size/Math.PI)},i[a]=[])}e=e.filter(function(me){return me.sets.length==2});for(var o=0;o<e.length;++o){var u=e[o],l=u.hasOwnProperty("weight")?u.weight:1,f=u.sets[0],h=u.sets[1];u.size+zee>=Math.min(n[f].size,n[h].size)&&(l=0),i[f].push({set:h,size:u.size,weight:l}),i[h].push({set:f,size:u.size,weight:l})}var p=[];for(a in i)if(i.hasOwnProperty(a)){for(var v=0,o=0;o<i[a].length;++o)v+=i[a][o].size*i[a][o].weight;p.push({set:a,size:v})}function m(me,Re){return Re.size-me.size}p.sort(m);var x={};function E(me){return me.set in x}function A(me,Re){n[Re].x=me.x,n[Re].y=me.y,x[Re]=!0}A({x:0,y:0},p[0].set);for(var o=1;o<p.length;++o){var L=p[o].set,k=i[L].filter(E);if(a=n[L],k.sort(m),k.length===0)throw"ERROR: missing pairwise overlap information";for(var R=[],D=0;D<k.length;++D){var $=n[k[D].set],j=R5(a.radius,$.radius,k[D].size);R.push({x:$.x+j,y:$.y}),R.push({x:$.x-j,y:$.y}),R.push({y:$.y+j,x:$.x}),R.push({y:$.y-j,x:$.x});for(var H=D+1;H<k.length;++H)for(var ee=n[k[H].set],U=R5(a.radius,ee.radius,k[H].size),W=Bee({x:$.x,y:$.y,radius:j},{x:ee.x,y:ee.y,radius:U}),Q=0;Q<W.length;++Q)R.push(W[Q])}for(var te=1e50,ie=R[0],D=0;D<R.length;++D){n[L].x=R[D].x,n[L].y=R[D].y;var ve=t(n,e);ve<te&&(te=ve,ie=R[D])}A(ie,L)}return n}function iB(e,r){var t=0;function n(f){return f.map(function(h){return e[h]})}for(var i=0;i<r.length;++i){var a=r[i],o=void 0;if(a.sets.length!=1){if(a.sets.length==2){var s=e[a.sets[0]],u=e[a.sets[1]];o=Dee(s.radius,u.radius,Xv(s,u))}else o=nB(n(a.sets));var l=a.hasOwnProperty("weight")?a.weight:1;t+=l*(o-a.size)*(o-a.size)}}return t}function Pke(e){var r=function(t){var n=Math.max.apply(null,e.map(function(a){return a[t]+a.radius})),i=Math.min.apply(null,e.map(function(a){return a[t]-a.radius}));return{max:n,min:i}};return{xRange:r("x"),yRange:r("y")}}function Rke(e,r,t,n){var i=[],a=[];for(var o in e)e.hasOwnProperty(o)&&(a.push(o),i.push(e[o]));r-=2*n,t-=2*n;var s=Pke(i),u=s.xRange,l=s.yRange;if(u.max==u.min||l.max==l.min)return console.log("not scaling solution: zero size detected"),e;for(var f=r/(u.max-u.min),h=t/(l.max-l.min),p=Math.min(h,f),v=(r-(u.max-u.min)*p)/2,m=(t-(l.max-l.min)*p)/2,x={},E=0;E<i.length;++E){var A=i[E];x[a[E]]={radius:p*A.radius,x:n+v+(A.x-u.min)*p,y:n+m+(A.y-l.min)*p}}return x}function DR(e,r,t){var n=r[0].radius-Xv(r[0],e),i,a;for(i=1;i<r.length;++i)a=r[i].radius-Xv(r[i],e),a<=n&&(n=a);for(i=0;i<t.length;++i)a=Xv(t[i],e)-t[i].radius,a<=n&&(n=a);return n}function $ee(e,r){var t=[],n;for(n=0;n<e.length;++n){var i=e[n];t.push({x:i.x,y:i.y}),t.push({x:i.x+i.radius/2,y:i.y}),t.push({x:i.x-i.radius/2,y:i.y}),t.push({x:i.x,y:i.y+i.radius/2}),t.push({x:i.x,y:i.y-i.radius/2})}var a=t[0],o=DR(t[0],e,r);for(n=1;n<t.length;++n){var s=DR(t[n],e,r);s>=o&&(a=t[n],o=s)}var u=Oee(function(p){return-1*DR({x:p[0],y:p[1]},e,r)},[a.x,a.y],{maxIterations:500,minErrorDelta:1e-10}).x,l={x:u[0],y:u[1]},f=!0;for(n=0;n<e.length;++n)if(Xv(l,e[n])>e[n].radius){f=!1;break}for(n=0;n<r.length;++n)if(Xv(l,r[n])<r[n].radius){f=!1;break}if(!f)if(e.length==1)l={x:e[0].x,y:e[0].y};else{var h={};nB(e,h),h.arcs.length===0?l={x:0,y:-1e3,disjoint:!0}:h.arcs.length==1?l={x:h.arcs[0].circle.x,y:h.arcs[0].circle.y}:r.length?l=$ee(e,[]):l=Nee(h.arcs.map(function(p){return p.p1}))}return l}function Oke(e){var r={},t=[];for(var n in e)t.push(n),r[n]=[];for(var i=0;i<t.length;i++)for(var a=e[t[i]],o=i+1;o<t.length;++o){var s=e[t[o]],u=Xv(a,s);u+s.radius<=a.radius+1e-10?r[t[o]].push(t[i]):u+a.radius<=s.radius+1e-10&&r[t[i]].push(t[o])}return r}function Fke(e,r){for(var t={},n=Oke(e),i=0;i<r.length;++i){for(var a=r[i].sets,o={},s={},u=0;u<a.length;++u){o[a[u]]=!0;for(var l=n[a[u]],f=0;f<l.length;++f)s[l[f]]=!0}var h=[],p=[];for(var v in e)v in o?h.push(e[v]):v in s||p.push(e[v]);var m=$ee(h,p);t[a]=m,m.disjoint&&r[i].size>0&&console.log("WARNING: area "+a+" not represented on screen")}return t}function Dke(e,r,t){var n=[],i=e-t,a=r;return n.push("M",i,a),n.push("A",t,t,0,1,0,i+2*t,a),n.push("A",t,t,0,1,0,i,a),n.join(" ")}function Bke(e){var r={};nB(e,r);var t=r.arcs;if(t.length===0)return"M 0 0";if(t.length==1){var n=t[0].circle;return Dke(n.x,n.y,n.radius)}else{for(var i=[`
M`,t[0].p2.x,t[0].p2.y],a=0;a<t.length;++a){var o=t[a],s=o.circle.radius,u=o.width>s;i.push(`
A`,s,s,0,u?1:0,1,o.p1.x,o.p1.y)}return i.join(" ")}}var hy="id",O5="path",Nke={appendPadding:[10,0,20,0],blendMode:"multiply",tooltip:{showTitle:!1,showMarkers:!1,fields:["id","size"],formatter:function(e){return{name:e.id,value:e.size}}},legend:{position:"top-left"},label:{style:{textAlign:"center",fill:"#fff"}},interactions:[{type:"legend-filter",enable:!1}],state:{active:{style:{stroke:"#000"}},selected:{style:{stroke:"#000",lineWidth:2}},inactive:{style:{fillOpacity:.3,strokeOpacity:.3}}},defaultInteractions:["tooltip","venn-legend-active"]},zke=v1(function(e,r,t,n){var i=new Map,a=e.length;return r.forEach(function(o,s){if(o[n].length===1)i.set(o[hy],e[(s+a)%a]);else{var u=o[n].map(function(l){return i.get(l)});i.set(o[hy],u.slice(1).reduce(function(l,f){return _ke(l,f,t)},u[0]))}}),i},function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return JSON.stringify(e)});function $ke(e,r,t,n){n===void 0&&(n=0);var i=e.data,a=e.setsField,o=e.sizeField;if(i.length===0)return Cy(Kv.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),[];var s=i.map(function(h){var p;return nt(nt({},h),(p={sets:h[a]||[],size:h[o]},p[O5]="",p[hy]="",p))});s.sort(function(h,p){return h.sets.length-p.sets.length});var u=Ske(s),l=Rke(u,r,t,n),f=Fke(l,s);return s.forEach(function(h){var p=h.sets,v=p.join(",");h[hy]=v;var m=p.map(function(A){return l[A]}),x=Bke(m);/[zZ]$/.test(x)||(x+=" Z"),h[O5]=x;var E=f[v]||{x:0,y:0};Na(h,E)}),s}function Uke(e,r){for(var t=0;t<r.length;t++)if(!e.includes(r[t]))return!1;return!0}function Vke(e){return Dt({},e.defaultStyle,{fill:e.color},e.style)}lo("schema","venn",{draw:function(e,r){var t=e.data,n=W3(t[O5]),i=Vke(e),a=r.addGroup({name:"venn-shape"});a.addShape("path",{attrs:nt(nt({},i),{path:n}),name:"venn-path"});var o=e.customInfo,s=o.offsetX,u=o.offsetY,l=dp.transform(null,[["t",s,u]]);return a.setMatrix(l),a},getMarker:function(e){var r=e.color;return{symbol:"circle",style:{lineWidth:0,stroke:r,fill:r,r:4}}}});var Gke=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getLabelPoint=function(t,n,i){var a=t.data,o=a.x,s=a.y,u=t.customLabelInfo,l=u.offsetX,f=u.offsetY;return{content:t.content[i],x:o+l,y:s+f}},r}(OI);mS("venn",Gke);function ZI(e){if(!!e){var r=e.geometries[0].elements;r.forEach(function(t){t.shape.toFront()})}}var Hke=PI("element-active"),jke=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.syncElementsPos=function(){ZI(this.context.view)},r.prototype.active=function(){e.prototype.active.call(this),this.syncElementsPos()},r.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},r.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},r}(Hke),Wke=PI("element-highlight"),Xke=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.syncElementsPos=function(){ZI(this.context.view)},r.prototype.highlight=function(){e.prototype.highlight.call(this),this.syncElementsPos()},r.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},r.prototype.clear=function(){e.prototype.clear.call(this),this.syncElementsPos()},r.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},r}(Wke),Yke=PI("element-selected"),Zke=PI("element-single-selected"),qke=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.syncElementsPos=function(){ZI(this.context.view)},r.prototype.selected=function(){e.prototype.selected.call(this),this.syncElementsPos()},r.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},r.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},r}(Yke),Kke=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.syncElementsPos=function(){ZI(this.context.view)},r.prototype.selected=function(){e.prototype.selected.call(this),this.syncElementsPos()},r.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},r.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},r}(Zke);hi("venn-element-active",jke);hi("venn-element-highlight",Xke);hi("venn-element-selected",qke);hi("venn-element-single-selected",Kke);$i("venn-element-active",{start:[{trigger:"element:mouseenter",action:"venn-element-active:active"}],end:[{trigger:"element:mouseleave",action:"venn-element-active:reset"}]});$i("venn-element-highlight",{start:[{trigger:"element:mouseenter",action:"venn-element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"venn-element-highlight:reset"}]});$i("venn-element-selected",{start:[{trigger:"element:click",action:"venn-element-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-selected:reset"]}]});$i("venn-element-single-selected",{start:[{trigger:"element:click",action:"venn-element-single-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-single-selected:reset"]}]});$i("venn-legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","venn-element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","venn-element-active:reset"]}]});$i("venn-legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","venn-element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","venn-element-highlight:reset"]}]});var Qke=40;function Uee(e,r,t){var n=e.chart,i=e.options,a=i.blendMode,o=i.setsField,s=n.getTheme(),u=s.colors10,l=s.colors20,f=t;ar(f)||(f=r.filter(function(p){return p[o].length===1}).length<=10?u:l);var h=zke(f,r,a,o);return function(p){return h.get(p)||f[0]}}function Jke(e,r){var t=e.options,n=t.color;if(typeof n!="function"){var i=typeof n=="string"?[n]:n,a=Uee(e,r,i);return function(o){return a(o[hy])}}return n}function ePe(e){var r=e.chart,t=e.options,n=t.legend,i=t.appendPadding,a=t.padding,o=t_(i);return n!==!1&&(o=zI(i,Ie(n,"position"),Qke)),r.appendPadding=G4([o,a]),e}function tPe(e){var r=e.options,t=r.data;t||(Cy(Kv.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),t=[]);var n=t.filter(function(a){return a.sets.length===1}).map(function(a){return a.sets[0]}),i=t.filter(function(a){var o=a.sets;return Uke(n,o)});return rs(i,t)||Cy(Kv.WARN,!1,"warn: %s","\u4EA4\u96C6\u4E2D\u4E0D\u80FD\u51FA\u73B0\u4E0D\u5B58\u5728\u7684\u96C6\u5408, \u8BF7\u8F93\u5165\u5408\u6CD5\u6570\u636E"),yn({},e,{options:{data:i}})}function rPe(e){var r=e.chart,t=e.options,n=t.pointStyle,i=t.setsField,a=t.sizeField,o=t_(r.appendPadding),s=o[0],u=o[1],l=o[2],f=o[3],h={offsetX:f,offsetY:s},p=r.viewBBox,v=p.width,m=p.height,x=$ke(t,Math.max(v-(u+f),0),Math.max(m-(s+l),0),0);r.data(x);var E=Z4(Dt({},e,{options:{xField:"x",yField:"y",sizeField:a,seriesField:hy,rawFields:[i,a],schema:{shape:"venn",style:n}}})).ext,A=E.geometry;A.customInfo(h);var L=Jke(e,x);return typeof L=="function"&&A.color(hy,function(k){var R=x.find(function($){return $[hy]===k}),D=Uee(e,x)(k);return L(R,D)}),e}function nPe(e){var r=e.chart,t=e.options,n=t.label,i=t_(r.appendPadding),a=i[0],o=i[3],s={offsetX:o,offsetY:a},u=hf(r,"schema");if(!n)u.label(!1);else{var l=n.callback,f=fh(n,["callback"]);u.label({fields:["id"],callback:l,cfg:yn({},uc(f),{type:"venn",customLabelInfo:s})})}return e}function iPe(e){var r=e.chart,t=e.options,n=t.legend,i=t.sizeField;return r.legend(hy,n),r.legend(i,!1),e}function aPe(e){var r=e.chart;return r.axis(!1),e}function oPe(e){var r=e.options,t=e.chart,n=r.interactions;if(n){var i={"legend-active":"venn-legend-active","legend-highlight":"venn-legend-highlight"};ks(Dt({},e,{options:{interactions:n.map(function(a){return nt(nt({},a),{type:i[a.type]||a.type})})}}))}return t.removeInteraction("legend-active"),t.removeInteraction("legend-highlight"),e}function sPe(e){return Ei(ePe,Xa,tPe,rPe,nPe,ku({}),iPe,aPe,Ul,oPe,Po)(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="venn",t}return r.getDefaultOptions=function(){return Nke},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return sPe},r.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},r})(Ui);var wE="$$stock-range$$",qI="trend",Vee="up",Gee="down",uPe={showMarkers:!1,showCrosshairs:!0,shared:!0,crosshairs:{type:"xy",follow:!0,text:function(e,r,t){var n;if(e==="x"){var i=t[0];n=i?i.title:r}else n=r;return{position:e==="y"?"start":"end",content:n,style:{fill:"#dfdfdf"}}},textBackground:{padding:[2,4],style:{fill:"#666"}}}},lPe=Dt({},Ui.getDefaultOptions(),{tooltip:uPe,interactions:[{type:"tooltip"}],legend:{position:"top-left"},risingFill:"#ef5350",fallingFill:"#26a69a"});function Hee(e,r){return gu(e,function(t){if(ar(r)){var n=r[0],i=r[1],a=r[2],o=r[3];t[qI]=t[n]<=t[i]?Vee:Gee,t[wE]=[t[n],t[i],t[a],t[o]]}return t})}function cPe(e){var r=e.chart,t=e.options,n=t.yField,i=t.data,a=t.risingFill,o=t.fallingFill,s=t.tooltip,u=t.stockStyle;r.data(Hee(i,n));var l=s;return l!==!1&&(l=Dt({},{fields:n},l)),Z4(Dt({},e,{options:{schema:{shape:"candle",color:[a,o],style:u},yField:wE,seriesField:qI,rawFields:n,tooltip:l}})),e}function fPe(e){var r,t,n=e.chart,i=e.options,a=i.meta,o=i.xAxis,s=i.yAxis,u=i.xField,l=(r={},r[u]={type:"timeCat",tickCount:6},r[qI]={values:[Vee,Gee]},r),f=Dt(l,a,(t={},t[u]=Ao(o,sp),t[wE]=Ao(s,sp),t));return n.scale(f),e}function hPe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField;return n===!1?r.axis(a,!1):r.axis(a,n),i===!1?r.axis(wE,!1):r.axis(wE,i),e}function pPe(e){var r=e.chart,t=e.options,n=t.tooltip;return n!==!1?r.tooltip(n):r.tooltip(!1),e}function dPe(e){var r=e.chart,t=e.options,n=t.legend;return n?r.legend(qI,n):n===!1&&r.legend(!1),e}function jee(e){Ei(Xa,cPe,fPe,hPe,pPe,dPe,ks,Po,mu(),xS)(e)}var vPe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="stock",t}return r.getDefaultOptions=function(){return lPe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return jee},r.prototype.changeData=function(t){this.updateOption({data:t});var n=this.options.yField;this.chart.changeData(Hee(t,n))},r}(Ui),BR,n_="$$percentage$$",i_="$$mappingValue$$",py="$$conversion$$",F5="$$totalPercentage$$",CE="$$x$$",EE="$$y$$",gPe={appendPadding:[0,80],minSize:0,maxSize:1,meta:(BR={},BR[i_]={min:0,max:1,nice:!1},BR),label:{style:{fill:"#fff",fontSize:12}},tooltip:{showTitle:!1,showMarkers:!1,shared:!1},conversionTag:{offsetX:10,offsetY:0,style:{fontSize:12,fill:"rgba(0,0,0,0.45)"}}};function Wee(e,r,t){var n=[],i=t.yField,a=t.maxSize,o=t.minSize,s=Ie(M3(r,i),[i]),u=xi(a)?a:1,l=xi(o)?o:0;return n=gu(e,function(f,h){var p=(f[i]||0)/s;return f[n_]=p,f[i_]=(u-l)*p+l,f[py]=[Ie(e,[h-1,i]),f[i]],f}),n}function aB(e){return function(r){var t=r.chart,n=r.options,i=n.conversionTag,a=t.getOptions().data;if(i){var o=i.formatter;a.forEach(function(s,u){if(!(u<=0||Number.isNaN(s[i_]))){var l=e(s,u,a,{top:!0,text:{content:kn(o)?o(s,a):o,offsetX:i.offsetX,offsetY:i.offsetY,position:"end",autoRotate:!1,style:nt({textAlign:"start",textBaseline:"middle"},i.style)}});t.annotation().line(l)}})}return r}}function mPe(e){var r=e.chart,t=e.options,n=t.data,i=n===void 0?[]:n,a=t.yField,o=t.maxSize,s=t.minSize,u=Wee(i,i,{yField:a,maxSize:o,minSize:s});return r.data(u),e}function yPe(e){var r=e.chart,t=e.options,n=t.xField,i=t.yField,a=t.color,o=t.tooltip,s=t.label,u=t.shape,l=u===void 0?"funnel":u,f=t.funnelStyle,h=t.state,p=Qd(o,[n,i]),v=p.fields,m=p.formatter;_p({chart:r,options:{type:"interval",xField:n,yField:i_,colorField:n,tooltipFields:ar(v)&&v.concat([n_,py]),mapping:{shape:l,tooltip:m,color:a,style:f},label:s,state:h}});var x=hf(e.chart,"interval");return x.adjust("symmetric"),e}function _Pe(e){var r=e.chart,t=e.options,n=t.isTransposed;return r.coordinate({type:"rect",actions:n?[]:[["transpose"],["scale",1,-1]]}),e}function xPe(e){var r=e.options,t=r.maxSize,n=function(i,a,o,s){var u=t-(t-i[i_])/2;return nt(nt({},s),{start:[a-.5,u],end:[a-.5,u+.05]})};return aB(n)(e),e}function Xee(e){return Ei(mPe,yPe,_Pe,xPe)(e)}function bPe(e){var r,t=e.chart,n=e.options,i=n.data,a=i===void 0?[]:i,o=n.yField;return t.data(a),t.scale((r={},r[o]={sync:!0},r)),e}function wPe(e){var r=e.chart,t=e.options,n=t.data,i=t.xField,a=t.yField,o=t.color,s=t.compareField,u=t.isTransposed,l=t.tooltip,f=t.maxSize,h=t.minSize,p=t.label,v=t.funnelStyle,m=t.state,x=t.showFacetTitle;return r.facet("mirror",{fields:[s],transpose:!u,padding:u?0:[32,0,0,0],showTitle:x,eachView:function(E,A){var L=u?A.rowIndex:A.columnIndex;u||E.coordinate({type:"rect",actions:[["transpose"],["scale",L===0?-1:1,-1]]});var k=Wee(A.data,n,{yField:a,maxSize:f,minSize:h});E.data(k);var R=Qd(l,[i,a,s]),D=R.fields,$=R.formatter,j=u?{offset:L===0?10:-23,position:L===0?"bottom":"top"}:{offset:10,position:"left",style:{textAlign:L===0?"end":"start"}};_p({chart:E,options:{type:"interval",xField:i,yField:i_,colorField:i,tooltipFields:ar(D)&&D.concat([n_,py]),mapping:{shape:"funnel",tooltip:$,color:o,style:v},label:p===!1?!1:Dt({},j,p),state:m}})}}),e}function CPe(e){var r=e.chart,t=e.options,n=t.conversionTag,i=t.isTransposed;return r.once("beforepaint",function(){r.views.forEach(function(a,o){var s=function(u,l,f,h){var p=o===0?-1:1;return Dt({},h,{start:[l-.5,u[i_]],end:[l-.5,u[i_]+.05],text:i?{style:{textAlign:"start"}}:{offsetX:n!==!1?p*n.offsetX:0,style:{textAlign:o===0?"end":"start"}}})};aB(s)(Dt({},{chart:a,options:t}))})}),e}function EPe(e){return Ei(bPe,wPe,CPe)(e)}function SPe(e){var r,t=e.chart,n=e.options,i=n.data,a=i===void 0?[]:i,o=n.yField;return t.data(a),t.scale((r={},r[o]={sync:!0},r)),e}function APe(e){var r=e.chart,t=e.options,n=t.seriesField,i=t.isTransposed,a=t.showFacetTitle;return r.facet("rect",{fields:[n],padding:[i?0:32,10,0,10],showTitle:a,eachView:function(o,s){Xee(Dt({},e,{chart:o,options:{data:s.data}}))}}),e}function TPe(e){return Ei(SPe,APe)(e)}function MPe(e){var r=e.chart,t=e.options,n=t.data,i=n===void 0?[]:n,a=t.yField,o=cf(i,function(l,f){return l+(f[a]||0)},0),s=M3(i,a)[a],u=gu(i,function(l,f){var h=[],p=[];if(l[F5]=(l[a]||0)/o,f){var v=i[f-1][CE],m=i[f-1][EE];h[0]=v[3],p[0]=m[3],h[1]=v[2],p[1]=m[2]}else h[0]=-.5,p[0]=1,h[1]=.5,p[1]=1;return p[2]=p[1]-l[F5],h[2]=(p[2]+1)/4,p[3]=p[2],h[3]=-h[2],l[CE]=h,l[EE]=p,l[n_]=(l[a]||0)/s,l[py]=[Ie(i,[f-1,a]),l[a]],l});return r.data(u),e}function LPe(e){var r=e.chart,t=e.options,n=t.xField,i=t.yField,a=t.color,o=t.tooltip,s=t.label,u=t.funnelStyle,l=t.state,f=Qd(o,[n,i]),h=f.fields,p=f.formatter;return _p({chart:r,options:{type:"polygon",xField:CE,yField:EE,colorField:n,tooltipFields:ar(h)&&h.concat([n_,py]),label:s,state:l,mapping:{tooltip:p,color:a,style:u}}}),e}function IPe(e){var r=e.chart,t=e.options,n=t.isTransposed;return r.coordinate({type:"rect",actions:n?[["transpose"],["reflect","x"]]:[]}),e}function kPe(e){var r=function(t,n,i,a){return nt(nt({},a),{start:[t[CE][1],t[EE][1]],end:[t[CE][1]+.05,t[EE][1]]})};return aB(r)(e),e}function PPe(e){return Ei(MPe,LPe,IPe,kPe)(e)}function RPe(e){var r=e.options,t=r.compareField,n=r.xField,i=r.yField,a=r.locale,o=r.funnelStyle,s=r.data,u=$I(a),l={label:t?{fields:[n,i,t,n_,py],formatter:function(h){return""+h[i]}}:{fields:[n,i,n_,py],offset:0,position:"middle",formatter:function(h){return h[n]+" "+h[i]}},tooltip:{title:n,formatter:function(h){return{name:h[n],value:h[i]}}},conversionTag:{formatter:function(h){return u.get(["conversionTag","label"])+": "+KJ.apply(void 0,h[py])}}},f;return(t||o)&&(f=function(h){return Dt({},t&&{lineWidth:1,stroke:"#fff"},kn(o)?o(h):o)}),Dt({options:l},e,{options:{funnelStyle:f,data:Of(s)}})}function OPe(e){var r=e.options,t=r.compareField,n=r.dynamicHeight,i=r.seriesField;return i?TPe(e):t?EPe(e):n?PPe(e):Xee(e)}function FPe(e){var r,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return Ei(ku((r={},r[a]=n,r[o]=i,r)))(e)}function DPe(e){var r=e.chart;return r.axis(!1),e}function BPe(e){var r=e.chart,t=e.options,n=t.legend;return n===!1?r.legend(!1):r.legend(n),e}function Yee(e){return Ei(RPe,OPe,FPe,DPe,Ul,ks,BPe,Po,Xa,mu())(e)}var NPe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="funnel",t}return r.getDefaultOptions=function(){return gPe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return Yee},r.prototype.setState=function(t,n,i){i===void 0&&(i=!0);var a=_E(this.chart);we(a,function(o){n(o.getData())&&o.setState(t,i)})},r.prototype.getStates=function(){var t=_E(this.chart),n=[];return we(t,function(i){var a=i.getData(),o=i.getStates();we(o,function(s){n.push({data:a,state:s,geometry:i.geometry,element:i})})}),n},r.CONVERSATION_FIELD=py,r.PERCENT_FIELD=n_,r.TOTAL_PERCENT_FIELD=F5,r}(Ui),zPe="liquid";function Zee(e){return[{percent:e,type:zPe}]}function $Pe(e){var r=e.chart,t=e.options,n=t.percent,i=t.liquidStyle,a=t.radius,o=t.outline,s=t.wave,u=t.shape,l=t.animation;r.scale({percent:{min:0,max:1}}),r.data(Zee(n));var f=t.color||r.getTheme().defaultColor,h=Dt({},e,{options:{xField:"type",yField:"percent",widthRatio:a,interval:{color:f,style:i,shape:"liquid-fill-gauge"}}}),p=pf(h).ext,v=p.geometry,m=r.getTheme().background,x={radius:a,outline:o,wave:s,shape:u,background:m,animation:l};return v.customInfo(x),r.legend(!1),r.axis(!1),r.tooltip(!1),e}function qee(e,r){var t=e.chart,n=e.options,i=n.statistic,a=n.percent,o=n.meta;t.getController("annotation").clear(!0);var s=Ie(o,["percent","formatter"])||function(l){return(l*100).toFixed(2)+"%"},u=i.content;return u&&(u=Dt({},u,{content:rr(u.content)?s(a):u.content})),NI(t,{statistic:nt(nt({},i),{content:u}),plotType:"liquid"},{percent:a}),r&&t.render(!0),e}function UPe(e){return Ei(Xa,nd("liquidStyle"),$Pe,qee,ku({}),Po,ks)(e)}var VPe={radius:.9,statistic:{title:!1,content:{style:{opacity:.75,fontSize:"30px",lineHeight:"30px",textAlign:"center"}}},outline:{border:2,distance:0},wave:{count:3,length:192},shape:"circle"},M9=5e3;function L9(e,r,t){return e+(r-e)*t}function GPe(e){var r=nt({opacity:1},e.style);return e.color&&!r.fill&&(r.fill=e.color),r}function HPe(e){var r={fill:"#fff",fillOpacity:0,lineWidth:4},t=Na({},r,e.style);return e.color&&!t.stroke&&(t.stroke=e.color),xi(e.opacity)&&(t.opacity=t.strokeOpacity=e.opacity),t}function jPe(e,r,t,n){return r===0?[[e+1/2*t/Math.PI/2,n/2],[e+1/2*t/Math.PI,n],[e+t/4,n]]:r===1?[[e+1/2*t/Math.PI/2*(Math.PI-2),n],[e+1/2*t/Math.PI/2*(Math.PI-1),n/2],[e+t/4,0]]:r===2?[[e+1/2*t/Math.PI/2,-n/2],[e+1/2*t/Math.PI,-n],[e+t/4,-n]]:[[e+1/2*t/Math.PI/2*(Math.PI-2),-n],[e+1/2*t/Math.PI/2*(Math.PI-1),-n/2],[e+t/4,0]]}function WPe(e,r,t,n,i,a,o){for(var s=Math.ceil(2*e/t*4)*4,u=[],l=n;l<-Math.PI*2;)l+=Math.PI*2;for(;l>0;)l-=Math.PI*2;l=l/Math.PI/2*t;var f=a-e+l-e*2;u.push(["M",f,r]);for(var h=0,p=0;p<s;++p){var v=p%4,m=jPe(p*t/4,v,t,i);u.push(["C",m[0][0]+f,-m[0][1]+r,m[1][0]+f,-m[1][1]+r,m[2][0]+f,-m[2][1]+r]),p===s-1&&(h=m[2][0])}return u.push(["L",h+f,o+e]),u.push(["L",f,o+e]),u.push(["Z"]),u}function XPe(e,r,t,n,i,a,o,s,u,l){for(var f=i.fill,h=i.opacity,p=o.getBBox(),v=p.maxX-p.minX,m=p.maxY-p.minY,x=0;x<n;x++){var E=n<=1?0:x/(n-1),A=a.addShape("path",{name:"waterwave-path",attrs:{path:WPe(s,p.minY+m*t,u,0,v/32,e,r),fill:f,opacity:L9(.2,.9,E)*h}});try{if(l===!1)return;var L=T5([["t",u,0]]);A.stopAnimate(),A.animate({matrix:L},{duration:L9(.5*M9,M9,E),repeat:!0})}catch{console.warn("off-screen group animate error!")}}}function YPe(e,r,t,n){var i=t*2/3,a=Math.max(i,n),o=i/2,s=e,u=o+r-a/2,l=Math.asin(o/((a-o)*.85)),f=Math.sin(l)*o,h=Math.cos(l)*o,p=s-h,v=u+f,m=e,x=u+o/Math.sin(l);return`
      M `+p+" "+v+`
      A `+o+" "+o+" 0 1 1 "+(p+h*2)+" "+v+`
      Q `+m+" "+x+" "+e+" "+(r+a/2)+`
      Q `+m+" "+x+" "+p+" "+v+`
      Z 
    `}function ZPe(e,r,t,n){var i=t/2,a=n/2;return`
      M `+e+" "+(r-a)+` 
      a `+i+" "+a+" 0 1 0 0 "+a*2+`
      a `+i+" "+a+" 0 1 0 0 "+-a*2+`
      Z
    `}function qPe(e,r,t,n){var i=n/2,a=t/2;return`
      M `+e+" "+(r-i)+`
      L `+(e+a)+" "+r+`
      L `+e+" "+(r+i)+`
      L `+(e-a)+" "+r+`
      Z
    `}function KPe(e,r,t,n){var i=n/2,a=t/2;return`
      M `+e+" "+(r-i)+`
      L `+(e+a)+" "+(r+i)+`
      L `+(e-a)+" "+(r+i)+`
      Z
    `}function QPe(e,r,t,n){var i=.618,a=n/2,o=t/2*i;return`
      M `+(e-o)+" "+(r-a)+`
      L `+(e+o)+" "+(r-a)+`
      L `+(e+o)+" "+(r+a)+`
      L `+(e-o)+" "+(r+a)+`
      Z
    `}var I9={pin:YPe,circle:ZPe,diamond:qPe,triangle:KPe,rect:QPe};lo("interval","liquid-fill-gauge",{draw:function(e,r){var t=.5,n=.5,i=e.customInfo,a=i,o=a.radius,s=a.shape,u=a.background,l=a.animation,f=i.outline,h=i.wave,p=f.border,v=f.distance,m=h.count,x=h.length,E=cf(e.points,function(Q,te){return Math.min(Q,te.x)},1/0),A=this.parsePoint({x:t,y:n}),L=this.parsePoint({x:E,y:n}),k=A.x-L.x,R=Math.min(k,L.y*o),D=GPe(e),$=HPe(Na({},e,f)),j=R-p/2,H=typeof s=="function"?s:I9[s]||I9.circle,ee=H(A.x,A.y,j*2,j*2),U=r.addGroup({name:"waves"}),W=U.setClip({type:"path",attrs:{path:ee}});return XPe(A.x,A.y,1-e.points[1].y,m,D,U,W,R*2,x,l),r.addShape("path",{name:"distance",attrs:{path:ee,fill:"transparent",lineWidth:p+v*2,stroke:u==="transparent"?"#fff":u}}),r.addShape("path",{name:"wrap",attrs:Na($,{path:ee,fill:"transparent",lineWidth:p})}),r}});var JPe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="liquid",t}return r.getDefaultOptions=function(){return VPe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.changeData=function(t){this.chart.emit(ra.BEFORE_CHANGE_DATA,ru.fromData(this.chart,ra.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(Zee(t)),qee({chart:this.chart,options:this.options},!0),this.chart.emit(ra.AFTER_CHANGE_DATA,ru.fromData(this.chart,ra.AFTER_CHANGE_DATA,null))},r.prototype.getSchemaAdaptor=function(){return UPe},r}(Ui);function k9(e,r,t){return e.length>1?r+"_"+t:""+r}function Kee(e){var r=e.data,t=e.xField,n=e.measureField,i=e.rangeField,a=e.targetField,o=e.layout,s=[],u=[];r.forEach(function(h,p){var v=[h[i]].flat();v.sort(function(E,A){return E-A}),v.forEach(function(E,A){var L,k=A===0?E:v[A]-v[A-1];s.push((L={rKey:i+"_"+A},L[t]=t?h[t]:String(p),L[i]=k,L))});var m=[h[n]].flat();m.forEach(function(E,A){var L;s.push((L={mKey:k9(m,n,A)},L[t]=t?h[t]:String(p),L[n]=E,L))});var x=[h[a]].flat();x.forEach(function(E,A){var L;s.push((L={tKey:k9(x,a,A)},L[t]=t?h[t]:String(p),L[a]=E,L))}),u.push(h[i],h[n],h[a])});var l=Math.min.apply(Math,u.flat(1/0)),f=Math.max.apply(Math,u.flat(1/0));return l=l>0?0:l,o==="vertical"&&s.reverse(),{min:l,max:f,ds:s}}function eRe(e){var r=e.chart,t=e.options,n=t.bulletStyle,i=t.targetField,a=t.rangeField,o=t.measureField,s=t.xField,u=t.color,l=t.layout,f=t.size,h=t.label,p=Kee(t),v=p.min,m=p.max,x=p.ds;r.data(x);var E=Dt({},e,{options:{xField:s,yField:a,seriesField:"rKey",isStack:!0,label:Ie(h,"range"),interval:{color:Ie(u,"range"),style:Ie(n,"range"),size:Ie(f,"range")}}});pf(E),r.geometries[0].tooltip(!1);var A=Dt({},e,{options:{xField:s,yField:o,seriesField:"mKey",isStack:!0,label:Ie(h,"measure"),interval:{color:Ie(u,"measure"),style:Ie(n,"measure"),size:Ie(f,"measure")}}});pf(A);var L=Dt({},e,{options:{xField:s,yField:i,seriesField:"tKey",label:Ie(h,"target"),point:{color:Ie(u,"target"),style:Ie(n,"target"),size:kn(Ie(f,"target"))?function(k){return Ie(f,"target")(k)/2}:Ie(f,"target")/2,shape:l==="horizontal"?"line":"hyphen"}}});return id(L),l==="horizontal"&&r.coordinate().transpose(),nt(nt({},e),{ext:{data:{min:v,max:m}}})}function Qee(e){var r,t,n=e.options,i=e.ext,a=n.xAxis,o=n.yAxis,s=n.targetField,u=n.rangeField,l=n.measureField,f=n.xField,h=i.data;return Ei(ku((r={},r[f]=a,r[l]=o,r),(t={},t[l]={min:h==null?void 0:h.min,max:h==null?void 0:h.max,sync:!0},t[s]={sync:""+l},t[u]={sync:""+l},t)))(e)}function tRe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.measureField,s=t.rangeField,u=t.targetField;return r.axis(""+s,!1),r.axis(""+u,!1),n===!1?r.axis(""+a,!1):r.axis(""+a,n),i===!1?r.axis(""+o,!1):r.axis(""+o,i),e}function rRe(e){var r=e.chart,t=e.options,n=t.legend;return r.removeInteraction("legend-filter"),r.legend(n),r.legend("rKey",!1),r.legend("mKey",!1),r.legend("tKey",!1),e}function nRe(e){var r=e.chart,t=e.options,n=t.label,i=t.measureField,a=t.targetField,o=t.rangeField,s=r.geometries,u=s[0],l=s[1],f=s[2];return Ie(n,"range")?u.label(""+o,nt({layout:[{type:"limit-in-plot"}]},uc(n.range))):u.label(!1),Ie(n,"measure")?l.label(""+i,nt({layout:[{type:"limit-in-plot"}]},uc(n.measure))):l.label(!1),Ie(n,"target")?f.label(""+a,nt({layout:[{type:"limit-in-plot"}]},uc(n.target))):f.label(!1),e}function iRe(e){Ei(eRe,Qee,tRe,rRe,Xa,nRe,Ul,ks,Po)(e)}var aRe=Dt({},Ui.getDefaultOptions(),{layout:"horizontal",size:{range:30,measure:20,target:20},xAxis:{tickLine:!1,line:null},bulletStyle:{range:{fillOpacity:.5}},label:{measure:{position:"right"}},tooltip:{showMarkers:!1}});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="bullet",t}return r.getDefaultOptions=function(){return aRe},r.prototype.changeData=function(t){this.updateOption({data:t});var n=Kee(this.options),i=n.min,a=n.max,o=n.ds;Qee({options:this.options,ext:{data:{min:i,max:a}},chart:this.chart}),this.chart.changeData(o)},r.prototype.getSchemaAdaptor=function(){return iRe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r})(Ui);var Jee="nodeIndex",ete="childNodeCount",oB="nodeAncestor",NR="Invalid field: it must be a string!";function sB(e,r){var t=e.field,n=e.fields;if(ei(t))return t;if(ar(t))return console.warn(NR),t[0];if(console.warn(NR+" will try to get fields instead."),ei(n))return n;if(ar(n)&&n.length)return n[0];if(r)return r;throw new TypeError(NR)}function uB(e){var r=[];if(e&&e.each){var t,n;e.each(function(i){var a,o;i.parent!==t?(t=i.parent,n=0):n+=1;var s=kc((((a=i.ancestors)===null||a===void 0?void 0:a.call(i))||[]).map(function(u){return r.find(function(l){return l.name===u.name})||u}),function(u){var l=u.depth;return l>0&&l<i.depth});i[oB]=s,i[ete]=((o=i.children)===null||o===void 0?void 0:o.length)||0,i[Jee]=n,r.push(i)})}else e&&e.eachNode&&e.eachNode(function(i){r.push(i)});return r}var lB="ancestor-node",tte="value",SE="path",oRe=[SE,Jee,oB,ete,"name","depth","height"],sRe=Dt({},Ui.getDefaultOptions(),{innerRadius:0,radius:.85,hierarchyConfig:{field:"value"},tooltip:{shared:!0,showMarkers:!1,offset:20,showTitle:!1},legend:!1,sunburstStyle:{lineWidth:.5,stroke:"#FFF"},drilldown:{enabled:!0}}),P9=4,uRe=0,R9=5,O9="drilldown-bread-crumb",lRe={position:"top-left",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}},AE="hierarchy-data-transform-params",cRe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.name="drill-down",t.historyCache=[],t.breadCrumbGroup=null,t.breadCrumbCfg=lRe,t}return r.prototype.click=function(){var t=Ie(this.context,["event","data","data"]);if(!t)return!1;this.drill(t),this.drawBreadCrumb()},r.prototype.resetPosition=function(){if(!!this.breadCrumbGroup){var t=this.context.view.getCoordinate(),n=this.breadCrumbGroup,i=n.getBBox(),a=this.getButtonCfg().position,o={x:t.start.x,y:t.end.y-(i.height+R9*2)};t.isPolar&&(o={x:0,y:0}),a==="bottom-left"&&(o={x:t.start.x,y:t.start.y});var s=dp.transform(null,[["t",o.x+uRe,o.y+i.height+R9]]);n.setMatrix(s)}},r.prototype.back=function(){zl(this.historyCache)&&this.backTo(this.historyCache.slice(0,-1))},r.prototype.reset=function(){this.historyCache[0]&&this.backTo(this.historyCache.slice(0,1)),this.historyCache=[],this.hideCrumbGroup()},r.prototype.drill=function(t){var n=this.context.view,i=Ie(n,["interactions","drill-down","cfg","transformData"],function(l){return l}),a=i(nt({data:t.data},t[AE]));n.changeData(a);for(var o=[],s=t;s;){var u=s.data;o.unshift({id:u.name+"_"+s.height+"_"+s.depth,name:u.name,children:i(nt({data:u},t[AE]))}),s=s.parent}this.historyCache=(this.historyCache||[]).slice(0,-1).concat(o)},r.prototype.backTo=function(t){if(!(!t||t.length<=0)){var n=this.context.view,i=al(t).children;n.changeData(i),t.length>1?(this.historyCache=t,this.drawBreadCrumb()):(this.historyCache=[],this.hideCrumbGroup())}},r.prototype.getButtonCfg=function(){var t=this.context.view,n=Ie(t,["interactions","drill-down","cfg","drillDownConfig"]);return Dt(this.breadCrumbCfg,n==null?void 0:n.breadCrumb,this.cfg)},r.prototype.drawBreadCrumb=function(){this.drawBreadCrumbGroup(),this.resetPosition(),this.breadCrumbGroup.show()},r.prototype.drawBreadCrumbGroup=function(){var t=this,n=this.getButtonCfg(),i=this.historyCache;this.breadCrumbGroup?this.breadCrumbGroup.clear():this.breadCrumbGroup=this.context.view.foregroundGroup.addGroup({name:O9});var a=0;i.forEach(function(o,s){var u=t.breadCrumbGroup.addShape({type:"text",id:o.id,name:O9+"_"+o.name+"_text",attrs:nt(nt({text:s===0&&!rr(n.rootText)?n.rootText:o.name},n.textStyle),{x:a,y:0})}),l=u.getBBox();if(a+=l.width+P9,u.on("click",function(p){var v,m=p.target.get("id");if(m!==((v=al(i))===null||v===void 0?void 0:v.id)){var x=i.slice(0,i.findIndex(function(E){return E.id===m})+1);t.backTo(x)}}),u.on("mouseenter",function(p){var v,m=p.target.get("id");m!==((v=al(i))===null||v===void 0?void 0:v.id)?u.attr(n.activeTextStyle):u.attr({cursor:"default"})}),u.on("mouseleave",function(){u.attr(n.textStyle)}),s<i.length-1){var f=t.breadCrumbGroup.addShape({type:"text",name:n.name+"_"+o.name+"_divider",attrs:nt(nt({text:n.dividerText},n.textStyle),{x:a,y:0})}),h=f.getBBox();a+=h.width+P9}})},r.prototype.hideCrumbGroup=function(){this.breadCrumbGroup&&this.breadCrumbGroup.hide()},r.prototype.destroy=function(){this.breadCrumbGroup&&this.breadCrumbGroup.remove(),e.prototype.destroy.call(this)},r}(Vs);function fRe(e,r){return e.parent===r.parent?1:2}function hRe(e){return e.reduce(pRe,0)/e.length}function pRe(e,r){return e+r.x}function dRe(e){return 1+e.reduce(vRe,0)}function vRe(e,r){return Math.max(e,r.y)}function gRe(e){for(var r;r=e.children;)e=r[0];return e}function mRe(e){for(var r;r=e.children;)e=r[r.length-1];return e}function yRe(){var e=fRe,r=1,t=1,n=!1;function i(a){var o,s=0;a.eachAfter(function(p){var v=p.children;v?(p.x=hRe(v),p.y=dRe(v)):(p.x=o?s+=e(p,o):0,p.y=0,o=p)});var u=gRe(a),l=mRe(a),f=u.x-e(u,l)/2,h=l.x+e(l,u)/2;return a.eachAfter(n?function(p){p.x=(p.x-a.x)*r,p.y=(a.y-p.y)*t}:function(p){p.x=(p.x-f)/(h-f)*r,p.y=(1-(a.y?p.y/a.y:1))*t})}return i.separation=function(a){return arguments.length?(e=a,i):e},i.size=function(a){return arguments.length?(n=!1,r=+a[0],t=+a[1],i):n?null:[r,t]},i.nodeSize=function(a){return arguments.length?(n=!0,r=+a[0],t=+a[1],i):n?[r,t]:null},i}function _Re(e){var r=0,t=e.children,n=t&&t.length;if(!n)r=1;else for(;--n>=0;)r+=t[n].value;e.value=r}function xRe(){return this.eachAfter(_Re)}function bRe(e,r){let t=-1;for(const n of this)e.call(r,n,++t,this);return this}function wRe(e,r){for(var t=this,n=[t],i,a,o=-1;t=n.pop();)if(e.call(r,t,++o,this),i=t.children)for(a=i.length-1;a>=0;--a)n.push(i[a]);return this}function CRe(e,r){for(var t=this,n=[t],i=[],a,o,s,u=-1;t=n.pop();)if(i.push(t),a=t.children)for(o=0,s=a.length;o<s;++o)n.push(a[o]);for(;t=i.pop();)e.call(r,t,++u,this);return this}function ERe(e,r){let t=-1;for(const n of this)if(e.call(r,n,++t,this))return n}function SRe(e){return this.eachAfter(function(r){for(var t=+e(r.data)||0,n=r.children,i=n&&n.length;--i>=0;)t+=n[i].value;r.value=t})}function ARe(e){return this.eachBefore(function(r){r.children&&r.children.sort(e)})}function TRe(e){for(var r=this,t=MRe(r,e),n=[r];r!==t;)r=r.parent,n.push(r);for(var i=n.length;e!==t;)n.splice(i,0,e),e=e.parent;return n}function MRe(e,r){if(e===r)return e;var t=e.ancestors(),n=r.ancestors(),i=null;for(e=t.pop(),r=n.pop();e===r;)i=e,e=t.pop(),r=n.pop();return i}function LRe(){for(var e=this,r=[e];e=e.parent;)r.push(e);return r}function IRe(){return Array.from(this)}function kRe(){var e=[];return this.eachBefore(function(r){r.children||e.push(r)}),e}function PRe(){var e=this,r=[];return e.each(function(t){t!==e&&r.push({source:t.parent,target:t})}),r}function*RRe(){var e=this,r,t=[e],n,i,a;do for(r=t.reverse(),t=[];e=r.pop();)if(yield e,n=e.children)for(i=0,a=n.length;i<a;++i)t.push(n[i]);while(t.length)}function X2(e,r){e instanceof Map?(e=[void 0,e],r===void 0&&(r=DRe)):r===void 0&&(r=FRe);for(var t=new b2(e),n,i=[t],a,o,s,u;n=i.pop();)if((o=r(n.data))&&(u=(o=Array.from(o)).length))for(n.children=o,s=u-1;s>=0;--s)i.push(a=o[s]=new b2(o[s])),a.parent=n,a.depth=n.depth+1;return t.eachBefore(rte)}function ORe(){return X2(this).eachBefore(BRe)}function FRe(e){return e.children}function DRe(e){return Array.isArray(e)?e[1]:null}function BRe(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function rte(e){var r=0;do e.height=r;while((e=e.parent)&&e.height<++r)}function b2(e){this.data=e,this.depth=this.height=0,this.parent=null}b2.prototype=X2.prototype={constructor:b2,count:xRe,each:bRe,eachAfter:CRe,eachBefore:wRe,find:ERe,sum:SRe,sort:ARe,path:TRe,ancestors:LRe,descendants:IRe,leaves:kRe,links:PRe,copy:ORe,[Symbol.iterator]:RRe};function NRe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function zRe(e){for(var r=e.length,t,n;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}function nte(e){for(var r=0,t=(e=zRe(Array.from(e))).length,n=[],i,a;r<t;)i=e[r],a&&ite(a,i)?++r:(a=URe(n=$Re(n,i)),r=0);return a}function $Re(e,r){var t,n;if(zR(r,e))return[r];for(t=0;t<e.length;++t)if(tT(r,e[t])&&zR(CC(e[t],r),e))return[e[t],r];for(t=0;t<e.length-1;++t)for(n=t+1;n<e.length;++n)if(tT(CC(e[t],e[n]),r)&&tT(CC(e[t],r),e[n])&&tT(CC(e[n],r),e[t])&&zR(ate(e[t],e[n],r),e))return[e[t],e[n],r];throw new Error}function tT(e,r){var t=e.r-r.r,n=r.x-e.x,i=r.y-e.y;return t<0||t*t<n*n+i*i}function ite(e,r){var t=e.r-r.r+Math.max(e.r,r.r,1)*1e-9,n=r.x-e.x,i=r.y-e.y;return t>0&&t*t>n*n+i*i}function zR(e,r){for(var t=0;t<r.length;++t)if(!ite(e,r[t]))return!1;return!0}function URe(e){switch(e.length){case 1:return VRe(e[0]);case 2:return CC(e[0],e[1]);case 3:return ate(e[0],e[1],e[2])}}function VRe(e){return{x:e.x,y:e.y,r:e.r}}function CC(e,r){var t=e.x,n=e.y,i=e.r,a=r.x,o=r.y,s=r.r,u=a-t,l=o-n,f=s-i,h=Math.sqrt(u*u+l*l);return{x:(t+a+u/h*f)/2,y:(n+o+l/h*f)/2,r:(h+i+s)/2}}function ate(e,r,t){var n=e.x,i=e.y,a=e.r,o=r.x,s=r.y,u=r.r,l=t.x,f=t.y,h=t.r,p=n-o,v=n-l,m=i-s,x=i-f,E=u-a,A=h-a,L=n*n+i*i-a*a,k=L-o*o-s*s+u*u,R=L-l*l-f*f+h*h,D=v*m-p*x,$=(m*R-x*k)/(D*2)-n,j=(x*E-m*A)/D,H=(v*k-p*R)/(D*2)-i,ee=(p*A-v*E)/D,U=j*j+ee*ee-1,W=2*(a+$*j+H*ee),Q=$*$+H*H-a*a,te=-(U?(W+Math.sqrt(W*W-4*U*Q))/(2*U):Q/W);return{x:n+$+j*te,y:i+H+ee*te,r:te}}function F9(e,r,t){var n=e.x-r.x,i,a,o=e.y-r.y,s,u,l=n*n+o*o;l?(a=r.r+t.r,a*=a,u=e.r+t.r,u*=u,a>u?(i=(l+u-a)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),t.x=e.x-i*n-s*o,t.y=e.y-i*o+s*n):(i=(l+a-u)/(2*l),s=Math.sqrt(Math.max(0,a/l-i*i)),t.x=r.x+i*n-s*o,t.y=r.y+i*o+s*n)):(t.x=r.x+t.r,t.y=r.y)}function D9(e,r){var t=e.r+r.r-1e-6,n=r.x-e.x,i=r.y-e.y;return t>0&&t*t>n*n+i*i}function B9(e){var r=e._,t=e.next._,n=r.r+t.r,i=(r.x*t.r+t.x*r.r)/n,a=(r.y*t.r+t.y*r.r)/n;return i*i+a*a}function rT(e){this._=e,this.next=null,this.previous=null}function ote(e){if(!(i=(e=NRe(e)).length))return 0;var r,t,n,i,a,o,s,u,l,f,h;if(r=e[0],r.x=0,r.y=0,!(i>1))return r.r;if(t=e[1],r.x=-t.r,t.x=r.r,t.y=0,!(i>2))return r.r+t.r;F9(t,r,n=e[2]),r=new rT(r),t=new rT(t),n=new rT(n),r.next=n.previous=t,t.next=r.previous=n,n.next=t.previous=r;e:for(s=3;s<i;++s){F9(r._,t._,n=e[s]),n=new rT(n),u=t.next,l=r.previous,f=t._.r,h=r._.r;do if(f<=h){if(D9(u._,n._)){t=u,r.next=t,t.previous=r,--s;continue e}f+=u._.r,u=u.next}else{if(D9(l._,n._)){r=l,r.next=t,t.previous=r,--s;continue e}h+=l._.r,l=l.previous}while(u!==l.next);for(n.previous=r,n.next=t,r.next=t.previous=t=n,a=B9(r);(n=n.next)!==t;)(o=B9(n))<a&&(r=n,a=o);t=r.next}for(r=[t._],n=t;(n=n.next)!==t;)r.push(n._);for(n=nte(r),s=0;s<i;++s)r=e[s],r.x-=n.x,r.y-=n.y;return n.r}function GRe(e){return ote(e),e}function HRe(e){return e==null?null:eL(e)}function eL(e){if(typeof e!="function")throw new Error;return e}function Ax(){return 0}function Fb(e){return function(){return e}}function jRe(e){return Math.sqrt(e.value)}function ste(){var e=null,r=1,t=1,n=Ax;function i(a){return a.x=r/2,a.y=t/2,e?a.eachBefore(N9(e)).eachAfter($R(n,.5)).eachBefore(z9(1)):a.eachBefore(N9(jRe)).eachAfter($R(Ax,1)).eachAfter($R(n,a.r/Math.min(r,t))).eachBefore(z9(Math.min(r,t)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(e=HRe(a),i):e},i.size=function(a){return arguments.length?(r=+a[0],t=+a[1],i):[r,t]},i.padding=function(a){return arguments.length?(n=typeof a=="function"?a:Fb(+a),i):n},i}function N9(e){return function(r){r.children||(r.r=Math.max(0,+e(r)||0))}}function $R(e,r){return function(t){if(n=t.children){var n,i,a=n.length,o=e(t)*r||0,s;if(o)for(i=0;i<a;++i)n[i].r+=o;if(s=ote(n),o)for(i=0;i<a;++i)n[i].r-=o;t.r=s+o}}}function z9(e){return function(r){var t=r.parent;r.r*=e,t&&(r.x=t.x+e*r.x,r.y=t.y+e*r.y)}}function ute(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function ES(e,r,t,n,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(n-r)/e.value;++s<u;)o=a[s],o.y0=t,o.y1=i,o.x0=r,o.x1=r+=o.value*l}function lte(){var e=1,r=1,t=0,n=!1;function i(o){var s=o.height+1;return o.x0=o.y0=t,o.x1=e,o.y1=r/s,o.eachBefore(a(r,s)),n&&o.eachBefore(ute),o}function a(o,s){return function(u){u.children&&ES(u,u.x0,o*(u.depth+1)/s,u.x1,o*(u.depth+2)/s);var l=u.x0,f=u.y0,h=u.x1-t,p=u.y1-t;h<l&&(l=h=(l+h)/2),p<f&&(f=p=(f+p)/2),u.x0=l,u.y0=f,u.x1=h,u.y1=p}}return i.round=function(o){return arguments.length?(n=!!o,i):n},i.size=function(o){return arguments.length?(e=+o[0],r=+o[1],i):[e,r]},i.padding=function(o){return arguments.length?(t=+o,i):t},i}var WRe={depth:-1},$9={};function XRe(e){return e.id}function YRe(e){return e.parentId}function ZRe(){var e=XRe,r=YRe;function t(n){var i=Array.from(n),a=i.length,o,s,u,l,f,h,p,v=new Map;for(s=0;s<a;++s)o=i[s],f=i[s]=new b2(o),(h=e(o,s,n))!=null&&(h+="")&&(p=f.id=h,v.set(p,v.has(p)?$9:f)),(h=r(o,s,n))!=null&&(h+="")&&(f.parent=h);for(s=0;s<a;++s)if(f=i[s],h=f.parent){if(l=v.get(h),!l)throw new Error("missing: "+h);if(l===$9)throw new Error("ambiguous: "+h);l.children?l.children.push(f):l.children=[f],f.parent=l}else{if(u)throw new Error("multiple roots");u=f}if(!u)throw new Error("no root");if(u.parent=WRe,u.eachBefore(function(m){m.depth=m.parent.depth+1,--a}).eachBefore(rte),u.parent=null,a>0)throw new Error("cycle");return u}return t.id=function(n){return arguments.length?(e=eL(n),t):e},t.parentId=function(n){return arguments.length?(r=eL(n),t):r},t}function qRe(e,r){return e.parent===r.parent?1:2}function UR(e){var r=e.children;return r?r[0]:e.t}function VR(e){var r=e.children;return r?r[r.length-1]:e.t}function KRe(e,r,t){var n=t/(r.i-e.i);r.c-=n,r.s+=t,e.c+=n,r.z+=t,r.m+=t}function QRe(e){for(var r=0,t=0,n=e.children,i=n.length,a;--i>=0;)a=n[i],a.z+=r,a.m+=r,r+=a.s+(t+=a.c)}function JRe(e,r,t){return e.a.parent===r.parent?e.a:t}function oM(e,r){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=r}oM.prototype=Object.create(b2.prototype);function eOe(e){for(var r=new oM(e,0),t,n=[r],i,a,o,s;t=n.pop();)if(a=t._.children)for(t.children=new Array(s=a.length),o=s-1;o>=0;--o)n.push(i=t.children[o]=new oM(a[o],o)),i.parent=t;return(r.parent=new oM(null,0)).children=[r],r}function tOe(){var e=qRe,r=1,t=1,n=null;function i(l){var f=eOe(l);if(f.eachAfter(a),f.parent.m=-f.z,f.eachBefore(o),n)l.eachBefore(u);else{var h=l,p=l,v=l;l.eachBefore(function(L){L.x<h.x&&(h=L),L.x>p.x&&(p=L),L.depth>v.depth&&(v=L)});var m=h===p?1:e(h,p)/2,x=m-h.x,E=r/(p.x+m+x),A=t/(v.depth||1);l.eachBefore(function(L){L.x=(L.x+x)*E,L.y=L.depth*A})}return l}function a(l){var f=l.children,h=l.parent.children,p=l.i?h[l.i-1]:null;if(f){QRe(l);var v=(f[0].z+f[f.length-1].z)/2;p?(l.z=p.z+e(l._,p._),l.m=l.z-v):l.z=v}else p&&(l.z=p.z+e(l._,p._));l.parent.A=s(l,p,l.parent.A||h[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,f,h){if(f){for(var p=l,v=l,m=f,x=p.parent.children[0],E=p.m,A=v.m,L=m.m,k=x.m,R;m=VR(m),p=UR(p),m&&p;)x=UR(x),v=VR(v),v.a=l,R=m.z+L-p.z-E+e(m._,p._),R>0&&(KRe(JRe(m,l,h),l,R),E+=R,A+=R),L+=m.m,E+=p.m,k+=x.m,A+=v.m;m&&!VR(v)&&(v.t=m,v.m+=L-A),p&&!UR(x)&&(x.t=p,x.m+=E-k,h=l)}return h}function u(l){l.x*=r,l.y=l.depth*t}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(n=!1,r=+l[0],t=+l[1],i):n?null:[r,t]},i.nodeSize=function(l){return arguments.length?(n=!0,r=+l[0],t=+l[1],i):n?[r,t]:null},i}function KI(e,r,t,n,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(i-t)/e.value;++s<u;)o=a[s],o.x0=r,o.x1=n,o.y0=t,o.y1=t+=o.value*l}var cte=(1+Math.sqrt(5))/2;function fte(e,r,t,n,i,a){for(var o=[],s=r.children,u,l,f=0,h=0,p=s.length,v,m,x=r.value,E,A,L,k,R,D,$;f<p;){v=i-t,m=a-n;do E=s[h++].value;while(!E&&h<p);for(A=L=E,D=Math.max(m/v,v/m)/(x*e),$=E*E*D,R=Math.max(L/$,$/A);h<p;++h){if(E+=l=s[h].value,l<A&&(A=l),l>L&&(L=l),$=E*E*D,k=Math.max(L/$,$/A),k>R){E-=l;break}R=k}o.push(u={value:E,dice:v<m,children:s.slice(f,h)}),u.dice?ES(u,t,n,i,x?n+=m*E/x:a):KI(u,t,n,x?t+=v*E/x:i,a),x-=E,f=h}return o}var hte=function e(r){function t(n,i,a,o,s){fte(r,n,i,a,o,s)}return t.ratio=function(n){return e((n=+n)>1?n:1)},t}(cte);function pte(){var e=hte,r=!1,t=1,n=1,i=[0],a=Ax,o=Ax,s=Ax,u=Ax,l=Ax;function f(p){return p.x0=p.y0=0,p.x1=t,p.y1=n,p.eachBefore(h),i=[0],r&&p.eachBefore(ute),p}function h(p){var v=i[p.depth],m=p.x0+v,x=p.y0+v,E=p.x1-v,A=p.y1-v;E<m&&(m=E=(m+E)/2),A<x&&(x=A=(x+A)/2),p.x0=m,p.y0=x,p.x1=E,p.y1=A,p.children&&(v=i[p.depth+1]=a(p)/2,m+=l(p)-v,x+=o(p)-v,E-=s(p)-v,A-=u(p)-v,E<m&&(m=E=(m+E)/2),A<x&&(x=A=(x+A)/2),e(p,m,x,E,A))}return f.round=function(p){return arguments.length?(r=!!p,f):r},f.size=function(p){return arguments.length?(t=+p[0],n=+p[1],f):[t,n]},f.tile=function(p){return arguments.length?(e=eL(p),f):e},f.padding=function(p){return arguments.length?f.paddingInner(p).paddingOuter(p):f.paddingInner()},f.paddingInner=function(p){return arguments.length?(a=typeof p=="function"?p:Fb(+p),f):a},f.paddingOuter=function(p){return arguments.length?f.paddingTop(p).paddingRight(p).paddingBottom(p).paddingLeft(p):f.paddingTop()},f.paddingTop=function(p){return arguments.length?(o=typeof p=="function"?p:Fb(+p),f):o},f.paddingRight=function(p){return arguments.length?(s=typeof p=="function"?p:Fb(+p),f):s},f.paddingBottom=function(p){return arguments.length?(u=typeof p=="function"?p:Fb(+p),f):u},f.paddingLeft=function(p){return arguments.length?(l=typeof p=="function"?p:Fb(+p),f):l},f}function rOe(e,r,t,n,i){var a=e.children,o,s=a.length,u,l=new Array(s+1);for(l[0]=u=o=0;o<s;++o)l[o+1]=u+=a[o].value;f(0,s,e.value,r,t,n,i);function f(h,p,v,m,x,E,A){if(h>=p-1){var L=a[h];L.x0=m,L.y0=x,L.x1=E,L.y1=A;return}for(var k=l[h],R=v/2+k,D=h+1,$=p-1;D<$;){var j=D+$>>>1;l[j]<R?D=j+1:$=j}R-l[D-1]<l[D]-R&&h+1<D&&--D;var H=l[D]-k,ee=v-H;if(E-m>A-x){var U=v?(m*ee+E*H)/v:E;f(h,D,H,m,x,U,A),f(D,p,ee,U,x,E,A)}else{var W=v?(x*ee+A*H)/v:A;f(h,D,H,m,x,E,W),f(D,p,ee,m,W,E,A)}}}function nOe(e,r,t,n,i){(e.depth&1?KI:ES)(e,r,t,n,i)}var iOe=function e(r){function t(n,i,a,o,s){if((u=n._squarify)&&u.ratio===r)for(var u,l,f,h,p=-1,v,m=u.length,x=n.value;++p<m;){for(l=u[p],f=l.children,h=l.value=0,v=f.length;h<v;++h)l.value+=f[h].value;l.dice?ES(l,i,a,o,x?a+=(s-a)*l.value/x:s):KI(l,i,a,x?i+=(o-i)*l.value/x:o,s),x-=l.value}else n._squarify=u=fte(r,n,i,a,o,s),u.ratio=r}return t.ratio=function(n){return e((n=+n)>1?n:1)},t}(cte),U9=Object.freeze(Object.defineProperty({__proto__:null,cluster:yRe,hierarchy:X2,pack:ste,packSiblings:GRe,packEnclose:nte,partition:lte,stratify:ZRe,tree:tOe,treemap:pte,treemapBinary:rOe,treemapDice:ES,treemapSlice:KI,treemapSliceDice:nOe,treemapSquarify:hte,treemapResquarify:iOe},Symbol.toStringTag,{value:"Module"})),aOe={field:"value",size:[1,1],round:!1,padding:0,sort:function(e,r){return r.value-e.value},as:["x","y"],ignoreParentValue:!0};function oOe(e,r){r=Na({},aOe,r);var t=r.as;if(!ar(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var n;try{n=sB(r)}catch(u){console.warn(u)}var i=function(u){return lte().size(r.size).round(r.round).padding(r.padding)(X2(u).sum(function(l){return zl(l.children)?r.ignoreParentValue?0:l[n]-cf(l.children,function(f,h){return f+h[n]},0):l[n]}).sort(r.sort))},a=i(e),o=t[0],s=t[1];return a.each(function(u){var l,f;u[o]=[u.x0,u.x1,u.x1,u.x0],u[s]=[u.y1,u.y1,u.y0,u.y0],u.name=u.name||((l=u.data)===null||l===void 0?void 0:l.name)||((f=u.data)===null||f===void 0?void 0:f.label),u.data.name=u.name,["x0","x1","y0","y1"].forEach(function(h){t.indexOf(h)===-1&&delete u[h]})}),uB(a)}var sOe={field:"value",tile:"treemapSquarify",size:[1,1],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,as:["x","y"],sort:function(e,r){return r.value-e.value},ratio:.5*(1+Math.sqrt(5))};function uOe(e,r){return e==="treemapSquarify"?U9[e].ratio(r):U9[e]}function dte(e,r){r=Na({},sOe,r);var t=r.as;if(!ar(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var n;try{n=sB(r)}catch(l){console.warn(l)}var i=uOe(r.tile,r.ratio),a=function(l){return pte().tile(i).size(r.size).round(r.round).padding(r.padding).paddingInner(r.paddingInner).paddingOuter(r.paddingOuter).paddingTop(r.paddingTop).paddingRight(r.paddingRight).paddingBottom(r.paddingBottom).paddingLeft(r.paddingLeft)(X2(l).sum(function(f){return r.ignoreParentValue&&f.children?0:f[n]}).sort(r.sort))},o=a(e),s=t[0],u=t[1];return o.each(function(l){l[s]=[l.x0,l.x1,l.x1,l.x0],l[u]=[l.y1,l.y1,l.y0,l.y0],["x0","x1","y0","y1"].forEach(function(f){t.indexOf(f)===-1&&delete l[f]})}),uB(o)}function vte(e){var r=e.data,t=e.colorField,n=e.rawFields,i=e.hierarchyConfig,a=i===void 0?{}:i,o=a.activeDepth,s={partition:oOe,treemap:dte},u=e.seriesField,l=e.type||"partition",f=s[l](r,nt(nt({field:u||"value"},cS(a,["activeDepth"])),{type:"hierarchy."+l,as:["x","y"]})),h=[];return f.forEach(function(p){var v,m,x,E,A,L;if(p.depth===0||o>0&&p.depth>o)return null;for(var k=p.data.name,R=nt({},p);R.depth>1;)k=((m=R.parent.data)===null||m===void 0?void 0:m.name)+" / "+k,R=R.parent;var D=nt(nt(nt({},Ao(p.data,nu(n||[],[a.field]))),(v={},v[SE]=k,v[lB]=R.data.name,v)),p);u&&(D[u]=p.data[u]||((E=(x=p.parent)===null||x===void 0?void 0:x.data)===null||E===void 0?void 0:E[u])),t&&(D[t]=p.data[t]||((L=(A=p.parent)===null||A===void 0?void 0:A.data)===null||L===void 0?void 0:L[t])),D.ext=a,D[AE]={hierarchyConfig:a,colorField:t,rawFields:n},h.push(D)}),h}function lOe(e){var r=e.chart,t=e.options,n=t.color,i=t.colorField,a=i===void 0?lB:i,o=t.sunburstStyle,s=t.rawFields,u=s===void 0?[]:s,l=vte(t);r.data(l);var f;return o&&(f=function(h){return Dt({},{fillOpacity:Math.pow(.85,h.depth)},kn(o)?o(h):o)}),WI(Dt({},e,{options:{xField:"x",yField:"y",seriesField:a,rawFields:Z0(nu(oRe,u)),polygon:{color:n,style:f}}})),e}function cOe(e){var r=e.chart;return r.axis(!1),e}function fOe(e){var r=e.chart,t=e.options,n=t.label,i=hf(r,"polygon");if(!n)i.label(!1);else{var a=n.fields,o=a===void 0?["name"]:a,s=n.callback,u=fh(n,["fields","callback"]);i.label({fields:o,callback:s,cfg:uc(u)})}return e}function hOe(e){var r=e.chart,t=e.options,n=t.innerRadius,i=t.radius,a=t.reflect,o=r.coordinate({type:"polar",cfg:{innerRadius:n,radius:i}});return a&&o.reflect(a),e}function pOe(e){var r,t=e.options,n=t.hierarchyConfig,i=t.meta;return Ei(ku({},(r={},r[tte]=Ie(i,Ie(n,["field"],"value")),r)))(e)}function dOe(e){var r=e.chart,t=e.options,n=t.tooltip;if(n===!1)r.tooltip(!1);else{var i=n;Ie(n,"fields")||(i=Dt({},{customItems:function(a){return a.map(function(o){var s=Ie(r.getOptions(),"scales"),u=Ie(s,[SE,"formatter"],function(f){return f}),l=Ie(s,[tte,"formatter"],function(f){return f});return nt(nt({},o),{name:u(o.data[SE]),value:l(o.data.value)})})}},i)),r.tooltip(i)}return e}function vOe(e){var r=e.drilldown,t=e.interactions,n=t===void 0?[]:t;return r!=null&&r.enabled?Dt({},e,{interactions:nu(n,[{type:"drill-down",cfg:{drillDownConfig:r,transformData:vte}}])}):e}function gOe(e){var r=e.chart,t=e.options,n=t.drilldown;return ks({chart:r,options:vOe(t)}),n!=null&&n.enabled&&(r.appendPadding=zI(r.appendPadding,Ie(n,["breadCrumb","position"]))),e}function mOe(e){return Ei(Xa,nd("sunburstStyle"),lOe,cOe,pOe,G2,hOe,dOe,fOe,gOe,Po,mu())(e)}function V9(e){var r=Ie(e,["event","data","data"],{});return ar(r.children)&&r.children.length>0}function G9(e){var r=e.view.getCoordinate(),t=r.innerRadius;if(t){var n=e.event,i=n.x,a=n.y,o=r.center,s=o.x,u=o.y,l=r.getRadius()*t,f=Math.sqrt(Math.pow(s-i,2)+Math.pow(u-a,2));return f<l}return!1}hi("drill-down-action",cRe);$i("drill-down",{showEnable:[{trigger:"element:mouseenter",action:"cursor:pointer",isEnable:V9},{trigger:"element:mouseleave",action:"cursor:default"},{trigger:"element:mouseleave",action:"cursor:pointer",isEnable:G9}],start:[{trigger:"element:click",isEnable:V9,action:["drill-down-action:click"]},{trigger:"afterchangesize",action:["drill-down-action:resetPosition"]},{trigger:"click",isEnable:G9,action:["drill-down-action:back"]}]});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="sunburst",t}return r.getDefaultOptions=function(){return sRe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return mOe},r.SUNBURST_ANCESTOR_FIELD=lB,r.SUNBURST_PATH_FIELD=SE,r.NODE_ANCESTORS_FIELD=oB,r})(Ui);var nT,tL="range",gte="type",oy="percent",yOe="#f0f0f0",mte="indicator-view",yte="range-view",_Oe={percent:0,range:{ticks:[]},innerRadius:.9,radius:.95,startAngle:-7/6*Math.PI,endAngle:1/6*Math.PI,syncViewPadding:!0,axis:{line:null,label:{offset:-24,style:{textAlign:"center",textBaseline:"middle"}},subTickLine:{length:-8},tickLine:{length:-12},grid:null},indicator:{pointer:{style:{lineWidth:5,lineCap:"round"}},pin:{style:{r:9.75,lineWidth:4.5,fill:"#fff"}}},statistic:{title:!1},meta:(nT={},nT[tL]={sync:"v"},nT[oy]={sync:"v",tickCount:5,tickInterval:.2},nT),animation:!1};function xOe(e,r){return e.map(function(t,n){var i;return i={},i[tL]=t-(e[n-1]||0),i[gte]=""+n,i[oy]=r,i}).filter(function(t){return!!t[tL]})}function _te(e){var r;return[(r={},r[oy]=_s(e,0,1),r)]}function xte(e,r){var t=Ie(r,["ticks"],[]),n=zl(t)?t:[0,_s(e,0,1),1];return xOe(n,e)}function bOe(e){var r=e.chart,t=e.options,n=t.percent,i=t.range,a=t.radius,o=t.innerRadius,s=t.startAngle,u=t.endAngle,l=t.axis,f=t.indicator,h=t.gaugeStyle,p=t.type,v=t.meter,m=i.color,x=i.width;if(f){var E=_te(n),A=r.createView({id:mte});A.data(E),A.point().position(oy+"*1").shape(f.shape||"gauge-indicator").customInfo({defaultColor:r.getTheme().defaultColor,indicator:f}),A.coordinate("polar",{startAngle:s,endAngle:u,radius:o*a}),A.axis(oy,l),A.scale(oy,Ao(l,sp))}var L=xte(n,t.range),k=r.createView({id:yte});k.data(L);var R=ei(m)?[m,yOe]:m,D=pf({chart:k,options:{xField:"1",yField:tL,seriesField:gte,rawFields:[oy],isStack:!0,interval:{color:R,style:h,shape:p==="meter"?"meter-gauge":null},args:{zIndexReversed:!0,sortZIndex:!0},minColumnWidth:x,maxColumnWidth:x}}).ext,$=D.geometry;return $.customInfo({meter:v}),k.coordinate("polar",{innerRadius:o,radius:a,startAngle:s,endAngle:u}).transpose(),e}function wOe(e){var r;return Ei(ku((r={range:{min:0,max:1,maxLimit:1,minLimit:0}},r[oy]={},r)))(e)}function bte(e,r){var t=e.chart,n=e.options,i=n.statistic,a=n.percent;if(t.getController("annotation").clear(!0),i){var o=i.content,s=void 0;o&&(s=Dt({},{content:(a*100).toFixed(2)+"%",style:{opacity:.75,fontSize:"30px",lineHeight:1,textAlign:"center",color:"rgba(44,53,66,0.85)"}},o)),ZAe(t,{statistic:nt(nt({},i),{content:s})},{percent:a})}return r&&t.render(!0),e}function COe(e){var r=e.chart,t=e.options,n=t.tooltip;return n?r.tooltip(Dt({showTitle:!1,showMarkers:!1,containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',domStyles:{"g2-tooltip":{padding:"4px 8px",fontSize:"10px"}},customContent:function(i,a){var o=Ie(a,[0,"data",oy],0);return(o*100).toFixed(2)+"%"}},n)):r.tooltip(!1),e}function EOe(e){var r=e.chart;return r.legend(!1),e}function wte(e){return Ei(Xa,Po,bOe,wOe,COe,bte,ks,mu(),EOe)(e)}lo("point","gauge-indicator",{draw:function(e,r){var t=e.customInfo,n=t.indicator,i=t.defaultColor,a=n,o=a.pointer,s=a.pin,u=r.addGroup(),l=this.parsePoint({x:0,y:0});return o&&u.addShape("line",{name:"pointer",attrs:nt({x1:l.x,y1:l.y,x2:e.x,y2:e.y,stroke:i},o.style)}),s&&u.addShape("circle",{name:"pin",attrs:nt({x:l.x,y:l.y,stroke:i},s.style)}),u}});lo("interval","meter-gauge",{draw:function(e,r){var t=e.customInfo.meter,n=t===void 0?{}:t,i=n.steps,a=i===void 0?50:i,o=n.stepRatio,s=o===void 0?.5:o;a=a<1?1:a,s=_s(s,0,1);var u=this.coordinate,l=u.startAngle,f=u.endAngle,h=0;if(s>0&&s<1){var p=f-l;h=p/a/(s/(1-s)+1-1/a)}for(var v=h/(1-s)*s,m=r.addGroup(),x=this.coordinate.getCenter(),E=this.coordinate.getRadius(),A=dp.getAngle(e,this.coordinate),L=A.startAngle,k=A.endAngle,R=L;R<k;){var D=void 0,$=(R-l)%(v+h);$<v?D=R+(v-$):(R+=v+h-$,D=R+v);var j=dp.getSectorPath(x.x,x.y,E,R,Math.min(D,k),E*this.coordinate.innerRadius);m.addShape("path",{name:"meter-gauge",attrs:{path:j,fill:e.color,stroke:e.color,lineWidth:.5}}),R=D+h}return m}});var Cte=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="gauge",t}return r.getDefaultOptions=function(){return _Oe},r.prototype.changeData=function(t){this.chart.emit(ra.BEFORE_CHANGE_DATA,ru.fromData(this.chart,ra.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t});var n=this.chart.views.find(function(a){return a.id===mte});n&&n.data(_te(t));var i=this.chart.views.find(function(a){return a.id===yte});i&&i.data(xte(t,this.options.range)),bte({chart:this.chart,options:this.options},!0),this.chart.emit(ra.AFTER_CHANGE_DATA,ru.fromData(this.chart,ra.AFTER_CHANGE_DATA,null))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return wte},r}(Ui),Nd="$$yField$$",QI="$$diffField$$",cB="$$absoluteField$$",D5="$$isTotal$$",SOe={label:{},leaderLine:{style:{lineWidth:1,stroke:"#8c8c8c",lineDash:[4,2]}},total:{style:{fill:"rgba(0, 0, 0, 0.25)"}},interactions:[{type:"element-active"}],risingFill:"#f4664a",fallingFill:"#30bf78",waterfallStyle:{fill:"rgba(0, 0, 0, 0.25)"},yAxis:{grid:{line:{style:{lineDash:[4,2]}}}}};function AOe(e,r,t,n,i){var a,o=[];if(cf(e,function(u,l){var f;Cy(Kv.WARN,xi(l[t]),l[t]+" is not a valid number");var h=R0(l[t])?null:l[t];return o.push(nt(nt({},l),(f={},f[n]=[u,u+h],f))),u+h},0),o.length&&i){var s=Ie(o,[[e.length-1],n,[1]]);o.push((a={},a[r]=i.label,a[t]=s,a[n]=[0,s],a))}return o}function Ete(e,r,t,n){var i=AOe(e,r,t,Nd,n);return i.map(function(a,o){var s;return xo(a)?nt(nt({},a),(s={},s[cB]=a[Nd][1],s[QI]=a[Nd][1]-a[Nd][0],s[D5]=o===e.length,s)):a})}function TOe(e){for(var r=[],t=0;t<e.length;t++){var n=e[t];if(n){var i=t===0?"M":"L";r.push([i,n.x,n.y])}}var a=e[0];return r.push(["L",a.x,a.y]),r.push(["z"]),r}function MOe(e){return Dt({},e.defaultStyle,e.style,{fill:e.color})}lo("interval","waterfall",{draw:function(e,r){var t=e.customInfo,n=e.points,i=e.nextPoints,a=r.addGroup(),o=this.parsePath(TOe(n)),s=MOe(e);a.addShape("path",{attrs:nt(nt({},s),{path:o})});var u=Ie(t,"leaderLine");if(u&&i){var l=[["M",n[2].x,n[2].y],["L",i[0].x,i[0].y]];n[2].y===i[1].y&&(l[1]=["L",i[1].x,i[1].y]),l=this.parsePath(l),a.addShape("path",{attrs:nt({path:l},u.style||{})})}return a}});function LOe(e){var r=e.options,t=r.locale,n=r.total,i=$I(t).get(["waterfall","total"]);return n&&typeof n.label!="string"&&i&&(e.options.total.label=i),e}function IOe(e){var r=e.chart,t=e.options,n=t.data,i=t.xField,a=t.yField,o=t.total,s=t.leaderLine,u=t.columnWidthRatio,l=t.waterfallStyle,f=t.risingFill,h=t.fallingFill,p=t.color;r.data(Ete(n,i,a,o));var v=p||function(A){return Ie(A,[D5])?Ie(o,["style","fill"],""):Ie(A,[Nd,1])-Ie(A,[Nd,0])>0?f:h},m=Dt({},e,{options:{xField:i,yField:Nd,seriesField:i,rawFields:[a,QI,D5,Nd],widthRatio:u,interval:{style:l,shape:"waterfall",color:v}}}),x=pf(m).ext,E=x.geometry;return E.customInfo({leaderLine:s}),e}function kOe(e){var r,t,n=e.options,i=n.xAxis,a=n.yAxis,o=n.xField,s=n.yField,u=n.meta,l=Dt({},{alias:s},Ie(u,s));return Ei(ku((r={},r[o]=i,r[s]=a,r[Nd]=a,r),Dt({},u,(t={},t[Nd]=l,t[QI]=l,t[cB]=l,t))))(e)}function POe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField;return n===!1?r.axis(a,!1):r.axis(a,n),i===!1?(r.axis(o,!1),r.axis(Nd,!1)):(r.axis(o,i),r.axis(Nd,i)),e}function ROe(e){var r=e.chart,t=e.options,n=t.legend,i=t.total,a=t.risingFill,o=t.fallingFill,s=t.locale,u=$I(s);if(n===!1)r.legend(!1);else{var l=[{name:u.get(["general","increase"]),value:"increase",marker:{symbol:"square",style:{r:5,fill:a}}},{name:u.get(["general","decrease"]),value:"decrease",marker:{symbol:"square",style:{r:5,fill:o}}}];i&&l.push({name:i.label||"",value:"total",marker:{symbol:"square",style:Dt({},{r:5},Ie(i,"style"))}}),r.legend(Dt({},{custom:!0,position:"top",items:l},n)),r.removeInteraction("legend-filter")}return e}function OOe(e){var r=e.chart,t=e.options,n=t.label,i=t.labelMode,a=t.xField,o=hf(r,"interval");if(!n)o.label(!1);else{var s=n.callback,u=fh(n,["callback"]);o.label({fields:i==="absolute"?[cB,a]:[QI,a],callback:s,cfg:uc(u)})}return e}function FOe(e){var r=e.chart,t=e.options,n=t.tooltip,i=t.xField,a=t.yField;if(n!==!1){r.tooltip(nt({showCrosshairs:!1,showMarkers:!1,shared:!0,fields:[a]},n));var o=r.geometries[0];n!=null&&n.formatter?o.tooltip(i+"*"+a,n.formatter):o.tooltip(a)}else r.tooltip(!1);return e}function DOe(e){return Ei(LOe,Xa,IOe,kOe,POe,ROe,FOe,OOe,b_,ks,Po,mu())(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="waterfall",t}return r.getDefaultOptions=function(){return SOe},r.prototype.changeData=function(t){var n=this.options,i=n.xField,a=n.yField,o=n.total;this.updateOption({data:t}),this.chart.changeData(Ete(t,i,a,o))},r.prototype.getSchemaAdaptor=function(){return DOe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r})(Ui);function BOe(e,r,t){var n=t.map(function(o){return o[r]}).filter(function(o){return o!==void 0}),i=n.length>0?Math.max.apply(Math,n):0,a=Math.abs(e)%360;return a?i*360/a:i}function NOe(e,r,t){var n=[];return e.forEach(function(i){var a=n.find(function(o){return o[r]===i[r]});a?a[t]+=i[t]||null:n.push(nt({},i))}),n}function zOe(e){var r=e.chart,t=e.options,n=t.barStyle,i=t.color,a=t.tooltip,o=t.colorField,s=t.type,u=t.xField,l=t.yField,f=t.data,h=m2(f,l);r.data(h);var p=Dt({},e,{options:{tooltip:a,seriesField:o,interval:{style:n,color:i,shape:s==="line"?"line":"intervel"},minColumnWidth:t.minBarWidth,maxColumnWidth:t.maxBarWidth,columnBackground:t.barBackground}});return pf(p),s==="line"&&id({chart:r,options:{xField:u,yField:l,seriesField:o,point:{shape:"circle",color:i}}}),e}function Ste(e){var r,t=e.options,n=t.yField,i=t.xField,a=t.data,o=t.isStack,s=t.isGroup,u=t.colorField,l=t.maxAngle,f=o&&!s&&u?NOe(a,i,n):a,h=m2(f,n);return Ei(ku((r={},r[n]={min:0,max:BOe(l,n,h)},r)))(e)}function $Oe(e){var r=e.chart,t=e.options,n=t.radius,i=t.innerRadius,a=t.startAngle,o=t.endAngle;return r.coordinate({type:"polar",cfg:{radius:n,innerRadius:i,startAngle:a,endAngle:o}}).transpose(),e}function UOe(e){var r=e.chart,t=e.options,n=t.xField,i=t.xAxis;return r.axis(n,i),e}function VOe(e){var r=e.chart,t=e.options,n=t.label,i=t.yField,a=hf(r,"interval");if(!n)a.label(!1);else{var o=n.callback,s=fh(n,["callback"]);a.label({fields:[i],callback:o,cfg:nt(nt({},uc(s)),{type:"polar"})})}return e}function GOe(e){return Ei(nd("barStyle"),zOe,Ste,UOe,$Oe,ks,Po,Xa,Ul,G2,mu(),VOe)(e)}var HOe=Dt({},Ui.getDefaultOptions(),{interactions:[{type:"element-active"}],legend:!1,tooltip:{showMarkers:!1},xAxis:{grid:null,tickLine:null,line:null},maxAngle:240});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="radial-bar",t}return r.getDefaultOptions=function(){return HOe},r.prototype.changeData=function(t){this.updateOption({data:t}),Ste({chart:this.chart,options:this.options}),this.chart.changeData(t)},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return GOe},r})(Ui);var Kg="first-axes-view",Qg="second-axes-view",Fx="series-field-key";function Ate(e,r,t,n,i){var a=[];r.forEach(function(h){n.forEach(function(p){var v,m=(v={},v[e]=p[e],v[t]=h,v[h]=p[h],v);a.push(m)})});var o=Object.values(lp(a,t)),s=o[0],u=s===void 0?[]:s,l=o[1],f=l===void 0?[]:l;return i?[u.reverse(),f.reverse()]:[u,f]}function sy(e){return e!=="vertical"}function jOe(e,r,t){var n=r[0],i=r[1],a=n.autoPadding,o=i.autoPadding,s=e.__axisPosition,u=s.layout,l=s.position;if(sy(u)&&l==="top"&&(n.autoPadding=t.instance(a.top,0,a.bottom,a.left),i.autoPadding=t.instance(o.top,a.left,o.bottom,0)),sy(u)&&l==="bottom"&&(n.autoPadding=t.instance(a.top,a.right/2+5,a.bottom,a.left),i.autoPadding=t.instance(o.top,o.right,o.bottom,a.right/2+5)),!sy(u)&&l==="bottom"){var f=a.left>=o.left?a.left:o.left;n.autoPadding=t.instance(a.top,a.right,a.bottom/2+5,f),i.autoPadding=t.instance(a.bottom/2+5,o.right,o.bottom,f)}if(!sy(u)&&l==="top"){var f=a.left>=o.left?a.left:o.left;n.autoPadding=t.instance(a.top,a.right,0,f),i.autoPadding=t.instance(0,o.right,a.top,f)}}function WOe(e){var r=e.chart,t=e.options,n=t.data,i=t.xField,a=t.yField,o=t.color,s=t.barStyle,u=t.widthRatio,l=t.legend,f=t.layout,h=Ate(i,a,Fx,n,sy(f));l?r.legend(Fx,l):l===!1&&r.legend(!1);var p,v,m=h[0],x=h[1];sy(f)?(p=r.createView({region:{start:{x:0,y:0},end:{x:.5,y:1}},id:Kg}),p.coordinate().transpose().reflect("x"),v=r.createView({region:{start:{x:.5,y:0},end:{x:1,y:1}},id:Qg}),v.coordinate().transpose(),p.data(m),v.data(x)):(p=r.createView({region:{start:{x:0,y:0},end:{x:1,y:.5}},id:Kg}),v=r.createView({region:{start:{x:0,y:.5},end:{x:1,y:1}},id:Qg}),v.coordinate().reflect("y"),p.data(m),v.data(x));var E=Dt({},e,{chart:p,options:{widthRatio:u,xField:i,yField:a[0],seriesField:Fx,interval:{color:o,style:s}}});pf(E);var A=Dt({},e,{chart:v,options:{xField:i,yField:a[1],seriesField:Fx,widthRatio:u,interval:{color:o,style:s}}});return pf(A),e}function XOe(e){var r,t,n,i=e.options,a=e.chart,o=i.xAxis,s=i.yAxis,u=i.xField,l=i.yField,f=aa(a,Kg),h=aa(a,Qg),p={};return p1((i==null?void 0:i.meta)||{}).map(function(v){Ie(i==null?void 0:i.meta,[v,"alias"])&&(p[v]=i.meta[v].alias)}),a.scale((r={},r[Fx]={sync:!0,formatter:function(v){return Ie(p,v,v)}},r)),ku((t={},t[u]=o,t[l[0]]=s[l[0]],t))(Dt({},e,{chart:f})),ku((n={},n[u]=o,n[l[1]]=s[l[1]],n))(Dt({},e,{chart:h})),e}function YOe(e){var r=e.chart,t=e.options,n=t.xAxis,i=t.yAxis,a=t.xField,o=t.yField,s=t.layout,u=aa(r,Kg),l=aa(r,Qg);return(n==null?void 0:n.position)==="bottom"?l.axis(a,nt(nt({},n),{label:{formatter:function(){return""}}})):l.axis(a,!1),n===!1?u.axis(a,!1):u.axis(a,nt({position:sy(s)?"top":"bottom"},n)),i===!1?(u.axis(o[0],!1),l.axis(o[1],!1)):(u.axis(o[0],i[o[0]]),l.axis(o[1],i[o[1]])),r.__axisPosition={position:u.getOptions().axes[a].position,layout:s},e}function ZOe(e){var r=e.chart;return ks(Dt({},e,{chart:aa(r,Kg)})),ks(Dt({},e,{chart:aa(r,Qg)})),e}function qOe(e){var r=e.chart,t=e.options,n=t.yField,i=t.yAxis;return t1(Dt({},e,{chart:aa(r,Kg),options:{yAxis:i[n[0]]}})),t1(Dt({},e,{chart:aa(r,Qg),options:{yAxis:i[n[1]]}})),e}function KOe(e){var r=e.chart;return Xa(Dt({},e,{chart:aa(r,Kg)})),Xa(Dt({},e,{chart:aa(r,Qg)})),Xa(e),e}function QOe(e){var r=e.chart;return Po(Dt({},e,{chart:aa(r,Kg)})),Po(Dt({},e,{chart:aa(r,Qg)})),e}function JOe(e){var r=this,t,n,i=e.chart,a=e.options,o=a.label,s=a.yField,u=a.layout,l=aa(i,Kg),f=aa(i,Qg),h=hf(l,"interval"),p=hf(f,"interval");if(!o)h.label(!1),p.label(!1);else{var v=o.callback,m=fh(o,["callback"]);m.position||(m.position="middle"),m.offset===void 0&&(m.offset=2);var x=nt({},m);if(sy(u)){var E=((t=x.style)===null||t===void 0?void 0:t.textAlign)||(m.position==="middle"?"center":"left");m.style=Dt({},m.style,{textAlign:E});var A={left:"right",right:"left",center:"center"};x.style=Dt({},x.style,{textAlign:A[E]})}else{var L={top:"bottom",bottom:"top",middle:"middle"};typeof m.position=="string"?m.position=L[m.position]:typeof m.position=="function"&&(m.position=function(){for(var D=[],$=0;$<arguments.length;$++)D[$]=arguments[$];return L[m.position.apply(r,D)]});var k=((n=x.style)===null||n===void 0?void 0:n.textBaseline)||"bottom";x.style=Dt({},x.style,{textBaseline:k});var R={top:"bottom",bottom:"top",middle:"middle"};m.style=Dt({},m.style,{textBaseline:R[k]})}h.label({fields:[s[0]],callback:v,cfg:uc(x)}),p.label({fields:[s[1]],callback:v,cfg:uc(m)})}return e}function eFe(e){return Ei(WOe,XOe,YOe,qOe,KOe,JOe,Ul,ZOe,QOe)(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="bidirectional-bar",t}return r.getDefaultOptions=function(){return Dt({},e.getDefaultOptions.call(this),{syncViewPadding:jOe})},r.prototype.changeData=function(t){t===void 0&&(t=[]),this.chart.emit(ra.BEFORE_CHANGE_DATA,ru.fromData(this.chart,ra.BEFORE_CHANGE_DATA,null)),this.updateOption({data:t});var n=this.options,i=n.xField,a=n.yField,o=n.layout,s=Ate(i,a,Fx,t,sy(o)),u=s[0],l=s[1],f=aa(this.chart,Kg),h=aa(this.chart,Qg);f.data(u),h.data(l),this.chart.render(!0),this.chart.emit(ra.AFTER_CHANGE_DATA,ru.fromData(this.chart,ra.AFTER_CHANGE_DATA,null))},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return eFe},r.SERIES_FIELD_KEY=Fx,r})(Ui);function Tte(e,r){if(!!ar(e))return e.find(function(t){return t.type===r})}function Mte(e,r){var t=Tte(e,r);return t&&t.enable!==!1}function fB(e){var r=e.interactions,t=e.drilldown;return Ie(t,"enabled")||Mte(r,"treemap-drill-down")}function tFe(e){var r=e.interactions["drill-down"];if(!!r){var t=r.context.actions.find(function(n){return n.name==="drill-down-action"});t.reset()}}function hB(e){var r=e.data,t=e.colorField,n=e.enableDrillDown,i=e.hierarchyConfig,a=dte(r,nt(nt({},i),{type:"hierarchy.treemap",field:"value",as:["x","y"]})),o=[];return a.forEach(function(s){if(s.depth===0||n&&s.depth!==1||!n&&s.children)return null;var u=s.ancestors().map(function(p){return{data:p.data,height:p.height,value:p.value}}),l=n&&ar(r.path)?u.concat(r.path.slice(1)):u,f=Object.assign({},s.data,nt({x:s.x,y:s.y,depth:s.depth,value:s.value,path:l},s));if(!s.data[t]&&s.parent){var h=s.ancestors().find(function(p){return p.data[t]});f[t]=h==null?void 0:h.data[t]}else f[t]=s.data[t];f[AE]={hierarchyConfig:i,colorField:t,enableDrillDown:n},o.push(f)}),o}function rFe(e){var r=e.options,t=r.colorField;return Dt({options:{rawFields:["value"],tooltip:{fields:["name","value",t,"path"],formatter:function(n){return{name:n.name,value:n.value}}}}},e)}function nFe(e){var r=e.chart,t=e.options,n=t.color,i=t.colorField,a=t.rectStyle,o=t.hierarchyConfig,s=t.rawFields,u=hB({data:t.data,colorField:t.colorField,enableDrillDown:fB(t),hierarchyConfig:o});return r.data(u),WI(Dt({},e,{options:{xField:"x",yField:"y",seriesField:i,rawFields:s,polygon:{color:n,style:a}}})),r.coordinate().reflect("y"),e}function iFe(e){var r=e.chart;return r.axis(!1),e}function aFe(e){var r=e.drilldown,t=e.interactions,n=t===void 0?[]:t,i=fB(e);return i?Dt({},e,{interactions:nu(n,[{type:"drill-down",cfg:{drillDownConfig:r,transformData:hB}}])}):e}function oFe(e){var r=e.chart,t=e.options,n=t.interactions,i=t.drilldown;ks({chart:r,options:aFe(t)});var a=Tte(n,"view-zoom");a&&(a.enable!==!1?r.getCanvas().on("mousewheel",function(s){s.preventDefault()}):r.getCanvas().off("mousewheel"));var o=fB(t);return o&&(r.appendPadding=zI(r.appendPadding,Ie(i,["breadCrumb","position"]))),e}function sFe(e){return Ei(rFe,Xa,nd("rectStyle"),nFe,iFe,G2,Ul,oFe,Po,mu())(e)}var uFe={colorField:"name",rectStyle:{lineWidth:1,stroke:"#fff"},hierarchyConfig:{tile:"treemapSquarify"},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1,breadCrumb:{position:"bottom-left",rootText:"\u521D\u59CB",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}}}};(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="treemap",t}return r.getDefaultOptions=function(){return uFe},r.prototype.changeData=function(t){var n=this.options,i=n.colorField,a=n.interactions,o=n.hierarchyConfig;this.updateOption({data:t});var s=hB({data:t,colorField:i,enableDrillDown:Mte(a,"treemap-drill-down"),hierarchyConfig:o});this.chart.changeData(s),tFe(this.chart)},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return sFe},r})(Ui);function lFe(e){return e.target.depth}function cFe(e){return e.depth}function fFe(e,r){return r-1-e.height}function pB(e,r){return e.sourceLinks.length?e.depth:r-1}function hFe(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?rq(e.sourceLinks,lFe)-1:0}function iT(e){return function(){return e}}function GR(e,r){for(var t=0,n=0;n<e.length;n++)t+=r(e[n]);return t}function HR(e,r){for(var t=-1/0,n=0;n<e.length;n++)t=Math.max(r(e[n]),t);return t}function pFe(e,r){for(var t=1/0,n=0;n<e.length;n++)t=Math.min(r(e[n]),t);return t}function H9(e,r){return rL(e.source,r.source)||e.index-r.index}function j9(e,r){return rL(e.target,r.target)||e.index-r.index}function rL(e,r){return e.y0-r.y0}function jR(e){return e.value}function dFe(e){return e.index}function vFe(e){return e.nodes}function gFe(e){return e.links}function W9(e,r){var t=e.get(r);if(!t)throw new Error("missing: "+r);return t}function X9(e){for(var r=e.nodes,t=0,n=r;t<n.length;t++){for(var i=n[t],a=i.y0,o=a,s=0,u=i.sourceLinks;s<u.length;s++){var l=u[s];l.y0=a+l.width/2,a+=l.width}for(var f=0,h=i.targetLinks;f<h.length;f++){var l=h[f];l.y1=o+l.width/2,o+=l.width}}}function mFe(){var e=0,r=0,t=1,n=1,i=24,a=8,o,s=dFe,u=pB,l,f,h,p=vFe,v=gFe,m=6;function x(me){var Re={nodes:p(me),links:v(me)};return E(Re),A(Re),L(Re),k(Re),$(Re),X9(Re),Re}x.update=function(me){return X9(me),me},x.nodeId=function(me){return arguments.length?(s=typeof me=="function"?me:iT(me),x):s},x.nodeAlign=function(me){return arguments.length?(u=typeof me=="function"?me:iT(me),x):u},x.nodeDepth=function(me){return arguments.length?(l=me,x):l},x.nodeSort=function(me){return arguments.length?(f=me,x):f},x.nodeWidth=function(me){return arguments.length?(i=+me,x):i},x.nodePadding=function(me){return arguments.length?(a=o=+me,x):a},x.nodes=function(me){return arguments.length?(p=typeof me=="function"?me:iT(me),x):p},x.links=function(me){return arguments.length?(v=typeof me=="function"?me:iT(me),x):v},x.linkSort=function(me){return arguments.length?(h=me,x):h},x.size=function(me){return arguments.length?(e=r=0,t=+me[0],n=+me[1],x):[t-e,n-r]},x.extent=function(me){return arguments.length?(e=+me[0][0],t=+me[1][0],r=+me[0][1],n=+me[1][1],x):[[e,r],[t,n]]},x.iterations=function(me){return arguments.length?(m=+me,x):m};function E(me){var Re=me.nodes,We=me.links;Re.forEach(function(Lt,rn){Lt.index=rn,Lt.sourceLinks=[],Lt.targetLinks=[]});var je=new Map(Re.map(function(Lt){return[s(Lt),Lt]}));if(We.forEach(function(Lt,rn){Lt.index=rn;var wn=Lt.source,zn=Lt.target;typeof wn!="object"&&(wn=Lt.source=W9(je,wn)),typeof zn!="object"&&(zn=Lt.target=W9(je,zn)),wn.sourceLinks.push(Lt),zn.targetLinks.push(Lt)}),h!=null)for(var lt=0,dt=Re;lt<dt.length;lt++){var ct=dt[lt],Tt=ct.sourceLinks,It=ct.targetLinks;Tt.sort(h),It.sort(h)}}function A(me){for(var Re=me.nodes,We=0,je=Re;We<je.length;We++){var lt=je[We];lt.value=lt.fixedValue===void 0?Math.max(GR(lt.sourceLinks,jR),GR(lt.targetLinks,jR)):lt.fixedValue}}function L(me){for(var Re=me.nodes,We=Re.length,je=new Set(Re),lt=new Set,dt=0;je.size;){if(je.forEach(function(Lt){Lt.depth=dt;for(var rn=0,wn=Lt.sourceLinks;rn<wn.length;rn++){var zn=wn[rn].target;lt.add(zn)}}),++dt>We)throw new Error("circular link");je=lt,lt=new Set}if(l)for(var ct=Math.max(HR(Re,function(Lt){return Lt.depth})+1,0),Tt=void 0,It=0;It<Re.length;It++)Tt=Re[It],Tt.depth=l.call(null,Tt,ct)}function k(me){for(var Re=me.nodes,We=Re.length,je=new Set(Re),lt=new Set,dt=0;je.size;){if(je.forEach(function(ct){ct.height=dt;for(var Tt=0,It=ct.targetLinks;Tt<It.length;Tt++){var Lt=It[Tt].source;lt.add(Lt)}}),++dt>We)throw new Error("circular link");je=lt,lt=new Set}}function R(me){for(var Re=me.nodes,We=Math.max(HR(Re,function(zn){return zn.depth})+1,0),je=(t-e-i)/(We-1),lt=new Array(We).fill(0).map(function(){return[]}),dt=0,ct=Re;dt<ct.length;dt++){var Tt=ct[dt],It=Math.max(0,Math.min(We-1,Math.floor(u.call(null,Tt,We))));Tt.layer=It,Tt.x0=e+It*je,Tt.x1=Tt.x0+i,lt[It]?lt[It].push(Tt):lt[It]=[Tt]}if(f)for(var Lt=0,rn=lt;Lt<rn.length;Lt++){var wn=rn[Lt];wn.sort(f)}return lt}function D(me){for(var Re=pFe(me,function(Zt){return(n-r-(Zt.length-1)*o)/GR(Zt,jR)}),We=0,je=me;We<je.length;We++){for(var lt=je[We],dt=r,ct=0,Tt=lt;ct<Tt.length;ct++){var It=Tt[ct];It.y0=dt,It.y1=dt+It.value*Re,dt=It.y1+o;for(var Lt=0,rn=It.sourceLinks;Lt<rn.length;Lt++){var wn=rn[Lt];wn.width=wn.value*Re}}dt=(n-dt+o)/(lt.length+1);for(var zn=0;zn<lt.length;++zn){var It=lt[zn];It.y0+=dt*(zn+1),It.y1+=dt*(zn+1)}te(lt)}}function $(me){var Re=R(me);o=Math.min(a,(n-r)/(HR(Re,function(dt){return dt.length})-1)),D(Re);for(var We=0;We<m;++We){var je=Math.pow(.99,We),lt=Math.max(1-je,(We+1)/m);H(Re,je,lt),j(Re,je,lt)}}function j(me,Re,We){for(var je=1,lt=me.length;je<lt;++je){for(var dt=me[je],ct=0,Tt=dt;ct<Tt.length;ct++){for(var It=Tt[ct],Lt=0,rn=0,wn=0,zn=It.targetLinks;wn<zn.length;wn++){var Zt=zn[wn],nn=Zt.source,mn=Zt.value,zt=mn*(It.layer-nn.layer);Lt+=ie(nn,It)*zt,rn+=zt}if(rn>0){var Vr=(Lt/rn-It.y0)*Re;It.y0+=Vr,It.y1+=Vr,Q(It)}}f===void 0&&dt.sort(rL),dt.length&&ee(dt,We)}}function H(me,Re,We){for(var je=me.length,lt=je-2;lt>=0;--lt){for(var dt=me[lt],ct=0,Tt=dt;ct<Tt.length;ct++){for(var It=Tt[ct],Lt=0,rn=0,wn=0,zn=It.sourceLinks;wn<zn.length;wn++){var Zt=zn[wn],nn=Zt.target,mn=Zt.value,zt=mn*(nn.layer-It.layer);Lt+=ve(It,nn)*zt,rn+=zt}if(rn>0){var Vr=(Lt/rn-It.y0)*Re;It.y0+=Vr,It.y1+=Vr,Q(It)}}f===void 0&&dt.sort(rL),dt.length&&ee(dt,We)}}function ee(me,Re){var We=me.length>>1,je=me[We];W(me,je.y0-o,We-1,Re),U(me,je.y1+o,We+1,Re),W(me,n,me.length-1,Re),U(me,r,0,Re)}function U(me,Re,We,je){for(;We<me.length;++We){var lt=me[We],dt=(Re-lt.y0)*je;dt>1e-6&&(lt.y0+=dt,lt.y1+=dt),Re=lt.y1+o}}function W(me,Re,We,je){for(;We>=0;--We){var lt=me[We],dt=(lt.y1-Re)*je;dt>1e-6&&(lt.y0-=dt,lt.y1-=dt),Re=lt.y0-o}}function Q(me){var Re=me.sourceLinks,We=me.targetLinks;if(h===void 0){for(var je=0,lt=We;je<lt.length;je++){var dt=lt[je].source.sourceLinks;dt.sort(j9)}for(var ct=0,Tt=Re;ct<Tt.length;ct++){var It=Tt[ct].target.targetLinks;It.sort(H9)}}}function te(me){if(h===void 0)for(var Re=0,We=me;Re<We.length;Re++){var je=We[Re],lt=je.sourceLinks,dt=je.targetLinks;lt.sort(j9),dt.sort(H9)}}function ie(me,Re){for(var We=me.y0-(me.sourceLinks.length-1)*o/2,je=0,lt=me.sourceLinks;je<lt.length;je++){var dt=lt[je],ct=dt.target,Tt=dt.width;if(ct===Re)break;We+=Tt+o}for(var It=0,Lt=Re.targetLinks;It<Lt.length;It++){var rn=Lt[It],ct=rn.source,Tt=rn.width;if(ct===me)break;We-=Tt}return We}function ve(me,Re){for(var We=Re.y0-(Re.targetLinks.length-1)*o/2,je=0,lt=Re.targetLinks;je<lt.length;je++){var dt=lt[je],ct=dt.source,Tt=dt.width;if(ct===me)break;We+=Tt+o}for(var It=0,Lt=me.sourceLinks;It<Lt.length;It++){var rn=Lt[It],ct=rn.target,Tt=rn.width;if(ct===Re)break;We-=Tt}return We}return x}var yFe={left:cFe,right:fFe,center:hFe,justify:pB},_Fe={nodeId:function(e){return e.index},nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodeSort:void 0};function xFe(e){var r=ei(e)?yFe[e]:kn(e)?e:null;return r||pB}function bFe(e){return Na({},_Fe,e)}function wFe(e,r){var t=bFe(e),n=t.nodeId,i=t.nodeSort,a=t.nodeAlign,o=t.nodeWidth,s=t.nodePadding,u=t.nodeDepth,l=mFe().nodeSort(i).nodeWidth(o).nodePadding(s).nodeDepth(u).nodeAlign(xFe(a)).extent([[0,0],[1,1]]).nodeId(n),f=l(r),h=f.nodes.map(function(v){var m=v.x0,x=v.x1,E=v.y0,A=v.y1;return v.x=[m,x,x,m],v.y=[E,E,A,A],v}).filter(function(v){return v.name!==null}),p=f.links.map(function(v){var m=v.source,x=v.target,E=m.x1,A=x.x0;v.x=[E,E,A,A];var L=v.width/2;return v.y=[v.y0+L,v.y0-L,v.y1+L,v.y1-L],v}).filter(function(v){var m=v.source,x=v.target;return m.name!==null&&x.name!==null});return{nodes:h,links:p}}function CFe(e,r,t){var n=[];return e.forEach(function(i){var a=i[r],o=i[t];n.includes(a)||n.push(a),n.includes(o)||n.push(o)}),n}function EFe(e,r,t,n){var i={};return r.forEach(function(a){i[a]={},r.forEach(function(o){i[a][o]=0})}),e.forEach(function(a){i[a[t]][a[n]]=1}),i}function SFe(e,r,t){if(!ar(e))return[];var n=[],i=CFe(e,r,t),a=EFe(e,i,r,t),o={};i.forEach(function(u){o[u]=0});function s(u){o[u]=1,i.forEach(function(l){if(a[u][l]!=0)if(o[l]==1)n.push(u+"_"+l);else{if(o[l]==-1)return;s(l)}}),o[u]=-1}return i.forEach(function(u){o[u]!=-1&&s(u)}),n.length!==0&&console.warn("sankey data contains circle, "+n.length+" records removed.",n),e.filter(function(u){return n.findIndex(function(l){return l===u[r]+"_"+u[t]})<0})}function AFe(e){return e==="node-link"}function TFe(e,r,t){return e1(e)?e/t:r}function MFe(e,r,t){return e1(e)?e/t:r}function Lte(e,r,t){var n=e.dataType,i=e.data,a=e.sourceField,o=e.targetField,s=e.weightField,u=e.nodeAlign,l=e.nodeSort,f=e.nodePadding,h=e.nodePaddingRatio,p=e.nodeWidth,v=e.nodeWidthRatio,m=e.nodeDepth,x=e.rawFields,E=x===void 0?[]:x,A;AFe(n)?A=i:A=DJ(SFe(i,a,o),a,o,s,E);var L=wFe({nodeAlign:u,nodePadding:MFe(f,h,t),nodeWidth:TFe(p,v,r),nodeSort:l,nodeDepth:m},A),k=L.nodes,R=L.links;return{nodes:k.map(function(D){return nt(nt({},Ao(D,nu(["x","y","name"],E))),{isNode:!0})}),edges:R.map(function(D){return nt(nt({source:D.source.name,target:D.target.name,name:D.source.name||D.target.name},Ao(D,nu(["x","y","value"],E))),{isNode:!1})})}}var Y9="x",Z9="y",q9="name",JI="nodes",ek="edges";function LFe(e){var r=e.options,t=r.rawFields,n=t===void 0?[]:t;return Dt({},{options:{tooltip:{fields:Z0(nu(["name","source","target","value","isNode"],n))},label:{fields:Z0(nu(["x","name"],n))}}},e)}function IFe(e){var r=e.chart,t=e.options,n=t.color,i=t.nodeStyle,a=t.edgeStyle,o=t.label,s=t.tooltip,u=t.nodeState,l=t.edgeState;r.legend(!1),r.tooltip(s),r.axis(!1),r.coordinate().reflect("y");var f=Lte(t,r.width,r.height),h=f.nodes,p=f.edges,v=r.createView({id:ek});v.data(p),HJ({chart:v,options:{xField:Y9,yField:Z9,seriesField:q9,edge:{color:n,style:a,shape:"arc"},tooltip:s,state:l}});var m=r.createView({id:JI});return m.data(h),WI({chart:m,options:{xField:Y9,yField:Z9,seriesField:q9,polygon:{color:n,style:i},label:o,tooltip:s,state:u}}),r.interaction("element-active"),r.scale({x:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},y:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},name:{sync:"color",type:"cat"}}),e}function kFe(e){var r=e.chart,t=e.options,n=t.animation;typeof n=="boolean"?r.animate(n):r.animate(!0);var i=nu(r.views[0].geometries,r.views[1].geometries);return i.forEach(function(a){a.animate(n)}),e}function PFe(e){var r=e.chart,t=e.options,n=t.nodeDraggable,i="sankey-node-draggable";return n?r.interaction(i):r.removeInteraction(i),e}function RFe(e){var r=e.chart,t=e.options,n=t.interactions,i=n===void 0?[]:n,a=[].concat(i,t.nodeInteractions||[]),o=[].concat(i,t.edgeInteractions||[]),s=aa(r,JI),u=aa(r,ek);return a.forEach(function(l){(l==null?void 0:l.enable)===!1?s.removeInteraction(l.type):s.interaction(l.type,l.cfg||{})}),o.forEach(function(l){(l==null?void 0:l.enable)===!1?u.removeInteraction(l.type):u.interaction(l.type,l.cfg||{})}),e}function OFe(e){return Ei(LFe,IFe,RFe,PFe,kFe,Xa)(e)}var FFe=function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDragging=!1,t}return r.prototype.isNodeElement=function(){var t=Ie(this.context,"event.target");if(t){var n=t.get("element");return n&&n.getModel().data.isNode}return!1},r.prototype.getNodeView=function(){return aa(this.context.view,JI)},r.prototype.getEdgeView=function(){return aa(this.context.view,ek)},r.prototype.getCurrentDatumIdx=function(t){return this.getNodeView().geometries[0].elements.indexOf(t)},r.prototype.start=function(){if(this.isNodeElement()){this.prevPoint={x:Ie(this.context,"event.x"),y:Ie(this.context,"event.y")};var t=this.context.event.target.get("element"),n=this.getCurrentDatumIdx(t);if(n===-1)return;this.currentElementIdx=n,this.context.isDragging=!0,this.isDragging=!0,this.prevNodeAnimateCfg=this.getNodeView().getOptions().animate,this.prevEdgeAnimateCfg=this.getEdgeView().getOptions().animate,this.getNodeView().animate(!1),this.getEdgeView().animate(!1)}},r.prototype.translate=function(){if(this.isDragging){var t=this.context.view,n={x:Ie(this.context,"event.x"),y:Ie(this.context,"event.y")},i=n.x-this.prevPoint.x,a=n.y-this.prevPoint.y,o=this.getNodeView(),s=o.geometries[0].elements[this.currentElementIdx];if(s&&s.getModel()){var u=s.getModel().data,l=o.getOptions().data,f=o.getCoordinate(),h={x:i/f.getWidth(),y:a/f.getHeight()},p=nt(nt({},u),{x:u.x.map(function(A){return A+=h.x}),y:u.y.map(function(A){return A+=h.y})}),v=nu(l);v[this.currentElementIdx]=p,o.data(v);var m=u.name,x=this.getEdgeView(),E=x.getOptions().data;E.forEach(function(A){A.source===m&&(A.x[0]+=h.x,A.x[1]+=h.x,A.y[0]+=h.y,A.y[1]+=h.y),A.target===m&&(A.x[2]+=h.x,A.x[3]+=h.x,A.y[2]+=h.y,A.y[3]+=h.y)}),x.data(E),this.prevPoint=n,t.render(!0)}}},r.prototype.end=function(){this.isDragging=!1,this.context.isDragging=!1,this.prevPoint=null,this.currentElementIdx=null,this.getNodeView().animate(this.prevNodeAnimateCfg),this.getEdgeView().animate(this.prevEdgeAnimateCfg)},r}(Vs);hi("sankey-node-drag",FFe);$i("sankey-node-draggable",{showEnable:[{trigger:"polygon:mouseenter",action:"cursor:pointer"},{trigger:"polygon:mouseleave",action:"cursor:default"}],start:[{trigger:"polygon:mousedown",action:"sankey-node-drag:start"}],processing:[{trigger:"plot:mousemove",action:"sankey-node-drag:translate"},{isEnable:function(e){return e.isDragging},trigger:"plot:mousemove",action:"cursor:move"}],end:[{trigger:"plot:mouseup",action:"sankey-node-drag:end"}]});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="sankey",t}return r.getDefaultOptions=function(){return{appendPadding:8,syncViewPadding:!0,nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.3,lineWidth:0},edgeState:{active:{style:{opacity:.8,lineWidth:0}}},label:{formatter:function(t){var n=t.name;return n},callback:function(t){var n=t[1]===1;return{style:{fill:"#545454",textAlign:n?"end":"start"},offsetX:n?-8:8}},layout:[{type:"hide-overlap"}]},tooltip:{showTitle:!1,showMarkers:!1,shared:!1,showContent:function(t){return!Ie(t,[0,"data","isNode"])},formatter:function(t){var n=t.source,i=t.target,a=t.value;return{name:n+" -> "+i,value:a}}},nodeWidthRatio:.008,nodePaddingRatio:.01,animation:{appear:{animation:"wave-in"},enter:{animation:"wave-in"}}}},r.prototype.changeData=function(t){this.updateOption({data:t});var n=Lte(this.options,this.chart.width,this.chart.height),i=n.nodes,a=n.edges,o=aa(this.chart,JI),s=aa(this.chart,ek);o.changeData(i),s.changeData(a)},r.prototype.getSchemaAdaptor=function(){return OFe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r})(Ui);var DFe={y:0,nodeWidthRatio:.05,weight:!1,nodePaddingRatio:.1,id:function(e){return e.id},source:function(e){return e.source},target:function(e){return e.target},sourceWeight:function(e){return e.value||1},targetWeight:function(e){return e.value||1},sortBy:null};function BFe(e,r,t){we(e,function(n,i){n.inEdges=r.filter(function(a){return""+t.target(a)==""+i}),n.outEdges=r.filter(function(a){return""+t.source(a)==""+i}),n.edges=n.outEdges.concat(n.inEdges),n.frequency=n.edges.length,n.value=0,n.inEdges.forEach(function(a){n.value+=t.targetWeight(a)}),n.outEdges.forEach(function(a){n.value+=t.sourceWeight(a)})})}function NFe(e,r){var t={weight:function(i,a){return a.value-i.value},frequency:function(i,a){return a.frequency-i.frequency},id:function(i,a){return(""+r.id(i)).localeCompare(""+r.id(a))}},n=t[r.sortBy];!n&&kn(r.sortBy)&&(n=r.sortBy),n&&e.sort(n)}function zFe(e,r){var t=e.length;if(!t)throw new TypeError("Invalid nodes: it's empty!");if(r.weight){var n=r.nodePaddingRatio;if(n<0||n>=1)throw new TypeError("Invalid nodePaddingRatio: it must be in range [0, 1)!");var i=n/(2*t),a=r.nodeWidthRatio;if(a<=0||a>=1)throw new TypeError("Invalid nodeWidthRatio: it must be in range (0, 1)!");var o=0;e.forEach(function(u){o+=u.value}),e.forEach(function(u){u.weight=u.value/o,u.width=u.weight*(1-n),u.height=a}),e.forEach(function(u,l){for(var f=0,h=l-1;h>=0;h--)f+=e[h].width+2*i;var p=u.minX=i+f,v=u.maxX=u.minX+u.width,m=u.minY=r.y-a/2,x=u.maxY=m+a;u.x=[p,v,v,p],u.y=[m,m,x,x]})}else{var s=1/t;e.forEach(function(u,l){u.x=(l+.5)*s,u.y=r.y})}return e}function $Fe(e,r,t){if(t.weight){var n={};we(e,function(i,a){n[a]=i.value}),r.forEach(function(i){var a=t.source(i),o=t.target(i),s=e[a],u=e[o];if(s&&u){var l=n[a],f=t.sourceWeight(i),h=s.minX+(s.value-l)/s.value*s.width,p=h+f/s.value*s.width;n[a]-=f;var v=n[o],m=t.targetWeight(i),x=u.minX+(u.value-v)/u.value*u.width,E=x+m/u.value*u.width;n[o]-=m;var A=t.y;i.x=[h,p,x,E],i.y=[A,A,A,A],i.source=s,i.target=u}})}else r.forEach(function(i){var a=e[t.source(i)],o=e[t.target(i)];a&&o&&(i.x=[a.x,o.x],i.y=[a.y,o.y],i.source=a,i.target=o)});return r}function UFe(e){return Na({},DFe,e)}function VFe(e,r){var t=UFe(e),n={},i=r.nodes,a=r.links;i.forEach(function(u){var l=t.id(u);n[l]=u}),BFe(n,a,t),NFe(i,t);var o=zFe(i,t),s=$Fe(n,a,t);return{nodes:o,links:s}}var Ite="x",kte="y",Pte="name",Rte="source",GFe={nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.5,lineWidth:2},label:{fields:["x","name"],callback:function(e,r){var t=(e[0]+e[1])/2,n=t>.5?-4:4;return{labelEmit:!0,style:{fill:"#8c8c8c"},offsetX:n,content:r}}},tooltip:{showTitle:!1,showMarkers:!1,fields:["source","target","value","isNode"],showContent:function(e){return!Ie(e,[0,"data","isNode"])},formatter:function(e){var r=e.source,t=e.target,n=e.value;return{name:r+" -> "+t,value:n}}},interactions:[{type:"element-active"}],weight:!0,nodePaddingRatio:.1,nodeWidthRatio:.05};function HFe(e){var r=e.options,t=r.data,n=r.sourceField,i=r.targetField,a=r.weightField,o=r.nodePaddingRatio,s=r.nodeWidthRatio,u=r.rawFields,l=u===void 0?[]:u,f=DJ(t,n,i,a),h=VFe({weight:!0,nodePaddingRatio:o,nodeWidthRatio:s},f),p=h.nodes,v=h.links,m=p.map(function(E){return nt(nt({},Ao(E,nu(["id","x","y","name"],l))),{isNode:!0})}),x=v.map(function(E){return nt(nt({source:E.source.name,target:E.target.name,name:E.source.name||E.target.name},Ao(E,nu(["x","y","value"],l))),{isNode:!1})});return nt(nt({},e),{ext:nt(nt({},e.ext),{chordData:{nodesData:m,edgesData:x}})})}function jFe(e){var r,t=e.chart;return t.scale((r={x:{sync:!0,nice:!0},y:{sync:!0,nice:!0,max:1}},r[Pte]={sync:"color"},r[Rte]={sync:"color"},r)),e}function WFe(e){var r=e.chart;return r.axis(!1),e}function XFe(e){var r=e.chart;return r.legend(!1),e}function YFe(e){var r=e.chart,t=e.options,n=t.tooltip;return r.tooltip(n),e}function ZFe(e){var r=e.chart;return r.coordinate("polar").reflect("y"),e}function qFe(e){var r=e.chart,t=e.options,n=e.ext.chordData.nodesData,i=t.nodeStyle,a=t.label,o=t.tooltip,s=r.createView();return s.data(n),WI({chart:s,options:{xField:Ite,yField:kte,seriesField:Pte,polygon:{style:i},label:a,tooltip:o}}),e}function KFe(e){var r=e.chart,t=e.options,n=e.ext.chordData.edgesData,i=t.edgeStyle,a=t.tooltip,o=r.createView();o.data(n);var s={xField:Ite,yField:kte,seriesField:Rte,edge:{style:i,shape:"arc"},tooltip:a};return HJ({chart:o,options:s}),e}function QFe(e){var r=e.chart,t=e.options,n=t.animation;return typeof n=="boolean"?r.animate(n):r.animate(!0),we($Ae(r),function(i){i.animate(n)}),e}function JFe(e){return Ei(Xa,HFe,ZFe,jFe,WFe,XFe,YFe,KFe,qFe,ks,b_,QFe)(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="chord",t}return r.getDefaultOptions=function(){return GFe},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return JFe},r})(Ui);var e5e={field:"value",as:["x","y","r"],sort:function(e,r){return r.value-e.value}};function t5e(e,r){r=Na({},e5e,r);var t=r.as;if(!ar(t)||t.length!==3)throw new TypeError('Invalid as: it must be an array with 3 strings (e.g. [ "x", "y", "r" ])!');var n;try{n=sB(r)}catch(l){console.warn(l)}var i=function(l){return ste().size(r.size).padding(r.padding)(X2(l).sum(function(f){return f[n]}).sort(r.sort))},a=i(e),o=t[0],s=t[1],u=t[2];return a.each(function(l){l[o]=l.x,l[s]=l.y,l[u]=l.r}),uB(a)}function Ote(e){var r=e.data,t=e.hierarchyConfig,n=e.rawFields,i=n===void 0?[]:n,a=e.enableDrillDown,o=t5e(r,nt(nt({},t),{field:"value",as:["x","y","r"]})),s=[];return o.forEach(function(u){for(var l,f=u.data.name,h=nt({},u);h.depth>1;)f=((l=h.parent.data)===null||l===void 0?void 0:l.name)+" / "+f,h=h.parent;if(a&&u.depth>2)return null;var p=Dt({},u.data,nt(nt(nt({},Ao(u.data,i)),{path:f}),u));p.ext=t,p[AE]={hierarchyConfig:t,rawFields:i,enableDrillDown:a},s.push(p)}),s}function Fte(e,r,t){var n=G4([e,r]),i=n[0],a=n[1],o=n[2],s=n[3],u=t.width,l=t.height,f=u-(s+a),h=l-(i+o),p=Math.min(f,h),v=(f-p)/2,m=(h-p)/2,x=i+m,E=a+v,A=o+m,L=s+v,k=[x,E,A,L],R=p<0?0:p;return{finalPadding:k,finalSize:R}}var r5e=["x","y","r","name","value","path","depth"],n5e={colorField:"name",autoFit:!0,pointStyle:{lineWidth:0,stroke:"#fff"},legend:!1,hierarchyConfig:{size:[1,1],padding:0},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1}};function i5e(e){var r=e.chart,t=Math.min(r.viewBBox.width,r.viewBBox.height);return Dt({options:{size:function(n){var i=n.r;return i*t}}},e)}function a5e(e){var r=e.options,t=e.chart,n=t.viewBBox,i=r.padding,a=r.appendPadding,o=r.drilldown,s=a;if(o!=null&&o.enabled){var u=zI(t.appendPadding,Ie(o,["breadCrumb","position"]));s=G4([u,a])}var l=Fte(i,s,n).finalPadding;return t.padding=l,t.appendPadding=0,e}function o5e(e){var r=e.chart,t=e.options,n=r.padding,i=r.appendPadding,a=t.color,o=t.colorField,s=t.pointStyle,u=t.hierarchyConfig,l=t.sizeField,f=t.rawFields,h=f===void 0?[]:f,p=t.drilldown,v=Ote({data:t.data,hierarchyConfig:u,enableDrillDown:p==null?void 0:p.enabled,rawFields:h});r.data(v);var m=r.viewBBox,x=Fte(n,i,m).finalSize,E=function(A){var L=A.r;return L*x};return l&&(E=function(A){return A[l]*x}),id(Dt({},e,{options:{xField:"x",yField:"y",seriesField:o,sizeField:l,rawFields:nu(r5e,h),point:{color:a,style:s,shape:"circle",size:E}}})),e}function s5e(e){return Ei(ku({},{x:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0},y:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0}}))(e)}function u5e(e){var r=e.chart,t=e.options,n=t.tooltip;if(n===!1)r.tooltip(!1);else{var i=n;Ie(n,"fields")||(i=Dt({},{customItems:function(a){return a.map(function(o){var s=Ie(r.getOptions(),"scales"),u=Ie(s,["name","formatter"],function(f){return f}),l=Ie(s,["value","formatter"],function(f){return f});return nt(nt({},o),{name:u(o.data.name),value:l(o.data.value)})})}},i)),r.tooltip(i)}return e}function l5e(e){var r=e.chart;return r.axis(!1),e}function c5e(e){var r=e.drilldown,t=e.interactions,n=t===void 0?[]:t;return r!=null&&r.enabled?Dt({},e,{interactions:nu(n,[{type:"drill-down",cfg:{drillDownConfig:r,transformData:Ote,enableDrillDown:!0}}])}):e}function f5e(e){var r=e.chart,t=e.options;return ks({chart:r,options:c5e(t)}),e}function h5e(e){return Ei(nd("pointStyle"),i5e,a5e,Xa,s5e,o5e,l5e,G2,u5e,f5e,Po,mu())(e)}(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="circle-packing",t}return r.getDefaultOptions=function(){return n5e},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return h5e},r.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},r})(Ui);(function(e){ji(r,e);function r(t,n,i,a){var o=e.call(this,t,Dt({},a,n))||this;return o.type="g2-plot",o.defaultOptions=a,o.adaptor=i,o}return r.prototype.getDefaultOptions=function(){return this.defaultOptions},r.prototype.getSchemaAdaptor=function(){return this.adaptor},r})(Ui);var p5e={line:XJ,pie:aee,column:YI,bar:eee,area:qJ,gauge:wte,"tiny-line":vee,"tiny-column":gee,"tiny-area":dee,"ring-progress":Cee,progress:bee,scatter:fee,histogram:yee,funnel:Yee,stock:jee},d5e={line:YJ,pie:TMe,column:JJ,bar:dMe,area:HTe,gauge:Cte,"tiny-line":mIe,"tiny-column":bIe,"tiny-area":CIe,"ring-progress":DIe,progress:RIe,scatter:ULe,histogram:IIe,funnel:NPe,stock:vPe},v5e={pie:{label:!1},column:{tooltip:{showMarkers:!1}},bar:{tooltip:{showMarkers:!1}}};function B5(e,r,t){var n=d5e[e];if(!n){console.error("could not find "+e+" plot");return}var i=p5e[e];i({chart:r,options:Dt({},n.getDefaultOptions(),Ie(v5e,e,{}),t)})}function g5e(e){var r=e.chart,t=e.options,n=t.views,i=t.legend;return we(n,function(a){var o=a.region,s=a.data,u=a.meta,l=a.axes,f=a.coordinate,h=a.interactions,p=a.annotations,v=a.tooltip,m=a.geometries,x=r.createView({region:o});x.data(s);var E={};l&&we(l,function(A,L){E[L]=Ao(A,sp)}),E=Dt({},u,E),x.scale(E),l?we(l,function(A,L){x.axis(L,A)}):x.axis(!1),x.coordinate(f),we(m,function(A){var L=_p({chart:x,options:A}).ext,k=A.adjust;k&&L.geometry.adjust(k)}),we(h,function(A){A.enable===!1?x.removeInteraction(A.type):x.interaction(A.type,A.cfg)}),we(p,function(A){x.annotation()[A.type](nt({},A))}),typeof a.animation=="boolean"?x.animate(!1):(x.animate(!0),we(x.geometries,function(A){A.animate(a.animation)})),v&&(x.interaction("tooltip"),x.tooltip(v))}),i?we(i,function(a,o){r.legend(o,a)}):r.legend(!1),r.tooltip(t.tooltip),e}function m5e(e){var r=e.chart,t=e.options,n=t.plots,i=t.data,a=i===void 0?[]:i;return we(n,function(o){var s=o.type,u=o.region,l=o.options,f=l===void 0?{}:l,h=o.top,p=f.tooltip;if(h){B5(s,r,nt(nt({},f),{data:a}));return}var v=r.createView(nt({region:u},Ao(f,$J)));p&&v.interaction("tooltip"),B5(s,v,nt({data:a},f))}),e}function y5e(e){var r=e.chart,t=e.options;return r.option("slider",t.slider),e}function _5e(e){return Ei(Po,g5e,m5e,ks,Po,Xa,Ul,y5e,mu())(e)}function x5e(e,r){var t=e.getModel(),n=t.data,i;return ar(n)?i=n[0][r]:i=n[r],i}function b5e(e){var r=ZM(e);we(r,function(t){t.hasState("active")&&t.setState("active",!1),t.hasState("selected")&&t.setState("selected",!1),t.hasState("inactive")&&t.setState("inactive",!1)})}var w5e=function(e){ji(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getAssociationItems=function(t,n){var i,a=this.context.event,o=n||{},s=o.linkField,u=o.dim,l=[];if(!((i=a.data)===null||i===void 0)&&i.data){var f=a.data.data;we(t,function(h){var p,v,m=s;if(u==="x"?m=h.getXScale().field:u==="y"?m=(p=h.getYScales().find(function(E){return E.field===m}))===null||p===void 0?void 0:p.field:m||(m=(v=h.getGroupScales()[0])===null||v===void 0?void 0:v.field),!!m){var x=gu(ZM(h),function(E){var A=!1,L=!1,k=ar(f)?Ie(f[0],m):Ie(f,m);return x5e(E,m)===k?A=!0:L=!0,{element:E,view:h,active:A,inactive:L}});l.push.apply(l,x)}})}return l},r.prototype.showTooltip=function(t){var n=o9(this.context.view),i=this.getAssociationItems(n,t);we(i,function(a){if(a.active){var o=a.element.shape.getCanvasBBox();a.view.showTooltip({x:o.minX+o.width/2,y:o.minY+o.height/2})}})},r.prototype.hideTooltip=function(){var t=o9(this.context.view);we(t,function(n){n.hideTooltip()})},r.prototype.active=function(t){var n=bC(this.context.view),i=this.getAssociationItems(n,t);we(i,function(a){var o=a.active,s=a.element;o&&s.setState("active",!0)})},r.prototype.selected=function(t){var n=bC(this.context.view),i=this.getAssociationItems(n,t);we(i,function(a){var o=a.active,s=a.element;o&&s.setState("selected",!0)})},r.prototype.highlight=function(t){var n=bC(this.context.view),i=this.getAssociationItems(n,t);we(i,function(a){var o=a.inactive,s=a.element;o&&s.setState("inactive",!0)})},r.prototype.reset=function(){var t=bC(this.context.view);we(t,function(n){b5e(n)})},r}(Vs);hi("association",w5e);$i("association-active",{start:[{trigger:"element:mouseenter",action:"association:active"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]});$i("association-selected",{start:[{trigger:"element:mouseenter",action:"association:selected"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]});$i("association-highlight",{start:[{trigger:"element:mouseenter",action:"association:highlight"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]});$i("association-tooltip",{start:[{trigger:"element:mousemove",action:"association:showTooltip"}],end:[{trigger:"element:mouseleave",action:"association:hideTooltip"}]});(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="mix",t}return r.prototype.getSchemaAdaptor=function(){return _5e},r})(Ui);function C5e(e,r){var t=r.data,n=r.coordinate,i=r.interactions,a=r.annotations,o=r.animation,s=r.tooltip,u=r.axes,l=r.meta,f=r.geometries;t&&e.data(t);var h={};u&&we(u,function(p,v){h[v]=Ao(p,sp)}),h=Dt({},l,h),e.scale(h),n&&e.coordinate(n),u===!1?e.axis(!1):we(u,function(p,v){e.axis(v,p)}),we(f,function(p){var v=_p({chart:e,options:p}).ext,m=p.adjust;m&&v.geometry.adjust(m)}),we(i,function(p){p.enable===!1?e.removeInteraction(p.type):e.interaction(p.type,p.cfg)}),we(a,function(p){e.annotation()[p.type](nt({},p))}),typeof o=="boolean"?e.animate(!1):(e.animate(!0),we(e.geometries,function(p){p.animate(o)})),s?(e.interaction("tooltip"),e.tooltip(s)):s===!1&&e.removeInteraction("tooltip")}function E5e(e){var r=e.chart,t=e.options,n=t.type,i=t.data,a=t.fields,o=t.eachView,s=cS(t,["type","data","fields","eachView","axes","meta","tooltip","coordinate","theme","legend","interactions","annotations"]);return r.data(i),r.facet(n,nt(nt({},s),{fields:a,eachView:function(u,l){var f=o(u,l);if(f.geometries)C5e(u,f);else{var h=f,p=h.options;p.tooltip&&u.interaction("tooltip"),B5(h.type,u,p)}}})),e}function S5e(e){var r=e.chart,t=e.options,n=t.axes,i=t.meta,a=t.tooltip,o=t.coordinate,s=t.theme,u=t.legend,l=t.interactions,f=t.annotations,h={};return n&&we(n,function(p,v){h[v]=Ao(p,sp)}),h=Dt({},i,h),r.scale(h),r.coordinate(o),n?we(n,function(p,v){r.axis(v,p)}):r.axis(!1),a?(r.interaction("tooltip"),r.tooltip(a)):a===!1&&r.removeInteraction("tooltip"),r.legend(u),s&&r.theme(s),we(l,function(p){p.enable===!1?r.removeInteraction(p.type):r.interaction(p.type,p.cfg)}),we(f,function(p){r.annotation()[p.type](nt({},p))}),e}function A5e(e){return Ei(Xa,E5e,S5e)(e)}var T5e={title:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},rowTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},columnTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}}};(function(e){ji(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="area",t}return r.getDefaultOptions=function(){return T5e},r.prototype.getDefaultOptions=function(){return r.getDefaultOptions()},r.prototype.getSchemaAdaptor=function(){return A5e},r})(Ui);var K9;(function(e){e.DEV="DEV",e.BETA="BETA",e.STABLE="STABLE"})(K9||(K9={}));BJ("en-US",JAe);BJ("zh-CN",eTe);var N5=globalThis&&globalThis.__assign||function(){return N5=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},N5.apply(this,arguments)};globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var SS=N5({},ode),M5e=SS.version,L5e=SS.render;SS.unmountComponentAtNode;var dB;try{var I5e=Number((M5e||"").split(".")[0]);I5e>=18&&(dB=SS.createRoot)}catch{}function Q9(e){var r=SS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;r&&typeof r=="object"&&(r.usingClientEntryPoint=e)}var J9="__rc_react_root__";function k5e(e,r){Q9(!0);var t=r[J9]||dB(r);Q9(!1),t.render(e),r[J9]=t}function P5e(e,r){L5e(e,r)}function R5e(e,r){if(dB){k5e(e,r);return}P5e(e,r)}var O5e=function(e,r){var t=document.createElement("div");return r==="tooltip"&&(t.className="g2-tooltip"),R5e(e,t),t},F5e=O5e,aT=function(e,r){var t={}.toString;return t.call(e)==="[object ".concat(r,"]")},D5e=function(e){if(!e)return e;var r={};for(var t in e)r[t]=e[t];return r},nL=function(e){if(!e||typeof e!="object")return e;var r;return Array.isArray(e)?r=e.map(function(t){return nL(t)}):(r={},Object.keys(e).forEach(function(t){return r[t]=nL(e[t])})),r},Uw=function(e,r){for(var t=e,n=0;n<r.length;n+=1)if(t!=null&&t[r[n]])t=t[r[n]];else{t=void 0;break}return t},B5e=function(e,r,t){if(!e)return e;var n=e;return r.forEach(function(i,a){a<r.length-1?n=n[i]:n[i]=t}),e},tk=function(e,r){!e||(kn(e)?e(r):e.current=r)},z5=globalThis&&globalThis.__assign||function(){return z5=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},z5.apply(this,arguments)},e$=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};function rk(e,r){var t=ut.exports.useRef(),n=ut.exports.useRef(),i=ut.exports.useRef(null),a=r.onReady,o=r.onEvent,s=function(h,p){var v;return h===void 0&&(h="image/png"),(v=t.current)===null||v===void 0?void 0:v.chart.canvas.cfg.el.toDataURL(h,p)},u=function(h,p,v){var m;h===void 0&&(h="download"),p===void 0&&(p="image/png");var x=h;h.indexOf(".")===-1&&(x="".concat(h,".").concat(p.split("/")[1]));var E=(m=t.current)===null||m===void 0?void 0:m.chart.canvas.cfg.el.toDataURL(p,v),A=document.createElement("a");return A.href=E,A.download=x,document.body.appendChild(A),A.click(),document.body.removeChild(A),A=null,x},l=function(h,p,v){var m=Uw(h,p);B5e(h,p,function(){for(var x=[],E=0;E<arguments.length;E++)x[E]=arguments[E];var A=aT(m,"Function")?m.apply(void 0,x):m;return aT(A,"String")||aT(A,"Number")||aT(A,"HTMLDivElement")?A:F5e(A,v)})},f=function(){Uw(r,["statistic","content","customHtml"])&&l(r,["statistic","content","customHtml"]),Uw(r,["statistic","title","customHtml"])&&l(r,["statistic","title","customHtml"]),typeof r.tooltip=="object"&&(Uw(r,["tooltip","container"])&&l(r,["tooltip","container"],"tooltip"),Uw(r,["tooltip","customContent"])&&l(r,["tooltip","customContent"],"tooltip"))};return ut.exports.useEffect(function(){if(t.current&&!rs(n.current,r)){var h=!1;if(n.current){var p=n.current;p.data,p.value,p.percent;var v=e$(p,["data","value","percent"]);r.data,r.value,r.percent;var m=e$(r,["data","value","percent"]);h=rs(v,m)}if(n.current=nL(r),h&&Ie(r,"chartType")!=="Mix"){var x="data",E=["percent"],A=Object.keys(r);E.forEach(function(L){A.includes(L)&&(x=L)}),t.current.changeData((r==null?void 0:r[x])||[])}else f(),t.current.update(r)}},[r]),ut.exports.useEffect(function(){if(!i.current)return function(){return null};n.current||(n.current=nL(r)),f();var h=new e(i.current,z5({},r));h.toDataURL=function(v,m){return s(v,m)},h.downloadImage=function(v,m,x){return u(v,m,x)},h.render(),t.current=D5e(h),a&&a(h);var p=function(v){o&&o(h,v)};return h.on("*",p),function(){t.current&&(t.current.destroy(),t.current.off("*",p),t.current=void 0)}},[]),{chart:t,container:i}}var N5e=globalThis&&globalThis.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),z5e=function(e){N5e(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={hasError:!1},t.renderError=function(n){var i=t.props.errorTemplate;switch(n){default:return i&&typeof i=="function"?i(n):_y("h5",{children:["\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",n.message]})}},t}return r.getDerivedStateFromError=function(t){return{hasError:!0,error:t}},r.getDerivedStateFromProps=function(t,n){return n.children!==t.children?{children:t.children,hasError:!1,error:void 0}:null},r.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):oo(OZ,{children:this.props.children})},r}(Is.Component),nk=z5e;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var W0=function(){return W0=Object.assign||function(r){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a])}return r},W0.apply(this,arguments)};function $5e(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t}var U5e=function(){return Math.random().toString(36).substring(6)},Dte=function(e){var r=e.animate,t=e.backgroundColor,n=e.backgroundOpacity,i=e.baseUrl,a=e.children,o=e.foregroundColor,s=e.foregroundOpacity,u=e.gradientRatio,l=e.uniqueKey,f=e.interval,h=e.rtl,p=e.speed,v=e.style,m=e.title,x=$5e(e,["animate","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","uniqueKey","interval","rtl","speed","style","title"]),E=l||U5e(),A=E+"-diff",L=E+"-animated-diff",k=E+"-aria",R=h?{transform:"scaleX(-1)"}:null,D="0; "+f+"; 1",$=p+"s";return ut.exports.createElement("svg",W0({"aria-labelledby":k,role:"img",style:W0(W0({},v),R)},x),m?ut.exports.createElement("title",{id:k},m):null,ut.exports.createElement("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%",clipPath:"url("+i+"#"+A+")",style:{fill:"url("+i+"#"+L+")"}}),ut.exports.createElement("defs",{role:"presentation"},ut.exports.createElement("clipPath",{id:A},a),ut.exports.createElement("linearGradient",{id:L},ut.exports.createElement("stop",{offset:"0%",stopColor:t,stopOpacity:n},r&&ut.exports.createElement("animate",{attributeName:"offset",values:-u+"; "+-u+"; 1",keyTimes:D,dur:$,repeatCount:"indefinite"})),ut.exports.createElement("stop",{offset:"50%",stopColor:o,stopOpacity:s},r&&ut.exports.createElement("animate",{attributeName:"offset",values:-u/2+"; "+-u/2+"; "+(1+u/2),keyTimes:D,dur:$,repeatCount:"indefinite"})),ut.exports.createElement("stop",{offset:"100%",stopColor:t,stopOpacity:n},r&&ut.exports.createElement("animate",{attributeName:"offset",values:"0; 0; "+(1+u),keyTimes:D,dur:$,repeatCount:"indefinite"})))))};Dte.defaultProps={animate:!0,backgroundColor:"#f5f6f7",backgroundOpacity:1,baseUrl:"",foregroundColor:"#eee",foregroundOpacity:1,gradientRatio:2,id:null,interval:.25,rtl:!1,speed:1.2,style:{},title:"Loading..."};var Bte=function(e){return e.children?ut.exports.createElement(Dte,W0({},e)):ut.exports.createElement(V5e,W0({},e))},V5e=function(e){return ut.exports.createElement(Bte,W0({viewBox:"0 0 476 124"},e),ut.exports.createElement("rect",{x:"48",y:"8",width:"88",height:"6",rx:"3"}),ut.exports.createElement("rect",{x:"48",y:"26",width:"52",height:"6",rx:"3"}),ut.exports.createElement("rect",{x:"0",y:"56",width:"410",height:"6",rx:"3"}),ut.exports.createElement("rect",{x:"0",y:"72",width:"380",height:"6",rx:"3"}),ut.exports.createElement("rect",{x:"0",y:"88",width:"178",height:"6",rx:"3"}),ut.exports.createElement("circle",{cx:"20",cy:"20",r:"20"}))},Nte=Bte,G5e=function(e){var r=e.loadingTemplate,t=e.theme,n=t===void 0?"light":t,i=function(){return r||Is.createElement(Nte,{viewBox:"0 0 400 180",width:200,height:90,speed:1,backgroundColor:n==="dark"?"#262626":"#D9D9D9"},Is.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),Is.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),Is.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),Is.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),Is.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),Is.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),Is.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),Is.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),Is.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),Is.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return Is.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:n==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},i())},ik=G5e,H5e=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},j5e=ut.exports.forwardRef(function(e,r){var t=e.chartRef,n=e.style,i=n===void 0?{height:"inherit"}:n,a=e.className,o=e.loading,s=e.loadingTemplate,u=e.errorTemplate,l=H5e(e,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),f=rk(JJ,l),h=f.chart,p=f.container;return ut.exports.useEffect(function(){tk(t,h.current)},[h.current]),ut.exports.useImperativeHandle(r,function(){return{getChart:function(){return h.current}}}),_y(nk,{errorTemplate:u,children:[o&&oo(ik,{loadingTemplate:s,theme:e.theme}),oo("div",{className:a,style:i,ref:p})]})}),W5e=j5e,X5e=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},Y5e=ut.exports.forwardRef(function(e,r){var t=e.chartRef,n=e.style,i=n===void 0?{height:"inherit"}:n,a=e.className,o=e.loading,s=e.loadingTemplate,u=e.errorTemplate,l=X5e(e,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),f=rk(YJ,l),h=f.chart,p=f.container;return ut.exports.useEffect(function(){tk(t,h.current)},[h.current]),ut.exports.useImperativeHandle(r,function(){return{getChart:function(){return h.current}}}),_y(nk,{errorTemplate:u,children:[o&&oo(ik,{loadingTemplate:s,theme:e.theme}),oo("div",{className:a,style:i,ref:p})]})}),Z5e=Y5e,q5e=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},K5e=ut.exports.forwardRef(function(e,r){var t=e.chartRef,n=e.style,i=n===void 0?{height:"inherit"}:n,a=e.className,o=e.loading,s=e.loadingTemplate,u=e.errorTemplate,l=q5e(e,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),f=rk(JPe,l),h=f.chart,p=f.container;return ut.exports.useEffect(function(){tk(t,h.current)},[h.current]),ut.exports.useImperativeHandle(r,function(){return{getChart:function(){return h.current}}}),_y(nk,{errorTemplate:u,children:[o&&oo(ik,{loadingTemplate:s,theme:e.theme}),oo("div",{className:a,style:i,ref:p})]})}),Q5e=K5e,J5e=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},eDe=ut.exports.forwardRef(function(e,r){var t=e.chartRef,n=e.style,i=n===void 0?{height:"inherit"}:n,a=e.className,o=e.loading,s=e.loadingTemplate,u=e.errorTemplate,l=J5e(e,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),f=rk(Cte,l),h=f.chart,p=f.container;return ut.exports.useEffect(function(){tk(t,h.current)},[h.current]),ut.exports.useImperativeHandle(r,function(){return{getChart:function(){return h.current}}}),_y(nk,{errorTemplate:u,children:[o&&oo(ik,{loadingTemplate:s,theme:e.theme}),oo("div",{className:a,style:i,ref:p})]})}),tDe=eDe;const rDe=()=>{const[e,r]=ut.exports.useState([]),t=()=>{fetch("https://gw.alipayobjects.com/os/bmw-prod/1d565782-dde4-4bb6-8946-ea6a38ccf184.json").then(i=>i.json()).then(i=>r(i)).catch(i=>{console.log("fetch data failed",i)})};return ut.exports.useEffect(()=>{t()},[]),oo(Z5e,{...{data:e,padding:"auto",xField:"Date",yField:"scales",xAxis:{tickCount:5},slider:{start:.1,end:.5}}})};var nDe=rDe,zte={},vB={};Object.defineProperty(vB,"__esModule",{value:!0});vB.default="0.0.13";var gB={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.unregisterIconFont=e.registerIconFonts=e.registerIconFont=e.ICON_FONT_CACHE=e.unregisterFontFace=e.registerFontFace=e.FONT_FACE_CACHE=e.unregisterImage=e.hasImage=e.getImage=e.registerImages=e.registerImage=e.IMAGES_CACHE=void 0,e.IMAGES_CACHE=new Map;function r(h,p){e.IMAGES_CACHE.set(h,p)}e.registerImage=r;function t(h){h.forEach(function(p){e.IMAGES_CACHE.set(p.id,p.image)})}e.registerImages=t;function n(h){return e.IMAGES_CACHE.get(h)}e.getImage=n;function i(h){return e.IMAGES_CACHE.has(h)}e.hasImage=i;function a(h){return e.IMAGES_CACHE.delete(h)}e.unregisterImage=a,e.FONT_FACE_CACHE=new Map;function o(h,p){e.FONT_FACE_CACHE.set(h,p)}e.registerFontFace=o;function s(h){return e.FONT_FACE_CACHE.delete(h)}e.unregisterFontFace=s,e.ICON_FONT_CACHE=new Map;function u(h,p){e.ICON_FONT_CACHE.set(h,p)}e.registerIconFont=u;function l(h){h.forEach(function(p){e.ICON_FONT_CACHE.set(p.name,p.fontUnicode)})}e.registerIconFonts=l;function f(h){return e.ICON_FONT_CACHE.delete(h)}e.unregisterIconFont=f})(gB);var a_={},Ps=ed(Bge),mB={},w2={},ak={},$te={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ITEM_TPL=e.CONTAINER_TPL=e.VALUE_CLASS=e.NAME_CLASS=e.LIST_ITEM_CLASS=e.LIST_CLASS=e.TITLE_CLASS=e.CONTAINER_CLASS=void 0,e.CONTAINER_CLASS="l7plot-tooltip",e.TITLE_CLASS="l7plot-tooltip__title",e.LIST_CLASS="l7plot-tooltip__list",e.LIST_ITEM_CLASS="l7plot-tooltip__list-item",e.NAME_CLASS="l7plot-tooltip__name",e.VALUE_CLASS="l7plot-tooltip__value",e.CONTAINER_TPL='<div class="'.concat(e.CONTAINER_CLASS,`">
  <div class="`).concat(e.TITLE_CLASS,`"></div>
  <ul class="`).concat(e.LIST_CLASS,`"></ul>
</div>`),e.ITEM_TPL='<li class="'.concat(e.LIST_ITEM_CLASS,`" data-index={index}>
  <span class="`).concat(e.NAME_CLASS,`">{name}</span>
  <span class="`).concat(e.VALUE_CLASS,`">{value}</span>
</li>`)})($te);var Ute={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ITEM_TPL=e.CONTAINER_TPL=e.VALUE_CLASS=e.MARKER_CLASS=e.LIST_ITEM_CLASS=e.LIST_CLASS=e.TITLE_CLASS=e.CONTAINER_CLASS=void 0,e.CONTAINER_CLASS="l7plot-legend l7plot-legend__category",e.TITLE_CLASS="l7plot-legend__title",e.LIST_CLASS="l7plot-legend__category-list",e.LIST_ITEM_CLASS="l7plot-legend__list-item",e.MARKER_CLASS="l7plot-legend__category-marker",e.VALUE_CLASS="l7plot-legend__category-value",e.CONTAINER_TPL='<div class="'.concat(e.CONTAINER_CLASS,`">
  <div class="`).concat(e.TITLE_CLASS,`"></div>
  <ul class="`).concat(e.LIST_CLASS,`"></ul>
</div>`),e.ITEM_TPL='<li class="'.concat(e.LIST_ITEM_CLASS,`" data-index={index}>
  <span class="`).concat(e.MARKER_CLASS,`" style="background:{color}"></span>
  <span class="`).concat(e.VALUE_CLASS,`">{value}</span>
</li>`)})(Ute);var Vte={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RIBBON_TPL=e.CONTAINER_TPL=e.VALUE_RANGE_CLASS=e.GRADIENT_BAR_CLASS=e.RIBBON_CLASS=e.RIBBON_CONTAINER_CLASS=e.TITLE_CLASS=e.CONTAINER_CLASS=void 0,e.CONTAINER_CLASS="l7plot-legend l7plot-legend__continue",e.TITLE_CLASS="l7plot-legend__title",e.RIBBON_CONTAINER_CLASS="l7plot-legend__ribbon-container",e.RIBBON_CLASS="l7plot-legend__ribbon",e.GRADIENT_BAR_CLASS="l7plot-legend__gradient-bar",e.VALUE_RANGE_CLASS="l7plot-legend__value-range",e.CONTAINER_TPL='<div class="'.concat(e.CONTAINER_CLASS,`">
  <div class="`).concat(e.TITLE_CLASS,`"></div>
  <div class="`).concat(e.RIBBON_CONTAINER_CLASS,`"></div>
</div>`),e.RIBBON_TPL='<div class="'.concat(e.RIBBON_CLASS,`">
  <span class="`).concat(e.VALUE_RANGE_CLASS,`">{min}</span>
  <div class="`).concat(e.GRADIENT_BAR_CLASS,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(e.VALUE_RANGE_CLASS,`">{max}</span>
</div>`)})(Vte);Object.defineProperty(ak,"__esModule",{value:!0});ak.createThemeByStyleSheet=void 0;var yB=mi.exports,vb=yB.__importStar($te),gb=yB.__importStar(Ute),Vw=yB.__importStar(Vte);function iDe(e){var r,t,n,i={point:{default:{fill:e.pointFillColor,size:e.pointSize,stroke:e.pointBorderColor,lineWidth:e.pointBorder,fillOpacity:e.pointFillOpacity},active:{fill:e.pointActiveFillColor},selected:{fill:e.pointSelectedFillColor}}};return{mapStyle:e.mapStyle,defaultColor:e.brandColor,subColor:e.subColor,semanticRed:e.paletteSemanticRed,semanticGreen:e.paletteSemanticGreen,fontFamily:e.fontFamily,colors10:e.paletteQualitative10,colors20:e.paletteQualitative20,sequenceColors:e.paletteSequence,shapes:{point:["circle","square"],line:["line"]},sizes:[1,10],geometries:{point:{circle:{default:{style:i.point.default},active:{style:i.point.active},selected:{style:i.point.selected}}},line:{},polygon:{}},components:{legend:{category:{domStyles:(r={},r[gb.CONTAINER_CLASS]={visibility:"visible",zIndex:1,backgroundColor:e.legendContainerFillColor,boxShadow:e.legendContainerShadow,borderRadius:"".concat(e.legendContainerBorderRadius,"px"),color:e.legendTextFillColor,fontFamily:e.fontFamily,padding:"10px",lineHeight:"1",fontSize:"".concat(e.legendTextFontSize,"px")},r[gb.TITLE_CLASS]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},r[gb.LIST_CLASS]={margin:"0px",padding:"0px"},r[gb.LIST_ITEM_CLASS]={marginBottom:"2px"},r[gb.MARKER_CLASS]={width:"10px",height:"10px"},r[gb.VALUE_CLASS]={paddingLeft:"8px"},r)},continue:{domStyles:(t={},t[Vw.CONTAINER_CLASS]={visibility:"visible",zIndex:1,backgroundColor:e.legendContainerFillColor,boxShadow:e.legendContainerShadow,borderRadius:"".concat(e.legendContainerBorderRadius,"px"),color:e.legendTextFillColor,fontFamily:e.fontFamily,padding:"10px",lineHeight:1,fontSize:"".concat(e.legendTextFontSize,"px")},t[Vw.TITLE_CLASS]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},t[Vw.RIBBON_CLASS]={display:"flex",alignItems:"center"},t[Vw.GRADIENT_BAR_CLASS]={width:"140px",height:"14px",margin:"0px 5px"},t[Vw.VALUE_RANGE_CLASS]={padding:"0px"},t)}},tooltip:{domStyles:(n={},n[vb.CONTAINER_CLASS]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:e.tooltipContainerFillColor,boxShadow:e.tooltipContainerShadow,borderRadius:"".concat(e.tooltipContainerBorderRadius,"px"),color:e.tooltipTextFillColor,fontSize:"".concat(e.tooltipTextFontSize,"px"),fontFamily:e.fontFamily,lineHeight:e.tooltipTextLineHeight},n[vb.TITLE_CLASS]={marginBottom:"4px"},n[vb.LIST_CLASS]={margin:"0px",padding:"0px"},n[vb.LIST_ITEM_CLASS]={marginBottom:"4px"},n[vb.NAME_CLASS]={color:e.tooltipItemNameFillColor},n[vb.VALUE_CLASS]={color:e.tooltipItemValueFillColor,marginLeft:"30px"},n)},label:{style:{textAnchor:"center",textOffset:[0,0],fill:e.labelFillColor,fontSize:e.labelFontSize,fontFamily:e.fontFamily,fillColorDark:e.labelFillColorDark,fillColorLight:e.labelFillColorLight}}}}}ak.createThemeByStyleSheet=iDe;var Gte={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.light=e.createLightStyleSheet=void 0;var r={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},t={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},n=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],i=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],a=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],o=function(s){s===void 0&&(s={});var u=s.mapStyle,l=u===void 0?"light":u,f=s.subColor,h=f===void 0?"rgba(0,0,0,0.05)":f,p=s.paletteQualitative10,v=p===void 0?n:p,m=s.paletteQualitative20,x=m===void 0?i:m,E=s.paletteSemanticRed,A=E===void 0?"#F4664A":E,L=s.paletteSemanticGreen,k=L===void 0?"#30BF78":L,R=s.paletteSemanticYellow,D=R===void 0?"#FAAD14":R,$=s.paletteSequence,j=$===void 0?a:$,H=s.fontFamily,ee=H===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:H,U=s.brandColor,W=U===void 0?v[0]:U;return{mapStyle:l,brandColor:W,subColor:h,paletteQualitative10:v,paletteQualitative20:x,paletteSemanticRed:A,paletteSemanticGreen:k,paletteSemanticYellow:D,paletteSequence:j,fontFamily:ee,legendContainerFillColor:"rgba(255, 255, 255, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:r[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(255, 255, 255, 0.9)",tooltipContainerShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",tooltipContainerBorderRadius:2,tooltipTextFillColor:r[65],tooltipItemNameFillColor:r[65],tooltipItemValueFillColor:r[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:r[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:W,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:t[100],pointActiveBorderColor:r[100],pointSelectedBorderColor:r[100]}};e.createLightStyleSheet=o,e.light=(0,e.createLightStyleSheet)()})(Gte);var Hte={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.dark=e.createDarkStyleSheet=void 0;var r={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},t={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},n=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],i=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],a=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],o=function(s){s===void 0&&(s={});var u=s.mapStyle,l=u===void 0?"dark":u,f=s.subColor,h=f===void 0?"rgba(255,255,255,0.05)":f,p=s.paletteQualitative10,v=p===void 0?n:p,m=s.paletteQualitative20,x=m===void 0?i:m,E=s.paletteSemanticRed,A=E===void 0?"#F4664A":E,L=s.paletteSemanticGreen,k=L===void 0?"#30BF78":L,R=s.paletteSemanticYellow,D=R===void 0?"#FAAD14":R,$=s.paletteSequence,j=$===void 0?a:$,H=s.fontFamily,ee=H===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:H,U=s.brandColor,W=U===void 0?v[0]:U;return{mapStyle:l,brandColor:W,subColor:h,paletteQualitative10:v,paletteQualitative20:x,paletteSemanticRed:A,paletteSemanticGreen:k,paletteSemanticYellow:D,paletteSequence:j,fontFamily:ee,legendContainerFillColor:"rgba(31, 31, 31, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:t[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(31, 31, 31, 0.9)",tooltipContainerShadow:"0px 2px 4px rgba(0, 0, 0, 0.5)",tooltipContainerBorderRadius:2,tooltipTextFillColor:t[65],tooltipItemNameFillColor:t[65],tooltipItemValueFillColor:t[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:t[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:n[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:r[100],pointActiveBorderColor:t[100],pointSelectedBorderColor:t[100]}};e.createDarkStyleSheet=o,e.dark=(0,e.createDarkStyleSheet)()})(Hte);Object.defineProperty(w2,"__esModule",{value:!0});w2.createDarkTheme=w2.createTheme=void 0;var jte=mi.exports,Wte=Ps,Xte=ak,aDe=Gte,oDe=Hte;function sDe(e){var r=e.styleSheet,t=r===void 0?{}:r,n=jte.__rest(e,["styleSheet"]),i=(0,aDe.createLightStyleSheet)(t);return(0,Wte.deepMix)({},(0,Xte.createThemeByStyleSheet)(i),n)}w2.createTheme=sDe;function uDe(e){var r=e.styleSheet,t=r===void 0?{}:r,n=jte.__rest(e,["styleSheet"]),i=(0,oDe.createDarkStyleSheet)(t);return(0,Wte.deepMix)({},(0,Xte.createThemeByStyleSheet)(i),n)}w2.createDarkTheme=uDe;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createDarkTheme=e.createTheme=void 0;var r=w2;Object.defineProperty(e,"createTheme",{enumerable:!0,get:function(){return r.createTheme}}),Object.defineProperty(e,"createDarkTheme",{enumerable:!0,get:function(){return r.createDarkTheme}})})(mB);Object.defineProperty(a_,"__esModule",{value:!0});a_.registerTheme=a_.getTheme=void 0;var $5=Ps,iL=mB,t$=(0,iL.createTheme)({}),lDe=(0,iL.createDarkTheme)({}),U5={default:t$,light:t$,dark:lDe};function cDe(e){return e===void 0&&(e="default"),(0,$5.get)(U5,(0,$5.lowerCase)(e),U5.default)}a_.getTheme=cDe;function fDe(e,r,t){t===void 0&&(t="light"),U5[(0,$5.lowerCase)(e)]=t==="light"?(0,iL.createTheme)(r):(0,iL.createDarkTheme)(r)}a_.registerTheme=fDe;var w1={},Yte={};/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var r$;(function(e){(function(r){var t=typeof jp=="object"?jp:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(e);typeof t.Reflect=="undefined"?t.Reflect=e:n=i(t.Reflect,n),r(n);function i(a,o){return function(s,u){typeof a[s]!="function"&&Object.defineProperty(a,s,{configurable:!0,writable:!0,value:u}),o&&o(s,u)}}})(function(r){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",s={__proto__:[]}instanceof Array,u=!o&&!s,l={create:o?function(){return Ro(Object.create(null))}:s?function(){return Ro({__proto__:null})}:function(){return Ro({})},has:u?function(ne,Qt){return t.call(ne,Qt)}:function(ne,Qt){return Qt in ne},get:u?function(ne,Qt){return t.call(ne,Qt)?ne[Qt]:void 0}:function(ne,Qt){return ne[Qt]}},f=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",p=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Va(),v=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:to(),m=!h&&typeof WeakMap=="function"?WeakMap:Os(),x=new m;function E(ne,Qt,gr,hn){if(dt(gr)){if(!nn(ne))throw new TypeError;if(!zt(Qt))throw new TypeError;return U(ne,Qt)}else{if(!nn(ne))throw new TypeError;if(!It(Qt))throw new TypeError;if(!It(hn)&&!dt(hn)&&!ct(hn))throw new TypeError;return ct(hn)&&(hn=void 0),gr=Zt(gr),W(ne,Qt,gr,hn)}}r("decorate",E);function A(ne,Qt){function gr(hn,$n){if(!It(hn))throw new TypeError;if(!dt($n)&&!Vr($n))throw new TypeError;Re(ne,Qt,hn,$n)}return gr}r("metadata",A);function L(ne,Qt,gr,hn){if(!It(gr))throw new TypeError;return dt(hn)||(hn=Zt(hn)),Re(ne,Qt,gr,hn)}r("defineMetadata",L);function k(ne,Qt,gr){if(!It(Qt))throw new TypeError;return dt(gr)||(gr=Zt(gr)),te(ne,Qt,gr)}r("hasMetadata",k);function R(ne,Qt,gr){if(!It(Qt))throw new TypeError;return dt(gr)||(gr=Zt(gr)),ie(ne,Qt,gr)}r("hasOwnMetadata",R);function D(ne,Qt,gr){if(!It(Qt))throw new TypeError;return dt(gr)||(gr=Zt(gr)),ve(ne,Qt,gr)}r("getMetadata",D);function $(ne,Qt,gr){if(!It(Qt))throw new TypeError;return dt(gr)||(gr=Zt(gr)),me(ne,Qt,gr)}r("getOwnMetadata",$);function j(ne,Qt){if(!It(ne))throw new TypeError;return dt(Qt)||(Qt=Zt(Qt)),We(ne,Qt)}r("getMetadataKeys",j);function H(ne,Qt){if(!It(ne))throw new TypeError;return dt(Qt)||(Qt=Zt(Qt)),je(ne,Qt)}r("getOwnMetadataKeys",H);function ee(ne,Qt,gr){if(!It(Qt))throw new TypeError;dt(gr)||(gr=Zt(gr));var hn=Q(Qt,gr,!1);if(dt(hn)||!hn.delete(ne))return!1;if(hn.size>0)return!0;var $n=x.get(Qt);return $n.delete(gr),$n.size>0||x.delete(Qt),!0}r("deleteMetadata",ee);function U(ne,Qt){for(var gr=ne.length-1;gr>=0;--gr){var hn=ne[gr],$n=hn(Qt);if(!dt($n)&&!ct($n)){if(!zt($n))throw new TypeError;Qt=$n}}return Qt}function W(ne,Qt,gr,hn){for(var $n=ne.length-1;$n>=0;--$n){var Ta=ne[$n],Qn=Ta(Qt,gr,hn);if(!dt(Qn)&&!ct(Qn)){if(!It(Qn))throw new TypeError;hn=Qn}}return hn}function Q(ne,Qt,gr){var hn=x.get(ne);if(dt(hn)){if(!gr)return;hn=new p,x.set(ne,hn)}var $n=hn.get(Qt);if(dt($n)){if(!gr)return;$n=new p,hn.set(Qt,$n)}return $n}function te(ne,Qt,gr){var hn=ie(ne,Qt,gr);if(hn)return!0;var $n=va(Qt);return ct($n)?!1:te(ne,$n,gr)}function ie(ne,Qt,gr){var hn=Q(Qt,gr,!1);return dt(hn)?!1:wn(hn.has(ne))}function ve(ne,Qt,gr){var hn=ie(ne,Qt,gr);if(hn)return me(ne,Qt,gr);var $n=va(Qt);if(!ct($n))return ve(ne,$n,gr)}function me(ne,Qt,gr){var hn=Q(Qt,gr,!1);if(!dt(hn))return hn.get(ne)}function Re(ne,Qt,gr,hn){var $n=Q(gr,hn,!0);$n.set(ne,Qt)}function We(ne,Qt){var gr=je(ne,Qt),hn=va(ne);if(hn===null)return gr;var $n=We(hn,Qt);if($n.length<=0)return gr;if(gr.length<=0)return $n;for(var Ta=new v,Qn=[],ci=0,Wn=gr;ci<Wn.length;ci++){var Ti=Wn[ci],Li=Ta.has(Ti);Li||(Ta.add(Ti),Qn.push(Ti))}for(var Oo=0,Fo=$n;Oo<Fo.length;Oo++){var Ti=Fo[Oo],Li=Ta.has(Ti);Li||(Ta.add(Ti),Qn.push(Ti))}return Qn}function je(ne,Qt){var gr=[],hn=Q(ne,Qt,!1);if(dt(hn))return gr;for(var $n=hn.keys(),Ta=Si($n),Qn=0;;){var ci=Ai(Ta);if(!ci)return gr.length=Qn,gr;var Wn=Fn(ci);try{gr[Qn]=Wn}catch(Ti){try{Ua(Ta)}finally{throw Ti}}Qn++}}function lt(ne){if(ne===null)return 1;switch(typeof ne){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return ne===null?1:6;default:return 6}}function dt(ne){return ne===void 0}function ct(ne){return ne===null}function Tt(ne){return typeof ne=="symbol"}function It(ne){return typeof ne=="object"?ne!==null:typeof ne=="function"}function Lt(ne,Qt){switch(lt(ne)){case 0:return ne;case 1:return ne;case 2:return ne;case 3:return ne;case 4:return ne;case 5:return ne}var gr=Qt===3?"string":Qt===5?"number":"default",hn=On(ne,i);if(hn!==void 0){var $n=hn.call(ne,gr);if(It($n))throw new TypeError;return $n}return rn(ne,gr==="default"?"number":gr)}function rn(ne,Qt){if(Qt==="string"){var gr=ne.toString;if(mn(gr)){var hn=gr.call(ne);if(!It(hn))return hn}var $n=ne.valueOf;if(mn($n)){var hn=$n.call(ne);if(!It(hn))return hn}}else{var $n=ne.valueOf;if(mn($n)){var hn=$n.call(ne);if(!It(hn))return hn}var Ta=ne.toString;if(mn(Ta)){var hn=Ta.call(ne);if(!It(hn))return hn}}throw new TypeError}function wn(ne){return!!ne}function zn(ne){return""+ne}function Zt(ne){var Qt=Lt(ne,3);return Tt(Qt)?Qt:zn(Qt)}function nn(ne){return Array.isArray?Array.isArray(ne):ne instanceof Object?ne instanceof Array:Object.prototype.toString.call(ne)==="[object Array]"}function mn(ne){return typeof ne=="function"}function zt(ne){return typeof ne=="function"}function Vr(ne){switch(lt(ne)){case 3:return!0;case 4:return!0;default:return!1}}function On(ne,Qt){var gr=ne[Qt];if(gr!=null){if(!mn(gr))throw new TypeError;return gr}}function Si(ne){var Qt=On(ne,a);if(!mn(Qt))throw new TypeError;var gr=Qt.call(ne);if(!It(gr))throw new TypeError;return gr}function Fn(ne){return ne.value}function Ai(ne){var Qt=ne.next();return Qt.done?!1:Qt}function Ua(ne){var Qt=ne.return;Qt&&Qt.call(ne)}function va(ne){var Qt=Object.getPrototypeOf(ne);if(typeof ne!="function"||ne===f||Qt!==f)return Qt;var gr=ne.prototype,hn=gr&&Object.getPrototypeOf(gr);if(hn==null||hn===Object.prototype)return Qt;var $n=hn.constructor;return typeof $n!="function"||$n===ne?Qt:$n}function Va(){var ne={},Qt=[],gr=function(){function Qn(ci,Wn,Ti){this._index=0,this._keys=ci,this._values=Wn,this._selector=Ti}return Qn.prototype["@@iterator"]=function(){return this},Qn.prototype[a]=function(){return this},Qn.prototype.next=function(){var ci=this._index;if(ci>=0&&ci<this._keys.length){var Wn=this._selector(this._keys[ci],this._values[ci]);return ci+1>=this._keys.length?(this._index=-1,this._keys=Qt,this._values=Qt):this._index++,{value:Wn,done:!1}}return{value:void 0,done:!0}},Qn.prototype.throw=function(ci){throw this._index>=0&&(this._index=-1,this._keys=Qt,this._values=Qt),ci},Qn.prototype.return=function(ci){return this._index>=0&&(this._index=-1,this._keys=Qt,this._values=Qt),{value:ci,done:!0}},Qn}();return function(){function Qn(){this._keys=[],this._values=[],this._cacheKey=ne,this._cacheIndex=-2}return Object.defineProperty(Qn.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Qn.prototype.has=function(ci){return this._find(ci,!1)>=0},Qn.prototype.get=function(ci){var Wn=this._find(ci,!1);return Wn>=0?this._values[Wn]:void 0},Qn.prototype.set=function(ci,Wn){var Ti=this._find(ci,!0);return this._values[Ti]=Wn,this},Qn.prototype.delete=function(ci){var Wn=this._find(ci,!1);if(Wn>=0){for(var Ti=this._keys.length,Li=Wn+1;Li<Ti;Li++)this._keys[Li-1]=this._keys[Li],this._values[Li-1]=this._values[Li];return this._keys.length--,this._values.length--,ci===this._cacheKey&&(this._cacheKey=ne,this._cacheIndex=-2),!0}return!1},Qn.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=ne,this._cacheIndex=-2},Qn.prototype.keys=function(){return new gr(this._keys,this._values,hn)},Qn.prototype.values=function(){return new gr(this._keys,this._values,$n)},Qn.prototype.entries=function(){return new gr(this._keys,this._values,Ta)},Qn.prototype["@@iterator"]=function(){return this.entries()},Qn.prototype[a]=function(){return this.entries()},Qn.prototype._find=function(ci,Wn){return this._cacheKey!==ci&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=ci)),this._cacheIndex<0&&Wn&&(this._cacheIndex=this._keys.length,this._keys.push(ci),this._values.push(void 0)),this._cacheIndex},Qn}();function hn(Qn,ci){return Qn}function $n(Qn,ci){return ci}function Ta(Qn,ci){return[Qn,ci]}}function to(){return function(){function ne(){this._map=new p}return Object.defineProperty(ne.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ne.prototype.has=function(Qt){return this._map.has(Qt)},ne.prototype.add=function(Qt){return this._map.set(Qt,Qt),this},ne.prototype.delete=function(Qt){return this._map.delete(Qt)},ne.prototype.clear=function(){this._map.clear()},ne.prototype.keys=function(){return this._map.keys()},ne.prototype.values=function(){return this._map.values()},ne.prototype.entries=function(){return this._map.entries()},ne.prototype["@@iterator"]=function(){return this.keys()},ne.prototype[a]=function(){return this.keys()},ne}()}function Os(){var ne=16,Qt=l.create(),gr=hn();return function(){function Wn(){this._key=hn()}return Wn.prototype.has=function(Ti){var Li=$n(Ti,!1);return Li!==void 0?l.has(Li,this._key):!1},Wn.prototype.get=function(Ti){var Li=$n(Ti,!1);return Li!==void 0?l.get(Li,this._key):void 0},Wn.prototype.set=function(Ti,Li){var Oo=$n(Ti,!0);return Oo[this._key]=Li,this},Wn.prototype.delete=function(Ti){var Li=$n(Ti,!1);return Li!==void 0?delete Li[this._key]:!1},Wn.prototype.clear=function(){this._key=hn()},Wn}();function hn(){var Wn;do Wn="@@WeakMap@@"+ci();while(l.has(Qt,Wn));return Qt[Wn]=!0,Wn}function $n(Wn,Ti){if(!t.call(Wn,gr)){if(!Ti)return;Object.defineProperty(Wn,gr,{value:l.create()})}return Wn[gr]}function Ta(Wn,Ti){for(var Li=0;Li<Ti;++Li)Wn[Li]=Math.random()*255|0;return Wn}function Qn(Wn){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Wn)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Wn)):Ta(new Uint8Array(Wn),Wn):Ta(new Array(Wn),Wn)}function ci(){var Wn=Qn(ne);Wn[6]=Wn[6]&79|64,Wn[8]=Wn[8]&191|128;for(var Ti="",Li=0;Li<ne;++Li){var Oo=Wn[Li];(Li===4||Li===6||Li===8)&&(Ti+="-"),Oo<16&&(Ti+="0"),Ti+=Oo.toString(16).toLowerCase()}return Ti}}function Ro(ne){return ne.__=void 0,delete ne.__,ne}})})(r$||(r$={}));var zf={exports:{}};(function(e){var r=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(u,l,f){this.fn=u,this.context=l,this.once=f||!1}function a(u,l,f,h,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new i(f,h||u,p),m=t?t+l:l;return u._events[m]?u._events[m].fn?u._events[m]=[u._events[m],v]:u._events[m].push(v):(u._events[m]=v,u._eventsCount++),u}function o(u,l){--u._eventsCount===0?u._events=new n:delete u._events[l]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],f,h;if(this._eventsCount===0)return l;for(h in f=this._events)r.call(f,h)&&l.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},s.prototype.listeners=function(l){var f=t?t+l:l,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,v=h.length,m=new Array(v);p<v;p++)m[p]=h[p].fn;return m},s.prototype.listenerCount=function(l){var f=t?t+l:l,h=this._events[f];return h?h.fn?1:h.length:0},s.prototype.emit=function(l,f,h,p,v,m){var x=t?t+l:l;if(!this._events[x])return!1;var E=this._events[x],A=arguments.length,L,k;if(E.fn){switch(E.once&&this.removeListener(l,E.fn,void 0,!0),A){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,f),!0;case 3:return E.fn.call(E.context,f,h),!0;case 4:return E.fn.call(E.context,f,h,p),!0;case 5:return E.fn.call(E.context,f,h,p,v),!0;case 6:return E.fn.call(E.context,f,h,p,v,m),!0}for(k=1,L=new Array(A-1);k<A;k++)L[k-1]=arguments[k];E.fn.apply(E.context,L)}else{var R=E.length,D;for(k=0;k<R;k++)switch(E[k].once&&this.removeListener(l,E[k].fn,void 0,!0),A){case 1:E[k].fn.call(E[k].context);break;case 2:E[k].fn.call(E[k].context,f);break;case 3:E[k].fn.call(E[k].context,f,h);break;case 4:E[k].fn.call(E[k].context,f,h,p);break;default:if(!L)for(D=1,L=new Array(A-1);D<A;D++)L[D-1]=arguments[D];E[k].fn.apply(E[k].context,L)}}return!0},s.prototype.on=function(l,f,h){return a(this,l,f,h,!1)},s.prototype.once=function(l,f,h){return a(this,l,f,h,!0)},s.prototype.removeListener=function(l,f,h,p){var v=t?t+l:l;if(!this._events[v])return this;if(!f)return o(this,v),this;var m=this._events[v];if(m.fn)m.fn===f&&(!p||m.once)&&(!h||m.context===h)&&o(this,v);else{for(var x=0,E=[],A=m.length;x<A;x++)(m[x].fn!==f||p&&!m[x].once||h&&m[x].context!==h)&&E.push(m[x]);E.length?this._events[v]=E.length===1?E[0]:E:o(this,v)}return this},s.prototype.removeAllListeners=function(l){var f;return l?(f=t?t+l:l,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=t,s.EventEmitter=s,e.exports=s})(zf);var _B=zf.exports,jg="named",Zte="name",xB="unmanaged",qte="optional",ok="inject",TE="multi_inject",Kte="inversify:tagged",Qte="inversify:tagged_props",V5="inversify:paramtypes",hDe="design:paramtypes",GC="post_construct";function pDe(){return[ok,TE,Zte,xB,jg,qte]}var n$=pDe(),lf={Request:"Request",Singleton:"Singleton",Transient:"Transient"},uf={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},uy={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},dDe=0;function AS(){return dDe++}var vDe=function(){function e(r,t){this.id=AS(),this.activated=!1,this.serviceIdentifier=r,this.scope=t,this.type=uf.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var r=new e(this.serviceIdentifier,this.scope);return r.activated=r.scope===lf.Singleton?this.activated:!1,r.implementationType=this.implementationType,r.dynamicValue=this.dynamicValue,r.scope=this.scope,r.type=this.type,r.factory=this.factory,r.provider=this.provider,r.constraint=this.constraint,r.onActivation=this.onActivation,r.cache=this.cache,r},e}(),gDe="Cannot apply @injectable decorator multiple times.",mDe="Metadata key was used more than once in a parameter:",Gw="NULL argument",i$="Key Not Found",yDe="Ambiguous match found for serviceIdentifier:",_De="Could not unbind serviceIdentifier:",xDe="No matching bindings found for serviceIdentifier:",bDe="Missing required @injectable annotation in:",wDe="Missing required @inject or @multiInject annotation in:",CDe=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},EDe="Circular dependency found:",SDe="Invalid binding type:",ADe="No snapshot available to restore.",TDe="Invalid return type in middleware. Middleware must return!",MDe="Value provided to function binding must be a function!",LDe="The toSelf function can only be applied when a constructor is used as service identifier",IDe="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",kDe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return"The number of constructor arguments in the derived class "+(e[0]+" must be >= than the number of constructor arguments of its base class.")},PDe="Invalid Container constructor argument. Container options must be an object.",RDe="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",ODe="Invalid Container option. Auto bind injectable must be a boolean",FDe="Invalid Container option. Skip base check must be a boolean",DDe="Cannot apply @postConstruct decorator multiple times in the same class",BDe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return"@postConstruct error in class "+e[0]+": "+e[1]},NDe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return"It looks like there is a circular dependency "+("in one of the '"+e[0]+"' bindings. Please investigate bindings with")+("service identifier '"+e[1]+"'.")},zDe="Maximum call stack size exceeded",$De=function(){function e(){}return e.prototype.getConstructorMetadata=function(r){var t=Reflect.getMetadata(V5,r),n=Reflect.getMetadata(Kte,r);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},e.prototype.getPropertiesMetadata=function(r){var t=Reflect.getMetadata(Qte,r)||[];return t},e}(),sM={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function Jte(e){return e instanceof RangeError||e.message===zDe}function ME(e){if(typeof e=="function"){var r=e;return r.name}else{if(typeof e=="symbol")return e.toString();var r=e;return r}}function a$(e,r,t){var n="",i=t(e,r);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(a){var o="Object";a.implementationType!==null&&(o=sk(a.implementationType)),n=n+`
 `+o,a.constraint.metaData&&(n=n+" - "+a.constraint.metaData)})),n}function ere(e,r){return e.parentRequest===null?!1:e.parentRequest.serviceIdentifier===r?!0:ere(e.parentRequest,r)}function UDe(e){function r(n,i){i===void 0&&(i=[]);var a=ME(n.serviceIdentifier);return i.push(a),n.parentRequest!==null?r(n.parentRequest,i):i}var t=r(e);return t.reverse().join(" --> ")}function tre(e){e.childRequests.forEach(function(r){if(ere(r,r.serviceIdentifier)){var t=UDe(r);throw new Error(EDe+" "+t)}else tre(r)})}function VDe(e,r){if(r.isTagged()||r.isNamed()){var t="",n=r.getNamedTag(),i=r.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(a){t+=a.toString()+`
`})," "+e+`
 `+e+" - "+t}else return" "+e}function sk(e){if(e.name)return e.name;var r=e.toString(),t=r.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+r}var rre=function(){function e(r){this.id=AS(),this.container=r}return e.prototype.addPlan=function(r){this.plan=r},e.prototype.setCurrentRequest=function(r){this.currentRequest=r},e}(),o_=function(){function e(r,t){this.key=r,this.value=t}return e.prototype.toString=function(){return this.key===jg?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}(),GDe=function(){function e(r,t){this.parentContext=r,this.rootRequest=t}return e}();function HDe(e,r,t,n){var i=Kte;nre(i,e,r,n,t)}function jDe(e,r,t){var n=Qte;nre(n,e.constructor,r,t)}function nre(e,r,t,n,i){var a={},o=typeof i=="number",s=i!==void 0&&o?i.toString():t;if(o&&t!==void 0)throw new Error(IDe);Reflect.hasOwnMetadata(e,r)&&(a=Reflect.getMetadata(e,r));var u=a[s];if(!Array.isArray(u))u=[];else for(var l=0,f=u;l<f.length;l++){var h=f[l];if(h.key===n.key)throw new Error(mDe+" "+h.key.toString())}u.push(n),a[s]=u,Reflect.defineMetadata(e,a,r)}function o$(e,r){Reflect.decorate(e,r)}function WDe(e,r){return function(t,n){r(t,n,e)}}function XDe(e,r,t){typeof t=="number"?o$([WDe(t,e)],r):typeof t=="string"?Reflect.decorate([e],r,t):o$([e],r)}var YDe=function(){function e(r){this._cb=r}return e.prototype.unwrap=function(){return this._cb()},e}();function ba(e){return function(r,t,n){if(e===void 0)throw new Error(CDe(r.name));var i=new o_(ok,e);typeof n=="number"?HDe(r,t,n,i):jDe(r,t,i)}}var ZDe=function(){function e(r){this.str=r}return e.prototype.startsWith=function(r){return this.str.indexOf(r)===0},e.prototype.endsWith=function(r){var t="",n=r.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(r){return this.str.indexOf(r)!==-1},e.prototype.equals=function(r){return this.str===r},e.prototype.value=function(){return this.str},e}(),uk=function(){function e(r,t,n,i){this.id=AS(),this.type=r,this.serviceIdentifier=n,this.name=new ZDe(t||""),this.metadata=new Array;var a=null;typeof i=="string"?a=new o_(jg,i):i instanceof o_&&(a=i),a!==null&&this.metadata.push(a)}return e.prototype.hasTag=function(r){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===r)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(TE)},e.prototype.matchesArray=function(r){return this.matchesTag(TE)(r)},e.prototype.isNamed=function(){return this.hasTag(jg)},e.prototype.isTagged=function(){return this.metadata.some(function(r){return n$.every(function(t){return r.key!==t})})},e.prototype.isOptional=function(){return this.matchesTag(qte)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(r){return r.key===jg})[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(r){return n$.every(function(t){return r.key!==t})}):null},e.prototype.matchesNamedTag=function(r){return this.matchesTag(jg)(r)},e.prototype.matchesTag=function(r){var t=this;return function(n){for(var i=0,a=t.metadata;i<a.length;i++){var o=a[i];if(o.key===r&&o.value===n)return!0}return!1}},e}(),aL=globalThis&&globalThis.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};function qDe(e,r){var t=sk(r),n=ire(e,t,r,!1);return n}function ire(e,r,t,n){var i=e.getConstructorMetadata(t),a=i.compilerGeneratedMetadata;if(a===void 0){var o=bDe+" "+r+".";throw new Error(o)}var s=i.userGeneratedMetadata,u=Object.keys(s),l=t.length===0&&u.length>0,f=u.length>t.length,h=l||f?u.length:t.length,p=QDe(n,r,a,s,h),v=are(e,t),m=aL(aL([],p),v);return m}function KDe(e,r,t,n,i){var a=i[e.toString()]||[],o=sre(a),s=o.unmanaged!==!0,u=n[e],l=o.inject||o.multiInject;if(u=l||u,u instanceof YDe&&(u=u.unwrap()),s){var f=u===Object,h=u===Function,p=u===void 0,v=f||h||p;if(!r&&v){var m=wDe+" argument "+e+" in class "+t+".";throw new Error(m)}var x=new uk(uy.ConstructorArgument,o.targetName,u);return x.metadata=a,x}return null}function QDe(e,r,t,n,i){for(var a=[],o=0;o<i;o++){var s=o,u=KDe(s,e,r,t,n);u!==null&&a.push(u)}return a}function are(e,r){for(var t=e.getPropertiesMetadata(r),n=[],i=Object.keys(t),a=0,o=i;a<o.length;a++){var s=o[a],u=t[s],l=sre(t[s]),f=l.targetName||s,h=l.inject||l.multiInject,p=new uk(uy.ClassProperty,f,h);p.metadata=u,n.push(p)}var v=Object.getPrototypeOf(r.prototype).constructor;if(v!==Object){var m=are(e,v);n=aL(aL([],n),m)}return n}function ore(e,r){var t=Object.getPrototypeOf(r.prototype).constructor;if(t!==Object){var n=sk(t),i=ire(e,n,t,!0),a=i.map(function(u){return u.metadata.filter(function(l){return l.key===xB})}),o=[].concat.apply([],a).length,s=i.length-o;return s>0?s:ore(e,t)}else return 0}function sre(e){var r={};return e.forEach(function(t){r[t.key.toString()]=t.value}),{inject:r[ok],multiInject:r[TE],targetName:r[Zte],unmanaged:r[xB]}}var bB=function(){function e(r,t,n,i,a){this.id=AS(),this.serviceIdentifier=r,this.parentContext=t,this.parentRequest=n,this.target=a,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return e.prototype.addChildRequest=function(r,t,n){var i=new e(r,this.parentContext,this,t,n);return this.childRequests.push(i),i},e}();function G5(e){return e._bindingDictionary}function JDe(e,r,t,n,i,a){var o=e?TE:ok,s=new o_(o,t),u=new uk(r,n,t,s);if(i!==void 0){var l=new o_(i,a);u.metadata.push(l)}return u}function s$(e,r,t,n,i){var a=LE(t.container,i.serviceIdentifier),o=[];return a.length===sM.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),a=LE(t.container,i.serviceIdentifier)),r?o=a:o=a.filter(function(s){var u=new bB(s.serviceIdentifier,t,n,s,i);return s.constraint(u)}),e3e(i.serviceIdentifier,o,i,t.container),o}function e3e(e,r,t,n){switch(r.length){case sM.NoBindingsAvailable:if(t.isOptional())return r;var i=ME(e),a=xDe;throw a+=VDe(i,t),a+=a$(n,i,LE),new Error(a);case sM.OnlyOneBindingAvailable:if(!t.isArray())return r;case sM.MultipleBindingsAvailable:default:if(t.isArray())return r;var i=ME(e),a=yDe+" "+i;throw a+=a$(n,i,LE),new Error(a)}}function ure(e,r,t,n,i,a){var o,s;if(i===null){o=s$(e,r,n,null,a),s=new bB(t,n,null,o,a);var u=new GDe(n,s);n.addPlan(u)}else o=s$(e,r,n,i,a),s=i.addChildRequest(a.serviceIdentifier,o,a);o.forEach(function(l){var f=null;if(a.isArray())f=s.addChildRequest(l.serviceIdentifier,l,a);else{if(l.cache)return;f=s}if(l.type===uf.Instance&&l.implementationType!==null){var h=qDe(e,l.implementationType);if(!n.container.options.skipBaseClassChecks){var p=ore(e,l.implementationType);if(h.length<p){var v=kDe(sk(l.implementationType));throw new Error(v)}}h.forEach(function(m){ure(e,!1,m.serviceIdentifier,n,f,m)})}})}function LE(e,r){var t=[],n=G5(e);return n.hasKey(r)?t=n.get(r):e.parent!==null&&(t=LE(e.parent,r)),t}function t3e(e,r,t,n,i,a,o,s){s===void 0&&(s=!1);var u=new rre(r),l=JDe(t,n,i,"",a,o);try{return ure(e,s,i,u,null,l),u}catch(f){throw Jte(f)&&u.plan&&tre(u.plan.rootRequest),f}}function r3e(e,r,t,n){var i=new uk(uy.Variable,"",r,new o_(t,n)),a=new rre(e),o=new bB(r,a,null,[],i);return o}var n3e=globalThis&&globalThis.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};function i3e(e,r,t){var n=r.filter(function(a){return a.target!==null&&a.target.type===uy.ClassProperty}),i=n.map(t);return n.forEach(function(a,o){var s="";s=a.target.name.value();var u=i[o];e[s]=u}),e}function a3e(e,r){return new(e.bind.apply(e,n3e([void 0],r)))}function o3e(e,r){if(Reflect.hasMetadata(GC,e)){var t=Reflect.getMetadata(GC,e);try{r[t.value]()}catch(n){throw new Error(BDe(e.name,n.message))}}}function s3e(e,r,t){var n=null;if(r.length>0){var i=r.filter(function(o){return o.target!==null&&o.target.type===uy.ConstructorArgument}),a=i.map(t);n=a3e(e,a),n=i3e(n,r,t)}else n=new e;return o3e(e,n),n}var WR=function(e,r,t){try{return t()}catch(n){throw Jte(n)?new Error(NDe(e,r.toString())):n}},H5=function(e){return function(r){r.parentContext.setCurrentRequest(r);var t=r.bindings,n=r.childRequests,i=r.target&&r.target.isArray(),a=!r.parentRequest||!r.parentRequest.target||!r.target||!r.parentRequest.target.matchesArray(r.target.serviceIdentifier);if(i&&a)return n.map(function(h){var p=H5(e);return p(h)});var o=null;if(r.target.isOptional()&&t.length===0)return;var s=t[0],u=s.scope===lf.Singleton,l=s.scope===lf.Request;if(u&&s.activated)return s.cache;if(l&&e!==null&&e.has(s.id))return e.get(s.id);if(s.type===uf.ConstantValue)o=s.cache,s.activated=!0;else if(s.type===uf.Function)o=s.cache,s.activated=!0;else if(s.type===uf.Constructor)o=s.implementationType;else if(s.type===uf.DynamicValue&&s.dynamicValue!==null)o=WR("toDynamicValue",s.serviceIdentifier,function(){return s.dynamicValue(r.parentContext)});else if(s.type===uf.Factory&&s.factory!==null)o=WR("toFactory",s.serviceIdentifier,function(){return s.factory(r.parentContext)});else if(s.type===uf.Provider&&s.provider!==null)o=WR("toProvider",s.serviceIdentifier,function(){return s.provider(r.parentContext)});else if(s.type===uf.Instance&&s.implementationType!==null)o=s3e(s.implementationType,n,H5(e));else{var f=ME(r.serviceIdentifier);throw new Error(SDe+" "+f)}return typeof s.onActivation=="function"&&(o=s.onActivation(r.parentContext,o)),u&&(s.cache=o,s.activated=!0),l&&e!==null&&!e.has(s.id)&&e.set(s.id,o),o}};function u3e(e){var r=H5(e.plan.rootRequest.requestScope);return r(e.plan.rootRequest)}var Zm=function(e,r){var t=e.parentRequest;return t!==null?r(t)?!0:Zm(t,r):!1},EC=function(e){return function(r){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(e)(r)};return t.metaData=new o_(e,r),t}},oT=EC(jg),XR=function(e){return function(r){var t=null;if(r!==null)if(t=r.bindings[0],typeof e=="string"){var n=t.serviceIdentifier;return n===e}else{var i=r.bindings[0].implementationType;return e===i}return!1}},wB=function(){function e(r){this._binding=r}return e.prototype.when=function(r){return this._binding.constraint=r,new sf(this._binding)},e.prototype.whenTargetNamed=function(r){return this._binding.constraint=oT(r),new sf(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(r){var t=r.target!==null&&!r.target.isNamed()&&!r.target.isTagged();return t},new sf(this._binding)},e.prototype.whenTargetTagged=function(r,t){return this._binding.constraint=EC(r)(t),new sf(this._binding)},e.prototype.whenInjectedInto=function(r){return this._binding.constraint=function(t){return XR(r)(t.parentRequest)},new sf(this._binding)},e.prototype.whenParentNamed=function(r){return this._binding.constraint=function(t){return oT(r)(t.parentRequest)},new sf(this._binding)},e.prototype.whenParentTagged=function(r,t){return this._binding.constraint=function(n){return EC(r)(t)(n.parentRequest)},new sf(this._binding)},e.prototype.whenAnyAncestorIs=function(r){return this._binding.constraint=function(t){return Zm(t,XR(r))},new sf(this._binding)},e.prototype.whenNoAncestorIs=function(r){return this._binding.constraint=function(t){return!Zm(t,XR(r))},new sf(this._binding)},e.prototype.whenAnyAncestorNamed=function(r){return this._binding.constraint=function(t){return Zm(t,oT(r))},new sf(this._binding)},e.prototype.whenNoAncestorNamed=function(r){return this._binding.constraint=function(t){return!Zm(t,oT(r))},new sf(this._binding)},e.prototype.whenAnyAncestorTagged=function(r,t){return this._binding.constraint=function(n){return Zm(n,EC(r)(t))},new sf(this._binding)},e.prototype.whenNoAncestorTagged=function(r,t){return this._binding.constraint=function(n){return!Zm(n,EC(r)(t))},new sf(this._binding)},e.prototype.whenAnyAncestorMatches=function(r){return this._binding.constraint=function(t){return Zm(t,r)},new sf(this._binding)},e.prototype.whenNoAncestorMatches=function(r){return this._binding.constraint=function(t){return!Zm(t,r)},new sf(this._binding)},e}(),sf=function(){function e(r){this._binding=r}return e.prototype.onActivation=function(r){return this._binding.onActivation=r,new wB(this._binding)},e}(),I0=function(){function e(r){this._binding=r,this._bindingWhenSyntax=new wB(this._binding),this._bindingOnSyntax=new sf(this._binding)}return e.prototype.when=function(r){return this._bindingWhenSyntax.when(r)},e.prototype.whenTargetNamed=function(r){return this._bindingWhenSyntax.whenTargetNamed(r)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(r,t){return this._bindingWhenSyntax.whenTargetTagged(r,t)},e.prototype.whenInjectedInto=function(r){return this._bindingWhenSyntax.whenInjectedInto(r)},e.prototype.whenParentNamed=function(r){return this._bindingWhenSyntax.whenParentNamed(r)},e.prototype.whenParentTagged=function(r,t){return this._bindingWhenSyntax.whenParentTagged(r,t)},e.prototype.whenAnyAncestorIs=function(r){return this._bindingWhenSyntax.whenAnyAncestorIs(r)},e.prototype.whenNoAncestorIs=function(r){return this._bindingWhenSyntax.whenNoAncestorIs(r)},e.prototype.whenAnyAncestorNamed=function(r){return this._bindingWhenSyntax.whenAnyAncestorNamed(r)},e.prototype.whenAnyAncestorTagged=function(r,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(r,t)},e.prototype.whenNoAncestorNamed=function(r){return this._bindingWhenSyntax.whenNoAncestorNamed(r)},e.prototype.whenNoAncestorTagged=function(r,t){return this._bindingWhenSyntax.whenNoAncestorTagged(r,t)},e.prototype.whenAnyAncestorMatches=function(r){return this._bindingWhenSyntax.whenAnyAncestorMatches(r)},e.prototype.whenNoAncestorMatches=function(r){return this._bindingWhenSyntax.whenNoAncestorMatches(r)},e.prototype.onActivation=function(r){return this._bindingOnSyntax.onActivation(r)},e}(),l3e=function(){function e(r){this._binding=r}return e.prototype.inRequestScope=function(){return this._binding.scope=lf.Request,new I0(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=lf.Singleton,new I0(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=lf.Transient,new I0(this._binding)},e}(),u$=function(){function e(r){this._binding=r,this._bindingWhenSyntax=new wB(this._binding),this._bindingOnSyntax=new sf(this._binding),this._bindingInSyntax=new l3e(r)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(r){return this._bindingWhenSyntax.when(r)},e.prototype.whenTargetNamed=function(r){return this._bindingWhenSyntax.whenTargetNamed(r)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(r,t){return this._bindingWhenSyntax.whenTargetTagged(r,t)},e.prototype.whenInjectedInto=function(r){return this._bindingWhenSyntax.whenInjectedInto(r)},e.prototype.whenParentNamed=function(r){return this._bindingWhenSyntax.whenParentNamed(r)},e.prototype.whenParentTagged=function(r,t){return this._bindingWhenSyntax.whenParentTagged(r,t)},e.prototype.whenAnyAncestorIs=function(r){return this._bindingWhenSyntax.whenAnyAncestorIs(r)},e.prototype.whenNoAncestorIs=function(r){return this._bindingWhenSyntax.whenNoAncestorIs(r)},e.prototype.whenAnyAncestorNamed=function(r){return this._bindingWhenSyntax.whenAnyAncestorNamed(r)},e.prototype.whenAnyAncestorTagged=function(r,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(r,t)},e.prototype.whenNoAncestorNamed=function(r){return this._bindingWhenSyntax.whenNoAncestorNamed(r)},e.prototype.whenNoAncestorTagged=function(r,t){return this._bindingWhenSyntax.whenNoAncestorTagged(r,t)},e.prototype.whenAnyAncestorMatches=function(r){return this._bindingWhenSyntax.whenAnyAncestorMatches(r)},e.prototype.whenNoAncestorMatches=function(r){return this._bindingWhenSyntax.whenNoAncestorMatches(r)},e.prototype.onActivation=function(r){return this._bindingOnSyntax.onActivation(r)},e}(),c3e=function(){function e(r){this._binding=r}return e.prototype.to=function(r){return this._binding.type=uf.Instance,this._binding.implementationType=r,new u$(this._binding)},e.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+LDe);var r=this._binding.serviceIdentifier;return this.to(r)},e.prototype.toConstantValue=function(r){return this._binding.type=uf.ConstantValue,this._binding.cache=r,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=lf.Singleton,new I0(this._binding)},e.prototype.toDynamicValue=function(r){return this._binding.type=uf.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=r,this._binding.implementationType=null,new u$(this._binding)},e.prototype.toConstructor=function(r){return this._binding.type=uf.Constructor,this._binding.implementationType=r,this._binding.scope=lf.Singleton,new I0(this._binding)},e.prototype.toFactory=function(r){return this._binding.type=uf.Factory,this._binding.factory=r,this._binding.scope=lf.Singleton,new I0(this._binding)},e.prototype.toFunction=function(r){if(typeof r!="function")throw new Error(MDe);var t=this.toConstantValue(r);return this._binding.type=uf.Function,this._binding.scope=lf.Singleton,t},e.prototype.toAutoFactory=function(r){return this._binding.type=uf.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(r)};return n},this._binding.scope=lf.Singleton,new I0(this._binding)},e.prototype.toProvider=function(r){return this._binding.type=uf.Provider,this._binding.provider=r,this._binding.scope=lf.Singleton,new I0(this._binding)},e.prototype.toService=function(r){this.toDynamicValue(function(t){return t.container.get(r)})},e}(),f3e=function(){function e(){}return e.of=function(r,t){var n=new e;return n.bindings=r,n.middleware=t,n},e}(),l$=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(r,t){if(r==null)throw new Error(Gw);if(t==null)throw new Error(Gw);var n=this._map.get(r);n!==void 0?(n.push(t),this._map.set(r,n)):this._map.set(r,[t])},e.prototype.get=function(r){if(r==null)throw new Error(Gw);var t=this._map.get(r);if(t!==void 0)return t;throw new Error(i$)},e.prototype.remove=function(r){if(r==null)throw new Error(Gw);if(!this._map.delete(r))throw new Error(i$)},e.prototype.removeByCondition=function(r){var t=this;this._map.forEach(function(n,i){var a=n.filter(function(o){return!r(o)});a.length>0?t._map.set(i,a):t._map.delete(i)})},e.prototype.hasKey=function(r){if(r==null)throw new Error(Gw);return this._map.has(r)},e.prototype.clone=function(){var r=new e;return this._map.forEach(function(t,n){t.forEach(function(i){return r.add(n,i.clone())})}),r},e.prototype.traverse=function(r){this._map.forEach(function(t,n){r(n,t)})},e}(),h3e=globalThis&&globalThis.__awaiter||function(e,r,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(h){o(h)}}function u(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(e,r||[])).next())})},p3e=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=r.call(e,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},d3e=globalThis&&globalThis.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e},CB=function(){function e(r){this._appliedMiddleware=[];var t=r||{};if(typeof t!="object")throw new Error(""+PDe);if(t.defaultScope===void 0)t.defaultScope=lf.Transient;else if(t.defaultScope!==lf.Singleton&&t.defaultScope!==lf.Transient&&t.defaultScope!==lf.Request)throw new Error(""+RDe);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+ODe);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+FDe);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=AS(),this._bindingDictionary=new l$,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new $De}return e.merge=function(r,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var a=new e,o=d3e([r,t],n).map(function(l){return G5(l)}),s=G5(a);function u(l,f){l.traverse(function(h,p){p.forEach(function(v){f.add(v.serviceIdentifier,v.clone())})})}return o.forEach(function(l){u(l,s)}),a},e.prototype.load=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,a=r;i<a.length;i++){var o=a[i],s=n(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},e.prototype.loadAsync=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return h3e(this,void 0,void 0,function(){var n,i,a,o,s;return p3e(this,function(u){switch(u.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,a=r,u.label=1;case 1:return i<a.length?(o=a[i],s=n(o.id),[4,o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)]):[3,4];case 2:u.sent(),u.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},e.prototype.unload=function(){for(var r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(a){return function(o){return o.moduleId===a}};t.forEach(function(a){var o=i(a.id);r._bindingDictionary.removeByCondition(o)})},e.prototype.bind=function(r){var t=this.options.defaultScope||lf.Transient,n=new vDe(r,t);return this._bindingDictionary.add(r,n),new c3e(n)},e.prototype.rebind=function(r){return this.unbind(r),this.bind(r)},e.prototype.unbind=function(r){try{this._bindingDictionary.remove(r)}catch{throw new Error(_De+" "+ME(r))}},e.prototype.unbindAll=function(){this._bindingDictionary=new l$},e.prototype.isBound=function(r){var t=this._bindingDictionary.hasKey(r);return!t&&this.parent&&(t=this.parent.isBound(r)),t},e.prototype.isBoundNamed=function(r,t){return this.isBoundTagged(r,jg,t)},e.prototype.isBoundTagged=function(r,t,n){var i=!1;if(this._bindingDictionary.hasKey(r)){var a=this._bindingDictionary.get(r),o=r3e(this,r,t,n);i=a.some(function(s){return s.constraint(o)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(r,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(f3e.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var r=this._snapshots.pop();if(r===void 0)throw new Error(ADe);this._bindingDictionary=r.bindings,this._middleware=r.middleware},e.prototype.createChild=function(r){var t=new e(r||this.options);return t.parent=this,t},e.prototype.applyMiddleware=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(r);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=r.reduce(function(i,a){return a(i)},n)},e.prototype.applyCustomMetadataReader=function(r){this._metadataReader=r},e.prototype.get=function(r){return this._get(!1,!1,uy.Variable,r)},e.prototype.getTagged=function(r,t,n){return this._get(!1,!1,uy.Variable,r,t,n)},e.prototype.getNamed=function(r,t){return this.getTagged(r,jg,t)},e.prototype.getAll=function(r){return this._get(!0,!0,uy.Variable,r)},e.prototype.getAllTagged=function(r,t,n){return this._get(!1,!0,uy.Variable,r,t,n)},e.prototype.getAllNamed=function(r,t){return this.getAllTagged(r,jg,t)},e.prototype.resolve=function(r){var t=this.createChild();return t.bind(r).toSelf(),this._appliedMiddleware.forEach(function(n){t.applyMiddleware(n)}),t.get(r)},e.prototype._getContainerModuleHelpersFactory=function(){var r=this,t=function(s,u){s._binding.moduleId=u},n=function(s){return function(u){var l=r.bind.bind(r),f=l(u);return t(f,s),f}},i=function(s){return function(u){var l=r.unbind.bind(r);l(u)}},a=function(s){return function(u){var l=r.isBound.bind(r);return l(u)}},o=function(s){return function(u){var l=r.rebind.bind(r),f=l(u);return t(f,s),f}};return function(s){return{bindFunction:n(s),isboundFunction:a(),rebindFunction:o(s),unbindFunction:i()}}},e.prototype._get=function(r,t,n,i,a,o){var s=null,u={avoidConstraints:r,contextInterceptor:function(l){return l},isMultiInject:t,key:a,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(s=this._middleware(u),s==null)throw new Error(TDe)}else s=this._planAndResolve()(u);return s},e.prototype._planAndResolve=function(){var r=this;return function(t){var n=t3e(r._metadataReader,r,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=u3e(n);return i}},e}();function Ri(){return function(e){if(Reflect.hasOwnMetadata(V5,e))throw new Error(gDe);var r=Reflect.getMetadata(hDe,e)||[];return Reflect.defineMetadata(V5,r,e),e}}function v3e(){return function(e,r,t){var n=new o_(GC,r);if(Reflect.hasOwnMetadata(GC,e.constructor))throw new Error(DDe);Reflect.defineMetadata(GC,n,e.constructor)}}var Hw=Symbol.for("INJECTION");function lk(e,r,t,n){function i(){return n&&!Reflect.hasMetadata(Hw,this,r)&&Reflect.defineMetadata(Hw,t(),this,r),Reflect.hasMetadata(Hw,this,r)?Reflect.getMetadata(Hw,this,r):t()}function a(o){Reflect.defineMetadata(Hw,o,this,r)}Object.defineProperty(e,r,{configurable:!0,enumerable:!0,get:i,set:a})}function g3e(e,r){return function(t){return function(n,i){var a=function(){return e.get(t)};lk(n,i,a,r)}}}function m3e(e,r){return function(t,n){return function(i,a){var o=function(){return e.getNamed(t,n)};lk(i,a,o,r)}}}function y3e(e,r){return function(t,n,i){return function(a,o){var s=function(){return e.getTagged(t,n,i)};lk(a,o,s,r)}}}function _3e(e,r){return function(t){return function(n,i){var a=function(){return e.getAll(t)};lk(n,i,a,r)}}}function x3e(e,r){r===void 0&&(r=!0);var t=g3e(e,r),n=m3e(e,r),i=y3e(e,r),a=_3e(e,r);return{lazyInject:t,lazyInjectNamed:n,lazyInjectTagged:i,lazyMultiInject:a}}var Mt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")};function b3e(e){var r=131,t=137,n=0;e+="x";for(var i=Math.floor(9007199254740991/t),a=0;a<e.length;a++)n>i&&(n=Math.floor(n/t)),n=n*r+e.charCodeAt(a);return n}function w3e(e){e=e.toString();for(var r=5381,t=e.length;t;)r=r*33^e.charCodeAt(--t);return r>>>0}var SC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function EB(e){this.message=e}EB.prototype=new Error;EB.prototype.name="InvalidCharacterError";function C3e(e){var r=String(e).replace(/=+$/,"");if(r.length%4===1)throw new EB("'atob' failed: The string to be decoded is not correctly encoded.");for(var t="",n=0,i,a,o=0;a=r.charAt(o++);~a&&(i=n%4?i*64+a:a,n++%4)?t+=String.fromCharCode(255&i>>(-2*n&6)):0)a=SC.indexOf(a);return t}function lre(e){e=String(e);for(var r,t,n,i,a="",o=0,s=e.length%3;o<e.length;){if((t=e.charCodeAt(o++))>255||(n=e.charCodeAt(o++))>255||(i=e.charCodeAt(o++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");r=t<<16|n<<8|i,a+=SC.charAt(r>>18&63)+SC.charAt(r>>12&63)+SC.charAt(r>>6&63)+SC.charAt(r&63)}return s?a.slice(0,s-3)+"===".substring(s):a}var E3e=function(){function e(r,t){st(this,e),this.buffers=r,this.type=t}return ot(e,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(t,n,i){throw new Error("not implemented")}}]),e}(),zd;typeof window=="undefined"?zd={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(r){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(r){return null},clearMeasures:function(r){return null},clearMarks:function(r){return null},measure:function(r,t,n){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(r){return!0},Event:function(r,t){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:zd=window;var S3e=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,A3e=S3e?my.getSystemInfoSync().pixelRatio:zd.devicePixelRatio,ck=ot(function e(r,t){st(this,e),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=r,this.timeStamp=Date.now()});function T3e(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=M3e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function M3e(e,r){if(!!e){if(typeof e=="string")return c$(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c$(e,r)}}function c$(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var jw=new WeakMap,SB=function(){function e(){st(this,e),jw.set(this,{})}return ot(e,[{key:"addEventListener",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=jw.get(this);a||(a={}),a[t]||(a[t]=[]),a[t].push(n),jw.set(this,a),i.capture,i.once,i.passive}},{key:"removeEventListener",value:function(t,n){var i=jw.get(this);if(i){var a=i[t];if(a&&a.length>0){for(var o=a.length;o--;o>0)if(a[o]===n){a.splice(o,1);break}}}}},{key:"dispatchEvent",value:function(t){var n=jw.get(this)[t.type];if(n){var i=T3e(n),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o(t)}}catch(s){i.e(s)}finally{i.f()}}}}]),e}();function L3e(e){var r=I3e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function I3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cre=function(e){er(t,e);var r=L3e(t);function t(){var n;return st(this,t),n=r.call(this),n.childNodes=[],n}return ot(t,[{key:"appendChild",value:function(i){this.childNodes.push(i)}},{key:"cloneNode",value:function(){var i=Object.create(this);return Object.assign(i,this),i}},{key:"removeChild",value:function(i){var a=this.childNodes.findIndex(function(o){return o===i});return a>-1?this.childNodes.splice(a,1):null}}]),t}(SB);function k3e(e){var r=P3e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function P3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fre=function(e){er(t,e);var r=k3e(t);function t(){var n;return st(this,t),n=r.call(this),n.className="",n.children=[],n}return ot(t,[{key:"setAttribute",value:function(i,a){this[i]=a}},{key:"getAttribute",value:function(i){return this[i]}},{key:"setAttributeNS",value:function(i,a){this[i]=a}},{key:"getAttributeNS",value:function(i){return this[i]}}]),t}(cre),R3e=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,j5,W5,X5,Y5;if(R3e){var sT=my.getSystemInfoSync();j5=sT.screenWidth,W5=sT.screenHeight,X5=sT.windowWidth,Y5=sT.windowHeight}else{var f$=zd.innerWidth,h$=zd.innerHeight;j5=f$,W5=h$,X5=f$,Y5=h$}var HC={width:j5,height:W5,availWidth:X5,availHeight:Y5,availLeft:0,availTop:0},fk=HC.availWidth,hk=HC.availHeight,p$={style:[]};function hre(e,r){if(!("parentNode"in e)){var t;r===0?t=function(){return null}:r===1?t=function(){return p$}:t=function(){return null},Object.defineProperty(e,"parentNode",{enumerable:!0,get:t})}if(!("parentElement"in e)){var n;r===0?n=function(){return null}:r===1?n=function(){return p$}:n=function(){return null},Object.defineProperty(e,"parentElement",{enumerable:!0,get:n})}}function O3e(e){e.style=e.style||{},Object.assign(e.style,{top:"0px",left:"0px",width:fk+"px",height:hk+"px",margin:"0px",padding:"0px"})}function F3e(e){"clientLeft"in e||(e.clientLeft=0,e.clientTop=0),"clientWidth"in e||(e.clientWidth=fk,e.clientHeight=hk),"getBoundingClientRect"in e||(e.getBoundingClientRect=function(){var r={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return r})}function D3e(e){"offsetLeft"in e||(e.offsetLeft=0,e.offsetTop=0),"offsetWidth"in e||(e.offsetWidth=fk,e.offsetHeight=hk)}function B3e(e){"scrollLeft"in e||(e.scrollLeft=0,e.scrollTop=0),"scrollWidth"in e||(e.scrollWidth=fk,e.scrollHeight=hk)}function pre(e){var r=function(){return!0};e.classList=[],e.classList.add=r,e.classList.remove=r,e.classList.contains=r,e.classList.toggle=r}function N3e(e){var r=z3e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function z3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mb(){}var Y2=function(e){er(t,e);var r=N3e(t);function t(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;return st(this,t),n=r.call(this),n.className="",n.children=[],n.focus=mb,n.blur=mb,n.insertBefore=mb,n.appendChild=mb,n.removeChild=mb,n.remove=mb,n.innerHTML="",n.tagName=i.toUpperCase(),hre(He(n),a),O3e(He(n)),pre(He(n)),F3e(He(n)),D3e(He(n)),B3e(He(n)),n}return ot(t)}(fre);function $3e(e){var r=U3e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function U3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dre=function(e){er(t,e);var r=$3e(t);function t(n){return st(this,t),r.call(this,n)}return ot(t,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),t}(Y2);function V3e(e){var r=G3e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function G3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vre=function(e){er(t,e);var r=V3e(t);function t(){return st(this,t),r.call(this,"video")}return ot(t)}(dre),H3e={};function Ey(){return H3e}var gre=ot(function e(){st(this,e);var r=Ey(),t=r.createImage&&r.createImage()||{};return"tagName"in t||(t.tagName="IMG",t.__proto__=e.prototype),hre(t),pre(t),Object.assign(t,{addEventListener:function(i,a){t["on".concat(i)]=a.bind(t)},removeEventListener:function(i){t["on".concat(i)]=null}}),t}),mre={href:"",protocol:"",host:""};function yre(e){var r=j3e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function j3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var W3e=function(e){er(t,e);var r=yre(t);function t(){return st(this,t),r.call(this,"body",0)}return ot(t,[{key:"addEventListener",value:function(i,a){}},{key:"removeEventListener",value:function(i,a,o){}},{key:"dispatchEvent",value:function(i){}}]),t}(Y2),X3e=function(e){er(t,e);var r=yre(t);function t(){return st(this,t),r.call(this,"html",0)}return ot(t,[{key:"addEventListener",value:function(i,a){}},{key:"removeEventListener",value:function(i,a){}},{key:"dispatchEvent",value:function(i){}}]),t}(Y2),Ww={},Gv={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:mre,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(r){return r=r.toLowerCase(),r==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):r==="img"?new gre:r==="video"?new vre:new Y2(r)},createElementNS:function(r,t){return this.createElement(t)},createTextNode:function(r){return r},getElementById:function(r){return null},getElementsByTagName:function(r){return r=r.toLowerCase(),[]},getElementsByTagNameNS:function(r,t){return this.getElementsByTagName(t)},getElementsByName:function(r){return[]},querySelector:function(r){return null},querySelectorAll:function(r){return[]},addEventListener:function(r,t,n){Ww[r]||(Ww[r]=[]),Ww[r].push(t)},removeEventListener:function(r,t){var n=Ww[r];if(n&&n.length>0){for(var i=n.length;i--;i>0)if(n[i]===t){n.splice(i,1);break}}},dispatchEvent:function(r){var t=r.type,n=Ww[t];if(n)for(var i=0;i<n.length;i++)n[i](r);r.target&&typeof r.target["on"+t]=="function"&&r.target["on"+t](r)},createEvent:function(r){return new ck(r)}};Gv.documentElement=new X3e;Gv.head=new Y2("head");Gv.body=new W3e;var Y3e=Object,Z3e=function(){function e(){st(this,e);var r=arguments.length;if(r===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else r===3&&em(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return ot(e,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),e}(),q3e=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Z5,Kh,oL;if(q3e){var YR=my.getSystemInfoSync();Z5=YR.system,Kh=YR.platform,oL=YR.language}else{var Vp={versions:function(){var e=zd.navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")===-1,weixin:e.indexOf("MicroMessenger")>-1,qq:e.match(/\sQQ/i)===" qq"}}(),language:(zd.navigator.browserLanguage||zd.navigator.language).toLowerCase()};Vp.versions.android?Kh="android":Vp.versions.trident?Kh="IE":Vp.versions.presto?Kh="Opera":Vp.versions.webKit?Kh="webKit":Vp.versions.gecko?Kh="Firefox":Vp.versions.mobile?Kh="mobile":Vp.versions.ios?Kh="ios":Vp.versions.iPhone?Kh="iPhone":Vp.versions.iPad?Kh="ipad":Vp.versions.webApp?Kh="webApp":Vp.versions.weixin?Kh="weixin":Vp.versions.qq&&(Kh="qq"),Z5=zd.navigator.userAgent,oL=Vp.language}var K3e=Z5.toLowerCase().indexOf("android")!==-1,_re=K3e?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",Q3e="Mozilla/5.0 (".concat(_re,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(oL),J3e={platform:Kh,language:oL,appVersion:"5.0 (".concat(_re,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:Q3e},e4e={mark:function(r){return null},clearMeasures:function(r){return null},clearMarks:function(r){return null},measure:function(r,t,n){return{duration:0}},now:function(){}},d$=0,v$=0;function t4e(e){var r=Date.now(),t=Math.max(d$+23,r);return v$=setTimeout(function(){e(d$=t)},t-r),v$}function r4e(e){var r=Ey();return r.requestAnimationFrame?r.requestAnimationFrame(e):t4e(e)}function n4e(e){var r=Ey();return r.cancelAnimationFrame?r.cancelAnimationFrame(e):clearTimeout(e)}var i4e=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(st(this,e),r.indexOf("http://")==0||r.indexOf("https://")==0){this.href=r;return}this.href=t+r}return ot(e,null,[{key:"createObjectURL",value:function(t){var n=t.buffers[0],i=t.type,a=a4e(n),o="data:".concat(i,";base64, ");return o+a}}]),e}();function a4e(e){for(var r="",t=new Uint8Array(e),n=t.byteLength,i=0;i<n;i++)r+=String.fromCharCode(t[i]);return lre(r)}var o4e={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},s4e={};function u4e(e){var r=l4e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function l4e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ZR=new Map,g$=new Map,c4e=new Map,C1=function(e){er(t,e);var r=u4e(t);function t(){var n;return st(this,t),n=r.call(this),n.onabort=null,n.onerror=null,n.onload=null,n.onloadstart=null,n.onprogress=null,n.ontimeout=null,n.onloadend=null,n.onreadystatechange=null,n.readyState=0,n.response=null,n.responseText=null,n._responseType="text",n.responseXML=null,n.status=0,n.statusText="",n.upload={},n.withCredentials=!1,ZR.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),n}return ot(t,[{key:"responseType",set:function(i){this._responseType=i}},{key:"abort",value:function(){var i=c4e.get("requestTask");i&&i.abort()}},{key:"getAllResponseHeaders",value:function(){var i=g$.get("responseHeader");return Object.keys(i).map(function(a){return"".concat(a,": ").concat(i[a])}).join(`
`)}},{key:"getResponseHeader",value:function(i){return g$.get("responseHeader")[i]}},{key:"open",value:function(i,a,o){this._method=i,this._url=a}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(i,a){var o=ZR.get("requestHeader");o[i]=a,ZR.set("requestHeader",o)}},{key:"addEventListener",value:function(i,a){var o=this;typeof a=="function"&&(this["on"+i]=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};s.target=s.target||o,a.call(o,s)})}},{key:"removeEventListener",value:function(i,a){this["on"+i]===a&&(this["on"+i]=null)}}]),t}(SB);C1.UNSEND=0;C1.OPENED=1;C1.HEADERS_RECEIVED=2;C1.LOADING=3;C1.DONE=4;function f4e(e){var r=h4e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function h4e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var p4e=function(e){er(t,e);var r=f4e(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.touches=[],i.targetTouches=[],i.changedTouches=[],i.target=Ey(),i.currentTarget=Ey(),i}return ot(t)}(ck);function qR(e){var r=e||{},t=r.x,n=t===void 0?0:t,i=r.y,a=i===void 0?0:i,o=r.clientX,s=o===void 0?0:o,u=r.clientY,l=u===void 0?0:u;Object.keys(e).indexOf("x")!==-1?(e.pageX=e.clientX=n,e.pageY=e.clientY=a):(e.x=s,e.y=l)}function AB(e){return function(r){var t=new p4e(e);t.changedTouches=r.changedTouches,t.touches=r.touches,t.targetTouches=Array.prototype.slice.call(r.touches),t.timeStamp=r.timeStamp,t.changedTouches.forEach(function(n){return qR(n)}),t.touches.forEach(function(n){return qR(n)}),t.targetTouches.forEach(function(n){return qR(n)}),Gv.dispatchEvent(t)}}function d4e(e){return function(r){r.type=e,Gv.dispatchEvent(r)}}var v4e=AB("touchstart"),g4e=AB("touchmove"),m4e=AB("touchend"),y4e=d4e("mapCameaParams");function _4e(e){var r=x4e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function x4e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var b4e=function(e){er(t,e);var r=_4e(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.target=Ey(),i.currentTarget=Ey(),i}return ot(t)}(ck),m$=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],w4e=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],C4e="touch";function E4e(e,r,t){for(var n=new b4e(e),i=0;i<m$.length;i++){var a=m$[i];n[a]=r[a]||w4e[i]}return n.type=e,n.target=Ey(),n.currentTarget=Ey(),n.buttons=S4e(e),n.which=n.buttons,n.pointerId=(r.identifier||0)+2,n.bubbles=!0,n.cancelable=!0,n.button=0,n.width=(r.radiusX||.5)*2,n.height=(r.radiusY||.5)*2,n.pressure=r.force||.5,n.isPrimary=A4e(r),n.pointerType=C4e,n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,t.preventDefault&&(n.preventDefault=function(){t.preventDefault()}),n}function S4e(e){var r=0;return(e==="touchstart"||e==="touchmove"||e==="pointerdown"||e==="pointermove")&&(r=1),r}var IE=null;function A4e(e){return IE===e.identifier}function T4e(e){IE===null&&(IE=e.identifier)}function M4e(e){IE===e.identifier&&(IE=null)}function TB(e){return function(r){for(var t=r.changedTouches,n=0;n<t.length;n++){var i=t[n];n===0&&e==="pointerdown"?T4e(i):(e==="pointerup"||e==="pointercancel")&&M4e(i);var a=E4e(e,i,r);Gv.dispatchEvent(a)}}}var L4e=TB("pointerdown"),I4e=TB("pointermove"),k4e=TB("pointerup");function MB(e){return function(r){r.type=e,Gv.dispatchEvent(r)}}var P4e=MB("mousedown"),R4e=MB("mousemove"),O4e=MB("mouseup"),xre=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,bre=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),ns=xre||bre,wre={atob:C3e,btoa:lre,devicePixelRatio:A3e,Blob:E3e,document:Gv,Element:fre,Event:ck,EventTarget:SB,HTMLCanvasElement:Y3e,HTMLElement:Y2,HTMLMediaElement:dre,HTMLVideoElement:vre,Image:gre,ImageData:Z3e,navigator:J3e,Node:cre,requestAnimationFrame:r4e,cancelAnimationFrame:n4e,screen:HC,XMLHttpRequest:C1,performance:e4e,URL:i4e,WebGLRenderingContext:o4e,WebGL2RenderingContext:s4e,addEventListener:function(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Gv.addEventListener(r,t,n)},removeEventListener:function(r,t,n){Gv.removeEventListener(r,t)},dispatchEvent:function(r){Gv.dispatchEvent(r)},innerWidth:HC.availWidth,innerHeight:HC.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},Hn=ns?wre:zd,Cre=ns?C1:zd.XMLHttpRequest,F4e=ns?mre:zd.location;function Ere(e){var r=e;return typeof e=="string"&&(r=Hn.document.getElementById(e)),r}function LB(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Sre(e){return LB(e).split(/\s+/)}function D4e(e){var r,t,n=Hn==null||(r=Hn.document)===null||r===void 0||(t=r.documentElement)===null||t===void 0?void 0:t.style;if(!n)return e[0];for(var i in e)if(e[i]&&e[i]in n)return e[i];return e[0]}function xs(e,r,t){var n=Hn.document.createElement(e);return n.className=r||"",t&&t.appendChild(n),n}function n1(e){var r=e.parentNode;r&&r.removeChild(e)}function s_(e,r){if(e.classList!==void 0)for(var t=Sre(r),n=0,i=t.length;n<i;n++)e.classList.add(t[n]);else if(!Are(e,r)){var a=pk(e);IB(e,(a?a+" ":"")+r)}}function C2(e,r){e.classList!==void 0?e.classList.remove(r):IB(e,LB((" "+pk(e)+" ").replace(" "+r+" "," ")))}function Are(e,r){if(e.classList!==void 0)return e.classList.contains(r);var t=pk(e);return t.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(t)}function IB(e,r){e instanceof HTMLElement?e.className=r:e.className.baseVal=r}function pk(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function q5(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var B4e=D4e(["transform","WebkitTransform"]);function kB(e,r){e.style[B4e]=r}function Tre(){if(typeof Event=="function")Hn.dispatchEvent(new Event("resize"));else{var e=Hn.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,Hn,0),Hn.dispatchEvent(e)}}function N4e(e){var r=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,r.join(""))}function Mre(){var e,r=Hn.document.querySelector('meta[name="viewport"]');if(!r)return 1;var t=(e=r.content)===null||e===void 0?void 0:e.split(","),n=t.find(function(i){var a=i.split("="),o=tn(a,1),s=o[0];return s==="initial-scale"});return n?n.split("=")[1]*1:1}var pu=Mre()<1?1:Hn.devicePixelRatio,z4e=Object.freeze(Object.defineProperty({__proto__:null,getContainer:Ere,trim:LB,splitWords:Sre,create:xs,remove:n1,addClass:s_,removeClass:C2,hasClass:Are,setClass:IB,getClass:pk,empty:q5,setTransform:kB,triggerResize:Tre,printCanvas:N4e,getViewPortScale:Mre,DPR:pu},Symbol.toStringTag,{value:"Module"}));function Lre(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]>r&&(r=e[t]);return r*1}function Ire(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]<r&&(r=e[t]);return r*1}function PB(e){if(e.length===0)return 0;for(var r=e[0]*1,t=1;t<e.length;t++)r+=e[t]*1;return r}function kre(e){if(e.length===0)throw new Error("mean requires at least one data point");return PB(e)/e.length}function Pre(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var r=e[0],t=NaN,n=0,i=1,a=1;a<e.length+1;a++)e[a]!==r?(i>n&&(n=i,t=r),i=1,r=e[a]):i++;return t*1}var dk={min:Ire,max:Lre,mean:kre,sum:PB,mode:Pre};function vk(e,r){return e.map(function(t){return t[r]})}function Rre(e,r){return dk[e](r)}var $4e=Object.freeze(Object.defineProperty({__proto__:null,sum:PB,max:Lre,min:Ire,mean:kre,mode:Pre,statMap:dk,getColumn:vk,getSatByColumn:Rre},Symbol.toStringTag,{value:"Module"}));function U4e(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function X0(e,r,t){return sde()?X0=Reflect.construct.bind():X0=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&FZ(l,o.prototype),l},X0.apply(null,arguments)}function K5(e){var r=typeof Map=="function"?new Map:void 0;return K5=function(n){if(n===null||!U4e(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r!="undefined"){if(r.has(n))return r.get(n);r.set(n,i)}function i(){return X0(n,arguments,ze(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),FZ(i,n)},K5(e)}function Ore(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap}function Fre(){return typeof importScripts=="function"}var V4e=Fre()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href};function G4e(e){var r=H4e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function H4e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dre=function(e){er(t,e);var r=G4e(t);function t(n,i,a,o){var s;return st(this,t),s=r.call(this,"AJAXError: ".concat(i," (").concat(n,"): ").concat(a)),s.status=n,s.statusText=i,s.url=a,s.body=o,s}return ot(t)}(K5(Error));function Bre(e,r){var t=new Cre,n=Array.isArray(e.url)?e.url[0]:e.url;t.open(e.method||"GET",n,!0),e.type==="arrayBuffer"&&(t.responseType="arraybuffer");for(var i in e.headers)e.headers.hasOwnProperty(i)&&t.setRequestHeader(i,e.headers[i]);return e.type==="json"&&(t.responseType="text",t.setRequestHeader("Accept","application/json")),t.withCredentials=e.credentials==="include",t.onerror=function(){r(new Error(t.statusText))},t.onload=function(){if((t.status>=200&&t.status<300||t.status===0)&&t.response!==null){var a=t.response;if(e.type==="json")try{a=JSON.parse(t.response)}catch(s){return r(s)}r(null,a,t.getResponseHeader("Cache-Control"),t.getResponseHeader("Expires"),t)}else{var o=new Blob([t.response],{type:t.getResponseHeader("Content-Type")});r(new Dre(t.status,t.statusText,n.toString(),o))}},t.send(e.body),t}function Nre(e){return new Promise(function(r,t){Bre(e,function(n,i,a,o,s){n?t({err:n,data:null,xhr:s}):r({err:null,data:i,cacheControl:a,expires:o,xhr:s})})})}function RB(e,r){return Bre(e,r)}var j4e=function(r,t){return RB(Et(Et({},r),{},{type:"json"}),t)},gk=function(r,t){return RB(Et(Et({},r),{},{type:"arrayBuffer"}),t)},W4e=function(r,t){return RB(Et(Et({},r),{},{method:"POST"}),t)};function X4e(e){var r=Hn.document.createElement("a");return r.href=e,r.protocol===Hn.document.location.protocol&&r.host===Hn.document.location.host}var y$="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Y4e(e,r){var t=new Hn.Image,n=Hn.URL||Hn.webkitURL;t.crossOrigin="anonymous",t.onload=function(){r(null,t),n.revokeObjectURL(t.src),t.onload=null,window.requestAnimationFrame(function(){t.src=y$})},t.onerror=function(){return r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var i=new Blob([new Uint8Array(e)],{type:"image/png"});t.src=e.byteLength?n.createObjectURL(i):y$}function Z4e(e,r){var t=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(t).then(function(n){r(null,n)}).catch(function(n){r(new Error("Could not load image because of ".concat(n.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var sL=function(r,t){return gk(r,function(n,i){if(n)t(n);else if(i){var a=typeof createImageBitmap=="function";a?Z4e(i,t):Y4e(i,t)}})},Zh=63710088e-1,q4e={centimeters:Zh*100,centimetres:Zh*100,degrees:Zh/111325,feet:Zh*3.28084,inches:Zh*39.37,kilometers:Zh/1e3,kilometres:Zh/1e3,meters:Zh,metres:Zh,miles:Zh/1609.344,millimeters:Zh*1e3,millimetres:Zh*1e3,nauticalmiles:Zh/1852,radians:1,yards:Zh*1.0936};function E2(e,r,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function OB(e,r,t){t===void 0&&(t={});for(var n=0,i=e;n<i.length;n++){var a=i[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:e};return E2(s,r,t)}function K4e(e,r,t){if(t===void 0&&(t={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return E2(n,r,t)}function Q4e(e,r){r===void 0&&(r={});var t={type:"FeatureCollection"};return r.id&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.features=e,t}function J4e(e,r,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:e};return E2(n,r,t)}function eBe(e,r,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:e};return E2(n,r,t)}function tBe(e,r){r===void 0&&(r="kilometers");var t=q4e[r];if(!t)throw new Error(r+" units is invalid");return e*t}function _$(e){var r=e%(2*Math.PI);return r*180/Math.PI}function N0(e){var r=e%360;return r*Math.PI/180}function KR(e){return typeof e=="number"}var uL=2*Math.PI*6378137/2;function zre(e){var r=[1/0,1/0,-1/0,-1/0];return e.forEach(function(t){var n=t.coordinates;$re(r,n)}),r}function $re(e,r){return Array.isArray(r[0])?r.forEach(function(t){$re(e,t)}):(e[0]>r[0]&&(e[0]=r[0]),e[1]>r[1]&&(e[1]=r[1]),e[2]<r[0]&&(e[2]=r[0]),e[3]<r[1]&&(e[3]=r[1])),e}function rBe(e,r){return Ure(e,r)}function Ure(e,r){return Array.isArray(e[0])?e.map(function(t){return Ure(t,r)}):r(e)}function uM(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=Hre(e,r);var n=e[0],i=e[1],a=n*uL/180,o=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return o=o*uL/180,t.enable&&(a=Number(a.toFixed(t.decimal)),o=Number(o.toFixed(t.decimal))),e.length===3?[a,o,e[2]]:[a,o]}function nBe(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,t=e[0],n=e[1],i=t/uL*180,a=n/uL*180;return a=180/Math.PI*(2*Math.atan(Math.exp(a*Math.PI/180))-Math.PI/2),r!=null&&(i=Number(i.toFixed(r)),a=Number(a.toFixed(r))),e.length===3?[i,a,e[2]]:[i,a]}function Vre(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function Gre(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function Hre(e,r){if(r===!1)return e;var t=Vre(e[0]),n=Gre(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[t,n,e[2]]:[t,n]}function nc(e){var r=85.0511287798,t=Math.max(Math.min(r,e[1]),-r),n=256<<20,i=Math.PI/180,a=e[0]*i,o=t*i;o=Math.log(Math.tan(Math.PI/4+o/2));var s=.5/Math.PI,u=.5,l=-.5/Math.PI;return i=.5,a=n*(s*a+u),o=n*(l*o+i),[Math.floor(a),Math.floor(o)]}function iBe(e){var r=.5/Math.PI,t=.5,n=-.5/Math.PI,i=.5,a=256<<20,o=tn(e,2),s=o[0],u=o[1];s=(s/a-t)/r,u=(u/a-i)/n,u=(Math.atan(Math.pow(Math.E,u))-Math.PI/4)*2,i=Math.PI/180;var l=u/i,f=s/i;return[f,l]}function Dx(e,r){var t=85.0511287798,n=Math.PI/180,i=6378137;return r=Math.max(Math.min(t,r),-t),e*=n,r*=n,r=Math.log(Math.tan(Math.PI/4+r/2)),[e*i,r*i]}function jre(e,r){var t=Math.PI/180,n=6378137,i=e/n/t,a=2*(Math.atan(Math.exp(r/n))-Math.PI/4)/t;return[i,a]}function Wre(e,r,t){var n=N0(r[1]-e[1]),i=N0(r[0]-e[0]),a=N0(e[1]),o=N0(r[1]),s=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(o);return tBe(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),"meters")}function aBe(e){var r=Math.PI/180,t=85.0511287798,n=6378137,i=Math.max(Math.min(t,e[1]),-t),a=Math.sin(i*r),o=n*e[0]*r,s=n*Math.log((1+a)/(1-a))/2;return[o,s]}function i1(e,r){var t=Math.abs(e[1][1]-e[0][1])*r,n=Math.abs(e[1][0]-e[0][0])*r;return[[e[0][0]-n,e[0][1]-t],[e[1][0]+n,e[1][1]+t]]}function mk(e,r){return e[0][0]<=r[0][0]&&e[0][1]<=r[0][1]&&e[1][0]>=r[1][0]&&e[1][1]>=r[1][1]}function kE(e){return[[e[0],e[1]],[e[2],e[3]]]}function FB(e){var r=yk(e,[0,0]);return[e[0]/r,e[1]/r]}function yk(e,r){return Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))}function oBe(e,r){return e[0]*r[0]+e[1]*r[1]}function x$(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function sBe(e,r){return Math.acos(oBe(e,r)/(x$(e)*x$(r)))*180/Math.PI}function Xre(e,r){return r[0]>0?r[1]>0?90-Math.atan(r[1]/r[0])*180/Math.PI:90+Math.atan(-r[1]/r[0])*180/Math.PI:r[1]<0?180+(90-Math.atan(r[1]/r[0])*180/Math.PI):270+Math.atan(r[1]/-r[0])*180/Math.PI}function uBe(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var t=[0,1],n=0,i=[],a=0;a<e.length-1;a++){var o=e[a],s=e[a+1],u=yk(o,s);n+=u;var l=[o[0]-s[0],o[1]-s[1]],f=Xre(t,l);if(a>0){var h=i[a-1].rotation;h-f>360-h+f&&(f=f+360)}i.push({start:o,end:s,dis:u,rotation:f,duration:0})}return i.map(function(p){p.duration=r*(p.dis/n)}),i}}function Yp(e){if(KR(e[0]))return e;if(KR(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(KR(e[0][0][0])){var r=e,t=0,n=0,i=0;return r.forEach(function(a){a.forEach(function(o){t+=o[0],n+=o[1],i++})}),[t/i,n/i,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Yre(e){for(var r=e[0],t=e[1],n=e[0],i=e[1],a=0,o=0,s=0,u=0;u<e.length;u+=2){var l=e[u],f=e[u+1];l&&f&&(r=Math.max(l,r),t=Math.max(f,t),n=Math.min(l,n),i=Math.min(f,i),a+=l,o+=f,s++)}return{center:[a/s,o/s],radius:Math.sqrt(Math.pow(r-n,2)+Math.pow(t-i,2))/2}}var Zre=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0;st(this,e),this.limit=r,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}return ot(e,[{key:"clear",value:function(){var t=this;this.order.forEach(function(n){t.delete(n)}),this.cache={},this.order=[]}},{key:"get",value:function(t){var n=this.cache[t];return n&&(this.deleteOrder(t),this.appendOrder(t)),n}},{key:"set",value:function(t,n){this.cache[t]?(this.delete(t),this.cache[t]=n,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=n,this.appendOrder(t))}},{key:"delete",value:function(t){var n=this.cache[t];n&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(n,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var n=this.order.findIndex(function(i){return i===t});n>=0&&this.order.splice(n,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,n){return null}}]),e}();function E1(e,r){e.forEach(function(t){!r[t]||(r[t]=r[t].bind(r))})}var qre=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16;st(this,e),X(this,"duration",16),X(this,"timestamp",new Date().getTime()),this.duration=r}return ot(e,[{key:"run",value:function(t){var n=new Date().getTime(),i=n-this.timestamp;this.timestamp=n,i>=this.duration&&t()}}]),e}();function DB(e){return typeof e=="string"?!!q0(e):!1}function Sa(e){var r=q0(e),t=[0,0,0,0];return r!=null&&(t[0]=r.r/255,t[1]=r.g/255,t[2]=r.b/255,t[3]=r.opacity),t}function dy(e){var r=e&&e[0],t=e&&e[1],n=e&&e[2],i=r+t*256+n*65536-1;return i}function Sy(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function Ay(e){var r=Hn.document.createElement("canvas"),t=r.getContext("2d");r.width=256,r.height=1;var n=null;if(e.weights){var i=0;e.weights.map(function(p,v){var m=e.colors[v]||"rgba(0, 0, 0, 0)",x=i+p;t.fillStyle=m,t.fillRect(i*256,0,x*256,1),i=x})}else{for(var a=t.createLinearGradient(0,0,256,1),o=e.positions[0],s=e.positions[e.positions.length-1],u=0;u<e.colors.length;++u){var l=(e.positions[u]-o)/(s-o);a.addColorStop(l,e.colors[u])}t.fillStyle=a,t.fillRect(0,0,256,1)}if(ns)return n=new Uint8ClampedArray(t.getImageData(0,0,256,1).data),r=null,t=null,{data:n,width:256,height:1};n=t.getImageData(0,0,256,1).data;for(var f=t.createImageData(256,1),h=0;h<f.data.length;h+=4)f.data[h+0]=n[h+0],f.data[h+1]=n[h+1],f.data[h+2]=n[h+2],f.data[h+3]=n[h+3];return r=null,t=null,f}var PE;(function(e){e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e.LEFT="left",e.RIGHT="right"})(PE||(PE={}));var RE={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function BB(e,r,t){var n=e.classList;for(var i in RE)RE.hasOwnProperty(i)&&n.remove("l7-".concat(t,"-anchor-").concat(i));n.add("l7-".concat(t,"-anchor-").concat(r))}function Ya(e,r){return{enable:e,mask:255,func:{cmp:514,ref:r?1:0,mask:255}}}var Kre={exports:{}},Qre={exports:{}};(function(e){function r(t){return e.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Qre);(function(e){var r=Qre.exports.default;function t(){e.exports=t=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},i=Object.prototype,a=i.hasOwnProperty,o=typeof Symbol=="function"?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function f(te,ie,ve){return Object.defineProperty(te,ie,{value:ve,enumerable:!0,configurable:!0,writable:!0}),te[ie]}try{f({},"")}catch{f=function(ve,me,Re){return ve[me]=Re}}function h(te,ie,ve,me){var Re=ie&&ie.prototype instanceof m?ie:m,We=Object.create(Re.prototype),je=new U(me||[]);return We._invoke=function(lt,dt,ct){var Tt="suspendedStart";return function(It,Lt){if(Tt==="executing")throw new Error("Generator is already running");if(Tt==="completed"){if(It==="throw")throw Lt;return Q()}for(ct.method=It,ct.arg=Lt;;){var rn=ct.delegate;if(rn){var wn=j(rn,ct);if(wn){if(wn===v)continue;return wn}}if(ct.method==="next")ct.sent=ct._sent=ct.arg;else if(ct.method==="throw"){if(Tt==="suspendedStart")throw Tt="completed",ct.arg;ct.dispatchException(ct.arg)}else ct.method==="return"&&ct.abrupt("return",ct.arg);Tt="executing";var zn=p(lt,dt,ct);if(zn.type==="normal"){if(Tt=ct.done?"completed":"suspendedYield",zn.arg===v)continue;return{value:zn.arg,done:ct.done}}zn.type==="throw"&&(Tt="completed",ct.method="throw",ct.arg=zn.arg)}}}(te,ve,je),We}function p(te,ie,ve){try{return{type:"normal",arg:te.call(ie,ve)}}catch(me){return{type:"throw",arg:me}}}n.wrap=h;var v={};function m(){}function x(){}function E(){}var A={};f(A,s,function(){return this});var L=Object.getPrototypeOf,k=L&&L(L(W([])));k&&k!==i&&a.call(k,s)&&(A=k);var R=E.prototype=m.prototype=Object.create(A);function D(te){["next","throw","return"].forEach(function(ie){f(te,ie,function(ve){return this._invoke(ie,ve)})})}function $(te,ie){function ve(Re,We,je,lt){var dt=p(te[Re],te,We);if(dt.type!=="throw"){var ct=dt.arg,Tt=ct.value;return Tt&&r(Tt)=="object"&&a.call(Tt,"__await")?ie.resolve(Tt.__await).then(function(It){ve("next",It,je,lt)},function(It){ve("throw",It,je,lt)}):ie.resolve(Tt).then(function(It){ct.value=It,je(ct)},function(It){return ve("throw",It,je,lt)})}lt(dt.arg)}var me;this._invoke=function(Re,We){function je(){return new ie(function(lt,dt){ve(Re,We,lt,dt)})}return me=me?me.then(je,je):je()}}function j(te,ie){var ve=te.iterator[ie.method];if(ve===void 0){if(ie.delegate=null,ie.method==="throw"){if(te.iterator.return&&(ie.method="return",ie.arg=void 0,j(te,ie),ie.method==="throw"))return v;ie.method="throw",ie.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var me=p(ve,te.iterator,ie.arg);if(me.type==="throw")return ie.method="throw",ie.arg=me.arg,ie.delegate=null,v;var Re=me.arg;return Re?Re.done?(ie[te.resultName]=Re.value,ie.next=te.nextLoc,ie.method!=="return"&&(ie.method="next",ie.arg=void 0),ie.delegate=null,v):Re:(ie.method="throw",ie.arg=new TypeError("iterator result is not an object"),ie.delegate=null,v)}function H(te){var ie={tryLoc:te[0]};1 in te&&(ie.catchLoc=te[1]),2 in te&&(ie.finallyLoc=te[2],ie.afterLoc=te[3]),this.tryEntries.push(ie)}function ee(te){var ie=te.completion||{};ie.type="normal",delete ie.arg,te.completion=ie}function U(te){this.tryEntries=[{tryLoc:"root"}],te.forEach(H,this),this.reset(!0)}function W(te){if(te){var ie=te[s];if(ie)return ie.call(te);if(typeof te.next=="function")return te;if(!isNaN(te.length)){var ve=-1,me=function Re(){for(;++ve<te.length;)if(a.call(te,ve))return Re.value=te[ve],Re.done=!1,Re;return Re.value=void 0,Re.done=!0,Re};return me.next=me}}return{next:Q}}function Q(){return{value:void 0,done:!0}}return x.prototype=E,f(R,"constructor",E),f(E,"constructor",x),x.displayName=f(E,l,"GeneratorFunction"),n.isGeneratorFunction=function(te){var ie=typeof te=="function"&&te.constructor;return!!ie&&(ie===x||(ie.displayName||ie.name)==="GeneratorFunction")},n.mark=function(te){return Object.setPrototypeOf?Object.setPrototypeOf(te,E):(te.__proto__=E,f(te,l,"GeneratorFunction")),te.prototype=Object.create(R),te},n.awrap=function(te){return{__await:te}},D($.prototype),f($.prototype,u,function(){return this}),n.AsyncIterator=$,n.async=function(te,ie,ve,me,Re){Re===void 0&&(Re=Promise);var We=new $(h(te,ie,ve,me),Re);return n.isGeneratorFunction(ie)?We:We.next().then(function(je){return je.done?je.value:We.next()})},D(R),f(R,l,"Generator"),f(R,s,function(){return this}),f(R,"toString",function(){return"[object Generator]"}),n.keys=function(te){var ie=[];for(var ve in te)ie.push(ve);return ie.reverse(),function me(){for(;ie.length;){var Re=ie.pop();if(Re in te)return me.value=Re,me.done=!1,me}return me.done=!0,me}},n.values=W,U.prototype={constructor:U,reset:function(ie){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(ee),!ie)for(var ve in this)ve.charAt(0)==="t"&&a.call(this,ve)&&!isNaN(+ve.slice(1))&&(this[ve]=void 0)},stop:function(){this.done=!0;var ie=this.tryEntries[0].completion;if(ie.type==="throw")throw ie.arg;return this.rval},dispatchException:function(ie){if(this.done)throw ie;var ve=this;function me(ct,Tt){return je.type="throw",je.arg=ie,ve.next=ct,Tt&&(ve.method="next",ve.arg=void 0),!!Tt}for(var Re=this.tryEntries.length-1;Re>=0;--Re){var We=this.tryEntries[Re],je=We.completion;if(We.tryLoc==="root")return me("end");if(We.tryLoc<=this.prev){var lt=a.call(We,"catchLoc"),dt=a.call(We,"finallyLoc");if(lt&&dt){if(this.prev<We.catchLoc)return me(We.catchLoc,!0);if(this.prev<We.finallyLoc)return me(We.finallyLoc)}else if(lt){if(this.prev<We.catchLoc)return me(We.catchLoc,!0)}else{if(!dt)throw new Error("try statement without catch or finally");if(this.prev<We.finallyLoc)return me(We.finallyLoc)}}}},abrupt:function(ie,ve){for(var me=this.tryEntries.length-1;me>=0;--me){var Re=this.tryEntries[me];if(Re.tryLoc<=this.prev&&a.call(Re,"finallyLoc")&&this.prev<Re.finallyLoc){var We=Re;break}}We&&(ie==="break"||ie==="continue")&&We.tryLoc<=ve&&ve<=We.finallyLoc&&(We=null);var je=We?We.completion:{};return je.type=ie,je.arg=ve,We?(this.method="next",this.next=We.finallyLoc,v):this.complete(je)},complete:function(ie,ve){if(ie.type==="throw")throw ie.arg;return ie.type==="break"||ie.type==="continue"?this.next=ie.arg:ie.type==="return"?(this.rval=this.arg=ie.arg,this.method="return",this.next="end"):ie.type==="normal"&&ve&&(this.next=ve),v},finish:function(ie){for(var ve=this.tryEntries.length-1;ve>=0;--ve){var me=this.tryEntries[ve];if(me.finallyLoc===ie)return this.complete(me.completion,me.afterLoc),ee(me),v}},catch:function(ie){for(var ve=this.tryEntries.length-1;ve>=0;--ve){var me=this.tryEntries[ve];if(me.tryLoc===ie){var Re=me.completion;if(Re.type==="throw"){var We=Re.arg;ee(me)}return We}}throw new Error("illegal catch attempt")},delegateYield:function(ie,ve,me){return this.delegate={iterator:W(ie),resultName:ve,nextLoc:me},this.method==="next"&&(this.arg=void 0),v}},n}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Kre);var lM=Kre.exports(),Xr=lM;try{regeneratorRuntime=lM}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=lM:Function("r","regeneratorRuntime = r")(lM)}function OE(e,r){if(!e)throw new Error(r||"web worker helper assertion failed.")}var lBe=typeof window!="undefined"&&typeof window.orientation!="undefined",cBe=function(){function e(r,t){var n=this;this.name=r,this.workerThread=t,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(i,a){n.resolve=i,n.reject=a})}return e.prototype.postMessage=function(r,t){this.workerThread.postMessage({source:"Main thread",type:r,payload:t})},e.prototype.done=function(r){OE(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(r)},e.prototype.error=function(r){OE(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(r)},e}(),QR=new Map;function fBe(e){OE(e.source&&!e.url||!e.source&&e.url);var r=QR.get(e.source||e.url);return r||(e.url&&(r=hBe(e.url),QR.set(e.url,r)),e.source&&(r=Jre(e.source),QR.set(e.source,r))),OE(r),r}function hBe(e){if(!e.startsWith("http"))return e;var r=pBe(e);return Jre(r)}function Jre(e){var r=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(r)}function pBe(e){return`try {
  importScripts('`+e+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function NB(e,r,t){r===void 0&&(r=!0);var n=t||new Set;if(e){if(b$(e))n.add(e);else if(b$(e.buffer))n.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(r&&typeof e=="object")for(var i in e)NB(e[i],r,n)}}return t===void 0?Array.from(n):[]}function b$(e){return e?e instanceof ArrayBuffer||typeof MessagePort!="undefined"&&e instanceof MessagePort||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas:!1}var JR=function(){},ene=function(){function e(r){this.terminated=!1,this.loadableURL="";var t=r.name,n=r.source,i=r.url;OE(n||i),this.name=t,this.source=n,this.url=i,this.onMessage=JR,this.onError=function(a){return console.log(a)},this.worker=this.createBrowserWorker()}return e.isSupported=function(){return typeof Worker!="undefined"},e.prototype.destroy=function(){this.onMessage=JR,this.onError=JR,this.worker.terminate(),this.terminated=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(r,t){t=t||NB(r),this.worker.postMessage(r,t)},e.prototype.getErrorFromErrorEvent=function(r){var t="Failed to load ";return t+="worker "+this.name+" from "+this.url+". ",r.message&&(t+=r.message+" in "),r.lineno&&(t+=":"+r.lineno+":"+r.colno),new Error(t)},e.prototype.createBrowserWorker=function(){var r=this;this.loadableURL=fBe({source:this.source,url:this.url});var t=new Worker(this.loadableURL,{name:this.name});return t.onmessage=function(n){n.data?r.onMessage(n.data):r.onError(new Error("No data received"))},t.onerror=function(n){r.onError(r.getErrorFromErrorEvent(n)),r.terminated=!0},t.onmessageerror=function(n){return console.error("worker "+r.name+", message error: "+n)},t},e}(),lL=globalThis&&globalThis.__assign||function(){return lL=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},lL.apply(this,arguments)},w$=globalThis&&globalThis.__awaiter||function(e,r,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(h){o(h)}}function u(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(e,r||[])).next())})},C$=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=r.call(e,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},dBe=function(){function e(r){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=r.source,this.url=r.url,this.setProps(r)}return e.prototype.destroy=function(){this.idleQueue.forEach(function(r){return r.destroy()}),this.isDestroyed=!0},e.prototype.setProps=function(r){this.props=lL(lL({},this.props),r),r.name!==void 0&&(this.name=r.name),r.maxConcurrency!==void 0&&(this.maxConcurrency=r.maxConcurrency),r.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=r.maxMobileConcurrency),r.reuseWorkers!==void 0&&(this.reuseWorkers=r.reuseWorkers),r.onDebug!==void 0&&(this.onDebug=r.onDebug)},e.prototype.startJob=function(r,t,n){return t===void 0&&(t=function(i,a,o){return i.done(o)}),n===void 0&&(n=function(i,a){return i.error(a)}),w$(this,void 0,void 0,function(){var i,a=this;return C$(this,function(o){switch(o.label){case 0:return i=new Promise(function(s){return a.jobQueue.push({name:r,onMessage:t,onError:n,onStart:s}),a}),this.startQueuedJob(),[4,i];case 1:return[2,o.sent()]}})})},e.prototype.startQueuedJob=function(){return w$(this,void 0,void 0,function(){var r,t,n;return C$(this,function(i){switch(i.label){case 0:if(!this.jobQueue.length)return[2];if(r=this.getAvailableWorker(),!r)return[2];if(t=this.jobQueue.shift(),!t)return[3,4];this.onDebug({message:"Starting job",name:t.name,backlog:this.jobQueue.length,workerThread:r}),n=new cBe(t.name,r),r.onMessage=function(a){return t.onMessage(n,a.type,a.payload)},r.onError=function(a){return t.onError(n,a)},t.onStart(n),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,n.result];case 2:return i.sent(),[3,4];case 3:return this.returnWorkerToQueue(r),[7];case 4:return[2]}})})},e.prototype.returnWorkerToQueue=function(r){var t=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();t?(r.destroy(),this.count--):this.idleQueue.push(r),this.isDestroyed||this.startQueuedJob()},e.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var r=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new ene({name:r,source:this.source,url:this.url})}return null},e.prototype.getMaxConcurrency=function(){return lBe?this.maxMobileConcurrency:this.maxConcurrency},e}(),jC=globalThis&&globalThis.__assign||function(){return jC=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},jC.apply(this,arguments)},E$=globalThis&&globalThis.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},vBe={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},gBe=function(){function e(r){this.workerPools=new Map,this.props=jC({},vBe),this.setProps(r),this.workerPools=new Map}return e.isSupported=function(){return ene.isSupported()},e.getWorkerFarm=function(r){return r===void 0&&(r={}),e.workerFarm=e.workerFarm||new e({}),e.workerFarm.setProps(r),e.workerFarm},e.prototype.destroy=function(){var r,t;try{for(var n=E$(this.workerPools.values()),i=n.next();!i.done;i=n.next()){var a=i.value;a.destroy()}}catch(o){r={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(r)throw r.error}}},e.prototype.setProps=function(r){var t,n;this.props=jC(jC({},this.props),r);try{for(var i=E$(this.workerPools.values()),a=i.next();!a.done;a=i.next()){var o=a.value;o.setProps(this.getWorkerPoolProps())}}catch(s){t={error:s}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.getWorkerPool=function(r){var t=r.name,n=r.source,i=r.url,a=this.workerPools.get(t);return a||(a=new dBe({name:t,source:n,url:i}),a.setProps(this.getWorkerPoolProps()),this.workerPools.set(t,a)),a},e.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},e}(),eO=new Map,ry=function(){function e(){}return Object.defineProperty(e,"onmessage",{set:function(r){self.onmessage=function(t){if(!!S$(t)){var n=t.data,i=n.type,a=n.payload;r(i,a)}}},enumerable:!1,configurable:!0}),e.addEventListener=function(r){var t=eO.get(r);t||(t=function(n){if(!!S$(n)){var i=n.data,a=i.type,o=i.payload;r(a,o)}}),self.addEventListener("message",t)},e.removeEventListener=function(r){var t=eO.get(r);eO.delete(r),self.removeEventListener("message",t)},e.postMessage=function(r,t){if(self){var n={source:"Worker thread",type:r,payload:t},i=NB(t);self.postMessage(n,i)}},e}();function S$(e){var r=e.type,t=e.data;return r==="message"&&t&&typeof t.source=="string"&&t.source==="Main thread"}globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var mBe=function(){function e(){this._values=[],this._settlers=[],this._closed=!1}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.push=function(r){return this.enqueue(r)},e.prototype.enqueue=function(r){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var t=this._settlers.shift();r instanceof Error?t.reject(r):t.resolve({value:r})}else this._values.push(r)},e.prototype.close=function(){for(;this._settlers.length>0;){var r=this._settlers.shift();r.resolve({done:!0})}this._closed=!0},e.prototype.next=function(){var r=this;if(this._values.length>0){var t=this._values.shift();return t instanceof Error?Promise.reject(t):Promise.resolve({done:!1,value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(n,i){r._settlers.push({resolve:n,reject:i})})},e}(),yBe=globalThis&&globalThis.__awaiter||function(e,r,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(h){o(h)}}function u(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(e,r||[])).next())})},_Be=globalThis&&globalThis.__generator||function(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=r.call(e,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},xBe=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e[Symbol.asyncIterator],t;return r?r.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(o){return new Promise(function(s,u){o=e[a](o),i(s,u,o.done,o.value)})}}function i(a,o,s,u){Promise.resolve(u).then(function(l){a({value:l,done:s})},o)}},bBe=0,uT,A$;function wBe(e,r){var t=this;if(typeof self!="undefined"){var n={process:CBe};ry.onmessage=function(i,a){return yBe(t,void 0,void 0,function(){var o,s,u,l,f,h,p,v,m,x,E;return _Be(this,function(A){switch(A.label){case 0:switch(A.trys.push([0,19,,20]),o=i,o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!e)throw new Error("Worker does not support atomic processing");return[4,e(a.input,a.options||{},n)];case 2:return s=A.sent(),ry.postMessage("done",{result:s}),[3,18];case 3:if(!r)throw new Error("Worker does not support batched processing");uT=new mBe,A$=a.options||{},u=r(uT,A$,n),A.label=4;case 4:A.trys.push([4,9,10,15]),l=xBe(u),A.label=5;case 5:return[4,l.next()];case 6:if(f=A.sent(),!!f.done)return[3,8];h=f.value,ry.postMessage("output-batch",{result:h}),A.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return p=A.sent(),x={error:p},[3,15];case 10:return A.trys.push([10,,13,14]),f&&!f.done&&(E=l.return)?[4,E.call(l)]:[3,12];case 11:A.sent(),A.label=12;case 12:return[3,14];case 13:if(x)throw x.error;return[7];case 14:return[7];case 15:return ry.postMessage("done",{}),[3,18];case 16:return uT.push(a.input),[3,18];case 17:return uT.close(),[3,18];case 18:return[3,20];case 19:return v=A.sent(),m=v instanceof Error?v.message:"",ry.postMessage("error",{error:m}),[3,20];case 20:return[2]}})})}}}function CBe(e,r){return r===void 0&&(r={}),new Promise(function(t,n){var i=bBe++,a=function(s,u){if(u.id===i)switch(s){case"done":ry.removeEventListener(a),t(u.result);break;case"error":ry.removeEventListener(a),n(u.error);break}};ry.addEventListener(a);var o={id:i,input:e,options:r};ry.postMessage("process",o)})}globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;function zB(e){var r=e.color;return!r||!r.length?[1,1,1,1]:r}function $B(e,r,t){return t.length===2?[t[0],t[1],0]:[t[0],t[1],t[2]]}function UB(e){var r=e.filter;return r?[1]:[0]}function VB(e,r){return[r]}var GB={exports:{}};GB.exports=_k;GB.exports.default=_k;function _k(e,r,t){t=t||2;var n=r&&r.length,i=n?r[0]*t:e.length,a=tne(e,0,i,t,!0),o=[];if(!a||a.next===a.prev)return o;var s,u,l,f,h,p,v;if(n&&(a=MBe(e,r,a,t)),e.length>80*t){s=l=e[0],u=f=e[1];for(var m=t;m<i;m+=t)h=e[m],p=e[m+1],h<s&&(s=h),p<u&&(u=p),h>l&&(l=h),p>f&&(f=p);v=Math.max(l-s,f-u),v=v!==0?32767/v:0}return FE(a,o,t,s,u,v,0),o}function tne(e,r,t,n,i){var a,o;if(i===eD(e,r,t,n)>0)for(a=r;a<t;a+=n)o=T$(a,e[a],e[a+1],o);else for(a=t-n;a>=r;a-=n)o=T$(a,e[a],e[a+1],o);return o&&xk(o,o.next)&&(BE(o),o=o.next),o}function a1(e,r){if(!e)return e;r||(r=e);var t=e,n;do if(n=!1,!t.steiner&&(xk(t,t.next)||Gu(t.prev,t,t.next)===0)){if(BE(t),t=r=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==r);return r}function FE(e,r,t,n,i,a,o){if(!!e){!o&&a&&RBe(e,n,i,a);for(var s=e,u,l;e.prev!==e.next;){if(u=e.prev,l=e.next,a?SBe(e,n,i,a):EBe(e)){r.push(u.i/t|0),r.push(e.i/t|0),r.push(l.i/t|0),BE(e),e=l.next,s=l.next;continue}if(e=l,e===s){o?o===1?(e=ABe(a1(e),r,t),FE(e,r,t,n,i,a,2)):o===2&&TBe(e,r,t,n,i,a):FE(a1(e),r,t,n,i,a,1);break}}}}function EBe(e){var r=e.prev,t=e,n=e.next;if(Gu(r,t,n)>=0)return!1;for(var i=r.x,a=t.x,o=n.x,s=r.y,u=t.y,l=n.y,f=i<a?i<o?i:o:a<o?a:o,h=s<u?s<l?s:l:u<l?u:l,p=i>a?i>o?i:o:a>o?a:o,v=s>u?s>l?s:l:u>l?u:l,m=n.next;m!==r;){if(m.x>=f&&m.x<=p&&m.y>=h&&m.y<=v&&Wb(i,s,a,u,o,l,m.x,m.y)&&Gu(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function SBe(e,r,t,n){var i=e.prev,a=e,o=e.next;if(Gu(i,a,o)>=0)return!1;for(var s=i.x,u=a.x,l=o.x,f=i.y,h=a.y,p=o.y,v=s<u?s<l?s:l:u<l?u:l,m=f<h?f<p?f:p:h<p?h:p,x=s>u?s>l?s:l:u>l?u:l,E=f>h?f>p?f:p:h>p?h:p,A=Q5(v,m,r,t,n),L=Q5(x,E,r,t,n),k=e.prevZ,R=e.nextZ;k&&k.z>=A&&R&&R.z<=L;){if(k.x>=v&&k.x<=x&&k.y>=m&&k.y<=E&&k!==i&&k!==o&&Wb(s,f,u,h,l,p,k.x,k.y)&&Gu(k.prev,k,k.next)>=0||(k=k.prevZ,R.x>=v&&R.x<=x&&R.y>=m&&R.y<=E&&R!==i&&R!==o&&Wb(s,f,u,h,l,p,R.x,R.y)&&Gu(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;k&&k.z>=A;){if(k.x>=v&&k.x<=x&&k.y>=m&&k.y<=E&&k!==i&&k!==o&&Wb(s,f,u,h,l,p,k.x,k.y)&&Gu(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;R&&R.z<=L;){if(R.x>=v&&R.x<=x&&R.y>=m&&R.y<=E&&R!==i&&R!==o&&Wb(s,f,u,h,l,p,R.x,R.y)&&Gu(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function ABe(e,r,t){var n=e;do{var i=n.prev,a=n.next.next;!xk(i,a)&&rne(i,n,n.next,a)&&DE(i,a)&&DE(a,i)&&(r.push(i.i/t|0),r.push(n.i/t|0),r.push(a.i/t|0),BE(n),BE(n.next),n=e=a),n=n.next}while(n!==e);return a1(n)}function TBe(e,r,t,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&DBe(o,s)){var u=nne(o,s);o=a1(o,o.next),u=a1(u,u.next),FE(o,r,t,n,i,a,0),FE(u,r,t,n,i,a,0);return}s=s.next}o=o.next}while(o!==e)}function MBe(e,r,t,n){var i=[],a,o,s,u,l;for(a=0,o=r.length;a<o;a++)s=r[a]*n,u=a<o-1?r[a+1]*n:e.length,l=tne(e,s,u,n,!1),l===l.next&&(l.steiner=!0),i.push(FBe(l));for(i.sort(LBe),a=0;a<i.length;a++)t=IBe(i[a],t);return t}function LBe(e,r){return e.x-r.x}function IBe(e,r){var t=kBe(e,r);if(!t)return r;var n=nne(t,e);return a1(n,n.next),a1(t,t.next)}function kBe(e,r){var t=r,n=e.x,i=e.y,a=-1/0,o;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){var s=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(s<=n&&s>a&&(a=s,o=t.x<t.next.x?t:t.next,s===n))return o}t=t.next}while(t!==r);if(!o)return null;var u=o,l=o.x,f=o.y,h=1/0,p;t=o;do n>=t.x&&t.x>=l&&n!==t.x&&Wb(i<f?n:a,i,l,f,i<f?a:n,i,t.x,t.y)&&(p=Math.abs(i-t.y)/(n-t.x),DE(t,e)&&(p<h||p===h&&(t.x>o.x||t.x===o.x&&PBe(o,t)))&&(o=t,h=p)),t=t.next;while(t!==u);return o}function PBe(e,r){return Gu(e.prev,e,r.prev)<0&&Gu(r.next,e,e.next)<0}function RBe(e,r,t,n){var i=e;do i.z===0&&(i.z=Q5(i.x,i.y,r,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,OBe(i)}function OBe(e){var r,t,n,i,a,o,s,u,l=1;do{for(t=e,e=null,a=null,o=0;t;){for(o++,n=t,s=0,r=0;r<l&&(s++,n=n.nextZ,!!n);r++);for(u=l;s>0||u>0&&n;)s!==0&&(u===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,s--):(i=n,n=n.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;t=n}a.nextZ=null,l*=2}while(o>1);return e}function Q5(e,r,t,n,i){return e=(e-t)*i|0,r=(r-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e|r<<1}function FBe(e){var r=e,t=e;do(r.x<t.x||r.x===t.x&&r.y<t.y)&&(t=r),r=r.next;while(r!==e);return t}function Wb(e,r,t,n,i,a,o,s){return(i-o)*(r-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(t-o)*(r-s)&&(t-o)*(a-s)>=(i-o)*(n-s)}function DBe(e,r){return e.next.i!==r.i&&e.prev.i!==r.i&&!BBe(e,r)&&(DE(e,r)&&DE(r,e)&&NBe(e,r)&&(Gu(e.prev,e,r.prev)||Gu(e,r.prev,r))||xk(e,r)&&Gu(e.prev,e,e.next)>0&&Gu(r.prev,r,r.next)>0)}function Gu(e,r,t){return(r.y-e.y)*(t.x-r.x)-(r.x-e.x)*(t.y-r.y)}function xk(e,r){return e.x===r.x&&e.y===r.y}function rne(e,r,t,n){var i=cT(Gu(e,r,t)),a=cT(Gu(e,r,n)),o=cT(Gu(t,n,e)),s=cT(Gu(t,n,r));return!!(i!==a&&o!==s||i===0&&lT(e,t,r)||a===0&&lT(e,n,r)||o===0&&lT(t,e,n)||s===0&&lT(t,r,n))}function lT(e,r,t){return r.x<=Math.max(e.x,t.x)&&r.x>=Math.min(e.x,t.x)&&r.y<=Math.max(e.y,t.y)&&r.y>=Math.min(e.y,t.y)}function cT(e){return e>0?1:e<0?-1:0}function BBe(e,r){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==r.i&&t.next.i!==r.i&&rne(t,t.next,e,r))return!0;t=t.next}while(t!==e);return!1}function DE(e,r){return Gu(e.prev,e,e.next)<0?Gu(e,r,e.next)>=0&&Gu(e,e.prev,r)>=0:Gu(e,r,e.prev)<0||Gu(e,e.next,r)<0}function NBe(e,r){var t=e,n=!1,i=(e.x+r.x)/2,a=(e.y+r.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&i<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==e);return n}function nne(e,r){var t=new J5(e.i,e.x,e.y),n=new J5(r.i,r.x,r.y),i=e.next,a=r.prev;return e.next=r,r.prev=e,t.next=i,i.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}function T$(e,r,t,n){var i=new J5(e,r,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function BE(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function J5(e,r,t){this.i=e,this.x=r,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}_k.deviation=function(e,r,t,n){var i=r&&r.length,a=i?r[0]*t:e.length,o=Math.abs(eD(e,0,a,t));if(i)for(var s=0,u=r.length;s<u;s++){var l=r[s]*t,f=s<u-1?r[s+1]*t:e.length;o-=Math.abs(eD(e,l,f,t))}var h=0;for(s=0;s<n.length;s+=3){var p=n[s]*t,v=n[s+1]*t,m=n[s+2]*t;h+=Math.abs((e[p]-e[m])*(e[v+1]-e[p+1])-(e[p]-e[v])*(e[m+1]-e[p+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function eD(e,r,t,n){for(var i=0,a=r,o=t-n;a<t;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}_k.flatten=function(e){for(var r=e[0][0].length,t={vertices:[],holes:[],dimensions:r},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<r;o++)t.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,t.holes.push(n))}return t};var jd=GB.exports,fT=Ba();Ba();var Bl=Ba(),c0=Ba(),yb=Ba();function tO(e,r,t,n,i){Xo(e,t,n),Ud(e,e),r=l2(-e[1],e[0]);var a=l2(-t[1],t[0]);return[i/cy(r,a),r]}function f0(e,r){return Uq(e,-r[1],r[0])}function _b(e,r,t){return Xp(e,r,t),Ud(e,e),e}function rO(e,r){return e[0]===r[0]&&e[1]===r[1]}var zBe=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};st(this,e),X(this,"lastFlip",-1),X(this,"miter",l2(0,0)),X(this,"started",!1),X(this,"dash",!1),X(this,"totalDistance",0),X(this,"currentIndex",0),this.join=r.join||"miter",this.cap=r.cap||"butt",this.miterLimit=r.miterLimit||10,this.thickness=r.thickness||1,this.dash=r.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return ot(e,[{key:"extrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=i.startIndex,s=1;s<a;s++){var u,l,f,h=t[s-1];h.push((u=n[s-1][2])!==null&&u!==void 0?u:0);var p=n[s-1],v=t[s];v.push((l=n[s][2])!==null&&l!==void 0?l:0);var m=n[s],x=s<t.length-1?[].concat(Pr(t[s+1]),[(f=n[s+1][2])!==null&&f!==void 0?f:0]):null,E=s<n.length-1?n[s+1]:null,A=this.segment_gaode2(i,o,h,v,x,p,m,E);o+=A}if(this.dash)for(var L=0;L<i.positions.length/6;L++)i.positions[L*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=i.startIndex,s=1;s<a;s++){var u,l,f,h=t[s-1];h.push((u=n[s-1][2])!==null&&u!==void 0?u:0);var p=n[s-1],v=t[s];v.push((l=n[s][2])!==null&&l!==void 0?l:0);var m=n[s],x=s<t.length-1?[].concat(Pr(t[s+1]),[(f=n[s+1][2])!==null&&f!==void 0?f:0]):null,E=s<n.length-1?n[s+1]:null,A=this.simpleSegment(i,o,h,v,x,p,m,E);o+=A}if(this.dash)for(var L=0;L<i.positions.length/6;L++)i.positions[L*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,a=n.startIndex,o=1;o<i;o++){var s=t[o-1],u=t[o],l=o<t.length-1?t[o+1]:null,f=this.segment(n,a,s,u,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,a=n.startIndex,o=1;o<i;o++){var s=t[o-1],u=t[o],l=o<t.length-1?t[o+1]:null,f=this.simpleSegment(n,a,s,u,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"segment_gaode2",value:function(t,n,i,a,o,s,u,l){var f=0,h=t.indices,p=t.positions,v=t.normals,m=this.cap==="square",x=this.join==="bevel",E=nc([u[0],u[1]]),A=nc([s[0],s[1]]);_b(Bl,a,i);var L=0;if(this.dash&&(L=this.lineSegmentDistance(E,A),this.totalDistance+=L),this.normal||(this.normal=Ba(),f0(this.normal,Bl)),!this.started)if(this.started=!0,m){var k=Ba(),R=Ba();Xo(k,this.normal,Bl),Xo(R,this.normal,Bl),v.push(R[0],R[1],0),v.push(k[0],k[1],0),p.push(i[0],i[1],i[2]|0,this.totalDistance-L,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),p.push(i[0],i[1],i[2]|0,this.totalDistance-L,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(p,v,i,this.normal,this.thickness,this.totalDistance-L);if(h.push(n+0,n+1,n+2),o){rO(a,o)&&Xo(o,a,Ud(o,V0(o,a,i))),_b(c0,o,a);var j=tO(yb,Ba(),Bl,c0,this.thickness),H=tn(j,2),ee=H[0],U=H[1],W=cy(yb,this.normal)<0?-1:1,Q=x;if(!Q&&this.join==="miter"){var te=ee;te>this.miterLimit&&(Q=!0)}Q?(v.push(this.normal[0],this.normal[1],0),v.push(U[0],U[1],0),p.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*W,a[2]|0),this.complex.indexes.push(this.currentIndex),p.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*W,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,h.push.apply(h,Pr(this.lastFlip!==-W?[n,n+2,n+3]:[n+2,n+1,n+3])),h.push(n+2,n+3,n+4),f0(fT,c0),Vg(this.normal,fT),v.push(this.normal[0],this.normal[1],0),p.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*W,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f+=3):(this.extrusions(p,v,a,U,ee,this.totalDistance),h.push.apply(h,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),W=-1,Vg(this.normal,U),f+=2),this.lastFlip=W}else{if(f0(this.normal,Bl),m){var D=Ba(),$=Ba();Xp($,Bl,this.normal),Xo(D,Bl,this.normal),v.push($[0],$[1],0),v.push(D[0],D[1],0),p.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),p.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(p,v,a,this.normal,this.thickness,this.totalDistance);h.push.apply(h,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),f+=2}return f}},{key:"simpleSegment",value:function(t,n,i,a,o){var s=0,u=t.indices,l=t.positions,f=t.normals,h=nc([a[0],a[1]]),p=nc([i[0],i[1]]);_b(Bl,h,p);var v=0;if(this.dash&&(v=this.lineSegmentDistance(h,p),this.totalDistance+=v),this.normal||(this.normal=Ba(),f0(this.normal,Bl)),this.started||(this.started=!0,this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-v)),u.push(n+0,n+1,n+2),!o)f0(this.normal,Bl),this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance),u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),s+=2;else{var m=nc([o[0],o[1]]);rO(h,m)&&Xo(m,h,Ud(m,V0(m,h,p))),_b(c0,m,h);var x=tO(yb,Ba(),Bl,c0,this.thickness),E=tn(x,2),A=E[0],L=E[1],k=cy(yb,this.normal)<0?-1:1;this.extrusions(l,f,a,L,A,this.totalDistance),u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),k=-1,Vg(this.normal,L),s+=2,this.lastFlip=k}return s}},{key:"segment",value:function(t,n,i,a,o){var s=0,u=t.indices,l=t.positions,f=t.normals,h=this.cap==="square",p=this.join==="bevel",v=nc([a[0],a[1]]),m=nc([i[0],i[1]]);_b(Bl,v,m);var x=0;if(this.dash&&(x=this.lineSegmentDistance(v,m),this.totalDistance+=x),this.normal||(this.normal=Ba(),f0(this.normal,Bl)),!this.started)if(this.started=!0,h){var E=Ba(),A=Ba();Xo(E,this.normal,Bl),Xo(A,this.normal,Bl),f.push(A[0],A[1],0),f.push(E[0],E[1],0),l.push(i[0],i[1],i[2]|0,this.totalDistance-x,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),l.push(i[0],i[1],i[2]|0,this.totalDistance-x,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-x);if(u.push(n+0,n+1,n+2),o){var R=nc([o[0],o[1]]);rO(v,R)&&Xo(R,v,Ud(R,V0(R,v,m))),_b(c0,R,v);var D=tO(yb,Ba(),Bl,c0,this.thickness),$=tn(D,2),j=$[0],H=$[1],ee=cy(yb,this.normal)<0?-1:1,U=p;if(!U&&this.join==="miter"){var W=j;W>this.miterLimit&&(U=!0)}U?(f.push(this.normal[0],this.normal[1],0),f.push(H[0],H[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ee,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ee,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u.push.apply(u,Pr(this.lastFlip!==-ee?[n,n+2,n+3]:[n+2,n+1,n+3])),u.push(n+2,n+3,n+4),f0(fT,c0),Vg(this.normal,fT),f.push(this.normal[0],this.normal[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ee,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(l,f,a,H,j,this.totalDistance),u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),ee=-1,Vg(this.normal,H),s+=2),this.lastFlip=ee}else{if(f0(this.normal,Bl),h){var L=Ba(),k=Ba();Xp(k,Bl,this.normal),Xo(L,Bl,this.normal),f.push(k[0],k[1],0),f.push(L[0],L[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance);u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),s+=2}return s}},{key:"extrusions",value:function(t,n,i,a,o,s){n.push(a[0],a[1],0),n.push(a[0],a[1],0),t.push(i[0],i[1],i[2]|0,s,-o,i[2]|0),this.complex.indexes.push(this.currentIndex),t.push(i[0],i[1],i[2]|0,s,o,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,n){var i=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(i*i+a*a)}}]),e}();function cL(e){var r=e.coordinates,t=e.originCoordinates,n=e.version,i=new zBe({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=r;Array.isArray(a[0][0])||(a=[r]);var o=t;Array.isArray(o[0][0])||(o=[t]);for(var s=0;s<a.length;s++){var u=a[s],l=o[s];i.extrude_gaode2(u,l)}}else{var f=r;f[0]&&!Array.isArray(f[0][0])&&(f=[r]),f.forEach(function(p){i.extrude(p)})}var h=i.complex;return{vertices:h.positions,indices:h.indices,normals:h.normals,indexes:h.indexes,size:6}}function WC(e){var r=Yp(e.coordinates);return{vertices:[].concat(Pr(r),Pr(r),Pr(r),Pr(r)),indices:[0,1,2,2,3,0],size:r.length}}function HB(e){var r=e.coordinates,t=jd.flatten(r),n=t.vertices,i=t.dimensions,a=t.holes;return{indices:jd(n,a,i),vertices:n,size:i}}var $Be=function(){var e=Hi(Xr.mark(function r(t){var n,i,a,o,s,u,l,f,h;return Xr.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return n=t.descriptors,i=t.features,a=t.enablePicking,o=t.iconMap,s={a_Color:zB,a_Position:$B,filter:UB,a_vertexId:VB,a_PickingColor:function(x){var E=x.id;return a?Sy(E):[0,0,0]},a_DistanceAndIndex:function(x,E,A,L,k,R){return R===void 0?[A[3],10]:[A[3],R]},a_Total_Distance:function(x,E,A){return[A[5]]},a_Size:function(x){var E=x.size,A=E===void 0?1:E;return Array.isArray(A)?[A[0],A[1]]:[A,0]},a_Normal:function(x,E,A,L,k){return k},a_Miter:function(x,E,A){return[A[4]]},a_iconMapUV:function(x){var E=x.texture,A=o[E]||{x:0,y:0},L=A.x,k=A.y;return[L,k]}},u={sizePerElement:0,elements:[]},l=0,f=[],h=3,i.forEach(function(m,x){var E=cL(m),A=E.indices,L=E.vertices,k=E.normals,R=E.size,D=E.indexes;A.forEach(function(ee){f.push(ee+l)}),h=R;var $=L.length/R;u.sizePerElement=h,u.elements.push({featureIdx:x,vertices:L,normals:k,offset:l}),l+=$;for(var j=function(U){var W=(k==null?void 0:k.slice(U*3,U*3+3))||[],Q=L.slice(U*R,U*R+R),te=0;D&&D[U]!==void 0&&(te=D[U]),n.forEach(function(ie){if(ie&&s[ie.name]){var ve;(ve=ie.buffer.data).push.apply(ve,Pr(s[ie.name](m,x,Q,U,W,te)))}})},H=0;H<$;H++)j(H)}),v.abrupt("return",{descriptors:n,featureLayout:u,indices:f});case 8:case"end":return v.stop()}},r)}));return function(t){return e.apply(this,arguments)}}(),UBe=function(){var e=Hi(Xr.mark(function r(t){var n,i,a,o,s,u,l,f,h;return Xr.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return n=t.descriptors,i=t.features,a=t.enablePicking,o=t.shape2d,s={a_Color:zB,a_Position:$B,filter:UB,a_vertexId:VB,a_PickingColor:function(x){var E=x.id;return a?Sy(E):[0,0,0]},a_Shape:function(x){var E=x.shape,A=E===void 0?2:E,L=o.indexOf(A);return[L]},a_Extrude:function(x,E,A,L){var k=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],R=L%4*3;return[k[R],k[R+1],k[R+2]]},a_Size:function(x){var E=x.size,A=E===void 0?5:E;return Array.isArray(A)?[A[0]]:[A]}},u={sizePerElement:0,elements:[]},l=0,f=[],h=3,i.forEach(function(m,x){var E=WC(m),A=E.indices,L=E.vertices,k=E.normals,R=E.size,D=E.indexes;A.forEach(function(ee){f.push(ee+l)}),h=R;var $=L.length/R;u.sizePerElement=h,u.elements.push({featureIdx:x,vertices:L,normals:k,offset:l}),l+=$;for(var j=function(U){var W=(k==null?void 0:k.slice(U*3,U*3+3))||[],Q=L.slice(U*R,U*R+R),te=0;D&&D[U]!==void 0&&(te=D[U]),n.forEach(function(ie){if(ie&&s[ie.name]){var ve;(ve=ie.buffer.data).push.apply(ve,Pr(s[ie.name](m,x,Q,U,W,te)))}})},H=0;H<$;H++)j(H)}),v.abrupt("return",{descriptors:n,featureLayout:u,indices:f});case 8:case"end":return v.stop()}},r)}));return function(t){return e.apply(this,arguments)}}(),VBe=function(){var e=Hi(Xr.mark(function r(t){var n,i,a,o,s,u,l,f;return Xr.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return n=t.descriptors,i=t.features,a=t.enablePicking,o={a_Color:zB,a_Position:$B,filter:UB,a_vertexId:VB,a_PickingColor:function(m){var x=m.id;return a?Sy(x):[0,0,0]}},s={sizePerElement:0,elements:[]},u=0,l=[],f=3,i.forEach(function(v,m){var x=HB(v),E=x.indices,A=x.vertices,L=x.normals,k=x.size,R=x.indexes;E.forEach(function(H){l.push(H+u)}),f=k;var D=A.length/k;s.sizePerElement=f,s.elements.push({featureIdx:m,vertices:A,normals:L,offset:u}),u+=D;for(var $=function(ee){var U=(L==null?void 0:L.slice(ee*3,ee*3+3))||[],W=A.slice(ee*k,ee*k+k),Q=0;R&&R[ee]!==void 0&&(Q=R[ee]),n.forEach(function(te){if(te&&o[te.name]){var ie;(ie=te.buffer.data).push.apply(ie,Pr(o[te.name](v,m,W,ee,U,Q)))}})},j=0;j<D;j++)$(j)}),p.abrupt("return",{descriptors:n,featureLayout:s,indices:l});case 8:case"end":return p.stop()}},r)}));return function(t){return e.apply(this,arguments)}}(),jB={pointFill:UBe,line:$Be,polygonFill:VBe},M$=Et({},jB);function GBe(e){return tD.apply(this,arguments)}function tD(){return tD=Hi(Xr.mark(function e(r){var t,n;return Xr.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=r.workerType,n=r.data,!M$[t]){a.next=3;break}return a.abrupt("return",M$[t](n));case 3:return a.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(t,'" non-existent.'))));case 4:case"end":return a.stop()}},e)})),tD.apply(this,arguments)}wBe(GBe);var ine=new Map;function HBe(e,r){ine.set(e,r)}function jBe(e){var r=ine.get(e);return r}var WBe=`var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new O(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=w(a,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=f(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(t,r,a),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function h(){}function p(){}function v(){}var d={};s(d,i,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(S([])));g&&g!==e&&n.call(g,i)&&(d=g);var m=v.prototype=h.prototype=Object.create(d);function x(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var r;this._invoke=function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function w(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=f(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},x(b.prototype),s(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=S,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var w,E,A=function(t){return t&&t.Math==Math&&t},O=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof x&&x)||function(){return this}()||Function("return this")(),S=Object.defineProperty,T=function(t,e){try{S(O,t,{value:e,configurable:!0,writable:!0})}catch(r){O[t]=e}return e},k=O["__core-js_shared__"]||T("__core-js_shared__",{}),I=b((function(t){(t.exports=function(t,e){return k[t]||(k[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.24.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"})})),j=function(t){try{return!!t()}catch(t){return!0}},P=!j((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype,M=_.bind,L=_.call,R=P&&M.bind(L,L),C=P?function(t){return t&&R(t)}:function(t){return t&&function(){return L.apply(t,arguments)}},N=TypeError,D=function(t){if(null==t)throw N("Can't call method on "+t);return t},F=Object,W=function(t){return F(D(t))},z=C({}.hasOwnProperty),B=Object.hasOwn||function(t,e){return z(W(t),e)},U=0,G=Math.random(),V=C(1..toString),q=function(t){return"Symbol("+(void 0===t?"":t)+")_"+V(++U+G,36)},H=function(t){return"function"==typeof t},Z=function(t){return H(t)?t:void 0},Y=function(t,e){return arguments.length<2?Z(O[t]):O[t]&&O[t][e]},$=Y("navigator","userAgent")||"",K=O.process,Q=O.Deno,X=K&&K.versions||Q&&Q.version,J=X&&X.v8;J&&(E=(w=J.split("."))[0]>0&&w[0]<4?1:+(w[0]+w[1])),!E&&$&&(!(w=$.match(/Edge\\/(\\d+)/))||w[1]>=74)&&(w=$.match(/Chrome\\/(\\d+)/))&&(E=+w[1]);var tt=E,et=!!Object.getOwnPropertySymbols&&!j((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&tt&&tt<41})),rt=et&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,nt=I("wks"),ot=O.Symbol,it=ot&&ot.for,at=rt?ot:ot&&ot.withoutSetter||q,ut=function(t){if(!B(nt,t)||!et&&"string"!=typeof nt[t]){var e="Symbol."+t;et&&B(ot,t)?nt[t]=ot[t]:nt[t]=rt&&it?it(e):at(e)}return nt[t]},st={};st[ut("toStringTag")]="z";var ct="[object z]"===String(st),ft=!j((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),lt=function(t){return"object"==typeof t?null!==t:H(t)},ht=O.document,pt=lt(ht)&&lt(ht.createElement),vt=function(t){return pt?ht.createElement(t):{}},dt=!ft&&!j((function(){return 7!=Object.defineProperty(vt("div"),"a",{get:function(){return 7}}).a})),yt=ft&&j((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),gt=String,mt=TypeError,xt=function(t){if(lt(t))return t;throw mt(gt(t)+" is not an object")},bt=Function.prototype.call,wt=P?bt.bind(bt):function(){return bt.apply(bt,arguments)},Et=C({}.isPrototypeOf),At=Object,Ot=rt?function(t){return"symbol"==typeof t}:function(t){var e=Y("Symbol");return H(e)&&Et(e.prototype,At(t))},St=String,Tt=function(t){try{return St(t)}catch(t){return"Object"}},kt=TypeError,It=function(t){if(H(t))return t;throw kt(Tt(t)+" is not a function")},jt=function(t,e){var r=t[e];return null==r?void 0:It(r)},Pt=TypeError,_t=TypeError,Mt=ut("toPrimitive"),Lt=function(t,e){if(!lt(t)||Ot(t))return t;var r,n=jt(t,Mt);if(n){if(void 0===e&&(e="default"),r=wt(n,t,e),!lt(r)||Ot(r))return r;throw _t("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&H(r=t.toString)&&!lt(n=wt(r,t)))return n;if(H(r=t.valueOf)&&!lt(n=wt(r,t)))return n;if("string"!==e&&H(r=t.toString)&&!lt(n=wt(r,t)))return n;throw Pt("Can't convert object to primitive value")}(t,e)},Rt=function(t){var e=Lt(t,"string");return Ot(e)?e:e+""},Ct=TypeError,Nt=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor,Ft={f:ft?yt?function(t,e,r){if(xt(t),e=Rt(e),xt(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Dt(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return Nt(t,e,r)}:Nt:function(t,e,r){if(xt(t),e=Rt(e),xt(r),dt)try{return Nt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Ct("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Wt=Function.prototype,zt=ft&&Object.getOwnPropertyDescriptor,Bt=B(Wt,"name"),Ut={EXISTS:Bt,PROPER:Bt&&"something"===function(){}.name,CONFIGURABLE:Bt&&(!ft||ft&&zt(Wt,"name").configurable)},Gt=C(Function.toString);H(k.inspectSource)||(k.inspectSource=function(t){return Gt(t)});var Vt,qt,Ht,Zt=k.inspectSource,Yt=O.WeakMap,$t=H(Yt)&&/native code/.test(Zt(Yt)),Kt=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Qt=ft?function(t,e,r){return Ft.f(t,e,Kt(1,r))}:function(t,e,r){return t[e]=r,t},Xt=I("keys"),Jt=function(t){return Xt[t]||(Xt[t]=q(t))},te={},ee=O.TypeError,re=O.WeakMap;if($t||k.state){var ne=k.state||(k.state=new re),oe=C(ne.get),ie=C(ne.has),ae=C(ne.set);Vt=function(t,e){if(ie(ne,t))throw new ee("Object already initialized");return e.facade=t,ae(ne,t,e),e},qt=function(t){return oe(ne,t)||{}},Ht=function(t){return ie(ne,t)}}else{var ue=Jt("state");te[ue]=!0,Vt=function(t,e){if(B(t,ue))throw new ee("Object already initialized");return e.facade=t,Qt(t,ue,e),e},qt=function(t){return B(t,ue)?t[ue]:{}},Ht=function(t){return B(t,ue)}}var se={set:Vt,get:qt,has:Ht,enforce:function(t){return Ht(t)?qt(t):Vt(t,{})},getterFor:function(t){return function(e){var r;if(!lt(e)||(r=qt(e)).type!==t)throw ee("Incompatible receiver, "+t+" required");return r}}},ce=b((function(t){var e=Ut.CONFIGURABLE,r=se.enforce,n=se.get,o=Object.defineProperty,i=ft&&!j((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!B(t,"name")||e&&t.name!==n)&&(ft?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&B(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&B(u,"constructor")&&u.constructor?ft&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return B(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return H(this)&&n(this).source||Zt(this)}),"toString")})),fe=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if(H(r)&&ce(r,i,n),n.global)o?t[e]=r:T(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:Ft.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},le=C({}.toString),he=C("".slice),pe=function(t){return he(le(t),8,-1)},ve=ut("toStringTag"),de=Object,ye="Arguments"==pe(function(){return arguments}()),ge=ct?pe:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=de(t),ve))?r:ye?pe(e):"Object"==(n=pe(e))&&H(e.callee)?"Arguments":n},me=ct?{}.toString:function(){return"[object "+ge(this)+"]"};ct||fe(Object.prototype,"toString",me,{unsafe:!0});var xe={}.propertyIsEnumerable,be=Object.getOwnPropertyDescriptor,we={f:be&&!xe.call({1:2},1)?function(t){var e=be(this,t);return!!e&&e.enumerable}:xe},Ee=Object,Ae=C("".split),Oe=j((function(){return!Ee("z").propertyIsEnumerable(0)}))?function(t){return"String"==pe(t)?Ae(t,""):Ee(t)}:Ee,Se=function(t){return Oe(D(t))},Te=Object.getOwnPropertyDescriptor,ke={f:ft?Te:function(t,e){if(t=Se(t),e=Rt(e),dt)try{return Te(t,e)}catch(t){}if(B(t,e))return Kt(!wt(we.f,t,e),t[e])}},Ie=Math.ceil,je=Math.floor,Pe=Math.trunc||function(t){var e=+t;return(e>0?je:Ie)(e)},_e=function(t){var e=+t;return e!=e||0===e?0:Pe(e)},Me=Math.max,Le=Math.min,Re=function(t,e){var r=_e(t);return r<0?Me(r+e,0):Le(r,e)},Ce=Math.min,Ne=function(t){return t>0?Ce(_e(t),9007199254740991):0},De=function(t){return Ne(t.length)},Fe=function(t){return function(e,r,n){var o,i=Se(e),a=De(i),u=Re(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},We={includes:Fe(!0),indexOf:Fe(!1)},ze=We.indexOf,Be=C([].push),Ue=function(t,e){var r,n=Se(t),o=0,i=[];for(r in n)!B(te,r)&&B(n,r)&&Be(i,r);for(;e.length>o;)B(n,r=e[o++])&&(~ze(i,r)||Be(i,r));return i},Ge=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ve=Ge.concat("length","prototype"),qe={f:Object.getOwnPropertyNames||function(t){return Ue(t,Ve)}},He={f:Object.getOwnPropertySymbols},Ze=C([].concat),Ye=Y("Reflect","ownKeys")||function(t){var e=qe.f(xt(t)),r=He.f;return r?Ze(e,r(t)):e},$e=function(t,e,r){for(var n=Ye(e),o=Ft.f,i=ke.f,a=0;a<n.length;a++){var u=n[a];B(t,u)||r&&B(r,u)||o(t,u,i(e,u))}},Ke=/#|\\.prototype\\./,Qe=function(t,e){var r=Je[Xe(t)];return r==er||r!=tr&&(H(e)?j(e):!!e)},Xe=Qe.normalize=function(t){return String(t).replace(Ke,".").toLowerCase()},Je=Qe.data={},tr=Qe.NATIVE="N",er=Qe.POLYFILL="P",rr=Qe,nr=ke.f,or=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?O:c?O[u]||T(u,{}):(O[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=nr(r,n))&&a.value:r[n],!rr(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;$e(i,o)}(t.sham||o&&o.sham)&&Qt(i,"sham",!0),fe(r,n,i,t)}},ir="process"==pe(O.process),ar=String,ur=TypeError,sr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=C(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return xt(r),function(t){if("object"==typeof t||H(t))return t;throw ur("Can't set "+ar(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),cr=Ft.f,fr=ut("toStringTag"),lr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!B(t,fr)&&cr(t,fr,{configurable:!0,value:e})},hr=ut("species"),pr=function(t){var e=Y(t),r=Ft.f;ft&&e&&!e[hr]&&r(e,hr,{configurable:!0,get:function(){return this}})},vr=TypeError,dr=function(t,e){if(Et(e,t))return t;throw vr("Incorrect invocation")},yr=function(){},gr=[],mr=Y("Reflect","construct"),xr=/^\\s*(?:class|function)\\b/,br=C(xr.exec),wr=!xr.exec(yr),Er=function(t){if(!H(t))return!1;try{return mr(yr,gr,t),!0}catch(t){return!1}},Ar=function(t){if(!H(t))return!1;switch(ge(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return wr||!!br(xr,Zt(t))}catch(t){return!0}};Ar.sham=!0;var Or,Sr,Tr,kr,Ir=!mr||j((function(){var t;return Er(Er.call)||!Er(Object)||!Er((function(){t=!0}))||t}))?Ar:Er,jr=TypeError,Pr=function(t){if(Ir(t))return t;throw jr(Tt(t)+" is not a constructor")},_r=ut("species"),Mr=function(t,e){var r,n=xt(t).constructor;return void 0===n||null==(r=xt(n)[_r])?e:Pr(r)},Lr=Function.prototype,Rr=Lr.apply,Cr=Lr.call,Nr="object"==typeof Reflect&&Reflect.apply||(P?Cr.bind(Rr):function(){return Cr.apply(Rr,arguments)}),Dr=C(C.bind),Fr=function(t,e){return It(t),void 0===e?t:P?Dr(t,e):function(){return t.apply(e,arguments)}},Wr=Y("document","documentElement"),zr=C([].slice),Br=TypeError,Ur=function(t,e){if(t<e)throw Br("Not enough arguments");return t},Gr=/(?:ipad|iphone|ipod).*applewebkit/i.test($),Vr=O.setImmediate,qr=O.clearImmediate,Hr=O.process,Zr=O.Dispatch,Yr=O.Function,$r=O.MessageChannel,Kr=O.String,Qr=0,Xr={};try{Or=O.location}catch(t){}var Jr=function(t){if(B(Xr,t)){var e=Xr[t];delete Xr[t],e()}},tn=function(t){return function(){Jr(t)}},en=function(t){Jr(t.data)},rn=function(t){O.postMessage(Kr(t),Or.protocol+"//"+Or.host)};Vr&&qr||(Vr=function(t){Ur(arguments.length,1);var e=H(t)?t:Yr(t),r=zr(arguments,1);return Xr[++Qr]=function(){Nr(e,void 0,r)},Sr(Qr),Qr},qr=function(t){delete Xr[t]},ir?Sr=function(t){Hr.nextTick(tn(t))}:Zr&&Zr.now?Sr=function(t){Zr.now(tn(t))}:$r&&!Gr?(kr=(Tr=new $r).port2,Tr.port1.onmessage=en,Sr=Fr(kr.postMessage,kr)):O.addEventListener&&H(O.postMessage)&&!O.importScripts&&Or&&"file:"!==Or.protocol&&!j(rn)?(Sr=rn,O.addEventListener("message",en,!1)):Sr="onreadystatechange"in vt("script")?function(t){Wr.appendChild(vt("script")).onreadystatechange=function(){Wr.removeChild(this),Jr(t)}}:function(t){setTimeout(tn(t),0)});var nn,on,an,un,sn,cn,fn,ln,hn={set:Vr,clear:qr},pn=/ipad|iphone|ipod/i.test($)&&void 0!==O.Pebble,vn=/web0s(?!.*chrome)/i.test($),dn=ke.f,yn=hn.set,gn=O.MutationObserver||O.WebKitMutationObserver,mn=O.document,xn=O.process,bn=O.Promise,wn=dn(O,"queueMicrotask"),En=wn&&wn.value;En||(nn=function(){var t,e;for(ir&&(t=xn.domain)&&t.exit();on;){e=on.fn,on=on.next;try{e()}catch(t){throw on?un():an=void 0,t}}an=void 0,t&&t.enter()},Gr||ir||vn||!gn||!mn?!pn&&bn&&bn.resolve?((fn=bn.resolve(void 0)).constructor=bn,ln=Fr(fn.then,fn),un=function(){ln(nn)}):ir?un=function(){xn.nextTick(nn)}:(yn=Fr(yn,O),un=function(){yn(nn)}):(sn=!0,cn=mn.createTextNode(""),new gn(nn).observe(cn,{characterData:!0}),un=function(){cn.data=sn=!sn}));var An=En||function(t){var e={fn:t,next:void 0};an&&(an.next=e),on||(on=e,un()),an=e},On=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Sn=function(){this.head=null,this.tail=null};Sn.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var Tn,kn,In,jn=Sn,Pn=O.Promise,_n="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Mn=!_n&&!ir&&"object"==typeof window&&"object"==typeof document,Ln=(Pn&&Pn.prototype,ut("species")),Rn=!1,Cn=H(O.PromiseRejectionEvent),Nn={CONSTRUCTOR:rr("Promise",(function(){var t=Zt(Pn),e=t!==String(Pn);if(!e&&66===tt)return!0;if(!tt||tt<51||!/native code/.test(t)){var r=new Pn((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Ln]=n,!(Rn=r.then((function(){}))instanceof n))return!0}return!e&&(Mn||_n)&&!Cn})),REJECTION_EVENT:Cn,SUBCLASSING:Rn},Dn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n})),this.resolve=It(e),this.reject=It(r)},Fn={f:function(t){return new Dn(t)}},Wn=hn.set,zn=Nn.CONSTRUCTOR,Bn=Nn.REJECTION_EVENT,Un=Nn.SUBCLASSING,Gn=se.getterFor("Promise"),Vn=se.set,qn=Pn&&Pn.prototype,Hn=Pn,Zn=qn,Yn=O.TypeError,$n=O.document,Kn=O.process,Qn=Fn.f,Xn=Qn,Jn=!!($n&&$n.createEvent&&O.dispatchEvent),to=function(t){var e;return!(!lt(t)||!H(e=t.then))&&e},eo=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&ao(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Yn("Promise-chain cycle")):(n=to(r))?wt(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},ro=function(t,e){t.notified||(t.notified=!0,An((function(){for(var r,n=t.reactions;r=n.get();)eo(r,t);t.notified=!1,e&&!t.rejection&&oo(t)})))},no=function(t,e,r){var n,o;Jn?((n=$n.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),O.dispatchEvent(n)):n={promise:e,reason:r},!Bn&&(o=O["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=O.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},oo=function(t){wt(Wn,O,(function(){var e,r=t.facade,n=t.value;if(io(t)&&(e=On((function(){ir?Kn.emit("unhandledRejection",n,r):no("unhandledrejection",r,n)})),t.rejection=ir||io(t)?2:1,e.error))throw e.value}))},io=function(t){return 1!==t.rejection&&!t.parent},ao=function(t){wt(Wn,O,(function(){var e=t.facade;ir?Kn.emit("rejectionHandled",e):no("rejectionhandled",e,t.value)}))},uo=function(t,e,r){return function(n){t(e,n,r)}},so=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,ro(t,!0))},co=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Yn("Promise can't be resolved itself");var n=to(e);n?An((function(){var r={done:!1};try{wt(n,e,uo(co,r,t),uo(so,r,t))}catch(e){so(r,e,t)}})):(t.value=e,t.state=1,ro(t,!1))}catch(e){so({done:!1},e,t)}}};if(zn&&(Zn=(Hn=function(t){dr(this,Zn),It(t),wt(Tn,this);var e=Gn(this);try{t(uo(co,e),uo(so,e))}catch(t){so(e,t)}}).prototype,(Tn=function(t){Vn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new jn,rejection:!1,state:0,value:void 0})}).prototype=fe(Zn,"then",(function(t,e){var r=Gn(this),n=Qn(Mr(this,Hn));return r.parent=!0,n.ok=!H(t)||t,n.fail=H(e)&&e,n.domain=ir?Kn.domain:void 0,0==r.state?r.reactions.add(n):An((function(){eo(n,r)})),n.promise})),kn=function(){var t=new Tn,e=Gn(t);this.promise=t,this.resolve=uo(co,e),this.reject=uo(so,e)},Fn.f=Qn=function(t){return t===Hn||void 0===t?new kn(t):Xn(t)},H(Pn)&&qn!==Object.prototype)){In=qn.then,Un||fe(qn,"then",(function(t,e){var r=this;return new Hn((function(t,e){wt(In,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete qn.constructor}catch(t){}sr&&sr(qn,Zn)}or({global:!0,constructor:!0,wrap:!0,forced:zn},{Promise:Hn}),lr(Hn,"Promise",!1),pr("Promise");var fo={},lo=ut("iterator"),ho=Array.prototype,po=function(t){return void 0!==t&&(fo.Array===t||ho[lo]===t)},vo=ut("iterator"),yo=function(t){if(null!=t)return jt(t,vo)||jt(t,"@@iterator")||fo[ge(t)]},go=TypeError,mo=function(t,e){var r=arguments.length<2?yo(t):e;if(It(r))return xt(wt(r,t));throw go(Tt(t)+" is not iterable")},xo=function(t,e,r){var n,o;xt(t);try{if(!(n=jt(t,"return"))){if("throw"===e)throw r;return r}n=wt(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return xt(n),r},bo=TypeError,wo=function(t,e){this.stopped=t,this.result=e},Eo=wo.prototype,Ao=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=Fr(e,f),y=function(t){return n&&xo(n,"normal",t),new wo(!0,t)},g=function(t){return l?(xt(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=yo(t)))throw bo(Tt(t)+" is not iterable");if(po(o)){for(i=0,a=De(t);a>i;i++)if((u=g(t[i]))&&Et(Eo,u))return u;return new wo(!1)}n=mo(t,o)}for(s=h?t.next:n.next;!(c=wt(s,n)).done;){try{u=g(c.value)}catch(t){xo(n,"throw",t)}if("object"==typeof u&&u&&Et(Eo,u))return u}return new wo(!1)},Oo=ut("iterator"),So=!1;try{var To=0,ko={next:function(){return{done:!!To++}},return:function(){So=!0}};ko[Oo]=function(){return this},Array.from(ko,(function(){throw 2}))}catch(t){}var Io=function(t,e){if(!e&&!So)return!1;var r=!1;try{var n={};n[Oo]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},jo=Nn.CONSTRUCTOR||!Io((function(t){Pn.all(t).then(void 0,(function(){}))}));or({target:"Promise",stat:!0,forced:jo},{all:function(t){var e=this,r=Fn.f(e),n=r.resolve,o=r.reject,i=On((function(){var r=It(e.resolve),i=[],a=0,u=1;Ao(t,(function(t){var s=a++,c=!1;u++,wt(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Po=Nn.CONSTRUCTOR,_o=Pn&&Pn.prototype;if(or({target:"Promise",proto:!0,forced:Po,real:!0},{catch:function(t){return this.then(void 0,t)}}),H(Pn)){var Mo=Y("Promise").prototype.catch;_o.catch!==Mo&&fe(_o,"catch",Mo,{unsafe:!0})}or({target:"Promise",stat:!0,forced:jo},{race:function(t){var e=this,r=Fn.f(e),n=r.reject,o=On((function(){var o=It(e.resolve);Ao(t,(function(t){wt(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),or({target:"Promise",stat:!0,forced:Nn.CONSTRUCTOR},{reject:function(t){var e=Fn.f(this);return wt(e.reject,void 0,t),e.promise}});var Lo=Nn.CONSTRUCTOR;Y("Promise");function Ro(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}or({target:"Promise",stat:!0,forced:Lo},{resolve:function(t){return function(t,e){if(xt(t),lt(e)&&e.constructor===t)return e;var r=Fn.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Co="undefined"!=typeof window&&void 0!==window.orientation,No=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Ro(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Ro(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),Do=new Map;function Fo(t){Ro(t.source&&!t.url||!t.source&&t.url);var e=Do.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Wo((e=t,"try {\\n  importScripts('"+e+"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),Do.set(t.url,e)),t.source&&(e=Wo(t.source),Do.set(t.source,e))),Ro(e),e}function Wo(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function zo(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Bo(t))n.add(t);else if(Bo(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)zo(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Bo(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Uo=function(){},Go=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Ro(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=Uo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=Uo,this.onError=Uo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||zo(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Fo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Vo=self&&self.__assign||function(){return(Vo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},qo=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},Ho=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Zo=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Vo(Vo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),qo(this,void 0,void 0,(function(){var n,o=this;return Ho(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return qo(this,void 0,void 0,(function(){var t,e,r;return Ho(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new No(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Go({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Co?this.maxMobileConcurrency:this.maxConcurrency},t}(),Yo=self&&self.__assign||function(){return(Yo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},$o=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ko={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},Qo=(function(){function t(t){this.workerPools=new Map,this.props=Yo({},Ko),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return Go.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=$o(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Yo(Yo({},this.props),t);try{for(var n=$o(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Zo({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),Xo=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(Jo(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=Qo.get(t);e||(e=function(e){if(Jo(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=Qo.get(t);Qo.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=zo(e);self.postMessage(r,n)}},t}();function Jo(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var ti,ei,ri=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ni=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},oi=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ii=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},ai=0;function ui(t,e){var r=this;if("undefined"!=typeof self){var n={process:si};Xo.onmessage=function(o,i){return ni(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return oi(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),Xo.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");ti=new ri,ei=i.options||{},a=e(ti,ei,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=ii(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,Xo.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return Xo.postMessage("done",{}),[3,18];case 16:return ti.push(i.input),[3,18];case 17:return ti.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",Xo.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function si(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=ai++,i=function(t,e){if(e.id===o)switch(t){case"done":Xo.removeEventListener(i),r(e.result);break;case"error":Xo.removeEventListener(i),n(e.error)}};Xo.addEventListener(i);var a={id:o,input:t,options:e};Xo.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var ci={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},fi=vt("span").classList,li=fi&&fi.constructor&&fi.constructor.prototype,hi=li===Object.prototype?void 0:li,pi=Array.isArray||function(t){return"Array"==pe(t)},vi=ut("species"),di=Array,yi=function(t,e){return new(function(t){var e;return pi(t)&&(e=t.constructor,(Ir(e)&&(e===di||pi(e.prototype))||lt(e)&&null===(e=e[vi]))&&(e=void 0)),void 0===e?di:e}(t))(0===e?0:e)},gi=C([].push),mi=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=W(s),d=Oe(v),y=Fr(c,f),g=De(d),m=0,x=l||yi,b=e?x(s,g):r||a?x(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)b[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:gi(b,h)}else switch(t){case 4:return!1;case 7:gi(b,h)}return i?-1:n||o?o:b}},xi={forEach:mi(0),map:mi(1),filter:mi(2),some:mi(3),every:mi(4),find:mi(5),findIndex:mi(6),filterReject:mi(7)},bi=function(t,e){var r=[][t];return!!r&&j((function(){r.call(null,e||function(){return 1},1)}))},wi=xi.forEach,Ei=bi("forEach")?[].forEach:function(t){return wi(this,t,arguments.length>1?arguments[1]:void 0)},Ai=function(t){if(t&&t.forEach!==Ei)try{Qt(t,"forEach",Ei)}catch(e){t.forEach=Ei}};for(var Oi in ci)ci[Oi]&&Ai(O[Oi]&&O[Oi].prototype);Ai(hi);var Si=function(t,e,r){var n=Rt(e);n in t?Ft.f(t,n,Kt(0,r)):t[n]=r},Ti=ut("species"),ki=function(t){return tt>=51||!j((function(){var e=[];return(e.constructor={})[Ti]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Ii=ki("slice"),ji=ut("species"),Pi=Array,_i=Math.max;or({target:"Array",proto:!0,forced:!Ii},{slice:function(t,e){var r,n,o,i=Se(this),a=De(i),u=Re(t,a),s=Re(void 0===e?a:e,a);if(pi(i)&&(r=i.constructor,(Ir(r)&&(r===Pi||pi(r.prototype))||lt(r)&&null===(r=r[ji]))&&(r=void 0),r===Pi||void 0===r))return zr(i,u,s);for(n=new(void 0===r?Pi:r)(_i(s-u,0)),o=0;u<s;u++,o++)u in i&&Si(n,o,i[u]);return n.length=o,n}});var Mi=Ut.EXISTS,Li=Ft.f,Ri=Function.prototype,Ci=C(Ri.toString),Ni=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,Di=C(Ni.exec);ft&&!Mi&&Li(Ri,"name",{configurable:!0,get:function(){try{return Di(Ni,Ci(this))[1]}catch(t){return""}}});var Fi=xi.map,Wi=ki("map");or({target:"Array",proto:!0,forced:!Wi},{map:function(t){return Fi(this,t,arguments.length>1?arguments[1]:void 0)}});var zi,Bi=Object.keys||function(t){return Ue(t,Ge)},Ui={f:ft&&!yt?Object.defineProperties:function(t,e){xt(t);for(var r,n=Se(e),o=Bi(e),i=o.length,a=0;i>a;)Ft.f(t,r=o[a++],n[r]);return t}},Gi=Jt("IE_PROTO"),Vi=function(){},qi=function(t){return"<script>"+t+"<\\/script>"},Hi=function(t){t.write(qi("")),t.close();var e=t.parentWindow.Object;return t=null,e},Zi=function(){try{zi=new ActiveXObject("htmlfile")}catch(t){}var t,e;Zi="undefined"!=typeof document?document.domain&&zi?Hi(zi):((e=vt("iframe")).style.display="none",Wr.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(qi("document.F=Object")),t.close(),t.F):Hi(zi);for(var r=Ge.length;r--;)delete Zi.prototype[Ge[r]];return Zi()};te[Gi]=!0;var Yi=Object.create||function(t,e){var r;return null!==t?(Vi.prototype=xt(t),r=new Vi,Vi.prototype=null,r[Gi]=t):r=Zi(),void 0===e?r:Ui.f(r,e)},$i=Ft.f,Ki=ut("unscopables"),Qi=Array.prototype;null==Qi[Ki]&&$i(Qi,Ki,{configurable:!0,value:Yi(null)});var Xi,Ji,ta,ea=function(t){Qi[Ki][t]=!0},ra=!j((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),na=Jt("IE_PROTO"),oa=Object,ia=oa.prototype,aa=ra?oa.getPrototypeOf:function(t){var e=W(t);if(B(e,na))return e[na];var r=e.constructor;return H(r)&&e instanceof r?r.prototype:e instanceof oa?ia:null},ua=ut("iterator"),sa=!1;[].keys&&("next"in(ta=[].keys())?(Ji=aa(aa(ta)))!==Object.prototype&&(Xi=Ji):sa=!0),(null==Xi||j((function(){var t={};return Xi[ua].call(t)!==t})))&&(Xi={}),H(Xi[ua])||fe(Xi,ua,(function(){return this}));var ca={IteratorPrototype:Xi,BUGGY_SAFARI_ITERATORS:sa},fa=ca.IteratorPrototype,la=function(){return this},ha=Ut.PROPER,pa=Ut.CONFIGURABLE,va=ca.IteratorPrototype,da=ca.BUGGY_SAFARI_ITERATORS,ya=ut("iterator"),ga=function(){return this},ma=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Yi(fa,{next:Kt(+!n,r)}),lr(t,o,!1),fo[o]=la}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!da&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[ya]||p["@@iterator"]||o&&p[o],d=!da&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=aa(y.call(new t)))!==Object.prototype&&u.next&&(aa(u)!==va&&(sr?sr(u,va):H(u[ya])||fe(u,ya,ga)),lr(u,l,!0)),ha&&"values"==o&&v&&"values"!==v.name&&(pa?Qt(p,"name","values"):(h=!0,d=function(){return wt(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(da||h||!(c in p))&&fe(p,c,s[c]);else or({target:e,proto:!0,forced:da||h},s);return p[ya]!==d&&fe(p,ya,d,{name:o}),fo[e]=d,s},xa=Ft.f,ba=se.set,wa=se.getterFor("Array Iterator"),Ea=ma(Array,"Array",(function(t,e){ba(this,{type:"Array Iterator",target:Se(t),index:0,kind:e})}),(function(){var t=wa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values"),Aa=fo.Arguments=fo.Array;if(ea("keys"),ea("values"),ea("entries"),ft&&"values"!==Aa.name)try{xa(Aa,"name",{value:"values"})}catch(t){}var Oa,Sa,Ta,ka="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ia=Ft.f,ja=se.enforce,Pa=se.get,_a=O.Int8Array,Ma=_a&&_a.prototype,La=O.Uint8ClampedArray,Ra=La&&La.prototype,Ca=_a&&aa(_a),Na=Ma&&aa(Ma),Da=Object.prototype,Fa=O.TypeError,Wa=ut("toStringTag"),za=q("TYPED_ARRAY_TAG"),Ba=ka&&!!sr&&"Opera"!==ge(O.opera),Ua=!1,Ga={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Va={BigInt64Array:8,BigUint64Array:8},qa=function(t){var e=aa(t);if(lt(e)){var r=Pa(e);return r&&B(r,"TypedArrayConstructor")?r.TypedArrayConstructor:qa(e)}},Ha=function(t){if(!lt(t))return!1;var e=ge(t);return B(Ga,e)||B(Va,e)};for(Oa in Ga)(Ta=(Sa=O[Oa])&&Sa.prototype)?ja(Ta).TypedArrayConstructor=Sa:Ba=!1;for(Oa in Va)(Ta=(Sa=O[Oa])&&Sa.prototype)&&(ja(Ta).TypedArrayConstructor=Sa);if((!Ba||!H(Ca)||Ca===Function.prototype)&&(Ca=function(){throw Fa("Incorrect invocation")},Ba))for(Oa in Ga)O[Oa]&&sr(O[Oa],Ca);if((!Ba||!Na||Na===Da)&&(Na=Ca.prototype,Ba))for(Oa in Ga)O[Oa]&&sr(O[Oa].prototype,Na);if(Ba&&aa(Ra)!==Na&&sr(Ra,Na),ft&&!B(Na,Wa))for(Oa in Ua=!0,Ia(Na,Wa,{get:function(){return lt(this)?this[za]:void 0}}),Ga)O[Oa]&&Qt(O[Oa],za,Oa);var Za={NATIVE_ARRAY_BUFFER_VIEWS:Ba,TYPED_ARRAY_TAG:Ua&&za,aTypedArray:function(t){if(Ha(t))return t;throw Fa("Target is not a typed array")},aTypedArrayConstructor:function(t){if(H(t)&&(!sr||Et(Ca,t)))return t;throw Fa(Tt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(ft){if(r)for(var o in Ga){var i=O[o];if(i&&B(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}Na[t]&&!r||fe(Na,t,r?e:Ba&&Ma[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(ft){if(sr){if(r)for(n in Ga)if((o=O[n])&&B(o,t))try{delete o[t]}catch(t){}if(Ca[t]&&!r)return;try{return fe(Ca,t,r?e:Ba&&Ca[t]||e)}catch(t){}}for(n in Ga)!(o=O[n])||o[t]&&!r||fe(o,t,e)}},getTypedArrayConstructor:qa,isView:function(t){if(!lt(t))return!1;var e=ge(t);return"DataView"===e||B(Ga,e)||B(Va,e)},isTypedArray:Ha,TypedArray:Ca,TypedArrayPrototype:Na},Ya=Za.NATIVE_ARRAY_BUFFER_VIEWS,$a=O.ArrayBuffer,Ka=O.Int8Array,Qa=!Ya||!j((function(){Ka(1)}))||!j((function(){new Ka(-1)}))||!Io((function(t){new Ka,new Ka(null),new Ka(1.5),new Ka(t)}),!0)||j((function(){return 1!==new Ka(new $a(2),1,void 0).length})),Xa=function(t,e,r){for(var n in e)fe(t,n,e[n],r);return t},Ja=RangeError,tu=function(t){if(void 0===t)return 0;var e=_e(t),r=Ne(e);if(e!==r)throw Ja("Wrong length or index");return r},eu=Array,ru=Math.abs,nu=Math.pow,ou=Math.floor,iu=Math.log,au=Math.LN2,uu=function(t,e,r){var n,o,i,a=eu(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?nu(2,-24)-nu(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=ru(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=ou(iu(t)/au),t*(i=nu(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*nu(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*nu(2,e),n+=c):(o=t*nu(2,c-1)*nu(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},su=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=nu(2,e),f-=a}return(c?-1:1)*r*nu(2,f-e)},cu=function(t){for(var e=W(this),r=De(e),n=arguments.length,o=Re(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Re(i,r);a>o;)e[o++]=t;return e},fu=Array,lu=Math.max,hu=function(t,e,r){for(var n=De(t),o=Re(e,n),i=Re(void 0===r?n:r,n),a=fu(lu(i-o,0)),u=0;o<i;o++,u++)Si(a,u,t[o]);return a.length=u,a},pu=qe.f,vu=Ft.f,du=Ut.PROPER,yu=Ut.CONFIGURABLE,gu=se.get,mu=se.set,xu=O.ArrayBuffer,bu=xu,wu=bu&&bu.prototype,Eu=O.DataView,Au=Eu&&Eu.prototype,Ou=Object.prototype,Su=O.Array,Tu=O.RangeError,ku=C(cu),Iu=C([].reverse),ju=uu,Pu=su,_u=function(t){return[255&t]},Mu=function(t){return[255&t,t>>8&255]},Lu=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Ru=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Cu=function(t){return ju(t,23,4)},Nu=function(t){return ju(t,52,8)},Du=function(t,e){vu(t.prototype,e,{get:function(){return gu(this)[e]}})},Fu=function(t,e,r,n){var o=tu(r),i=gu(t);if(o+e>i.byteLength)throw Tu("Wrong index");var a=gu(i.buffer).bytes,u=o+i.byteOffset,s=hu(a,u,u+e);return n?s:Iu(s)},Wu=function(t,e,r,n,o,i){var a=tu(r),u=gu(t);if(a+e>u.byteLength)throw Tu("Wrong index");for(var s=gu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(ka){var zu=du&&"ArrayBuffer"!==xu.name;if(j((function(){xu(1)}))&&j((function(){new xu(-1)}))&&!j((function(){return new xu,new xu(1.5),new xu(NaN),zu&&!yu})))zu&&yu&&Qt(xu,"name","ArrayBuffer");else{(bu=function(t){return dr(this,wu),new xu(tu(t))}).prototype=wu;for(var Bu,Uu=pu(xu),Gu=0;Uu.length>Gu;)(Bu=Uu[Gu++])in bu||Qt(bu,Bu,xu[Bu]);wu.constructor=bu}sr&&aa(Au)!==Ou&&sr(Au,Ou);var Vu=new Eu(new bu(2)),qu=C(Au.setInt8);Vu.setInt8(0,2147483648),Vu.setInt8(1,2147483649),!Vu.getInt8(0)&&Vu.getInt8(1)||Xa(Au,{setInt8:function(t,e){qu(this,t,e<<24>>24)},setUint8:function(t,e){qu(this,t,e<<24>>24)}},{unsafe:!0})}else wu=(bu=function(t){dr(this,wu);var e=tu(t);mu(this,{bytes:ku(Su(e),0),byteLength:e}),ft||(this.byteLength=e)}).prototype,Au=(Eu=function(t,e,r){dr(this,Au),dr(t,wu);var n=gu(t).byteLength,o=_e(e);if(o<0||o>n)throw Tu("Wrong offset");if(o+(r=void 0===r?n-o:Ne(r))>n)throw Tu("Wrong length");mu(this,{buffer:t,byteLength:r,byteOffset:o}),ft||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,ft&&(Du(bu,"byteLength"),Du(Eu,"buffer"),Du(Eu,"byteLength"),Du(Eu,"byteOffset")),Xa(Au,{getInt8:function(t){return Fu(this,1,t)[0]<<24>>24},getUint8:function(t){return Fu(this,1,t)[0]},getInt16:function(t){var e=Fu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Fu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Ru(Fu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Ru(Fu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Pu(Fu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Pu(Fu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Wu(this,1,t,_u,e)},setUint8:function(t,e){Wu(this,1,t,_u,e)},setInt16:function(t,e){Wu(this,2,t,Mu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Wu(this,2,t,Mu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Wu(this,4,t,Lu,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Wu(this,4,t,Lu,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Wu(this,4,t,Cu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Wu(this,8,t,Nu,e,arguments.length>2?arguments[2]:void 0)}});lr(bu,"ArrayBuffer"),lr(Eu,"DataView");var Hu={ArrayBuffer:bu,DataView:Eu},Zu=Math.floor,Yu=Number.isInteger||function(t){return!lt(t)&&isFinite(t)&&Zu(t)===t},$u=RangeError,Ku=RangeError,Qu=function(t,e){var r=function(t){var e=_e(t);if(e<0)throw $u("The argument can't be less than 0");return e}(t);if(r%e)throw Ku("Wrong offset");return r},Xu=Za.aTypedArrayConstructor,Ju=function(t){var e,r,n,o,i,a,u=Pr(this),s=W(t),c=arguments.length,f=c>1?arguments[1]:void 0,l=void 0!==f,h=yo(s);if(h&&!po(h))for(a=(i=mo(s,h)).next,s=[];!(o=wt(a,i)).done;)s.push(o.value);for(l&&c>2&&(f=Fr(f,arguments[2])),r=De(s),n=new(Xu(u))(r),e=0;r>e;e++)n[e]=l?f(s[e],e):s[e];return n},ts=function(t,e,r){var n,o;return sr&&H(n=e.constructor)&&n!==r&&lt(o=n.prototype)&&o!==r.prototype&&sr(t,o),t},es=b((function(t){var e=qe.f,r=xi.forEach,n=se.get,o=se.set,i=se.enforce,a=Ft.f,u=ke.f,s=Math.round,c=O.RangeError,f=Hu.ArrayBuffer,l=f.prototype,h=Hu.DataView,p=Za.NATIVE_ARRAY_BUFFER_VIEWS,v=Za.TYPED_ARRAY_TAG,d=Za.TypedArray,y=Za.TypedArrayPrototype,g=Za.aTypedArrayConstructor,m=Za.isTypedArray,x=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},b=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return Et(l,t)||"ArrayBuffer"==(e=ge(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!Ot(e)&&e in t&&Yu(+e)&&e>=0},A=function(t,e){return e=Rt(e),E(t,e)?Kt(2,t[e]):u(t,e)},S=function(t,e,r){return e=Rt(e),!(E(t,e)&&lt(r)&&B(r,"value"))||B(r,"get")||B(r,"set")||r.configurable||B(r,"writable")&&!r.writable||B(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};ft?(p||(ke.f=A,Ft.f=S,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),or({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:S}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,b=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,S=O[b],T=S,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?Qa&&(T=u((function(t,e,r,n){return dr(t,k),ts(lt(e)?w(e)?void 0!==n?new S(e,Qu(r,g),n):void 0!==r?new S(e,Qu(r,g)):new S(e):m(e)?x(T,e):wt(Ju,T,e):new S(tu(e)),t,T)})),sr&&sr(T,d),r(e(S),(function(t){t in T||Qt(T,t,S[t])})),T.prototype=k):(T=u((function(t,e,r,n){dr(t,k);var i,a,u,s=0,l=0;if(lt(e)){if(!w(e))return m(e)?x(T,e):wt(Ju,T,e);i=e,l=Qu(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=Ne(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=tu(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),sr&&sr(T,d),k=T.prototype=Yi(y)),k.constructor!==T&&Qt(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&Qt(k,v,b);var P=T!=S;I[b]=T,or({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||Qt(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||Qt(k,"BYTES_PER_ELEMENT",g),pr(b)}):t.exports=function(){}}));es("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var rs=TypeError,ns=function(t,e){if(!delete t[e])throw rs("Cannot delete property "+Tt(e)+" of "+Tt(t))},os=Math.min,is=C([].copyWithin||function(t,e){var r=W(this),n=De(r),o=Re(t,n),i=Re(e,n),a=arguments.length>2?arguments[2]:void 0,u=os((void 0===a?n:Re(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:ns(r,o),o+=s,i+=s;return r}),as=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("copyWithin",(function(t,e){return is(as(this),t,e,arguments.length>2?arguments[2]:void 0)}));var us=xi.every,ss=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("every",(function(t){return us(ss(this),t,arguments.length>1?arguments[1]:void 0)}));var cs=TypeError,fs=function(t){var e=Lt(t,"number");if("number"==typeof e)throw cs("Can't convert number to bigint");return BigInt(e)},ls=Za.aTypedArray,hs=Za.exportTypedArrayMethod,ps=C("".slice);hs("fill",(function(t){var e=arguments.length;ls(this);var r="Big"===ps(ge(this),0,3)?fs(t):+t;return wt(cu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),j((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var vs=Za.aTypedArrayConstructor,ds=Za.getTypedArrayConstructor,ys=function(t){return vs(Mr(t,ds(t)))},gs=function(t,e){return function(t,e){for(var r=0,n=De(e),o=new t(n);n>r;)o[r]=e[r++];return o}(ys(t),e)},ms=xi.filter,xs=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("filter",(function(t){var e=ms(xs(this),t,arguments.length>1?arguments[1]:void 0);return gs(this,e)}));var bs=xi.find,ws=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("find",(function(t){return bs(ws(this),t,arguments.length>1?arguments[1]:void 0)}));var Es=xi.findIndex,As=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("findIndex",(function(t){return Es(As(this),t,arguments.length>1?arguments[1]:void 0)}));var Os=xi.forEach,Ss=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("forEach",(function(t){Os(Ss(this),t,arguments.length>1?arguments[1]:void 0)}));var Ts=We.includes,ks=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("includes",(function(t){return Ts(ks(this),t,arguments.length>1?arguments[1]:void 0)}));var Is=We.indexOf,js=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("indexOf",(function(t){return Is(js(this),t,arguments.length>1?arguments[1]:void 0)}));var Ps=ut("iterator"),_s=O.Uint8Array,Ms=C(Ea.values),Ls=C(Ea.keys),Rs=C(Ea.entries),Cs=Za.aTypedArray,Ns=Za.exportTypedArrayMethod,Ds=_s&&_s.prototype,Fs=!j((function(){Ds[Ps].call([1])})),Ws=!!Ds&&Ds.values&&Ds[Ps]===Ds.values&&"values"===Ds.values.name,zs=function(){return Ms(Cs(this))};Ns("entries",(function(){return Rs(Cs(this))}),Fs),Ns("keys",(function(){return Ls(Cs(this))}),Fs),Ns("values",zs,Fs||!Ws,{name:"values"}),Ns(Ps,zs,Fs||!Ws,{name:"values"});var Bs=Za.aTypedArray,Us=Za.exportTypedArrayMethod,Gs=C([].join);Us("join",(function(t){return Gs(Bs(this),t)}));var Vs=Math.min,qs=[].lastIndexOf,Hs=!!qs&&1/[1].lastIndexOf(1,-0)<0,Zs=bi("lastIndexOf"),Ys=Hs||!Zs?function(t){if(Hs)return Nr(qs,this,arguments)||0;var e=Se(this),r=De(e),n=r-1;for(arguments.length>1&&(n=Vs(n,_e(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:qs,$s=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Nr(Ys,$s(this),e>1?[t,arguments[1]]:[t])}));var Ks=xi.map,Qs=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("map",(function(t){return Ks(Qs(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(ys(t))(e)}))}));var Xs=TypeError,Js=function(t){return function(e,r,n,o){It(r);var i=W(e),a=Oe(i),u=De(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw Xs("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},tc={left:Js(!1),right:Js(!0)},ec=tc.left,rc=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return ec(rc(this),t,e,e>1?arguments[1]:void 0)}));var nc=tc.right,oc=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return nc(oc(this),t,e,e>1?arguments[1]:void 0)}));var ic=Za.aTypedArray,ac=Za.exportTypedArrayMethod,uc=Math.floor;ac("reverse",(function(){for(var t,e=ic(this).length,r=uc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var sc=O.RangeError,cc=O.Int8Array,fc=cc&&cc.prototype,lc=fc&&fc.set,hc=Za.aTypedArray,pc=Za.exportTypedArrayMethod,vc=!j((function(){var t=new Uint8ClampedArray(2);return wt(lc,t,{length:1,0:3},1),3!==t[1]})),dc=vc&&Za.NATIVE_ARRAY_BUFFER_VIEWS&&j((function(){var t=new cc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));pc("set",(function(t){hc(this);var e=Qu(arguments.length>1?arguments[1]:void 0,1),r=W(t);if(vc)return wt(lc,this,r,e);var n=this.length,o=De(r),i=0;if(o+e>n)throw sc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!vc||dc);var yc=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("slice",(function(t,e){for(var r=zr(yc(this),t,e),n=ys(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),j((function(){new Int8Array(1).slice()})));var gc=xi.some,mc=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("some",(function(t){return gc(mc(this),t,arguments.length>1?arguments[1]:void 0)}));var xc=Math.floor,bc=function(t,e){var r=t.length,n=xc(r/2);return r<8?wc(t,e):Ec(t,bc(hu(t,0,n),e),bc(hu(t,n),e),e)},wc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Ec=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},Ac=bc,Oc=$.match(/firefox\\/(\\d+)/i),Sc=!!Oc&&+Oc[1],Tc=/MSIE|Trident/.test($),kc=$.match(/AppleWebKit\\/(\\d+)\\./),Ic=!!kc&&+kc[1],jc=Za.aTypedArray,Pc=Za.exportTypedArrayMethod,_c=O.Uint16Array,Mc=_c&&C(_c.prototype.sort),Lc=!(!Mc||j((function(){Mc(new _c(2),null)}))&&j((function(){Mc(new _c(2),{})}))),Rc=!!Mc&&!j((function(){if(tt)return tt<74;if(Sc)return Sc<67;if(Tc)return!0;if(Ic)return Ic<602;var t,e,r=new _c(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Mc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Pc("sort",(function(t){return void 0!==t&&It(t),Rc?Mc(this,t):Ac(jc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!Rc||Lc);var Cc=Za.aTypedArray;(0,Za.exportTypedArrayMethod)("subarray",(function(t,e){var r=Cc(this),n=r.length,o=Re(t,n);return new(ys(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,Ne((void 0===e?n:Re(e,n))-o))}));var Nc=O.Int8Array,Dc=Za.aTypedArray,Fc=Za.exportTypedArrayMethod,Wc=[].toLocaleString,zc=!!Nc&&j((function(){Wc.call(new Nc(1))}));Fc("toLocaleString",(function(){return Nr(Wc,zc?zr(Dc(this)):Dc(this),zr(arguments))}),j((function(){return[1,2].toLocaleString()!=new Nc([1,2]).toLocaleString()}))||!j((function(){Nc.prototype.toLocaleString.call([1,2])})));var Bc=Za.exportTypedArrayMethod,Uc=O.Uint8Array,Gc=Uc&&Uc.prototype||{},Vc=[].toString,qc=C([].join);j((function(){Vc.call({})}))&&(Vc=function(){return qc(this)});var Hc=Gc.toString!=Vc;Bc("toString",Vc,Hc);var Zc,Yc,$c=String,Kc=function(t){if("Symbol"===ge(t))throw TypeError("Cannot convert a Symbol value to a string");return $c(t)},Qc=function(){var t=xt(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},Xc=O.RegExp,Jc=j((function(){var t=Xc("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),tf=Jc||j((function(){return!Xc("a","y").sticky})),ef={BROKEN_CARET:Jc||j((function(){var t=Xc("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:tf,UNSUPPORTED_Y:Jc},rf=O.RegExp,nf=j((function(){var t=rf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),of=O.RegExp,af=j((function(){var t=of("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),uf=se.get,sf=I("native-string-replace",String.prototype.replace),cf=RegExp.prototype.exec,ff=cf,lf=C("".charAt),hf=C("".indexOf),pf=C("".replace),vf=C("".slice),df=(Yc=/b*/g,wt(cf,Zc=/a/,"a"),wt(cf,Yc,"a"),0!==Zc.lastIndex||0!==Yc.lastIndex),yf=ef.BROKEN_CARET,gf=void 0!==/()??/.exec("")[1];(df||gf||yf||nf||af)&&(ff=function(t){var e,r,n,o,i,a,u,s=this,c=uf(s),f=Kc(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=wt(ff,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=yf&&s.sticky,v=wt(Qc,s),d=s.source,y=0,g=f;if(p&&(v=pf(v,"y",""),-1===hf(v,"g")&&(v+="g"),g=vf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==lf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),gf&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),df&&(n=s.lastIndex),o=wt(cf,p?r:s,g),p?o?(o.input=vf(o.input,y),o[0]=vf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:df&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),gf&&o&&o.length>1&&wt(sf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Yi(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var mf=ff;or({target:"RegExp",proto:!0,forced:/./.exec!==mf},{exec:mf});var xf,bf=ut("species"),wf=RegExp.prototype,Ef=function(t,e,r,n){var o=ut(t),i=!j((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!j((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[bf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=C(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=C(t),s=e.exec;return s===mf||s===wf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));fe(String.prototype,t,s[0]),fe(wf,o,s[1])}n&&Qt(wf[o],"sham",!0)},Af=C("".charAt),Of=C("".charCodeAt),Sf=C("".slice),Tf=function(t){return function(e,r){var n,o,i=Kc(D(e)),a=_e(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=Of(i,a))<55296||n>56319||a+1===u||(o=Of(i,a+1))<56320||o>57343?t?Af(i,a):n:t?Sf(i,a,a+2):o-56320+(n-55296<<10)+65536}},kf={codeAt:Tf(!1),charAt:Tf(!0)},If=kf.charAt,jf=function(t,e,r){return e+(r?If(t,e).length:1)},Pf=Math.floor,_f=C("".charAt),Mf=C("".replace),Lf=C("".slice),Rf=/\\$([$&'\`]|\\d{1,2}|<[^>]*>)/g,Cf=/\\$([$&'\`]|\\d{1,2})/g,Nf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=Cf;return void 0!==o&&(o=W(o),s=Rf),Mf(i,s,(function(i,s){var c;switch(_f(s,0)){case"$":return"$";case"&":return t;case"\`":return Lf(e,0,r);case"'":return Lf(e,a);case"<":c=o[Lf(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Pf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?_f(s,1):n[l-1]+_f(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Df=TypeError,Ff=function(t,e){var r=t.exec;if(H(r)){var n=wt(r,t,e);return null!==n&&xt(n),n}if("RegExp"===pe(t))return wt(mf,t,e);throw Df("RegExp#exec called on incompatible receiver")},Wf=ut("replace"),zf=Math.max,Bf=Math.min,Uf=C([].concat),Gf=C([].push),Vf=C("".indexOf),qf=C("".slice),Hf="$0"==="a".replace(/./,"$0"),Zf=!!/./[Wf]&&""===/./[Wf]("a","$0");function Yf(t){this.message=t}Ef("replace",(function(t,e,r){var n=Zf?"$":"$0";return[function(t,r){var n=D(this),o=null==t?void 0:jt(t,Wf);return o?wt(o,t,n,r):wt(e,Kc(n),t,r)},function(t,o){var i=xt(this),a=Kc(t);if("string"==typeof o&&-1===Vf(o,n)&&-1===Vf(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=H(o);s||(o=Kc(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Ff(i,a);if(null===h)break;if(Gf(l,h),!c)break;""===Kc(h[0])&&(i.lastIndex=jf(a,Ne(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=Kc((h=l[y])[0]),m=zf(Bf(_e(h.index),a.length),0),x=[],b=1;b<h.length;b++)Gf(x,void 0===(p=h[b])?p:String(p));var w=h.groups;if(s){var E=Uf([g],x,m,a);void 0!==w&&Gf(E,w);var A=Kc(Nr(o,void 0,E))}else A=Nf(g,a,m,x,w,o);m>=d&&(v+=qf(a,d,m)+A,d=m+g.length)}return v+qf(a,d)}]}),!!j((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Hf||Zf),Yf.prototype=new Error,Yf.prototype.name="InvalidCharacterError",or({global:!0},{globalThis:O}),xf="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:xf.devicePixelRatio;var $f=TypeError,Kf=function(t){if(t>9007199254740991)throw $f("Maximum allowed index exceeded");return t},Qf=ki("splice"),Xf=Math.max,Jf=Math.min;or({target:"Array",proto:!0,forced:!Qf},{splice:function(t,e){var r,n,o,i,a,u,s=W(this),c=De(s),f=Re(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=Jf(Xf(_e(e),0),c-f)),Kf(c+r-n),o=yi(s,n),i=0;i<n;i++)(a=f+i)in s&&Si(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:ns(s,u);for(i=c;i>c-n+r;i--)ns(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:ns(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return s.length=c-n+r,o}});var tl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),el=Object.assign,rl=Object.defineProperty,nl=C([].concat),ol=!el||j((function(){if(ft&&1!==el({b:1},el(rl({},"a",{enumerable:!0,get:function(){rl(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=el({},t)[r]||"abcdefghijklmnopqrst"!=Bi(el({},e)).join("")}))?function(t,e){for(var r=W(t),n=arguments.length,o=1,i=He.f,a=we.f;n>o;)for(var u,s=Oe(arguments[o++]),c=i?nl(Bi(s),i(s)):Bi(s),f=c.length,l=0;f>l;)u=c[l++],ft&&!wt(a,s,u)||(r[u]=s[u]);return r}:el;or({target:"Object",stat:!0,arity:2,forced:Object.assign!==ol},{assign:ol});var il=xi.findIndex,al=!0;"findIndex"in[]&&Array(1).findIndex((function(){al=!1})),or({target:"Array",proto:!0,forced:al},{findIndex:function(t){return il(this,t,arguments.length>1?arguments[1]:void 0)}}),ea("findIndex");var ul=kf.charAt,sl=se.set,cl=se.getterFor("String Iterator");ma(String,"String",(function(t){sl(this,{type:"String Iterator",string:Kc(t),index:0})}),(function(){var t,e=cl(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=ul(r,n),e.index+=t.length,{value:t,done:!1})}));var fl=qe.f,ll="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],hl={f:function(t){return ll&&"Window"==pe(t)?function(t){try{return fl(t)}catch(t){return hu(ll)}}(t):fl(Se(t))}},pl=j((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),vl=Object.isExtensible,dl=j((function(){vl(1)}))||pl?function(t){return!!lt(t)&&((!pl||"ArrayBuffer"!=pe(t))&&(!vl||vl(t)))}:vl,yl=!j((function(){return Object.isExtensible(Object.preventExtensions({}))})),gl=b((function(t){var e=Ft.f,r=!1,n=q("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=qe.f,e=C([].splice),o={};o[n]=1,t(o).length&&(qe.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},or({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:hl.f}))},fastKey:function(t,e){if(!lt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!B(t,n)){if(!dl(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!B(t,n)){if(!dl(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return yl&&r&&dl(t)&&!B(t,n)&&i(t),t}};te[n]=!0})),ml=(gl.enable,gl.fastKey,gl.getWeakData,gl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=O[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=C(u[t]);fe(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!lt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!lt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!lt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(rr(t,!H(a)||!(o||u.forEach&&!j((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),gl.enable();else if(rr(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=j((function(){l.has(1)})),v=Io((function(t){new a(t)})),d=!o&&j((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){dr(t,u);var r=ts(new a,t,s);return null!=e&&Ao(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,or({global:!0,constructor:!0,forced:s!=a},c),lr(s,t),o||r.setStrong(s,t,n),s}),xl=gl.getWeakData,bl=se.set,wl=se.getterFor,El=xi.find,Al=xi.findIndex,Ol=C([].splice),Sl=0,Tl=function(t){return t.frozen||(t.frozen=new kl)},kl=function(){this.entries=[]},Il=function(t,e){return El(t.entries,(function(t){return t[0]===e}))};kl.prototype={get:function(t){var e=Il(this,t);if(e)return e[1]},has:function(t){return!!Il(this,t)},set:function(t,e){var r=Il(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Al(this.entries,(function(e){return e[0]===t}));return~e&&Ol(this.entries,e,1),!!~e}};var jl,Pl={getConstructor:function(t,e,r,n){var o=t((function(t,o){dr(t,i),bl(t,{type:e,id:Sl++,frozen:void 0}),null!=o&&Ao(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=wl(e),u=function(t,e,r){var n=a(t),o=xl(xt(e),!0);return!0===o?Tl(n).set(e,r):o[n.id]=r,t};return Xa(i,{delete:function(t){var e=a(this);if(!lt(t))return!1;var r=xl(t);return!0===r?Tl(e).delete(t):r&&B(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!lt(t))return!1;var r=xl(t);return!0===r?Tl(e).has(t):r&&B(r,e.id)}}),Xa(i,r?{get:function(t){var e=a(this);if(lt(t)){var r=xl(t);return!0===r?Tl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},_l=se.enforce,Ml=!O.ActiveXObject&&"ActiveXObject"in O,Ll=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Rl=ml("WeakMap",Ll,Pl);if($t&&Ml){jl=Pl.getConstructor(Ll,"WeakMap",!0),gl.enable();var Cl=Rl.prototype,Nl=C(Cl.delete),Dl=C(Cl.has),Fl=C(Cl.get),Wl=C(Cl.set);Xa(Cl,{delete:function(t){if(lt(t)&&!dl(t)){var e=_l(this);return e.frozen||(e.frozen=new jl),Nl(this,t)||e.frozen.delete(t)}return Nl(this,t)},has:function(t){if(lt(t)&&!dl(t)){var e=_l(this);return e.frozen||(e.frozen=new jl),Dl(this,t)||e.frozen.has(t)}return Dl(this,t)},get:function(t){if(lt(t)&&!dl(t)){var e=_l(this);return e.frozen||(e.frozen=new jl),Dl(this,t)?Fl(this,t):e.frozen.get(t)}return Fl(this,t)},set:function(t,e){if(lt(t)&&!dl(t)){var r=_l(this);r.frozen||(r.frozen=new jl),Dl(this,t)?Wl(this,t,e):r.frozen.set(t,e)}else Wl(this,t,e);return this}})}var zl=ut("iterator"),Bl=ut("toStringTag"),Ul=Ea.values,Gl=function(t,e){if(t){if(t[zl]!==Ul)try{Qt(t,zl,Ul)}catch(e){t[zl]=Ul}if(t[Bl]||Qt(t,Bl,e),ci[e])for(var r in Ea)if(t[r]!==Ea[r])try{Qt(t,r,Ea[r])}catch(e){t[r]=Ea[r]}}};for(var Vl in ci)Gl(O[Vl]&&O[Vl].prototype,Vl);Gl(hi,"DOMTokenList");var ql,Hl,Zl,Yl,$l=new WeakMap,Kl=function(){function t(){i(this,t),$l.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=$l.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),$l.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=$l.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=$l.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),Ql=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(Kl));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Xl=my.getSystemInfoSync();ql=Xl.screenWidth,Hl=Xl.screenHeight,Zl=Xl.windowWidth,Yl=Xl.windowHeight}else{var Jl=xf.innerWidth,th=xf.innerHeight;ql=Jl,Hl=th,Zl=Jl,Yl=th}var eh={width:ql,height:Hl,availWidth:Zl,availHeight:Yl,availLeft:0,availTop:0},rh=eh.availWidth,nh=eh.availHeight,oh={style:[]};function ih(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return oh}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return oh}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function ah(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:rh+"px",height:nh+"px",margin:"0px",padding:"0px"})}function uh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=rh,t.clientHeight=nh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function sh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=rh,t.offsetHeight=nh)}function ch(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=rh,t.scrollHeight=nh)}function fh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function lh(){}var hh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=lh,t.blur=lh,t.insertBefore=lh,t.appendChild=lh,t.removeChild=lh,t.remove=lh,t.innerHTML="",t.tagName=n.toUpperCase(),ih(h(t),o),ah(h(t)),fh(h(t)),uh(h(t)),sh(h(t)),ch(h(t)),t}return u(r)}(Ql),ph=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(hh)),vh={};function dh(){return vh}var yh=u((function t(){i(this,t);var e=dh(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),ih(r),fh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),gh={href:"",protocol:"",host:""},mh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(hh),xh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(hh),bh={},wh={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:gh,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new yh:"video"===t?new ph:new hh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){bh[t]||(bh[t]=[]),bh[t].push(e)},removeEventListener:function(t,e){var r=bh[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=bh[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new tl(t)}};wh.documentElement=new xh,wh.head=new hh("head"),wh.body=new mh,Ef("match",(function(t,e,r){return[function(e){var r=D(this),n=null==e?void 0:jt(e,t);return n?wt(n,e,r):new RegExp(e)[t](Kc(r))},function(t){var n=xt(this),o=Kc(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Ff(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Ff(n,o));){var f=Kc(u[0]);s[c]=f,""===f&&(n.lastIndex=jf(o,Ne(n.lastIndex),a)),c++}return 0===c?null:s}]}));var Eh,Ah,Oh=ut("isConcatSpreadable"),Sh=tt>=51||!j((function(){var t=[];return t[Oh]=!1,t.concat()[0]!==t})),Th=ki("concat"),kh=function(t){if(!lt(t))return!1;var e=t[Oh];return void 0!==e?!!e:pi(t)};if(or({target:"Array",proto:!0,arity:1,forced:!Sh||!Th},{concat:function(t){var e,r,n,o,i,a=W(this),u=yi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(kh(i=-1===e?a:arguments[e]))for(o=De(i),Kf(s+o),r=0;r<o;r++,s++)r in i&&Si(u,s,i[r]);else Kf(s+1),Si(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Ih=my.getSystemInfoSync();Eh=Ih.system,Ih.platform,Ih.language}else{var jh={versions:(Ah=xf.navigator.userAgent,{trident:Ah.indexOf("Trident")>-1,presto:Ah.indexOf("Presto")>-1,webKit:Ah.indexOf("AppleWebKit")>-1,gecko:Ah.indexOf("Gecko")>-1&&-1===Ah.indexOf("KHTML"),mobile:!!Ah.match(/AppleWebKit.*Mobile.*/),ios:!!Ah.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:Ah.indexOf("Android")>-1||Ah.indexOf("Linux")>-1,iPhone:Ah.indexOf("iPhone")>-1,iPad:Ah.indexOf("iPad")>-1,webApp:-1===Ah.indexOf("Safari"),weixin:Ah.indexOf("MicroMessenger")>-1,qq:" qq"===Ah.match(/\\sQQ/i)}),language:(xf.navigator.browserLanguage||xf.navigator.language).toLowerCase()};jh.versions.android?"android":jh.versions.trident?"IE":jh.versions.presto?"Opera":jh.versions.webKit?"webKit":jh.versions.gecko?"Firefox":jh.versions.mobile?"mobile":jh.versions.ios?"ios":jh.versions.iPhone?"iPhone":jh.versions.iPad?"ipad":jh.versions.webApp?"webApp":jh.versions.weixin?"weixin":jh.versions.qq&&"qq",Eh=xf.navigator.userAgent,jh.language}Eh.toLowerCase().indexOf("android");es("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Ph=Ft.f,_h=gl.fastKey,Mh=se.set,Lh=se.getterFor;ml("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){dr(t,i),Mh(t,{type:e,index:Yi(null),first:void 0,last:void 0,size:0}),ft||(t.size=0),null!=o&&Ao(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Lh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=_h(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),ft?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=_h(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return Xa(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,ft?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),ft?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=Fr(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),Xa(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),ft&&Ph(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Lh(e),i=Lh(n);ma(t,e,(function(t,e){Mh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),pr(e)}});var Rh=C([].join),Ch=Oe!=Object,Nh=bi("join",",");or({target:"Array",proto:!0,forced:Ch||!Nh},{join:function(t){return Rh(Se(this),void 0===t?",":t)}});var Dh=j((function(){Bi(1)}));or({target:"Object",stat:!0,forced:Dh},{keys:function(t){return Bi(W(t))}});var Fh=new Map,Wh=new Map,zh=new Map,Bh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Fh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=zh.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Wh.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return Wh.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Fh.get("requestHeader");r[t]=e,Fh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(Kl);s(Bh,"UNSEND",void 0),s(Bh,"OPENED",void 0),s(Bh,"HEADERS_RECEIVED",void 0),s(Bh,"LOADING",void 0),s(Bh,"DONE",void 0),Bh.UNSEND=0,Bh.OPENED=1,Bh.HEADERS_RECEIVED=2,Bh.LOADING=3,Bh.DONE=4;var Uh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Gh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),Vh=Uh||Gh;Vh||xf.XMLHttpRequest,Vh||xf.location;function qh(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var Hh=xi.filter,Zh=ki("filter");function Yh(t,e){var r=t.color;return r&&r.length?r:[1,1,1,1]}function $h(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function Kh(t,e){return t.filter?[1]:[0]}function Qh(t,e,r,n){return[e]}or({target:"Array",proto:!0,forced:!Zh},{filter:function(t){return Hh(this,t,arguments.length>1?arguments[1]:void 0)}});var Xh=tp,Jh=tp;function tp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=ep(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=ep(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(hp(s));for(c.sort(sp),o=0;o<c.length;o++)r=cp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return np(h,p,r,n,o,c,0),p}function ep(t,e,r,n,o){var i,a;if(o===Sp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=Ep(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=Ep(i,t[i],t[i+1],a);return a&&yp(a,a.next)&&(Ap(a),a=a.next),a}function rp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!yp(n,n.next)&&0!==dp(n.prev,n,n.next))n=n.next;else{if(Ap(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function np(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=lp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?ip(t,n,o,i):op(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Ap(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?np(t=ap(rp(t),e,r),e,r,n,o,i,2):2===a&&up(t,e,r,n,o,i):np(rp(t),e,r,n,o,i,1);break}}}function op(t){var e=t.prev,r=t,n=t.next;if(dp(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&pp(o,u,i,s,a,c,v.x,v.y)&&dp(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function ip(t,e,r,n){var o=t.prev,i=t,a=t.next;if(dp(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=lp(p,v,e,r,n),m=lp(d,y,e,r,n),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&pp(u,f,s,l,c,h,x.x,x.y)&&dp(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&pp(u,f,s,l,c,h,b.x,b.y)&&dp(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&pp(u,f,s,l,c,h,x.x,x.y)&&dp(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&pp(u,f,s,l,c,h,b.x,b.y)&&dp(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function ap(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!yp(o,i)&&gp(o,n,n.next,i)&&bp(o,i)&&bp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Ap(n),Ap(n.next),n=t=i),n=n.next}while(n!==t);return rp(n)}function up(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&vp(a,u)){var s=wp(a,u);return a=rp(a,a.next),s=rp(s,s.next),np(a,e,r,n,o,i,0),void np(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function sp(t,e){return t.x-e.x}function cp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&pp(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),bp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&fp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=wp(r,t);return rp(n,n.next),rp(r,r.next)}function fp(t,e){return dp(t.prev,t,e.prev)<0&&dp(e.next,t,t.next)<0}function lp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function hp(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function pp(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function vp(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&gp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(bp(t,e)&&bp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(dp(t.prev,t,e.prev)||dp(t,e.prev,e))||yp(t,e)&&dp(t.prev,t,t.next)>0&&dp(e.prev,e,e.next)>0)}function dp(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function yp(t,e){return t.x===e.x&&t.y===e.y}function gp(t,e,r,n){var o=xp(dp(t,e,r)),i=xp(dp(t,e,n)),a=xp(dp(r,n,t)),u=xp(dp(r,n,e));return o!==i&&a!==u||(!(0!==o||!mp(t,r,e))||(!(0!==i||!mp(t,n,e))||(!(0!==a||!mp(r,t,n))||!(0!==u||!mp(r,e,n)))))}function mp(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function xp(t){return t>0?1:t<0?-1:0}function bp(t,e){return dp(t.prev,t,t.next)<0?dp(t,e,t.next)>=0&&dp(t,t.prev,e)>=0:dp(t,e,t.prev)<0||dp(t,t.next,e)<0}function wp(t,e){var r=new Op(t.i,t.x,t.y),n=new Op(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function Ep(t,e,r,n){var o=new Op(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Ap(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Op(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}tp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Sp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Sp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},tp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},Xh.default=Jh;var Tp=C(1..valueOf),kp=C("".replace),Ip="[\\t\\n\\v\\f\\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\\u2028\\u2029\\ufeff]",jp=RegExp("^"+Ip+Ip+"*"),Pp=RegExp(Ip+Ip+"*$"),_p=function(t){return function(e){var r=Kc(D(e));return 1&t&&(r=kp(r,jp,"")),2&t&&(r=kp(r,Pp,"")),r}},Mp={start:_p(1),end:_p(2),trim:_p(3)},Lp=qe.f,Rp=ke.f,Cp=Ft.f,Np=Mp.trim,Dp=O.Number,Fp=Dp.prototype,Wp=O.TypeError,zp=C("".slice),Bp=C("".charCodeAt),Up=function(t){var e=Lt(t,"number");return"bigint"==typeof e?e:Gp(e)},Gp=function(t){var e,r,n,o,i,a,u,s,c=Lt(t,"number");if(Ot(c))throw Wp("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Np(c),43===(e=Bp(c,0))||45===e){if(88===(r=Bp(c,2))||120===r)return NaN}else if(48===e){switch(Bp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=zp(c,2)).length,u=0;u<a;u++)if((s=Bp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(rr("Number",!Dp(" 0o1")||!Dp("0b1")||Dp("+0x1"))){for(var Vp,qp=function(t){var e=arguments.length<1?0:Dp(Up(t)),r=this;return Et(Fp,r)&&j((function(){Tp(r)}))?ts(Object(e),r,qp):e},Hp=ft?Lp(Dp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Zp=0;Hp.length>Zp;Zp++)B(Dp,Vp=Hp[Zp])&&!B(qp,Vp)&&Cp(qp,Vp,Rp(Dp,Vp));qp.prototype=Fp,Fp.constructor=qp,fe(O,"Number",qp,{constructor:!0})}var Yp=RangeError,$p=RangeError,Kp=String,Qp=Math.floor,Xp=C((function(t){var e=Kc(D(this)),r="",n=_e(t);if(n<0||n==1/0)throw Yp("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),Jp=C("".slice),tv=C(1..toFixed),ev=function(t,e,r){return 0===e?r:e%2==1?ev(t,e-1,r*t):ev(t*t,e/2,r)},rv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=Qp(o/1e7)},nv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=Qp(n/e),n=n%e*1e7},ov=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=Kp(t[e]);r=""===r?n:r+Xp("0",7-n.length)+n}return r},iv=j((function(){return"0.000"!==tv(8e-5,3)||"1"!==tv(.9,0)||"1.25"!==tv(1.255,2)||"1000000000000000128"!==tv(0xde0b6b3a7640080,0)}))||!j((function(){tv({})}));function av(t){return"number"==typeof t}function uv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}or({target:"Number",proto:!0,forced:iv},{toFixed:function(t){var e,r,n,o,i=Tp(this),a=_e(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw $p("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return Kp(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*ev(2,69,1))-69)<0?i*ev(2,-e,1):i/ev(2,e,1),r*=4503599627370496,(e=52-e)>0){for(rv(u,0,r),n=a;n>=7;)rv(u,1e7,0),n-=7;for(rv(u,ev(10,n,1),0),n=e-1;n>=23;)nv(u,1<<23),n-=23;nv(u,1<<n),rv(u,1,1),nv(u,2),c=ov(u)}else rv(u,0,r),rv(u,1<<-e,0),c=ov(u)+Xp("0",a);return c=a>0?s+((o=c.length)<=a?"0."+Xp("0",a-o)+c:Jp(c,0,o-a)+"."+Jp(c,o-a)):s+c}});var sv,cv=/"/g,fv=C("".replace);or({target:"String",proto:!0,forced:(sv="sub",j((function(){var t=""[sv]('"');return t!==t.toLowerCase()||t.split('"').length>3})))},{sub:function(){return t="sub",e="",r="",n=Kc(D(this)),o="<"+t,""!==e&&(o+=" "+e+'="'+fv(Kc(r),cv,"&quot;")+'"'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var lv=RegExp.prototype,hv=Ut.PROPER,pv=RegExp.prototype.toString,vv=j((function(){return"/a/b"!=pv.call({source:"a",flags:"b"})})),dv=hv&&"toString"!=pv.name;(vv||dv)&&fe(RegExp.prototype,"toString",(function(){var t=xt(this);return"/"+Kc(t.source)+"/"+Kc(function(t){var e=t.flags;return void 0!==e||"flags"in lv||B(t,"flags")||!Et(lv,t)?e:wt(Qc,t)}(t))}),{unsafe:!0});var yv="undefined"!=typeof Float32Array?Float32Array:Array;function gv(){var t=new yv(2);return yv!=Float32Array&&(t[0]=0,t[1]=0),t}function mv(t,e){var r=new yv(2);return r[0]=t,r[1]=e,r}function xv(t,e){return t[0]=e[0],t[1]=e[1],t}function bv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function wv(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function Ev(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Av(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Ov,Sv=wv,Tv=(Ov=gv(),gv()),kv=(gv(),gv()),Iv=gv(),jv=gv();function Pv(t,e,r,n,o){return bv(t,r,n),Ev(t,t),[o/Av(e=mv(-t[1],t[0]),mv(-r[1],r[0])),e]}function _v(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Mv(t,e,r){return Sv(t,e,r),Ev(t,t),t}function Lv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Rv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",mv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=uv([a[0],a[1]]),g=uv([i[0],i[1]]);Mv(kv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=gv(),_v(this.normal,kv)),!this.started)if(this.started=!0,h){var x=gv(),b=gv();bv(x,this.normal,kv),bv(b,this.normal,kv),l.push(b[0],b[1],0),l.push(x[0],x[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Lv(n,o)&&bv(o,n,Ev(o,wv(o,n,r))),Mv(Iv,o,n);var w=d(Pv(jv,gv(),kv,Iv,this.thickness),2),E=w[0],A=w[1],O=Av(jv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),_v(Tv,Iv),xv(this.normal,Tv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,xv(this.normal,A),s+=2),this.lastFlip=O}else{if(_v(this.normal,kv),h){var T=gv(),k=gv();Sv(k,kv,this.normal),bv(T,kv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=uv([n[0],n[1]]),f=uv([r[0],r[1]]);Mv(kv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=gv(),_v(this.normal,kv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=uv([o[0],o[1]]);Lv(c,h)&&bv(h,c,Ev(h,wv(h,c,f))),Mv(Iv,h,c);var p=d(Pv(jv,gv(),kv,Iv,this.thickness),2),v=p[0],g=p[1];Av(jv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,xv(this.normal,g),i+=2,this.lastFlip=-1}else _v(this.normal,kv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=uv([n[0],n[1]]),h=uv([r[0],r[1]]);Mv(kv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=gv(),_v(this.normal,kv)),!this.started)if(this.started=!0,c){var v=gv(),g=gv();bv(v,this.normal,kv),bv(g,this.normal,kv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=uv([o[0],o[1]]);Lv(l,m)&&bv(m,l,Ev(m,wv(m,l,h))),Mv(Iv,m,l);var x=d(Pv(jv,gv(),kv,Iv,this.thickness),2),b=x[0],w=x[1],E=Av(jv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)b>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),_v(Tv,Iv),xv(this.normal,Tv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,b,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,xv(this.normal,w),i+=2),this.lastFlip=E}else{if(_v(this.normal,kv),c){var O=gv(),S=gv();Sv(S,kv,this.normal),bv(O,kv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Cv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Rv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function Nv(t){var e=function(t){if(av(t[0]))return t;if(av(t[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(av(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function Dv(t){var e=t.coordinates,r=Xh.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:Xh(n,i,o),vertices:n,size:o}}var Fv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:Yh,a_Position:$h,filter:Kh,a_vertexId:Qh,a_PickingColor:function(t){var e=t.id;return i?qh(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r,n){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Cv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Wv={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:Yh,a_Position:$h,filter:Kh,a_vertexId:Qh,a_PickingColor:function(t){var e=t.id;return i?qh(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Nv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Fv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:Yh,a_Position:$h,filter:Kh,a_vertexId:Qh,a_PickingColor:function(t){var e=t.id;return i?qh(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=Dv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},zv=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Wv);function Bv(t){return Uv.apply(this,arguments)}function Uv(){return(Uv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!zv[n]){t.next=3;break}return t.abrupt("return",zv[n](o));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return ui(Bv),t.WorkerSourceMap=Wv,t.createWorker=ui,t.worker=Bv,t}({});
`,NE="l7-worker",XBe=3,YBe=!0;function ane(e){HBe(NE,e)}function ZBe(){var e=jBe(NE);if(!e)throw new Error("get worker failed by workerName: ".concat(NE,"."));return e}function one(e,r){return rD.apply(this,arguments)}function rD(){return rD=Hi(Xr.mark(function e(r,t){var n,i,a,o,s;return Xr.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=ZBe(),i=gBe.getWorkerFarm({maxConcurrency:XBe,reuseWorkers:YBe}),a=i.getWorkerPool({name:NE,source:n}),l.next=5,a.startJob(NE,function(f,h,p){return f.done(p)});case 5:return o=l.sent,o.postMessage("process",{input:{workerType:r,data:t}}),l.next=9,o.result;case 9:return s=l.sent,l.abrupt("return",s.result);case 11:case"end":return l.stop()}},e)})),rD.apply(this,arguments)}ane(WBe);var ux={BACK:1029,FRONT:1028};function Z2(e){switch(e){case"GAODE1.x":return ux.BACK;case"GAODE2.x":return ux.BACK;case"MAPBOX":return ux.FRONT;case"SIMPLE":return ux.FRONT;case"GLOBEL":return ux.BACK;case"L7MAP":return ux.FRONT;default:return ux.FRONT}}function qBe(e){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function sne(e){var r=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var n=t[1].charCodeAt(0),i=t[2].charCodeAt(0),a;for(a=n;a<=i;++a)r.push(e.replace(t[0],String.fromCharCode(a)));return r}if(t=/\{(\d+)-(\d+)\}/.exec(e),t){for(var o=parseInt(t[2],10),s=parseInt(t[1],10);s<=o;s++)r.push(e.replace(t[0],s.toString()));return r}return r.push(e),r}function e2(e,r){if(!e||!e.length)throw new Error("url is not allowed to be empty");var t=r.x,n=r.y,i=r.z,a=sne(e),o=Math.abs(t+n)%a.length,s=a[o];return s.replace(/\{x\}/g,t.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,i.toString()).replace(/\{-y\}/g,(Math.pow(2,i)-n-1).toString())}var Wx;(function(e){e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace"})(Wx||(Wx={}));var Jh;(function(e){e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled"})(Jh||(Jh={}));function KBe(e,r){r===void 0&&(r={});var t=Number(e[0]),n=Number(e[1]),i=Number(e[2]),a=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[t,n],s=[t,a],u=[i,a],l=[i,n];return OB([[o,l,u,s,o]],r.properties,{bbox:e,id:r.id})}var une=0,L$=1,bk=2;function QBe(e){e.forEach(function(r){r.isCurrent&&(r.isVisible=r.isLoaded)})}function JBe(e){e.forEach(function(r){r.properties.state=une}),e.forEach(function(r){r.isCurrent&&!lne(r)&&WB(r)}),e.forEach(function(r){r.isVisible=Boolean(r.properties.state&bk)})}function e6e(e){e.forEach(function(t){t.properties.state=une}),e.forEach(function(t){t.isCurrent&&lne(t)});var r=e.slice().sort(function(t,n){return t.z-n.z});r.forEach(function(t){t.isVisible=Boolean(t.properties.state&bk),t.children.length&&(t.isVisible||t.properties.state&L$)?t.children.forEach(function(n){n.properties.state=L$}):t.isCurrent&&WB(t)})}function lne(e){for(;e;){if(e.isLoaded)return e.properties.state|=bk,!0;e=e.parent}return!1}function WB(e){e.children.forEach(function(r){r.isLoaded?r.properties.state|=bk:WB(r)})}var Xw,cne=[-1/0,-1/0,1/0,1/0],t6e=.2,r6e=5,n6e=(Xw={},X(Xw,Wx.Realtime,QBe),X(Xw,Wx.Overlap,JBe),X(Xw,Wx.Replace,e6e),Xw),i6e=function(){};function fL(e,r,t){var n=Math.floor((e+180)/360*Math.pow(2,t)),i=Math.floor((1-Math.log(Math.tan(r*Math.PI/180)+1/Math.cos(r*Math.PI/180))/Math.PI)/2*Math.pow(2,t));return[n,i]}function nD(e,r,t){var n=e/Math.pow(2,t)*360-180,i=Math.PI-2*Math.PI*r/Math.pow(2,t),a=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[n,a]}var fne=function(r,t,n){var i=nD(r,t,n),a=tn(i,2),o=a[0],s=a[1],u=nD(r+1,t+1,n),l=tn(u,2),f=l[0],h=l[1];return[o,h,f,s]};function hne(e){var r=e.zoom,t=e.latLonBounds,n=e.maxZoom,i=n===void 0?1/0:n,a=e.minZoom,o=a===void 0?0:a,s=e.zoomOffset,u=s===void 0?0:s,l=e.extent,f=l===void 0?cne:l,h=Math.ceil(r)+u;if(Number.isFinite(o)&&h<o)return[];Number.isFinite(i)&&h>i&&(h=i);for(var p=tn(t,4),v=p[0],m=p[1],x=p[2],E=p[3],A=[Math.max(v,f[0]),Math.max(m,f[1]),Math.min(x,f[2]),Math.min(E,f[3])],L=[],k=fL(A[0],A[1],h),R=tn(k,2),D=R[0],$=R[1],j=fL(A[2],A[3],h),H=tn(j,2),ee=H[0],U=H[1],W=D;W<=ee;W++)for(var Q=U;Q<=$;Q++)L.push({x:W,y:Q,z:h});var te=(ee+D)/2,ie=($+U)/2,ve=function(Re,We){return Math.abs(Re-te)+Math.abs(We-ie)};return L.sort(function(me,Re){return ve(me.x,me.y)-ve(Re.x,Re.y)}),L}var pne=function(r,t,n){var i=Math.pow(2,n),a=i-1,o=i,s=r,u=t;return s<0?s=s+o:s>a&&(s=s%o),{warpX:s,warpY:u}};function a6e(e){var r=o6e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function o6e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dne=function(e){er(t,e);var r=a6e(t);function t(n){var i;st(this,t),i=r.call(this),X(He(i),"tileSize",256),X(He(i),"isVisible",!1),X(He(i),"isCurrent",!1),X(He(i),"isVisibleChange",!1),X(He(i),"layerIDList",[]),X(He(i),"loadedLayers",0),X(He(i),"parent",null),X(He(i),"children",[]),X(He(i),"loadedChilds",0),X(He(i),"data",null),X(He(i),"properties",{}),X(He(i),"loadDataId",0);var a=n.x,o=n.y,s=n.z,u=n.tileSize;return i.x=a,i.y=o,i.z=s,i.tileSize=u,i}return ot(t,[{key:"isLoading",get:function(){return this.loadStatus===Jh.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===Jh.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===Jh.Failure}},{key:"isCancelled",get:function(){return this.loadStatus===Jh.Cancelled}},{key:"isDone",get:function(){return[Jh.Loaded,Jh.Cancelled,Jh.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return fne(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var i=tn(this.bounds,4),a=i[0],o=i[1],s=i[2],u=i[3],l=[(s-a)/2,(u-o)/2],f=KBe(this.bounds,{properties:{key:this.key,bbox:this.bounds,center:l,meta:`
      `.concat(this.key,`
      `)}});return f}},{key:"key",get:function(){var i="".concat(this.x,",").concat(this.y,",").concat(this.z);return i}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v,m,x,E,A,L,k,R,D,$;return Xr.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return s=o.getData,u=o.onLoad,l=o.onError,this.loadDataId++,f=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Jh.Loading,h=null,H.prev=7,v=this.x,m=this.y,x=this.z,E=this.bounds,A=this.tileSize,L=pne(v,m,x),k=L.warpX,R=L.warpY,D=this.abortController.signal,$={x:k,y:R,z:x,bounds:E,tileSize:A,signal:D},H.next=14,s($,this);case 14:h=H.sent,H.next=20;break;case 17:H.prev=17,H.t0=H.catch(7),p=H.t0;case 20:if(f===this.loadDataId){H.next=22;break}return H.abrupt("return");case 22:if(!(this.isCancelled&&!h)){H.next=24;break}return H.abrupt("return");case 24:if(!(p||!h)){H.next=28;break}return this.loadStatus=Jh.Failure,l(p,this),H.abrupt("return");case 28:this.loadStatus=Jh.Loaded,this.data=h,u(this);case 31:case"end":return H.stop()}},a,this,[[7,17]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"reloadData",value:function(i){this.isLoading&&this.abortLoad(),this.loadData(i)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=Jh.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),t}(zf.exports.EventEmitter),s6e=function(r,t){var n=kE(r),i=i1(n,t),a=360*3-180,o=85.0511287798065,s=[Math.max(i[0][0],-a),Math.max(i[0][1],-o),Math.min(i[1][0],a),Math.min(i[1][1],o)];return s},u6e=function(r,t){var n=kE(r),i=kE(t),a=mk(n,i);return a},Kt={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(e,r){(function(){var t,n="4.17.21",i=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",s="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",l=500,f="__lodash_placeholder__",h=1,p=2,v=4,m=1,x=2,E=1,A=2,L=4,k=8,R=16,D=32,$=64,j=128,H=256,ee=512,U=30,W="...",Q=800,te=16,ie=1,ve=2,me=3,Re=1/0,We=9007199254740991,je=17976931348623157e292,lt=0/0,dt=4294967295,ct=dt-1,Tt=dt>>>1,It=[["ary",j],["bind",E],["bindKey",A],["curry",k],["curryRight",R],["flip",ee],["partial",D],["partialRight",$],["rearg",H]],Lt="[object Arguments]",rn="[object Array]",wn="[object AsyncFunction]",zn="[object Boolean]",Zt="[object Date]",nn="[object DOMException]",mn="[object Error]",zt="[object Function]",Vr="[object GeneratorFunction]",On="[object Map]",Si="[object Number]",Fn="[object Null]",Ai="[object Object]",Ua="[object Promise]",va="[object Proxy]",Va="[object RegExp]",to="[object Set]",Os="[object String]",Ro="[object Symbol]",ne="[object Undefined]",Qt="[object WeakMap]",gr="[object WeakSet]",hn="[object ArrayBuffer]",$n="[object DataView]",Ta="[object Float32Array]",Qn="[object Float64Array]",ci="[object Int8Array]",Wn="[object Int16Array]",Ti="[object Int32Array]",Li="[object Uint8Array]",Oo="[object Uint8ClampedArray]",Fo="[object Uint16Array]",xl="[object Uint32Array]",Fc=/\b__p \+= '';/g,gf=/\b(__p \+=) '' \+/g,Gl=/(__e\(.*?\)|\b__t\)) \+\n'';/g,iu=/&(?:amp|lt|gt|quot|#39);/g,bl=/[&<>"']/g,Dc=RegExp(iu.source),mf=RegExp(bl.source),fo=/<%-([\s\S]+?)%>/g,ae=/<%([\s\S]+?)%>/g,ue=/<%=([\s\S]+?)%>/g,fe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ce=/^\w*$/,Ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/[\\^$.*+?()[\]{}|]/g,pt=RegExp(it.source),_e=/^\s+/,Ge=/\s/,wt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,cr=/\{\n\/\* \[wrapped with (.+)\] \*/,fr=/,? & /,$t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pr=/[()=,{}\[\]\/\s]/,Rr=/\\(\\)?/g,cn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ht=/\w*$/,an=/^[-+]0x[0-9a-f]+$/i,Br=/^0b[01]+$/i,$r=/^\[object .+?Constructor\]$/,Ln=/^0o[0-7]+$/i,Tr=/^(?:0|[1-9]\d*)$/,Sn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,pi=/($^)/,oi=/['\n\r\u2028\u2029\\]/g,Pi="\\ud800-\\udfff",Oi="\\u0300-\\u036f",Gs="\\ufe20-\\ufe2f",Qi="\\u20d0-\\u20ff",Ki=Oi+Gs+Qi,oa="\\u2700-\\u27bf",bi="a-z\\xdf-\\xf6\\xf8-\\xff",Ni="\\xac\\xb1\\xd7\\xf7",Fs="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xu="\\u2000-\\u206f",ho=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",au="A-Z\\xc0-\\xd6\\xd8-\\xde",bp="\\ufe0e\\ufe0f",Bc=Ni+Fs+Xu+ho,ya="['\u2019]",yf="["+Pi+"]",Ds="["+Bc+"]",po="["+Ki+"]",_u="\\d+",Za="["+oa+"]",Pu="["+bi+"]",bo="[^"+Pi+Bc+_u+oa+bi+au+"]",yh="\\ud83c[\\udffb-\\udfff]",Yu="(?:"+po+"|"+yh+")",_h="[^"+Pi+"]",wl="(?:\\ud83c[\\udde6-\\uddff]){2}",ws="[\\ud800-\\udbff][\\udc00-\\udfff]",Ru="["+au+"]",he="\\u200d",Te="(?:"+Pu+"|"+bo+")",et="(?:"+Ru+"|"+bo+")",jt="(?:"+ya+"(?:d|ll|m|re|s|t|ve))?",Or="(?:"+ya+"(?:D|LL|M|RE|S|T|VE))?",Bn=Yu+"?",Ji="["+bp+"]?",Bs="(?:"+he+"(?:"+[_h,wl,ws].join("|")+")"+Ji+Bn+")*",Hs="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",js=Ji+Bn+Bs,dm="(?:"+[Za,wl,ws].join("|")+")"+js,nv="(?:"+[_h+po+"?",po,wl,ws,yf].join("|")+")",zy=RegExp(ya,"g"),ng=RegExp(po,"g"),Cl=RegExp(yh+"(?="+yh+")|"+nv+js,"g"),xh=RegExp([Ru+"?"+Pu+"+"+jt+"(?="+[Ds,Ru,"$"].join("|")+")",et+"+"+Or+"(?="+[Ds,Ru+Te,"$"].join("|")+")",Ru+"?"+Te+"+"+jt,Ru+"+"+Or,xu,Hs,_u,dm].join("|"),"g"),bh=RegExp("["+he+Pi+Ki+bp+"]"),wp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,El=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],wh=-1,wo={};wo[Ta]=wo[Qn]=wo[ci]=wo[Wn]=wo[Ti]=wo[Li]=wo[Oo]=wo[Fo]=wo[xl]=!0,wo[Lt]=wo[rn]=wo[hn]=wo[zn]=wo[$n]=wo[Zt]=wo[mn]=wo[zt]=wo[On]=wo[Si]=wo[Ai]=wo[Va]=wo[to]=wo[Os]=wo[Qt]=!1;var ea={};ea[Lt]=ea[rn]=ea[hn]=ea[$n]=ea[zn]=ea[Zt]=ea[Ta]=ea[Qn]=ea[ci]=ea[Wn]=ea[Ti]=ea[On]=ea[Si]=ea[Ai]=ea[Va]=ea[to]=ea[Os]=ea[Ro]=ea[Li]=ea[Oo]=ea[Fo]=ea[xl]=!0,ea[mn]=ea[zt]=ea[Qt]=!1;var us={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Cp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},vm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},P_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},gm=parseFloat,iv=parseInt,Nc=typeof jp=="object"&&jp&&jp.Object===Object&&jp,sd=typeof self=="object"&&self&&self.Object===Object&&self,Ws=Nc||sd||Function("return this")(),av=r&&!r.nodeType&&r,Ch=av&&!0&&e&&!e.nodeType&&e,$y=Ch&&Ch.exports===av,Ep=$y&&Nc.process,Zu=function(){try{var bt=Ch&&Ch.require&&Ch.require("util").types;return bt||Ep&&Ep.binding&&Ep.binding("util")}catch{}}(),mm=Zu&&Zu.isArrayBuffer,ou=Zu&&Zu.isDate,ig=Zu&&Zu.isMap,qu=Zu&&Zu.isRegExp,Vf=Zu&&Zu.isSet,Eh=Zu&&Zu.isTypedArray;function hs(bt,lr,Xt){switch(Xt.length){case 0:return bt.call(lr);case 1:return bt.call(lr,Xt[0]);case 2:return bt.call(lr,Xt[0],Xt[1]);case 3:return bt.call(lr,Xt[0],Xt[1],Xt[2])}return bt.apply(lr,Xt)}function Sh(bt,lr,Xt,Jr){for(var Ii=-1,ga=bt==null?0:bt.length;++Ii<ga;){var To=bt[Ii];lr(Jr,To,Xt(To),bt)}return Jr}function ps(bt,lr){for(var Xt=-1,Jr=bt==null?0:bt.length;++Xt<Jr&&lr(bt[Xt],Xt,bt)!==!1;);return bt}function Ah(bt,lr){for(var Xt=bt==null?0:bt.length;Xt--&&lr(bt[Xt],Xt,bt)!==!1;);return bt}function Sl(bt,lr){for(var Xt=-1,Jr=bt==null?0:bt.length;++Xt<Jr;)if(!lr(bt[Xt],Xt,bt))return!1;return!0}function _f(bt,lr){for(var Xt=-1,Jr=bt==null?0:bt.length,Ii=0,ga=[];++Xt<Jr;){var To=bt[Xt];lr(To,Xt,bt)&&(ga[Ii++]=To)}return ga}function zc(bt,lr){var Xt=bt==null?0:bt.length;return!!Xt&&Ku(bt,lr,0)>-1}function Ma(bt,lr,Xt){for(var Jr=-1,Ii=bt==null?0:bt.length;++Jr<Ii;)if(Xt(lr,bt[Jr]))return!0;return!1}function ls(bt,lr){for(var Xt=-1,Jr=bt==null?0:bt.length,Ii=Array(Jr);++Xt<Jr;)Ii[Xt]=lr(bt[Xt],Xt,bt);return Ii}function $c(bt,lr){for(var Xt=-1,Jr=lr.length,Ii=bt.length;++Xt<Jr;)bt[Ii+Xt]=lr[Xt];return bt}function ag(bt,lr,Xt,Jr){var Ii=-1,ga=bt==null?0:bt.length;for(Jr&&ga&&(Xt=bt[++Ii]);++Ii<ga;)Xt=lr(Xt,bt[Ii],Ii,bt);return Xt}function ym(bt,lr,Xt,Jr){var Ii=bt==null?0:bt.length;for(Jr&&Ii&&(Xt=bt[--Ii]);Ii--;)Xt=lr(Xt,bt[Ii],Ii,bt);return Xt}function og(bt,lr){for(var Xt=-1,Jr=bt==null?0:bt.length;++Xt<Jr;)if(lr(bt[Xt],Xt,bt))return!0;return!1}var Uy=Vc("length");function Th(bt){return bt.split("")}function ro(bt){return bt.match($t)||[]}function Gf(bt,lr,Xt){var Jr;return Xt(bt,function(Ii,ga,To){if(lr(Ii,ga,To))return Jr=ga,!1}),Jr}function ov(bt,lr,Xt,Jr){for(var Ii=bt.length,ga=Xt+(Jr?1:-1);Jr?ga--:++ga<Ii;)if(lr(bt[ga],ga,bt))return ga;return-1}function Ku(bt,lr,Xt){return lr===lr?lg(bt,lr,Xt):ov(bt,Uc,Xt)}function sv(bt,lr,Xt,Jr){for(var Ii=Xt-1,ga=bt.length;++Ii<ga;)if(Jr(bt[Ii],lr))return Ii;return-1}function Uc(bt){return bt!==bt}function Hf(bt,lr){var Xt=bt==null?0:bt.length;return Xt?Ga(bt,lr)/Xt:lt}function Vc(bt){return function(lr){return lr==null?t:lr[bt]}}function lc(bt){return function(lr){return bt==null?t:bt[lr]}}function Sp(bt,lr,Xt,Jr,Ii){return Ii(bt,function(ga,To,Un){Xt=Jr?(Jr=!1,ga):lr(Xt,ga,To,Un)}),Xt}function Mh(bt,lr){var Xt=bt.length;for(bt.sort(lr);Xt--;)bt[Xt]=bt[Xt].value;return bt}function Ga(bt,lr){for(var Xt,Jr=-1,Ii=bt.length;++Jr<Ii;){var ga=lr(bt[Jr]);ga!==t&&(Xt=Xt===t?ga:Xt+ga)}return Xt}function Lh(bt,lr){for(var Xt=-1,Jr=Array(bt);++Xt<bt;)Jr[Xt]=lr(Xt);return Jr}function Vy(bt,lr){return ls(lr,function(Xt){return[Xt,bt[Xt]]})}function Ap(bt){return bt&&bt.slice(0,cd(bt)+1).replace(_e,"")}function Al(bt){return function(lr){return bt(lr)}}function _m(bt,lr){return ls(lr,function(Xt){return bt[Xt]})}function ud(bt,lr){return bt.has(lr)}function Tp(bt,lr){for(var Xt=-1,Jr=bt.length;++Xt<Jr&&Ku(lr,bt[Xt],0)>-1;);return Xt}function xf(bt,lr){for(var Xt=bt.length;Xt--&&Ku(lr,bt[Xt],0)>-1;);return Xt}function Mp(bt,lr){for(var Xt=bt.length,Jr=0;Xt--;)bt[Xt]===lr&&++Jr;return Jr}var ld=lc(us),bf=lc(Cp);function Ih(bt){return"\\"+P_[bt]}function sg(bt,lr){return bt==null?t:bt[lr]}function Hl(bt){return bh.test(bt)}function jl(bt){return wp.test(bt)}function xm(bt){for(var lr,Xt=[];!(lr=bt.next()).done;)Xt.push(lr.value);return Xt}function uv(bt){var lr=-1,Xt=Array(bt.size);return bt.forEach(function(Jr,Ii){Xt[++lr]=[Ii,Jr]}),Xt}function ug(bt,lr){return function(Xt){return bt(lr(Xt))}}function fl(bt,lr){for(var Xt=-1,Jr=bt.length,Ii=0,ga=[];++Xt<Jr;){var To=bt[Xt];(To===lr||To===f)&&(bt[Xt]=f,ga[Ii++]=Xt)}return ga}function jf(bt){var lr=-1,Xt=Array(bt.size);return bt.forEach(function(Jr){Xt[++lr]=Jr}),Xt}function lv(bt){var lr=-1,Xt=Array(bt.size);return bt.forEach(function(Jr){Xt[++lr]=[Jr,Jr]}),Xt}function lg(bt,lr,Xt){for(var Jr=Xt-1,Ii=bt.length;++Jr<Ii;)if(bt[Jr]===lr)return Jr;return-1}function cv(bt,lr,Xt){for(var Jr=Xt+1;Jr--;)if(bt[Jr]===lr)return Jr;return Jr}function Gc(bt){return Hl(bt)?Gy(bt):Uy(bt)}function Qu(bt){return Hl(bt)?cg(bt):Th(bt)}function cd(bt){for(var lr=bt.length;lr--&&Ge.test(bt.charAt(lr)););return lr}var fd=lc(vm);function Gy(bt){for(var lr=Cl.lastIndex=0;Cl.test(bt);)++lr;return lr}function cg(bt){return bt.match(Cl)||[]}function bm(bt){return bt.match(xh)||[]}var fv=function bt(lr){lr=lr==null?Ws:kh.defaults(Ws.Object(),lr,kh.pick(Ws,El));var Xt=lr.Array,Jr=lr.Date,Ii=lr.Error,ga=lr.Function,To=lr.Math,Un=lr.Object,qa=lr.RegExp,Ju=lr.String,el=lr.TypeError,Wf=Xt.prototype,hv=ga.prototype,hd=Un.prototype,fg=lr["__core-js_shared__"],Ph=hv.toString,Fa=hd.hasOwnProperty,wf=0,Do=function(){var w=/[^.]+$/.exec(fg&&fg.keys&&fg.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),Rh=hd.toString,pv=Ph.call(Un),Da=Ws._,dn=qa("^"+Ph.call(Fa).replace(it,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bu=$y?lr.Buffer:t,cc=lr.Symbol,Cf=lr.Uint8Array,Wl=bu?bu.allocUnsafe:t,wu=ug(Un.getPrototypeOf,Un),dv=Un.create,Yr=hd.propertyIsEnumerable,Hc=Wf.splice,Cs=cc?cc.isConcatSpreadable:t,Oh=cc?cc.iterator:t,su=cc?cc.toStringTag:t,ds=function(){try{var w=Rl(Un,"defineProperty");return w({},"",{}),w}catch{}}(),vv=lr.clearTimeout!==Ws.clearTimeout&&lr.clearTimeout,gv=Jr&&Jr.now!==Ws.Date.now&&Jr.now,Tl=lr.setTimeout!==Ws.setTimeout&&lr.setTimeout,fc=To.ceil,mv=To.floor,Lp=Un.getOwnPropertySymbols,yv=bu?bu.isBuffer:t,_v=lr.isFinite,Xl=Wf.join,Ml=ug(Un.keys,Un),ti=To.max,Bo=To.min,Yl=Jr.now,Cu=lr.parseInt,jc=To.random,Fh=Wf.reverse,Xs=Rl(lr,"DataView"),vs=Rl(lr,"Map"),Dh=Rl(lr,"Promise"),Pn=Rl(lr,"Set"),_n=Rl(lr,"WeakMap"),Xf=Rl(Un,"create"),Ys=_n&&new _n,Ou={},uu=Ka(Xs),Wc=Ka(vs),hg=Ka(Dh),Ll=Ka(Pn),La=Ka(_n),Es=cc?cc.prototype:t,Il=Es?Es.valueOf:t,Ef=Es?Es.toString:t;function be(w){if(ys(w)&&!Ci(w)&&!(w instanceof zi)){if(w instanceof Su)return w;if(Fa.call(w,"__wrapped__"))return Vi(w)}return new Su(w)}var Fu=function(){function w(){}return function(T){if(!ms(T))return{};if(dv)return dv(T);w.prototype=T;var B=new w;return w.prototype=t,B}}();function Eu(){}function Su(w,T){this.__wrapped__=w,this.__actions__=[],this.__chain__=!!T,this.__index__=0,this.__values__=t}be.templateSettings={escape:fo,evaluate:ae,interpolate:ue,variable:"",imports:{_:be}},be.prototype=Eu.prototype,be.prototype.constructor=be,Su.prototype=Fu(Eu.prototype),Su.prototype.constructor=Su;function zi(w){this.__wrapped__=w,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=dt,this.__views__=[]}function xv(){var w=new zi(this.__wrapped__);return w.__actions__=Pl(this.__actions__),w.__dir__=this.__dir__,w.__filtered__=this.__filtered__,w.__iteratees__=Pl(this.__iteratees__),w.__takeCount__=this.__takeCount__,w.__views__=Pl(this.__views__),w}function Ip(){if(this.__filtered__){var w=new zi(this);w.__dir__=-1,w.__filtered__=!0}else w=this.clone(),w.__dir__*=-1;return w}function bv(){var w=this.__wrapped__.value(),T=this.__dir__,B=Ci(w),Y=T<0,le=B?w.length:0,Me=Rt(0,le,this.__views__),rt=Me.start,gt=Me.end,Pt=gt-rt,Sr=Y?gt:rt-1,Lr=this.__iteratees__,Gr=Lr.length,Gn=0,vi=Bo(Pt,this.__takeCount__);if(!B||!Y&&le==Pt&&vi==Pt)return B_(w,this.__actions__);var Yi=[];e:for(;Pt--&&Gn<vi;){Sr+=T;for(var Oa=-1,Zi=w[Sr];++Oa<Gr;){var Ja=Lr[Oa],yo=Ja.iteratee,zp=Ja.type,rh=yo(Zi);if(zp==ve)Zi=rh;else if(!rh){if(zp==ie)continue e;break e}}Yi[Gn++]=Zi}return Yi}zi.prototype=Fu(Eu.prototype),zi.prototype.constructor=zi;function Yf(w){var T=-1,B=w==null?0:w.length;for(this.clear();++T<B;){var Y=w[T];this.set(Y[0],Y[1])}}function pd(){this.__data__=Xf?Xf(null):{},this.size=0}function kp(w){var T=this.has(w)&&delete this.__data__[w];return this.size-=T?1:0,T}function wm(w){var T=this.__data__;if(Xf){var B=T[w];return B===u?t:B}return Fa.call(T,w)?T[w]:t}function Bh(w){var T=this.__data__;return Xf?T[w]!==t:Fa.call(T,w)}function Nh(w,T){var B=this.__data__;return this.size+=this.has(w)?0:1,B[w]=Xf&&T===t?u:T,this}Yf.prototype.clear=pd,Yf.prototype.delete=kp,Yf.prototype.get=wm,Yf.prototype.has=Bh,Yf.prototype.set=Nh;function Zl(w){var T=-1,B=w==null?0:w.length;for(this.clear();++T<B;){var Y=w[T];this.set(Y[0],Y[1])}}function Zf(){this.__data__=[],this.size=0}function hc(w){var T=this.__data__,B=Ut(T,w);if(B<0)return!1;var Y=T.length-1;return B==Y?T.pop():Hc.call(T,B,1),--this.size,!0}function Cm(w){var T=this.__data__,B=Ut(T,w);return B<0?t:T[B][1]}function Pp(w){return Ut(this.__data__,w)>-1}function dd(w,T){var B=this.__data__,Y=Ut(B,w);return Y<0?(++this.size,B.push([w,T])):B[Y][1]=T,this}Zl.prototype.clear=Zf,Zl.prototype.delete=hc,Zl.prototype.get=Cm,Zl.prototype.has=Pp,Zl.prototype.set=dd;function pc(w){var T=-1,B=w==null?0:w.length;for(this.clear();++T<B;){var Y=w[T];this.set(Y[0],Y[1])}}function y(){this.size=0,this.__data__={hash:new Yf,map:new(vs||Zl),string:new Yf}}function b(w){var T=ja(this,w).delete(w);return this.size-=T?1:0,T}function _(w){return ja(this,w).get(w)}function S(w){return ja(this,w).has(w)}function P(w,T){var B=ja(this,w),Y=B.size;return B.set(w,T),this.size+=B.size==Y?0:1,this}pc.prototype.clear=y,pc.prototype.delete=b,pc.prototype.get=_,pc.prototype.has=S,pc.prototype.set=P;function F(w){var T=-1,B=w==null?0:w.length;for(this.__data__=new pc;++T<B;)this.add(w[T])}function N(w){return this.__data__.set(w,u),this}function V(w){return this.__data__.has(w)}F.prototype.add=F.prototype.push=N,F.prototype.has=V;function J(w){var T=this.__data__=new Zl(w);this.size=T.size}function se(){this.__data__=new Zl,this.size=0}function de(w){var T=this.__data__,B=T.delete(w);return this.size=T.size,B}function xe(w){return this.__data__.get(w)}function Ee(w){return this.__data__.has(w)}function Ue(w,T){var B=this.__data__;if(B instanceof Zl){var Y=B.__data__;if(!vs||Y.length<i-1)return Y.push([w,T]),this.size=++B.size,this;B=this.__data__=new pc(Y)}return B.set(w,T),this.size=B.size,this}J.prototype.clear=se,J.prototype.delete=de,J.prototype.get=xe,J.prototype.has=Ee,J.prototype.set=Ue;function Be(w,T){var B=Ci(w),Y=!B&&bc(w),le=!B&&!Y&&th(w),Me=!B&&!Y&&!le&&Cd(w),rt=B||Y||le||Me,gt=rt?Lh(w.length,Ju):[],Pt=gt.length;for(var Sr in w)(T||Fa.call(w,Sr))&&!(rt&&(Sr=="length"||le&&(Sr=="offset"||Sr=="parent")||Me&&(Sr=="buffer"||Sr=="byteLength"||Sr=="byteOffset")||dr(Sr,Pt)))&&gt.push(Sr);return gt}function Ke(w){var T=w.length;return T?w[gd(0,T-1)]:t}function Oe(w,T){return Xn(Pl(w),Kr(T,0,w.length))}function Qe(w){return Xn(Pl(w))}function ft(w,T,B){(B!==t&&!ao(w[T],B)||B===t&&!(T in w))&&yr(w,T,B)}function xt(w,T,B){var Y=w[T];(!(Fa.call(w,T)&&ao(Y,B))||B===t&&!(T in w))&&yr(w,T,B)}function Ut(w,T){for(var B=w.length;B--;)if(ao(w[B][0],T))return B;return-1}function Bt(w,T,B,Y){return qn(w,function(le,Me,rt){T(Y,le,B(le),rt)}),Y}function Wt(w,T){return w&&mc(T,vl(T),w)}function hr(w,T){return w&&mc(T,rl(T),w)}function yr(w,T,B){T=="__proto__"&&ds?ds(w,T,{configurable:!0,enumerable:!0,value:B,writable:!0}):w[T]=B}function Ir(w,T){for(var B=-1,Y=T.length,le=Xt(Y),Me=w==null;++B<Y;)le[B]=Me?t:ib(w,T[B]);return le}function Kr(w,T,B){return w===w&&(B!==t&&(w=w<=B?w:B),T!==t&&(w=w>=T?w:T)),w}function An(w,T,B,Y,le,Me){var rt,gt=T&h,Pt=T&p,Sr=T&v;if(B&&(rt=le?B(w,Y,le,Me):B(w)),rt!==t)return rt;if(!ms(w))return w;var Lr=Ci(w);if(Lr){if(rt=Yt(w),!gt)return Pl(w,rt)}else{var Gr=Ve(w),Gn=Gr==zt||Gr==Vr;if(th(w))return Lm(w,gt);if(Gr==Ai||Gr==Lt||Gn&&!le){if(rt=Pt||Gn?{}:sr(w),!gt)return Pt?Tv(w,hr(rt,w)):_d(w,Wt(rt,w))}else{if(!ea[Gr])return le?w:{};rt=mr(w,Gr,gt)}}Me||(Me=new J);var vi=Me.get(w);if(vi)return vi;Me.set(w,rt),Bm(w)?w.forEach(function(Zi){rt.add(An(Zi,T,B,Zi,w,Me))}):Rv(w)&&w.forEach(function(Zi,Ja){rt.set(Ja,An(Zi,T,B,Ja,w,Me))});var Yi=Sr?Pt?W_:j_:Pt?rl:vl,Oa=Lr?t:Yi(w);return ps(Oa||w,function(Zi,Ja){Oa&&(Ja=Zi,Zi=w[Ja]),xt(rt,Ja,An(Zi,T,B,Ja,w,Me))}),rt}function Nn(w){var T=vl(w);return function(B){return Dn(B,w,T)}}function Dn(w,T,B){var Y=B.length;if(w==null)return!Y;for(w=Un(w);Y--;){var le=B[Y],Me=T[le],rt=w[le];if(rt===t&&!(le in w)||!Me(rt))return!1}return!0}function sa(w,T,B){if(typeof w!="function")throw new el(o);return li(function(){w.apply(t,B)},T)}function on(w,T,B,Y){var le=-1,Me=zc,rt=!0,gt=w.length,Pt=[],Sr=T.length;if(!gt)return Pt;B&&(T=ls(T,Al(B))),Y?(Me=Ma,rt=!1):T.length>=i&&(Me=ud,rt=!1,T=new F(T));e:for(;++le<gt;){var Lr=w[le],Gr=B==null?Lr:B(Lr);if(Lr=Y||Lr!==0?Lr:0,rt&&Gr===Gr){for(var Gn=Sr;Gn--;)if(T[Gn]===Gr)continue e;Pt.push(Lr)}else Me(T,Gr,Y)||Pt.push(Lr)}return Pt}var qn=N_(Mo),di=N_(Ss,!0);function si(w,T){var B=!0;return qn(w,function(Y,le,Me){return B=!!T(Y,le,Me),B}),B}function Jn(w,T,B){for(var Y=-1,le=w.length;++Y<le;){var Me=w[Y],rt=T(Me);if(rt!=null&&(gt===t?rt===rt&&!Dl(rt):B(rt,gt)))var gt=rt,Pt=Me}return Pt}function wi(w,T,B,Y){var le=w.length;for(B=fa(B),B<0&&(B=-B>le?0:le+B),Y=Y===t||Y>le?le:fa(Y),Y<0&&(Y+=le),Y=B>Y?0:sA(Y);B<Y;)w[B++]=T;return w}function ri(w,T){var B=[];return qn(w,function(Y,le,Me){T(Y,le,Me)&&B.push(Y)}),B}function Tn(w,T,B,Y,le){var Me=-1,rt=w.length;for(B||(B=wr),le||(le=[]);++Me<rt;){var gt=w[Me];T>0&&B(gt)?T>1?Tn(gt,T-1,B,Y,le):$c(le,gt):Y||(le[le.length]=gt)}return le}var Zo=z_(),No=z_(!0);function Mo(w,T){return w&&Zo(w,T,vl)}function Ss(w,T){return w&&No(w,T,vl)}function vo(w,T){return _f(T,function(B){return jh(w[B])})}function no(w,T){T=Lf(T,w);for(var B=0,Y=T.length;w!=null&&B<Y;)w=w[_i(T[B++])];return B&&B==Y?w:t}function Du(w,T,B){var Y=T(w);return Ci(w)?Y:$c(Y,B(w))}function Ha(w){return w==null?w===t?ne:Fn:su&&su in Un(w)?Tg(w):qt(w)}function Xc(w,T){return w>T}function tl(w,T){return w!=null&&Fa.call(w,T)}function dc(w,T){return w!=null&&T in Un(w)}function ql(w,T,B){return w>=Bo(T,B)&&w<ti(T,B)}function qf(w,T,B){for(var Y=B?Ma:zc,le=w[0].length,Me=w.length,rt=Me,gt=Xt(Me),Pt=1/0,Sr=[];rt--;){var Lr=w[rt];rt&&T&&(Lr=ls(Lr,Al(T))),Pt=Bo(Lr.length,Pt),gt[rt]=!B&&(T||le>=120&&Lr.length>=120)?new F(rt&&Lr):t}Lr=w[0];var Gr=-1,Gn=gt[0];e:for(;++Gr<le&&Sr.length<Pt;){var vi=Lr[Gr],Yi=T?T(vi):vi;if(vi=B||vi!==0?vi:0,!(Gn?ud(Gn,Yi):Y(Sr,Yi,B))){for(rt=Me;--rt;){var Oa=gt[rt];if(!(Oa?ud(Oa,Yi):Y(w[rt],Yi,B)))continue e}Gn&&Gn.push(Yi),Sr.push(vi)}}return Sr}function Rp(w,T,B,Y){return Mo(w,function(le,Me,rt){T(Y,B(le),Me,rt)}),Y}function Kl(w,T,B){T=Lf(T,w),w=Ur(w,T);var Y=w==null?w:w[_i(Ye(T))];return Y==null?t:hs(Y,w,B)}function Kf(w){return ys(w)&&Ha(w)==Lt}function Op(w){return ys(w)&&Ha(w)==hn}function Yc(w){return ys(w)&&Ha(w)==Zt}function Zc(w,T,B,Y,le){return w===T?!0:w==null||T==null||!ys(w)&&!ys(T)?w!==w&&T!==T:qc(w,T,B,Y,Zc,le)}function qc(w,T,B,Y,le,Me){var rt=Ci(w),gt=Ci(T),Pt=rt?rn:Ve(w),Sr=gt?rn:Ve(T);Pt=Pt==Lt?Ai:Pt,Sr=Sr==Lt?Ai:Sr;var Lr=Pt==Ai,Gr=Sr==Ai,Gn=Pt==Sr;if(Gn&&th(w)){if(!th(T))return!1;rt=!0,Lr=!1}if(Gn&&!Lr)return Me||(Me=new J),rt||Cd(w)?H1(w,T,B,Y,le,Me):j1(w,T,Pt,B,Y,le,Me);if(!(B&m)){var vi=Lr&&Fa.call(w,"__wrapped__"),Yi=Gr&&Fa.call(T,"__wrapped__");if(vi||Yi){var Oa=vi?w.value():w,Zi=Yi?T.value():T;return Me||(Me=new J),le(Oa,Zi,B,Y,Me)}}return Gn?(Me||(Me=new J),yw(w,T,B,Y,le,Me)):!1}function Ns(w){return ys(w)&&Ve(w)==On}function Ql(w,T,B,Y){var le=B.length,Me=le,rt=!Y;if(w==null)return!Me;for(w=Un(w);le--;){var gt=B[le];if(rt&&gt[2]?gt[1]!==w[gt[0]]:!(gt[0]in w))return!1}for(;++le<Me;){gt=B[le];var Pt=gt[0],Sr=w[Pt],Lr=gt[1];if(rt&&gt[2]){if(Sr===t&&!(Pt in w))return!1}else{var Gr=new J;if(Y)var Gn=Y(Sr,Lr,Pt,w,T,Gr);if(!(Gn===t?Zc(Lr,Sr,m|x,Y,Gr):Gn))return!1}}return!0}function Sf(w){if(!ms(w)||Gt(w))return!1;var T=jh(w)?dn:$r;return T.test(Ka(w))}function zh(w){return ys(w)&&Ha(w)==Va}function ma(w){return ys(w)&&Ve(w)==to}function hl(w){return ys(w)&&Wh(w.length)&&!!wo[Ha(w)]}function Zs(w){return typeof w=="function"?w:w==null?Xh:typeof w=="object"?Ci(w)?Fp(w[0],w[1]):vc(w):c7(w)}function Af(w){if(!Zr(w))return Ml(w);var T=[];for(var B in Un(w))Fa.call(w,B)&&B!="constructor"&&T.push(B);return T}function pg(w){if(!ms(w))return Jt(w);var T=Zr(w),B=[];for(var Y in w)Y=="constructor"&&(T||!Fa.call(w,Y))||B.push(Y);return B}function kl(w,T){return w<T}function vd(w,T){var B=-1,Y=Ra(w)?Xt(w.length):[];return qn(w,function(le,Me,rt){Y[++B]=T(le,Me,rt)}),Y}function vc(w){var T=Yy(w);return T.length==1&&T[0][2]?Fr(T[0][0],T[0][1]):function(B){return B===w||Ql(B,w,T)}}function Fp(w,T){return vr(w)&&or(T)?Fr(_i(w),T):function(B){var Y=ib(B,w);return Y===t&&Y===T?r0(B,w):Zc(T,Y,m|x)}}function Jl(w,T,B,Y,le){w!==T&&Zo(T,function(Me,rt){if(le||(le=new J),ms(Me))Tf(w,T,rt,B,Jl,Y,le);else{var gt=Y?Y(qr(w,rt),Me,rt+"",w,T,le):t;gt===t&&(gt=Me),ft(w,rt,gt)}},rl)}function Tf(w,T,B,Y,le,Me,rt){var gt=qr(w,B),Pt=qr(T,B),Sr=rt.get(Pt);if(Sr){ft(w,B,Sr);return}var Lr=Me?Me(gt,Pt,B+"",w,T,rt):t,Gr=Lr===t;if(Gr){var Gn=Ci(Pt),vi=!Gn&&th(Pt),Yi=!Gn&&!vi&&Cd(Pt);Lr=Pt,Gn||vi||Yi?Ci(gt)?Lr=gt:Uo(gt)?Lr=Pl(gt):vi?(Gr=!1,Lr=Lm(Pt,!0)):Yi?(Gr=!1,Lr=md(Pt,!0)):Lr=[]:Ov(Pt)||bc(Pt)?(Lr=gt,bc(gt)?Lr=Ls(gt):(!ms(gt)||jh(gt))&&(Lr=sr(Pt))):Gr=!1}Gr&&(rt.set(Pt,Lr),le(Lr,Pt,Y,Me,rt),rt.delete(Pt)),ft(w,B,Lr)}function $h(w,T){var B=w.length;if(!!B)return T+=T<0?B:0,dr(T,B)?w[T]:t}function gc(w,T,B){T.length?T=ls(T,function(Me){return Ci(Me)?function(rt){return no(rt,Me.length===1?Me[0]:Me)}:Me}):T=[Xh];var Y=-1;T=ls(T,Al(yi()));var le=vd(w,function(Me,rt,gt){var Pt=ls(T,function(Sr){return Sr(Me)});return{criteria:Pt,index:++Y,value:Me}});return Mh(le,function(Me,rt){return ec(Me,rt,B)})}function Bu(w,T){return Em(w,T,function(B,Y){return r0(w,Y)})}function Em(w,T,B){for(var Y=-1,le=T.length,Me={};++Y<le;){var rt=T[Y],gt=no(w,rt);B(gt,rt)&&Kc(Me,Lf(rt,w),gt)}return Me}function dg(w){return function(T){return no(T,w)}}function Sm(w,T,B,Y){var le=Y?sv:Ku,Me=-1,rt=T.length,gt=w;for(w===T&&(T=Pl(T)),B&&(gt=ls(w,Al(B)));++Me<rt;)for(var Pt=0,Sr=T[Me],Lr=B?B(Sr):Sr;(Pt=le(gt,Lr,Pt,Y))>-1;)gt!==w&&Hc.call(gt,Pt,1),Hc.call(w,Pt,1);return w}function Hy(w,T){for(var B=w?T.length:0,Y=B-1;B--;){var le=T[B];if(B==Y||le!==Me){var Me=le;dr(le)?Hc.call(w,le,1):D_(w,le)}}return w}function gd(w,T){return w+mv(jc()*(T-w+1))}function vg(w,T,B,Y){for(var le=-1,Me=ti(fc((T-w)/(B||1)),0),rt=Xt(Me);Me--;)rt[Y?Me:++le]=w,w+=B;return rt}function Am(w,T){var B="";if(!w||T<1||T>We)return B;do T%2&&(B+=w),T=mv(T/2),T&&(w+=w);while(T);return B}function _a(w,T){return ii(jr(w,T,Xh),w+"")}function Tm(w){return Ke(Um(w))}function R_(w,T){var B=Um(w);return Xn(B,Kr(T,0,B.length))}function Kc(w,T,B,Y){if(!ms(w))return w;T=Lf(T,w);for(var le=-1,Me=T.length,rt=Me-1,gt=w;gt!=null&&++le<Me;){var Pt=_i(T[le]),Sr=B;if(Pt==="__proto__"||Pt==="constructor"||Pt==="prototype")return w;if(le!=rt){var Lr=gt[Pt];Sr=Y?Y(Lr,Pt,gt):t,Sr===t&&(Sr=ms(Lr)?Lr:dr(T[le+1])?[]:{})}xt(gt,Pt,Sr),gt=gt[Pt]}return w}var gg=Ys?function(w,T){return Ys.set(w,T),w}:Xh,mg=ds?function(w,T){return ds(w,"toString",{configurable:!0,enumerable:!1,value:ZP(T),writable:!0})}:Xh;function O_(w){return Xn(Um(w))}function Mf(w,T,B){var Y=-1,le=w.length;T<0&&(T=-T>le?0:le+T),B=B>le?le:B,B<0&&(B+=le),le=T>B?0:B-T>>>0,T>>>=0;for(var Me=Xt(le);++Y<le;)Me[Y]=w[Y+T];return Me}function mw(w,T){var B;return qn(w,function(Y,le,Me){return B=T(Y,le,Me),!B}),!!B}function Mm(w,T,B){var Y=0,le=w==null?Y:w.length;if(typeof T=="number"&&T===T&&le<=Tt){for(;Y<le;){var Me=Y+le>>>1,rt=w[Me];rt!==null&&!Dl(rt)&&(B?rt<=T:rt<T)?Y=Me+1:le=Me}return le}return F_(w,T,Xh,B)}function F_(w,T,B,Y){var le=0,Me=w==null?0:w.length;if(Me===0)return 0;T=B(T);for(var rt=T!==T,gt=T===null,Pt=Dl(T),Sr=T===t;le<Me;){var Lr=mv((le+Me)/2),Gr=B(w[Lr]),Gn=Gr!==t,vi=Gr===null,Yi=Gr===Gr,Oa=Dl(Gr);if(rt)var Zi=Y||Yi;else Sr?Zi=Yi&&(Y||Gn):gt?Zi=Yi&&Gn&&(Y||!vi):Pt?Zi=Yi&&Gn&&!vi&&(Y||!Oa):vi||Oa?Zi=!1:Zi=Y?Gr<=T:Gr<T;Zi?le=Lr+1:Me=Lr}return Bo(Me,ct)}function U1(w,T){for(var B=-1,Y=w.length,le=0,Me=[];++B<Y;){var rt=w[B],gt=T?T(rt):rt;if(!B||!ao(gt,Pt)){var Pt=gt;Me[le++]=rt===0?0:rt}}return Me}function jy(w){return typeof w=="number"?w:Dl(w)?lt:+w}function Qc(w){if(typeof w=="string")return w;if(Ci(w))return ls(w,Qc)+"";if(Dl(w))return Ef?Ef.call(w):"";var T=w+"";return T=="0"&&1/w==-Re?"-0":T}function Jc(w,T,B){var Y=-1,le=zc,Me=w.length,rt=!0,gt=[],Pt=gt;if(B)rt=!1,le=Ma;else if(Me>=i){var Sr=T?null:Ca(w);if(Sr)return jf(Sr);rt=!1,le=ud,Pt=new F}else Pt=T?[]:gt;e:for(;++Y<Me;){var Lr=w[Y],Gr=T?T(Lr):Lr;if(Lr=B||Lr!==0?Lr:0,rt&&Gr===Gr){for(var Gn=Pt.length;Gn--;)if(Pt[Gn]===Gr)continue e;T&&Pt.push(Gr),gt.push(Lr)}else le(Pt,Gr,B)||(Pt!==gt&&Pt.push(Gr),gt.push(Lr))}return gt}function D_(w,T){return T=Lf(T,w),w=Ur(w,T),w==null||delete w[_i(Ye(T))]}function As(w,T,B,Y){return Kc(w,T,B(no(w,T)),Y)}function wv(w,T,B,Y){for(var le=w.length,Me=Y?le:-1;(Y?Me--:++Me<le)&&T(w[Me],Me,w););return B?Mf(w,Y?0:Me,Y?Me+1:le):Mf(w,Y?Me+1:0,Y?le:Me)}function B_(w,T){var B=w;return B instanceof zi&&(B=B.value()),ag(T,function(Y,le){return le.func.apply(le.thisArg,$c([Y],le.args))},B)}function yg(w,T,B){var Y=w.length;if(Y<2)return Y?Jc(w[0]):[];for(var le=-1,Me=Xt(Y);++le<Y;)for(var rt=w[le],gt=-1;++gt<Y;)gt!=le&&(Me[le]=on(Me[le]||rt,w[gt],T,B));return Jc(Tn(Me,1),T,B)}function Cv(w,T,B){for(var Y=-1,le=w.length,Me=T.length,rt={};++Y<le;){var gt=Y<Me?T[Y]:t;B(rt,w[Y],gt)}return rt}function Uh(w){return Uo(w)?w:[]}function Ev(w){return typeof w=="function"?w:Xh}function Lf(w,T){return Ci(w)?w:vr(w,T)?[w]:fi(Vo(w))}var Sv=_a;function ef(w,T,B){var Y=w.length;return B=B===t?Y:B,!T&&B>=Y?w:Mf(w,T,B)}var Av=vv||function(w){return Ws.clearTimeout(w)};function Lm(w,T){if(T)return w.slice();var B=w.length,Y=Wl?Wl(B):new w.constructor(B);return w.copy(Y),Y}function Dp(w){var T=new w.constructor(w.byteLength);return new Cf(T).set(new Cf(w)),T}function Wy(w,T){var B=T?Dp(w.buffer):w.buffer;return new w.constructor(B,w.byteOffset,w.byteLength)}function _g(w){var T=new w.constructor(w.source,Ht.exec(w));return T.lastIndex=w.lastIndex,T}function Xy(w){return Il?Un(Il.call(w)):{}}function md(w,T){var B=T?Dp(w.buffer):w.buffer;return new w.constructor(B,w.byteOffset,w.length)}function yd(w,T){if(w!==T){var B=w!==t,Y=w===null,le=w===w,Me=Dl(w),rt=T!==t,gt=T===null,Pt=T===T,Sr=Dl(T);if(!gt&&!Sr&&!Me&&w>T||Me&&rt&&Pt&&!gt&&!Sr||Y&&rt&&Pt||!B&&Pt||!le)return 1;if(!Y&&!Me&&!Sr&&w<T||Sr&&B&&le&&!Y&&!Me||gt&&B&&le||!rt&&le||!Pt)return-1}return 0}function ec(w,T,B){for(var Y=-1,le=w.criteria,Me=T.criteria,rt=le.length,gt=B.length;++Y<rt;){var Pt=yd(le[Y],Me[Y]);if(Pt){if(Y>=gt)return Pt;var Sr=B[Y];return Pt*(Sr=="desc"?-1:1)}}return w.index-T.index}function xg(w,T,B,Y){for(var le=-1,Me=w.length,rt=B.length,gt=-1,Pt=T.length,Sr=ti(Me-rt,0),Lr=Xt(Pt+Sr),Gr=!Y;++gt<Pt;)Lr[gt]=T[gt];for(;++le<rt;)(Gr||le<Me)&&(Lr[B[le]]=w[le]);for(;Sr--;)Lr[gt++]=w[le++];return Lr}function bg(w,T,B,Y){for(var le=-1,Me=w.length,rt=-1,gt=B.length,Pt=-1,Sr=T.length,Lr=ti(Me-gt,0),Gr=Xt(Lr+Sr),Gn=!Y;++le<Lr;)Gr[le]=w[le];for(var vi=le;++Pt<Sr;)Gr[vi+Pt]=T[Pt];for(;++rt<gt;)(Gn||le<Me)&&(Gr[vi+B[rt]]=w[le++]);return Gr}function Pl(w,T){var B=-1,Y=w.length;for(T||(T=Xt(Y));++B<Y;)T[B]=w[B];return T}function mc(w,T,B,Y){var le=!B;B||(B={});for(var Me=-1,rt=T.length;++Me<rt;){var gt=T[Me],Pt=Y?Y(B[gt],w[gt],gt,B,w):t;Pt===t&&(Pt=w[gt]),le?yr(B,gt,Pt):xt(B,gt,Pt)}return B}function _d(w,T){return mc(w,Z(w),T)}function Tv(w,T){return mc(w,Se(w),T)}function wg(w,T){return function(B,Y){var le=Ci(B)?Sh:Bt,Me=T?T():{};return le(B,w,yi(Y,2),Me)}}function Cg(w){return _a(function(T,B){var Y=-1,le=B.length,Me=le>1?B[le-1]:t,rt=le>2?B[2]:t;for(Me=w.length>3&&typeof Me=="function"?(le--,Me):t,rt&&xr(B[0],B[1],rt)&&(Me=le<3?t:Me,le=1),T=Un(T);++Y<le;){var gt=B[Y];gt&&w(T,gt,Y,Me)}return T})}function N_(w,T){return function(B,Y){if(B==null)return B;if(!Ra(B))return w(B,Y);for(var le=B.length,Me=T?le:-1,rt=Un(B);(T?Me--:++Me<le)&&Y(rt[Me],Me,rt)!==!1;);return B}}function z_(w){return function(T,B,Y){for(var le=-1,Me=Un(T),rt=Y(T),gt=rt.length;gt--;){var Pt=rt[w?gt:++le];if(B(Me[Pt],Pt,Me)===!1)break}return T}}function xd(w,T,B){var Y=T&E,le=Eg(w);function Me(){var rt=this&&this!==Ws&&this instanceof Me?le:w;return rt.apply(Y?B:this,arguments)}return Me}function $_(w){return function(T){T=Vo(T);var B=Hl(T)?Qu(T):t,Y=B?B[0]:T.charAt(0),le=B?ef(B,1).join(""):T.slice(1);return Y[w]()+le}}function If(w){return function(T){return ag(u7(Lw(T).replace(zy,"")),w,"")}}function Eg(w){return function(){var T=arguments;switch(T.length){case 0:return new w;case 1:return new w(T[0]);case 2:return new w(T[0],T[1]);case 3:return new w(T[0],T[1],T[2]);case 4:return new w(T[0],T[1],T[2],T[3]);case 5:return new w(T[0],T[1],T[2],T[3],T[4]);case 6:return new w(T[0],T[1],T[2],T[3],T[4],T[5]);case 7:return new w(T[0],T[1],T[2],T[3],T[4],T[5],T[6])}var B=Fu(w.prototype),Y=w.apply(B,T);return ms(Y)?Y:B}}function U_(w,T,B){var Y=Eg(w);function le(){for(var Me=arguments.length,rt=Xt(Me),gt=Me,Pt=bd(le);gt--;)rt[gt]=arguments[gt];var Sr=Me<3&&rt[0]!==Pt&&rt[Me-1]!==Pt?[]:fl(rt,Pt);if(Me-=Sr.length,Me<B)return lu(w,T,tf,le.placeholder,t,rt,Sr,t,t,B-Me);var Lr=this&&this!==Ws&&this instanceof le?Y:w;return hs(Lr,this,rt)}return le}function Mv(w){return function(T,B,Y){var le=Un(T);if(!Ra(T)){var Me=yi(B,3);T=vl(T),B=function(gt){return Me(le[gt],gt,le)}}var rt=w(T,B,Y);return rt>-1?le[Me?T[rt]:rt]:t}}function kf(w){return Vh(function(T){var B=T.length,Y=B,le=Su.prototype.thru;for(w&&T.reverse();Y--;){var Me=T[Y];if(typeof Me!="function")throw new el(o);if(le&&!rt&&Ag(Me)=="wrapper")var rt=new Su([],!0)}for(Y=rt?Y:B;++Y<B;){Me=T[Y];var gt=Ag(Me),Pt=gt=="wrapper"?Lv(Me):t;Pt&&_t(Pt[0])&&Pt[1]==(j|k|D|H)&&!Pt[4].length&&Pt[9]==1?rt=rt[Ag(Pt[0])].apply(rt,Pt[3]):rt=Me.length==1&&_t(Me)?rt[gt]():rt.thru(Me)}return function(){var Sr=arguments,Lr=Sr[0];if(rt&&Sr.length==1&&Ci(Lr))return rt.plant(Lr).value();for(var Gr=0,Gn=B?T[Gr].apply(this,Sr):Lr;++Gr<B;)Gn=T[Gr].call(this,Gn);return Gn}})}function tf(w,T,B,Y,le,Me,rt,gt,Pt,Sr){var Lr=T&j,Gr=T&E,Gn=T&A,vi=T&(k|R),Yi=T&ee,Oa=Gn?t:Eg(w);function Zi(){for(var Ja=arguments.length,yo=Xt(Ja),zp=Ja;zp--;)yo[zp]=arguments[zp];if(vi)var rh=bd(Zi),$p=Mp(yo,rh);if(Y&&(yo=xg(yo,Y,le,vi)),Me&&(yo=bg(yo,Me,rt,vi)),Ja-=$p,vi&&Ja<Sr){var gl=fl(yo,rh);return lu(w,T,tf,Zi.placeholder,B,yo,gl,gt,Pt,Sr-Ja)}var Dv=Gr?B:this,Vm=Gn?Dv[w]:w;return Ja=yo.length,gt?yo=br(yo,gt):Yi&&Ja>1&&yo.reverse(),Lr&&Pt<Ja&&(yo.length=Pt),this&&this!==Ws&&this instanceof Zi&&(Vm=Oa||Eg(Vm)),Vm.apply(Dv,yo)}return Zi}function V_(w,T){return function(B,Y){return Rp(B,w,T(Y),{})}}function Bp(w,T){return function(B,Y){var le;if(B===t&&Y===t)return T;if(B!==t&&(le=B),Y!==t){if(le===t)return Y;typeof B=="string"||typeof Y=="string"?(B=Qc(B),Y=Qc(Y)):(B=jy(B),Y=jy(Y)),le=w(B,Y)}return le}}function yc(w){return Vh(function(T){return T=ls(T,Al(yi())),_a(function(B){var Y=this;return w(T,function(le){return hs(le,Y,B)})})})}function Sg(w,T){T=T===t?" ":Qc(T);var B=T.length;if(B<2)return B?Am(T,w):T;var Y=Am(T,fc(w/Gc(T)));return Hl(T)?ef(Qu(Y),0,w).join(""):Y.slice(0,w)}function G_(w,T,B,Y){var le=T&E,Me=Eg(w);function rt(){for(var gt=-1,Pt=arguments.length,Sr=-1,Lr=Y.length,Gr=Xt(Lr+Pt),Gn=this&&this!==Ws&&this instanceof rt?Me:w;++Sr<Lr;)Gr[Sr]=Y[Sr];for(;Pt--;)Gr[Sr++]=arguments[++gt];return hs(Gn,le?B:this,Gr)}return rt}function Im(w){return function(T,B,Y){return Y&&typeof Y!="number"&&xr(T,B,Y)&&(B=Y=t),T=Ed(T),B===t?(B=T,T=0):B=Ed(B),Y=Y===t?T<B?1:-1:Ed(Y),vg(T,B,Y,w)}}function km(w){return function(T,B){return typeof T=="string"&&typeof B=="string"||(T=wc(T),B=wc(B)),w(T,B)}}function lu(w,T,B,Y,le,Me,rt,gt,Pt,Sr){var Lr=T&k,Gr=Lr?rt:t,Gn=Lr?t:rt,vi=Lr?Me:t,Yi=Lr?t:Me;T|=Lr?D:$,T&=~(Lr?$:D),T&L||(T&=~(E|A));var Oa=[w,T,le,vi,Gr,Yi,Gn,gt,Pt,Sr],Zi=B.apply(t,Oa);return _t(w)&&Qr(Zi,Oa),Zi.placeholder=Y,sn(Zi,w,T)}function Qf(w){var T=To[w];return function(B,Y){if(B=wc(B),Y=Y==null?0:Bo(fa(Y),292),Y&&_v(B)){var le=(Vo(B)+"e").split("e"),Me=T(le[0]+"e"+(+le[1]+Y));return le=(Vo(Me)+"e").split("e"),+(le[0]+"e"+(+le[1]-Y))}return T(B)}}var Ca=Pn&&1/jf(new Pn([,-0]))[1]==Re?function(w){return new Pn(w)}:QP;function tc(w){return function(T){var B=Ve(T);return B==On?uv(T):B==to?lv(T):Vy(T,w(T))}}function Jf(w,T,B,Y,le,Me,rt,gt){var Pt=T&A;if(!Pt&&typeof w!="function")throw new el(o);var Sr=Y?Y.length:0;if(Sr||(T&=~(D|$),Y=le=t),rt=rt===t?rt:ti(fa(rt),0),gt=gt===t?gt:fa(gt),Sr-=le?le.length:0,T&$){var Lr=Y,Gr=le;Y=le=t}var Gn=Pt?t:Lv(w),vi=[w,T,B,Y,le,Lr,Gr,Me,rt,gt];if(Gn&&xn(vi,Gn),w=vi[0],T=vi[1],B=vi[2],Y=vi[3],le=vi[4],gt=vi[9]=vi[9]===t?Pt?0:w.length:ti(vi[9]-Sr,0),!gt&&T&(k|R)&&(T&=~(k|R)),!T||T==E)var Yi=xd(w,T,B);else T==k||T==R?Yi=U_(w,T,gt):(T==D||T==(E|D))&&!le.length?Yi=G_(w,T,B,Y):Yi=tf.apply(t,vi);var Oa=Gn?gg:Qr;return sn(Oa(Yi,vi),w,T)}function H_(w,T,B,Y){return w===t||ao(w,hd[B])&&!Fa.call(Y,B)?T:w}function V1(w,T,B,Y,le,Me){return ms(w)&&ms(T)&&(Me.set(T,w),Jl(w,T,t,V1,Me),Me.delete(T)),w}function G1(w){return Ov(w)?t:w}function H1(w,T,B,Y,le,Me){var rt=B&m,gt=w.length,Pt=T.length;if(gt!=Pt&&!(rt&&Pt>gt))return!1;var Sr=Me.get(w),Lr=Me.get(T);if(Sr&&Lr)return Sr==T&&Lr==w;var Gr=-1,Gn=!0,vi=B&x?new F:t;for(Me.set(w,T),Me.set(T,w);++Gr<gt;){var Yi=w[Gr],Oa=T[Gr];if(Y)var Zi=rt?Y(Oa,Yi,Gr,T,w,Me):Y(Yi,Oa,Gr,w,T,Me);if(Zi!==t){if(Zi)continue;Gn=!1;break}if(vi){if(!og(T,function(Ja,yo){if(!ud(vi,yo)&&(Yi===Ja||le(Yi,Ja,B,Y,Me)))return vi.push(yo)})){Gn=!1;break}}else if(!(Yi===Oa||le(Yi,Oa,B,Y,Me))){Gn=!1;break}}return Me.delete(w),Me.delete(T),Gn}function j1(w,T,B,Y,le,Me,rt){switch(B){case $n:if(w.byteLength!=T.byteLength||w.byteOffset!=T.byteOffset)return!1;w=w.buffer,T=T.buffer;case hn:return!(w.byteLength!=T.byteLength||!Me(new Cf(w),new Cf(T)));case zn:case Zt:case Si:return ao(+w,+T);case mn:return w.name==T.name&&w.message==T.message;case Va:case Os:return w==T+"";case On:var gt=uv;case to:var Pt=Y&m;if(gt||(gt=jf),w.size!=T.size&&!Pt)return!1;var Sr=rt.get(w);if(Sr)return Sr==T;Y|=x,rt.set(w,T);var Lr=H1(gt(w),gt(T),Y,le,Me,rt);return rt.delete(w),Lr;case Ro:if(Il)return Il.call(w)==Il.call(T)}return!1}function yw(w,T,B,Y,le,Me){var rt=B&m,gt=j_(w),Pt=gt.length,Sr=j_(T),Lr=Sr.length;if(Pt!=Lr&&!rt)return!1;for(var Gr=Pt;Gr--;){var Gn=gt[Gr];if(!(rt?Gn in T:Fa.call(T,Gn)))return!1}var vi=Me.get(w),Yi=Me.get(T);if(vi&&Yi)return vi==T&&Yi==w;var Oa=!0;Me.set(w,T),Me.set(T,w);for(var Zi=rt;++Gr<Pt;){Gn=gt[Gr];var Ja=w[Gn],yo=T[Gn];if(Y)var zp=rt?Y(yo,Ja,Gn,T,w,Me):Y(Ja,yo,Gn,w,T,Me);if(!(zp===t?Ja===yo||le(Ja,yo,B,Y,Me):zp)){Oa=!1;break}Zi||(Zi=Gn=="constructor")}if(Oa&&!Zi){var rh=w.constructor,$p=T.constructor;rh!=$p&&"constructor"in w&&"constructor"in T&&!(typeof rh=="function"&&rh instanceof rh&&typeof $p=="function"&&$p instanceof $p)&&(Oa=!1)}return Me.delete(w),Me.delete(T),Oa}function Vh(w){return ii(jr(w,t,Gi),w+"")}function j_(w){return Du(w,vl,Z)}function W_(w){return Du(w,rl,Se)}var Lv=Ys?function(w){return Ys.get(w)}:QP;function Ag(w){for(var T=w.name+"",B=Ou[T],Y=Fa.call(Ou,T)?B.length:0;Y--;){var le=B[Y],Me=le.func;if(Me==null||Me==w)return le.name}return T}function bd(w){var T=Fa.call(be,"placeholder")?be:w;return T.placeholder}function yi(){var w=be.iteratee||qP;return w=w===qP?Zs:w,arguments.length?w(arguments[0],arguments[1]):w}function ja(w,T){var B=w.__data__;return Er(T)?B[typeof T=="string"?"string":"hash"]:B.map}function Yy(w){for(var T=vl(w),B=T.length;B--;){var Y=T[B],le=w[Y];T[B]=[Y,le,or(le)]}return T}function Rl(w,T){var B=sg(w,T);return Sf(B)?B:t}function Tg(w){var T=Fa.call(w,su),B=w[su];try{w[su]=t;var Y=!0}catch{}var le=Rh.call(w);return Y&&(T?w[su]=B:delete w[su]),le}var Z=Lp?function(w){return w==null?[]:(w=Un(w),_f(Lp(w),function(T){return Yr.call(w,T)}))}:JP,Se=Lp?function(w){for(var T=[];w;)$c(T,Z(w)),w=wu(w);return T}:JP,Ve=Ha;(Xs&&Ve(new Xs(new ArrayBuffer(1)))!=$n||vs&&Ve(new vs)!=On||Dh&&Ve(Dh.resolve())!=Ua||Pn&&Ve(new Pn)!=to||_n&&Ve(new _n)!=Qt)&&(Ve=function(w){var T=Ha(w),B=T==Ai?w.constructor:t,Y=B?Ka(B):"";if(Y)switch(Y){case uu:return $n;case Wc:return On;case hg:return Ua;case Ll:return to;case La:return Qt}return T});function Rt(w,T,B){for(var Y=-1,le=B.length;++Y<le;){var Me=B[Y],rt=Me.size;switch(Me.type){case"drop":w+=rt;break;case"dropRight":T-=rt;break;case"take":T=Bo(T,w+rt);break;case"takeRight":w=ti(w,T-rt);break}}return{start:w,end:T}}function tr(w){var T=w.match(cr);return T?T[1].split(fr):[]}function kt(w,T,B){T=Lf(T,w);for(var Y=-1,le=T.length,Me=!1;++Y<le;){var rt=_i(T[Y]);if(!(Me=w!=null&&B(w,rt)))break;w=w[rt]}return Me||++Y!=le?Me:(le=w==null?0:w.length,!!le&&Wh(le)&&dr(rt,le)&&(Ci(w)||bc(w)))}function Yt(w){var T=w.length,B=new w.constructor(T);return T&&typeof w[0]=="string"&&Fa.call(w,"index")&&(B.index=w.index,B.input=w.input),B}function sr(w){return typeof w.constructor=="function"&&!Zr(w)?Fu(wu(w)):{}}function mr(w,T,B){var Y=w.constructor;switch(T){case hn:return Dp(w);case zn:case Zt:return new Y(+w);case $n:return Wy(w,B);case Ta:case Qn:case ci:case Wn:case Ti:case Li:case Oo:case Fo:case xl:return md(w,B);case On:return new Y;case Si:case Os:return new Y(w);case Va:return _g(w);case to:return new Y;case Ro:return Xy(w)}}function Cr(w,T){var B=T.length;if(!B)return w;var Y=B-1;return T[Y]=(B>1?"& ":"")+T[Y],T=T.join(B>2?", ":" "),w.replace(wt,`{
/* [wrapped with `+T+`] */
`)}function wr(w){return Ci(w)||bc(w)||!!(Cs&&w&&w[Cs])}function dr(w,T){var B=typeof w;return T=T==null?We:T,!!T&&(B=="number"||B!="symbol"&&Tr.test(w))&&w>-1&&w%1==0&&w<T}function xr(w,T,B){if(!ms(B))return!1;var Y=typeof T;return(Y=="number"?Ra(B)&&dr(T,B.length):Y=="string"&&T in B)?ao(B[T],w):!1}function vr(w,T){if(Ci(w))return!1;var B=typeof w;return B=="number"||B=="symbol"||B=="boolean"||w==null||Dl(w)?!0:Ce.test(w)||!fe.test(w)||T!=null&&w in Un(T)}function Er(w){var T=typeof w;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?w!=="__proto__":w===null}function _t(w){var T=Ag(w),B=be[T];if(typeof B!="function"||!(T in zi.prototype))return!1;if(w===B)return!0;var Y=Lv(B);return!!Y&&w===Y[0]}function Gt(w){return!!Do&&Do in w}var _r=fg?jh:eR;function Zr(w){var T=w&&w.constructor,B=typeof T=="function"&&T.prototype||hd;return w===B}function or(w){return w===w&&!ms(w)}function Fr(w,T){return function(B){return B==null?!1:B[w]===T&&(T!==t||w in Un(B))}}function Hr(w){var T=Ko(w,function(Y){return B.size===l&&B.clear(),Y}),B=T.cache;return T}function xn(w,T){var B=w[1],Y=T[1],le=B|Y,Me=le<(E|A|j),rt=Y==j&&B==k||Y==j&&B==H&&w[7].length<=T[8]||Y==(j|H)&&T[7].length<=T[8]&&B==k;if(!(Me||rt))return w;Y&E&&(w[2]=T[2],le|=B&E?0:L);var gt=T[3];if(gt){var Pt=w[3];w[3]=Pt?xg(Pt,gt,T[4]):gt,w[4]=Pt?fl(w[3],f):T[4]}return gt=T[5],gt&&(Pt=w[5],w[5]=Pt?bg(Pt,gt,T[6]):gt,w[6]=Pt?fl(w[5],f):T[6]),gt=T[7],gt&&(w[7]=gt),Y&j&&(w[8]=w[8]==null?T[8]:Bo(w[8],T[8])),w[9]==null&&(w[9]=T[9]),w[0]=T[0],w[1]=le,w}function Jt(w){var T=[];if(w!=null)for(var B in Un(w))T.push(B);return T}function qt(w){return Rh.call(w)}function jr(w,T,B){return T=ti(T===t?w.length-1:T,0),function(){for(var Y=arguments,le=-1,Me=ti(Y.length-T,0),rt=Xt(Me);++le<Me;)rt[le]=Y[T+le];le=-1;for(var gt=Xt(T+1);++le<T;)gt[le]=Y[le];return gt[T]=B(rt),hs(w,this,gt)}}function Ur(w,T){return T.length<2?w:no(w,Mf(T,0,-1))}function br(w,T){for(var B=w.length,Y=Bo(T.length,B),le=Pl(w);Y--;){var Me=T[Y];w[Y]=dr(Me,B)?le[Me]:t}return w}function qr(w,T){if(!(T==="constructor"&&typeof w[T]=="function")&&T!="__proto__")return w[T]}var Qr=ln(gg),li=Tl||function(w,T){return Ws.setTimeout(w,T)},ii=ln(mg);function sn(w,T,B){var Y=T+"";return ii(w,Cr(Y,gs(tr(Y),B)))}function ln(w){var T=0,B=0;return function(){var Y=Yl(),le=te-(Y-B);if(B=Y,le>0){if(++T>=Q)return arguments[0]}else T=0;return w.apply(t,arguments)}}function Xn(w,T){var B=-1,Y=w.length,le=Y-1;for(T=T===t?Y:T;++B<T;){var Me=gd(B,le),rt=w[Me];w[Me]=w[B],w[B]=rt}return w.length=T,w}var fi=Hr(function(w){var T=[];return w.charCodeAt(0)===46&&T.push(""),w.replace(Ne,function(B,Y,le,Me){T.push(le?Me.replace(Rr,"$1"):Y||B)}),T});function _i(w){if(typeof w=="string"||Dl(w))return w;var T=w+"";return T=="0"&&1/w==-Re?"-0":T}function Ka(w){if(w!=null){try{return Ph.call(w)}catch{}try{return w+""}catch{}}return""}function gs(w,T){return ps(It,function(B){var Y="_."+B[0];T&B[1]&&!zc(w,Y)&&w.push(Y)}),w.sort()}function Vi(w){if(w instanceof zi)return w.clone();var T=new Su(w.__wrapped__,w.__chain__);return T.__actions__=Pl(w.__actions__),T.__index__=w.__index__,T.__values__=w.__values__,T}function Au(w,T,B){(B?xr(w,T,B):T===t)?T=1:T=ti(fa(T),0);var Y=w==null?0:w.length;if(!Y||T<1)return[];for(var le=0,Me=0,rt=Xt(fc(Y/T));le<Y;)rt[Me++]=Mf(w,le,le+=T);return rt}function Co(w){for(var T=-1,B=w==null?0:w.length,Y=0,le=[];++T<B;){var Me=w[T];Me&&(le[Y++]=Me)}return le}function qs(){var w=arguments.length;if(!w)return[];for(var T=Xt(w-1),B=arguments[0],Y=w;Y--;)T[Y-1]=arguments[Y];return $c(Ci(B)?Pl(B):[B],Tn(T,1))}var zs=_a(function(w,T){return Uo(w)?on(w,Tn(T,1,Uo,!0)):[]}),Tu=_a(function(w,T){var B=Ye(T);return Uo(B)&&(B=t),Uo(w)?on(w,Tn(T,1,Uo,!0),yi(B,2)):[]}),Mu=_a(function(w,T){var B=Ye(T);return Uo(B)&&(B=t),Uo(w)?on(w,Tn(T,1,Uo,!0),t,B):[]});function Nu(w,T,B){var Y=w==null?0:w.length;return Y?(T=B||T===t?1:fa(T),Mf(w,T<0?0:T,Y)):[]}function cs(w,T,B){var Y=w==null?0:w.length;return Y?(T=B||T===t?1:fa(T),T=Y-T,Mf(w,0,T<0?0:T)):[]}function ki(w,T){return w&&w.length?wv(w,yi(T,3),!0,!0):[]}function Ks(w,T){return w&&w.length?wv(w,yi(T,3),!0):[]}function Ea(w,T,B,Y){var le=w==null?0:w.length;return le?(B&&typeof B!="number"&&xr(w,T,B)&&(B=0,Y=le),wi(w,T,B,Y)):[]}function Ts(w,T,B){var Y=w==null?0:w.length;if(!Y)return-1;var le=B==null?0:fa(B);return le<0&&(le=ti(Y+le,0)),ov(w,yi(T,3),le)}function Kn(w,T,B){var Y=w==null?0:w.length;if(!Y)return-1;var le=Y-1;return B!==t&&(le=fa(B),le=B<0?ti(Y+le,0):Bo(le,Y-1)),ov(w,yi(T,3),le,!0)}function Gi(w){var T=w==null?0:w.length;return T?Tn(w,1):[]}function io(w){var T=w==null?0:w.length;return T?Tn(w,Re):[]}function Qs(w,T){var B=w==null?0:w.length;return B?(T=T===t?1:fa(T),Tn(w,T)):[]}function _c(w){for(var T=-1,B=w==null?0:w.length,Y={};++T<B;){var le=w[T];Y[le[0]]=le[1]}return Y}function Fe(w){return w&&w.length?w[0]:t}function Ft(w,T,B){var Y=w==null?0:w.length;if(!Y)return-1;var le=B==null?0:fa(B);return le<0&&(le=ti(Y+le,0)),Ku(w,T,le)}function Ct(w){var T=w==null?0:w.length;return T?Mf(w,0,-1):[]}var vn=_a(function(w){var T=ls(w,Uh);return T.length&&T[0]===w[0]?qf(T):[]}),Wi=_a(function(w){var T=Ye(w),B=ls(w,Uh);return T===Ye(B)?T=t:B.pop(),B.length&&B[0]===w[0]?qf(B,yi(T,2)):[]}),ke=_a(function(w){var T=Ye(w),B=ls(w,Uh);return T=typeof T=="function"?T:t,T&&B.pop(),B.length&&B[0]===w[0]?qf(B,t,T):[]});function ge(w,T){return w==null?"":Xl.call(w,T)}function Ye(w){var T=w==null?0:w.length;return T?w[T-1]:t}function yt(w,T,B){var Y=w==null?0:w.length;if(!Y)return-1;var le=Y;return B!==t&&(le=fa(B),le=le<0?ti(Y+le,0):Bo(le,Y-1)),T===T?cv(w,T,le):ov(w,Uc,le,!0)}function Ot(w,T){return w&&w.length?$h(w,fa(T)):t}var at=_a(Je);function Je(w,T){return w&&w.length&&T&&T.length?Sm(w,T):w}function ht(w,T,B){return w&&w.length&&T&&T.length?Sm(w,T,yi(B,2)):w}function ye(w,T,B){return w&&w.length&&T&&T.length?Sm(w,T,t,B):w}var qe=Vh(function(w,T){var B=w==null?0:w.length,Y=Ir(w,T);return Hy(w,ls(T,function(le){return dr(le,B)?+le:le}).sort(yd)),Y});function Pe(w,T){var B=[];if(!(w&&w.length))return B;var Y=-1,le=[],Me=w.length;for(T=yi(T,3);++Y<Me;){var rt=w[Y];T(rt,Y,w)&&(B.push(rt),le.push(Y))}return Hy(w,le),B}function vt(w){return w==null?w:Fh.call(w)}function St(w,T,B){var Y=w==null?0:w.length;return Y?(B&&typeof B!="number"&&xr(w,T,B)?(T=0,B=Y):(T=T==null?0:fa(T),B=B===t?Y:fa(B)),Mf(w,T,B)):[]}function ur(w,T){return Mm(w,T)}function Nr(w,T,B){return F_(w,T,yi(B,2))}function zr(w,T){var B=w==null?0:w.length;if(B){var Y=Mm(w,T);if(Y<B&&ao(w[Y],T))return Y}return-1}function un(w,T){return Mm(w,T,!0)}function Dr(w,T,B){return F_(w,T,yi(B,2),!0)}function Mn(w,T){var B=w==null?0:w.length;if(B){var Y=Mm(w,T,!0)-1;if(ao(w[Y],T))return Y}return-1}function pn(w){return w&&w.length?U1(w):[]}function bn(w,T){return w&&w.length?U1(w,yi(T,2)):[]}function Cn(w){var T=w==null?0:w.length;return T?Mf(w,1,T):[]}function En(w,T,B){return w&&w.length?(T=B||T===t?1:fa(T),Mf(w,0,T<0?0:T)):[]}function ni(w,T,B){var Y=w==null?0:w.length;return Y?(T=B||T===t?1:fa(T),T=Y-T,Mf(w,T<0?0:T,Y)):[]}function Pa(w,T){return w&&w.length?wv(w,yi(T,3),!1,!0):[]}function cu(w,T){return w&&w.length?wv(w,yi(T,3)):[]}var xc=_a(function(w){return Jc(Tn(w,1,Uo,!0))}),Gh=_a(function(w){var T=Ye(w);return Uo(T)&&(T=t),Jc(Tn(w,1,Uo,!0),yi(T,2))}),go=_a(function(w){var T=Ye(w);return T=typeof T=="function"?T:t,Jc(Tn(w,1,Uo,!0),t,T)});function ta(w){return w&&w.length?Jc(w):[]}function eh(w,T){return w&&w.length?Jc(w,yi(T,2)):[]}function rf(w,T){return T=typeof T=="function"?T:t,w&&w.length?Jc(w,t,T):[]}function Pm(w){if(!(w&&w.length))return[];var T=0;return w=_f(w,function(B){if(Uo(B))return T=ti(B.length,T),!0}),Lh(T,function(B){return ls(w,Vc(B))})}function nf(w,T){if(!(w&&w.length))return[];var B=Pm(w);return T==null?B:ls(B,function(Y){return hs(T,t,Y)})}var X_=_a(function(w,T){return Uo(w)?on(w,T):[]}),_w=_a(function(w){return yg(_f(w,Uo))}),Rm=_a(function(w){var T=Ye(w);return Uo(T)&&(T=t),yg(_f(w,Uo),yi(T,2))}),Om=_a(function(w){var T=Ye(w);return T=typeof T=="function"?T:t,yg(_f(w,Uo),t,T)}),rA=_a(Pm);function fu(w,T){return Cv(w||[],T||[],xt)}function Y_(w,T){return Cv(w||[],T||[],Kc)}var Iv=_a(function(w){var T=w.length,B=T>1?w[T-1]:t;return B=typeof B=="function"?(w.pop(),B):t,nf(w,B)});function Z_(w){var T=be(w);return T.__chain__=!0,T}function W1(w,T){return T(w),w}function Zy(w,T){return T(w)}var qy=Vh(function(w){var T=w.length,B=T?w[0]:0,Y=this.__wrapped__,le=function(Me){return Ir(Me,w)};return T>1||this.__actions__.length||!(Y instanceof zi)||!dr(B)?this.thru(le):(Y=Y.slice(B,+B+(T?1:0)),Y.__actions__.push({func:Zy,args:[le],thisArg:t}),new Su(Y,this.__chain__).thru(function(Me){return T&&!Me.length&&Me.push(t),Me}))});function kv(){return Z_(this)}function nA(){return new Su(this.value(),this.__chain__)}function iA(){this.__values__===t&&(this.__values__=Q1(this.value()));var w=this.__index__>=this.__values__.length,T=w?t:this.__values__[this.__index__++];return{done:w,value:T}}function NP(){return this}function zu(w){for(var T,B=this;B instanceof Eu;){var Y=Vi(B);Y.__index__=0,Y.__values__=t,T?le.__wrapped__=Y:T=Y;var le=Y;B=B.__wrapped__}return le.__wrapped__=w,T}function Mg(){var w=this.__wrapped__;if(w instanceof zi){var T=w;return this.__actions__.length&&(T=new zi(this)),T=T.reverse(),T.__actions__.push({func:Zy,args:[vt],thisArg:t}),new Su(T,this.__chain__)}return this.thru(vt)}function aA(){return B_(this.__wrapped__,this.__actions__)}var c=wg(function(w,T,B){Fa.call(w,B)?++w[B]:yr(w,B,1)});function d(w,T,B){var Y=Ci(w)?Sl:si;return B&&xr(w,T,B)&&(T=t),Y(w,yi(T,3))}function g(w,T){var B=Ci(w)?_f:ri;return B(w,yi(T,3))}var C=Mv(Ts),M=Mv(Kn);function I(w,T){return Tn(De(w,T),1)}function O(w,T){return Tn(De(w,T),Re)}function z(w,T,B){return B=B===t?1:fa(B),Tn(De(w,T),B)}function G(w,T){var B=Ci(w)?ps:qn;return B(w,yi(T,3))}function q(w,T){var B=Ci(w)?Ah:di;return B(w,yi(T,3))}var re=wg(function(w,T,B){Fa.call(w,B)?w[B].push(T):yr(w,B,[T])});function oe(w,T,B,Y){w=Ra(w)?w:Um(w),B=B&&!Y?fa(B):0;var le=w.length;return B<0&&(B=ti(le+B,0)),Nm(w)?B<=le&&w.indexOf(T,B)>-1:!!le&&Ku(w,T,B)>-1}var ce=_a(function(w,T,B){var Y=-1,le=typeof T=="function",Me=Ra(w)?Xt(w.length):[];return qn(w,function(rt){Me[++Y]=le?hs(T,rt,B):Kl(rt,T,B)}),Me}),pe=wg(function(w,T,B){yr(w,B,T)});function De(w,T){var B=Ci(w)?ls:vd;return B(w,yi(T,3))}function $e(w,T,B,Y){return w==null?[]:(Ci(T)||(T=T==null?[]:[T]),B=Y?t:B,Ci(B)||(B=B==null?[]:[B]),gc(w,T,B))}var tt=wg(function(w,T,B){w[B?0:1].push(T)},function(){return[[],[]]});function Ze(w,T,B){var Y=Ci(w)?ag:Sp,le=arguments.length<3;return Y(w,yi(T,4),B,le,qn)}function mt(w,T,B){var Y=Ci(w)?ym:Sp,le=arguments.length<3;return Y(w,yi(T,4),B,le,di)}function At(w,T){var B=Ci(w)?_f:ri;return B(w,zo(yi(T,3)))}function Nt(w){var T=Ci(w)?Ke:Tm;return T(w)}function Vt(w,T,B){(B?xr(w,T,B):T===t)?T=1:T=fa(T);var Y=Ci(w)?Oe:R_;return Y(w,T)}function ir(w){var T=Ci(w)?Qe:O_;return T(w)}function Mr(w){if(w==null)return 0;if(Ra(w))return Nm(w)?Gc(w):w.length;var T=Ve(w);return T==On||T==to?w.size:Af(w).length}function Wr(w,T,B){var Y=Ci(w)?og:mw;return B&&xr(w,T,B)&&(T=t),Y(w,yi(T,3))}var Vn=_a(function(w,T){if(w==null)return[];var B=T.length;return B>1&&xr(w,T[0],T[1])?T=[]:B>2&&xr(T[0],T[1],T[2])&&(T=[T[0]]),gc(w,Tn(T,1),[])}),fn=gv||function(){return Ws.Date.now()};function Yn(w,T){if(typeof T!="function")throw new el(o);return w=fa(w),function(){if(--w<1)return T.apply(this,arguments)}}function gn(w,T,B){return T=B?t:T,T=w&&T==null?w.length:T,Jf(w,j,t,t,t,t,T)}function Fi(w,T){var B;if(typeof T!="function")throw new el(o);return w=fa(w),function(){return--w>0&&(B=T.apply(this,arguments)),w<=1&&(T=t),B}}var ai=_a(function(w,T,B){var Y=E;if(B.length){var le=fl(B,bd(ai));Y|=D}return Jf(w,Y,T,B,le)}),In=_a(function(w,T,B){var Y=E|A;if(B.length){var le=fl(B,bd(In));Y|=D}return Jf(T,Y,w,B,le)});function Xi(w,T,B){T=B?t:T;var Y=Jf(w,k,t,t,t,t,t,T);return Y.placeholder=Xi.placeholder,Y}function Mi(w,T,B){T=B?t:T;var Y=Jf(w,R,t,t,t,t,t,T);return Y.placeholder=Mi.placeholder,Y}function ca(w,T,B){var Y,le,Me,rt,gt,Pt,Sr=0,Lr=!1,Gr=!1,Gn=!0;if(typeof w!="function")throw new el(o);T=wc(T)||0,ms(B)&&(Lr=!!B.leading,Gr="maxWait"in B,Me=Gr?ti(wc(B.maxWait)||0,T):Me,Gn="trailing"in B?!!B.trailing:Gn);function vi(gl){var Dv=Y,Vm=le;return Y=le=t,Sr=gl,rt=w.apply(Vm,Dv),rt}function Yi(gl){return Sr=gl,gt=li(Ja,T),Lr?vi(gl):rt}function Oa(gl){var Dv=gl-Pt,Vm=gl-Sr,f7=T-Dv;return Gr?Bo(f7,Me-Vm):f7}function Zi(gl){var Dv=gl-Pt,Vm=gl-Sr;return Pt===t||Dv>=T||Dv<0||Gr&&Vm>=Me}function Ja(){var gl=fn();if(Zi(gl))return yo(gl);gt=li(Ja,Oa(gl))}function yo(gl){return gt=t,Gn&&Y?vi(gl):(Y=le=t,rt)}function zp(){gt!==t&&Av(gt),Sr=0,Y=Pt=le=gt=t}function rh(){return gt===t?rt:yo(fn())}function $p(){var gl=fn(),Dv=Zi(gl);if(Y=arguments,le=this,Pt=gl,Dv){if(gt===t)return Yi(Pt);if(Gr)return Av(gt),gt=li(Ja,T),vi(Pt)}return gt===t&&(gt=li(Ja,T)),rt}return $p.cancel=zp,$p.flush=rh,$p}var Zn=_a(function(w,T){return sa(w,1,T)}),Ia=_a(function(w,T,B){return sa(w,wc(T)||0,B)});function qo(w){return Jf(w,ee)}function Ko(w,T){if(typeof w!="function"||T!=null&&typeof T!="function")throw new el(o);var B=function(){var Y=arguments,le=T?T.apply(this,Y):Y[0],Me=B.cache;if(Me.has(le))return Me.get(le);var rt=w.apply(this,Y);return B.cache=Me.set(le,rt)||Me,rt};return B.cache=new(Ko.Cache||pc),B}Ko.Cache=pc;function zo(w){if(typeof w!="function")throw new el(o);return function(){var T=arguments;switch(T.length){case 0:return!w.call(this);case 1:return!w.call(this,T[0]);case 2:return!w.call(this,T[0],T[1]);case 3:return!w.call(this,T[0],T[1],T[2])}return!w.apply(this,T)}}function Qo(w){return Fi(2,w)}var Ms=Sv(function(w,T){T=T.length==1&&Ci(T[0])?ls(T[0],Al(yi())):ls(Tn(T,1),Al(yi()));var B=T.length;return _a(function(Y){for(var le=-1,Me=Bo(Y.length,B);++le<Me;)Y[le]=T[le].call(this,Y[le]);return hs(w,this,Y)})}),Js=_a(function(w,T){var B=fl(T,bd(Js));return Jf(w,D,t,T,B)}),hu=_a(function(w,T){var B=fl(T,bd(hu));return Jf(w,$,t,T,B)}),Ol=Vh(function(w,T){return Jf(w,H,t,t,t,T)});function $u(w,T){if(typeof w!="function")throw new el(o);return T=T===t?T:fa(T),_a(w,T)}function Fl(w,T){if(typeof w!="function")throw new el(o);return T=T==null?0:ti(fa(T),0),_a(function(B){var Y=B[T],le=ef(B,0,T);return Y&&$c(le,Y),hs(w,this,le)})}function $s(w,T,B){var Y=!0,le=!0;if(typeof w!="function")throw new el(o);return ms(B)&&(Y="leading"in B?!!B.leading:Y,le="trailing"in B?!!B.trailing:le),ca(w,T,{leading:Y,maxWait:T,trailing:le})}function Uu(w){return gn(w,1)}function na(w,T){return Js(Ev(T),w)}function mo(){if(!arguments.length)return[];var w=arguments[0];return Ci(w)?w:[w]}function Qa(w){return An(w,v)}function xa(w,T){return T=typeof T=="function"?T:t,An(w,v,T)}function rc(w){return An(w,h|v)}function pl(w,T){return T=typeof T=="function"?T:t,An(w,h|v,T)}function $o(w,T){return T==null||Dn(w,T,vl(T))}function ao(w,T){return w===T||w!==w&&T!==T}var dl=km(Xc),ka=km(function(w,T){return w>=T}),bc=Kf(function(){return arguments}())?Kf:function(w){return ys(w)&&Fa.call(w,"callee")&&!Yr.call(w,"callee")},Ci=Xt.isArray,wd=mm?Al(mm):Op;function Ra(w){return w!=null&&Wh(w.length)&&!jh(w)}function Uo(w){return ys(w)&&Ra(w)}function Hh(w){return w===!0||w===!1||ys(w)&&Ha(w)==zn}var th=yv||eR,Fm=ou?Al(ou):Yc;function Ky(w){return ys(w)&&w.nodeType===1&&!Ov(w)}function Pv(w){if(w==null)return!0;if(Ra(w)&&(Ci(w)||typeof w=="string"||typeof w.splice=="function"||th(w)||Cd(w)||bc(w)))return!w.length;var T=Ve(w);if(T==On||T==to)return!w.size;if(Zr(w))return!Af(w).length;for(var B in w)if(Fa.call(w,B))return!1;return!0}function Qy(w,T){return Zc(w,T)}function X1(w,T,B){B=typeof B=="function"?B:t;var Y=B?B(w,T):t;return Y===t?Zc(w,T,t,B):!!Y}function Lg(w){if(!ys(w))return!1;var T=Ha(w);return T==mn||T==nn||typeof w.message=="string"&&typeof w.name=="string"&&!Ov(w)}function q_(w){return typeof w=="number"&&_v(w)}function jh(w){if(!ms(w))return!1;var T=Ha(w);return T==zt||T==Vr||T==wn||T==va}function K_(w){return typeof w=="number"&&w==fa(w)}function Wh(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=We}function ms(w){var T=typeof w;return w!=null&&(T=="object"||T=="function")}function ys(w){return w!=null&&typeof w=="object"}var Rv=ig?Al(ig):Ns;function Jy(w,T){return w===T||Ql(w,T,Yy(T))}function Y1(w,T,B){return B=typeof B=="function"?B:t,Ql(w,T,Yy(T),B)}function Z1(w){return e0(w)&&w!=+w}function Q_(w){if(_r(w))throw new Ii(a);return Sf(w)}function J_(w){return w===null}function q1(w){return w==null}function e0(w){return typeof w=="number"||ys(w)&&Ha(w)==Si}function Ov(w){if(!ys(w)||Ha(w)!=Ai)return!1;var T=wu(w);if(T===null)return!0;var B=Fa.call(T,"constructor")&&T.constructor;return typeof B=="function"&&B instanceof B&&Ph.call(B)==pv}var Dm=qu?Al(qu):zh;function K1(w){return K_(w)&&w>=-We&&w<=We}var Bm=Vf?Al(Vf):ma;function Nm(w){return typeof w=="string"||!Ci(w)&&ys(w)&&Ha(w)==Os}function Dl(w){return typeof w=="symbol"||ys(w)&&Ha(w)==Ro}var Cd=Eh?Al(Eh):hl;function zm(w){return w===t}function ex(w){return ys(w)&&Ve(w)==Qt}function t0(w){return ys(w)&&Ha(w)==gr}var xw=km(kl),oA=km(function(w,T){return w<=T});function Q1(w){if(!w)return[];if(Ra(w))return Nm(w)?Qu(w):Pl(w);if(Oh&&w[Oh])return xm(w[Oh]());var T=Ve(w),B=T==On?uv:T==to?jf:Um;return B(w)}function Ed(w){if(!w)return w===0?w:0;if(w=wc(w),w===Re||w===-Re){var T=w<0?-1:1;return T*je}return w===w?w:0}function fa(w){var T=Ed(w),B=T%1;return T===T?B?T-B:T:0}function sA(w){return w?Kr(fa(w),0,dt):0}function wc(w){if(typeof w=="number")return w;if(Dl(w))return lt;if(ms(w)){var T=typeof w.valueOf=="function"?w.valueOf():w;w=ms(T)?T+"":T}if(typeof w!="string")return w===0?w:+w;w=Ap(w);var B=Br.test(w);return B||Ln.test(w)?iv(w.slice(2),B?2:8):an.test(w)?lt:+w}function Ls(w){return mc(w,rl(w))}function Np(w){return w?Kr(fa(w),-We,We):w===0?w:0}function Vo(w){return w==null?"":Qc(w)}var Ig=Cg(function(w,T){if(Zr(T)||Ra(T)){mc(T,vl(T),w);return}for(var B in T)Fa.call(T,B)&&xt(w,B,T[B])}),J1=Cg(function(w,T){mc(T,rl(T),w)}),tx=Cg(function(w,T,B,Y){mc(T,rl(T),w,Y)}),eb=Cg(function(w,T,B,Y){mc(T,vl(T),w,Y)}),Sd=Vh(Ir);function tb(w,T){var B=Fu(w);return T==null?B:Wt(B,T)}var rx=_a(function(w,T){w=Un(w);var B=-1,Y=T.length,le=Y>2?T[2]:t;for(le&&xr(T[0],T[1],le)&&(Y=1);++B<Y;)for(var Me=T[B],rt=rl(Me),gt=-1,Pt=rt.length;++gt<Pt;){var Sr=rt[gt],Lr=w[Sr];(Lr===t||ao(Lr,hd[Sr])&&!Fa.call(w,Sr))&&(w[Sr]=Me[Sr])}return w}),rb=_a(function(w){return w.push(t,V1),hs($m,t,w)});function nb(w,T){return Gf(w,yi(T,3),Mo)}function bw(w,T){return Gf(w,yi(T,3),Ss)}function uA(w,T){return w==null?w:Zo(w,yi(T,3),rl)}function nx(w,T){return w==null?w:No(w,yi(T,3),rl)}function lA(w,T){return w&&Mo(w,yi(T,3))}function cA(w,T){return w&&Ss(w,yi(T,3))}function fA(w){return w==null?[]:vo(w,vl(w))}function hA(w){return w==null?[]:vo(w,rl(w))}function ib(w,T,B){var Y=w==null?t:no(w,T);return Y===t?B:Y}function Pf(w,T){return w!=null&&kt(w,T,tl)}function r0(w,T){return w!=null&&kt(w,T,dc)}var pA=V_(function(w,T,B){T!=null&&typeof T.toString!="function"&&(T=Rh.call(T)),w[T]=B},ZP(Xh)),Ad=V_(function(w,T,B){T!=null&&typeof T.toString!="function"&&(T=Rh.call(T)),Fa.call(w,T)?w[T].push(B):w[T]=[B]},yi),zP=_a(Kl);function vl(w){return Ra(w)?Be(w):Af(w)}function rl(w){return Ra(w)?Be(w,!0):pg(w)}function n0(w,T){var B={};return T=yi(T,3),Mo(w,function(Y,le,Me){yr(B,T(Y,le,Me),Y)}),B}function i0(w,T){var B={};return T=yi(T,3),Mo(w,function(Y,le,Me){yr(B,le,T(Y,le,Me))}),B}var a0=Cg(function(w,T,B){Jl(w,T,B)}),$m=Cg(function(w,T,B,Y){Jl(w,T,B,Y)}),dA=Vh(function(w,T){var B={};if(w==null)return B;var Y=!1;T=ls(T,function(Me){return Me=Lf(Me,w),Y||(Y=Me.length>1),Me}),mc(w,W_(w),B),Y&&(B=An(B,h|p|v,G1));for(var le=T.length;le--;)D_(B,T[le]);return B});function vA(w,T){return ww(w,zo(yi(T)))}var gA=Vh(function(w,T){return w==null?{}:Bu(w,T)});function ww(w,T){if(w==null)return{};var B=ls(W_(w),function(Y){return[Y]});return T=yi(T),Em(w,B,function(Y,le){return T(Y,le[0])})}function Cw(w,T,B){T=Lf(T,w);var Y=-1,le=T.length;for(le||(le=1,w=t);++Y<le;){var Me=w==null?t:w[_i(T[Y])];Me===t&&(Y=le,Me=B),w=jh(Me)?Me.call(w):Me}return w}function Ew(w,T,B){return w==null?w:Kc(w,T,B)}function Fv(w,T,B,Y){return Y=typeof Y=="function"?Y:t,w==null?w:Kc(w,T,B,Y)}var Sw=tc(vl),ab=tc(rl);function Aw(w,T,B){var Y=Ci(w),le=Y||th(w)||Cd(w);if(T=yi(T,4),B==null){var Me=w&&w.constructor;le?B=Y?new Me:[]:ms(w)?B=jh(Me)?Fu(wu(w)):{}:B={}}return(le?ps:Mo)(w,function(rt,gt,Pt){return T(B,rt,gt,Pt)}),B}function mA(w,T){return w==null?!0:D_(w,T)}function Tw(w,T,B){return w==null?w:As(w,T,Ev(B))}function yA(w,T,B,Y){return Y=typeof Y=="function"?Y:t,w==null?w:As(w,T,Ev(B),Y)}function Um(w){return w==null?[]:_m(w,vl(w))}function Mw(w){return w==null?[]:_m(w,rl(w))}function _A(w,T,B){return B===t&&(B=T,T=t),B!==t&&(B=wc(B),B=B===B?B:0),T!==t&&(T=wc(T),T=T===T?T:0),Kr(wc(w),T,B)}function ix(w,T,B){return T=Ed(T),B===t?(B=T,T=0):B=Ed(B),w=wc(w),ql(w,T,B)}function xA(w,T,B){if(B&&typeof B!="boolean"&&xr(w,T,B)&&(T=B=t),B===t&&(typeof T=="boolean"?(B=T,T=t):typeof w=="boolean"&&(B=w,w=t)),w===t&&T===t?(w=0,T=1):(w=Ed(w),T===t?(T=w,w=0):T=Ed(T)),w>T){var Y=w;w=T,T=Y}if(B||w%1||T%1){var le=jc();return Bo(w+le*(T-w+gm("1e-"+((le+"").length-1))),T)}return gd(w,T)}var ob=If(function(w,T,B){return T=T.toLowerCase(),w+(B?bA(T):T)});function bA(w){return YP(Vo(w).toLowerCase())}function Lw(w){return w=Vo(w),w&&w.replace(Sn,ld).replace(ng,"")}function $P(w,T,B){w=Vo(w),T=Qc(T);var Y=w.length;B=B===t?Y:Kr(fa(B),0,Y);var le=B;return B-=T.length,B>=0&&w.slice(B,le)==T}function UP(w){return w=Vo(w),w&&mf.test(w)?w.replace(bl,bf):w}function VP(w){return w=Vo(w),w&&pt.test(w)?w.replace(it,"\\$&"):w}var GP=If(function(w,T,B){return w+(B?"-":"")+T.toLowerCase()}),HP=If(function(w,T,B){return w+(B?" ":"")+T.toLowerCase()}),jP=$_("toLowerCase");function WP(w,T,B){w=Vo(w),T=fa(T);var Y=T?Gc(w):0;if(!T||Y>=T)return w;var le=(T-Y)/2;return Sg(mv(le),B)+w+Sg(fc(le),B)}function XP(w,T,B){w=Vo(w),T=fa(T);var Y=T?Gc(w):0;return T&&Y<T?w+Sg(T-Y,B):w}function Td(w,T,B){w=Vo(w),T=fa(T);var Y=T?Gc(w):0;return T&&Y<T?Sg(T-Y,B)+w:w}function sb(w,T,B){return B||T==null?T=0:T&&(T=+T),Cu(Vo(w).replace(_e,""),T||0)}function wA(w,T,B){return(B?xr(w,T,B):T===t)?T=1:T=fa(T),Am(Vo(w),T)}function ax(){var w=arguments,T=Vo(w[0]);return w.length<3?T:T.replace(w[1],w[2])}var CA=If(function(w,T,B){return w+(B?"_":"")+T.toLowerCase()});function tpe(w,T,B){return B&&typeof B!="number"&&xr(w,T,B)&&(T=B=t),B=B===t?dt:B>>>0,B?(w=Vo(w),w&&(typeof T=="string"||T!=null&&!Dm(T))&&(T=Qc(T),!T&&Hl(w))?ef(Qu(w),0,B):w.split(T,B)):[]}var rpe=If(function(w,T,B){return w+(B?" ":"")+YP(T)});function npe(w,T,B){return w=Vo(w),B=B==null?0:Kr(fa(B),0,w.length),T=Qc(T),w.slice(B,B+T.length)==T}function ipe(w,T,B){var Y=be.templateSettings;B&&xr(w,T,B)&&(T=t),w=Vo(w),T=tx({},T,Y,H_);var le=tx({},T.imports,Y.imports,H_),Me=vl(le),rt=_m(le,Me),gt,Pt,Sr=0,Lr=T.interpolate||pi,Gr="__p += '",Gn=qa((T.escape||pi).source+"|"+Lr.source+"|"+(Lr===ue?cn:pi).source+"|"+(T.evaluate||pi).source+"|$","g"),vi="//# sourceURL="+(Fa.call(T,"sourceURL")?(T.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++wh+"]")+`
`;w.replace(Gn,function(Zi,Ja,yo,zp,rh,$p){return yo||(yo=zp),Gr+=w.slice(Sr,$p).replace(oi,Ih),Ja&&(gt=!0,Gr+=`' +
__e(`+Ja+`) +
'`),rh&&(Pt=!0,Gr+=`';
`+rh+`;
__p += '`),yo&&(Gr+=`' +
((__t = (`+yo+`)) == null ? '' : __t) +
'`),Sr=$p+Zi.length,Zi}),Gr+=`';
`;var Yi=Fa.call(T,"variable")&&T.variable;if(!Yi)Gr=`with (obj) {
`+Gr+`
}
`;else if(pr.test(Yi))throw new Ii(s);Gr=(Pt?Gr.replace(Fc,""):Gr).replace(gf,"$1").replace(Gl,"$1;"),Gr="function("+(Yi||"obj")+`) {
`+(Yi?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(gt?", __e = _.escape":"")+(Pt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Gr+`return __p
}`;var Oa=l7(function(){return ga(Me,vi+"return "+Gr).apply(t,rt)});if(Oa.source=Gr,Lg(Oa))throw Oa;return Oa}function ape(w){return Vo(w).toLowerCase()}function ope(w){return Vo(w).toUpperCase()}function spe(w,T,B){if(w=Vo(w),w&&(B||T===t))return Ap(w);if(!w||!(T=Qc(T)))return w;var Y=Qu(w),le=Qu(T),Me=Tp(Y,le),rt=xf(Y,le)+1;return ef(Y,Me,rt).join("")}function upe(w,T,B){if(w=Vo(w),w&&(B||T===t))return w.slice(0,cd(w)+1);if(!w||!(T=Qc(T)))return w;var Y=Qu(w),le=xf(Y,Qu(T))+1;return ef(Y,0,le).join("")}function lpe(w,T,B){if(w=Vo(w),w&&(B||T===t))return w.replace(_e,"");if(!w||!(T=Qc(T)))return w;var Y=Qu(w),le=Tp(Y,Qu(T));return ef(Y,le).join("")}function cpe(w,T){var B=U,Y=W;if(ms(T)){var le="separator"in T?T.separator:le;B="length"in T?fa(T.length):B,Y="omission"in T?Qc(T.omission):Y}w=Vo(w);var Me=w.length;if(Hl(w)){var rt=Qu(w);Me=rt.length}if(B>=Me)return w;var gt=B-Gc(Y);if(gt<1)return Y;var Pt=rt?ef(rt,0,gt).join(""):w.slice(0,gt);if(le===t)return Pt+Y;if(rt&&(gt+=Pt.length-gt),Dm(le)){if(w.slice(gt).search(le)){var Sr,Lr=Pt;for(le.global||(le=qa(le.source,Vo(Ht.exec(le))+"g")),le.lastIndex=0;Sr=le.exec(Lr);)var Gr=Sr.index;Pt=Pt.slice(0,Gr===t?gt:Gr)}}else if(w.indexOf(Qc(le),gt)!=gt){var Gn=Pt.lastIndexOf(le);Gn>-1&&(Pt=Pt.slice(0,Gn))}return Pt+Y}function fpe(w){return w=Vo(w),w&&Dc.test(w)?w.replace(iu,fd):w}var hpe=If(function(w,T,B){return w+(B?" ":"")+T.toUpperCase()}),YP=$_("toUpperCase");function u7(w,T,B){return w=Vo(w),T=B?t:T,T===t?jl(w)?bm(w):ro(w):w.match(T)||[]}var l7=_a(function(w,T){try{return hs(w,t,T)}catch(B){return Lg(B)?B:new Ii(B)}}),ppe=Vh(function(w,T){return ps(T,function(B){B=_i(B),yr(w,B,ai(w[B],w))}),w});function dpe(w){var T=w==null?0:w.length,B=yi();return w=T?ls(w,function(Y){if(typeof Y[1]!="function")throw new el(o);return[B(Y[0]),Y[1]]}):[],_a(function(Y){for(var le=-1;++le<T;){var Me=w[le];if(hs(Me[0],this,Y))return hs(Me[1],this,Y)}})}function vpe(w){return Nn(An(w,h))}function ZP(w){return function(){return w}}function gpe(w,T){return w==null||w!==w?T:w}var mpe=kf(),ype=kf(!0);function Xh(w){return w}function qP(w){return Zs(typeof w=="function"?w:An(w,h))}function _pe(w){return vc(An(w,h))}function xpe(w,T){return Fp(w,An(T,h))}var bpe=_a(function(w,T){return function(B){return Kl(B,w,T)}}),wpe=_a(function(w,T){return function(B){return Kl(w,B,T)}});function KP(w,T,B){var Y=vl(T),le=vo(T,Y);B==null&&!(ms(T)&&(le.length||!Y.length))&&(B=T,T=w,w=this,le=vo(T,vl(T)));var Me=!(ms(B)&&"chain"in B)||!!B.chain,rt=jh(w);return ps(le,function(gt){var Pt=T[gt];w[gt]=Pt,rt&&(w.prototype[gt]=function(){var Sr=this.__chain__;if(Me||Sr){var Lr=w(this.__wrapped__),Gr=Lr.__actions__=Pl(this.__actions__);return Gr.push({func:Pt,args:arguments,thisArg:w}),Lr.__chain__=Sr,Lr}return Pt.apply(w,$c([this.value()],arguments))})}),w}function Cpe(){return Ws._===this&&(Ws._=Da),this}function QP(){}function Epe(w){return w=fa(w),_a(function(T){return $h(T,w)})}var Spe=yc(ls),Ape=yc(Sl),Tpe=yc(og);function c7(w){return vr(w)?Vc(_i(w)):dg(w)}function Mpe(w){return function(T){return w==null?t:no(w,T)}}var Lpe=Im(),Ipe=Im(!0);function JP(){return[]}function eR(){return!1}function kpe(){return{}}function Ppe(){return""}function Rpe(){return!0}function Ope(w,T){if(w=fa(w),w<1||w>We)return[];var B=dt,Y=Bo(w,dt);T=yi(T),w-=dt;for(var le=Lh(Y,T);++B<w;)T(B);return le}function Fpe(w){return Ci(w)?ls(w,_i):Dl(w)?[w]:Pl(fi(Vo(w)))}function Dpe(w){var T=++wf;return Vo(w)+T}var Bpe=Bp(function(w,T){return w+T},0),Npe=Qf("ceil"),zpe=Bp(function(w,T){return w/T},1),$pe=Qf("floor");function Upe(w){return w&&w.length?Jn(w,Xh,Xc):t}function Vpe(w,T){return w&&w.length?Jn(w,yi(T,2),Xc):t}function Gpe(w){return Hf(w,Xh)}function Hpe(w,T){return Hf(w,yi(T,2))}function jpe(w){return w&&w.length?Jn(w,Xh,kl):t}function Wpe(w,T){return w&&w.length?Jn(w,yi(T,2),kl):t}var Xpe=Bp(function(w,T){return w*T},1),Ype=Qf("round"),Zpe=Bp(function(w,T){return w-T},0);function qpe(w){return w&&w.length?Ga(w,Xh):0}function Kpe(w,T){return w&&w.length?Ga(w,yi(T,2)):0}return be.after=Yn,be.ary=gn,be.assign=Ig,be.assignIn=J1,be.assignInWith=tx,be.assignWith=eb,be.at=Sd,be.before=Fi,be.bind=ai,be.bindAll=ppe,be.bindKey=In,be.castArray=mo,be.chain=Z_,be.chunk=Au,be.compact=Co,be.concat=qs,be.cond=dpe,be.conforms=vpe,be.constant=ZP,be.countBy=c,be.create=tb,be.curry=Xi,be.curryRight=Mi,be.debounce=ca,be.defaults=rx,be.defaultsDeep=rb,be.defer=Zn,be.delay=Ia,be.difference=zs,be.differenceBy=Tu,be.differenceWith=Mu,be.drop=Nu,be.dropRight=cs,be.dropRightWhile=ki,be.dropWhile=Ks,be.fill=Ea,be.filter=g,be.flatMap=I,be.flatMapDeep=O,be.flatMapDepth=z,be.flatten=Gi,be.flattenDeep=io,be.flattenDepth=Qs,be.flip=qo,be.flow=mpe,be.flowRight=ype,be.fromPairs=_c,be.functions=fA,be.functionsIn=hA,be.groupBy=re,be.initial=Ct,be.intersection=vn,be.intersectionBy=Wi,be.intersectionWith=ke,be.invert=pA,be.invertBy=Ad,be.invokeMap=ce,be.iteratee=qP,be.keyBy=pe,be.keys=vl,be.keysIn=rl,be.map=De,be.mapKeys=n0,be.mapValues=i0,be.matches=_pe,be.matchesProperty=xpe,be.memoize=Ko,be.merge=a0,be.mergeWith=$m,be.method=bpe,be.methodOf=wpe,be.mixin=KP,be.negate=zo,be.nthArg=Epe,be.omit=dA,be.omitBy=vA,be.once=Qo,be.orderBy=$e,be.over=Spe,be.overArgs=Ms,be.overEvery=Ape,be.overSome=Tpe,be.partial=Js,be.partialRight=hu,be.partition=tt,be.pick=gA,be.pickBy=ww,be.property=c7,be.propertyOf=Mpe,be.pull=at,be.pullAll=Je,be.pullAllBy=ht,be.pullAllWith=ye,be.pullAt=qe,be.range=Lpe,be.rangeRight=Ipe,be.rearg=Ol,be.reject=At,be.remove=Pe,be.rest=$u,be.reverse=vt,be.sampleSize=Vt,be.set=Ew,be.setWith=Fv,be.shuffle=ir,be.slice=St,be.sortBy=Vn,be.sortedUniq=pn,be.sortedUniqBy=bn,be.split=tpe,be.spread=Fl,be.tail=Cn,be.take=En,be.takeRight=ni,be.takeRightWhile=Pa,be.takeWhile=cu,be.tap=W1,be.throttle=$s,be.thru=Zy,be.toArray=Q1,be.toPairs=Sw,be.toPairsIn=ab,be.toPath=Fpe,be.toPlainObject=Ls,be.transform=Aw,be.unary=Uu,be.union=xc,be.unionBy=Gh,be.unionWith=go,be.uniq=ta,be.uniqBy=eh,be.uniqWith=rf,be.unset=mA,be.unzip=Pm,be.unzipWith=nf,be.update=Tw,be.updateWith=yA,be.values=Um,be.valuesIn=Mw,be.without=X_,be.words=u7,be.wrap=na,be.xor=_w,be.xorBy=Rm,be.xorWith=Om,be.zip=rA,be.zipObject=fu,be.zipObjectDeep=Y_,be.zipWith=Iv,be.entries=Sw,be.entriesIn=ab,be.extend=J1,be.extendWith=tx,KP(be,be),be.add=Bpe,be.attempt=l7,be.camelCase=ob,be.capitalize=bA,be.ceil=Npe,be.clamp=_A,be.clone=Qa,be.cloneDeep=rc,be.cloneDeepWith=pl,be.cloneWith=xa,be.conformsTo=$o,be.deburr=Lw,be.defaultTo=gpe,be.divide=zpe,be.endsWith=$P,be.eq=ao,be.escape=UP,be.escapeRegExp=VP,be.every=d,be.find=C,be.findIndex=Ts,be.findKey=nb,be.findLast=M,be.findLastIndex=Kn,be.findLastKey=bw,be.floor=$pe,be.forEach=G,be.forEachRight=q,be.forIn=uA,be.forInRight=nx,be.forOwn=lA,be.forOwnRight=cA,be.get=ib,be.gt=dl,be.gte=ka,be.has=Pf,be.hasIn=r0,be.head=Fe,be.identity=Xh,be.includes=oe,be.indexOf=Ft,be.inRange=ix,be.invoke=zP,be.isArguments=bc,be.isArray=Ci,be.isArrayBuffer=wd,be.isArrayLike=Ra,be.isArrayLikeObject=Uo,be.isBoolean=Hh,be.isBuffer=th,be.isDate=Fm,be.isElement=Ky,be.isEmpty=Pv,be.isEqual=Qy,be.isEqualWith=X1,be.isError=Lg,be.isFinite=q_,be.isFunction=jh,be.isInteger=K_,be.isLength=Wh,be.isMap=Rv,be.isMatch=Jy,be.isMatchWith=Y1,be.isNaN=Z1,be.isNative=Q_,be.isNil=q1,be.isNull=J_,be.isNumber=e0,be.isObject=ms,be.isObjectLike=ys,be.isPlainObject=Ov,be.isRegExp=Dm,be.isSafeInteger=K1,be.isSet=Bm,be.isString=Nm,be.isSymbol=Dl,be.isTypedArray=Cd,be.isUndefined=zm,be.isWeakMap=ex,be.isWeakSet=t0,be.join=ge,be.kebabCase=GP,be.last=Ye,be.lastIndexOf=yt,be.lowerCase=HP,be.lowerFirst=jP,be.lt=xw,be.lte=oA,be.max=Upe,be.maxBy=Vpe,be.mean=Gpe,be.meanBy=Hpe,be.min=jpe,be.minBy=Wpe,be.stubArray=JP,be.stubFalse=eR,be.stubObject=kpe,be.stubString=Ppe,be.stubTrue=Rpe,be.multiply=Xpe,be.nth=Ot,be.noConflict=Cpe,be.noop=QP,be.now=fn,be.pad=WP,be.padEnd=XP,be.padStart=Td,be.parseInt=sb,be.random=xA,be.reduce=Ze,be.reduceRight=mt,be.repeat=wA,be.replace=ax,be.result=Cw,be.round=Ype,be.runInContext=bt,be.sample=Nt,be.size=Mr,be.snakeCase=CA,be.some=Wr,be.sortedIndex=ur,be.sortedIndexBy=Nr,be.sortedIndexOf=zr,be.sortedLastIndex=un,be.sortedLastIndexBy=Dr,be.sortedLastIndexOf=Mn,be.startCase=rpe,be.startsWith=npe,be.subtract=Zpe,be.sum=qpe,be.sumBy=Kpe,be.template=ipe,be.times=Ope,be.toFinite=Ed,be.toInteger=fa,be.toLength=sA,be.toLower=ape,be.toNumber=wc,be.toSafeInteger=Np,be.toString=Vo,be.toUpper=ope,be.trim=spe,be.trimEnd=upe,be.trimStart=lpe,be.truncate=cpe,be.unescape=fpe,be.uniqueId=Dpe,be.upperCase=hpe,be.upperFirst=YP,be.each=G,be.eachRight=q,be.first=Fe,KP(be,function(){var w={};return Mo(be,function(T,B){Fa.call(be.prototype,B)||(w[B]=T)}),w}(),{chain:!1}),be.VERSION=n,ps(["bind","bindKey","curry","curryRight","partial","partialRight"],function(w){be[w].placeholder=be}),ps(["drop","take"],function(w,T){zi.prototype[w]=function(B){B=B===t?1:ti(fa(B),0);var Y=this.__filtered__&&!T?new zi(this):this.clone();return Y.__filtered__?Y.__takeCount__=Bo(B,Y.__takeCount__):Y.__views__.push({size:Bo(B,dt),type:w+(Y.__dir__<0?"Right":"")}),Y},zi.prototype[w+"Right"]=function(B){return this.reverse()[w](B).reverse()}}),ps(["filter","map","takeWhile"],function(w,T){var B=T+1,Y=B==ie||B==me;zi.prototype[w]=function(le){var Me=this.clone();return Me.__iteratees__.push({iteratee:yi(le,3),type:B}),Me.__filtered__=Me.__filtered__||Y,Me}}),ps(["head","last"],function(w,T){var B="take"+(T?"Right":"");zi.prototype[w]=function(){return this[B](1).value()[0]}}),ps(["initial","tail"],function(w,T){var B="drop"+(T?"":"Right");zi.prototype[w]=function(){return this.__filtered__?new zi(this):this[B](1)}}),zi.prototype.compact=function(){return this.filter(Xh)},zi.prototype.find=function(w){return this.filter(w).head()},zi.prototype.findLast=function(w){return this.reverse().find(w)},zi.prototype.invokeMap=_a(function(w,T){return typeof w=="function"?new zi(this):this.map(function(B){return Kl(B,w,T)})}),zi.prototype.reject=function(w){return this.filter(zo(yi(w)))},zi.prototype.slice=function(w,T){w=fa(w);var B=this;return B.__filtered__&&(w>0||T<0)?new zi(B):(w<0?B=B.takeRight(-w):w&&(B=B.drop(w)),T!==t&&(T=fa(T),B=T<0?B.dropRight(-T):B.take(T-w)),B)},zi.prototype.takeRightWhile=function(w){return this.reverse().takeWhile(w).reverse()},zi.prototype.toArray=function(){return this.take(dt)},Mo(zi.prototype,function(w,T){var B=/^(?:filter|find|map|reject)|While$/.test(T),Y=/^(?:head|last)$/.test(T),le=be[Y?"take"+(T=="last"?"Right":""):T],Me=Y||/^find/.test(T);!le||(be.prototype[T]=function(){var rt=this.__wrapped__,gt=Y?[1]:arguments,Pt=rt instanceof zi,Sr=gt[0],Lr=Pt||Ci(rt),Gr=function(Ja){var yo=le.apply(be,$c([Ja],gt));return Y&&Gn?yo[0]:yo};Lr&&B&&typeof Sr=="function"&&Sr.length!=1&&(Pt=Lr=!1);var Gn=this.__chain__,vi=!!this.__actions__.length,Yi=Me&&!Gn,Oa=Pt&&!vi;if(!Me&&Lr){rt=Oa?rt:new zi(this);var Zi=w.apply(rt,gt);return Zi.__actions__.push({func:Zy,args:[Gr],thisArg:t}),new Su(Zi,Gn)}return Yi&&Oa?w.apply(this,gt):(Zi=this.thru(Gr),Yi?Y?Zi.value()[0]:Zi.value():Zi)})}),ps(["pop","push","shift","sort","splice","unshift"],function(w){var T=Wf[w],B=/^(?:push|sort|unshift)$/.test(w)?"tap":"thru",Y=/^(?:pop|shift)$/.test(w);be.prototype[w]=function(){var le=arguments;if(Y&&!this.__chain__){var Me=this.value();return T.apply(Ci(Me)?Me:[],le)}return this[B](function(rt){return T.apply(Ci(rt)?rt:[],le)})}}),Mo(zi.prototype,function(w,T){var B=be[T];if(B){var Y=B.name+"";Fa.call(Ou,Y)||(Ou[Y]=[]),Ou[Y].push({name:T,func:B})}}),Ou[tf(t,A).name]=[{name:"wrapper",func:t}],zi.prototype.clone=xv,zi.prototype.reverse=Ip,zi.prototype.value=bv,be.prototype.at=qy,be.prototype.chain=kv,be.prototype.commit=nA,be.prototype.next=iA,be.prototype.plant=zu,be.prototype.reverse=Mg,be.prototype.toJSON=be.prototype.valueOf=be.prototype.value=aA,be.prototype.first=be.prototype.head,Oh&&(be.prototype[Oh]=NP),be},kh=fv();Ch?((Ch.exports=kh)._=kh,av._=kh):Ws._=kh}).call(jp)})(Kt,Kt.exports);function h0(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=l6e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function l6e(e,r){if(!!e){if(typeof e=="string")return I$(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return I$(e,r)}}function I$(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function c6e(e){var r=f6e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function f6e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vne=function(e){er(t,e);var r=c6e(t);function t(n){var i;return st(this,t),i=r.call(this),X(He(i),"currentTiles",[]),X(He(i),"cacheTiles",new Map),X(He(i),"throttleUpdate",Kt.exports.throttle(function(a,o){i.update(a,o)},16)),X(He(i),"onTileLoad",function(a){i.emit("tile-loaded",a),i.updateTileVisible()}),X(He(i),"onTileError",function(a,o){i.emit("tile-error",{error:a,tile:o}),i.updateTileVisible()}),X(He(i),"onTileUnload",function(a){i.emit("tile-unload",a)}),i.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:cne,getTileData:i6e,updateStrategy:Wx.Replace},i.updateOptions(n),i}return ot(t,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(i){return i.isDone})}},{key:"tiles",get:function(){var i=Array.from(this.cacheTiles.values()).sort(function(a,o){return a.z-o.z});return i}},{key:"updateOptions",value:function(i){var a=i.minZoom===void 0?this.options.minZoom:Math.ceil(i.minZoom),o=i.maxZoom===void 0?this.options.maxZoom:Math.floor(i.maxZoom);this.options=Et(Et(Et({},this.options),i),{},{minZoom:a,maxZoom:o})}},{key:"update",value:function(i,a){var o=this,s=Math.ceil(i);if(!(this.lastViewStates&&this.lastViewStates.zoom===s&&u6e(this.lastViewStates.latLonBoundsBuffer,a))){var u=s6e(a,t6e);this.lastViewStates={zoom:s,latLonBounds:a,latLonBoundsBuffer:u};var l=!1,f=this.getTileIndices(s,u);this.currentTiles=f.map(function(h){var p=h.x,v=h.y,m=h.z,x=o.getTile(p,v,m);if(x){var E,A,L=((E=x)===null||E===void 0?void 0:E.isFailure)||((A=x)===null||A===void 0?void 0:A.isCancelled);return L&&x.loadData({getData:o.options.getTileData,onLoad:o.onTileLoad,onError:o.onTileError}),x}return x=o.createTile(p,v,m),l=!0,x}),l&&(this.resizeCacheTiles(),this.rebuildTileTree()),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var i=h0(this.cacheTiles),a;try{for(i.s();!(a=i.n()).done;){var o=tn(a.value,2),s=o[0],u=o[1];this.currentTiles.includes(u)||(this.cacheTiles.delete(s),this.onTileUnload(u)),this.onTileUnload(u),u.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(l){i.e(l)}finally{i.f()}}},{key:"pruneRequests",value:function(){var i=[],a=h0(this.cacheTiles.values()),o;try{for(a.s();!(o=a.n()).done;){var s=o.value;s.isLoading&&!s.isCurrent&&!s.isVisible&&i.push(s)}}catch(l){a.e(l)}finally{a.f()}for(;i.length>0;){var u=i.shift();u.abortLoad()}}},{key:"getTileByLngLat",value:function(i,a,o){var s=this.options.zoomOffset,u=Math.ceil(o)+s,l=fL(i,a,u),f=this.tiles.filter(function(h){return h.key==="".concat(l[0],",").concat(l[1],",").concat(u)});return f[0]}},{key:"destroy",value:function(){var i=h0(this.cacheTiles.values()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o.isLoading&&o.abortLoad()}}catch(s){i.e(s)}finally{i.f()}this.cacheTiles.clear(),this.currentTiles=[],this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var i=this.options.updateStrategy,a=new Map,o=h0(this.cacheTiles.values()),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;a.set(u.key,u.isVisible),u.isCurrent=!1,u.isVisible=!1}}catch(m){o.e(m)}finally{o.f()}var l=h0(this.currentTiles),f;try{for(l.s();!(f=l.n()).done;){var h=f.value;h.isCurrent=!0,h.isVisible=!0}}catch(m){l.e(m)}finally{l.f()}var p=Array.from(this.cacheTiles.values());typeof i=="function"?i(p):n6e[i](p);var v=!1;Array.from(this.cacheTiles.values()).forEach(function(m){m.isVisible!==a.get(m.key)?(m.isVisibleChange=!0,v=!0):m.isVisibleChange=!1}),v&&this.emit("tile-update")}},{key:"getTileIndices",value:function(i,a){var o=this.options,s=o.tileSize,u=o.extent,l=o.zoomOffset,f=Math.floor(this.options.maxZoom),h=Math.ceil(this.options.minZoom),p=hne({maxZoom:f,minZoom:h,zoomOffset:l,tileSize:s,zoom:i,latLonBounds:a,extent:u});return p}},{key:"getTileId",value:function(i,a,o){var s="".concat(i,",").concat(a,",").concat(o);return s}},{key:"getTile",value:function(i,a,o){var s=this.getTileId(i,a,o),u=this.cacheTiles.get(s);return u}},{key:"createTile",value:function(i,a,o){var s=this.getTileId(i,a,o),u=new dne({x:i,y:a,z:o,tileSize:this.options.tileSize});return this.cacheTiles.set(s,u),u.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),u}},{key:"resizeCacheTiles",value:function(){var i=r6e*this.currentTiles.length,a=this.cacheTiles.size>i;if(a){var o=h0(this.cacheTiles),s;try{for(o.s();!(s=o.n()).done;){var u=tn(s.value,2),l=u[0],f=u[1];if(!f.isVisible&&!this.currentTiles.includes(f)&&(this.cacheTiles.delete(l),this.onTileUnload(f)),this.cacheTiles.size<=i)break}}catch(h){o.e(h)}finally{o.f()}}}},{key:"rebuildTileTree",value:function(){var i=h0(this.cacheTiles.values()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;o.parent=null,o.children.length=0}}catch(h){i.e(h)}finally{i.f()}var s=h0(this.cacheTiles.values()),u;try{for(s.s();!(u=s.n()).done;){var l=u.value,f=this.getNearestAncestor(l.x,l.y,l.z);l.parent=f,f!=null&&f.children&&f.children.push(l)}}catch(h){s.e(h)}finally{s.f()}}},{key:"getNearestAncestor",value:function(i,a,o){for(;o>this.options.minZoom;){i=Math.floor(i/2),a=Math.floor(a/2),o=o-1;var s=this.getTile(i,a,o);if(s)return s}return null}}]),t}(_B),iD;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.L7MAP="L7MAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(iD||(iD={}));function k$(e,r,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,o=arguments.length>6?arguments[6]:void 0,s=t;return o&&(s=Math.round(t*(a-1))/(a-1)),n?R$(e,r,s,n,i):R$(e,r,s,.314,i)}function hT(e,r){var t=1-r;return(e[0]*t+e[1]*r)*t+(e[1]*t+e[2]*r)*r}function h6e(e,r){return Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))}function P$(e,r,t){var n=[r[0]-e[0],r[1]-e[1]],i=h6e(n,[0,0]),a=Math.atan2(n[1],n[0]),o=i/2/Math.cos(t),s=a+t,u=[o*Math.cos(s)+e[0],o*Math.sin(s)+e[1]];return u}function R$(e,r,t,n,i){if(i===iD["GAODE2.x"]){var a=Dx(e[0],e[1]),o=Dx(r[0],r[1]),s=P$(a,o,n),u=[a[0],s[0],o[0]],l=[a[1],s[1],o[1]];return[].concat(Pr(jre(hT(u,t),hT(l,t))),[0])}else{var f=P$(e,r,n),h=[e[0],f[0],r[0]],p=[e[1],f[1],r[1]];return[hT(h,t),hT(p,t),0]}}function p6e(e,r,t,n,i){var a=arguments.length>6?arguments[6]:void 0,o=t;return a&&(o=Math.round(t*29)/29),g6e(e,r,o,i)}function d6e(e,r){var t=[r[0]-e[0],r[1]-e[1]],n=yk(t,[0,0]),i=Math.atan2(t[1],t[0]),a=.314,o=n/2/Math.cos(a),s=i+a,u=[o*Math.cos(s)+e[0],o*Math.sin(s)+e[1]];return u}function O$(e,r){var t=1-r;return(e[0]*t+e[1]*r)*t+(e[1]*t+e[2]*r)*r}function v6e(e,r){var t=[e[0]-r[0],e[1]-r[1]],n=[Math.sin(t[0]/2),Math.sin(t[1]/2)],i=n[1]*n[1]+Math.cos(e[1])*Math.cos(r[1])*n[0]*n[0];return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))}function g6e(e,r,t,n){var i=[N0(e[0]),N0(e[1])],a=[N0(r[0]),N0(r[1])];if(n==="GAODE2.x"){var o=d6e(i,a),s=[i[0],o[0],a[0]],u=[i[1],o[1],a[1]];return[O$(s,t),O$(u,t),0]}else{var l=v6e(i,a);if(Math.abs(l-Math.PI)<.001)return[(1-t)*i[0]+t*a[0],(1-t)*i[1]+t*a[1]];var f=Math.sin((1-t)*l)/Math.sin(l),h=Math.sin(t*l)/Math.sin(l),p=[Math.sin(i[0]),Math.sin(i[1])],v=[Math.cos(i[0]),Math.cos(i[1])],m=[Math.sin(a[0]),Math.sin(a[1])],x=[Math.cos(a[0]),Math.cos(a[1])],E=f*v[1]*v[0]+h*x[1]*x[0],A=f*v[1]*p[0]+h*x[1]*m[0],L=f*p[1]+h*m[1];return[_$(Math.atan2(A,E)),_$(Math.atan2(L,Math.sqrt(E*E+A*A)))]}}function m6e(e,r){for(var t=0,n=[],i=0;i<e.length-1;i++){var a=e[i],o=e[i+1],s=_6e(a,o),u=t;t+=s,n.push({p1:a,p2:o,totalDistance:t,distance:s,lastTotalDistance:u})}for(var l=t*r,f,h,p=0;p<n.length;p++){var v=n[p].totalDistance;if(v>l){var m=n[p].p1,x=n[p].p2,E=(l-n[p].lastTotalDistance)/n[p].distance,A=y6e(x,m,E);f=A[0],h=A[1];break}}return{_lng:f,_lat:h,_height:0}}function y6e(e,r,t){return[e[0]*t+r[0]*(1-t),e[1]*t+r[1]*(1-t)]}function _6e(e,r){return Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))}function aD(e,r){var t=r.featureId,n=e.data.dataArray;return typeof t=="number"&&(n=n.filter(function(i){var a=i._id;return a===t})),n.map(function(i){var a=b6e(i,r);return Et(Et({},i),a)})}function x6e(e,r){return new Promise(function(t){e.inited?t(aD(e,r)):e.once("update",function(){t(aD(e,r))})})}function b6e(e,r){var t=r.offset,n=r.shape,i=r.thetaOffset,a=r.mapVersion,o=r.segmentNumber,s=o===void 0?30:o,u=r.autoFit,l=u===void 0?!0:u,f=e.coordinates;if(n==="line")return m6e(f,t);var h=f[0],p=f[1],v;typeof i=="string"?v=e[i]||0:v=i;var m;switch(n){case"arc":m=k$;break;case"greatcircle":m=p6e;break;default:m=k$}var x=m(h,p,t,v,a,s,l),E=tn(x,3),A=E[0],L=E[1],k=E[2];return{_lng:A,_lat:L,_height:k}}var w6e=Object.freeze(Object.defineProperty({__proto__:null,DOM:z4e,Satistics:$4e,djb2hash:w3e,BKDRHash:b3e,dispatchTouchStart:v4e,dispatchTouchMove:g4e,dispatchTouchEnd:m4e,dispatchMapCameraParams:y4e,dispatchPointerDown:L4e,dispatchPointerMove:I4e,dispatchPointerUp:k4e,dispatchMouseDown:P4e,dispatchMouseMove:R4e,dispatchMouseUp:O4e,isMiniAli:xre,isWeChatMiniProgram:bre,isMini:ns,miniWindow:wre,$window:Hn,$XMLHttpRequest:Cre,$location:F4e,AJAXError:Dre,makeXMLHttpRequestPromise:Nre,getJSON:j4e,getArrayBuffer:gk,postData:W4e,sameOrigin:X4e,getImage:sL,extent:zre,tranfrormCoord:rBe,lngLatToMeters:uM,metersToLngLat:nBe,longitude:Vre,latitude:Gre,validateLngLat:Hre,aProjectFlat:nc,unProjectFlat:iBe,amap2Project:Dx,amap2UnProject:jre,lnglatDistance:Wre,project:aBe,padBounds:i1,boundsContains:mk,bBoxToBounds:kE,normalize:FB,calDistance:yk,calAngle:sBe,getAngle:Xre,flow:uBe,calculateCentroid:Yp,calculatePointsCenterAndRadius:Yre,LRUCache:Zre,bindAll:E1,FrequencyController:qre,isColor:DB,rgb2arr:Sa,decodePickingColor:dy,encodePickingColor:Sy,generateColorRamp:Ay,get anchorType(){return PE},anchorTranslate:RE,applyAnchorClass:BB,getMask:Ya,WorkerSourceMap:jB,setL7WorkerSource:ane,executeWorkerTask:one,getCullFace:Z2,isImageBitmap:Ore,isWorker:Fre,getReferrer:V4e,Tile:dne,TilesetManager:vne,isURLTemplate:qBe,expandUrl:sne,getURLFromTemplate:e2,get UpdateTileStrategy(){return Wx},get LoadTileDataStatus(){return Jh},osmLonLat2TileXY:fL,osmTileXY2LonLat:nD,tileToBounds:fne,getTileIndices:hne,getTileWarpXY:pne,LineTriangulation:cL,PointFillTriangulation:WC,polygonFillTriangulation:HB,lineAtOffset:aD,lineAtOffsetAsyc:x6e},Symbol.toStringTag,{value:"Module"})),XB={exports:{}};XB.exports=TS;XB.exports.default=TS;var t2=1e20;function TS(e,r,t,n,i,a){this.fontSize=e||24,this.buffer=r===void 0?3:r,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=a||"normal",this.radius=t||8;var o=this.size=this.fontSize+this.buffer*2,s=o+this.buffer*2,u=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;u?this.canvas=my.createOffscreenCanvas(o,o,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o),this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,u?this.middle=Math.round(o/2*1):this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function C6e(e,r,t,n,i,a,o){a.fill(t2,0,r*t),o.fill(0,0,r*t);for(var s=(r-n)/2,u=0;u<i;u++)for(var l=0;l<n;l++){var f=(u+s)*r+l+s,h=e.data[4*(u*n+l)+3]/255;if(h===1)a[f]=0,o[f]=t2;else if(h===0)a[f]=t2,o[f]=0;else{var p=Math.max(0,.5-h),v=Math.max(0,h-.5);a[f]=p*p,o[f]=v*v}}}function E6e(e,r,t,n,i,a,o){for(var s=0;s<r*t;s++){var u=Math.sqrt(n[s])-Math.sqrt(i[s]);e[s]=Math.round(255-255*(u/a+o))}}TS.prototype._draw=function(e,r){var t=this.ctx.measureText(e),n=t.width,i=2*this.buffer,a,o,s,u,l,f,h,p;r&&this.useMetrics?(l=Math.floor(t.actualBoundingBoxAscent),p=this.buffer+Math.ceil(t.actualBoundingBoxAscent),f=this.buffer,h=this.buffer,o=Math.min(this.size,Math.ceil(t.actualBoundingBoxRight-t.actualBoundingBoxLeft)),u=Math.min(this.size-f,Math.ceil(t.actualBoundingBoxAscent+t.actualBoundingBoxDescent)),a=o+i,s=u+i,this.ctx.textBaseline="alphabetic"):(a=o=this.size,s=u=this.size,l=19*this.fontSize/24,f=h=0,p=this.middle,this.ctx.textBaseline="middle");var v;o&&u&&(this.ctx.clearRect(h,f,o,u),this.ctx.fillText(e,this.buffer,p),v=this.ctx.getImageData(h,f,o,u));var m=new Uint8ClampedArray(a*s);return C6e(v,a,s,o,u,this.gridOuter,this.gridInner),F$(this.gridOuter,a,s,this.f,this.v,this.z),F$(this.gridInner,a,s,this.f,this.v,this.z),E6e(m,a,s,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:m,metrics:{width:o,height:u,sdfWidth:a,sdfHeight:s,top:l,left:0,advance:n}}};TS.prototype.draw=function(e){return this._draw(e,!1).data};TS.prototype.drawWithMetrics=function(e){return this._draw(e,!0)};function F$(e,r,t,n,i,a){for(var o=0;o<r;o++)D$(e,o,r,t,n,i,a);for(var s=0;s<t;s++)D$(e,s*r,1,r,n,i,a)}function D$(e,r,t,n,i,a,o){var s,u,l,f;for(a[0]=0,o[0]=-t2,o[1]=t2,s=0;s<n;s++)i[s]=e[r+s*t];for(s=1,u=0,l=0;s<n;s++){do f=a[u],l=(i[s]-i[f]+s*s-f*f)/(s-f)/2;while(l<=o[u]&&--u>-1);u++,a[u]=s,o[u]=l,o[u+1]=t2}for(s=0,u=0;s<n;s++){for(;o[u+1]<s;)u++;f=a[u],e[r+s*t]=i[f]+(s-f)*(s-f)}}var S6e=XB.exports;function gne(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=A6e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function A6e(e,r){if(!!e){if(typeof e=="string")return B$(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return B$(e,r)}}function B$(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Yw=30;function T6e(e){var r=e.characterSet,t=e.getFontWidth,n=e.fontHeight,i=e.buffer,a=e.maxCanvasWidth,o=e.mapping,s=o===void 0?{}:o,u=e.xOffset,l=u===void 0?0:u,f=e.yOffset,h=f===void 0?0:f,p=0,v=l;Array.from(r).forEach(function(x,E){if(!s[x]){var A=t(x,E);v+Yw>a&&(v=0,p++),s[x]={x:v,y:h+p*Yw,width:Yw,height:Yw,advance:A},v+=Yw}});var m=n+i*2;return{mapping:s,xOffset:v,yOffset:h+p*m,canvasHeight:mne(h+(p+1)*m)}}function M6e(e,r,t){var n=0,i=0,a=0,o=[],s={},u=gne(e),l;try{for(u.s();!(l=u.n()).done;){var f=l.value;if(!s[f.id]){var h=f.size;n+h+r>t&&(N$(s,o,i),n=0,i=a+i+r,a=0,o=[]),o.push({icon:f,xOffset:n}),n=n+h+r,a=Math.max(a,h)}}}catch(v){u.e(v)}finally{u.f()}o.length>0&&N$(s,o,i);var p=mne(a+i+r);return{mapping:s,canvasHeight:p}}function N$(e,r,t){var n=gne(r),i;try{for(n.s();!(i=n.n()).done;){var a=i.value,o=a.icon,s=a.xOffset;e[o.id]=Et(Et({},o),{},{x:s,y:t,image:o.image,width:o.width,height:o.height})}}catch(u){n.e(u)}finally{n.f()}}function mne(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var z$,$$;function U$(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=L6e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function L6e(e,r){if(!!e){if(typeof e=="string")return V$(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return V$(e,r)}}function V$(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function I6e(e){var r=k6e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function k6e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P6e=U6e(),R6e="sans-serif",O6e="normal",F6e=24,D6e=3,B6e=.25,N6e=8,G$=1024,z6e=1,H$=1,$6e=3;function U6e(){for(var e=[],r=32;r<128;r++)e.push(String.fromCharCode(r));return e}function j$(e,r,t,n){e.font="".concat(n," ").concat(t,"px ").concat(r),e.fillStyle="black",e.textBaseline="middle"}function W$(e,r){for(var t=0;t<e.length;t++)r.data[4*t+3]=e[t]}var V6e=(z$=Ri(),z$($$=function(e){er(t,e);var r=I6e(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"fontAtlas",void 0),X(He(n),"iconFontMap",void 0),X(He(n),"iconFontGlyphs",{}),X(He(n),"fontOptions",void 0),X(He(n),"key",void 0),X(He(n),"cache",new Zre($6e)),n}return ot(t,[{key:"scale",get:function(){return H$}},{key:"canvas",get:function(){var i=this.cache.get(this.key);return i&&i.data}},{key:"mapping",get:function(){var i=this.cache.get(this.key);return i&&i.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:R6e,fontWeight:O6e,characterSet:P6e,fontSize:F6e,buffer:D6e,sdf:!0,cutoff:B6e,radius:N6e,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(i){var a=this;i.forEach(function(o){a.iconFontGlyphs[o.name]=o.unicode})}},{key:"addIconFont",value:function(i,a){this.iconFontMap.set(i,a)}},{key:"getIconFontKey",value:function(i){return this.iconFontMap.get(i)||i}},{key:"getGlyph",value:function(i){return this.iconFontGlyphs[i]?String.fromCharCode(parseInt(this.iconFontGlyphs[i],16)):""}},{key:"setFontOptions",value:function(i){this.fontOptions=Et(Et({},this.fontOptions),i),this.key=this.getKey();var a=this.getNewChars(this.key,this.fontOptions.characterSet),o=this.cache.get(this.key);if(!(o&&a.length===0)){var s=this.generateFontAtlas(this.key,a,o);this.fontAtlas=s,this.cache.set(this.key,s)}}},{key:"addFontFace",value:function(i,a){var o=this,s=document.createElement("style");s.type="text/css",s.innerText=`
        @font-face{
            font-family: '`.concat(i,`';
            src: url('`).concat(a,`') format('woff2'),
            url('`).concat(a,`') format('woff'),
            url('`).concat(a,`') format('truetype');
        }`),s.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(i),"L7text"),document.fonts.ready.then(function(){o.emit("fontloaded",{fontFamily:i})})}catch(u){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(u)}},document.getElementsByTagName("head")[0].appendChild(s)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(i,a,o){var s=this.fontOptions,u=s.fontFamily,l=s.fontWeight,f=s.fontSize,h=s.buffer,p=s.sdf,v=s.radius,m=s.cutoff,x=s.iconfont,E=o&&o.data;E||(E=Hn.document.createElement("canvas"),E.width=G$);var A=E.getContext("2d");j$(A,u,f,l);var L=T6e(Et({getFontWidth:function(je){return A.measureText(je).width},fontHeight:f*H$,buffer:h,characterSet:a,maxCanvasWidth:G$},o&&{mapping:o.mapping,xOffset:o.xOffset,yOffset:o.yOffset})),k=L.mapping,R=L.canvasHeight,D=L.xOffset,$=L.yOffset,j=A.getImageData(0,0,E.width,E.height);if(E.height=R,A.putImageData(j,0,0),j$(A,u,f,l),p){var H=new S6e(f,h,v,m,u,l),ee=A.getImageData(0,0,H.size,H.size),U=U$(a),W;try{for(U.s();!(W=U.n()).done;){var Q=W.value;if(x){var te=String.fromCharCode(parseInt(Q.replace("&#x","").replace(";",""),16)),ie=H.draw(te);W$(ie,ee)}else W$(H.draw(Q),ee);A.putImageData(ee,k[Q].x,k[Q].y)}}catch(We){U.e(We)}finally{U.f()}}else{var ve=U$(a),me;try{for(ve.s();!(me=ve.n()).done;){var Re=me.value;A.fillText(Re,k[Re].x,k[Re].y+f*z6e)}}catch(We){ve.e(We)}finally{ve.f()}}return{xOffset:D,yOffset:$,mapping:k,data:E,width:E.width,height:E.height}}},{key:"getKey",value:function(){return"key"}},{key:"getNewChars",value:function(i,a){var o=this.cache.get(i);if(!o)return a;var s=[],u=o.mapping,l=new Set(Object.keys(u)),f=new Set(a);return f.forEach(function(h){l.has(h)||s.push(h)}),s}}]),t}(zf.exports.EventEmitter))||$$),X$,Y$;function G6e(e){var r=H6e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function H6e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var j6e=3,Z$=1024,Zw=64,W6e=(X$=Ri(),X$(Y$=function(e){er(t,e);var r=G6e(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"canvasHeight",128),X(He(n),"texture",void 0),X(He(n),"canvas",void 0),X(He(n),"iconData",void 0),X(He(n),"iconMap",void 0),X(He(n),"ctx",void 0),X(He(n),"loadingImageCount",0),n}return ot(t,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=Hn.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(i,a){var o=this,s=new Image;if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Zw}),this.updateIconMap(),this.loadImage(a).then(function(u){s=u;var l=o.iconData.find(function(f){return f.id===i});l&&(l.image=s,l.width=s.width,l.height=s.height),o.update()})}},{key:"addImageMini",value:function(i,a,o){var s=this,u=o.getSceneConfig().canvas,l=u.createImage();if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Zw}),this.updateIconMap(),this.loadImageMini(a,u).then(function(f){l=f;var h=s.iconData.find(function(p){return p.id===i});h&&(h.image=l,h.width=l.width,h.height=l.height),s.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(i){return this.iconMap.hasOwnProperty(i)}},{key:"removeImage",value:function(i){this.hasImage(i)&&(this.iconData=this.iconData.filter(function(a){return a.id!==i}),delete this.iconMap[i],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(i){return new Promise(function(a,o){if(i instanceof HTMLImageElement){a(i);return}var s=new Image;s.crossOrigin="anonymous",s.onload=function(){a(s)},s.onerror=function(){o(new Error("Could not load image at "+i))},s.src=i instanceof File?URL.createObjectURL(i):i})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var i=this;this.canvas.width=Z$,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(a){var o=i.iconMap[a],s=o.x,u=o.y,l=o.image,f=o.width,h=f===void 0?64:f,p=o.height,v=p===void 0?64:p,m=Math.max(h,v),x=m/Zw,E=v/x,A=h/x;l&&i.ctx.drawImage(l,s+(Zw-A)/2,u+(Zw-E)/2,A,E)})}},{key:"updateIconMap",value:function(){var i=M6e(this.iconData,j6e,Z$),a=i.mapping,o=i.canvasHeight;this.iconMap=a,this.canvasHeight=o}},{key:"loadImageMini",value:function(i,a){return new Promise(function(o,s){var u=a.createImage();u.crossOrigin="anonymous",u.onload=function(){o(u)},u.onerror=function(){s(new Error("Could not load image at "+i))},u.src=i})}}]),t}(zf.exports.EventEmitter))||Y$),q$,K$,X6e=(q$=Ri(),q$(K$=function(){function e(){st(this,e),X(this,"viewport",void 0),X(this,"overridedViewProjectionMatrix",void 0),X(this,"jitteredViewProjectionMatrix",void 0),X(this,"jitteredProjectionMatrix",void 0),X(this,"viewMatrixInverse",void 0),X(this,"cameraPosition",void 0)}return ot(e,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=ts(),s2(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=this.viewport.getCenter(),n=tn(t,2),i=n[0],a=n[1];return[i,a]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,n){var i=Sq(ts(),[t,n,0]);this.jitteredProjectionMatrix=ff(ts(),i,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=ff(ts(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||K$),Q$,J$;function Y6e(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Z6e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Z6e(e,r){if(!!e){if(typeof e=="string")return eU(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return eU(e,r)}}function eU(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var q6e=(Q$=Ri(),Q$(J$=function(){function e(){st(this,e),X(this,"container",void 0),X(this,"controlCorners",void 0),X(this,"controlContainer",void 0),X(this,"scene",void 0),X(this,"mapsService",void 0),X(this,"controls",[]),X(this,"unAddControls",[])}return ot(e,[{key:"init",value:function(t,n){this.container=t.container,this.scene=n,this.mapsService=n.get(Mt.IMapService),this.initControlPos()}},{key:"addControl",value:function(t,n){var i=n.get(Mt.IMapService);i.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find(function(n){return n.controlOption.name===t})}},{key:"removeControl",value:function(t){var n=this.controls.indexOf(t);return n>-1&&this.controls.splice(n,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach(function(n){n.addTo(t.scene),t.controls.push(n)}),this.unAddControls=[]}},{key:"destroy",value:function(){var t=Y6e(this.controls),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;i.remove()}}catch(a){t.e(a)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},n="l7-",i=this.controlContainer=xs("div",n+"control-container",this.container);function a(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=o.map(function(u){return n+u}).join(" ");t[o.join("")]=xs("div",s,i)}a(["top","left"]),a(["top","right"]),a(["bottom","left"]),a(["bottom","right"]),a(["top","center"]),a(["right","center"]),a(["left","center"]),a(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&n1(this.controlCorners[t]);this.controlContainer&&n1(this.controlContainer)}}]),e}())||J$),tU,rU,K6e=(tU=Ri(),tU(rU=function(){function e(){st(this,e),X(this,"container",void 0),X(this,"scene",void 0),X(this,"mapsService",void 0),X(this,"markers",[]),X(this,"markerLayers",[]),X(this,"unAddMarkers",[]),X(this,"unAddMarkerLayers",[])}return ot(e,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var n=this.markerLayers.indexOf(t);n>-1&&this.markerLayers.splice(n,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach(function(n){n.addTo(t.scene),t.markers.push(n)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach(function(n){t.markerLayers.push(n),n.addTo(t.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var n=this.markers.indexOf(t);n>-1&&this.markers.splice(n,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Mt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(t){t.remove()}),this.markers=[],this.markerLayers.forEach(function(t){t.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),e}())||rU),nU,iU,Q6e=(nU=Ri(),nU(iU=function(){function e(){st(this,e),X(this,"scene",void 0),X(this,"popup",void 0),X(this,"mapsService",void 0),X(this,"unAddPopup",void 0)}return ot(e,[{key:"removePopup",value:function(t){t.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(t){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(t.addTo(this.scene),this.popup=t):this.unAddPopup=t}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(Mt.IMapService)}}]),e}())||iU),J6e={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},aU,oU,eNe={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},tNe={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},rNe=(aU=Ri(),aU(oU=function(){function e(){st(this,e),X(this,"sceneConfigCache",{}),X(this,"layerConfigCache",{})}return ot(e,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return J6e[t]}},{key:"setSceneConfig",value:function(t,n){this.sceneConfigCache[t]=Et(Et({},eNe),n)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,n,i){this.layerConfigCache[n]=Et({},Kt.exports.merge({},this.sceneConfigCache[t],tNe,i))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||oU);function ua(e,r,t,n){!t||Object.defineProperty(e,r,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(n):void 0})}function ia(e,r,t,n,i){var a={};return Object.keys(n).forEach(function(o){a[o]=n[o]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=t.slice().reverse().reduce(function(o,s){return s(e,r,o)||o},a),i&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,r,a),a=null),a}var nO=Math.PI/180,nNe=512,sU=4003e4;function uU(e){var r=e.latitude,t=r===void 0?0:r,n=e.zoom,i=n===void 0?0:n,a=e.scale,o=e.highPrecision,s=o===void 0?!1:o,u=e.flipY,l=u===void 0?!1:u;a=a!==void 0?a:Math.pow(2,i);var f={},h=nNe*a,p=Math.cos(t*nO),v=h/360,m=v/p,x=h/sU/p;if(f.pixelsPerMeter=[x,-x,x],f.metersPerPixel=[1/x,-1/x,1/x],f.pixelsPerDegree=[v,-m,x],f.degreesPerPixel=[1/v,-1/m,1/x],s){var E=nO*Math.tan(t*nO)/p,A=v*E/2,L=h/sU*E,k=L/m*x;f.pixelsPerDegree2=[0,-A,L],f.pixelsPerMeter2=[k,0,k],l&&(f.pixelsPerDegree2[1]=-f.pixelsPerDegree2[1],f.pixelsPerMeter2[1]=-f.pixelsPerMeter2[1])}return l&&(f.pixelsPerMeter[1]=-f.pixelsPerMeter[1],f.metersPerPixel[1]=-f.metersPerPixel[1],f.pixelsPerDegree[1]=-f.pixelsPerDegree[1],f.degreesPerPixel[1]=-f.degreesPerPixel[1]),f}var sc;(function(e){e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2"})(sc||(sc={}));var w0={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},lU,cU,fU,iO,hU,iNe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],aNe=(lU=Ri(),cU=ba(Mt.ICameraService),lU(fU=(iO=function(){function e(){st(this,e),X(this,"needRefresh",!0),ua(this,"cameraService",hU,this),X(this,"coordinateSystem",void 0),X(this,"viewportCenter",void 0),X(this,"viewportCenterProjection",void 0),X(this,"pixelsPerDegree",void 0),X(this,"pixelsPerDegree2",void 0),X(this,"pixelsPerMeter",void 0)}return ot(e,[{key:"refresh",value:function(t){var n=this.cameraService.getZoom(),i=this.cameraService.getZoomScale(),a=t||this.cameraService.getCenter(),o=uU({latitude:a[1],zoom:n}),s=o.pixelsPerMeter,u=o.pixelsPerDegree;this.viewportCenter=a,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=s,this.pixelsPerDegree=u,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===sc.LNGLAT||this.coordinateSystem===sc.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===sc.LNGLAT_OFFSET?this.calculateLnglatOffset(a,n):this.coordinateSystem===sc.P20_OFFSET&&this.calculateLnglatOffset(a,n,i,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,n,i,a){var o=uU({latitude:t[1],zoom:n,scale:i,flipY:a,highPrecision:!0}),s=o.pixelsPerMeter,u=o.pixelsPerDegree,l=o.pixelsPerDegree2,f=this.cameraService.getViewMatrix(),h=this.cameraService.getProjectionMatrix(),p=ff([],h,f),v=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,n));this.viewportCenterProjection=kx([],[v[0],v[1],0,1],p),f=this.cameraService.getViewMatrixUncentered()||f,p=ff([],h,f),p=ff([],p,iNe),this.cameraService.setViewProjectionMatrix(p),this.pixelsPerMeter=s,this.pixelsPerDegree=u,this.pixelsPerDegree2=l}}]),e}(),hU=ia(iO.prototype,"cameraService",[cU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iO))||fU),yne={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(r,t,n,i){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,o=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),s=a||o,u=["","webkit","Moz","MS","ms","o"],l=s?"":t.createElement("div"),f="function",h=Math.round,p=Math.abs,v=Date.now;function m(he,Te,et){return setTimeout($(he,et),Te)}function x(he,Te,et){return Array.isArray(he)?(E(he,et[Te],et),!0):!1}function E(he,Te,et){var jt;if(!!he)if(he.forEach)he.forEach(Te,et);else if(he.length!==i)for(jt=0;jt<he.length;)Te.call(et,he[jt],jt,he),jt++;else for(jt in he)he.hasOwnProperty(jt)&&Te.call(et,he[jt],jt,he)}function A(he,Te,et){var jt="DEPRECATED METHOD: "+Te+`
`+et+` AT 
`;return function(){var Or=new Error("get-stack-trace"),Bn=Or&&Or.stack?Or.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ji=r.console&&(r.console.warn||r.console.log);return Ji&&Ji.call(r.console,jt,Bn),he.apply(this,arguments)}}var L;typeof Object.assign!="function"?L=function(Te){if(Te===i||Te===null)throw new TypeError("Cannot convert undefined or null to object");for(var et=Object(Te),jt=1;jt<arguments.length;jt++){var Or=arguments[jt];if(Or!==i&&Or!==null)for(var Bn in Or)Or.hasOwnProperty(Bn)&&(et[Bn]=Or[Bn])}return et}:L=Object.assign;var k=A(function(Te,et,jt){for(var Or=Object.keys(et),Bn=0;Bn<Or.length;)(!jt||jt&&Te[Or[Bn]]===i)&&(Te[Or[Bn]]=et[Or[Bn]]),Bn++;return Te},"extend","Use `assign`."),R=A(function(Te,et){return k(Te,et,!0)},"merge","Use `assign`.");function D(he,Te,et){var jt=Te.prototype,Or;Or=he.prototype=Object.create(jt),Or.constructor=he,Or._super=jt,et&&L(Or,et)}function $(he,Te){return function(){return he.apply(Te,arguments)}}function j(he,Te){return typeof he==f?he.apply(Te&&Te[0]||i,Te):he}function H(he,Te){return he===i?Te:he}function ee(he,Te,et){E(te(Te),function(jt){he.addEventListener(jt,et,!1)})}function U(he,Te,et){E(te(Te),function(jt){he.removeEventListener(jt,et,!1)})}function W(he,Te){for(;he;){if(he==Te)return!0;he=he.parentNode}return!1}function Q(he,Te){return he.indexOf(Te)>-1}function te(he){return he.trim().split(/\s+/g)}function ie(he,Te,et){if(he.indexOf&&!et)return he.indexOf(Te);for(var jt=0;jt<he.length;){if(et&&he[jt][et]==Te||!et&&he[jt]===Te)return jt;jt++}return-1}function ve(he){return Array.prototype.slice.call(he,0)}function me(he,Te,et){for(var jt=[],Or=[],Bn=0;Bn<he.length;){var Ji=Te?he[Bn][Te]:he[Bn];ie(Or,Ji)<0&&jt.push(he[Bn]),Or[Bn]=Ji,Bn++}return et&&(Te?jt=jt.sort(function(Hs,xu){return Hs[Te]>xu[Te]}):jt=jt.sort()),jt}function Re(he,Te){for(var et,jt,Or=Te[0].toUpperCase()+Te.slice(1),Bn=0;Bn<u.length;){if(et=u[Bn],jt=et?et+Or:Te,jt in he)return jt;Bn++}return i}var We=1;function je(){return We++}function lt(he){var Te=he.ownerDocument||he;return Te.defaultView||Te.parentWindow||r}var dt=/mobile|tablet|ip(ad|hone|od)|android/i,ct="ontouchstart"in r,Tt=Re(r,"PointerEvent")!==i,It=ct&&dt.test(navigator.userAgent),Lt="touch",rn="pen",wn="mouse",zn="kinect",Zt=25,nn=1,mn=2,zt=4,Vr=8,On=1,Si=2,Fn=4,Ai=8,Ua=16,va=Si|Fn,Va=Ai|Ua,to=va|Va,Os=["x","y"],Ro=["clientX","clientY"];function ne(he,Te){var et=this;this.manager=he,this.callback=Te,this.element=he.element,this.target=he.options.inputTarget,this.domHandler=function(jt){j(he.options.enable,[he])&&et.handler(jt)},this.init()}ne.prototype={handler:function(){},init:function(){this.evEl&&ee(this.element,this.evEl,this.domHandler),this.evTarget&&ee(this.target,this.evTarget,this.domHandler),this.evWin&&ee(lt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&U(this.element,this.evEl,this.domHandler),this.evTarget&&U(this.target,this.evTarget,this.domHandler),this.evWin&&U(lt(this.element),this.evWin,this.domHandler)}};function Qt(he){var Te,et=he.options.inputClass;return et?Te=et:Tt?Te=ae:It?Te=Ge:ct?Te=$t:Te=iu,new Te(he,gr)}function gr(he,Te,et){var jt=et.pointers.length,Or=et.changedPointers.length,Bn=Te&nn&&jt-Or===0,Ji=Te&(zt|Vr)&&jt-Or===0;et.isFirst=!!Bn,et.isFinal=!!Ji,Bn&&(he.session={}),et.eventType=Te,hn(he,et),he.emit("hammer.input",et),he.recognize(et),he.session.prevInput=et}function hn(he,Te){var et=he.session,jt=Te.pointers,Or=jt.length;et.firstInput||(et.firstInput=Qn(Te)),Or>1&&!et.firstMultiple?et.firstMultiple=Qn(Te):Or===1&&(et.firstMultiple=!1);var Bn=et.firstInput,Ji=et.firstMultiple,Bs=Ji?Ji.center:Bn.center,Hs=Te.center=ci(jt);Te.timeStamp=v(),Te.deltaTime=Te.timeStamp-Bn.timeStamp,Te.angle=Oo(Bs,Hs),Te.distance=Li(Bs,Hs),$n(et,Te),Te.offsetDirection=Ti(Te.deltaX,Te.deltaY);var xu=Wn(Te.deltaTime,Te.deltaX,Te.deltaY);Te.overallVelocityX=xu.x,Te.overallVelocityY=xu.y,Te.overallVelocity=p(xu.x)>p(xu.y)?xu.x:xu.y,Te.scale=Ji?xl(Ji.pointers,jt):1,Te.rotation=Ji?Fo(Ji.pointers,jt):0,Te.maxPointers=et.prevInput?Te.pointers.length>et.prevInput.maxPointers?Te.pointers.length:et.prevInput.maxPointers:Te.pointers.length,Ta(et,Te);var js=he.element;W(Te.srcEvent.target,js)&&(js=Te.srcEvent.target),Te.target=js}function $n(he,Te){var et=Te.center,jt=he.offsetDelta||{},Or=he.prevDelta||{},Bn=he.prevInput||{};(Te.eventType===nn||Bn.eventType===zt)&&(Or=he.prevDelta={x:Bn.deltaX||0,y:Bn.deltaY||0},jt=he.offsetDelta={x:et.x,y:et.y}),Te.deltaX=Or.x+(et.x-jt.x),Te.deltaY=Or.y+(et.y-jt.y)}function Ta(he,Te){var et=he.lastInterval||Te,jt=Te.timeStamp-et.timeStamp,Or,Bn,Ji,Bs;if(Te.eventType!=Vr&&(jt>Zt||et.velocity===i)){var Hs=Te.deltaX-et.deltaX,xu=Te.deltaY-et.deltaY,js=Wn(jt,Hs,xu);Bn=js.x,Ji=js.y,Or=p(js.x)>p(js.y)?js.x:js.y,Bs=Ti(Hs,xu),he.lastInterval=Te}else Or=et.velocity,Bn=et.velocityX,Ji=et.velocityY,Bs=et.direction;Te.velocity=Or,Te.velocityX=Bn,Te.velocityY=Ji,Te.direction=Bs}function Qn(he){for(var Te=[],et=0;et<he.pointers.length;)Te[et]={clientX:h(he.pointers[et].clientX),clientY:h(he.pointers[et].clientY)},et++;return{timeStamp:v(),pointers:Te,center:ci(Te),deltaX:he.deltaX,deltaY:he.deltaY}}function ci(he){var Te=he.length;if(Te===1)return{x:h(he[0].clientX),y:h(he[0].clientY)};for(var et=0,jt=0,Or=0;Or<Te;)et+=he[Or].clientX,jt+=he[Or].clientY,Or++;return{x:h(et/Te),y:h(jt/Te)}}function Wn(he,Te,et){return{x:Te/he||0,y:et/he||0}}function Ti(he,Te){return he===Te?On:p(he)>=p(Te)?he<0?Si:Fn:Te<0?Ai:Ua}function Li(he,Te,et){et||(et=Os);var jt=Te[et[0]]-he[et[0]],Or=Te[et[1]]-he[et[1]];return Math.sqrt(jt*jt+Or*Or)}function Oo(he,Te,et){et||(et=Os);var jt=Te[et[0]]-he[et[0]],Or=Te[et[1]]-he[et[1]];return Math.atan2(Or,jt)*180/Math.PI}function Fo(he,Te){return Oo(Te[1],Te[0],Ro)+Oo(he[1],he[0],Ro)}function xl(he,Te){return Li(Te[0],Te[1],Ro)/Li(he[0],he[1],Ro)}var Fc={mousedown:nn,mousemove:mn,mouseup:zt},gf="mousedown",Gl="mousemove mouseup";function iu(){this.evEl=gf,this.evWin=Gl,this.pressed=!1,ne.apply(this,arguments)}D(iu,ne,{handler:function(Te){var et=Fc[Te.type];et&nn&&Te.button===0&&(this.pressed=!0),et&mn&&Te.which!==1&&(et=zt),this.pressed&&(et&zt&&(this.pressed=!1),this.callback(this.manager,et,{pointers:[Te],changedPointers:[Te],pointerType:wn,srcEvent:Te}))}});var bl={pointerdown:nn,pointermove:mn,pointerup:zt,pointercancel:Vr,pointerout:Vr},Dc={2:Lt,3:rn,4:wn,5:zn},mf="pointerdown",fo="pointermove pointerup pointercancel";!s&&r.MSPointerEvent&&!r.PointerEvent&&(mf="MSPointerDown",fo="MSPointerMove MSPointerUp MSPointerCancel");function ae(){this.evEl=mf,this.evWin=fo,ne.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}D(ae,ne,{handler:function(Te){var et=this.store,jt=!1,Or=Te.type.toLowerCase().replace("ms",""),Bn=bl[Or],Ji=Dc[Te.pointerType]||Te.pointerType,Bs=Ji==Lt,Hs=ie(et,Te.pointerId,"pointerId");Bn&nn&&(Te.button===0||Bs)?Hs<0&&(et.push(Te),Hs=et.length-1):Bn&(zt|Vr)&&(jt=!0),!(Hs<0)&&(et[Hs]=Te,this.callback(this.manager,Bn,{pointers:et,changedPointers:[Te],pointerType:Ji,srcEvent:Te}),jt&&et.splice(Hs,1))}});var ue={touchstart:nn,touchmove:mn,touchend:zt,touchcancel:Vr},fe="touchstart",Ce="touchstart touchmove touchend touchcancel";function Ne(){this.evTarget=fe,this.evWin=Ce,this.started=!1,ne.apply(this,arguments)}D(Ne,ne,{handler:function(Te){var et=ue[Te.type];if(et===nn&&(this.started=!0),!!this.started){var jt=it.call(this,Te,et);et&(zt|Vr)&&jt[0].length-jt[1].length===0&&(this.started=!1),this.callback(this.manager,et,{pointers:jt[0],changedPointers:jt[1],pointerType:Lt,srcEvent:Te})}}});function it(he,Te){var et=ve(he.touches),jt=ve(he.changedTouches);return Te&(zt|Vr)&&(et=me(et.concat(jt),"identifier",!0)),[et,jt]}var pt={touchstart:nn,touchmove:mn,touchend:zt,touchcancel:Vr},_e="touchstart touchmove touchend touchcancel";function Ge(){this.evTarget=_e,this.targetIds={},ne.apply(this,arguments)}D(Ge,ne,{handler:function(Te){var et=pt[Te.type],jt=wt.call(this,Te,et);!jt||this.callback(this.manager,et,{pointers:jt[0],changedPointers:jt[1],pointerType:Lt,srcEvent:Te})}});function wt(he,Te){var et=ve(he.touches),jt=this.targetIds;if(Te&(nn|mn)&&et.length===1)return jt[et[0].identifier]=!0,[et,et];var Or,Bn,Ji=ve(he.changedTouches),Bs=[],Hs=this.target;if(Bn=et.filter(function(xu){return W(xu.target,Hs)}),Te===nn)for(Or=0;Or<Bn.length;)jt[Bn[Or].identifier]=!0,Or++;for(Or=0;Or<Ji.length;)jt[Ji[Or].identifier]&&Bs.push(Ji[Or]),Te&(zt|Vr)&&delete jt[Ji[Or].identifier],Or++;if(!!Bs.length)return[me(Bn.concat(Bs),"identifier",!0),Bs]}var cr=2500,fr=25;function $t(){ne.apply(this,arguments);var he=$(this.handler,this);this.touch=new Ge(this.manager,he),this.mouse=new iu(this.manager,he),this.primaryTouch=null,this.lastTouches=[]}D($t,ne,{handler:function(Te,et,jt){var Or=jt.pointerType==Lt,Bn=jt.pointerType==wn;if(!(Bn&&jt.sourceCapabilities&&jt.sourceCapabilities.firesTouchEvents)){if(Or)pr.call(this,et,jt);else if(Bn&&cn.call(this,jt))return;this.callback(Te,et,jt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function pr(he,Te){he&nn?(this.primaryTouch=Te.changedPointers[0].identifier,Rr.call(this,Te)):he&(zt|Vr)&&Rr.call(this,Te)}function Rr(he){var Te=he.changedPointers[0];if(Te.identifier===this.primaryTouch){var et={x:Te.clientX,y:Te.clientY};this.lastTouches.push(et);var jt=this.lastTouches,Or=function(){var Bn=jt.indexOf(et);Bn>-1&&jt.splice(Bn,1)};setTimeout(Or,cr)}}function cn(he){for(var Te=he.srcEvent.clientX,et=he.srcEvent.clientY,jt=0;jt<this.lastTouches.length;jt++){var Or=this.lastTouches[jt],Bn=Math.abs(Te-Or.x),Ji=Math.abs(et-Or.y);if(Bn<=fr&&Ji<=fr)return!0}return!1}var Ht=s?i:Re(l.style,"touchAction"),an=Ht!==i,Br="compute",$r="auto",Ln="manipulation",Tr="none",Sn="pan-x",pi="pan-y",oi=Gs();function Pi(he,Te){this.manager=he,this.set(Te)}Pi.prototype={set:function(he){he==Br&&(he=this.compute()),an&&this.manager.element.style&&oi[he]&&(this.manager.element.style[Ht]=he),this.actions=he.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var he=[];return E(this.manager.recognizers,function(Te){j(Te.options.enable,[Te])&&(he=he.concat(Te.getTouchAction()))}),Oi(he.join(" "))},preventDefaults:function(he){var Te=he.srcEvent,et=he.offsetDirection;if(this.manager.session.prevented){Te.preventDefault();return}var jt=this.actions,Or=Q(jt,Tr)&&!oi[Tr],Bn=Q(jt,pi)&&!oi[pi],Ji=Q(jt,Sn)&&!oi[Sn];if(Or){var Bs=he.pointers.length===1,Hs=he.distance<2,xu=he.deltaTime<250;if(Bs&&Hs&&xu)return}if(!(Ji&&Bn)&&(Or||Bn&&et&va||Ji&&et&Va))return this.preventSrc(Te)},preventSrc:function(he){this.manager.session.prevented=!0,he.preventDefault()}};function Oi(he){if(Q(he,Tr))return Tr;var Te=Q(he,Sn),et=Q(he,pi);return Te&&et?Tr:Te||et?Te?Sn:pi:Q(he,Ln)?Ln:$r}function Gs(){if(!an)return!1;var he={};if(s)return he;var Te=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(et){he[et]=Te?r.CSS.supports("touch-action",et):!0}),he}var Qi=1,Ki=2,oa=4,bi=8,Ni=bi,Fs=16,Xu=32;function ho(he){this.options=L({},this.defaults,he||{}),this.id=je(),this.manager=null,this.options.enable=H(this.options.enable,!0),this.state=Qi,this.simultaneous={},this.requireFail=[]}ho.prototype={defaults:{},set:function(he){return L(this.options,he),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(he){if(x(he,"recognizeWith",this))return this;var Te=this.simultaneous;return he=Bc(he,this),Te[he.id]||(Te[he.id]=he,he.recognizeWith(this)),this},dropRecognizeWith:function(he){return x(he,"dropRecognizeWith",this)?this:(he=Bc(he,this),delete this.simultaneous[he.id],this)},requireFailure:function(he){if(x(he,"requireFailure",this))return this;var Te=this.requireFail;return he=Bc(he,this),ie(Te,he)===-1&&(Te.push(he),he.requireFailure(this)),this},dropRequireFailure:function(he){if(x(he,"dropRequireFailure",this))return this;he=Bc(he,this);var Te=ie(this.requireFail,he);return Te>-1&&this.requireFail.splice(Te,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(he){return!!this.simultaneous[he.id]},emit:function(he){var Te=this,et=this.state;function jt(Or){Te.manager.emit(Or,he)}et<bi&&jt(Te.options.event+au(et)),jt(Te.options.event),he.additionalEvent&&jt(he.additionalEvent),et>=bi&&jt(Te.options.event+au(et))},tryEmit:function(he){if(this.canEmit())return this.emit(he);this.state=Xu},canEmit:function(){for(var he=0;he<this.requireFail.length;){if(!(this.requireFail[he].state&(Xu|Qi)))return!1;he++}return!0},recognize:function(he){var Te=L({},he);if(!j(this.options.enable,[this,Te])){this.reset(),this.state=Xu;return}this.state&(Ni|Fs|Xu)&&(this.state=Qi),this.state=this.process(Te),this.state&(Ki|oa|bi|Fs)&&this.tryEmit(Te)},process:function(he){},getTouchAction:function(){},reset:function(){}};function au(he){return he&Fs?"cancel":he&bi?"end":he&oa?"move":he&Ki?"start":""}function bp(he){return he==Ua?"down":he==Ai?"up":he==Si?"left":he==Fn?"right":""}function Bc(he,Te){var et=Te.manager;return et?et.get(he):he}function ya(){ho.apply(this,arguments)}D(ya,ho,{defaults:{pointers:1},attrTest:function(he){var Te=this.options.pointers;return Te===0||he.pointers.length===Te},process:function(he){var Te=this.state,et=he.eventType,jt=Te&(Ki|oa),Or=this.attrTest(he);return jt&&(et&Vr||!Or)?Te|Fs:jt||Or?et&zt?Te|bi:Te&Ki?Te|oa:Ki:Xu}});function yf(){ya.apply(this,arguments),this.pX=null,this.pY=null}D(yf,ya,{defaults:{event:"pan",threshold:10,pointers:1,direction:to},getTouchAction:function(){var he=this.options.direction,Te=[];return he&va&&Te.push(pi),he&Va&&Te.push(Sn),Te},directionTest:function(he){var Te=this.options,et=!0,jt=he.distance,Or=he.direction,Bn=he.deltaX,Ji=he.deltaY;return Or&Te.direction||(Te.direction&va?(Or=Bn===0?On:Bn<0?Si:Fn,et=Bn!=this.pX,jt=Math.abs(he.deltaX)):(Or=Ji===0?On:Ji<0?Ai:Ua,et=Ji!=this.pY,jt=Math.abs(he.deltaY))),he.direction=Or,et&&jt>Te.threshold&&Or&Te.direction},attrTest:function(he){return ya.prototype.attrTest.call(this,he)&&(this.state&Ki||!(this.state&Ki)&&this.directionTest(he))},emit:function(he){this.pX=he.deltaX,this.pY=he.deltaY;var Te=bp(he.direction);Te&&(he.additionalEvent=this.options.event+Te),this._super.emit.call(this,he)}});function Ds(){ya.apply(this,arguments)}D(Ds,ya,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Tr]},attrTest:function(he){return this._super.attrTest.call(this,he)&&(Math.abs(he.scale-1)>this.options.threshold||this.state&Ki)},emit:function(he){if(he.scale!==1){var Te=he.scale<1?"in":"out";he.additionalEvent=this.options.event+Te}this._super.emit.call(this,he)}});function po(){ho.apply(this,arguments),this._timer=null,this._input=null}D(po,ho,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[$r]},process:function(he){var Te=this.options,et=he.pointers.length===Te.pointers,jt=he.distance<Te.threshold,Or=he.deltaTime>Te.time;if(this._input=he,!jt||!et||he.eventType&(zt|Vr)&&!Or)this.reset();else if(he.eventType&nn)this.reset(),this._timer=m(function(){this.state=Ni,this.tryEmit()},Te.time,this);else if(he.eventType&zt)return Ni;return Xu},reset:function(){clearTimeout(this._timer)},emit:function(he){this.state===Ni&&(he&&he.eventType&zt?this.manager.emit(this.options.event+"up",he):(this._input.timeStamp=v(),this.manager.emit(this.options.event,this._input)))}});function _u(){ya.apply(this,arguments)}D(_u,ya,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Tr]},attrTest:function(he){return this._super.attrTest.call(this,he)&&(Math.abs(he.rotation)>this.options.threshold||this.state&Ki)}});function Za(){ya.apply(this,arguments)}D(Za,ya,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:va|Va,pointers:1},getTouchAction:function(){return yf.prototype.getTouchAction.call(this)},attrTest:function(he){var Te=this.options.direction,et;return Te&(va|Va)?et=he.overallVelocity:Te&va?et=he.overallVelocityX:Te&Va&&(et=he.overallVelocityY),this._super.attrTest.call(this,he)&&Te&he.offsetDirection&&he.distance>this.options.threshold&&he.maxPointers==this.options.pointers&&p(et)>this.options.velocity&&he.eventType&zt},emit:function(he){var Te=bp(he.offsetDirection);Te&&this.manager.emit(this.options.event+Te,he),this.manager.emit(this.options.event,he)}});function Pu(){ho.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}D(Pu,ho,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ln]},process:function(he){var Te=this.options,et=he.pointers.length===Te.pointers,jt=he.distance<Te.threshold,Or=he.deltaTime<Te.time;if(this.reset(),he.eventType&nn&&this.count===0)return this.failTimeout();if(jt&&Or&&et){if(he.eventType!=zt)return this.failTimeout();var Bn=this.pTime?he.timeStamp-this.pTime<Te.interval:!0,Ji=!this.pCenter||Li(this.pCenter,he.center)<Te.posThreshold;this.pTime=he.timeStamp,this.pCenter=he.center,!Ji||!Bn?this.count=1:this.count+=1,this._input=he;var Bs=this.count%Te.taps;if(Bs===0)return this.hasRequireFailures()?(this._timer=m(function(){this.state=Ni,this.tryEmit()},Te.interval,this),Ki):Ni}return Xu},failTimeout:function(){return this._timer=m(function(){this.state=Xu},this.options.interval,this),Xu},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ni&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function bo(he,Te){return Te=Te||{},Te.recognizers=H(Te.recognizers,bo.defaults.preset),new _h(he,Te)}bo.VERSION="2.0.7",bo.defaults={domEvents:!1,touchAction:Br,enable:!0,inputTarget:null,inputClass:null,preset:[[_u,{enable:!1}],[Ds,{enable:!1},["rotate"]],[Za,{direction:va}],[yf,{direction:va},["swipe"]],[Pu],[Pu,{event:"doubletap",taps:2},["tap"]],[po]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var yh=1,Yu=2;function _h(he,Te){this.options=L({},bo.defaults,Te||{}),this.options.inputTarget=this.options.inputTarget||he,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=he,this.input=Qt(this),this.touchAction=new Pi(this,this.options.touchAction),wl(this,!0),E(this.options.recognizers,function(et){var jt=this.add(new et[0](et[1]));et[2]&&jt.recognizeWith(et[2]),et[3]&&jt.requireFailure(et[3])},this)}_h.prototype={set:function(he){return L(this.options,he),he.touchAction&&this.touchAction.update(),he.inputTarget&&(this.input.destroy(),this.input.target=he.inputTarget,this.input.init()),this},stop:function(he){this.session.stopped=he?Yu:yh},recognize:function(he){var Te=this.session;if(!Te.stopped){this.touchAction.preventDefaults(he);var et,jt=this.recognizers,Or=Te.curRecognizer;(!Or||Or&&Or.state&Ni)&&(Or=Te.curRecognizer=null);for(var Bn=0;Bn<jt.length;)et=jt[Bn],Te.stopped!==Yu&&(!Or||et==Or||et.canRecognizeWith(Or))?et.recognize(he):et.reset(),!Or&&et.state&(Ki|oa|bi)&&(Or=Te.curRecognizer=et),Bn++}},get:function(he){if(he instanceof ho)return he;for(var Te=this.recognizers,et=0;et<Te.length;et++)if(Te[et].options.event==he)return Te[et];return null},add:function(he){if(x(he,"add",this))return this;var Te=this.get(he.options.event);return Te&&this.remove(Te),this.recognizers.push(he),he.manager=this,this.touchAction.update(),he},remove:function(he){if(x(he,"remove",this))return this;if(he=this.get(he),he){var Te=this.recognizers,et=ie(Te,he);et!==-1&&(Te.splice(et,1),this.touchAction.update())}return this},on:function(he,Te){if(he!==i&&Te!==i){var et=this.handlers;return E(te(he),function(jt){et[jt]=et[jt]||[],et[jt].push(Te)}),this}},off:function(he,Te){if(he!==i){var et=this.handlers;return E(te(he),function(jt){Te?et[jt]&&et[jt].splice(ie(et[jt],Te),1):delete et[jt]}),this}},emit:function(he,Te){this.options.domEvents&&ws(he,Te);var et=this.handlers[he]&&this.handlers[he].slice();if(!(!et||!et.length)){Te.type=he,Te.preventDefault=function(){Te.srcEvent.preventDefault()};for(var jt=0;jt<et.length;)et[jt](Te),jt++}},destroy:function(){this.element&&wl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function wl(he,Te){var et=he.element;if(!!et.style){var jt;E(he.options.cssProps,function(Or,Bn){jt=Re(et.style,Bn),Te?(he.oldCssProps[jt]=et.style[jt],et.style[jt]=Or):et.style[jt]=he.oldCssProps[jt]||""}),Te||(he.oldCssProps={})}}function ws(he,Te){if(!s){var et=t.createEvent("Event");et.initEvent(he,!0,!0),et.gesture=Te,Te.target.dispatchEvent(et)}}if(!s){L(bo,{INPUT_START:nn,INPUT_MOVE:mn,INPUT_END:zt,INPUT_CANCEL:Vr,STATE_POSSIBLE:Qi,STATE_BEGAN:Ki,STATE_CHANGED:oa,STATE_ENDED:bi,STATE_RECOGNIZED:Ni,STATE_CANCELLED:Fs,STATE_FAILED:Xu,DIRECTION_NONE:On,DIRECTION_LEFT:Si,DIRECTION_RIGHT:Fn,DIRECTION_UP:Ai,DIRECTION_DOWN:Ua,DIRECTION_HORIZONTAL:va,DIRECTION_VERTICAL:Va,DIRECTION_ALL:to,Manager:_h,Input:ne,TouchAction:Pi,TouchInput:Ge,MouseInput:iu,PointerEventInput:ae,TouchMouseInput:$t,SingleTouchInput:Ne,Recognizer:ho,AttrRecognizer:ya,Tap:Pu,Pan:yf,Swipe:Za,Pinch:Ds,Rotate:_u,Press:po,on:ee,off:U,each:E,merge:R,extend:k,assign:L,inherit:D,bindFn:$,prefixed:Re});var Ru=typeof window!="undefined"?window:typeof self!="undefined"?self:{};Ru.Hammer=bo,typeof i=="function"&&i.amd?i(function(){return bo}):e.exports?e.exports=bo:r[n]=bo}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")})(yne);var qw=yne.exports,Sc;(function(e){e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag"})(Sc||(Sc={}));var pU,dU,vU,aO,gU;function oNe(e){var r=sNe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function sNe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var uNe={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},lNe=(pU=Ri(),dU=ba(Mt.IMapService),pU(vU=(aO=function(e){er(t,e);var r=oNe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"indragging",!1),ua(He(n),"mapService",gU,He(n)),X(He(n),"hammertime",void 0),X(He(n),"lastClickTime",0),X(He(n),"lastClickXY",[-1,-1]),X(He(n),"clickTimer",void 0),X(He(n),"$containter",void 0),X(He(n),"onDrag",function(s){var u=n.interactionEvent(s);u.type=uNe[u.type],u.type==="dragging"?n.indragging=!0:n.indragging=!1,n.emit(Sc.Drag,u)}),X(He(n),"onHammer",function(s){s.srcEvent.stopPropagation();var u=n.interactionEvent(s);n.emit(Sc.Hover,u)}),X(He(n),"onTouch",function(s){var u=s.touches[0];n.onHover({x:u.pageX,y:u.pageY,type:"touch"})}),X(He(n),"onHover",function(s){var u=s.clientX,l=s.clientY,f=u,h=l,p=s.type,v=n.mapService.getMapContainer();if(v)if(ns)f=f-v.left-0,h=h-v.top-0;else{var m=v.getBoundingClientRect(),x=m.top,E=m.left;f=f-E-v.clientLeft,h=h-x-v.clientTop}var A=n.mapService.containerToLngLat([f,h]);if(p==="click"){if(!ns&&"ontouchstart"in document.documentElement)return;n.isDoubleTap(f,h,A);return}if(p==="touch"){n.isDoubleTap(f,h,A);return}p!=="click"&&p!=="dblclick"&&n.emit(Sc.Hover,{x:f,y:h,lngLat:A,type:p,target:s})}),n}return ot(t,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Sc.Hover)}},{key:"triggerHover",value:function(i){var a=i.x,o=i.y;this.emit(Sc.Hover,{x:a,y:o})}},{key:"triggerSelect",value:function(i){this.emit(Sc.Select,{featureId:i})}},{key:"triggerActive",value:function(i){this.emit(Sc.Active,{featureId:i})}},{key:"handleMiniEvent",value:function(i){this.onHover({clientX:i.touches[0].pageX,clientY:i.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var i=this.mapService.getMapContainer();if(i)if(ns)Hn.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var a=new qw.Manager(i);a.add(new qw.Tap({event:"dblclick",taps:2})),a.add(new qw.Tap({event:"click"})),a.add(new qw.Pan({threshold:0,pointers:0})),a.add(new qw.Press({})),a.on("dblclick click",this.onHammer),a.on("panstart panmove panend pancancel",this.onDrag),i.addEventListener("mousemove",this.onHover),i.addEventListener("mousedown",this.onHover,!0),i.addEventListener("mouseup",this.onHover),i.addEventListener("contextmenu",this.onHover),this.hammertime=a}}},{key:"removeEventListenerOnMap",value:function(){if(ns)Hn.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var i=this.mapService.getMapContainer();i&&(i.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),i.removeEventListener("mousedown",this.onHover),i.removeEventListener("mouseup",this.onHover),i.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(i){var a=i.type,o=i.pointerType,s,u;o==="touch"?(u=Math.floor(i.pointers[0].clientY),s=Math.floor(i.pointers[0].clientX)):(u=Math.floor(i.srcEvent.y),s=Math.floor(i.srcEvent.x));var l=this.mapService.getMapContainer();if(l){var f=l.getBoundingClientRect(),h=f.top,p=f.left;s-=p,u-=h}var v=this.mapService.containerToLngLat([s,u]);return{x:s,y:u,lngLat:v,type:a,target:i.srcEvent}}},{key:"isDoubleTap",value:function(i,a,o){var s=this,u=new Date().getTime(),l="click";u-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-i)<10&&Math.abs(this.lastClickXY[1]-a)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),l="dblclick",this.emit(Sc.Hover,{x:i,y:a,lngLat:o,type:l})):(this.lastClickTime=u,this.lastClickXY=[i,a],this.clickTimer=setTimeout(function(){l="click",s.emit(Sc.Hover,{x:i,y:a,lngLat:o,type:l})},400))}}]),t}(_B),gU=ia(aO.prototype,"mapService",[dU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aO))||vU),cNe=0;function fNe(e){if(ns)return null;var r=e;if(typeof e=="string"&&(r=document.getElementById(e)),r){var t=document.createElement("div");return t.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,t.id="l7-scene-".concat(cNe++),t.classList.add("l7-scene"),r.appendChild(t),t}return null}function hNe(e){var r,t,n=!0;return e==null||(r=e.target)===null||r===void 0||(t=r.path)===null||t===void 0||t.map(function(i){if(i!=null&&i.classList){var a;i==null||(a=i.classList)===null||a===void 0||a.forEach(function(o){(o==="l7-marker"||o==="l7-popup")&&(n=!1)})}}),n}var K;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(K||(K={}));var mU,yU,_U,xU,bU,wU,CU,lx,EU,SU,AU,TU,MU,pNe=(mU=Ri(),yU=ba(Mt.IMapService),_U=ba(Mt.IRendererService),xU=ba(Mt.IGlobalConfigService),bU=ba(Mt.IInteractionService),wU=ba(Mt.ILayerService),mU(CU=(lx=function(){function e(){var r=this;st(this,e),X(this,"pickedColors",void 0),X(this,"pickedTileLayers",[]),ua(this,"mapService",EU,this),ua(this,"rendererService",SU,this),ua(this,"configService",AU,this),ua(this,"interactionService",TU,this),ua(this,"layerService",MU,this),X(this,"pickingFBO",void 0),X(this,"width",0),X(this,"height",0),X(this,"alreadyInPicking",!1),X(this,"pickBufferScale",1),X(this,"pickFromPickingFBO",function(t,n){var i=n.x,a=n.y,o=n.lngLat,s=n.type,u=n.target,l=!1,f=r.rendererService,h=f.readPixels,p=f.getContainer,v=r.getContainerSize(p()),m=v.width,x=v.height;m*=pu,x*=pu;var E=t.getLayerConfig(),A=E.enableHighlight,L=E.enableSelect,k=i*pu,R=a*pu;if(k>m-1*pu||k<0||R>x-1*pu||R<0)return!1;var D=h({x:Math.floor(k/r.pickBufferScale),y:Math.floor((x-(a+1)*pu)/r.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:r.pickingFBO});if(r.pickedColors=D,D[0]!==0||D[1]!==0||D[2]!==0){var $=dy(D),j=t.getSource().getFeatureById($);$!==t.getCurrentPickId()&&s==="mousemove"&&(s="mouseenter");var H={x:i,y:a,type:s,lngLat:o,featureId:$,feature:j,target:u};j&&(l=!0,t.setCurrentPickId($),r.triggerHoverOnLayer(t,H))}else{var ee={x:i,y:a,lngLat:o,type:t.getCurrentPickId()!==null&&s==="mousemove"?"mouseout":"un"+s,featureId:null,target:u,feature:null};r.triggerHoverOnLayer(t,Et(Et({},ee),{},{type:"unpick"})),r.triggerHoverOnLayer(t,ee),t.setCurrentPickId(null)}if(A&&r.highlightPickedFeature(t,D),L&&s==="click"&&(D==null?void 0:D.toString())!==[0,0,0,0].toString()){var U=dy(D);t.getCurrentSelectedId()===null||U!==t.getCurrentSelectedId()?(r.selectFeature(t,D),t.setCurrentSelectedId(U)):(r.selectFeature(t,new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null)),t.isVector||r.layerService.getLayers().filter(function(W){return W.tileLayer}).map(function(W){W.tileLayer.clearPickState()})}return l})}return ot(e,[{key:"init",value:function(t){var n=this.rendererService,i=n.createTexture2D,a=n.createFramebuffer,o=n.getContainer,s=this.getContainerSize(o()),u=s.width,l=s.height;u*=pu,l*=pu,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=a({color:i({width:Math.round(u/this.pickBufferScale),height:Math.round(l/this.pickBufferScale),wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})}),this.interactionService.on(Sc.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var r=Hi(Xr.mark(function n(i,a,o){var s=this,u,l,f;return Xr.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:u=this.rendererService,l=u.useFramebuffer,f=u.clear,this.resizePickingFBO(),l(this.pickingFBO,function(){f({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.hooks.beforePickingEncode.call(),i.renderModels(),i.hooks.afterPickingEncode.call();var v=s.pickBox(i,a);o(v)});case 3:case"end":return p.stop()}},n,this)}));function t(n,i,a){return r.apply(this,arguments)}return t}()},{key:"pickBox",value:function(t,n){var i=this,a=n.map(function(U){var W=U<0?0:U;return Math.floor(W*pu/i.pickBufferScale)}),o=tn(a,4),s=o[0],u=o[1],l=o[2],f=o[3],h=this.rendererService,p=h.readPixels,v=h.getContainer,m=this.getContainerSize(v()),x=m.width,E=m.height;if(x*=pu,E*=pu,s>(x-1)*pu/this.pickBufferScale||l<0||u>(E-1)*pu/this.pickBufferScale||f<0)return[];for(var A=Math.min(x/this.pickBufferScale,l)-s,L=Math.min(E/this.pickBufferScale,f)-u,k=p({x:s,y:Math.floor(E/this.pickBufferScale-(f+1)),width:A,height:L,data:new Uint8Array(A*L*4),framebuffer:this.pickingFBO}),R=[],D={},$=0;$<k.length/4;$=$+1){var j=k.slice($*4,$*4+4),H=dy(j);if(H!==-1&&!D[H]){var ee=t.getSource().getFeatureById(H);R.push(Et(Et({},ee),{},{pickedFeatureIdx:H})),D[H]=!0}}return R}},{key:"handleCursor",value:function(t,n){var i=t.getLayerConfig(),a=i.cursor,o=a===void 0?"":a,s=i.cursorEnabled;if(s){var u=this.mapService.version,l=u==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),f=l==null?void 0:l.style.getPropertyValue("cursor");n==="unmousemove"&&f!==""?l==null||l.style.setProperty("cursor",""):n==="mousemove"&&(l==null||l.style.setProperty("cursor",o))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(t){return t.getContext?{width:t.width/pu,height:t.height/pu}:t.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var r=Hi(Xr.mark(function n(i){return Xr.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.isPickingAllLayer()){o.next=2;break}return o.abrupt("return");case 2:return this.alreadyInPicking=!0,o.next=5,this.pickingLayers(i);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return o.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var t=this.rendererService.getContainer,n=this.getContainerSize(t()),i=n.width,a=n.height;i*=pu,a*=pu,(this.width!==i||this.height!==a)&&(this.pickingFBO.resize({width:Math.round(i/this.pickBufferScale),height:Math.round(a/this.pickBufferScale)}),this.width=i,this.height=a)}},{key:"pickingLayers",value:function(){var r=Hi(Xr.mark(function n(i){var a=this,o,s,u;return Xr.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o=this.rendererService,s=o.useFramebuffer,u=o.clear,this.resizePickingFBO(),s(this.pickingFBO,function(){var h=a.layerService.getRenderList();h.filter(function(p){return p.needPick(i.type)}).reverse().some(function(p){if(u({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),a.pickedTileLayers.map(function(m){var x;return(x=m.tileLayer)===null||x===void 0?void 0:x.clearPick(i.type)}),p.tileLayer&&p.tileLayer.pickLayers)return p.tileLayer.pickLayers(i);p.hooks.beforePickingEncode.call(),p.masks.length>0&&p.masks.map(function(m){m.hooks.beforeRenderData.call(),m.hooks.beforeRender.call(),m.render(),m.hooks.afterRender.call()}),p.renderModels(!0),p.hooks.afterPickingEncode.call();var v=a.pickFromPickingFBO(p,i);return a.layerService.pickedLayerId=v?+p.id:-1,v&&!p.getLayerConfig().enablePropagation})});case 3:case"end":return f.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"triggerHoverOnLayer",value:function(t,n){hNe(n)&&(this.handleCursor(t,n.type),t.emit(n.type,n))}},{key:"highlightPickedFeature",value:function(t,n){var i=tn(n,3),a=i[0],o=i[1],s=i[2];t.hooks.beforeHighlight.call([a,o,s])}},{key:"selectFeature",value:function(t,n){var i=tn(n,3),a=i[0],o=i[1],s=i[2];t.hooks.beforeSelect.call([a,o,s])}}]),e}(),EU=ia(lx.prototype,"mapService",[yU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SU=ia(lx.prototype,"rendererService",[_U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AU=ia(lx.prototype,"configService",[xU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TU=ia(lx.prototype,"interactionService",[bU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MU=ia(lx.prototype,"layerService",[wU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lx))||CU),dNe=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;st(this,e),X(this,"autoStart",void 0),X(this,"startTime",0),X(this,"oldTime",0),X(this,"running",!1),X(this,"elapsedTime",0),this.autoStart=r}return ot(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();t=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=t}return t}}]),e}(),LU,IU,kU,PU,pT,RU,OU;function vNe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=gNe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function gNe(e,r){if(!!e){if(typeof e=="string")return FU(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return FU(e,r)}}function FU(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var mNe=(LU=Ri(),IU=ba(Mt.IRendererService),kU=ba(Mt.IMapService),LU(PU=(pT=function(){function e(){var r=this;st(this,e),X(this,"pickedLayerId",-1),X(this,"clock",new dNe),X(this,"alreadyInRendering",!1),X(this,"layers",[]),X(this,"layerList",[]),X(this,"layerRenderID",void 0),X(this,"sceneInited",!1),X(this,"animateInstanceCount",0),X(this,"shaderPicking",!0),X(this,"enableRender",!0),ua(this,"renderService",RU,this),ua(this,"mapService",OU,this),X(this,"reRender",Kt.exports.throttle(function(){r.updateLayerRenderList(),r.renderLayers()},32)),X(this,"throttleRenderLayers",Kt.exports.throttle(function(){r.renderLayers()},16))}return ot(e,[{key:"add",value:function(t){this.sceneInited&&t.init(),this.layers.push(t),this.updateLayerRenderList()}},{key:"addMask",value:function(t){this.sceneInited&&t.init()}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(t){t.inited||t.init()}),this.updateLayerRenderList()}},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(t){return this.layers.find(function(n){return n.id===t})}},{key:"getLayerByName",value:function(t){return this.layers.find(function(n){return n.name===t})}},{key:"cleanRemove",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=this.layers.indexOf(t);i>-1&&this.layers.splice(i,1),n&&this.throttleRenderLayers()}},{key:"remove",value:function(t,n){if(n){var i=n.layerChildren.indexOf(t);i>-1&&n.layerChildren.splice(i,1)}else{var a=this.layers.indexOf(t);a>-1&&this.layers.splice(a,1)}this.updateLayerRenderList(),t.destroy()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"setEnableRender",value:function(t){this.enableRender=t}},{key:"renderLayers",value:function(){var r=Hi(Xr.mark(function n(){var i,a,o;return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){u.next=2;break}return u.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),i=vNe(this.layerList),u.prev=5,i.s();case 7:if((a=i.n()).done){u.next=21;break}if(o=a.value,o.hooks.beforeRenderData.call(),o.hooks.beforeRender.call(),o.masks.length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),o.masks.map(function(l){l.hooks.beforeRenderData.call(),l.hooks.beforeRender.call(),l.render(),l.hooks.afterRender.call()})),!o.getLayerConfig().enableMultiPassRenderer){u.next=17;break}return u.next=15,o.renderMultiPass();case 15:u.next=18;break;case 17:o.render();case 18:o.hooks.afterRender.call();case 19:u.next=7;break;case 21:u.next=26;break;case 23:u.prev=23,u.t0=u.catch(5),i.e(u.t0);case 26:return u.prev=26,i.f(),u.finish(26);case 29:this.alreadyInRendering=!1;case 30:case"end":return u.stop()}},n,this,[[5,23,26,29]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"updateLayerRenderList",value:function(){var t=this;this.layerList=[],this.layers.filter(function(n){return n.inited}).filter(function(n){return n.isVisible()}).sort(function(n,i){return n.zIndex-i.zIndex}).forEach(function(n){t.layerList.push(n)})}},{key:"destroy",value:function(){this.layers.forEach(function(t){t.destroy()}),this.layers=[],this.layerList=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var t=Sa(this.mapService.bgColor);this.renderService.clear({color:t,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=Hn.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){Hn.cancelAnimationFrame(this.layerRenderID)}}]),e}(),RU=ia(pT.prototype,"renderService",[IU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OU=ia(pT.prototype,"mapService",[kU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pT))||PU),yNe=function(){function e(r){var t=this;st(this,e),X(this,"name",void 0),X(this,"type",void 0),X(this,"scale",void 0),X(this,"descriptor",void 0),X(this,"featureBufferLayout",[]),X(this,"needRescale",!1),X(this,"needRemapping",!1),X(this,"needRegenerateVertices",!1),X(this,"featureRange",{startIndex:0,endIndex:1/0}),X(this,"vertexAttribute",void 0),X(this,"defaultCallback",function(n){if(n.length===0){var i;return((i=t.scale)===null||i===void 0?void 0:i.defaultValues)||[]}return n.map(function(a,o){var s,u=(s=t.scale)===null||s===void 0?void 0:s.scalers[o].func,l=u(a);return l})}),this.setProps(r)}return ot(e,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var n;if((n=this.scale)!==null&&n!==void 0&&n.callback){var i,a=(i=this.scale)===null||i===void 0?void 0:i.callback.apply(i,Pr(t));if(!Kt.exports.isNil(a))return[a]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),_Ne=["modelType"],xNe=["buffer","update","name"],bNe=["buffer","update","name"],wNe=["buffer","update","name"],Kw,DU,BU,NU,oO,zU,CNe=(Kw={},X(Kw,K.FLOAT,4),X(Kw,K.UNSIGNED_BYTE,1),X(Kw,K.UNSIGNED_SHORT,2),Kw),ENe=(DU=Ri(),BU=ba(Mt.IRendererService),DU(NU=(oO=function(){function e(){st(this,e),X(this,"attributesAndIndices",void 0),ua(this,"rendererService",zU,this),X(this,"attributes",[]),X(this,"triangulation",void 0),X(this,"featureLayout",{sizePerElement:0,elements:[]})}return ot(e,[{key:"registerStyleAttribute",value:function(t){var n=this.getLayerStyleAttribute(t.name||"");return n?n.setProps(t):(n=new yNe(t),this.attributes.push(n)),n}},{key:"updateStyleAttribute",value:function(t,n,i){var a=this.getLayerStyleAttribute(t);a||(a=this.registerStyleAttribute(Et(Et({},n),{},{name:t})));var o=n.scale;o&&a&&(a.scale=o,a.needRescale=!0,a.needRemapping=!0,a.needRegenerateVertices=!0,i&&i.featureRange&&(a.featureRange=i.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find(function(n){return n.name===t})}},{key:"getLayerAttributeScale",value:function(t){var n,i=this.getLayerStyleAttribute(t),a=i==null||(n=i.scale)===null||n===void 0?void 0:n.scalers;return a&&a[0]?a[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,s=this.attributes.find(function(D){return D.name===t});if(s&&s.descriptor){var u=s.descriptor,l=u.update,f=u.buffer,h=u.size,p=h===void 0?0:h,v=CNe[f.type||K.FLOAT];if(l){var m=this.featureLayout,x=m.elements,E=m.sizePerElement,A=x.slice(i,a);if(!A.length)return;var L=A[0].offset,k=L*p*v,R=A.map(function(D,$){for(var j=D.featureIdx,H=D.vertices,ee=D.normals,U=H.length/E,W=[],Q=0;Q<U;Q++){var te=ee?ee.slice(Q*3,Q*3+3):[];W.push.apply(W,Pr(l(n[j],j,H.slice(Q*E,Q*E+E),$,te)))}return W}).reduce(function(D,$){return D.push.apply(D,Pr($)),D},[]);s.vertexAttribute.updateBuffer({data:R,offset:k}),o==null||o.emit("legend:".concat(t),{type:t,attr:s})}}}},{key:"createAttributesAndIndicesAscy",value:function(t,n,i){var a=this;this.featureLayout={sizePerElement:0,elements:[]};var o=this.attributes.map(function(m){return m.resetDescriptor(),m.descriptor}).filter(function(m){return m}),s=i.modelType,u=oc(i,_Ne),l=this.rendererService,f=l.createAttribute,h=l.createBuffer,p=l.createElements,v={};return new Promise(function(m,x){one(s,Et({descriptors:a.getDescriptorsWithOutFunc(o),features:t,segmentNumber:n},u)).then(function(E){E.descriptors.forEach(function(L,k){if(L){var R=L.buffer;L.update,L.name;var D=oc(L,xNe),$=f(Et({buffer:h(R)},D));v[L.name||""]=$,a.attributes[k].vertexAttribute=$}}),a.featureLayout=E.featureLayout;var A=p({data:E.indices,type:K.UNSIGNED_INT,count:E.indices.length});a.attributesAndIndices={attributes:v,elements:A,count:null},m(a.attributesAndIndices)}).catch(function(E){console.warn(E),x(E)})})}},{key:"createAttributesAndIndices",value:function(t,n,i){var a=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var o=this.attributes.map(function(A){return A.resetDescriptor(),A.descriptor}),s=0,u=0,l=[],f=3;t.forEach(function(A,L){var k=a.triangulation(A,i),R=k.indices,D=k.vertices,$=k.normals,j=k.size,H=k.indexes,ee=k.count;typeof ee=="number"&&(u+=ee),R.forEach(function(te){l.push(te+s)}),f=j;var U=D.length/j;a.featureLayout.sizePerElement=f,a.featureLayout.elements.push({featureIdx:L,vertices:D,normals:$,offset:s}),s+=U;for(var W=function(ie){var ve=($==null?void 0:$.slice(ie*3,ie*3+3))||[],me=D.slice(ie*j,ie*j+j),Re=0;H&&H[ie]!==void 0&&(Re=H[ie]),o.forEach(function(We,je){if(We&&We.update){var lt;(lt=We.buffer.data).push.apply(lt,Pr(We.update(A,L,me,ie,ve,Re)))}})},Q=0;Q<U;Q++)W(Q)});var h=this.rendererService,p=h.createAttribute,v=h.createBuffer,m=h.createElements,x={};o.forEach(function(A,L){if(A){var k=A.buffer;A.update,A.name;var R=oc(A,bNe),D=p(Et({buffer:v(k)},R));x[A.name||""]=D,a.attributes[L].vertexAttribute=D}});var E=m({data:l,type:K.UNSIGNED_INT,count:l.length});return this.attributesAndIndices={attributes:x,elements:E,count:u},this.attributesAndIndices}},{key:"createAttributes",value:function(t,n){var i=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var a=this.attributes.map(function(p){return p.resetDescriptor(),p.descriptor}),o=0,s=3;t.forEach(function(p,v){var m=i.triangulation(p),x=m.indices,E=m.vertices,A=m.normals,L=m.size,k=m.indexes;x.forEach(function(j){}),s=L;var R=E.length/L;i.featureLayout.sizePerElement=s,i.featureLayout.elements.push({featureIdx:v,vertices:E,normals:A,offset:o}),o+=R;for(var D=function(H){var ee=(A==null?void 0:A.slice(H*3,H*3+3))||[],U=E.slice(H*L,H*L+L),W=0;k&&k[H]!==void 0&&(W=k[H]),a.forEach(function(Q,te){if(Q&&Q.update){var ie;(ie=Q.buffer.data).push.apply(ie,Pr(Q.update(p,v,U,H,ee,W)))}})},$=0;$<R;$++)D($)});var u=this.rendererService,l=u.createAttribute,f=u.createBuffer,h={};return a.forEach(function(p,v){if(p){var m=p.buffer;p.update,p.name;var x=oc(p,wNe),E=l(Et({buffer:f(m)},x));h[p.name||""]=E,i.attributes[v].vertexAttribute=E}}),{attributes:h}}},{key:"clearAllAttributes",value:function(){var t;this.attributes.forEach(function(n){n.vertexAttribute&&n.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}},{key:"getDescriptorsWithOutFunc",value:function(t){return t.map(function(n){return{buffer:n.buffer,name:n.name,size:n.size}})}}]),e}(),zU=ia(oO.prototype,"rendererService",[BU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oO))||NU);function SNe(e,r,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(h){o(h)}}function u(f){try{l(n.throw(f))}catch(h){o(h)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(e,r||[])).next())})}function ANe(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=r.call(e,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function YB(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return a}function ZB(e,r,t){if(t||arguments.length===2)for(var n=0,i=r.length,a;n<i;n++)(a||!(n in r))&&(a||(a=Array.prototype.slice.call(r,0,n)),a[n]=r[n]);return e.concat(a||Array.prototype.slice.call(r))}function qB(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var oD={exports:{}},hL={exports:{}},zE={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=t;function t(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}e.exports=r.default})(zE,zE.exports);var cp={},sD={exports:{}},uD={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){return function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];var a=n.pop();return t.call(this,n,a)}},e.exports=r.default})(uD,uD.exports);var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.fallback=_ne;w_.wrap=xne;var TNe=w_.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,MNe=w_.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,LNe=w_.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function _ne(e){setTimeout(e,0)}function xne(e){return function(r){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return e(function(){return r.apply(void 0,t)})}}var AC;TNe?AC=queueMicrotask:MNe?AC=setImmediate:LNe?AC=process.nextTick:AC=_ne;w_.default=xne(AC);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=u;var t=uD.exports,n=s(t),i=w_,a=s(i),o=cp;function s(h){return h&&h.__esModule?h:{default:h}}function u(h){return(0,o.isAsync)(h)?function(){for(var p=[],v=arguments.length;v--;)p[v]=arguments[v];var m=p.pop(),x=h.apply(this,p);return l(x,m)}:(0,n.default)(function(p,v){var m;try{m=h.apply(this,p)}catch(x){return v(x)}if(m&&typeof m.then=="function")return l(m,v);v(null,m)})}function l(h,p){return h.then(function(v){f(p,null,v)},function(v){f(p,v&&v.message?v:new Error(v))})}function f(h,p,v){try{h(p,v)}catch(m){(0,a.default)(function(x){throw x},m)}}e.exports=r.default})(sD,sD.exports);Object.defineProperty(cp,"__esModule",{value:!0});cp.isAsyncIterable=cp.isAsyncGenerator=cp.isAsync=void 0;var INe=sD.exports,kNe=PNe(INe);function PNe(e){return e&&e.__esModule?e:{default:e}}function bne(e){return e[Symbol.toStringTag]==="AsyncFunction"}function RNe(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function ONe(e){return typeof e[Symbol.asyncIterator]=="function"}function FNe(e){if(typeof e!="function")throw new Error("expected a function");return bne(e)?(0,kNe.default)(e):e}cp.default=FNe;cp.isAsync=bne;cp.isAsyncGenerator=RNe;cp.isAsyncIterable=ONe;var o1={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=t;function t(n,i){if(i===void 0&&(i=n.length),!i)throw new Error("arity is undefined");function a(){for(var o=this,s=[],u=arguments.length;u--;)s[u]=arguments[u];return typeof s[i-1]=="function"?n.apply(this,s):new Promise(function(l,f){s[i-1]=function(h){for(var p=[],v=arguments.length-1;v-- >0;)p[v]=arguments[v+1];if(h)return f(h);l(p.length>1?p:p[0])},n.apply(o,s)})}return a}e.exports=r.default})(o1,o1.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=zE.exports,n=u(t),i=cp,a=u(i),o=o1.exports,s=u(o);function u(l){return l&&l.__esModule?l:{default:l}}r.default=(0,s.default)(function(l,f,h){var p=(0,n.default)(f)?[]:{};l(f,function(v,m,x){(0,a.default)(v)(function(E){for(var A,L=[],k=arguments.length-1;k-- >0;)L[k]=arguments[k+1];L.length<2&&(A=L,L=A[0]),p[m]=L,x(E)})},function(v){return h(v,p)})},3),e.exports=r.default})(hL,hL.exports);var lD={exports:{}},pL={exports:{}},cD={exports:{}},$E={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=t;function t(n){function i(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];if(n!==null){var s=n;n=null,s.apply(this,a)}}return Object.assign(i,n),i}e.exports=r.default})($E,$E.exports);var fD={exports:{}},hD={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},e.exports=r.default})(hD,hD.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=f;var t=zE.exports,n=o(t),i=hD.exports,a=o(i);function o(h){return h&&h.__esModule?h:{default:h}}function s(h){var p=-1,v=h.length;return function(){return++p<v?{value:h[p],key:p}:null}}function u(h){var p=-1;return function(){var m=h.next();return m.done?null:(p++,{value:m.value,key:p})}}function l(h){var p=h?Object.keys(h):[],v=-1,m=p.length;return function x(){var E=p[++v];return E==="__proto__"?x():v<m?{value:h[E],key:E}:null}}function f(h){if((0,n.default)(h))return s(h);var p=(0,a.default)(h);return p?u(p):l(h)}e.exports=r.default})(fD,fD.exports);var UE={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=t;function t(n){return function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];if(n===null)throw new Error("Callback was already called.");var o=n;n=null,o.apply(this,i)}}e.exports=r.default})(UE,UE.exports);var pD={exports:{}},VE={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t={};r.default=t,e.exports=r.default})(VE,VE.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=a;var t=VE.exports,n=i(t);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,u,l){var f=!1,h=!1,p=!1,v=0,m=0;function x(){v>=s||p||f||(p=!0,o.next().then(function(L){var k=L.value,R=L.done;if(!(h||f)){if(p=!1,R){f=!0,v<=0&&l(null);return}v++,u(k,m,E),m++,x()}}).catch(A))}function E(L,k){if(v-=1,!h){if(L)return A(L);if(L===!1){f=!0,h=!0;return}if(k===n.default||f&&v<=0)return f=!0,l(null);x()}}function A(L){h||(p=!1,f=!0,l(L))}x()}e.exports=r.default})(pD,pD.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=$E.exports,n=v(t),i=fD.exports,a=v(i),o=UE.exports,s=v(o),u=cp,l=pD.exports,f=v(l),h=VE.exports,p=v(h);function v(m){return m&&m.__esModule?m:{default:m}}r.default=function(m){return function(x,E,A){if(A=(0,n.default)(A),m<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!x)return A(null);if((0,u.isAsyncGenerator)(x))return(0,f.default)(x,m,E,A);if((0,u.isAsyncIterable)(x))return(0,f.default)(x[Symbol.asyncIterator](),m,E,A);var L=(0,a.default)(x),k=!1,R=!1,D=0,$=!1;function j(ee,U){if(!R)if(D-=1,ee)k=!0,A(ee);else if(ee===!1)k=!0,R=!0;else{if(U===p.default||k&&D<=0)return k=!0,A(null);$||H()}}function H(){for($=!0;D<m&&!k;){var ee=L();if(ee===null){k=!0,D<=0&&A(null);return}D+=1,E(ee.value,ee.key,(0,s.default)(j))}$=!1}H()}},e.exports=r.default})(cD,cD.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=cD.exports,n=u(t),i=cp,a=u(i),o=o1.exports,s=u(o);function u(f){return f&&f.__esModule?f:{default:f}}function l(f,h,p,v){return(0,n.default)(h)(f,(0,a.default)(p),v)}r.default=(0,s.default)(l,4),e.exports=r.default})(pL,pL.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=pL.exports,n=o(t),i=o1.exports,a=o(i);function o(u){return u&&u.__esModule?u:{default:u}}function s(u,l,f){return(0,n.default)(u,1,l,f)}r.default=(0,a.default)(s,3),e.exports=r.default})(lD,lD.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=s;var t=hL.exports,n=o(t),i=lD.exports,a=o(i);function o(u){return u&&u.__esModule?u:{default:u}}function s(u,l){return(0,n.default)(a.default,u,l)}e.exports=r.default})(oD,oD.exports);var KB=qB(oD.exports),Bg=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var r=arguments,t=[],n=0;n<arguments.length;n++)t[n]=r[n];return this.args=t,KB(this.tasks)},e.prototype.tap=function(r,t){var n=this;this.tasks.push(function(i){t.apply(void 0,ZB([],YB(n.args),!1)),i(null,r)})},e}(),dD={exports:{}},vD={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=zE.exports,n=E(t),i=VE.exports,a=E(i),o=pL.exports,s=E(o),u=$E.exports,l=E(u),f=UE.exports,h=E(f),p=cp,v=E(p),m=o1.exports,x=E(m);function E(R){return R&&R.__esModule?R:{default:R}}function A(R,D,$){$=(0,l.default)($);var j=0,H=0,ee=R.length,U=!1;ee===0&&$(null);function W(Q,te){Q===!1&&(U=!0),U!==!0&&(Q?$(Q):(++H===ee||te===a.default)&&$(null))}for(;j<ee;j++)D(R[j],j,(0,h.default)(W))}function L(R,D,$){return(0,s.default)(R,1/0,D,$)}function k(R,D,$){var j=(0,n.default)(R)?A:L;return j(R,(0,v.default)(D),$)}r.default=(0,x.default)(k,3),e.exports=r.default})(vD,vD.exports);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=s;var t=vD.exports,n=o(t),i=hL.exports,a=o(i);function o(u){return u&&u.__esModule?u:{default:u}}function s(u,l){return(0,a.default)(n.default,u,l)}e.exports=r.default})(dD,dD.exports);dD.exports;var gD={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=$E.exports,n=f(t),i=UE.exports,a=f(i),o=cp,s=f(o),u=o1.exports,l=f(u);function f(p){return p&&p.__esModule?p:{default:p}}function h(p,v){if(v=(0,n.default)(v),!Array.isArray(p))return v(new Error("First argument to waterfall must be an array of functions"));if(!p.length)return v();var m=0;function x(A){var L=(0,s.default)(p[m++]);L.apply(void 0,A.concat([(0,a.default)(E)]))}function E(A){for(var L=[],k=arguments.length-1;k-- >0;)L[k]=arguments[k+1];if(A!==!1){if(A||m===p.length)return v.apply(void 0,[A].concat(L));x(L)}}x([])}r.default=(0,l.default)(h),e.exports=r.default})(gD,gD.exports);var DNe=qB(gD.exports),BNe=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return DNe(this.tasks)},e.prototype.tap=function(r,t){this.tasks.length===0?this.tasks.push(function(n){var i=t();n(i?null:!1,i)}):this.tasks.push(function(n,i){var a=t.apply(void 0,ZB([],YB(n),!1));i(a?null:!1,r)})},e}(),sO=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return KB(this.tasks)},e.prototype.tap=function(r,t){this.tasks.push(function(n){var i=t();n(i,r)})},e}(),NNe=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var r=arguments,t=[],n=0;n<arguments.length;n++)t[n]=r[n];return this.args=t,KB(this.tasks)},e.prototype.tapPromise=function(r,t){var n=this;this.tasks.push(function(i){return SNe(n,void 0,void 0,function(){return ANe(this,function(a){switch(a.label){case 0:return[4,t.apply(void 0,ZB([],YB(this.args),!1))];case 1:return a.sent(),i(null,r),[2]}})})})},e}(),QB={exports:{}};function dL(e){var r=e.target||e.srcElement;r.__resizeRAF__&&cancelAnimationFrame(r.__resizeRAF__),r.__resizeRAF__=requestAnimationFrame(function(){var t=r.__resizeTrigger__,n=t&&t.__resizeListeners__;n&&n.forEach(function(i){i.call(t,e)})})}var $U=function(r,t){var n=this,i=n.document,a,o=i.attachEvent;typeof navigator!="undefined"&&(a=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function s(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",dL)}if(!r.__resizeListeners__)if(r.__resizeListeners__=[],o)r.__resizeTrigger__=r,r.attachEvent("onresize",dL);else{getComputedStyle(r).position==="static"&&(r.style.position="relative");var u=r.__resizeTrigger__=i.createElement("object");u.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),u.setAttribute("class","resize-sensor"),u.setAttribute("tabindex","-1"),u.setAttribute("title",""),u.__resizeElement__=r,u.onload=s,u.type="text/html",a&&r.appendChild(u),u.data="about:blank",a||r.appendChild(u)}r.__resizeListeners__.push(t)};QB.exports=typeof window=="undefined"?$U:$U.bind(window);var zNe=QB.exports.unbind=function(e,r){var t=document.attachEvent,n=e.__resizeListeners__||[];if(r){var i=n.indexOf(r);i!==-1&&n.splice(i,1)}else n=e.__resizeListeners__=[];if(!n.length){if(t)e.detachEvent("onresize",dL);else if(e.__resizeTrigger__){var a=e.__resizeTrigger__.contentDocument,o=a&&a.defaultView;o&&(o.removeEventListener("resize",dL),delete o.__resizeTrigger__),e.__resizeTrigger__=!e.removeChild(e.__resizeTrigger__)}delete e.__resizeListeners__}},$Ne=QB.exports,UU,VU,GU,HU,jU,WU,XU,YU,ZU,qU,KU,QU,JU,eV,tV,rV,nV,af,iV,aV,oV,sV,uV,lV,cV,fV,hV,pV,dV,vV,gV,mV,yV;function UNe(e){var r=VNe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function VNe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var GNe=(UU=Ri(),VU=ba(Mt.SceneID),GU=ba(Mt.IIconService),HU=ba(Mt.IFontService),jU=ba(Mt.IControlService),WU=ba(Mt.IGlobalConfigService),XU=ba(Mt.IMapService),YU=ba(Mt.ICoordinateSystemService),ZU=ba(Mt.IRendererService),qU=ba(Mt.ILayerService),KU=ba(Mt.ICameraService),QU=ba(Mt.IInteractionService),JU=ba(Mt.IPickingService),eV=ba(Mt.IShaderModuleService),tV=ba(Mt.IMarkerService),rV=ba(Mt.IPopupService),UU(nV=(af=function(e){er(t,e);var r=UNe(t);function t(){var n;return st(this,t),n=r.call(this),X(He(n),"destroyed",!1),X(He(n),"loaded",!1),ua(He(n),"id",iV,He(n)),ua(He(n),"iconService",aV,He(n)),ua(He(n),"fontService",oV,He(n)),ua(He(n),"controlService",sV,He(n)),ua(He(n),"configService",uV,He(n)),ua(He(n),"map",lV,He(n)),ua(He(n),"coordinateSystemService",cV,He(n)),ua(He(n),"rendererService",fV,He(n)),ua(He(n),"layerService",hV,He(n)),ua(He(n),"cameraService",pV,He(n)),ua(He(n),"interactionService",dV,He(n)),ua(He(n),"pickingService",vV,He(n)),ua(He(n),"shaderModuleService",gV,He(n)),ua(He(n),"markerService",mV,He(n)),ua(He(n),"popupService",yV,He(n)),X(He(n),"inited",!1),X(He(n),"initPromise",void 0),X(He(n),"rendering",!1),X(He(n),"$container",void 0),X(He(n),"canvas",void 0),X(He(n),"markerContainer",void 0),X(He(n),"hooks",void 0),X(He(n),"handleWindowResized",function(){n.emit("resize"),n.$container&&(n.initContainer(),Tre(),n.coordinateSystemService.needRefresh=!0,n.render())}),X(He(n),"handleMapCameraChanged",function(i){n.cameraService.update(i),n.render()}),n.hooks={init:new NNe},n}return ot(t,[{key:"init",value:function(i){var a=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",Hi(Xr.mark(function o(){return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,new Promise(function(l){a.map.onCameraChanged(function(f){a.cameraService.init(),a.cameraService.update(f),l()}),a.map.init()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.map.addMarkerContainer(),a.markerService.addMarkers(),a.markerService.addMarkerLayers(),a.popupService.initPopup(),a.interactionService.init(),a.interactionService.on(Sc.Drag,a.addSceneEvent.bind(a));case 9:case"end":return u.stop()}},o)}))),this.hooks.init.tapPromise("initRenderer",Hi(Xr.mark(function o(){var s,u;return Xr.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(s=a.map.getOverlayContainer(),s?a.$container=s:a.$container=fNe(a.configService.getSceneConfig(a.id).id||""),!a.$container){f.next=12;break}return a.canvas=xs("canvas","",a.$container),a.setCanvas(),f.next=7,a.rendererService.init(a.canvas,a.configService.getSceneConfig(a.id),i.gl);case 7:a.initContainer(),$Ne(a.$container,a.handleWindowResized),Hn.matchMedia&&((u=Hn.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||u===void 0||u.addListener(a.handleWindowResized)),f.next=13;break;case 12:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 13:a.pickingService.init(a.id);case 14:case"end":return f.stop()}},o)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"initMiniScene",value:function(i){var a=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",Hi(Xr.mark(function o(){return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,new Promise(function(l){a.map.onCameraChanged(function(f){a.cameraService.init(),a.cameraService.update(f),a.map.version!=="GAODE2.x"&&l()}),a.map.initMiniMap()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.interactionService.init(),a.interactionService.on(Sc.Drag,a.addSceneEvent.bind(a));case 5:case"end":return u.stop()}},o)}))),this.hooks.init.tapPromise("initRenderer",Hi(Xr.mark(function o(){var s;return Xr.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(s=i.canvas,a.$container=s||null,!a.$container){l.next=7;break}return l.next=5,a.rendererService.init(i.canvas,a.configService.getSceneConfig(a.id),void 0);case 5:l.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:a.pickingService.init(a.id);case 9:case"end":return l.stop()}},o)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(i){this.layerService.sceneService=this,this.layerService.add(i)}},{key:"addMask",value:function(i){this.layerService.sceneService=this,this.layerService.addMask(i)}},{key:"render",value:function(){var n=Hi(Xr.mark(function a(){return Xr.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(this.rendering||this.destroyed)){s.next=2;break}return s.abrupt("return");case 2:if(this.rendering=!0,this.inited){s.next=12;break}return s.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 12:this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this.rendering=!1;case 15:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"addFontFace",value:function(i,a){this.fontService.addFontFace(i,a)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(i){var a,o=(a=this.$container)===null||a===void 0?void 0:a.getElementsByTagName("canvas")[0];this.render();var s=i==="jpg"?o==null?void 0:o.toDataURL("image/jpeg"):o==null?void 0:o.toDataURL("image/png");return s}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var i=this.$container.parentElement;i!==null&&(this.markerContainer=xs("div","l7-marker-container",i))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var i=this,a,o;if(!this.inited){this.destroyed=!0;return}if(this.emit("destroy"),this.pickingService.destroy(),this.layerService.destroy(),setTimeout(function(){var u;(u=i.$container)===null||u===void 0||u.removeChild(i.canvas),i.canvas=null,i.rendererService.destroy()}),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),(a=this.$container)===null||a===void 0||(o=a.parentNode)===null||o===void 0||o.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,zNe(this.$container,this.handleWindowResized),Hn.matchMedia){var s;(s=Hn.matchMedia("screen and (min-resolution: 2dppx)"))===null||s===void 0||s.removeListener(this.handleWindowResized)}}},{key:"initContainer",value:function(){var i,a,o=pu,s=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,u=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,l=this.canvas;l&&(l.width=s*o,l.height=u*o),this.rendererService.viewport({x:0,y:0,width:o*s,height:o*u})}},{key:"setCanvas",value:function(){var i,a,o=pu,s=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,u=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,l=this.canvas;l.width=s*o,l.height=u*o,l.style.width="100%",l.style.height="100%"}},{key:"addSceneEvent",value:function(i){this.emit(i.type,i)}}]),t}(zf.exports.EventEmitter),iV=ia(af.prototype,"id",[VU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aV=ia(af.prototype,"iconService",[GU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oV=ia(af.prototype,"fontService",[HU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sV=ia(af.prototype,"controlService",[jU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uV=ia(af.prototype,"configService",[WU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lV=ia(af.prototype,"map",[XU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cV=ia(af.prototype,"coordinateSystemService",[YU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fV=ia(af.prototype,"rendererService",[ZU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hV=ia(af.prototype,"layerService",[qU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pV=ia(af.prototype,"cameraService",[KU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dV=ia(af.prototype,"interactionService",[QU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vV=ia(af.prototype,"pickingService",[JU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gV=ia(af.prototype,"shaderModuleService",[eV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mV=ia(af.prototype,"markerService",[tV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yV=ia(af.prototype,"popupService",[rV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),af))||nV);function HNe(e){var r=0;switch(e){case"vec2":case"ivec2":r=2;break;case"vec3":case"ivec3":r=3;break;case"vec4":case"ivec4":case"mat2":r=4;break;case"mat3":r=9;break;case"mat4":r=16;break}return r}var jNe=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function _V(e){var r={};return e=e.replace(jNe,function(t,n,i){var a=i.split(":"),o=a[0].trim(),s="";switch(a.length>1&&(s=a[1].trim()),n){case"bool":s=s==="true";break;case"float":case"int":s=Number(s);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":s?s=s.replace("[","").replace("]","").split(",").reduce(function(u,l){return u.push(Number(l.trim())),u},[]):s=new Array(HNe(n)).fill(0);break}return r[o]=s,"uniform ".concat(n," ").concat(o,`;
`)}),{content:e,uniforms:r}}var xV,bV,wV="#define PI 3.14159265359",WNe=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,XNe=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,YNe=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,ZNe=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,qNe=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,KNe=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,QNe=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom));
  }
  return pixel * 2.0;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,JNe=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,e7e=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,t7e=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,r7e=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,n7e=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,i7e=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,a7e=/precision\s+(high|low|medium)p\s+float/,o7e=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,s7e=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,u7e=(xV=Ri(),xV(bV=function(){function e(){st(this,e),X(this,"moduleCache",{}),X(this,"rawContentCache",{})}return ot(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:wV,fs:wV}),this.registerModule("decode",{vs:WNe,fs:""}),this.registerModule("projection",{vs:QNe,fs:""}),this.registerModule("project",{vs:KNe,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:JNe}),this.registerModule("lighting",{vs:YNe,fs:""}),this.registerModule("light",{vs:XNe,fs:""}),this.registerModule("picking",{vs:qNe,fs:ZNe}),this.registerModule("styleMapping",{vs:e7e,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:i7e,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:t7e,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:r7e,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:n7e,fs:""})}},{key:"registerModule",value:function(t,n){if(!this.rawContentCache[t]){var i=n.vs,a=n.fs,o=n.uniforms,s=_V(i),u=s.content,l=s.uniforms,f=_V(a),h=f.content,p=f.uniforms;this.rawContentCache[t]={fs:h,uniforms:Et(Et(Et({},l),p),o),vs:u}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var n=this;if(this.moduleCache[t])return this.moduleCache[t];var i=this.rawContentCache[t].vs,a=this.rawContentCache[t].fs,o=this.processModule(i,[],"vs"),s=o.content,u=o.includeList,l=this.processModule(a,[],"fs"),f=l.content,h=l.includeList,p=f,v=Kt.exports.uniq(u.concat(h).concat(t)).reduce(function(m,x){return Et(Et({},m),n.rawContentCache[x].uniforms)},{});return a7e.test(f)||(p=o7e+f),this.moduleCache[t]={fs:p.trim(),uniforms:v,vs:s.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,n,i){var a=this,o=t.replace(s7e,function(s,u){var l=u.split(" "),f=l[0].replace(/"/g,"");if(n.indexOf(f)>-1)return"";var h=a.rawContentCache[f][i];n.push(f);var p=a.processModule(h,n,i),v=p.content;return v});return{content:o,includeList:n}}}]),e}())||bV);function l7e(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=ze(e),e!==null););return e}function Yv(){return typeof Reflect!="undefined"&&Reflect.get?Yv=Reflect.get.bind():Yv=function(r,t,n){var i=l7e(r,t);if(!!i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?r:n):a.value}},Yv.apply(this,arguments)}var Ty;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(Ty||(Ty={}));var CV,EV,wk=(CV=Ri(),CV(EV=function(){function e(){st(this,e),X(this,"shaderModuleService",void 0),X(this,"rendererService",void 0),X(this,"cameraService",void 0),X(this,"mapService",void 0),X(this,"interactionService",void 0),X(this,"layerService",void 0),X(this,"config",void 0)}return ot(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Ty.Normal}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(Mt.IRendererService),this.cameraService=t.getContainer().get(Mt.ICameraService),this.mapService=t.getContainer().get(Mt.IMapService),this.interactionService=t.getContainer().get(Mt.IInteractionService),this.layerService=t.getContainer().get(Mt.ILayerService),this.shaderModuleService=t.getContainer().get(Mt.IShaderModuleService)}},{key:"render",value:function(t){}}]),e}())||EV),SV,AV;function c7e(e){var r=f7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function f7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var h7e=(SV=Ri(),SV(AV=function(e){er(t,e);var r=c7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(i,a){Yv(ze(t.prototype),"init",this).call(this,i,a)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),t}(wk))||AV),TV,MV,LV,uO,IV;function p7e(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=d7e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function d7e(e,r){if(!!e){if(typeof e=="string")return kV(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return kV(e,r)}}function kV(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var v7e=(TV=Ri(),MV=ba(Mt.IPostProcessor),TV(LV=(uO=function(){function e(){st(this,e),X(this,"passes",[]),ua(this,"postProcessor",IV,this),X(this,"layer",void 0),X(this,"renderFlag",void 0),X(this,"width",0),X(this,"height",0)}return ot(e,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var r=Hi(Xr.mark(function n(){var i,a,o;return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:i=p7e(this.passes),u.prev=1,i.s();case 3:if((a=i.n()).done){u.next=9;break}return o=a.value,u.next=7,o.render(this.layer);case 7:u.next=3;break;case 9:u.next=14;break;case 11:u.prev=11,u.t0=u.catch(1),i.e(u.t0);case 14:return u.prev=14,i.f(),u.finish(14);case 17:return u.next=19,this.postProcessor.render(this.layer);case 19:case"end":return u.stop()}},n,this,[[1,11,14,17]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){(this.width!==t||this.height!==n)&&(this.postProcessor.resize(t,n),this.width=t,this.height=n)}},{key:"add",value:function(t,n){t.getType()===Ty.PostProcessing?this.postProcessor.add(t,this.layer,n):(t.init(this.layer,n),this.passes.push(t))}},{key:"insert",value:function(t,n,i){t.init(this.layer,n),this.passes.splice(i,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),IV=ia(uO.prototype,"postProcessor",[MV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uO))||LV),PV,RV;function g7e(e){var r=m7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function m7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var y7e=(PV=Ri(),PV(RV=function(e){er(t,e);var r=g7e(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"pickingFBO",void 0),X(He(n),"layer",void 0),X(He(n),"width",0),X(He(n),"height",0),X(He(n),"alreadyInRendering",!1),X(He(n),"pickFromPickingFBO",function(s){var u=s.x,l=s.y,f=s.lngLat,h=s.type;if(!(!n.layer.isVisible()||!n.layer.needPick(h))){var p=n.rendererService,v=p.getViewportSize,m=p.readPixels,x=p.useFramebuffer,E=v(),A=E.width,L=E.height,k=n.layer.getLayerConfig(),R=k.enableHighlight,D=k.enableSelect,$=u*pu,j=l*pu;if(!($>A||$<0||j>L||j<0)){var H;x(n.pickingFBO,function(){var ee;if(H=m({x:Math.round($),y:Math.round(L-(l+1)*pu),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO}),H[0]!==0||H[1]!==0||H[2]!==0){var U=dy(H),W=n.layer.getSource().getFeatureById(U),Q={x:u,y:l,type:h,lngLat:f,featureId:U,feature:W};W&&(n.layer.setCurrentPickId(U),n.triggerHoverOnLayer(Q))}else{var te={x:u,y:l,lngLat:f,type:n.layer.getCurrentPickId()===null?"un"+h:"mouseout",featureId:null,feature:null};n.triggerHoverOnLayer(Et(Et({},te),{},{type:"unpick"})),n.triggerHoverOnLayer(te),n.layer.setCurrentPickId(null)}R&&n.highlightPickedFeature(H),D&&h==="click"&&((ee=H)===null||ee===void 0?void 0:ee.toString())!==[0,0,0,0].toString()&&n.selectFeature(H)})}}}),n}return ot(t,[{key:"getType",value:function(){return Ty.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(i,a){Yv(ze(t.prototype),"init",this).call(this,i,a),this.layer=i;var o=this.rendererService,s=o.createTexture2D,u=o.createFramebuffer,l=o.getViewportSize,f=l(),h=f.width,p=f.height;this.pickingFBO=u({color:s({width:h,height:p,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})}),this.interactionService.on(Sc.Hover,this.pickFromPickingFBO),this.interactionService.on(Sc.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Sc.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(i){var a=this;if(!this.alreadyInRendering){var o=this.rendererService,s=o.getViewportSize,u=o.useFramebuffer,l=o.clear,f=s(),h=f.width,p=f.height;this.alreadyInRendering=!0,(this.width!==h||this.height!==p)&&(this.pickingFBO.resize({width:h,height:p}),this.width=h,this.height=p),u(this.pickingFBO,function(){l({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var v=a.layer.multiPassRenderer.getRenderFlag();a.layer.multiPassRenderer.setRenderFlag(!1),i.hooks.beforePickingEncode.call(),i.render(),i.hooks.afterPickingEncode.call(),a.layer.multiPassRenderer.setRenderFlag(v),a.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(i){this.layer.emit(i.type,i)}},{key:"highlightPickedFeature",value:function(i){var a=tn(i,3),o=a[0],s=a[1],u=a[2];this.layer.hooks.beforeHighlight.call([o,s,u]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(i){var a=tn(i,3),o=a[0],s=a[1],u=a[2];this.layer.hooks.beforeSelect.call([o,s,u]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(i){var a=i.featureId,o=Sy(a);this.selectFeature(new Uint8Array(o))}},{key:"highlightFeatureHandle",value:function(i){var a=i.featureId,o=Sy(a);this.highlightPickedFeature(new Uint8Array(o))}}]),t}(wk))||RV),OV,FV,DV,lO,BV,_7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,am=(OV=Ri(),FV=ba(Mt.IShaderModuleService),OV(DV=(lO=function(){function e(){st(this,e),ua(this,"shaderModuleService",BV,this),X(this,"rendererService",void 0),X(this,"config",void 0),X(this,"quad",_7e),X(this,"enabled",!0),X(this,"renderToScreen",!1),X(this,"model",void 0),X(this,"name",void 0),X(this,"optionsToUpdate",{})}return ot(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return Ty.PostProcessing}},{key:"init",value:function(t,n){this.config=n,this.rendererService=t.getContainer().get(Mt.IRendererService),this.shaderModuleService=t.getContainer().get(Mt.IShaderModuleService);var i=this.rendererService,a=i.createAttribute,o=i.createBuffer,s=i.createModel,u=this.setupShaders(),l=u.vs,f=u.fs,h=u.uniforms;this.model=s({vs:l,fs:f,attributes:{a_Position:a({buffer:o({data:[-4,-4,4,-4,0,4],type:K.FLOAT}),size:2})},uniforms:Et(Et({u_Texture:null},h),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(t,n){var i=this,a=t.multiPassRenderer.getPostProcessor(),o=this.rendererService,s=o.useFramebuffer,u=o.getViewportSize,l=o.clear,f=u(),h=f.width,p=f.height;s(this.renderToScreen?null:a.getWriteFBO(),function(){l({framebuffer:a.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var v=Et({u_BloomFinal:0,u_Texture:a.getReadFBO(),u_ViewportSize:[h,p]},i.convertOptionsToUniforms(i.optionsToUpdate));n&&(v.u_BloomFinal=1,v.u_Texture2=n),i.model.draw({uniforms:v})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=Et(Et({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var n={};return Object.keys(t).forEach(function(i){Kt.exports.isNil(t[i])||(n["u_".concat(Kt.exports.upperFirst(Kt.exports.camelCase(i)))]=t[i])}),n}}]),e}(),BV=ia(lO.prototype,"shaderModuleService",[FV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lO))||DV),NV,zV;function x7e(e){var r=b7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function b7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var w7e=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,C7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,E7e=(NV=Ri(),NV(zV=function(e){er(t,e);var r=x7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:C7e,fs:w7e});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,o=i.fs,s=i.uniforms,u=this.rendererService.getViewportSize(),l=u.width,f=u.height;return{vs:a,fs:o,uniforms:Et(Et({},s),{},{u_ViewportSize:[l,f]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return Kt.exports.isNil(i.bloomRadius)||(a.u_radius=i.bloomRadius),Kt.exports.isNil(i.bloomIntensity)||(a.u_intensity=i.bloomIntensity),Kt.exports.isNil(i.bloomBaseRadio)||(a.u_baseRadio=i.bloomBaseRadio),a}}]),t}(am))||zV),$V,UV;function S7e(e){var r=A7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function A7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var T7e=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,M7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,L7e=($V=Ri(),$V(UV=function(e){er(t,e);var r=S7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:M7e,fs:T7e});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,o=i.fs,s=i.uniforms,u=this.rendererService.getViewportSize(),l=u.width,f=u.height;return{vs:a,fs:o,uniforms:Et(Et({},s),{},{u_ViewportSize:[l,f]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return Kt.exports.isNil(i.blurRadius)||(a.u_BlurDir=[i.blurRadius,0]),a}}]),t}(am))||UV),VV,GV;function I7e(e){var r=k7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function k7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P7e=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,R7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,O7e=(VV=Ri(),VV(GV=function(e){er(t,e);var r=I7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:R7e,fs:P7e});var i=this.shaderModuleService.getModule("blur-pass"),a=i.vs,o=i.fs,s=i.uniforms,u=this.rendererService.getViewportSize(),l=u.width,f=u.height;return{vs:a,fs:o,uniforms:Et(Et({},s),{},{u_ViewportSize:[l,f]})}}},{key:"convertOptionsToUniforms",value:function(i){var a={};return Kt.exports.isNil(i.blurRadius)||(a.u_BlurDir=[0,i.blurRadius]),a}}]),t}(am))||GV),HV,jV;function F7e(e){var r=D7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function D7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var B7e=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,N7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,z7e=(HV=Ri(),HV(jV=function(e){er(t,e);var r=F7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:N7e,fs:B7e});var i=this.shaderModuleService.getModule("colorhalftone-pass"),a=i.vs,o=i.fs,s=i.uniforms,u=this.rendererService.getViewportSize(),l=u.width,f=u.height;return{vs:a,fs:o,uniforms:Et(Et({},s),{},{u_ViewportSize:[l,f]})}}}]),t}(am))||jV),WV,XV;function $7e(e){var r=U7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function U7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var V7e=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,G7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,H7e=(WV=Ri(),WV(XV=function(e){er(t,e);var r=$7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:G7e,fs:V7e}),this.shaderModuleService.getModule("copy-pass")}}]),t}(am))||XV),YV,ZV;function j7e(e){var r=W7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function W7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var X7e=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Y7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Z7e=(YV=Ri(),YV(ZV=function(e){er(t,e);var r=j7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Y7e,fs:X7e});var i=this.shaderModuleService.getModule("hexagonalpixelate-pass"),a=i.vs,o=i.fs,s=i.uniforms,u=this.rendererService.getViewportSize(),l=u.width,f=u.height;return{vs:a,fs:o,uniforms:Et(Et({},s),{},{u_ViewportSize:[l,f]})}}}]),t}(am))||ZV),qV,KV;function q7e(e){var r=K7e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function K7e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Q7e=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,J7e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,e8e=(qV=Ri(),qV(KV=function(e){er(t,e);var r=q7e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:J7e,fs:Q7e});var i=this.shaderModuleService.getModule("ink-pass"),a=i.vs,o=i.fs,s=i.uniforms,u=this.rendererService.getViewportSize(),l=u.width,f=u.height;return{vs:a,fs:o,uniforms:Et(Et({},s),{},{u_ViewportSize:[l,f]})}}}]),t}(am))||KV),QV,JV;function t8e(e){var r=r8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function r8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var n8e=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,i8e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,a8e=(QV=Ri(),QV(JV=function(e){er(t,e);var r=t8e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:i8e,fs:n8e}),this.shaderModuleService.getModule("noise-pass")}}]),t}(am))||JV),eG,tG;function o8e(e){var r=s8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function s8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var u8e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,l8e=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,c8e=(eG=Ri(),eG(tG=function(e){er(t,e);var r=o8e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:u8e,fs:l8e}),this.shaderModuleService.getModule("sepia-pass")}}]),t}(am))||tG),rG,nG,iG,aG,xb,oG,f8e=(rG=Ri(),nG=ba(Mt.IRendererService),iG=v3e(),rG(aG=(xb=function(){function e(){st(this,e),ua(this,"rendererService",oG,this),X(this,"passes",[]),X(this,"readFBO",void 0),X(this,"writeFBO",void 0)}return ot(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var t=this.rendererService,n=t.getViewportSize,i=t.createTexture2D,a=n(),o=a.width,s=a.height;return i({x:0,y:0,width:o,height:s,copy:!0})}},{key:"getReadFBOTex",value:function(){var t=this,n=this.rendererService.useFramebuffer;return new Promise(function(i){n(t.readFBO,Hi(Xr.mark(function a(){return Xr.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:i(t.getCurrentFBOTex());case 1:case"end":return s.stop()}},a)})))})}},{key:"renderBloomPass",value:function(){var r=Hi(Xr.mark(function n(i,a){var o,s;return Xr.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.getReadFBOTex();case 2:o=l.sent,s=0;case 4:if(!(s<4)){l.next=11;break}return l.next=7,a.render(i,o);case 7:this.swap(),s++,l.next=4;break;case 11:case"end":return l.stop()}},n,this)}));function t(n,i){return r.apply(this,arguments)}return t}()},{key:"render",value:function(){var r=Hi(Xr.mark(function n(i){var a,o;return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:a=0;case 1:if(!(a<this.passes.length)){u.next=15;break}if(o=this.passes[a],o.setRenderToScreen(this.isLastEnabledPass(a)),o.getName()!=="bloom"){u.next=9;break}return u.next=7,this.renderBloomPass(i,o);case 7:u.next=12;break;case 9:return u.next=11,o.render(i);case 11:a!==this.passes.length-1&&this.swap();case 12:a++,u.next=1;break;case 15:case"end":return u.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"resize",value:function(t,n){this.readFBO.resize({width:t,height:n}),this.writeFBO.resize({width:t,height:n})}},{key:"add",value:function(t,n,i){t.init(n,i),this.passes.push(t)}},{key:"insert",value:function(t,n,i,a){t.init(i,a),this.passes.splice(n,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find(function(n){return n.getName()===t})}},{key:"init",value:function(){var t=this.rendererService,n=t.createFramebuffer,i=t.createTexture2D;this.readFBO=n({color:i({width:1,height:1,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})}),this.writeFBO=n({color:i({width:1,height:1,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var n=t+1;n<this.passes.length;n++)if(this.passes[n].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),e}(),oG=ia(xb.prototype,"rendererService",[nG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ia(xb.prototype,"init",[iG],Object.getOwnPropertyDescriptor(xb.prototype,"init"),xb.prototype),xb))||aG),sG,uG;function h8e(e){var r=p8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function p8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var d8e=(sG=Ri(),sG(uG=function(e){er(t,e);var r=h8e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getType",value:function(){return Ty.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(i,a){Yv(ze(t.prototype),"init",this).call(this,i,a)}},{key:"render",value:function(i){var a=this.rendererService,o=a.useFramebuffer,s=a.clear,u=i.multiPassRenderer.getPostProcessor().getReadFBO();o(u,function(){s({color:[0,0,0,0],depth:1,stencil:0,framebuffer:u}),i.multiPassRenderer.setRenderFlag(!1),i.models.forEach(function(l){l.draw({uniforms:i.layerModel.getUninforms()})}),i.multiPassRenderer.setRenderFlag(!0)})}}]),t}(wk))||uG),lG,cG,fG,cO,hG;function v8e(e){var r=g8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function g8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var m8e=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,pG=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,y8e=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function dG(e,r){for(var t=0,n=1/r,i=e;i>0;)t=t+n*(i%r),i=Math.floor(i/r),n=n/r;return t}var _8e=1,x8e=(lG=Ri(),cG=ba(Mt.IShaderModuleService),lG(fG=(cO=function(e){er(t,e);var r=v8e(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),ua(He(n),"shaderModuleService",hG,He(n)),X(He(n),"haltonSequence",[]),X(He(n),"accumulatingId",0),X(He(n),"frame",0),X(He(n),"timer",void 0),X(He(n),"sampleRenderTarget",void 0),X(He(n),"prevRenderTarget",void 0),X(He(n),"outputRenderTarget",void 0),X(He(n),"copyRenderTarget",void 0),X(He(n),"blendModel",void 0),X(He(n),"outputModel",void 0),X(He(n),"copyModel",void 0),n}return ot(t,[{key:"getType",value:function(){return Ty.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(i,a){Yv(ze(t.prototype),"init",this).call(this,i,a);var o=this.rendererService,s=o.createFramebuffer,u=o.createTexture2D;this.sampleRenderTarget=s({color:u({width:1,height:1,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})}),this.prevRenderTarget=s({color:u({width:1,height:1,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})}),this.outputRenderTarget=s({color:u({width:1,height:1,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})}),this.copyRenderTarget=s({color:u({width:1,height:1,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE})});for(var l=0;l<30;l++)this.haltonSequence.push([dG(l,2),dG(l,3)]);this.blendModel=this.createTriangleModel("blend-pass",m8e),this.outputModel=this.createTriangleModel("copy-pass",pG,{blend:{enable:!0,func:{srcRGB:K.ONE,dstRGB:K.ONE_MINUS_SRC_ALPHA,srcAlpha:K.ONE,dstAlpha:K.ONE_MINUS_SRC_ALPHA},equation:{rgb:K.FUNC_ADD,alpha:K.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",pG)}},{key:"render",value:function(i){var a=this,o=this.rendererService,s=o.clear,u=o.getViewportSize,l=o.useFramebuffer,f=u(),h=f.width,p=f.height;this.sampleRenderTarget.resize({width:h,height:p}),this.prevRenderTarget.resize({width:h,height:p}),this.outputRenderTarget.resize({width:h,height:p}),this.copyRenderTarget.resize({width:h,height:p}),this.resetFrame(),this.stopAccumulating();var v=i.multiPassRenderer.getPostProcessor().getReadFBO();l(v,function(){s({color:[0,0,0,0],depth:1,stencil:0,framebuffer:v}),i.multiPassRenderer.setRenderFlag(!1),i.render(),i.multiPassRenderer.setRenderFlag(!0)});var m=function x(E){!a.accumulatingId||E!==a.accumulatingId||a.isFinished()||(a.doRender(i),Hn.requestAnimationFrame(function(){x(E)}))};this.accumulatingId=_8e++,this.timer=Hn.setTimeout(function(){m(a.accumulatingId)},50)}},{key:"doRender",value:function(i){var a=this,o=this.rendererService,s=o.clear,u=o.getViewportSize,l=o.useFramebuffer,f=u(),h=f.width,p=f.height,v=i.getLayerConfig(),m=v.jitterScale,x=m===void 0?1:m,E=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((E[0]*2-1)/h*x,(E[1]*2-1)/p*x),i.multiPassRenderer.setRenderFlag(!1),i.hooks.beforeRender.call(),l(this.sampleRenderTarget,function(){s({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.sampleRenderTarget}),i.render()}),i.hooks.afterRender.call(),i.multiPassRenderer.setRenderFlag(!0);var A=i.getLayerConfig();l(this.outputRenderTarget,function(){a.blendModel.draw({uniforms:{u_opacity:A.opacity||1,u_MixRatio:a.frame===0?1:.9,u_Diffuse1:a.sampleRenderTarget,u_Diffuse2:a.frame===0?i.multiPassRenderer.getPostProcessor().getReadFBO():a.prevRenderTarget}})}),this.frame===0&&s({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(l(this.copyRenderTarget,function(){a.outputModel.draw({uniforms:{u_Texture:a.outputRenderTarget}})}),l(i.multiPassRenderer.getPostProcessor().getReadFBO(),function(){a.copyModel.draw({uniforms:{u_Texture:a.copyRenderTarget}})}),i.multiPassRenderer.getPostProcessor().render(i));var L=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=L,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,Hn.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(i,a,o){this.shaderModuleService.registerModule(i,{vs:y8e,fs:a});var s=this.shaderModuleService.getModule(i),u=s.vs,l=s.fs,f=s.uniforms,h=this.rendererService,p=h.createAttribute,v=h.createBuffer,m=h.createModel;return m(Et({vs:u,fs:l,attributes:{a_Position:p({buffer:v({data:[-4,-4,4,-4,0,4],type:K.FLOAT}),size:2})},uniforms:Et({},f),depth:{enable:!1},count:3},o))}}]),t}(wk),hG=ia(cO.prototype,"shaderModuleService",[cG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cO))||fG),Pc=new CB;Pc.bind(Mt.IGlobalConfigService).to(rNe).inSingletonScope();XDe(Ri(),zf.exports.EventEmitter);Pc.bind(Mt.IEventEmitter).to(zf.exports.EventEmitter);var wne=x3e(Pc,!1),Ck=function(r){var t=wne.lazyInject(r);return function(n,i,a){t.call(this,n,i),a&&(a.initializer=function(){return n[i]})}},b8e=function(r){var t=wne.lazyMultiInject(r);return function(n,i,a){t.call(this,n,i),a&&(a.initializer=function(){return n[i]})}},w8e=0;function Cne(){var e=new CB;return e.parent=Pc,e.bind(Mt.SceneID).toConstantValue("".concat(w8e++)),e.bind(Mt.IShaderModuleService).to(u7e).inSingletonScope(),e.bind(Mt.ILayerService).to(mNe).inSingletonScope(),e.bind(Mt.ISceneService).to(GNe).inSingletonScope(),e.bind(Mt.ICameraService).to(X6e).inSingletonScope(),e.bind(Mt.ICoordinateSystemService).to(aNe).inSingletonScope(),e.bind(Mt.IInteractionService).to(lNe).inSingletonScope(),e.bind(Mt.IPickingService).to(pNe).inSingletonScope(),e.bind(Mt.IControlService).to(q6e).inSingletonScope(),e.bind(Mt.IMarkerService).to(K6e).inSingletonScope(),e.bind(Mt.IIconService).to(W6e).inSingletonScope(),e.bind(Mt.IFontService).to(V6e).inSingletonScope(),e.bind(Mt.IPopupService).to(Q6e).inSingletonScope(),e.bind(Mt.INormalPass).to(h7e).whenTargetNamed("clear"),e.bind(Mt.INormalPass).to(y7e).whenTargetNamed("pixelPicking"),e.bind(Mt.INormalPass).to(d8e).whenTargetNamed("render"),e.bind(Mt.INormalPass).to(x8e).whenTargetNamed("taa"),e.bind(Mt.IFactoryNormalPass).toFactory(function(r){return function(t){return r.container.getNamed(Mt.INormalPass,t)}}),e.bind(Mt.IPostProcessingPass).to(H7e).whenTargetNamed("copy"),e.bind(Mt.IPostProcessingPass).to(E7e).whenTargetNamed("bloom"),e.bind(Mt.IPostProcessingPass).to(L7e).whenTargetNamed("blurH"),e.bind(Mt.IPostProcessingPass).to(O7e).whenTargetNamed("blurV"),e.bind(Mt.IPostProcessingPass).to(a8e).whenTargetNamed("noise"),e.bind(Mt.IPostProcessingPass).to(c8e).whenTargetNamed("sepia"),e.bind(Mt.IPostProcessingPass).to(z7e).whenTargetNamed("colorHalftone"),e.bind(Mt.IPostProcessingPass).to(Z7e).whenTargetNamed("hexagonalPixelate"),e.bind(Mt.IPostProcessingPass).to(e8e).whenTargetNamed("ink"),e.bind(Mt.IFactoryPostProcessingPass).toFactory(function(r){return function(t){var n=r.container.getNamed(Mt.IPostProcessingPass,t);return n.setName(t),n}}),e}function vL(e){var r=new CB;return r.parent=e,r.bind(Mt.IStyleAttributeService).to(ENe).inSingletonScope(),r.bind(Mt.IMultiPassRenderer).to(v7e).inSingletonScope(),r.bind(Mt.IPostProcessor).to(f8e).inSingletonScope(),r}var C8e=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function E8e(e){return C8e.indexOf(e)}var S8e=64,A8e=131072,T8e=524288,M8e=2097152,L8e=8388608;function dT(e,r){return e=Kt.exports.clamp(Math.floor(e),0,255),r=Kt.exports.clamp(Math.floor(r),0,255),256*e+r}function I8e(e){var r=e.color,t=e.radius,n=e.tileX,i=e.tileY,a=e.shape,o=e.opacity,s=e.stroke,u=e.strokeWidth,l=e.strokeOpacity,f=[],h=[],p=[],v=[dT(r[0],r[1]),dT(r[2],r[3])],m=[dT(s[0],s[1]),dT(s[2],s[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(x){var E=tn(x,2),A=E[0],L=E[1];f.push([].concat(v,[(A+1)*L8e+(L+1)*M8e+E8e(a)*A8e+t,(n+512)*T8e+(i+512)*S8e])),h.push([].concat(m,[u,l])),p.push([o,0,0,0])}),{packedBuffer:f,packedBuffer2:h,packedBuffer3:p}}var Fd;(function(e){e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none"})(Fd||(Fd={}));var Lo;(function(e){e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging"})(Lo||(Lo={}));var Qm;(function(e){e.CONSTANT="constant",e.VARIABLE="variable"})(Qm||(Qm={}));var Ar;(function(e){e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform"})(Ar||(Ar={}));var GE=["mapload","mapchange","mapAfterFrameChange"],C0={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},TC=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],My;(function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter"})(My||(My={}));var k8e=Object.freeze(Object.defineProperty({__proto__:null,container:Pc,createSceneContainer:Cne,createLayerContainer:vL,lazyInject:Ck,lazyMultiInject:b8e,TYPES:Mt,packCircleVertex:I8e,BasePostProcessingPass:am,get BlendType(){return Fd},get ScaleTypes(){return Lo},get StyleScaleType(){return Qm},get AttributeType(){return Ar},MapServiceEvent:GE,get CoordinateSystem(){return sc},CoordinateUniform:w0,CameraUniform:C0,SceneEventList:TC,get PositionType(){return My},get InteractionEvent(){return Sc},get PassType(){return Ty},get gl(){return K}},Symbol.toStringTag,{value:"Module"})),Ene=ed(k8e);function P8e(e){var r=R8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function R8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var O8e=0,MS=function(e){er(t,e);var r=P8e(t);function t(n){var i;return st(this,t),i=r.call(this),i.controlOption=Et(Et({},i.getDefault()),n||{}),i}return ot(t,[{key:"getDefault",value:function(){return{position:My.TOPRIGHT,name:"".concat(O8e++)}}},{key:"setPosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:My.BOTTOMRIGHT,a=this.controlService;return a&&a.removeControl(this),this.controlOption.position=i,a&&a.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(i){this.mapsService=i.get(Mt.IMapService),this.renderService=i.get(Mt.IRendererService),this.layerService=i.get(Mt.ILayerService),this.controlService=i.get(Mt.IControlService),this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd();var a=this.container,o=this.controlOption.position,s=this.controlService.controlCorners[o];return s_(a,"l7-control"),o.indexOf("bottom")!==-1?s.insertBefore(a,s.firstChild):s.appendChild(a),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var i=this.container;s_(i,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var i=this.container;C2(i,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;n1(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(i){if(this.mapsService&&i&&i.screenX>0&&i.screenY>0){var a=this.mapsService.getContainer();a!==null&&a.focus()}}}]),t}(zf.exports.EventEmitter);function F8e(e){var r=D8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function D8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var B8e=function(e){er(t,e);var r=F8e(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.layerControlInputs=[],i.layers=[],i.lastZIndex=0,i.handlingClick=!1,i.initLayers(),E1(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],He(i)),i}return ot(t,[{key:"getDefault",value:function(){return{collapsed:!0,position:My.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var i=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(a){a.layer.on("remove",i.onLayerChange),a.layer.on("add",i.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(i,a){return this.addLayer(i,a,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var i=this.renderService.getViewportSize(),a=i.height;s_(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var o=a-(this.container.offsetTop+50);return o<this.form.clientHeight?(s_(this.form,"l7-control-layers-scrollbar"),this.form.style.height=o+"px"):C2(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return C2(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var i=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(a){a.layer.off("remove",i.onLayerChange),a.layer.off("add",i.onLayerChange)}))}},{key:"initLayout",value:function(){var i="l7-control-layers",a=this.container=xs("div",i),o=this.controlOption.collapsed;a.setAttribute("aria-haspopup","true");var s=this.form=xs("form",i+"-list");o&&(this.mapsService.on("click",this.collapse),a.addEventListener("mouseenter",this.expand),a.addEventListener("mouseleave",this.collapse)),this.layersLink=xs("a",i+"-toggle",a);var u=this.layersLink;u.title="Layers",o||this.expand(),this.baseLayersList=xs("div",i+"-base",s),this.separator=xs("div",i+"-separator",s),this.overlaysList=xs("div",i+"-overlays",s),a.appendChild(s)}},{key:"initLayers",value:function(){var i=this,a=this.controlOption,o=a.baseLayers,s=o===void 0?{}:o,u=a.overlayers,l=u===void 0?{}:u;Object.keys(s).forEach(function(f){i.addLayer(s[f],f,!1)}),Object.keys(l).forEach(function(f){i.addLayer(l[f],f,!0)})}},{key:"update",value:function(){if(!this.container)return this;q5(this.baseLayersList),q5(this.overlaysList),this.layerControlInputs=[];var i,a,o,s,u=0;for(o=0;o<this.layers.length;o++)s=this.layers[o],this.addItem(s),a=a||s.overlay,i=i||!s.overlay,u+=s.overlay?0:1;return this.controlOption.hideSingleBase&&(i=i&&u>1,this.baseLayersList.style.display=i?"":"none"),this.separator.style.display=a&&i?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var i=this.layerControlInputs,a,o,s=this.mapsService.getZoom(),u=i.length-1;u>=0;u--)if(a=i[u],o=this.layerService.getLayer(a.layerId),o&&o.inited){var l=o.getMinZoom(),f=o.getMaxZoom();a.disabled=s<l||s>f}}},{key:"addLayer",value:function(i,a,o){this.mapsService&&(i.on("add",this.onLayerChange),i.on("remove",this.onLayerChange)),this.layers.push({layer:i,name:a,overlay:o});var s=this.controlOption,u=s.sortLayers,l=s.sortFunction,f=s.autoZIndex;u&&this.layers.sort(function(h,p){return l(h.layer,p.layer,h.name,p.name)}),f&&i.setZIndex&&(this.lastZIndex++,i.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(i){this.handlingClick||this.update();var a=this.layerService.getLayer(i.target.layerId),o=a!=null&&a.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;o&&this.emit(o,a)}},{key:"createRadioElement",value:function(i,a){var o='<input type="radio" class="l7-control-layers-selector" name="'+i+'"'+(a?' checked="checked"':"")+"/>",s=document.createElement("div");return s.innerHTML=o,s.firstChild}},{key:"addItem",value:function(i){var a=document.createElement("label"),o=this.layerService.getLayer(i.layer.id),s=o&&o.inited&&i.layer.isVisible(),u;i.overlay?(u=document.createElement("input"),u.type="checkbox",u.className="l7-control-layers-selector",u.defaultChecked=s):u=this.createRadioElement("l7-base-layers",s),this.layerControlInputs.push(u),u.layerId=i.layer.id,u.addEventListener("click",this.onInputClick);var l=document.createElement("span");l.innerHTML=" "+i.name;var f=document.createElement("div");a.appendChild(f),f.appendChild(u),f.appendChild(l);var h=i.overlay?this.overlaysList:this.baseLayersList;return h.appendChild(a),this.checkDisabledLayers(),a}},{key:"onInputClick",value:function(){var i=this.layerControlInputs,a,o,s=[],u=[];this.handlingClick=!0;for(var l=i.length-1;l>=0;l--)a=i[l],o=this.layerService.getLayer(a.layerId),a.checked?s.push(o):a.checked||u.push(o);u.forEach(function(f){f.hide()}),s.forEach(function(f){f.show()}),this.handlingClick=!1}}]),t}(MS);function N8e(e){var r=z8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function z8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Sne=function(e){er(t,e);var r=N8e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getDefault",value:function(){return{position:My.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var i="l7-control-logo",a=xs("div",i),o=xs("a","l7-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://antv.alipay.com/l7",o.setAttribute("aria-label","AntV logo"),o.setAttribute("rel","noopener nofollow"),a.appendChild(o),a}},{key:"onRemove",value:function(){return null}}]),t}(MS);function $8e(e){var r=U8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function U8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var V8e=function(e){er(t,e);var r=$8e(t);function t(n){var i;return st(this,t),i=r.call(this,n),E1(["update"],He(i)),i}return ot(t,[{key:"getDefault",value:function(){return{position:My.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var i="l7-control-scale",a=xs("div",i);this.addScales(i+"-line",a);var o=this.controlOption.updateWhenIdle;return this.mapsService.on(o?"moveend":"mapmove",this.update),this.mapsService.on(o?"zoomend":"zoomchange",this.update),this.update(),a}},{key:"onRemove",value:function(){var i=this.controlOption.updateWhenIdle;this.mapsService.off(i?"zoomend":"zoomchange",this.update),this.mapsService.off(i?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var i=this.mapsService,a=this.controlOption.maxWidth,o=i.getSize()[1]/2,s=i.containerToLngLat([0,o]),u=i.containerToLngLat([a,o]),l=Wre([s.lng,s.lat],[u.lng,u.lat]);this.updateScales(l)}},{key:"updateScales",value:function(i){var a=this.controlOption,o=a.metric,s=a.imperial;o&&i&&this.updateMetric(i),s&&i&&this.updateImperial(i)}},{key:"updateMetric",value:function(i){var a=this.getRoundNum(i),o=a<1e3?a+" m":a/1e3+" km";this.updateScale(this.mScale,o,a/i)}},{key:"updateImperial",value:function(i){var a=i*3.2808399,o,s,u;a>5280?(o=a/5280,s=this.getRoundNum(o),this.updateScale(this.iScale,s+" mi",s/o)):(u=this.getRoundNum(a),this.updateScale(this.iScale,u+" ft",u/a))}},{key:"updateScale",value:function(i,a,o){var s=this.controlOption.maxWidth;i.style.width=Math.round(s*o)+"px",i.innerHTML=a}},{key:"getRoundNum",value:function(i){var a=Math.pow(10,(Math.floor(i)+"").length-1),o=i/a;return o=o>=10?10:o>=5?5:o>=3?3:o>=2?2:1,a*o}},{key:"addScales",value:function(i,a){var o=this.controlOption,s=o.metric,u=o.imperial;s&&(this.mScale=xs("div",i,a)),u&&(this.iScale=xs("div",i,a))}}]),t}(MS);function G8e(e){var r=H8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function H8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var j8e=function(e){er(t,e);var r=G8e(t);function t(n){var i;return st(this,t),i=r.call(this,n),E1(["updateDisabled","zoomIn","zoomOut"],He(i)),i}return ot(t,[{key:"getDefault",value:function(){return{position:My.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var i="l7-control-zoom",a=xs("div",i+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,i+"-in",a,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,i+"-out",a,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),a}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(i,a,o,s,u){var l=xs("a",o,s);return l.innerHTML=i,l.title=a,l.href="javascript:void(0)",l.addEventListener("click",u),l}},{key:"updateDisabled",value:function(){var i=this.mapsService,a="l7-disabled";C2(this.zoomInButton,a),C2(this.zoomOutButton,a),(this.disabled||i.getZoom()<=i.getMinZoom())&&s_(this.zoomOutButton,a),(this.disabled||i.getZoom()>=i.getMaxZoom())&&s_(this.zoomInButton,a)}}]),t}(MS);function W8e(e){var r=X8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function X8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ane=function(e){er(t,e);var r=W8e(t);function t(n){var i;return st(this,t),i=r.call(this),X(He(i),"added",!1),X(He(i),"eventHandle",function(a){i.emit(a.type,{target:a,data:i.markerOption.extData,lngLat:i.lngLat})}),i.markerOption=Et(Et({},i.getDefault()),n),E1(["update","onMove","onUp","addDragHandler","onMapClick"],He(i)),i.init(),i}return ot(t,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:PE.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(i){this.scene=i,this.mapsService=i.get(Mt.IMapService),this.sceneSerive=i.get(Mt.ISceneService);var a=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(a),this.registerMarkerEvent(a),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var i=this.markerOption.element;return i&&n1(i),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(i){var a=this;if(!this.added)return this.once("added",function(){a.setElement(i)}),this;var o=this.markerOption.element;return o&&n1(o),this.markerOption.element=i,this.init(),this.mapsService.getMarkerContainer().appendChild(i),this.registerMarkerEvent(i),this.update(),this}},{key:"openPopup",value:function(){var i=this;if(!this.added)return this.once("added",function(){i.openPopup()}),this;var a=this.popup;return a?(a.isOpen()||a.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var i=this;this.added||this.once("added",function(){i.closePopup()});var a=this.popup;return a&&a.remove(),this}},{key:"setPopup",value:function(i){return this.popup=i,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var i=this.popup;if(i)i.isOpen()?i.remove():i.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(i){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(i){this.markerOption.extData=i}},{key:"update",value:function(){if(!!this.mapsService){var i=this.markerOption,a=i.element,o=i.anchor;this.updatePosition(),kB(a,"".concat(RE[o]))}}},{key:"onMapClick",value:function(i){var a=this.markerOption.element;this.popup&&a&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var i=this.mapsService.getContainer();return{containerHeight:(i==null?void 0:i.scrollHeight)||0,containerWidth:(i==null?void 0:i.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var i=this.markerOption,a=i.element,o=i.offsets,s=this.lngLat,u=s.lng,l=s.lat,f=this.mapsService.lngLatToContainer([u,l]);if(a){a.style.display="block",a.style.whiteSpace="nowrap";var h=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),p=h.containerHeight,v=h.containerWidth,m=h.bounds;if(!m)return;if(Math.abs(m[0][0])>180||Math.abs(m[1][0])>180){if(f.x>v){var x=this.mapsService.lngLatToContainer([u-360,l]);f.x=x.x}if(f.x<0){var E=this.mapsService.lngLatToContainer([u+360,l]);f.x=E.x}}(f.x>v||f.x<0||f.y>p||f.y<0)&&(a.style.display="none"),a.style.left=f.x+o[0]+"px",a.style.top=f.y-o[1]+"px"}}}},{key:"init",value:function(){var i=this,a=this.markerOption.element,o=this.markerOption,s=o.color,u=o.anchor;if(!a){this.defaultMarker=!0,a=xs("div"),this.markerOption.element=a;var l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height","48px"),l.setAttributeNS(null,"width","48px"),l.setAttributeNS(null,"viewBox","0 0 1024 1024");var f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),f.setAttributeNS(null,"fill",s),l.appendChild(f),a.appendChild(l)}s_(a,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(h){var p,v,m=((p=i.markerOption)===null||p===void 0?void 0:p.style)&&((v=i.markerOption)===null||v===void 0?void 0:v.style[h]);a&&(a.style[h]=m)}),a.addEventListener("click",function(h){i.onMapClick(h)}),a.addEventListener("click",this.eventHandle),BB(a,u,"marker")}},{key:"registerMarkerEvent",value:function(i){i.addEventListener("mousemove",this.eventHandle),i.addEventListener("click",this.eventHandle),i.addEventListener("mousedown",this.eventHandle),i.addEventListener("mouseup",this.eventHandle),i.addEventListener("dblclick",this.eventHandle),i.addEventListener("contextmenu",this.eventHandle),i.addEventListener("mouseover",this.eventHandle),i.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var i=this.getElement();i.removeEventListener("mousemove",this.eventHandle),i.removeEventListener("click",this.eventHandle),i.removeEventListener("mousedown",this.eventHandle),i.removeEventListener("mouseup",this.eventHandle),i.removeEventListener("dblclick",this.eventHandle),i.removeEventListener("contextmenu",this.eventHandle),i.removeEventListener("mouseover",this.eventHandle),i.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(i){throw new Error("Method not implemented.")}},{key:"onUp",value:function(i){throw new Error("Method not implemented.")}}]),t}(zf.exports.EventEmitter),Tne={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(jp,function(){function t(U,W,Q,te,ie,ve){if(!(ie-te<=Q)){var me=te+ie>>1;n(U,W,me,te,ie,ve%2),t(U,W,Q,te,me-1,ve+1),t(U,W,Q,me+1,ie,ve+1)}}function n(U,W,Q,te,ie,ve){for(;ie>te;){if(ie-te>600){var me=ie-te+1,Re=Q-te+1,We=Math.log(me),je=.5*Math.exp(2*We/3),lt=.5*Math.sqrt(We*je*(me-je)/me)*(Re-me/2<0?-1:1),dt=Math.max(te,Math.floor(Q-Re*je/me+lt)),ct=Math.min(ie,Math.floor(Q+(me-Re)*je/me+lt));n(U,W,Q,dt,ct,ve)}var Tt=W[2*Q+ve],It=te,Lt=ie;for(i(U,W,te,Q),W[2*ie+ve]>Tt&&i(U,W,te,ie);It<Lt;){for(i(U,W,It,Lt),It++,Lt--;W[2*It+ve]<Tt;)It++;for(;W[2*Lt+ve]>Tt;)Lt--}W[2*te+ve]===Tt?i(U,W,te,Lt):(Lt++,i(U,W,Lt,ie)),Lt<=Q&&(te=Lt+1),Q<=Lt&&(ie=Lt-1)}}function i(U,W,Q,te){a(U,Q,te),a(W,2*Q,2*te),a(W,2*Q+1,2*te+1)}function a(U,W,Q){var te=U[W];U[W]=U[Q],U[Q]=te}function o(U,W,Q,te,ie,ve,me){for(var Re=[0,U.length-1,0],We=[],je,lt;Re.length;){var dt=Re.pop(),ct=Re.pop(),Tt=Re.pop();if(ct-Tt<=me){for(var It=Tt;It<=ct;It++)je=W[2*It],lt=W[2*It+1],je>=Q&&je<=ie&&lt>=te&&lt<=ve&&We.push(U[It]);continue}var Lt=Math.floor((Tt+ct)/2);je=W[2*Lt],lt=W[2*Lt+1],je>=Q&&je<=ie&&lt>=te&&lt<=ve&&We.push(U[Lt]);var rn=(dt+1)%2;(dt===0?Q<=je:te<=lt)&&(Re.push(Tt),Re.push(Lt-1),Re.push(rn)),(dt===0?ie>=je:ve>=lt)&&(Re.push(Lt+1),Re.push(ct),Re.push(rn))}return We}function s(U,W,Q,te,ie,ve){for(var me=[0,U.length-1,0],Re=[],We=ie*ie;me.length;){var je=me.pop(),lt=me.pop(),dt=me.pop();if(lt-dt<=ve){for(var ct=dt;ct<=lt;ct++)u(W[2*ct],W[2*ct+1],Q,te)<=We&&Re.push(U[ct]);continue}var Tt=Math.floor((dt+lt)/2),It=W[2*Tt],Lt=W[2*Tt+1];u(It,Lt,Q,te)<=We&&Re.push(U[Tt]);var rn=(je+1)%2;(je===0?Q-ie<=It:te-ie<=Lt)&&(me.push(dt),me.push(Tt-1),me.push(rn)),(je===0?Q+ie>=It:te+ie>=Lt)&&(me.push(Tt+1),me.push(lt),me.push(rn))}return Re}function u(U,W,Q,te){var ie=U-Q,ve=W-te;return ie*ie+ve*ve}var l=function(U){return U[0]},f=function(U){return U[1]},h=function(W,Q,te,ie,ve){Q===void 0&&(Q=l),te===void 0&&(te=f),ie===void 0&&(ie=64),ve===void 0&&(ve=Float64Array),this.nodeSize=ie,this.points=W;for(var me=W.length<65536?Uint16Array:Uint32Array,Re=this.ids=new me(W.length),We=this.coords=new ve(W.length*2),je=0;je<W.length;je++)Re[je]=je,We[2*je]=Q(W[je]),We[2*je+1]=te(W[je]);t(Re,We,ie,0,Re.length-1,0)};h.prototype.range=function(W,Q,te,ie){return o(this.ids,this.coords,W,Q,te,ie,this.nodeSize)},h.prototype.within=function(W,Q,te){return s(this.ids,this.coords,W,Q,te,this.nodeSize)};var p={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(U){return U}},v=Math.fround||function(U){return function(W){return U[0]=+W,U[0]}}(new Float32Array(1)),m=function(W){this.options=j(Object.create(p),W),this.trees=new Array(this.options.maxZoom+1)};m.prototype.load=function(W){var Q=this.options,te=Q.log,ie=Q.minZoom,ve=Q.maxZoom,me=Q.nodeSize;te&&console.time("total time");var Re="prepare "+W.length+" points";te&&console.time(Re),this.points=W;for(var We=[],je=0;je<W.length;je++)!W[je].geometry||We.push(E(W[je],je));this.trees[ve+1]=new h(We,H,ee,me,Float32Array),te&&console.timeEnd(Re);for(var lt=ve;lt>=ie;lt--){var dt=+Date.now();We=this._cluster(We,lt),this.trees[lt]=new h(We,H,ee,me,Float32Array),te&&console.log("z%d: %d clusters in %dms",lt,We.length,+Date.now()-dt)}return te&&console.timeEnd("total time"),this},m.prototype.getClusters=function(W,Q){var te=((W[0]+180)%360+360)%360-180,ie=Math.max(-90,Math.min(90,W[1])),ve=W[2]===180?180:((W[2]+180)%360+360)%360-180,me=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)te=-180,ve=180;else if(te>ve){var Re=this.getClusters([te,ie,180,me],Q),We=this.getClusters([-180,ie,ve,me],Q);return Re.concat(We)}for(var je=this.trees[this._limitZoom(Q)],lt=je.range(k(te),R(me),k(ve),R(ie)),dt=[],ct=0,Tt=lt;ct<Tt.length;ct+=1){var It=Tt[ct],Lt=je.points[It];dt.push(Lt.numPoints?A(Lt):this.points[Lt.index])}return dt},m.prototype.getChildren=function(W){var Q=this._getOriginId(W),te=this._getOriginZoom(W),ie="No cluster with the specified id.",ve=this.trees[te];if(!ve)throw new Error(ie);var me=ve.points[Q];if(!me)throw new Error(ie);for(var Re=this.options.radius/(this.options.extent*Math.pow(2,te-1)),We=ve.within(me.x,me.y,Re),je=[],lt=0,dt=We;lt<dt.length;lt+=1){var ct=dt[lt],Tt=ve.points[ct];Tt.parentId===W&&je.push(Tt.numPoints?A(Tt):this.points[Tt.index])}if(je.length===0)throw new Error(ie);return je},m.prototype.getLeaves=function(W,Q,te){Q=Q||10,te=te||0;var ie=[];return this._appendLeaves(ie,W,Q,te,0),ie},m.prototype.getTile=function(W,Q,te){var ie=this.trees[this._limitZoom(W)],ve=Math.pow(2,W),me=this.options,Re=me.extent,We=me.radius,je=We/Re,lt=(te-je)/ve,dt=(te+1+je)/ve,ct={features:[]};return this._addTileFeatures(ie.range((Q-je)/ve,lt,(Q+1+je)/ve,dt),ie.points,Q,te,ve,ct),Q===0&&this._addTileFeatures(ie.range(1-je/ve,lt,1,dt),ie.points,ve,te,ve,ct),Q===ve-1&&this._addTileFeatures(ie.range(0,lt,je/ve,dt),ie.points,-1,te,ve,ct),ct.features.length?ct:null},m.prototype.getClusterExpansionZoom=function(W){for(var Q=this._getOriginZoom(W)-1;Q<=this.options.maxZoom;){var te=this.getChildren(W);if(Q++,te.length!==1)break;W=te[0].properties.cluster_id}return Q},m.prototype._appendLeaves=function(W,Q,te,ie,ve){for(var me=this.getChildren(Q),Re=0,We=me;Re<We.length;Re+=1){var je=We[Re],lt=je.properties;if(lt&&lt.cluster?ve+lt.point_count<=ie?ve+=lt.point_count:ve=this._appendLeaves(W,lt.cluster_id,te,ie,ve):ve<ie?ve++:W.push(je),W.length===te)break}return ve},m.prototype._addTileFeatures=function(W,Q,te,ie,ve,me){for(var Re=0,We=W;Re<We.length;Re+=1){var je=We[Re],lt=Q[je],dt=lt.numPoints,ct=void 0,Tt=void 0,It=void 0;if(dt)ct=L(lt),Tt=lt.x,It=lt.y;else{var Lt=this.points[lt.index];ct=Lt.properties,Tt=k(Lt.geometry.coordinates[0]),It=R(Lt.geometry.coordinates[1])}var rn={type:1,geometry:[[Math.round(this.options.extent*(Tt*ve-te)),Math.round(this.options.extent*(It*ve-ie))]],tags:ct},wn=void 0;dt?wn=lt.id:this.options.generateId?wn=lt.index:this.points[lt.index].id&&(wn=this.points[lt.index].id),wn!==void 0&&(rn.id=wn),me.features.push(rn)}},m.prototype._limitZoom=function(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))},m.prototype._cluster=function(W,Q){for(var te=[],ie=this.options,ve=ie.radius,me=ie.extent,Re=ie.reduce,We=ie.minPoints,je=ve/(me*Math.pow(2,Q)),lt=0;lt<W.length;lt++){var dt=W[lt];if(!(dt.zoom<=Q)){dt.zoom=Q;for(var ct=this.trees[Q+1],Tt=ct.within(dt.x,dt.y,je),It=dt.numPoints||1,Lt=It,rn=0,wn=Tt;rn<wn.length;rn+=1){var zn=wn[rn],Zt=ct.points[zn];Zt.zoom>Q&&(Lt+=Zt.numPoints||1)}if(Lt>It&&Lt>=We){for(var nn=dt.x*It,mn=dt.y*It,zt=Re&&It>1?this._map(dt,!0):null,Vr=(lt<<5)+(Q+1)+this.points.length,On=0,Si=Tt;On<Si.length;On+=1){var Fn=Si[On],Ai=ct.points[Fn];if(!(Ai.zoom<=Q)){Ai.zoom=Q;var Ua=Ai.numPoints||1;nn+=Ai.x*Ua,mn+=Ai.y*Ua,Ai.parentId=Vr,Re&&(zt||(zt=this._map(dt,!0)),Re(zt,this._map(Ai)))}}dt.parentId=Vr,te.push(x(nn/Lt,mn/Lt,Vr,Lt,zt))}else if(te.push(dt),Lt>1)for(var va=0,Va=Tt;va<Va.length;va+=1){var to=Va[va],Os=ct.points[to];Os.zoom<=Q||(Os.zoom=Q,te.push(Os))}}}return te},m.prototype._getOriginId=function(W){return W-this.points.length>>5},m.prototype._getOriginZoom=function(W){return(W-this.points.length)%32},m.prototype._map=function(W,Q){if(W.numPoints)return Q?j({},W.properties):W.properties;var te=this.points[W.index].properties,ie=this.options.map(te);return Q&&ie===te?j({},ie):ie};function x(U,W,Q,te,ie){return{x:v(U),y:v(W),zoom:1/0,id:Q,parentId:-1,numPoints:te,properties:ie}}function E(U,W){var Q=U.geometry.coordinates,te=Q[0],ie=Q[1];return{x:v(k(te)),y:v(R(ie)),zoom:1/0,index:W,parentId:-1}}function A(U){return{type:"Feature",id:U.id,properties:L(U),geometry:{type:"Point",coordinates:[D(U.x),$(U.y)]}}}function L(U){var W=U.numPoints,Q=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return j(j({},U.properties),{cluster:!0,cluster_id:U.id,point_count:W,point_count_abbreviated:Q})}function k(U){return U/360+.5}function R(U){var W=Math.sin(U*Math.PI/180),Q=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return Q<0?0:Q>1?1:Q}function D(U){return(U-.5)*360}function $(U){var W=(180-U*360)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function j(U,W){for(var Q in W)U[Q]=W[Q];return U}function H(U){return U.x}function ee(U){return U.y}return m})})(Tne);var Mne=Tne.exports;function Y8e(e){var r=Z8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Z8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q8e=function(e){er(t,e);var r=Y8e(t);function t(n){var i,a;return st(this,t),a=r.call(this),X(He(a),"markers",[]),X(He(a),"points",[]),X(He(a),"clusterMarkers",[]),a.markerLayerOption=Kt.exports.merge(a.getDefault(),n),E1(["update"],He(a)),a.zoom=((i=a.markerLayerOption.clusterOption)===null||i===void 0?void 0:i.zoom)||-99,a}return ot(t,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(i){return this.scene=i,this.mapsService=i.get(Mt.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this}},{key:"setContainerSize",value:function(){if(!!this.mapsService){var i=this.mapsService.getContainer();this.containerSize={containerWidth:(i==null?void 0:i.scrollWidth)||0,containerHeight:(i==null?void 0:i.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(i){var a=this.markerLayerOption.cluster;if(i.getMarkerLayerContainerSize=this.getContainerSize.bind(this),a&&(this.addPoint(i,this.markers.length),this.mapsService)){var o=this.mapsService.getZoom(),s=this.mapsService.getBounds();this.bbox=i1(s,.5),this.zoom=Math.floor(o),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(i)}},{key:"removeMarker",value:function(i){this.markers.indexOf(i);var a=this.markers.indexOf(i);a>-1&&this.markers.splice(a,1)}},{key:"hide",value:function(){this.markers.map(function(i){i.getElement().style.opacity="0"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(i){i.getElement().style.opacity="1"}),this.clusterMarkers.map(function(i){i.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var i=this.markerLayerOption.cluster;return i?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var i=this;this.getMarkers().forEach(function(a){a.addTo(i.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(i){i.remove()}),this.clusterMarkers.forEach(function(i){i.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(i,a){var o=i.getLnglat(),s=o.lng,u=o.lat,l={geometry:{type:"Point",coordinates:[s,u]},properties:Et(Et({},i.getExtData()),{},{marker_id:a})};this.points.push(l),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var i=this.markerLayerOption.clusterOption,a=i.radius,o=i.minZoom,s=o===void 0?0:o,u=i.maxZoom;this.clusterIndex=new Mne({radius:a,minZoom:s,maxZoom:u}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(i,a){var o=this,s=i[0].concat(i[1]),u=this.clusterIndex.getClusters(s,a);this.clusterMarkers.forEach(function(l){l.remove()}),this.clusterMarkers=[],u.forEach(function(l){var f,h=o.markerLayerOption.clusterOption,p=h.field,v=h.method;if((f=l.properties)!==null&&f!==void 0&&f.cluster_id){var m,x=o.getLeaves((m=l.properties)===null||m===void 0?void 0:m.cluster_id);if(l.properties.clusterData=x,p&&v){var E=x==null?void 0:x.map(function(D){var $=X({},p,D.properties[p]);return $}),A=vk(E,p),L=Rre(v,A),k="point_"+v;l.properties[k]=L.toFixed(2)}}var R=o.clusterMarker(l);o.clusterMarkers.push(R),R.addTo(o.scene)})}},{key:"getLeaves",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return i?this.clusterIndex.getLeaves(i,a,o):null}},{key:"clusterMarker",value:function(i){var a=this.markerLayerOption.clusterOption,o=a,s=o.element,u=s===void 0?this.generateElement.bind(this):s,l=new Ane({element:u(i)}).setLnglat({lng:i.geometry.coordinates[0],lat:i.geometry.coordinates[1]});return l}},{key:"normalMarker",value:function(i){var a=i.properties.marker_id;return this.markers[a]}},{key:"update",value:function(){if(!!this.mapsService&&this.markers.length!==0){var i=this.mapsService.getZoom(),a=this.mapsService.getBounds();(!this.bbox||Math.abs(i-this.zoom)>=1||!mk(this.bbox,a))&&(this.bbox=i1(a,.5),this.zoom=Math.floor(i),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(i){var a=xs("div","l7-marker-cluster"),o=xs("div","",a),s=xs("span","",o),u=this.markerLayerOption.clusterOption,l=u.field,f=u.method;i.properties.point_count=i.properties.point_count||1;var h=l&&f?i.properties["point_"+f]||i.properties[l]:i.properties.point_count;return s.textContent=h,a}}]),t}(zf.exports.EventEmitter);function K8e(e){var r=Q8e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Q8e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var J8e=function(e){er(t,e);var r=K8e(t);function t(n){var i;return st(this,t),i=r.call(this),i.popupOption=Et(Et({},i.getdefault()),n),E1(["update","onClickClose","remove"],He(i)),i}return ot(t,[{key:"addTo",value:function(i){var a=this;return this.mapsService=i.get(Mt.IMapService),this.sceneSerive=i.get(Mt.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=i,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){a.mapsService.on("click",a.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(i){var a=window.document.createDocumentFragment(),o=window.document.createElement("body"),s;for(o.innerHTML=i;s=o.firstChild,!!s;)a.appendChild(s);return this.setDOMContent(a)}},{key:"setLnglat",value:function(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(i){return this.setDOMContent(window.document.createTextNode(i))}},{key:"setMaxWidth",value:function(i){return this.popupOption.maxWidth=i,this.update(),this}},{key:"setDOMContent",value:function(i){return this.createContent(),this.content.appendChild(i),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&n1(this.content),this.content=xs("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=xs("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(i,a,o){var s=window.document.createElement(i);return a!==void 0&&(s.className=a),o&&o.appendChild(s),s}},{key:"removeDom",value:function(i){i.parentNode&&i.parentNode.removeChild(i)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:PE.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(i){i.stopPropagation&&i.stopPropagation(),this.remove()}},{key:"update",value:function(){var i=this,a=this.lngLat,o=this.popupOption,s=o.className,u=o.maxWidth,l=o.anchor;if(!(!this.mapsService||!a||!this.content)){var f=this.mapsService.getMarkerContainer();if(!this.container&&f){this.container=this.creatDom("div","l7-popup",f),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),s&&s.split(" ").forEach(function(p){return i.container.classList.add(p)});var h=this.popupOption.stopPropagation;h&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(p){i.container.addEventListener(p,function(v){v.stopPropagation()})}),this.container.style.whiteSpace="nowrap"}u&&this.container.style.maxWidth!==u&&(this.container.style.maxWidth=u),this.updatePosition(),kB(this.container,"".concat(RE[l])),BB(this.container,l,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var i=this.lngLat,a=i.lng,o=i.lat,s=this.popupOption.offsets,u=this.mapsService.lngLatToContainer([a,o]);this.container.style.left=u.x+s[0]+"px",this.container.style.top=u.y-s[1]+"px"}}}]),t}(zf.exports.EventEmitter);function eze(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var a=r.body||r.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):r.documentElement.appendChild(i)}var o=r.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(r.createTextNode(e)),i.appendChild(o),o}}eze(`.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
}

.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 5px;
}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}

.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-left: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-bottom: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-bottom: none;
  border-left: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-bottom: none;
  border-right: none;
  border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-left: none;
  border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  padding: 0;
  font-size: 25px;
  line-height: 20px;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
  display: none;
}

.l7-popup-track-pointer * {
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.l7-map:active .l7-popup-track-pointer {
  display: none;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
  -webkit-box-shadow: 0 0 1px rgba(0, 0, 0, 0.3);
          box-shadow: 0 0 1px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
}
.l7-bar a,
.l7-bar a:hover {
  background-color: #fff;
  width: 30px;
  height: 30px;
  font-size: 20px;
  display: block;
  text-align: center;
  text-decoration: none;
  color: #8e9dab;
}
.l7-bar a,
.l7-control-layers-toggle {
  background-position: 50% 50%;
  background-repeat: no-repeat;
  display: block;
}
.l7-bar a:hover {
  background-color: #f4f4f4;
}
.l7-bar a:first-child {
  border-top-left-radius: 2px;
  border-top-right-radius: 2px;
}
.l7-bar a:last-child {
  border-bottom-left-radius: 2px;
  border-bottom-right-radius: 2px;
  border-bottom: none;
}
.l7-bar a.l7-disabled {
  cursor: default;
  background-color: #f4f4f4;
  color: #bbb;
}

/* control positioning */

.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-hide {
  display: none;
}
.l7-control {
  position: relative;
  z-index: 800;
  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control {
  float: left;
  clear: both;
}
.l7-top,
.l7-bottom {
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-top {
  top: 0;
}
.l7-right {
  right: 0;
}
.l7-bottom {
  bottom: 0;
}
.l7-left {
  left: 0;
}
.l7-center {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-bottom.l7-center,
.l7-top.l7-center {
  width: 100%;
}
.l7-right.l7-center,
.l7-left.l7-center {
  height: 100%;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-top.l7-center,
.l7-left.l7-center {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}

.l7-bottom.l7-center,
.l7-right.l7-center {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}

.l7-center .l7-control {
  margin-right: 10px;
  margin-bottom: 10px;
}

.l7-control {
  float: left;
  clear: both;
}
.l7-right .l7-control {
  float: right;
}
.l7-top .l7-control {
  margin-top: 10px;
}
.l7-bottom .l7-control {
  margin-bottom: 10px;
}
.l7-left .l7-control {
  margin-left: 10px;
}
.l7-right .l7-control {
  margin-right: 10px;
}

/* attribution and scale controls */

.l7-control-container .l7-control-attribution {
  background: #fff;
  background: rgba(59, 58, 58, 0.7);
  margin: 0;
}
.l7-control-attribution,
.l7-control-scale-line {
  padding: 0 5px;
  color: #333;
}
.l7-control-attribution a {
  text-decoration: none;
}
.l7-control-attribution a:hover {
  text-decoration: underline;
}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
}
.l7-left .l7-control-scale {
  margin-left: 5px;
}
.l7-bottom .l7-control-scale {
  margin-bottom: 5px;
}
.l7-control-scale-line {
  border: 2px solid #000;
  border-top: none;
  color: #000;
  line-height: 1.1;
  padding: 2px 5px 1px;
  font-size: 11px;
  white-space: nowrap;
  overflow: hidden;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;

  background: #fff;
}
.l7-control-scale-line:not(:first-child) {
  border-top: 2px solid #777;
  border-bottom: none;
  margin-top: -2px;
}
.l7-control-scale-line:not(:first-child):not(:last-child) {
  border-bottom: 2px solid #777;
}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  border: 2px solid rgba(0, 0, 0, 0.2);
  background-clip: padding-box;
}
/*logo */

.l7-ctrl-logo {
  background-size: 100% 100%;
  width: 89px;
  height: 16px;
  margin: 0 0 -3px -3px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  background-repeat: no-repeat;
  cursor: pointer;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 2px;
}
.l7-control-layers-toggle {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
  width: 30px;
  height: 30px;
  background-size: 20px 20px;
}

.l7-touch .l7-control-layers-toggle {
  width: 44px;
  height: 44px;
}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
  display: none;
}
.l7-control-layers-expanded .l7-control-layers-list {
  display: block;
  position: relative;
}
.l7-control-layers-expanded {
  padding: 6px 10px 6px 6px;
  color: #59626b;
  background: #fff;
}
.l7-control-layers-scrollbar {
  overflow-y: scroll;
  overflow-x: hidden;
  padding-right: 5px;
}
.l7-control-layers-selector {
  margin-top: 2px;
  position: relative;
  top: 1px;
}
.l7-control-layers label {
  display: block;
  padding: 8px;
}
.l7-control-layers label input[type='radio'],
.l7-control-layers label input[type='checkbox'] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
  height: 0;
  border-top: 1px solid #d8d8d8;
  margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
}
.amap-logo {
  display: none !important;
}
`);var tze=Object.freeze(Object.defineProperty({__proto__:null,Control:MS,Logo:Sne,Scale:V8e,Zoom:j8e,Layers:B8e,Marker:Ane,Popup:J8e,MarkerLayer:q8e},Symbol.toStringTag,{value:"Module"})),Lne={},Ine={},mD=function(r){return Ine[r]},eg=function(r,t){Ine[r]=t},kne=function(r){return Lne[r]},S1=function(r,t){Lne[r]=t},vG={},fO={},hO=34,Qw=10,pO=13;function Pne(e){return new Function("d","return {"+e.map(function(r,t){return JSON.stringify(r)+": d["+t+'] || ""'}).join(",")+"}")}function rze(e,r){var t=Pne(e);return function(n,i){return r(t(n),i,e)}}function gG(e){var r=Object.create(null),t=[];return e.forEach(function(n){for(var i in n)i in r||t.push(r[i]=i)}),t}function ep(e,r){var t=e+"",n=t.length;return n<r?new Array(r-n+1).join(0)+t:t}function nze(e){return e<0?"-"+ep(-e,6):e>9999?"+"+ep(e,6):ep(e,4)}function ize(e){var r=e.getUTCHours(),t=e.getUTCMinutes(),n=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":nze(e.getUTCFullYear())+"-"+ep(e.getUTCMonth()+1,2)+"-"+ep(e.getUTCDate(),2)+(i?"T"+ep(r,2)+":"+ep(t,2)+":"+ep(n,2)+"."+ep(i,3)+"Z":n?"T"+ep(r,2)+":"+ep(t,2)+":"+ep(n,2)+"Z":t||r?"T"+ep(r,2)+":"+ep(t,2)+"Z":"")}function aze(e){var r=new RegExp('["'+e+`
\r]`),t=e.charCodeAt(0);function n(h,p){var v,m,x=i(h,function(E,A){if(v)return v(E,A-1);m=E,v=p?rze(E,p):Pne(E)});return x.columns=m||[],x}function i(h,p){var v=[],m=h.length,x=0,E=0,A,L=m<=0,k=!1;h.charCodeAt(m-1)===Qw&&--m,h.charCodeAt(m-1)===pO&&--m;function R(){if(L)return fO;if(k)return k=!1,vG;var $,j=x,H;if(h.charCodeAt(j)===hO){for(;x++<m&&h.charCodeAt(x)!==hO||h.charCodeAt(++x)===hO;);return($=x)>=m?L=!0:(H=h.charCodeAt(x++))===Qw?k=!0:H===pO&&(k=!0,h.charCodeAt(x)===Qw&&++x),h.slice(j+1,$-1).replace(/""/g,'"')}for(;x<m;){if((H=h.charCodeAt($=x++))===Qw)k=!0;else if(H===pO)k=!0,h.charCodeAt(x)===Qw&&++x;else if(H!==t)continue;return h.slice(j,$)}return L=!0,h.slice(j,m)}for(;(A=R())!==fO;){for(var D=[];A!==vG&&A!==fO;)D.push(A),A=R();p&&(D=p(D,E++))==null||v.push(D)}return v}function a(h,p){return h.map(function(v){return p.map(function(m){return f(v[m])}).join(e)})}function o(h,p){return p==null&&(p=gG(h)),[p.map(f).join(e)].concat(a(h,p)).join(`
`)}function s(h,p){return p==null&&(p=gG(h)),a(h,p).join(`
`)}function u(h){return h.map(l).join(`
`)}function l(h){return h.map(f).join(e)}function f(h){return h==null?"":h instanceof Date?ize(h):r.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:n,parseRows:i,format:o,formatBody:s,formatRows:u,formatRow:l,formatValue:f}}var oze=aze(","),sze=oze.parse,yD=cM;function cM(e,r){var t=e&&e.type,n;if(t==="FeatureCollection")for(n=0;n<e.features.length;n++)cM(e.features[n],r);else if(t==="GeometryCollection")for(n=0;n<e.geometries.length;n++)cM(e.geometries[n],r);else if(t==="Feature")cM(e.geometry,r);else if(t==="Polygon")mG(e.coordinates,r);else if(t==="MultiPolygon")for(n=0;n<e.coordinates.length;n++)mG(e.coordinates[n],r);return e}function mG(e,r){if(e.length!==0){yG(e[0],r);for(var t=1;t<e.length;t++)yG(e[t],!r)}}function yG(e,r){for(var t=0,n=0,i=0,a=e.length,o=a-1;i<a;o=i++){var s=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]),u=t+s;n+=Math.abs(t)>=Math.abs(s)?t-u+s:s-u+t,t=u}t+n>=0!=!!r&&e.reverse()}function uze(e,r){var t,n,i,a,o,s,u,l,f,h,p=0,v=e.type==="FeatureCollection",m=e.type==="Feature",x=v?e.features.length:1;for(t=0;t<x;t++){for(s=v?e.features[t].geometry:m?e.geometry:e,l=v?e.features[t].properties:m?e.properties:{},f=v?e.features[t].bbox:m?e.bbox:void 0,h=v?e.features[t].id:m?e.id:void 0,u=s?s.type==="GeometryCollection":!1,o=u?s.geometries.length:1,i=0;i<o;i++){if(a=u?s.geometries[i]:s,a===null){if(r(null,p,l,f,h)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(a,p,l,f,h)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(r(a.geometries[n],p,l,f,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}p++}}function Rne(e,r){uze(e,function(t,n,i,a,o){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return r(E2(t,i,{bbox:a,id:o}),n,0)===!1?!1:void 0}var u;switch(s){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var l=0;l<t.coordinates.length;l++){var f=t.coordinates[l],h={type:u,coordinates:f};if(r(E2(h,i),n,l)===!1)return!1}})}function One(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function HE(e){return e.type==="Feature"?e.geometry:e}function Fne(e,r){var t=r.x,n=r.y,i=r.x1,a=r.y1,o=r.coordinates,s=r.geometry,u=[];if(!Array.isArray(e))return{dataArray:[]};if(s)return e.filter(function(L){return L[s]&&L[s].type&&L[s].coordinates&&L[s].coordinates.length>0}).forEach(function(L,k){var R=Et({},L[s]),D=yD(R,!0);Rne(D,function($){var j=One($),H=Et(Et({},L),{},{_id:k,coordinates:j});u.push(H)})}),{dataArray:u};for(var l=0;l<e.length;l++){var f=e[l],h=[];if(o){var p="Polygon";Array.isArray(o[0])||(p="Point"),Array.isArray(o[0])&&!Array.isArray(o[0][0])&&(p="LineString");var v={type:p,coordinates:Pr(f[o])},m=yD(v,!0);h=m.coordinates}else if(t&&n&&i&&a){var x=[parseFloat(f[t]),parseFloat(f[n])],E=[parseFloat(f[i]),parseFloat(f[a])];h=[x,E]}else t&&n&&(h=[parseFloat(f[t]),parseFloat(f[n])]);var A=Et(Et({},f),{},{_id:l,coordinates:h});u.push(A)}return{dataArray:u}}function lze(e,r){var t=sze(e);return Fne(t,r)}function cze(e){for(var r=e.toString(),t=5381,n=r.length;n;)t=t*33^r.charCodeAt(--n);return t>>>0}function fze(e,r){return r===void 0?null:r==="id"&&e.id?e.id:e[r]?e[r]:e.properties&&e.properties[r]?cze(e.properties[r]+"")%1000019:null}function hze(e,r){var t=[],n={};return e.features?(e.features=e.features.filter(function(i){var a=i.geometry;return i!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),yD(e,!0),e.features.length===0?{dataArray:[],featureKeys:n}:(Rne(e,function(i,a){var o=fze(i,r==null?void 0:r.featureId);o===null&&(o=a);var s=o,u=One(i),l=Et(Et({},i.properties),{},{coordinates:u,_id:s});t.push(l)}),{dataArray:t,featureKeys:n})):(e.features=[],{dataArray:[]})}function Dne(e,r){var t=r.extent,n=t===void 0?[121.168,30.2828,121.384,30.4219]:t,i=new Promise(function(o){e instanceof HTMLImageElement||Ore(e)?o([e]):pze(e,function(s){o(s)})}),a={originData:e,images:i,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return a}function pze(e,r){var t=e,n=[];if(typeof t=="string")sL({url:t},function(o,s){s&&(n.push(s),r(n))});else{var i=t.length,a=0;t.forEach(function(o){sL({url:o},function(s,u){a++,u&&n.push(u),a===i&&r(n)})})}return Dne}var dze=r2;function r2(e,r){this.x=e,this.y=r}r2.prototype={clone:function(){return new r2(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,r){return this.clone()._rotateAround(e,r)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var r=e.x-this.x,t=e.y-this.y;return r*r+t*t},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,r){return Math.atan2(this.x*r-this.y*e,this.x*e+this.y*r)},_matMult:function(e){var r=e[0]*this.x+e[1]*this.y,t=e[2]*this.x+e[3]*this.y;return this.x=r,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var r=Math.cos(e),t=Math.sin(e),n=r*this.x-t*this.y,i=t*this.x+r*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,r){var t=Math.cos(e),n=Math.sin(e),i=r.x+t*(this.x-r.x)-n*(this.y-r.y),a=r.y+n*(this.x-r.x)+t*(this.y-r.y);return this.x=i,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};r2.convert=function(e){return e instanceof r2?e:Array.isArray(e)?new r2(e[0],e[1]):e};var vze=dze,gze=S2;function S2(e,r,t,n,i){this.properties={},this.extent=t,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(mze,this,r)}function mze(e,r,t){e==1?r.id=t.readVarint():e==2?yze(t,r):e==3?r.type=t.readVarint():e==4&&(r._geometry=t.pos)}function yze(e,r){for(var t=e.readVarint()+e.pos;e.pos<t;){var n=r._keys[e.readVarint()],i=r._values[e.readVarint()];r.properties[n]=i}}S2.types=["Unknown","Point","LineString","Polygon"];S2.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var r=e.readVarint()+e.pos,t=1,n=0,i=0,a=0,o=[],s;e.pos<r;){if(n<=0){var u=e.readVarint();t=u&7,n=u>>3}if(n--,t===1||t===2)i+=e.readSVarint(),a+=e.readSVarint(),t===1&&(s&&o.push(s),s=[]),s.push(new vze(i,a));else if(t===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+t)}return s&&o.push(s),o};S2.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var r=e.readVarint()+e.pos,t=1,n=0,i=0,a=0,o=1/0,s=-1/0,u=1/0,l=-1/0;e.pos<r;){if(n<=0){var f=e.readVarint();t=f&7,n=f>>3}if(n--,t===1||t===2)i+=e.readSVarint(),a+=e.readSVarint(),i<o&&(o=i),i>s&&(s=i),a<u&&(u=a),a>l&&(l=a);else if(t!==7)throw new Error("unknown command "+t)}return[o,u,s,l]};S2.prototype.toGeoJSON=function(e,r,t){var n=this.extent*Math.pow(2,t),i=this.extent*e,a=this.extent*r,o=this.loadGeometry(),s=S2.types[this.type],u,l;function f(v){for(var m=0;m<v.length;m++){var x=v[m],E=180-(x.y+a)*360/n;v[m]=[(x.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(E*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(u=0;u<o.length;u++)h[u]=o[u][0];o=h,f(o);break;case 2:for(u=0;u<o.length;u++)f(o[u]);break;case 3:for(o=_ze(o),u=0;u<o.length;u++)for(l=0;l<o[u].length;l++)f(o[u][l]);break}o.length===1?o=o[0]:s="Multi"+s;var p={type:"Feature",geometry:{type:s,coordinates:o},properties:this.properties};return"id"in this&&(p.id=this.id),p};function _ze(e){var r=e.length;if(r<=1)return[e];for(var t=[],n,i,a=0;a<r;a++){var o=xze(e[a]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(n&&t.push(n),n=[e[a]]):n.push(e[a]))}return n&&t.push(n),t}function xze(e){for(var r=0,t=0,n=e.length,i=n-1,a,o;t<n;i=t++)a=e[t],o=e[i],r+=(o.x-a.x)*(a.y+o.y);return r}var bze=gze,wze=Bne;function Bne(e,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Cze,this,r),this.length=this._features.length}function Cze(e,r,t){e===15?r.version=t.readVarint():e===1?r.name=t.readString():e===5?r.extent=t.readVarint():e===2?r._features.push(t.pos):e===3?r._keys.push(t.readString()):e===4&&r._values.push(Eze(t))}function Eze(e){for(var r=null,t=e.readVarint()+e.pos;e.pos<t;){var n=e.readVarint()>>3;r=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return r}Bne.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var r=this._pbf.readVarint()+this._pbf.pos;return new bze(this._pbf,r,this.extent,this._keys,this._values)};var Sze=wze,Aze=Tze;function Tze(e,r){this.layers=e.readFields(Mze,{},r)}function Mze(e,r,t){if(e===3){var n=new Sze(t,t.readVarint()+t.pos);n.length&&(r[n.name]=n)}}var Lze=Aze,JB={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */JB.read=function(e,r,t,n,i){var a,o,s=i*8-n-1,u=(1<<s)-1,l=u>>1,f=-7,h=t?i-1:0,p=t?-1:1,v=e[r+h];for(h+=p,a=v&(1<<-f)-1,v>>=-f,f+=s;f>0;a=a*256+e[r+h],h+=p,f-=8);for(o=a&(1<<-f)-1,a>>=-f,f+=n;f>0;o=o*256+e[r+h],h+=p,f-=8);if(a===0)a=1-l;else{if(a===u)return o?NaN:(v?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-l}return(v?-1:1)*o*Math.pow(2,a-n)};JB.write=function(e,r,t,n,i,a){var o,s,u,l=a*8-i-1,f=(1<<l)-1,h=f>>1,p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=n?0:a-1,m=n?1:-1,x=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(s=isNaN(r)?1:0,o=f):(o=Math.floor(Math.log(r)/Math.LN2),r*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+h>=1?r+=p/u:r+=p*Math.pow(2,1-h),r*u>=2&&(o++,u/=2),o+h>=f?(s=0,o=f):o+h>=1?(s=(r*u-1)*Math.pow(2,i),o=o+h):(s=r*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[t+v]=s&255,v+=m,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[t+v]=o&255,v+=m,o/=256,l-=8);e[t+v-m]|=x*128};var Ize=Jo,vT=JB;function Jo(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Jo.Varint=0;Jo.Fixed64=1;Jo.Bytes=2;Jo.Fixed32=5;var _D=(1<<16)*(1<<16),_G=1/_D,kze=12,Nne=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");Jo.prototype={destroy:function(){this.buf=null},readFields:function(e,r,t){for(t=t||this.length;this.pos<t;){var n=this.readVarint(),i=n>>3,a=this.pos;this.type=n&7,e(i,r,this),this.pos===a&&this.skip(n)}return r},readMessage:function(e,r){return this.readFields(e,r,this.readVarint()+this.pos)},readFixed32:function(){var e=gT(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=bG(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=gT(this.buf,this.pos)+gT(this.buf,this.pos+4)*_D;return this.pos+=8,e},readSFixed64:function(){var e=gT(this.buf,this.pos)+bG(this.buf,this.pos+4)*_D;return this.pos+=8,e},readFloat:function(){var e=vT.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=vT.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var r=this.buf,t,n;return n=r[this.pos++],t=n&127,n<128||(n=r[this.pos++],t|=(n&127)<<7,n<128)||(n=r[this.pos++],t|=(n&127)<<14,n<128)||(n=r[this.pos++],t|=(n&127)<<21,n<128)?t:(n=r[this.pos],t|=(n&15)<<28,Pze(t,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,r=this.pos;return this.pos=e,e-r>=kze&&Nne?Wze(this.buf,r,e):jze(this.buf,r,e)},readBytes:function(){var e=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,e);return this.pos=e,r},readPackedVarint:function(e,r){if(this.type!==Jo.Bytes)return e.push(this.readVarint(r));var t=Hm(this);for(e=e||[];this.pos<t;)e.push(this.readVarint(r));return e},readPackedSVarint:function(e){if(this.type!==Jo.Bytes)return e.push(this.readSVarint());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Jo.Bytes)return e.push(this.readBoolean());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Jo.Bytes)return e.push(this.readFloat());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Jo.Bytes)return e.push(this.readDouble());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Jo.Bytes)return e.push(this.readFixed32());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Jo.Bytes)return e.push(this.readSFixed32());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Jo.Bytes)return e.push(this.readFixed64());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Jo.Bytes)return e.push(this.readSFixed64());var r=Hm(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed64());return e},skip:function(e){var r=e&7;if(r===Jo.Varint)for(;this.buf[this.pos++]>127;);else if(r===Jo.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Jo.Fixed32)this.pos+=4;else if(r===Jo.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+r)},writeTag:function(e,r){this.writeVarint(e<<3|r)},realloc:function(e){for(var r=this.length||16;r<this.pos+e;)r*=2;if(r!==this.length){var t=new Uint8Array(r);t.set(this.buf),this.buf=t,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),wb(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),wb(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),wb(this.buf,e&-1,this.pos),wb(this.buf,Math.floor(e*_G),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),wb(this.buf,e&-1,this.pos),wb(this.buf,Math.floor(e*_G),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){Rze(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var r=this.pos;this.pos=Xze(this.buf,e,this.pos);var t=this.pos-r;t>=128&&xG(r,t,this),this.pos=r-1,this.writeVarint(t),this.pos+=t},writeFloat:function(e){this.realloc(4),vT.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),vT.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var r=e.length;this.writeVarint(r),this.realloc(r);for(var t=0;t<r;t++)this.buf[this.pos++]=e[t]},writeRawMessage:function(e,r){this.pos++;var t=this.pos;e(r,this);var n=this.pos-t;n>=128&&xG(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,r,t){this.writeTag(e,Jo.Bytes),this.writeRawMessage(r,t)},writePackedVarint:function(e,r){r.length&&this.writeMessage(e,Dze,r)},writePackedSVarint:function(e,r){r.length&&this.writeMessage(e,Bze,r)},writePackedBoolean:function(e,r){r.length&&this.writeMessage(e,$ze,r)},writePackedFloat:function(e,r){r.length&&this.writeMessage(e,Nze,r)},writePackedDouble:function(e,r){r.length&&this.writeMessage(e,zze,r)},writePackedFixed32:function(e,r){r.length&&this.writeMessage(e,Uze,r)},writePackedSFixed32:function(e,r){r.length&&this.writeMessage(e,Vze,r)},writePackedFixed64:function(e,r){r.length&&this.writeMessage(e,Gze,r)},writePackedSFixed64:function(e,r){r.length&&this.writeMessage(e,Hze,r)},writeBytesField:function(e,r){this.writeTag(e,Jo.Bytes),this.writeBytes(r)},writeFixed32Field:function(e,r){this.writeTag(e,Jo.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(e,r){this.writeTag(e,Jo.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(e,r){this.writeTag(e,Jo.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(e,r){this.writeTag(e,Jo.Fixed64),this.writeSFixed64(r)},writeVarintField:function(e,r){this.writeTag(e,Jo.Varint),this.writeVarint(r)},writeSVarintField:function(e,r){this.writeTag(e,Jo.Varint),this.writeSVarint(r)},writeStringField:function(e,r){this.writeTag(e,Jo.Bytes),this.writeString(r)},writeFloatField:function(e,r){this.writeTag(e,Jo.Fixed32),this.writeFloat(r)},writeDoubleField:function(e,r){this.writeTag(e,Jo.Fixed64),this.writeDouble(r)},writeBooleanField:function(e,r){this.writeVarintField(e,Boolean(r))}};function Pze(e,r,t){var n=t.buf,i,a;if(a=n[t.pos++],i=(a&112)>>4,a<128||(a=n[t.pos++],i|=(a&127)<<3,a<128)||(a=n[t.pos++],i|=(a&127)<<10,a<128)||(a=n[t.pos++],i|=(a&127)<<17,a<128)||(a=n[t.pos++],i|=(a&127)<<24,a<128)||(a=n[t.pos++],i|=(a&1)<<31,a<128))return bb(e,i,r);throw new Error("Expected varint not more than 10 bytes")}function Hm(e){return e.type===Jo.Bytes?e.readVarint()+e.pos:e.pos+1}function bb(e,r,t){return t?r*4294967296+(e>>>0):(r>>>0)*4294967296+(e>>>0)}function Rze(e,r){var t,n;if(e>=0?(t=e%4294967296|0,n=e/4294967296|0):(t=~(-e%4294967296),n=~(-e/4294967296),t^4294967295?t=t+1|0:(t=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),Oze(t,n,r),Fze(n,r)}function Oze(e,r,t){t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos]=e&127}function Fze(e,r){var t=(e&7)<<4;r.buf[r.pos++]|=t|((e>>>=3)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127)))))}function xG(e,r,t){var n=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(Math.LN2*7));t.realloc(n);for(var i=t.pos-1;i>=e;i--)t.buf[i+n]=t.buf[i]}function Dze(e,r){for(var t=0;t<e.length;t++)r.writeVarint(e[t])}function Bze(e,r){for(var t=0;t<e.length;t++)r.writeSVarint(e[t])}function Nze(e,r){for(var t=0;t<e.length;t++)r.writeFloat(e[t])}function zze(e,r){for(var t=0;t<e.length;t++)r.writeDouble(e[t])}function $ze(e,r){for(var t=0;t<e.length;t++)r.writeBoolean(e[t])}function Uze(e,r){for(var t=0;t<e.length;t++)r.writeFixed32(e[t])}function Vze(e,r){for(var t=0;t<e.length;t++)r.writeSFixed32(e[t])}function Gze(e,r){for(var t=0;t<e.length;t++)r.writeFixed64(e[t])}function Hze(e,r){for(var t=0;t<e.length;t++)r.writeSFixed64(e[t])}function gT(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+e[r+3]*16777216}function wb(e,r,t){e[t]=r,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24}function bG(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+(e[r+3]<<24)}function jze(e,r,t){for(var n="",i=r;i<t;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s>t)break;var u,l,f;s===1?a<128&&(o=a):s===2?(u=e[i+1],(u&192)===128&&(o=(a&31)<<6|u&63,o<=127&&(o=null))):s===3?(u=e[i+1],l=e[i+2],(u&192)===128&&(l&192)===128&&(o=(a&15)<<12|(u&63)<<6|l&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):s===4&&(u=e[i+1],l=e[i+2],f=e[i+3],(u&192)===128&&(l&192)===128&&(f&192)===128&&(o=(a&15)<<18|(u&63)<<12|(l&63)<<6|f&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,s=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),i+=s}return n}function Wze(e,r,t){return Nne.decode(e.subarray(r,t))}function Xze(e,r,t){for(var n=0,i,a;n<r.length;n++){if(i=r.charCodeAt(n),i>55295&&i<57344)if(a)if(i<56320){e[t++]=239,e[t++]=191,e[t++]=189,a=i;continue}else i=a-55296<<10|i-56320|65536,a=null;else{i>56319||n+1===r.length?(e[t++]=239,e[t++]=191,e[t++]=189):a=i;continue}else a&&(e[t++]=239,e[t++]=191,e[t++]=189,a=null);i<128?e[t++]=i:(i<2048?e[t++]=i>>6|192:(i<65536?e[t++]=i>>12|224:(e[t++]=i>>18|240,e[t++]=i>>12&63|128),e[t++]=i>>6&63|128),e[t++]=i&63|128)}return t}var Yze={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},Zze=function(){var e=Hi(Xr.mark(function r(t,n,i){var a;return Xr.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=e2(t,n),s.abrupt("return",new Promise(function(u){var l=gk({url:a},function(f,h){if(f||!h)u({layers:{}});else{for(var p=new Lze(new Ize(h)),v=0,m=Object.keys(p.layers);v<m.length;v++){for(var x=m[v],E=[],A=p.layers[x],L=0;L<p.layers[x].length;L++){var k=p.layers[x].feature(L),R=k.toGeoJSON(n.x,n.y,n.z);E.push(R)}A.features=E}u(p)}});i.xhrCancel=function(){return l.abort()}}));case 2:case"end":return s.stop()}},r)}));return function(t,n,i){return e.apply(this,arguments)}}();function qze(e,r){var t=Array.isArray(e)?e[0]:e,n=function(o,s){return Zze(t,o,s)},i=Et(Et(Et({},Yze),r),{},{getTileData:n});return{data:t,dataArray:[],tilesetOptions:i,isTile:!0}}function xD(e,r,t,n){for(var i=n,a=t-r>>1,o=t-r,s,u=e[r],l=e[r+1],f=e[t],h=e[t+1],p=r+3;p<t;p+=3){var v=Kze(e[p],e[p+1],u,l,f,h);if(v>i)s=p,i=v;else if(v===i){var m=Math.abs(p-a);m<o&&(s=p,o=m)}}i>n&&(s-r>3&&xD(e,r,s,n),e[s+2]=i,t-s>3&&xD(e,s,t,n))}function Kze(e,r,t,n,i,a){var o=i-t,s=a-n;if(o!==0||s!==0){var u=((e-t)*o+(r-n)*s)/(o*o+s*s);u>1?(t=i,n=a):u>0&&(t+=o*u,n+=s*u)}return o=e-t,s=r-n,o*o+s*s}function jE(e,r,t,n){var i={id:typeof e=="undefined"?null:e,type:r,geometry:t,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Qze(i),i}function Qze(e){var r=e.geometry,t=e.type;if(t==="Point"||t==="MultiPoint"||t==="LineString")dO(e,r);else if(t==="Polygon"||t==="MultiLineString")for(var n=0;n<r.length;n++)dO(e,r[n]);else if(t==="MultiPolygon")for(n=0;n<r.length;n++)for(var i=0;i<r[n].length;i++)dO(e,r[n][i])}function dO(e,r){for(var t=0;t<r.length;t+=3)e.minX=Math.min(e.minX,r[t]),e.minY=Math.min(e.minY,r[t+1]),e.maxX=Math.max(e.maxX,r[t]),e.maxY=Math.max(e.maxY,r[t+1])}function Jze(e,r){var t=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)fM(t,e.features[n],r,n);else e.type==="Feature"?fM(t,e,r):fM(t,{geometry:e},r);return t}function fM(e,r,t,n){if(!!r.geometry){var i=r.geometry.coordinates,a=r.geometry.type,o=Math.pow(t.tolerance/((1<<t.maxZoom)*t.extent),2),s=[],u=r.id;if(t.promoteId?u=r.properties[t.promoteId]:t.generateId&&(u=n||0),a==="Point")wG(i,s);else if(a==="MultiPoint")for(var l=0;l<i.length;l++)wG(i[l],s);else if(a==="LineString")bD(i,s,o,!1);else if(a==="MultiLineString")if(t.lineMetrics){for(l=0;l<i.length;l++)s=[],bD(i[l],s,o,!1),e.push(jE(u,"LineString",s,r.properties));return}else vO(i,s,o,!1);else if(a==="Polygon")vO(i,s,o,!0);else if(a==="MultiPolygon")for(l=0;l<i.length;l++){var f=[];vO(i[l],f,o,!0),s.push(f)}else if(a==="GeometryCollection"){for(l=0;l<r.geometry.geometries.length;l++)fM(e,{id:u,geometry:r.geometry.geometries[l],properties:r.properties},t,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(jE(u,a,s,r.properties))}}function wG(e,r){r.push(zne(e[0])),r.push($ne(e[1])),r.push(0)}function bD(e,r,t,n){for(var i,a,o=0,s=0;s<e.length;s++){var u=zne(e[s][0]),l=$ne(e[s][1]);r.push(u),r.push(l),r.push(0),s>0&&(n?o+=(i*l-u*a)/2:o+=Math.sqrt(Math.pow(u-i,2)+Math.pow(l-a,2))),i=u,a=l}var f=r.length-3;r[2]=1,xD(r,0,f,t),r[f+2]=1,r.size=Math.abs(o),r.start=0,r.end=r.size}function vO(e,r,t,n){for(var i=0;i<e.length;i++){var a=[];bD(e[i],a,t,n),r.push(a)}}function zne(e){return e/360+.5}function $ne(e){var r=Math.sin(e*Math.PI/180),t=.5-.25*Math.log((1+r)/(1-r))/Math.PI;return t<0?0:t>1?1:t}function Jm(e,r,t,n,i,a,o,s){if(t/=r,n/=r,a>=t&&o<n)return e;if(o<t||a>=n)return null;for(var u=[],l=0;l<e.length;l++){var f=e[l],h=f.geometry,p=f.type,v=i===0?f.minX:f.minY,m=i===0?f.maxX:f.maxY;if(v>=t&&m<n){u.push(f);continue}else if(m<t||v>=n)continue;var x=[];if(p==="Point"||p==="MultiPoint")e9e(h,x,t,n,i);else if(p==="LineString")Une(h,x,t,n,i,!1,s.lineMetrics);else if(p==="MultiLineString")gO(h,x,t,n,i,!1);else if(p==="Polygon")gO(h,x,t,n,i,!0);else if(p==="MultiPolygon")for(var E=0;E<h.length;E++){var A=[];gO(h[E],A,t,n,i,!0),A.length&&x.push(A)}if(x.length){if(s.lineMetrics&&p==="LineString"){for(E=0;E<x.length;E++)u.push(jE(f.id,p,x[E],f.tags));continue}(p==="LineString"||p==="MultiLineString")&&(x.length===1?(p="LineString",x=x[0]):p="MultiLineString"),(p==="Point"||p==="MultiPoint")&&(p=x.length===3?"Point":"MultiPoint"),u.push(jE(f.id,p,x,f.tags))}}return u.length?u:null}function e9e(e,r,t,n,i){for(var a=0;a<e.length;a+=3){var o=e[a+i];o>=t&&o<=n&&(r.push(e[a]),r.push(e[a+1]),r.push(e[a+2]))}}function Une(e,r,t,n,i,a,o){for(var s=CG(e),u=i===0?t9e:r9e,l=e.start,f,h,p=0;p<e.length-3;p+=3){var v=e[p],m=e[p+1],x=e[p+2],E=e[p+3],A=e[p+4],L=i===0?v:m,k=i===0?E:A,R=!1;o&&(f=Math.sqrt(Math.pow(v-E,2)+Math.pow(m-A,2))),L<t?k>t&&(h=u(s,v,m,E,A,t),o&&(s.start=l+f*h)):L>n?k<n&&(h=u(s,v,m,E,A,n),o&&(s.start=l+f*h)):mO(s,v,m,x),k<t&&L>=t&&(h=u(s,v,m,E,A,t),R=!0),k>n&&L<=n&&(h=u(s,v,m,E,A,n),R=!0),!a&&R&&(o&&(s.end=l+f*h),r.push(s),s=CG(e)),o&&(l+=f)}var D=e.length-3;v=e[D],m=e[D+1],x=e[D+2],L=i===0?v:m,L>=t&&L<=n&&mO(s,v,m,x),D=s.length-3,a&&D>=3&&(s[D]!==s[0]||s[D+1]!==s[1])&&mO(s,s[0],s[1],s[2]),s.length&&r.push(s)}function CG(e){var r=[];return r.size=e.size,r.start=e.start,r.end=e.end,r}function gO(e,r,t,n,i,a){for(var o=0;o<e.length;o++)Une(e[o],r,t,n,i,a,!1)}function mO(e,r,t,n){e.push(r),e.push(t),e.push(n)}function t9e(e,r,t,n,i,a){var o=(a-r)/(n-r);return e.push(a),e.push(t+(i-t)*o),e.push(1),o}function r9e(e,r,t,n,i,a){var o=(a-t)/(i-t);return e.push(r+(n-r)*o),e.push(a),e.push(1),o}function n9e(e,r){var t=r.buffer/r.extent,n=e,i=Jm(e,1,-1-t,t,0,-1,2,r),a=Jm(e,1,1-t,2+t,0,-1,2,r);return(i||a)&&(n=Jm(e,1,-t,1+t,0,-1,2,r)||[],i&&(n=EG(i,1).concat(n)),a&&(n=n.concat(EG(a,-1)))),n}function EG(e,r){for(var t=[],n=0;n<e.length;n++){var i=e[n],a=i.type,o;if(a==="Point"||a==="MultiPoint"||a==="LineString")o=yO(i.geometry,r);else if(a==="MultiLineString"||a==="Polygon"){o=[];for(var s=0;s<i.geometry.length;s++)o.push(yO(i.geometry[s],r))}else if(a==="MultiPolygon")for(o=[],s=0;s<i.geometry.length;s++){for(var u=[],l=0;l<i.geometry[s].length;l++)u.push(yO(i.geometry[s][l],r));o.push(u)}t.push(jE(i.id,a,o,i.tags))}return t}function yO(e,r){var t=[];t.size=e.size,e.start!==void 0&&(t.start=e.start,t.end=e.end);for(var n=0;n<e.length;n+=3)t.push(e[n]+r,e[n+1],e[n+2]);return t}function SG(e,r){if(e.transformed)return e;var t=1<<e.z,n=e.x,i=e.y,a,o,s;for(a=0;a<e.features.length;a++){var u=e.features[a],l=u.geometry,f=u.type;if(u.geometry=[],f===1)for(o=0;o<l.length;o+=2)u.geometry.push(AG(l[o],l[o+1],r,t,n,i));else for(o=0;o<l.length;o++){var h=[];for(s=0;s<l[o].length;s+=2)h.push(AG(l[o][s],l[o][s+1],r,t,n,i));u.geometry.push(h)}}return e.transformed=!0,e}function AG(e,r,t,n,i,a){return[Math.round(t*(e*n-i)),Math.round(t*(r*n-a))]}function i9e(e,r,t,n,i){for(var a=r===i.maxZoom?0:i.tolerance/((1<<r)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:t,y:n,z:r,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,a9e(o,e[s],a,i);var u=e[s].minX,l=e[s].minY,f=e[s].maxX,h=e[s].maxY;u<o.minX&&(o.minX=u),l<o.minY&&(o.minY=l),f>o.maxX&&(o.maxX=f),h>o.maxY&&(o.maxY=h)}return o}function a9e(e,r,t,n){var i=r.geometry,a=r.type,o=[];if(a==="Point"||a==="MultiPoint")for(var s=0;s<i.length;s+=3)o.push(i[s]),o.push(i[s+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")_O(o,i,e,t,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(s=0;s<i.length;s++)_O(o,i[s],e,t,a==="Polygon",s===0);else if(a==="MultiPolygon")for(var u=0;u<i.length;u++){var l=i[u];for(s=0;s<l.length;s++)_O(o,l[s],e,t,!0,s===0)}if(o.length){var f=r.tags||null;if(a==="LineString"&&n.lineMetrics){f={};for(var h in r.tags)f[h]=r.tags[h];f.mapbox_clip_start=i.start/i.size,f.mapbox_clip_end=i.end/i.size}var p={geometry:o,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:f};r.id!==null&&(p.id=r.id),e.features.push(p)}}function _O(e,r,t,n,i,a){var o=n*n;if(n>0&&r.size<(i?o:n)){t.numPoints+=r.length/3;return}for(var s=[],u=0;u<r.length;u+=3)(n===0||r[u+2]>o)&&(t.numSimplified++,s.push(r[u]),s.push(r[u+1])),t.numPoints++;i&&o9e(s,a),e.push(s)}function o9e(e,r){for(var t=0,n=0,i=e.length,a=i-2;n<i;a=n,n+=2)t+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(t>0===r)for(n=0,i=e.length;n<i/2;n+=2){var o=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=o,e[i-1-n]=s}}function s9e(e,r){return new Ek(e,r)}function Ek(e,r){r=this.options=u9e(Object.create(this.options),r);var t=r.debug;if(t&&console.time("preprocess data"),r.maxZoom<0||r.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(r.promoteId&&r.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Jze(e,r);this.tiles={},this.tileCoords=[],t&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",r.indexMaxZoom,r.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=n9e(n,r),n.length&&this.splitTile(n,0,0,0),t&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ek.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};Ek.prototype.splitTile=function(e,r,t,n,i,a,o){for(var s=[e,r,t,n],u=this.options,l=u.debug;s.length;){n=s.pop(),t=s.pop(),r=s.pop(),e=s.pop();var f=1<<r,h=wD(r,t,n),p=this.tiles[h];if(!p&&(l>1&&console.time("creation"),p=this.tiles[h]=i9e(e,r,t,n,u),this.tileCoords.push({z:r,x:t,y:n}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",r,t,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var v="z"+r;this.stats[v]=(this.stats[v]||0)+1,this.total++}if(p.source=e,i){if(r===u.maxZoom||r===i)continue;var m=1<<i-r;if(t!==Math.floor(a/m)||n!==Math.floor(o/m))continue}else if(r===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(p.source=null,e.length!==0){l>1&&console.time("clipping");var x=.5*u.buffer/u.extent,E=.5-x,A=.5+x,L=1+x,k,R,D,$,j,H;k=R=D=$=null,j=Jm(e,f,t-x,t+A,0,p.minX,p.maxX,u),H=Jm(e,f,t+E,t+L,0,p.minX,p.maxX,u),e=null,j&&(k=Jm(j,f,n-x,n+A,1,p.minY,p.maxY,u),R=Jm(j,f,n+E,n+L,1,p.minY,p.maxY,u),j=null),H&&(D=Jm(H,f,n-x,n+A,1,p.minY,p.maxY,u),$=Jm(H,f,n+E,n+L,1,p.minY,p.maxY,u),H=null),l>1&&console.timeEnd("clipping"),s.push(k||[],r+1,t*2,n*2),s.push(R||[],r+1,t*2,n*2+1),s.push(D||[],r+1,t*2+1,n*2),s.push($||[],r+1,t*2+1,n*2+1)}}};Ek.prototype.getTile=function(e,r,t){var n=this.options,i=n.extent,a=n.debug;if(e<0||e>24)return null;var o=1<<e;r=(r%o+o)%o;var s=wD(e,r,t);if(this.tiles[s])return SG(this.tiles[s],i);a>1&&console.log("drilling down to z%d-%d-%d",e,r,t);for(var u=e,l=r,f=t,h;!h&&u>0;)u--,l=Math.floor(l/2),f=Math.floor(f/2),h=this.tiles[wD(u,l,f)];return!h||!h.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",u,l,f),a>1&&console.time("drilling down"),this.splitTile(h.source,u,l,f,e,r,t),a>1&&console.timeEnd("drilling down"),this.tiles[s]?SG(this.tiles[s],i):null)};function wD(e,r,t){return((1<<e)*t+r)*32+e}function u9e(e,r){for(var t in r)e[t]=r[t];return e}var l9e={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function c9e(e){for(var r=0,t=0,n=e.length,i=n-1,a,o;t<n;i=t++)a=e[t],o=e[i],r+=(o.x-a.x)*(a.y+o.y);return r}function f9e(e){var r=e.length;if(r<=1)return[e];for(var t=[],n,i,a=0;a<r;a++){var o=c9e(e[a]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(n&&t.push(n),n=[e[a]]):n.push(e[a]))}return n&&t.push(n),t}var h9e=["Unknown","Point","LineString","Polygon"];function p9e(e,r,t,n,i){var a=i.geometry,o=i.type,s=i.tags,u=i.id,l=e*Math.pow(2,n),f=e*r,h=e*t,p=h9e[o],v,m;function x(L){for(var k=0;k<L.length;k++){var R=L[k];if(R[3])break;var D=180-(R[1]+h)*360/l,$=(R[0]+f)*360/l-180,j=360/Math.PI*Math.atan(Math.exp(D*Math.PI/180))-90;L[k]=[$,j,0,1]}}switch(o){case 1:var E=[];for(v=0;v<a.length;v++)E[v]=a[v][0];a=E,x(a);break;case 2:for(v=0;v<a.length;v++)x(a[v]);break;case 3:for(a=f9e(a),v=0;v<a.length;v++)for(m=0;m<a[v].length;m++)x(a[v][m]);break}a.length===1?a=a[0]:p="Multi"+p;var A={type:"Feature",geometry:{type:p,coordinates:a},properties:s,id:u,tileOrigin:[0,0],coord:""};return A}var d9e=function(){var e=Hi(Xr.mark(function r(t,n,i,a){return Xr.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise(function(u){var l=n.getTile(t.z,t.x,t.y),f=[];l.features.map(function(p){var v=p9e(a,i.x,i.y,i.z,p);f.push(v)});var h={layers:{geojsonvt:{features:f}}};u(h)}));case 1:case"end":return s.stop()}},r)}));return function(t,n,i,a){return e.apply(this,arguments)}}();function v9e(e){var r={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"||(e.geojsonvtOptions.maxZoom&&(r.maxZoom=e.geojsonvtOptions.maxZoom),e.geojsonvtOptions.indexMaxZoom&&(r.indexMaxZoom=e.geojsonvtOptions.indexMaxZoom),e.geojsonvtOptions.indexMaxPoints&&(r.indexMaxPoints=e.geojsonvtOptions.indexMaxPoints),e.geojsonvtOptions.tolerance&&(r.tolerance=e.geojsonvtOptions.tolerance),e.geojsonvtOptions.extent&&(r.extent=e.geojsonvtOptions.extent),e.geojsonvtOptions.buffer&&(r.buffer=e.geojsonvtOptions.buffer),e.geojsonvtOptions.lineMetrics&&(r.lineMetrics=e.geojsonvtOptions.lineMetrics),e.geojsonvtOptions.promoteId&&(r.promoteId=e.geojsonvtOptions.promoteId),e.geojsonvtOptions.generateId&&(r.generateId=e.geojsonvtOptions.generateId),e.geojsonvtOptions.debug&&(r.debug=e.geojsonvtOptions.debug)),r}function g9e(e,r){var t=v9e(r),n=t.extent||4096,i=s9e(e,t),a=function(u,l){return d9e(l,i,u,n)},o=Et(Et(Et({},l9e),r),{},{getTileData:a});return{data:e,dataArray:[],tilesetOptions:o,isTile:!0}}function m9e(e,r,t){switch(e){case"+":return r+t;case"-":return r-t;case"*":return r*t;case"/":return r/t;case"%":return r%t;case"^":return Math.pow(r,t);case"abs":return Math.abs(r);case"floor":return Math.floor(r);case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"sin":return Math.sin(r);case"cos":return Math.cos(r);case"atan":return t===-1?Math.atan(r):Math.atan2(r,t);default:return console.warn("Calculate symbol err! Return default 0"),0}}function hM(e,r){for(var t=r[0],n=t.width,i=t.height,a=r.map(function(v){return v.rasterData}),o=n*i,s=[],u=JSON.stringify(e),l=0;l<o;l++){var f=JSON.parse(u),h=Vne(f,a,l);if(typeof h=="number")s.push(h);else{var p=CD(f);s.push(p)}}return s}function Vne(e,r,t){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return r[e[1]][t]}catch{return console.warn("Raster Data err!"),0}e.map(function(n,i){if(Array.isArray(n)&&n.length>0)switch(n[0]){case"band":try{e[i]=r[n[1]][t]}catch{console.warn("Raster Data err!"),e[i]=0}break;default:Vne(n,r,t)}})}function y9e(e){var r=tn(e,3),t=r[0],n=r[1],i=n===void 0?-1:n,a=r[2],o=a===void 0?-1:a;if(t===void 0)return console.warn("Express err!"),["+",0,0];var s=t.replace(/\s+/g,"");return[s,i,o]}function CD(e){var r=y9e(e),t=r[0],n=r[1],i=r[2];return Array.isArray(n)&&(n=CD(e[1])),Array.isArray(i)&&(i=CD(e[2])),m9e(t,n,i)}function e6(e,r,t){return ED.apply(this,arguments)}function ED(){return ED=Hi(Xr.mark(function e(r,t,n){var i,a,o,s,u,l,f,h,p,v,m,x,E,A;return Xr.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(r.length!==0){k.next=2;break}return k.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return k.next=4,Promise.all(r.map(function(R){var D=R.data,$=R.bands,j=$===void 0?[0]:$;return t(D,j)}));case 4:i=k.sent,i=i.flat(),a=i[0],o=a.width,s=a.height,l=void 0,f=void 0,h=void 0,k.t0=em(n),k.next=k.t0==="function"?13:k.t0==="object"?15:17;break;case 13:return u=n(i),k.abrupt("break",18);case 15:return Array.isArray(n)?u=hM(n,i):(p=_9e(n,i),v=x9e(p),m=v.data,x=v.channelRMax,E=v.channelGMax,A=v.channelBMax,u=m,l=x,f=E,h=A),k.abrupt("break",18);case 17:u=i[0].rasterData;case 18:return k.abrupt("return",{rasterData:u,width:o,height:s,channelR:l,channelG:f,channelB:h});case 19:case"end":return k.stop()}},e)})),ED.apply(this,arguments)}function _9e(e,r){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var t=hM(e.r||["band",0],r),n=hM(e.g||["band",0],r),i=hM(e.b||["band",0],r);return[t,n,i]}function x9e(e){for(var r=e[0],t=e[1],n=e[2],i=[],a=-1/0,o=-1/0,s=-1/0,u=0;u<r.length;u++)i.push(r[u]),a=Math.max(a,r[u]),i.push(t[u]),o=Math.max(o,r[u]),i.push(n[u]),s=Math.max(s,r[u]);return{data:i,channelRMax:a,channelGMax:o,channelBMax:s}}function TG(e,r,t,n){return SD.apply(this,arguments)}function SD(){return SD=Hi(Xr.mark(function e(r,t,n,i){var a,o,s,u,l,f;return Xr.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,e6(r,t,n);case 2:a=p.sent,o=a.rasterData,s=a.width,u=a.height,l=0,f=8e3,i(null,{data:o,width:s,height:u,min:l,max:f});case 9:case"end":return p.stop()}},e)})),SD.apply(this,arguments)}function b9e(e,r){return e.map(function(t){return t[r]*1})}function Gne(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function w9e(e,r){var t=r.extent,n=r.width,i=r.height,a=r.min,o=r.max,s=r.format,u=r.operation,l,f,h;if(s===void 0||Gne(e))l=Array.from(e),f=n,h=i;else{var p=Array.isArray(e)?e:[e];l=e6(p,s,u)}var v={_id:1,dataArray:[{_id:1,data:l,width:f,height:h,min:a,max:o,coordinates:[[t[0],t[1]],[t[2],t[3]]]}]};return v}function C9e(e,r){var t=r.extent,n=r.width,i=r.height,a=r.min,o=r.max,s=r.format,u=r.operation,l,f,h;if(s===void 0||Gne(e))l=Array.from(e),f=n,h=i;else{var p=Array.isArray(e)?e:[e];l=e6(p,s,u)}var v={_id:1,dataArray:[{_id:1,data:l,width:f,height:h,min:a,max:o,coordinates:[[t[0],t[1]],[t[2],t[3]]]}]};return v}var Hg;(function(e){e.IMAGE="image",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb"})(Hg||(Hg={}));function E9e(e,r){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(t){return e2(t,r)}):e.map(function(t){return{url:e2(t.url,r),bands:t.bands||[0]}}):e2(e,r)}function S9e(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(r){return{url:r,bands:[0]}}):e}function MG(e,r){e.xhrCancel=function(){r.map(function(t){t.abort()})}}var A9e=function(){var e=Hi(Xr.mark(function r(t,n,i,a,o){var s,u,l,f,h,p;return Xr.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=S9e(n.url),!(s.length>1)){m.next=15;break}return m.next=4,T9e(s,n);case 4:if(u=m.sent,l=u.rasterFiles,f=u.xhrList,h=u.errList,MG(t,f),!(h.length>0)){m.next=12;break}return i(h,null),m.abrupt("return");case 12:TG(l,a,o,i),m.next=17;break;case 15:p=gk(n,function(x,E){if(x)i(x);else if(E){var A=[{data:E,bands:s[0].bands}];TG(A,a,o,i)}}),MG(t,[p]);case 17:case"end":return m.stop()}},r)}));return function(t,n,i,a,o){return e.apply(this,arguments)}}();function T9e(e,r){return AD.apply(this,arguments)}function AD(){return AD=Hi(Xr.mark(function e(r,t){var n,i,a,o,s,u,l,f,h,p,v;return Xr.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:n=[],i=[],a=[],o=0;case 4:if(!(o<r.length)){x.next=20;break}return s=r[o],u=Et(Et({},t),{},{url:s.url}),l=s.bands,x.next=10,Nre(Et(Et({},u),{},{type:"arrayBuffer"}));case 10:f=x.sent,h=f.err,p=f.data,v=f.xhr,h&&a.push(h),i.push(v),n.push({data:p,bands:l});case 17:o++,x.next=4;break;case 20:return x.abrupt("return",{rasterFiles:n,xhrList:i,errList:a});case 21:case"end":return x.stop()}},e)})),AD.apply(this,arguments)}var M9e=function(){var e=Hi(Xr.mark(function r(t,n,i,a,o){var s;return Xr.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return s={url:E9e(t,n)},l.abrupt("return",new Promise(function(f,h){A9e(i,s,function(p,v){p?h(p):v&&f(v)},a,o)}));case 2:case"end":return l.stop()}},r)}));return function(t,n,i,a,o){return e.apply(this,arguments)}}(),LG=function(){var e=Hi(Xr.mark(function r(t,n,i){var a;return Xr.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=e2(Array.isArray(t)?t[0]:t,n),s.abrupt("return",new Promise(function(u,l){var f=sL({url:a},function(h,p){h?l(h):p&&u(p)});i.xhrCancel=function(){return f.abort()}}));case 2:case"end":return s.stop()}},r)}));return function(t,n,i){return e.apply(this,arguments)}}(),L9e=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},I9e={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},Hne=[Hg.ARRAYBUFFER,Hg.RGB];function k9e(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function P9e(e,r){if(k9e(e))throw new Error("tile server url is error");var t=(r==null?void 0:r.dataType)||Hg.IMAGE;t===Hg.RGB&&(t=Hg.ARRAYBUFFER);var n=function(o,s){switch(t){case Hg.IMAGE:return LG(e,o,s);case Hg.ARRAYBUFFER:return M9e(e,o,s,(r==null?void 0:r.format)||L9e,r==null?void 0:r.operation);default:return LG(e,o,s)}},i=Et(Et(Et({},I9e),r),{},{getTileData:n});return{data:e,dataArray:[],tilesetOptions:i,isTile:!0}}var R9e={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},O9e=function(){var e=Hi(Xr.mark(function r(t){return Xr.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise(function(a){var o=tn(t.bounds,4),s=o[0],u=o[1],l=o[2],f=o[3],h={layers:{testTile:{features:[{type:"Feature",properties:{key:t.x+"/"+t.y+"/"+t.z,textLng:(s+l)/2,textLat:(u+f)/2},geometry:{type:"LineString",coordinates:[[l,f],[l,u],[s,u],[s,u]]}}]}}};a(h)}));case 1:case"end":return i.stop()}},r)}));return function(t){return e.apply(this,arguments)}}();function F9e(e,r){var t=function(a){return O9e(a)},n=Et(Et(Et({},R9e),r),{},{getTileData:t});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}function jne(e,r){var t=r.radius,n=t===void 0?40:t,i=r.maxZoom,a=i===void 0?18:i,o=r.minZoom,s=o===void 0?0:o,u=r.zoom,l=u===void 0?2:u;if(e.pointIndex){var f=e.pointIndex.getClusters(e.extent,Math.floor(l));return e.dataArray=D9e(f),e}var h=new Mne({radius:n,minZoom:s,maxZoom:a}),p={type:"FeatureCollection",features:[]};return p.features=e.dataArray.map(function(v){return{type:"Feature",geometry:{type:"Point",coordinates:v.coordinates},properties:Et({},v)}}),h.load(p.features),h}function D9e(e){return e.map(function(r,t){return Et({coordinates:r.geometry.coordinates,_id:t+1},r.properties)})}function B9e(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]>r&&(r=e[t]);return r}function N9e(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],t=1;t<e.length;t++)e[t]<r&&(r=e[t]);return r}function Wne(e){if(e.length===0)return 0;for(var r=e[0],t=0,n,i=1;i<e.length;i++)n=r+e[i]*1,Math.abs(r)>=Math.abs(e[i])?t+=r-n+e[i]:t+=e[i]-n+r,r=n;return r+t*1}function z9e(e){if(e.length===0)throw new Error("mean requires at least one data point");return Wne(e)/e.length}var $9e={min:N9e,max:B9e,mean:z9e,sum:Wne};function U9e(e){var r=V9e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function V9e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function G9e(e,r){if(Array.isArray(r))return r}var q2=function(e){er(t,e);var r=U9e(t);function t(n,i){var a;return st(this,t),a=r.call(this),X(He(a),"type","source"),X(He(a),"inited",!1),X(He(a),"hooks",{init:new Bg}),X(He(a),"parser",{type:"geojson"}),X(He(a),"transforms",[]),X(He(a),"cluster",!1),X(He(a),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),X(He(a),"invalidExtent",!1),X(He(a),"dataArrayChanged",!1),X(He(a),"cfg",{}),a.originData=n,a.initCfg(i),a.init(),a}return ot(t,[{key:"getClusters",value:function(i){return this.clusterIndex.getClusters(this.caculClusterExtent(2),i)}},{key:"getClustersLeaves",value:function(i){return this.clusterIndex.getLeaves(i,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(i){var a=this,o=this.clusterOptions,s=o.method,u=s===void 0?"sum":s,l=o.field,f=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(i));this.clusterOptions.zoom=i,f.forEach(function(h){h.id||(h.properties.point_count=1)}),(l||Kt.exports.isFunction(u))&&(f=f.map(function(h){var p=h.id;if(p){var v=a.clusterIndex.getLeaves(p,1/0),m=v.map(function(A){return A.properties}),x;if(Kt.exports.isString(u)&&l){var E=b9e(m,l);x=$9e[u](E)}Kt.exports.isFunction(u)&&(x=u(m)),h.properties.stat=x}else h.properties.point_count=1;return h})),this.data=mD("geojson")({type:"FeatureCollection",features:f}),this.executeTrans()}},{key:"getFeatureById",value:function(i){var a=this.parser,o=a.type,s=o===void 0?"geojson":o,u=a.geometry;if(s==="geojson"&&!this.cluster){var l=i<this.originData.features.length?this.originData.features[i]:"null",f=Kt.exports.cloneDeep(l);if(f!=null&&f.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var h=this.data.dataArray.find(function(p){return p._id===i});f.properties=h}return f}else return s==="json"&&u?this.data.dataArray.find(function(p){return p._id===i}):i<this.data.dataArray.length?this.data.dataArray[i]:"null"}},{key:"updateFeaturePropertiesById",value:function(i,a){this.data.dataArray=this.data.dataArray.map(function(o){return o._id===i?Et(Et({},o),a):o}),this.dataArrayChanged=!0,this.emit("update")}},{key:"getFeatureId",value:function(i,a){var o=this.data.dataArray.find(function(s){return s[i]===a});return o==null?void 0:o._id}},{key:"setData",value:function(i,a){this.originData=i,this.dataArrayChanged=!1,this.initCfg(a),this.init()}},{key:"destroy",value:function(){var i;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(i=this.tileset)===null||i===void 0||i.destroy()}},{key:"handleData",value:function(){var i=this;return new Promise(function(a,o){try{i.excuteParser(),i.initCluster(),i.executeTrans(),a({})}catch(s){o(s)}})}},{key:"initCfg",value:function(i){this.cfg=Kt.exports.mergeWith(this.cfg,i,G9e);var a=this.cfg;a&&(a.parser&&(this.parser=a.parser),a.transforms&&(this.transforms=a.transforms),this.cluster=a.cluster||!1,a.clusterOptions&&(this.cluster=!0,this.clusterOptions=Et(Et({},this.clusterOptions),a.clusterOptions)))}},{key:"init",value:function(){var i=this;this.inited=!1,this.handleData().then(function(){i.inited=!0,i.emit("update")})}},{key:"excuteParser",value:function(){var i=this.parser,a=i.type||"geojson",o=mD(a);this.data=o(this.originData,i),this.tileset=this.initTileset(),!i.cancelExtent&&(this.extent=zre(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(i){this.center=[(i[0]+i[2])/2,(i[1]+i[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var i=this.data.tilesetOptions;if(!!i){if(this.tileset)return this.tileset.updateOptions(i),this.tileset;var a=new vne(Et({},i));return a}}},{key:"executeTrans",value:function(){var i=this,a=this.transforms;a.forEach(function(o){var s=o.type,u=kne(s)(i.data,o);Object.assign(i.data,u)})}},{key:"initCluster",value:function(){if(!!this.cluster){var i=this.clusterOptions||{};this.clusterIndex=jne(this.data,i)}}},{key:"caculClusterExtent",value:function(i){var a=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(a=i1(kE(this.extent),i)),a[0].concat(a[1])}}]),t}(zf.exports.EventEmitter);function H9e(e,r){var t=r.callback;return t&&(e.dataArray=e.dataArray.filter(t)),e}function IG(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=j9e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function j9e(e,r){if(!!e){if(typeof e=="string")return kG(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return kG(e,r)}}function kG(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var t6=6378e3;function W9e(e,r){var t=e.dataArray,n=r.size,i=n===void 0?10:n,a=i/(2*Math.PI*t6)*(256<<20)/2,o=X9e(t,i),s=o.gridHash,u=o.gridOffset,l=K9e(s,u,r);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:l}}function X9e(e,r){var t=1/0,n=-1/0,i,a=IG(e),o;try{for(a.s();!(o=a.n()).done;){var s=o.value;i=s.coordinates[1],Number.isFinite(i)&&(t=i<t?i:t,n=i>n?i:n)}}catch(k){a.e(k)}finally{a.f()}var u=(t+n)/2,l=Y9e(r,u);if(l.xOffset<=0||l.yOffset<=0)return{gridHash:{},gridOffset:l};var f={},h=IG(e),p;try{for(h.s();!(p=h.n()).done;){var v=p.value,m=v.coordinates[1],x=v.coordinates[0];if(Number.isFinite(m)&&Number.isFinite(x)){var E=Math.floor((m+90)/l.yOffset),A=Math.floor((x+180)/l.xOffset),L="".concat(E,"-").concat(A);f[L]=f[L]||{count:0,points:[]},f[L].count+=1,f[L].points.push(v)}}}catch(k){h.e(k)}finally{h.f()}return{gridHash:f,gridOffset:l}}function Y9e(e,r){var t=Z9e(e),n=q9e(r,e);return{yOffset:t,xOffset:n}}function Z9e(e){return e/t6*(180/Math.PI)}function q9e(e,r){return r/t6*(180/Math.PI)/Math.cos(e*Math.PI/180)}function K9e(e,r,t){return Object.keys(e).reduce(function(n,i,a){var o=i.split("-"),s=parseInt(o[0],10),u=parseInt(o[1],10),l={};if(t.field&&t.method){var f=vk(e[i].points,t.field);l[t.method]=dk[t.method](f)}return Object.assign(l,{_id:a,coordinates:nc([-180+r.xOffset*(u+.5),-90+r.yOffset*(s+.5)]),rawData:e[i].points,count:e[i].count}),n.push(l),n},[])}var Db=Math.PI/3,Q9e=[0,Db,2*Db,3*Db,4*Db,5*Db];function J9e(e){return e[0]}function e$e(e){return e[1]}function t$e(){var e=0,r=0,t=1,n=1,i=J9e,a=e$e,o,s,u;function l(h){var p={},v=[],m,x=h.length;for(m=0;m<x;++m)if(!(isNaN(A=+i.call(null,E=h[m],m,h))||isNaN(L=+a.call(null,E,m,h)))){var E,A,L,k=Math.round(L=L/u),R=Math.round(A=A/s-(k&1)/2),D=L-k;if(Math.abs(D)*3>1){var $=A-R,j=R+(A<R?-1:1)/2,H=k+(L<k?-1:1),ee=A-j,U=L-H;$*$+D*D>ee*ee+U*U&&(R=j+(k&1?1:-1)/2,k=H)}var W=R+"-"+k,Q=p[W];Q?Q.push(E):(v.push(Q=p[W]=[E]),Q.x=(R+(k&1)/2)*s,Q.y=k*u)}return v}function f(h){var p=0,v=0;return Q9e.map(function(m){var x=Math.sin(m)*h,E=-Math.cos(m)*h,A=x-p,L=E-v;return p=x,v=E,[A,L]})}return l.hexagon=function(h){return"m"+f(h==null?o:+h).join("l")+"z"},l.centers=function(){for(var h=[],p=Math.round(r/u),v=Math.round(e/s),m=p*u;m<n+o;m+=u,++p)for(var x=v*s+(p&1)*s/2;x<t+s/2;x+=s)h.push([x,m]);return h},l.mesh=function(){var h=f(o).slice(0,4).join("l");return l.centers().map(function(p){return"M"+p+"m"+h}).join("")},l.x=function(h){return arguments.length?(i=h,l):i},l.y=function(h){return arguments.length?(a=h,l):a},l.radius=function(h){return arguments.length?(o=+h,s=o*2*Math.sin(Db),u=o*1.5,l):o},l.size=function(h){return arguments.length?(e=r=0,t=+h[0],n=+h[1],l):[t-e,n-r]},l.extent=function(h){return arguments.length?(e=+h[0][0],r=+h[0][1],t=+h[1][0],n=+h[1][1],l):[[e,r],[t,n]]},l.radius(1)}var r$e=6378e3;function n$e(e,r){var t=e.dataArray,n=r.size,i=n===void 0?10:n,a=r.method,o=a===void 0?"sum":a,s=i/(2*Math.PI*r$e)*(256<<20)/2,u=t.map(function(p){var v=nc(p.coordinates),m=tn(v,2),x=m[0],E=m[1];return Et(Et({},p),{},{coordinates:[x,E]})}),l=t$e().radius(s).x(function(p){return p.coordinates[0]}).y(function(p){return p.coordinates[1]}),f=l(u),h={dataArray:f.map(function(p,v){var m;if(r.field&&o){var x=vk(p,r.field);p[o]=dk[o](x)}return m={},X(m,r.method,p[o]),X(m,"count",p.length),X(m,"rawData",p),X(m,"coordinates",[p.x,p.y]),X(m,"_id",v),m}),radius:s,xOffset:s,yOffset:s,type:"hexagon"};return h}function i$e(e,r){var t=r.sourceField,n=r.targetField,i=r.data,a={};return i.forEach(function(o){a[o[t]]=o}),e.dataArray=e.dataArray.map(function(o){var s=o[n];return Et(Et({},o),a[s])}),e}function a$e(e,r){var t=r.callback;return t&&(e.dataArray=e.dataArray.map(t)),e}eg("rasterTile",P9e);eg("mvt",qze);eg("geojsonvt",g9e);eg("testTile",F9e);eg("geojson",hze);eg("image",Dne);eg("csv",lze);eg("json",Fne);eg("raster",w9e);eg("rasterRgb",C9e);S1("cluster",jne);S1("filter",H9e);S1("join",i$e);S1("map",a$e);S1("grid",W9e);S1("hexagon",n$e);var o$e=Object.freeze(Object.defineProperty({__proto__:null,rasterDataTypes:Hne,default:q2,getTransform:kne,registerTransform:S1,getParser:mD,registerParser:eg,get RasterTileType(){return Hg}},Symbol.toStringTag,{value:"Module"})),p0,TD=(p0={},X(p0,Fd.additive,{enable:!0,func:{srcRGB:K.ONE,dstRGB:K.ONE,srcAlpha:1,dstAlpha:1}}),X(p0,Fd.none,{enable:!1}),X(p0,Fd.normal,{enable:!0,func:{srcRGB:K.SRC_ALPHA,dstRGB:K.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),X(p0,Fd.subtractive,{enable:!0,func:{srcRGB:K.ONE,dstRGB:K.ONE,srcAlpha:K.ZERO,dstAlpha:K.ONE_MINUS_SRC_COLOR},equation:{rgb:K.FUNC_SUBTRACT,alpha:K.FUNC_SUBTRACT}}),X(p0,Fd.max,{enable:!0,func:{srcRGB:K.ONE,dstRGB:K.ONE},equation:{rgb:K.MAX_EXT}}),X(p0,Fd.min,{enable:!0,func:{srcRGB:K.ONE,dstRGB:K.ONE},equation:{rgb:K.MIN_EXT}}),p0);function nh(e,r,t,n,i){r.updateStyleAttribute(e,t,n,i)}function s$e(e,r){r.tileLayer||r.isTileLayer||(e.opacity&&mT("opacity",r,e.opacity),e.strokeWidth&&mT("strokeWidth",r,e.strokeWidth),e.strokeOpacity&&mT("strokeOpacity",r,e.strokeOpacity),e.stroke&&u$e("stroke",r,e.stroke),e.offsets&&PG("offsets",r,e.offsets),e.textOffset&&PG("textOffset",r,e.textOffset),e.thetaOffset&&mT("thetaOffset",r,e.thetaOffset))}function mT(e,r,t){Kt.exports.isString(t)?nh(e,r,t,function(n){return n}):Kt.exports.isNumber(t)?nh(e,r,[t],void 0):Array.isArray(t)&&t.length===2?Kt.exports.isString(t[0])&&Kt.exports.isFunction(t[1])||Kt.exports.isString(t[0])&&Array.isArray(t[1])&&Kt.exports.isNumber(t[1][0])&&Kt.exports.isNumber(t[1][1])?nh(e,r,t[0],t[1]):nh(e,r,[1],void 0):nh(e,r,[1],void 0)}function PG(e,r,t){Kt.exports.isString(t)?nh(e,r,t,function(n){return n}):Array.isArray(t)&&t.length===2&&Kt.exports.isString(t[0])&&Kt.exports.isFunction(t[1])?nh(e,r,t[0],t[1]):Array.isArray(t)&&t.length===2&&Kt.exports.isNumber(t[0])&&Kt.exports.isNumber(t[1])?nh(e,r,t,void 0):nh(e,r,[0,0],void 0)}function u$e(e,r,t){Kt.exports.isString(t)?nh(e,r,t,void 0):Array.isArray(t)&&t.length===2&&(Kt.exports.isString(t[0])&&Kt.exports.isFunction(t[1])||Kt.exports.isString(t[0])&&Array.isArray(t[1])&&t[1].length>0)?nh(e,r,t[0],t[1]):nh(e,r,"#fff",void 0)}var RG,xO,OG,K2=(RG=Ck(Mt.IGlobalConfigService),xO=function(){function e(r){st(this,e),ua(this,"configService",OG,this),this.config=r}return ot(e,[{key:"setContainer",value:function(t,n,i,a){t.bind(Mt.MapConfig).toConstantValue(Et(Et({},this.config),{},{id:n,canvas:i,hasBaseMap:a})),t.bind(Mt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),OG=ia(xO.prototype,"configService",[RG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xO),Xne={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(jp,function(){function t(h){var p=[];return h.AMapUI&&p.push(n(h.AMapUI)),h.Loca&&p.push(i(h.Loca)),Promise.all(p)}function n(h){return new Promise(function(p,v){var m=[];if(h.plugins)for(var x=0;x<h.plugins.length;x+=1)o.AMapUI.plugins.indexOf(h.plugins[x])==-1&&m.push(h.plugins[x]);if(s.AMapUI===a.failed)v("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(s.AMapUI===a.notload){s.AMapUI=a.loading,o.AMapUI.version=h.version||o.AMapUI.version,x=o.AMapUI.version;var E=document.body||document.head,A=document.createElement("script");A.type="text/javascript",A.src="https://webapi.amap.com/ui/"+x+"/main.js",A.onerror=function(L){s.AMapUI=a.failed,v("\u8BF7\u6C42 AMapUI \u5931\u8D25")},A.onload=function(){if(s.AMapUI=a.loaded,m.length)window.AMapUI.loadUI(m,function(){for(var L=0,k=m.length;L<k;L++){var R=m[L].split("/").slice(-1)[0];window.AMapUI[R]=arguments[L]}for(p();u.AMapUI.length;)u.AMapUI.splice(0,1)[0]()});else for(p();u.AMapUI.length;)u.AMapUI.splice(0,1)[0]()},E.appendChild(A)}else s.AMapUI===a.loaded?h.version&&h.version!==o.AMapUI.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):m.length?window.AMapUI.loadUI(m,function(){for(var L=0,k=m.length;L<k;L++){var R=m[L].split("/").slice(-1)[0];window.AMapUI[R]=arguments[L]}p()}):p():h.version&&h.version!==o.AMapUI.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):u.AMapUI.push(function(L){L?v(L):m.length?window.AMapUI.loadUI(m,function(){for(var k=0,R=m.length;k<R;k++){var D=m[k].split("/").slice(-1)[0];window.AMapUI[D]=arguments[k]}p()}):p()})})}function i(h){return new Promise(function(p,v){if(o.AMap.version.startsWith("2.0"))v("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(s.Loca===a.failed)v("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(s.Loca===a.notload){s.Loca=a.loading,o.Loca.version=h.version||o.Loca.version;var m=o.Loca.version,x=o.key,E=document.body||document.head,A=document.createElement("script");A.type="text/javascript",A.src="https://webapi.amap.com/loca?v="+m+"&key="+x,A.onerror=function(L){s.Loca=a.failed,v("\u8BF7\u6C42 AMapUI \u5931\u8D25")},A.onload=function(){for(s.Loca=a.loaded,p();u.Loca.length;)u.Loca.splice(0,1)[0]()},E.appendChild(A)}else s.Loca===a.loaded?h.version&&h.version!==o.Loca.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):p():h.version&&h.version!==o.Loca.version?v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):u.Loca.push(function(L){L?v(L):v()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var a;(function(h){h.notload="notload",h.loading="loading",h.loaded="loaded",h.failed="failed"})(a||(a={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},u={AMap:[],AMapUI:[],Loca:[]},l=[],f=function(h){typeof h=="function"&&(s.AMap===a.loaded?h(window.AMap):l.push(h))};return{load:function(h){return new Promise(function(p,v){if(s.AMap==a.failed)v("");else if(s.AMap==a.notload){var m=h.key,x=h.version,E=h.plugins;m?(window.AMap&&location.host!=="lbs.amap.com"&&v("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),o.key=m,o.AMap.version=x||o.AMap.version,o.AMap.plugins=E||o.AMap.plugins,s.AMap=a.loading,x=document.body||document.head,window.___onAPILoaded=function(L){if(delete window.___onAPILoaded,L)s.AMap=a.failed,v(L);else for(s.AMap=a.loaded,t(h).then(function(){p(window.AMap)}).catch(v);l.length;)l.splice(0,1)[0]()},E=document.createElement("script"),E.type="text/javascript",E.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+m+"&plugin="+o.AMap.plugins.join(","),E.onerror=function(L){s.AMap=a.failed,v(L)},x.appendChild(E)):v("\u8BF7\u586B\u5199key")}else if(s.AMap==a.loaded)if(h.key&&h.key!==o.key)v("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(h.version&&h.version!==o.AMap.version)v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(m=[],h.plugins)for(x=0;x<h.plugins.length;x+=1)o.AMap.plugins.indexOf(h.plugins[x])==-1&&m.push(h.plugins[x]);m.length?window.AMap.plugin(m,function(){t(h).then(function(){p(window.AMap)}).catch(v)}):t(h).then(function(){p(window.AMap)}).catch(v)}else if(h.key&&h.key!==o.key)v("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(h.version&&h.version!==o.AMap.version)v("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var A=[];if(h.plugins)for(x=0;x<h.plugins.length;x+=1)o.AMap.plugins.indexOf(h.plugins[x])==-1&&A.push(h.plugins[x]);f(function(){A.length?window.AMap.plugin(A,function(){t(h).then(function(){p(window.AMap)}).catch(v)}):t(h).then(function(){p(window.AMap)}).catch(v)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},u={AMap:[],AMapUI:[],Loca:[]}}}})})(Xne);var r6=Xne.exports,ko;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.L7MAP="L7MAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(ko||(ko={}));var FG=Math.PI/180,l$e=function(){function e(){st(this,e),X(this,"projectionMatrix",ts()),X(this,"viewMatrix",ts()),X(this,"viewProjectionMatrix",ts()),X(this,"ViewProjectionMatrixUncentered",ts()),X(this,"viewUncenteredMatrix",ts())}return ot(e,[{key:"syncWithMapCamera",value:function(t){var n=t.zoom,i=n===void 0?1:n,a=t.pitch,o=a===void 0?0:a,s=t.bearing,u=s===void 0?0:s,l=t.center,f=l===void 0?[0,0]:l,h=t.offsetOrigin,p=h===void 0?[0,0]:h,v=t.cameraHeight,m=v===void 0?1:v,x=t.aspect,E=x===void 0?1:x,A=t.near,L=A===void 0?.1:A,k=t.far,R=k===void 0?1e3:k,D=t.fov,$=D===void 0?0:D;this.zoom=i,this.center=f;var j=o*FG,H=(360-u)*FG;N2(this.projectionMatrix,$,E,L,R);var ee=Io(m*Math.sin(j)*Math.sin(H),-m*Math.sin(j)*Math.cos(H),m*Math.cos(j)),U=Io(-Math.cos(j)*Math.sin(H),Math.cos(j)*Math.cos(H),Math.sin(j));uI(this.viewMatrix,ee,Io(0,0,0),U),this.viewUncenteredMatrix=sI(this.viewMatrix),ih(this.viewMatrix,this.viewMatrix,Io(-p[0],p[1],0)),ff(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ff(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var t=tn(this.center,2),n=t[0],i=t[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t){var n=85.0511287798,i=Math.max(Math.min(n,t[1]),-n),a=256<<20,o=Math.PI/180,s=t[0]*o,u=i*o;u=Math.log(Math.tan(Math.PI/4+u/2));var l=.5/Math.PI,f=.5,h=-.5/Math.PI;return o=.5,s=a*(l*s+f)-215440491,u=-(a*(h*u+o)-106744817),[s,u]}}]),e}(),Yne=function(){function e(r){st(this,e),X(this,"size",1e4),this.size=r||1e4}return ot(e,[{key:"setSize",value:function(t){this.size=t}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(t){return(180+t)/360*this.size}},{key:"mercatorYfromLat",value:function(t){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(t){return t/this.size*360-180}},{key:"latFromMercatorY",value:function(t){var n=180-(1-t/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}},{key:"project",value:function(t){var n=this.mercatorXfromLng(t[0]),i=this.mercatorYfromLat(t[1]);return[n,i]}},{key:"unproject",value:function(t){var n=this.lngFromMercatorX(t[0]),i=this.latFromMercatorY(t[1]);return[n,i]}}]),e}();function DG(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return Object.assign({},r,e)}function XC(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function pM(e,r){var t=kx([],r,e);return Dye(t,t,1/t[3]),t}function s1(e,r){if(!e)throw new Error(r||"viewport-mercator-project: assertion failed.")}var Hv=Math.PI,Zne=Hv/4,Y0=Hv/180,BG=180/Hv,n6=512,NG=4003e4,c$e=1.5;function qne(e){return Math.pow(2,e)}function bO(e,r){var t=tn(e,2),n=t[0],i=t[1];s1(Number.isFinite(n)&&Number.isFinite(r)),s1(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),r*=n6;var a=n*Y0,o=i*Y0,s=r*(a+Hv)/(2*Hv),u=r*(Hv-Math.log(Math.tan(Zne+o*.5)))/(2*Hv);return[s,u]}function zG(e,r){var t=tn(e,2),n=t[0],i=t[1];r*=n6;var a=n/r*(2*Hv)-Hv,o=2*(Math.atan(Math.exp(Hv-i/r*(2*Hv)))-Zne);return[a*BG,o*BG]}function f$e(e){var r=e.latitude,t=e.longitude,n=e.zoom,i=e.scale,a=e.highPrecision,o=a===void 0?!1:a;i=i!==void 0?i:qne(n),s1(Number.isFinite(r)&&Number.isFinite(t)&&Number.isFinite(i));var s={},u=n6*i,l=Math.cos(r*Y0),f=u/360,h=f/l,p=u/NG/l;if(s.pixelsPerMeter=[p,-p,p],s.metersPerPixel=[1/p,-1/p,1/p],s.pixelsPerDegree=[f,-h,p],s.degreesPerPixel=[1/f,-1/h,1/p],o){var v=Y0*Math.tan(r*Y0)/l,m=f*v/2,x=u/NG*v,E=x/h*p;s.pixelsPerDegree2=[0,-m,x],s.pixelsPerMeter2=[E,0,E]}return s}function h$e(e){var r=e.height,t=e.pitch,n=e.bearing,i=e.altitude,a=e.center,o=a===void 0?null:a,s=e.flipY,u=s===void 0?!1:s,l=XC();return ih(l,l,[0,0,-i]),op(l,l,[1,1,1/r]),m_(l,l,-t*Y0),y_(l,l,n*Y0),u&&op(l,l,[1,-1,1]),o&&ih(l,l,Bq([],o)),l}function p$e(e){var r=e.width,t=e.height,n=e.altitude,i=n===void 0?c$e:n,a=e.pitch,o=a===void 0?0:a,s=e.nearZMultiplier,u=s===void 0?1:s,l=e.farZMultiplier,f=l===void 0?1:l,h=o*Y0,p=Math.atan(.5/i),v=Math.sin(p)*i/Math.sin(Math.PI/2-h-p),m=Math.cos(Math.PI/2-h)*v+i;return{fov:2*Math.atan(t/2/i),aspect:r/t,focalDistance:i,near:u,far:m*f}}function d$e(e){var r=e.width,t=e.height,n=e.pitch,i=e.altitude,a=e.nearZMultiplier,o=e.farZMultiplier,s=p$e({width:r,height:t,altitude:i,pitch:n,nearZMultiplier:a,farZMultiplier:o}),u=s.fov,l=s.aspect,f=s.near,h=s.far,p=N2([],u,l,f,h);return p}function v$e(e,r){var t=tn(e,3),n=t[0],i=t[1],a=t[2],o=a===void 0?0:a;return s1(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(o)),pM(r,[n,i,o,1])}function Kne(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=tn(e,3),i=n[0],a=n[1],o=n[2];if(s1(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(o)){var s=pM(r,[i,a,o,1]);return s}var u=pM(r,[i,a,0,1]),l=pM(r,[i,a,1,1]),f=u[2],h=l[2],p=f===h?0:((t||0)-f)/(h-f);return Nye([],u,l,p)}var $G=XC(),g$e=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=r.width,n=r.height,i=r.viewMatrix,a=i===void 0?$G:i,o=r.projectionMatrix,s=o===void 0?$G:o;st(this,e),this.width=t||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=s;var u=XC();ff(u,u,this.projectionMatrix),ff(u,u,this.viewMatrix),this.viewProjectionMatrix=u;var l=XC();op(l,l,[this.width/2,-this.height/2,1]),ih(l,l,[1,-1,0]),ff(l,l,this.viewProjectionMatrix);var f=s2(XC(),l);if(!f)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=f,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return ot(e,[{key:"equals",value:function(t){return t instanceof e?t.width===this.width&&t.height===this.height&&zF(t.projectionMatrix,this.projectionMatrix)&&zF(t.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,o=this.projectPosition(t),s=v$e(o,this.pixelProjectionMatrix),u=tn(s,2),l=u[0],f=u[1],h=a?f:this.height-f;return t.length===2?[l,h]:[l,h,s[2]]}},{key:"unproject",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,o=n.targetZ,s=tn(t,3),u=s[0],l=s[1],f=s[2],h=a?l:this.height-l,p=o&&o*this.pixelsPerMeter,v=Kne([u,h,f],this.pixelUnprojectionMatrix,p),m=this.unprojectPosition(v),x=tn(m,3),E=x[0],A=x[1],L=x[2];return Number.isFinite(f)?[E,A,L]:Number.isFinite(o)?[E,A,o]:[E,A]}},{key:"projectPosition",value:function(t){var n=this.projectFlat(t),i=tn(n,2),a=i[0],o=i[1],s=(t[2]||0)*this.pixelsPerMeter;return[a,o,s]}},{key:"unprojectPosition",value:function(t){var n=this.unprojectFlat(t),i=tn(n,2),a=i[0],o=i[1],s=(t[2]||0)/this.pixelsPerMeter;return[a,o,s]}},{key:"projectFlat",value:function(t){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,t}},{key:"unprojectFlat",value:function(t){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,t}}]),e}();function m$e(e){var r=e.width,t=e.height,n=e.bounds,i=e.minExtent,a=i===void 0?0:i,o=e.maxZoom,s=o===void 0?24:o,u=e.padding,l=u===void 0?0:u,f=e.offset,h=f===void 0?[0,0]:f,p=tn(n,2),v=tn(p[0],2),m=v[0],x=v[1],E=tn(p[1],2),A=E[0],L=E[1];if(Number.isFinite(l)){var k=l;l={top:k,bottom:k,left:k,right:k}}else s1(Number.isFinite(l.top)&&Number.isFinite(l.bottom)&&Number.isFinite(l.left)&&Number.isFinite(l.right));var R=new i6({width:r,height:t,longitude:0,latitude:0,zoom:0}),D=R.project([m,L]),$=R.project([A,x]),j=[Math.max(Math.abs($[0]-D[0]),a),Math.max(Math.abs($[1]-D[1]),a)],H=[r-l.left-l.right-Math.abs(h[0])*2,t-l.top-l.bottom-Math.abs(h[1])*2];s1(H[0]>0&&H[1]>0);var ee=H[0]/j[0],U=H[1]/j[1],W=(l.right-l.left)/2/ee,Q=(l.bottom-l.top)/2/U,te=[($[0]+D[0])/2+W,($[1]+D[1])/2+Q],ie=R.unproject(te),ve=R.zoom+Math.log2(Math.abs(Math.min(ee,U)));return{longitude:ie[0],latitude:ie[1],zoom:Math.min(ve,s)}}var i6=function(e){er(r,e);function r(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.width,a=n.height,o=n.latitude,s=o===void 0?0:o,u=n.longitude,l=u===void 0?0:u,f=n.zoom,h=f===void 0?0:f,p=n.pitch,v=p===void 0?0:p,m=n.bearing,x=m===void 0?0:m,E=n.altitude,A=E===void 0?1.5:E,L=n.nearZMultiplier,k=n.farZMultiplier;st(this,r),i=i||1,a=a||1;var R=qne(h);A=Math.max(.75,A);var D=bO([l,s],R);D[2]=0;var $=d$e({width:i,height:a,pitch:v,bearing:x,altitude:A,nearZMultiplier:L||1/a,farZMultiplier:k||1.01}),j=h$e({height:a,center:D,pitch:v,bearing:x,altitude:A,flipY:!0});return t=nr(this,ze(r).call(this,{width:i,height:a,viewMatrix:j,projectionMatrix:$})),t.latitude=s,t.longitude=l,t.zoom=h,t.pitch=v,t.bearing=x,t.altitude=A,t.scale=R,t.center=D,t.pixelsPerMeter=f$e(He(He(t))).pixelsPerMeter[2],Object.freeze(He(He(t))),t}return ot(r,[{key:"projectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return bO(n,i)}},{key:"unprojectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return zG(n,i)}},{key:"getMapCenterByLngLatPosition",value:function(n){var i=n.lngLat,a=n.pos,o=Kne(a,this.pixelUnprojectionMatrix),s=bO(i,this.scale),u=Xo([],s,Bye([],o)),l=Xo([],this.center,u);return zG(l,this.scale)}},{key:"getLocationAtPoint",value:function(n){var i=n.lngLat,a=n.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:a})}},{key:"fitBounds",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,o=this.height,s=m$e(Object.assign({width:a,height:o,bounds:n},i)),u=s.longitude,l=s.latitude,f=s.zoom;return new r({width:a,height:o,longitude:u,latitude:l,zoom:f})}}]),r}(g$e),gL=function(){function e(){st(this,e)}return ot(e,[{key:"syncWithMapCamera",value:function(t){var n=t.center,i=t.zoom,a=t.pitch,o=t.bearing,s=t.viewportHeight,u=t.viewportWidth,l=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new i6(Et(Et({},l),{},{width:u,height:s,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:a,bearing:o}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),UG={dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},y$e=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],VG,GG,HG,jG,WG,XG,Cb,YG,ZG,qG,KG;function _$e(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var a=r.body||r.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):r.documentElement.appendChild(i)}var o=r.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(r.createTextNode(e)),i.appendChild(o),o}}_$e(`.amap-logo{
 display: none !important;
}
`);var x$e=0;window.forceWebGL=!0;var QG="15cd8a57710d40c9b7c0e3cc120f1200",b$e="1.4.15",w$e="amap-script",wO=!1,yT=[],C$e=12,Qne=(VG=Ri(),GG=ba(Mt.IGlobalConfigService),HG=ba(Mt.MapConfig),jG=ba(Mt.ICoordinateSystemService),WG=ba(Mt.IEventEmitter),VG(XG=(Cb=function(){function e(){var r=this;st(this,e),X(this,"version",ko["GAODE1.x"]),X(this,"simpleMapCoord",new Yne),X(this,"bgColor","rgba(0, 0, 0, 0)"),ua(this,"configService",YG,this),ua(this,"config",ZG,this),ua(this,"coordinateSystemService",qG,this),ua(this,"eventEmitter",KG,this),X(this,"handleCameraChanged",function(t){var n=t.camera,i=n.fov,a=n.near,o=n.far,s=n.height,u=n.pitch,l=n.rotation,f=n.aspect,h=n.position,p=r.getCenter(),v=p.lng,m=p.lat;if(r.emit("mapchange"),r.cameraChangedCallback){r.viewport.syncWithMapCamera({aspect:f,bearing:360-l,far:o,fov:i,cameraHeight:s,near:a,pitch:u,zoom:r.map.getZoom()-1,center:[v,m],offsetOrigin:[h.x,h.y]});var x=r.config.offsetZoom,E=x===void 0?C$e:x;r.viewport.getZoom()>E?r.coordinateSystemService.setCoordinateSystem(sc.P20_OFFSET):r.coordinateSystemService.setCoordinateSystem(sc.P20),r.cameraChangedCallback(r.viewport)}})}return ot(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(t!==null){var n=t.getElementsByClassName("amap-maps")[0];this.markerContainer=xs("div","l7-marker-container",n)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,n){GE.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on(t,n)}},{key:"off",value:function(t,n){GE.indexOf(t)!==-1?this.eventEmitter.off(t,n):this.map.off(t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(t!=null&&t.padding){var n=this.getCenter(),i=DG(t.padding),a=this.lngLatToPixel([n.lng,n.lat]),o=[(i.right-i.left)/2,(i.bottom-i.top)/2],s=this.pixelToLngLat([a.x-o[0],a.y-o[1]]);return s}var u=this.map.getCenter();return{lng:u.getLng(),lat:u.getLat()}}},{key:"setCenter",value:function(t,n){if(n!=null&&n.padding){var i=DG(n.padding),a=this.lngLatToPixel(t),o=[(i.right-i.left)/2,(i.bottom-i.top)/2],s=this.pixelToLngLat([a.x+o[0],a.y+o[1]]);this.map.setCenter([s.lng,s.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),n=t.getNorthEast(),i=t.getSouthWest(),a=this.getCenter(),o=a.lng>n.getLng()||a.lng<i.getLng()?180-n.getLng():n.getLng(),s=a.lng<i.getLng()?i.getLng()-180:i.getLng();return[[s,i.getLat()],[o,n.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.get("zooms");return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.get("zooms");return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(t,n)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,n){this.map.setZoomAndCenter(t+1,n)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyle(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"pixelToLngLat",value:function(t){var n=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(t){var n=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(t){var n=new AMap.Pixel(t[0],t[1]),i=this.map.containerToLngLat(n);return{lng:i==null?void 0:i.getLng(),lat:i==null?void 0:i.getLat()}}},{key:"lngLatToContainer",value:function(t){var n=new AMap.LngLat(t[0],t[1]),i=this.map.lngLatToContainer(n);return{x:i.getX(),y:i.getY()}}},{key:"lngLatToCoord",value:function(t){var n=this.map.lngLatToGeodeticCoord(t),i=n.x,a=n.y;return[i,-a]}},{key:"lngLatToMercator",value:function(t,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],o=this.viewport.projectFlat(t),s=ts();return ih(s,s,Io(o[0],o[1],n)),op(s,s,Io(a[0],a[1],a[2])),m_(s,s,i[0]),g1(s,s,i[1]),y_(s,s,i[2]),s}},{key:"init",value:function(){var r=Hi(Xr.mark(function n(){var i=this,a,o,s,u,l,f,h,p,v,m,x,E,A,L;return Xr.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return a=this.config,o=a.id,s=a.style,u=s===void 0?"light":s,l=a.minZoom,f=l===void 0?0:l,h=a.maxZoom,p=h===void 0?18:h,v=a.token,m=v===void 0?QG:v,x=a.mapInstance,E=a.plugin,A=E===void 0?[]:E,L=oc(a,y$e),R.next=3,new Promise(function(D){var $=function(){if(x)i.map=x,i.$mapContainer=i.map.getContainer(),setTimeout(function(){i.map.on("camerachange",i.handleCameraChanged),D()},30);else{i.$mapContainer=i.creatMapContainer(o);var H=Et({mapStyle:i.getMapStyle(u),zooms:[f,p],viewMode:"3D"},L);H.zoom&&(H.zoom+=1);var ee=new AMap.Map(i.$mapContainer,H);ee.on("camerachange",i.handleCameraChanged),ee.on("camerachange",function(){setTimeout(function(){return i.handleAfterMapChange()})}),i.map=ee,setTimeout(function(){D()},10)}};!wO&&!x?(m===QG&&console.warn(i.configService.getSceneWarninfo("MapToken")),wO=!0,A.push("Map3D"),r6.load({key:m,version:b$e,plugins:A}).then(function(){$(),yT.length&&(yT.forEach(function(j){return j()}),yT=[])}).catch(function(j){throw new Error(j)})):wO&&window.AMap||x?$():yT.push($)});case 3:this.viewport=new gL;case 4:case"end":return R.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,n){var i=AMap.GeometryUtil.distance(X0(AMap.LngLat,Pr(t)),X0(AMap.LngLat,Pr(n))),a=this.lngLatToCoord(t),o=tn(a,2),s=o[0],u=o[1],l=this.lngLatToCoord(n),f=tn(l,2),h=f[0],p=f[1],v=Math.sqrt(Math.pow(s-h,2)+Math.pow(u-p,2));return v/i}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(t){var n,i=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],a=t==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png");return a}},{key:"emit",value:function(t){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];(n=this.eventEmitter).emit.apply(n,[t].concat(a))}},{key:"once",value:function(t){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];(n=this.eventEmitter).once.apply(n,[t].concat(a))}},{key:"destroy",value:function(){var t,n;this.map.destroy(),(t=this.$mapContainer)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var i=document.getElementById(w$e);i&&document.head.removeChild(i)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"getMapStyle",value:function(t){return UG[t]?UG[t]:t}},{key:"creatMapContainer",value:function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var i=document.createElement("div");return i.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,i.id="l7_amap_div"+x$e++,n.appendChild(i),i}}]),e}(),YG=ia(Cb.prototype,"configService",[GG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZG=ia(Cb.prototype,"config",[HG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qG=ia(Cb.prototype,"coordinateSystemService",[jG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KG=ia(Cb.prototype,"eventEmitter",[WG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cb))||XG),E$e=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],JG,eH;function S$e(e){var r=A$e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function A$e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}window.forceWebGL=!0;var tH="15cd8a57710d40c9b7c0e3cc120f1200",T$e="1.4.15",CO=!1,_T=[],M$e=12,L$e=(JG=Ri(),JG(eH=function(e){er(t,e);var r=S$e(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"version",ko["GAODE1.x"]),X(He(n),"handleCameraChanged",function(s){var u=s.camera,l=u.fov,f=u.near,h=u.far,p=u.height,v=u.pitch,m=u.rotation,x=u.aspect,E=u.position,A=n.getCenter(),L=A.lng,k=A.lat;if(n.emit("mapchange"),n.cameraChangedCallback){n.viewport.syncWithMapCamera({aspect:x,bearing:360-m,far:h,fov:l,cameraHeight:p,near:f,pitch:v,zoom:n.map.getZoom()-1,center:[L,k],offsetOrigin:[E.x,E.y]});var R=n.config.offsetZoom,D=R===void 0?M$e:R;n.viewport.getZoom()>D?n.coordinateSystemService.setCoordinateSystem(sc.P20_OFFSET):n.coordinateSystemService.setCoordinateSystem(sc.P20),n.cameraChangedCallback(n.viewport)}}),n}return ot(t,[{key:"getModelMatrix",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],u=this.viewport.projectFlat(i),l=ts();return ih(l,l,Io(u[0],u[1],a)),op(l,l,Io(s[0],s[1],s[2])),m_(l,l,o[0]),g1(l,l,o[1]),y_(l,l,o[2]),l}},{key:"init",value:function(){var n=Hi(Xr.mark(function a(){var o=this,s,u,l,f,h,p,v,m,x,E,A,L,k,R;return Xr.wrap(function($){for(;;)switch($.prev=$.next){case 0:return s=this.config,u=s.id,l=s.style,f=l===void 0?"light":l,h=s.minZoom,p=h===void 0?0:h,v=s.maxZoom,m=v===void 0?18:v,x=s.token,E=x===void 0?tH:x,A=s.mapInstance,L=s.plugin,k=L===void 0?[]:L,R=oc(s,E$e),$.next=3,new Promise(function(j){var H=function(){if(A)o.map=A,o.$mapContainer=o.map.getContainer(),setTimeout(function(){o.map.on("camerachange",o.handleCameraChanged),j()},30);else{o.$mapContainer=o.creatMapContainer(u);var U=Et({mapStyle:o.getMapStyle(f),zooms:[p,m],viewMode:"3D"},R);U.zoom&&(U.zoom+=1);var W=new AMap.Map(o.$mapContainer,U);W.on("camerachange",o.handleCameraChanged),W.on("camerachange",function(){setTimeout(function(){return o.handleAfterMapChange()})}),o.map=W,setTimeout(function(){j()},10)}};!CO&&!A?(E===tH&&console.warn(o.configService.getSceneWarninfo("MapToken")),CO=!0,k.push("Map3D"),r6.load({key:E,version:T$e,plugins:k}).then(function(ee){H(),_T.length&&(_T.forEach(function(U){return U()}),_T=[])}).catch(function(ee){throw new Error(ee)})):CO&&window.AMap||A?H():_T.push(H)});case 3:this.viewport=new l$e;case 4:case"end":return $.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"meterToCoord",value:function(i,a){var o=AMap.GeometryUtil.distance(X0(AMap.LngLat,Pr(i)),X0(AMap.LngLat,Pr(a))),s=this.lngLatToCoord(i),u=tn(s,2),l=u[0],f=u[1],h=this.lngLatToCoord(a),p=tn(h,2),v=p[0],m=p[1],x=Math.sqrt(Math.pow(l-v,2)+Math.pow(f-m,2));return x/o}},{key:"updateView",value:function(i){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(i){var a,o=(a=this.getContainer())===null||a===void 0?void 0:a.getElementsByClassName("amap-layer")[0],s=i==="jpg"?o==null?void 0:o.toDataURL("image/jpeg"):o==null?void 0:o.toDataURL("image/png");return s}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}}]),t}(Qne))||eH);function I$e(e){var r=k$e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function k$e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P$e=function(e){er(t,e);var r=I$e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getServiceConstructor",value:function(){return L$e}}]),t}(K2),rH={dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},R$e=function(){function e(){st(this,e),X(this,"projectionMatrix",ts()),X(this,"viewMatrix",ts()),X(this,"viewProjectionMatrix",ts()),X(this,"ViewProjectionMatrixUncentered",ts()),X(this,"viewUncenteredMatrix",ts())}return ot(e,[{key:"syncWithMapCamera",value:function(t){var n=t.zoom,i=n===void 0?1:n,a=t.center,o=a===void 0?[0,0]:a,s=t.offsetOrigin,u=s===void 0?[0,0]:s,l=t.cameraPosition,f=l===void 0?[0,0,0]:l,h=t.up,p=h===void 0?[0,1,0]:h,v=t.lookAt,m=v===void 0?[0,0,0]:v,x=t.aspect,E=x===void 0?1:x,A=t.near,L=A===void 0?.1:A,k=t.far,R=k===void 0?1e3:k,D=t.fov,$=D===void 0?45:D;this.zoom=i,this.center=o,N2(this.projectionMatrix,$/180*Math.PI,E,L,R);var j=Io.apply(Yb,Pr(f)),H=Io.apply(Yb,Pr(m)),ee=Io.apply(Yb,Pr(p));uI(this.viewMatrix,j,H,ee),this.viewUncenteredMatrix=sI(this.viewMatrix),ih(this.viewMatrix,this.viewMatrix,Io(-u[0],u[1],0)),ff(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ff(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var t=tn(this.center,2),n=t[0],i=t[1];return[n,i]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t){var n=85.0511287798,i=Math.max(Math.min(n,t[1]),-n),a=256<<20,o=Math.PI/180,s=t[0]*o,u=i*o;u=Math.log(Math.tan(Math.PI/4+u/2));var l=.5/Math.PI,f=.5,h=-.5/Math.PI;return o=.5,s=a*(l*s+f)-215440491,u=-(a*(h*u+o)-106744817),[s,u]}}]),e}(),O$e=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],nH,iH;function F$e(e){var r=D$e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function D$e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function B$e(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var a=r.body||r.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):r.documentElement.appendChild(i)}var o=r.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(r.createTextNode(e)),i.appendChild(o),o}}B$e(`.amap-logo{
 display: none !important;
}
`);window.forceWebGL=!0;var aH="ff533602d57df6f8ab3b0fea226ae52f",N$e="2.0.5",EO=!1,xT=[],z$e=(nH=Ri(),nH(iH=function(e){er(t,e);var r=F$e(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"version",ko["GAODE2.x"]),X(He(n),"handleViewChanged",function(s){var u=n.map.customCoords.getCameraParams(),l=u.fov,f=u.near,h=u.far,p=u.aspect,v=u.position,m=u.lookAt,x=u.up;n.emit("mapchange");var E=n.map.customCoords.getCenter();n.cameraChangedCallback&&(n.viewport.syncWithMapCamera({aspect:p,far:h,fov:l,cameraPosition:v,lookAt:m,up:x,near:f,zoom:n.map.getZoom()-1,center:E,offsetOrigin:[v[0],v[1]]}),n.coordinateSystemService.setCoordinateSystem(sc.P20_2),n.cameraChangedCallback(n.viewport))}),n}return ot(t,[{key:"setCustomCoordCenter",value:function(i){this.sceneCenter=i,this.sceneCenterMKT=Dx.apply(void 0,Pr(i))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoordByLayer",value:function(i,a){var o=a||this.sceneCenter,s=Dx.apply(void 0,Pr(o));return this._sub(Dx(i[0],i[1]),s)}},{key:"lngLatToCoordsByLayer",value:function(i,a){var o=this;return i.map(function(s){return typeof s[0]=="number"?o.lngLatToCoordByLayer(s,a):s.map(function(u){return o.lngLatToCoordByLayer(u,a)})})}},{key:"setCoordCenter",value:function(i){this.map.customCoords.setCenter(i),this.setCustomCoordCenter(i)}},{key:"lngLatToCoord",value:function(i){return this.sceneCenter||(this.map.customCoords.setCenter(i),this.setCustomCoordCenter(i)),this._sub(Dx(i[0],i[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(i){var a=this;return i.map(function(o){return typeof o[0]=="number"?a.lngLatToCoord(o):o.map(function(s){return a.lngLatToCoord(s)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var i=this.map.getContainer();if(i!==null){var a=i.getElementsByClassName("amap-maps")[0];a.style.zIndex="auto",this.markerContainer=xs("div","l7-marker-container2",a)}}}},{key:"updateView",value:function(i){}},{key:"getOverlayContainer",value:function(){}},{key:"getMapStyle",value:function(i){return rH[i]?rH[i]:i}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var i=this.map.getBounds(),a=i.getNorthEast(),o=i.getSouthWest(),s=this.getCenter(),u=s.lng>a.getLng()||s.lng<o.getLng()?180-a.getLng():a.getLng(),l=s.lng<o.getLng()?o.getLng()-180:o.getLng();return[[l,o.getLat()],[u,a.getLat()]]}},{key:"getMinZoom",value:function(){var i=this.map.getZooms();return i[0]-1}},{key:"getMaxZoom",value:function(){var i=this.map.getZooms();return i[1]-1}},{key:"lngLatToContainer",value:function(i){var a=this.map.lngLatToContainer(i);return{x:a.getX(),y:a.getY()}}},{key:"getModelMatrix",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],u=this.map.customCoords.lngLatToCoord(i),l=ts();return ih(l,l,Io(u[0],u[1],a)),op(l,l,Io(s[0],s[1],s[2])),m_(l,l,o[0]),g1(l,l,o[1]),y_(l,l,o[2]),l}},{key:"init",value:function(){var n=Hi(Xr.mark(function a(){var o=this,s,u,l,f,h,p,v,m,x,E,A,L,k,R;return Xr.wrap(function($){for(;;)switch($.prev=$.next){case 0:return s=this.config,u=s.id,l=s.style,f=l===void 0?"light":l,h=s.minZoom,p=h===void 0?0:h,v=s.maxZoom,m=v===void 0?18:v,x=s.token,E=x===void 0?aH:x,A=s.mapInstance,L=s.plugin,k=L===void 0?[]:L,s.version,R=oc(s,O$e),$.next=3,new Promise(function(j){var H=function(){if(A){var U;o.map=A,o.$mapContainer=o.map.getContainer();var W=o.map.getCenter();(U=o.map.customCoords)===null||U===void 0||U.setCenter([W.lng,W.lat]),o.setCustomCoordCenter([W.lng,W.lat]),setTimeout(function(){o.map.on("viewchange",o.handleViewChanged),j()},30)}else{o.$mapContainer=o.creatMapContainer(u);var Q=Et({mapStyle:o.getMapStyle(f),zooms:[p,m],viewMode:"3D"},R);Q.zoom&&(Q.zoom+=1);var te=new AMap.Map(o.$mapContainer,Q);o.map=te;var ie=te.getCenter();te.customCoords.setCenter([ie.lng,ie.lat]),o.setCustomCoordCenter([ie.lng,ie.lat]),te.on("viewchange",o.handleViewChanged),setTimeout(function(){j()},10)}};o.viewport=new R$e,!EO&&!A?(E===aH&&console.warn(o.configService.getSceneWarninfo("MapToken")),EO=!0,k.push("Map3D"),r6.load({key:E,version:N$e,plugins:k}).then(function(ee){H(),xT.length&&(xT.forEach(function(U){return U()}),xT=[])}).catch(function(ee){throw new Error(ee)})):EO&&window.AMap||A?H():xT.push(H)});case 3:this.initViewPort();case 4:case"end":return $.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}},{key:"initViewPort",value:function(){var i,a=(i=this.map.customCoords)===null||i===void 0?void 0:i.getCameraParams(),o=a.fov,s=a.near,u=a.far,l=a.aspect,f=a.position,h=a.lookAt,p=a.up;this.emit("mapchange");var v=this.map.customCoords.getCenter(),m=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:l,far:u,fov:o,cameraPosition:f,lookAt:h,near:s,up:p,zoom:m-1,center:v,offsetOrigin:[f[0],f[1]]}),this.coordinateSystemService.setCoordinateSystem(sc.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(i,a){var o=[0,0];return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o}}]),t}(Qne))||iH);function $$e(e){var r=U$e();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function U$e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var V$e=function(e){er(t,e);var r=$$e(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getServiceConstructor",value:function(){return z$e}}]),t}(K2),G$e=Q2;function Q2(e,r,t,n){this.cx=3*e,this.bx=3*(t-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(n-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=t,this.p2y=n}Q2.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e};Q2.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e};Q2.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx};Q2.prototype.solveCurveX=function(e,r){typeof r=="undefined"&&(r=1e-6);var t,n,i,a,o;for(i=e,o=0;o<8;o++){if(a=this.sampleCurveX(i)-e,Math.abs(a)<r)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i=i-a/s}if(t=0,n=1,i=e,i<t)return t;if(i>n)return n;for(;t<n;){if(a=this.sampleCurveX(i),Math.abs(a-e)<r)return i;e>a?t=i:n=i,i=(n-t)*.5+t}return i};Q2.prototype.solve=function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))};function H$e(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=j$e(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function j$e(e,r){if(!!e){if(typeof e=="string")return oH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oH(e,r)}}function oH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var SO;function a6(e,r,t){var n=t-r,i=((e-r)%n+n)%n+r;return i===r?t:i}function vy(e,r,t){return Math.min(t,Math.max(r,e))}function Bd(e,r,t){return e*(1-t)+r*t}function o6(e,r,t,n){var i=new G$e(e,r,t,n);return function(a){return i.solve(a)}}var MD=o6(.25,.1,.25,1);function sH(){return ns||!Hn.matchMedia?!1:(SO==null&&(SO=Hn.matchMedia("(prefers-reduced-motion: reduce)")),SO.matches)}function W$e(e,r){var t={},n=H$e(r),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a in e&&(t[a]=e[a])}}catch(o){n.e(o)}finally{n.f()}return t}var z0=ns?Date.now.bind(Date):Hn.performance&&Hn.performance.now?Hn.performance.now.bind(Hn.performance):Date.now.bind(Date),X$e=Hn.requestAnimationFrame||Hn.mozRequestAnimationFrame||Hn.webkitRequestAnimationFrame||Hn.msRequestAnimationFrame,Y$e=Hn.cancelAnimationFrame||Hn.mozCancelAnimationFrame||Hn.webkitCancelAnimationFrame||Hn.msCancelAnimationFrame;function mL(e){var r=X$e(e);return{cancel:function(){return Y$e(r)}}}var Jne=63710088e-1,Us=function(){function e(r,t){if(st(this,e),isNaN(r)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(r,", ").concat(t,")"));if(this.lng=+r,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return ot(e,[{key:"wrap",value:function(){return new e(a6(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(t){var n=Math.PI/180,i=this.lat*n,a=t.lat*n,o=Math.sin(i)*Math.sin(a)+Math.cos(i)*Math.cos(a)*Math.cos((t.lng-this.lng)*n),s=Jne*Math.acos(Math.min(o,1));return s}}],[{key:"convert",value:function(t){if(t instanceof e)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&em(t)==="object"&&t!==null){var n="lng"in t?t.lng:t.lon;return new e(Number(n),Number(t.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),e}(),WE=function(){function e(r,t){st(this,e),r&&(t?this.setSouthWest(r).setNorthEast(t):r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}return ot(e,[{key:"setNorthEast",value:function(t){return this.ne=t instanceof Us?new Us(t.lng,t.lat):Us.convert(t),this}},{key:"setSouthWest",value:function(t){return this.sw=t instanceof Us?new Us(t.lng,t.lat):Us.convert(t),this}},{key:"extend",value:function(t){var n=this.sw,i=this.ne,a,o;if(t instanceof Us)a=t,o=t;else if(t instanceof e){if(a=t.sw,o=t.ne,!a||!o)return this}else{if(Array.isArray(t))if(t.length===4||t.every(Array.isArray)){var s=t;return this.extend(e.convert(s))}else{var u=t;return this.extend(Us.convert(u))}return this}return!n&&!i?(this.sw=new Us(a.lng,a.lat),this.ne=new Us(o.lng,o.lat)):(n.lng=Math.min(a.lng,n.lng),n.lat=Math.min(a.lat,n.lat),i.lng=Math.max(o.lng,i.lng),i.lat=Math.max(o.lat,i.lat)),this}},{key:"getCenter",value:function(){return new Us((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new Us(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Us(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(t){var n=Us.convert(t),i=n.lng,a=n.lat,o=this.sw.lat<=a&&a<=this.ne.lat,s=this.sw.lng<=i&&i<=this.ne.lng;return this.sw.lng>this.ne.lng&&(s=this.sw.lng>=i&&i>=this.ne.lng),o&&s}}],[{key:"convert",value:function(t){return t instanceof e?t:new e(t)}}]),e}(),Wa=function(){function e(r,t){st(this,e),this.x=r,this.y=t}return ot(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"_add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"add",value:function(t){return this.clone()._add(t)}},{key:"_sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"sub",value:function(t){return this.clone()._sub(t)}},{key:"_multByPoint",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multByPoint",value:function(t){return this.clone()._multByPoint(t)}},{key:"_divByPoint",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divByPoint",value:function(t){return this.clone()._divByPoint(t)}},{key:"_mult",value:function(t){return this.x*=t,this.y*=t,this}},{key:"mult",value:function(t){return this.clone()._mult(t)}},{key:"_div",value:function(t){return this.x/=t,this.y/=t,this}},{key:"div",value:function(t){return this.clone()._div(t)}},{key:"_rotate",value:function(t){var n=Math.cos(t),i=Math.sin(t),a=n*this.x-i*this.y,o=i*this.x+n*this.y;return this.x=a,this.y=o,this}},{key:"rotate",value:function(t){return this.clone()._rotate(t)}},{key:"_rotateAround",value:function(t,n){var i=Math.cos(t),a=Math.sin(t),o=n.x+i*(this.x-n.x)-a*(this.y-n.y),s=n.y+a*(this.x-n.x)+i*(this.y-n.y);return this.x=o,this.y=s,this}},{key:"roateAround",value:function(t,n){return this.clone()._rotateAround(t,n)}},{key:"_matMult",value:function(t){var n=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=n,this.y=i,this}},{key:"matMult",value:function(t){return this.clone()._matMult(t)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var t=this.y;return this.y=this.x,this.x=-t,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"dist",value:function(t){return Math.sqrt(this.distSqr(t))}},{key:"distSqr",value:function(t){var n=t.x-this.x,i=t.y-this.y;return n*n+i*i}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(t){return Math.atan2(this.y-t.y,this.x-t.x)}},{key:"angleWith",value:function(t){return this.angleWithSep(t.x,t.y)}},{key:"angleWithSep",value:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)}}],[{key:"convert",value:function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t}}]),e}(),Z$e=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(st(this,e),isNaN(r)||r<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=t,this.left=n,this.right=i}return ot(e,[{key:"interpolate",value:function(t,n,i){return n.top!=null&&t.top!=null&&(this.top=Bd(t.top,n.top,i)),n.bottom!=null&&t.bottom!=null&&(this.bottom=Bd(t.bottom,n.bottom,i)),n.left!=null&&t.left!=null&&(this.left=Bd(t.left,n.left,i)),n.right!=null&&t.right!=null&&(this.right=Bd(t.right,n.right,i)),this}},{key:"getCenter",value:function(t,n){var i=vy((this.left+t-this.right)/2,0,t),a=vy((this.top+n-this.bottom)/2,0,n);return new Wa(i,a)}},{key:"equals",value:function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}},{key:"clone",value:function(){return new e(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),e}(),eie=2*Math.PI*Jne;function tie(e){return eie*Math.cos(e*Math.PI/180)}function dM(e){return(180+e)/360}function vM(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function rie(e,r){return e/tie(r)}function q$e(e){return e*360-180}function LD(e){var r=180-e*360;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}function K$e(e,r){return e*tie(LD(r))}function Q$e(e){return 1/Math.cos(e*Math.PI/180)}var bT=function(){function e(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;st(this,e),this.x=+r,this.y=+t,this.z=+n}return ot(e,[{key:"toLngLat",value:function(){return new Us(q$e(this.x),LD(this.y))}},{key:"toAltitude",value:function(){return K$e(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/eie*Q$e(LD(this.y))}}],[{key:"fromLngLat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Us.convert(t);return new e(dM(i.lng),vM(i.lat),rie(n,i.lat))}}]),e}();function J$e(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=eUe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function eUe(e,r){if(!!e){if(typeof e=="string")return uH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uH(e,r)}}function uH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var tUe=function(){function e(r,t,n,i,a){st(this,e),this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=a===void 0?!0:a,this._minZoom=r||0,this._maxZoom=t||22,this._minPitch=n==null?0:n,this._maxPitch=i==null?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Us(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new Z$e,this.posMatrixCache={},this.alignedPosMatrixCache={}}return ot(e,[{key:"minZoom",get:function(){return this._minZoom},set:function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}},{key:"minPitch",get:function(){return this._minPitch},set:function(t){this._minPitch!==t&&(this._minPitch=t,this._pitch=Math.max(this._pitch,t))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(t){this._maxPitch!==t&&(this._maxPitch=t,this._pitch=Math.min(this._pitch,t))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Wa(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(t){var n=-a6(t,-180,180)*Math.PI/180;this.angle!==n&&(this.unmodified=!1,this.angle=n,this.calcMatrices(),this.rotationMatrix=wme(),Cme(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(t){var n=vy(t,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==n&&(this.unmodified=!1,this._pitch=n,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this.unmodified=!1,this._fov=t/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(t){var n=Math.min(Math.max(t,this._minZoom),this._maxZoom);this._zoom!==n&&(this.unmodified=!1,this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this.unmodified=!1,this._center=t,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(t){this.edgeInsets.equals(t)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,t,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}},{key:"clone",value:function(){var t=new e(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t.center=this._center,t.zoom=this.zoom,t.angle=this.angle,t.fov=this._fov,t.pitch=this._pitch,t.unmodified=this.unmodified,t.edgeInsets=this.edgeInsets.clone(),t.calcMatrices(),t}},{key:"isPaddingEqual",value:function(t){return this.edgeInsets.equals(t)}},{key:"interpolatePadding",value:function(t,n,i){this.unmodified=!1,this.edgeInsets.interpolate(t,n,i),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(t){var n=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,n)}},{key:"resize",value:function(t,n){this.width=t,this.height=n,this.pixelsToGLUnits=[2/t,-2/n],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(t){return Math.pow(2,t)}},{key:"scaleZoom",value:function(t){return Math.log(t)/Math.LN2}},{key:"project",value:function(t){var n=vy(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Wa(dM(t.lng)*this.worldSize,vM(n)*this.worldSize)}},{key:"unproject",value:function(t){return new bT(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(t,n){var i=this.pointCoordinate(n),a=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(t),s=new bT(o.x-(i.x-a.x),o.y-(i.y-a.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(t){var n=0,i=new Float64Array([t.x,t.y,0,1]),a=new Float64Array([t.x,t.y,1,1]);kx(i,i,this.pixelMatrixInverse),kx(a,a,this.pixelMatrixInverse);var o=i[3],s=a[3],u=i[0]/o,l=a[0]/s,f=i[1]/o,h=a[1]/s,p=i[2]/o,v=a[2]/s,m=p===v?0:(n-p)/(v-p);return new bT(Bd(u,l,m)/this.worldSize,Bd(f,h,m)/this.worldSize)}},{key:"getBounds",value:function(){return new WE().extend(this.pointLocation(new Wa(0,0))).extend(this.pointLocation(new Wa(this.width,0))).extend(this.pointLocation(new Wa(this.width,this.height))).extend(this.pointLocation(new Wa(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new WE([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new Wa(0,0)),n=new Float32Array([t.x*this.worldSize,t.y*this.worldSize,0,1]),i=kx(n,n,this.pixelMatrix);return i[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var t=this._pitch,n=Math.tan(t)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Wa(0,n))}},{key:"getCameraQueryGeometry",value:function(t){var n=this.getCameraPoint();if(t.length===1)return[t[0],n];var i=n.x,a=n.y,o=n.x,s=n.y,u=J$e(t),l;try{for(u.s();!(l=u.n()).done;){var f=l.value;i=Math.min(i,f.x),a=Math.min(a,f.y),o=Math.max(o,f.x),s=Math.max(s,f.y)}}catch(h){u.e(h)}finally{u.f()}return[new Wa(i,a),new Wa(o,a),new Wa(o,s),new Wa(i,s),new Wa(i,a)]}},{key:"coordinatePoint",value:function(t){var n=$q(t.x*this.worldSize,t.y*this.worldSize,0,1);return kx(n,n,this.pixelMatrix),new Wa(n[0]/n[3],n[1]/n[3])}},{key:"locationPoint",value:function(t){return this.coordinatePoint(this.locationCoordinate(t))}},{key:"pointLocation",value:function(t){return this.coordinateLocation(this.pointCoordinate(t))}},{key:"locationCoordinate",value:function(t){return bT.fromLngLat(t)}},{key:"coordinateLocation",value:function(t){return t.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var t=-90,n=90,i=-180,a=180,o,s,u,l,f=this.size,h=this.unmodified;if(this.latRange){var p=this.latRange;t=vM(p[1])*this.worldSize,n=vM(p[0])*this.worldSize,o=n-t<f.y?f.y/(n-t):0}if(this.lngRange){var v=this.lngRange;i=dM(v[0])*this.worldSize,a=dM(v[1])*this.worldSize,s=a-i<f.x?f.x/(a-i):0}var m=this.point,x=Math.max(s||0,o||0);if(x){this.center=this.unproject(new Wa(s?(a+i)/2:m.x,o?(n+t)/2:m.y)),ns?this.zoom=Math.max(this.zoom,Math.max(-1,this.minZoom)):this.zoom+=this.scaleZoom(x),this.unmodified=h,this.constraining=!1;return}if(this.latRange){var E=m.y,A=f.y/2;E-A<t&&(l=t+A),E+A>n&&(l=n-A)}if(this.lngRange){var L=m.x,k=f.x/2;L-k<i&&(u=i+k),L+k>a&&(u=a-k)}(u!==void 0||l!==void 0)&&(this.center=this.unproject(new Wa(u!==void 0?u:m.x,l!==void 0?l:m.y))),this.unmodified=h,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(!!this.height){var t=this._fov/2,n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(t)*this.height;var i=Math.PI/2+this._pitch,a=this._fov*(.5+n.y/this.height),o=Math.sin(a)*this.cameraToCenterDistance/Math.sin(vy(Math.PI-i-a,.01,Math.PI-.01)),s=this.point,u=s.x,l=s.y,f=Math.cos(Math.PI/2-this._pitch)*o+this.cameraToCenterDistance,h=f*1.01,p=this.height/50,v=new Float64Array(16);N2(v,this._fov,this.width/this.height,p,h),v[8]=-n.x*2/this.width,v[9]=n.y*2/this.height,op(v,v,[1,-1,1]),ih(v,v,[0,0,-this.cameraToCenterDistance]),m_(v,v,this._pitch),y_(v,v,this.angle),ih(v,v,[-u,-l,0]),this.mercatorMatrix=op([],v,[this.worldSize,this.worldSize,this.worldSize]),op(v,v,[1,1,rie(1,this.center.lat)*this.worldSize,1]),this.projMatrix=v,this.invProjMatrix=s2([],this.projMatrix);var m=this.width%2/2,x=this.height%2/2,E=Math.cos(this.angle),A=Math.sin(this.angle),L=u-Math.round(u)+E*m+A*x,k=l-Math.round(l)+E*x+A*m,R=new Float64Array(v);if(ih(R,R,[L>.5?L-1:L,k>.5?k-1:k,0]),this.alignedProjMatrix=R,v=ts(),op(v,v,[this.width/2,-this.height/2,1]),ih(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=ts(),op(v,v,[1,-1,1]),ih(v,v,[-1,-1,0]),op(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v,this.pixelMatrix=ff(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),v=s2(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),e}(),rUe=ude,nUe=function(){try{var e=rUe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),nie=nUe,lH=nie;function iUe(e,r,t){r=="__proto__"&&lH?lH(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}var s6=iUe,aUe=s6,oUe=x3;function sUe(e,r,t){(t!==void 0&&!oUe(e[r],t)||t===void 0&&!(r in e))&&aUe(e,r,t)}var iie=sUe;function uUe(e){return function(r,t,n){for(var i=-1,a=Object(r),o=n(r),s=o.length;s--;){var u=o[e?s:++i];if(t(a[u],u,a)===!1)break}return r}}var lUe=uUe,cUe=lUe,fUe=cUe(),hUe=fUe,ID={exports:{}};(function(e,r){var t=lde,n=r&&!r.nodeType&&r,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,o=a?t.Buffer:void 0,s=o?o.allocUnsafe:void 0;function u(l,f){if(f)return l.slice();var h=l.length,p=s?s(h):new l.constructor(h);return l.copy(p),p}e.exports=u})(ID,ID.exports);var cH=cde;function pUe(e){var r=new e.constructor(e.byteLength);return new cH(r).set(new cH(e)),r}var dUe=pUe,vUe=dUe;function gUe(e,r){var t=r?vUe(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var mUe=gUe;function yUe(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}var _Ue=yUe,xUe=sS,fH=Object.create,bUe=function(){function e(){}return function(r){if(!xUe(r))return{};if(fH)return fH(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),wUe=bUe,CUe=fde,EUe=CUe(Object.getPrototypeOf,Object),aie=EUe,SUe=wUe,AUe=aie,TUe=DZ;function MUe(e){return typeof e.constructor=="function"&&!TUe(e)?SUe(AUe(e)):{}}var LUe=MUe,IUe=b3,kUe=BZ;function PUe(e){return kUe(e)&&IUe(e)}var RUe=PUe,OUe=hde,FUe=aie,DUe=BZ,BUe="[object Object]",NUe=Function.prototype,zUe=Object.prototype,oie=NUe.toString,$Ue=zUe.hasOwnProperty,UUe=oie.call(Object);function VUe(e){if(!DUe(e)||OUe(e)!=BUe)return!1;var r=FUe(e);if(r===null)return!0;var t=$Ue.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&oie.call(t)==UUe}var GUe=VUe;function HUe(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var sie=HUe,jUe=s6,WUe=x3,XUe=Object.prototype,YUe=XUe.hasOwnProperty;function ZUe(e,r,t){var n=e[r];(!(YUe.call(e,r)&&WUe(n,t))||t===void 0&&!(r in e))&&jUe(e,r,t)}var qUe=ZUe,KUe=qUe,QUe=s6;function JUe(e,r,t,n){var i=!t;t||(t={});for(var a=-1,o=r.length;++a<o;){var s=r[a],u=n?n(t[s],e[s],s,t,e):void 0;u===void 0&&(u=e[s]),i?QUe(t,s,u):KUe(t,s,u)}return t}var eVe=JUe;function tVe(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}var rVe=tVe,nVe=sS,iVe=DZ,aVe=rVe,oVe=Object.prototype,sVe=oVe.hasOwnProperty;function uVe(e){if(!nVe(e))return aVe(e);var r=iVe(e),t=[];for(var n in e)n=="constructor"&&(r||!sVe.call(e,n))||t.push(n);return t}var lVe=uVe,cVe=pde,fVe=lVe,hVe=b3;function pVe(e){return hVe(e)?cVe(e,!0):fVe(e)}var uie=pVe,dVe=eVe,vVe=uie;function gVe(e){return dVe(e,vVe(e))}var mVe=gVe,hH=iie,yVe=ID.exports,_Ve=mUe,xVe=_Ue,bVe=LUe,pH=dde,dH=vde,wVe=RUe,CVe=gde.exports,EVe=mde,SVe=sS,AVe=GUe,TVe=yde,vH=sie,MVe=mVe;function LVe(e,r,t,n,i,a,o){var s=vH(e,t),u=vH(r,t),l=o.get(u);if(l){hH(e,t,l);return}var f=a?a(s,u,t+"",e,r,o):void 0,h=f===void 0;if(h){var p=dH(u),v=!p&&CVe(u),m=!p&&!v&&TVe(u);f=u,p||v||m?dH(s)?f=s:wVe(s)?f=xVe(s):v?(h=!1,f=yVe(u,!0)):m?(h=!1,f=_Ve(u,!0)):f=[]:AVe(u)||pH(u)?(f=s,pH(s)?f=MVe(s):(!SVe(s)||EVe(s))&&(f=bVe(u))):h=!1}h&&(o.set(u,f),i(f,u,n,a,o),o.delete(u)),hH(e,t,f)}var IVe=LVe,kVe=_de,PVe=iie,RVe=hUe,OVe=IVe,FVe=sS,DVe=uie,BVe=sie;function lie(e,r,t,n,i){e!==r&&RVe(r,function(a,o){if(i||(i=new kVe),FVe(a))OVe(e,r,o,t,lie,n,i);else{var s=n?n(BVe(e,o),a,o+"",e,r,i):void 0;s===void 0&&(s=a),PVe(e,o,s)}},DVe)}var NVe=lie;function zVe(e){return e}var cie=zVe;function $Ve(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}var UVe=$Ve,VVe=UVe,gH=Math.max;function GVe(e,r,t){return r=gH(r===void 0?e.length-1:r,0),function(){for(var n=arguments,i=-1,a=gH(n.length-r,0),o=Array(a);++i<a;)o[i]=n[r+i];i=-1;for(var s=Array(r+1);++i<r;)s[i]=n[i];return s[r]=t(o),VVe(e,this,s)}}var HVe=GVe;function jVe(e){return function(){return e}}var WVe=jVe,XVe=WVe,mH=nie,YVe=cie,ZVe=mH?function(e,r){return mH(e,"toString",{configurable:!0,enumerable:!1,value:XVe(r),writable:!0})}:YVe,qVe=ZVe,KVe=800,QVe=16,JVe=Date.now;function eGe(e){var r=0,t=0;return function(){var n=JVe(),i=QVe-(n-t);if(t=n,i>0){if(++r>=KVe)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}var tGe=eGe,rGe=qVe,nGe=tGe,iGe=nGe(rGe),aGe=iGe,oGe=cie,sGe=HVe,uGe=aGe;function lGe(e,r){return uGe(sGe(e,r,oGe),e+"")}var cGe=lGe,fGe=x3,hGe=b3,pGe=xde,dGe=sS;function vGe(e,r,t){if(!dGe(t))return!1;var n=typeof r;return(n=="number"?hGe(t)&&pGe(r,t.length):n=="string"&&r in t)?fGe(t[r],e):!1}var gGe=vGe,mGe=cGe,yGe=gGe;function _Ge(e){return mGe(function(r,t){var n=-1,i=t.length,a=i>1?t[i-1]:void 0,o=i>2?t[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,o&&yGe(t[0],t[1],o)&&(a=i<3?void 0:a,i=1),r=Object(r);++n<i;){var s=t[n];s&&e(r,s,n,a)}return r})}var xGe=_Ge,bGe=NVe,wGe=xGe,CGe=wGe(function(e,r,t){bGe(e,r,t)}),u_=CGe,jo=ot(function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};st(this,e),u_(this,t),this.type=r});function EGe(e){var r=SGe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function SGe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fie=function(e){er(t,e);var r=EGe(t);function t(n){var i;st(this,t),i=r.call(this),X(He(i),"renderFrameCallback",function(){var f=Math.min((z0()-i.easeStart)/i.easeOptions.duration,1);i.onEaseFrame(i.easeOptions.easing(f)),f<1?i.easeFrameId=i.requestRenderFrame(i.renderFrameCallback):i.stop()}),i.options=n;var a=n.minZoom,o=n.maxZoom,s=n.minPitch,u=n.maxPitch,l=n.renderWorldCopies;return i.moving=!1,i.zooming=!1,i.bearingSnap=n.bearingSnap,i.pitchEnabled=n.pitchEnabled,i.rotateEnabled=n.rotateEnabled,i.transform=new tUe(a,o,s,u,l),i}return ot(t,[{key:"requestRenderFrame",value:function(i){return 0}},{key:"cancelRenderFrame",value:function(i){}},{key:"getCenter",value:function(){var i=this.transform.center,a=i.lng,o=i.lat;return new Us(a,o)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(i,a){return this.jumpTo({center:i},a)}},{key:"setPitch",value:function(i,a){return this.jumpTo({pitch:i},a),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(i,a,o){return this.easeTo(Kt.exports.merge({center:i},a),o)}},{key:"zoomOut",value:function(i,a){return this.zoomTo(this.getZoom()-1,i,a),this}},{key:"setBearing",value:function(i,a){return this.jumpTo({bearing:i},a),this}},{key:"setZoom",value:function(i,a){return this.jumpTo({zoom:i},a),this}},{key:"zoomIn",value:function(i,a){return this.zoomTo(this.getZoom()+1,i,a),this}},{key:"zoomTo",value:function(i,a,o){return this.easeTo(Kt.exports.merge({zoom:i},a),o)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(i,a){return this.jumpTo({padding:i},a),this}},{key:"rotateTo",value:function(i,a,o){return this.easeTo(Kt.exports.merge({bearing:i},a),o)}},{key:"resetNorth",value:function(i,a){return this.rotateTo(0,Kt.exports.merge({duration:1e3},i),a),this}},{key:"resetNorthPitch",value:function(i,a){return this.easeTo(Kt.exports.merge({bearing:0,pitch:0,duration:1e3},i),a),this}},{key:"fitBounds",value:function(i,a,o){return this.fitInternal(this.cameraForBounds(i,a),a,o)}},{key:"cameraForBounds",value:function(i,a){return i=WE.convert(i),this.cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),0,a)}},{key:"snapToNorth",value:function(i,a){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(i,a):this}},{key:"jumpTo",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;this.stop();var o=this.transform,s=!1,u=!1,l=!1;return i.zoom&&o.zoom!==+i.zoom&&(s=!0,o.zoom=+i.zoom),i.center!==void 0&&(o.center=Us.convert(i.center)),i.bearing&&o.bearing!==+i.bearing&&(u=!0,o.bearing=+i.bearing),i.pitch&&o.pitch!==+i.pitch&&(l=!0,o.pitch=+i.pitch),i.padding!=null&&!o.isPaddingEqual(i.padding)&&(o.padding=i.padding),this.emit("movestart",new jo("movestart",a)),this.emit("move",new jo("move",a)),s&&(this.emit("zoomstart",new jo("zoomstart",a)),this.emit("zoom",new jo("zoom",a)),this.emit("zoomend",new jo("zoomend",a))),u&&(this.emit("rotatestart",new jo("rotatestart",a)),this.emit("rotate",new jo("rotate",a)),this.emit("rotateend",new jo("rotateend",a))),l&&(this.emit("pitchstart",new jo("pitchstart",a)),this.emit("pitch",new jo("pitch",a)),this.emit("pitchend",new jo("pitchend",a))),this.emit("moveend",new jo("moveend",a))}},{key:"easeTo",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;a=Kt.exports.merge({offset:[0,0],duration:500,easing:MD},a),(a.animate===!1||!a.essential&&sH())&&(a.duration=0);var s=this.transform,u=this.getZoom(),l=this.getBearing(),f=this.getPitch(),h=this.getPadding(),p=a.zoom?+a.zoom:u,v=a.bearing?this.normalizeBearing(a.bearing,l):l,m=a.pitch?+a.pitch:f,x=a.padding?a.padding:s.padding,E=Wa.convert(a.offset),A=s.centerPoint.add(E),L=s.pointLocation(A),k=Us.convert(a.center||L);this.normalizeCenter(k);var R=s.project(L),D=s.project(k).sub(R),$=s.zoomScale(p-u),j,H;a.around&&(j=Us.convert(a.around),H=s.locationPoint(j));var ee={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||p!==u,this.rotating=this.rotating||l!==v,this.pitching=this.pitching||m!==f,this.padding=!s.isPaddingEqual(x),this.easeId=a.easeId,this.prepareEase(o,a.noMoveStart,ee),clearTimeout(this.easeEndTimeoutID),this.ease(function(U){if(i.zooming&&(s.zoom=Bd(u,p,U)),i.rotating&&i.rotateEnabled&&(s.bearing=Bd(l,v,U)),i.pitching&&i.pitchEnabled&&(s.pitch=Bd(f,m,U)),i.padding&&(s.interpolatePadding(h,x,U),A=s.centerPoint.add(E)),j)s.setLocationAtPoint(j,H);else{var W=s.zoomScale(s.zoom-u),Q=p>u?Math.min(2,$):Math.max(.5,$),te=Math.pow(Q,1-U),ie=s.unproject(R.add(D.mult(U*te)).mult(W));s.setLocationAtPoint(s.renderWorldCopies?ie.wrap():ie,A)}i.fireMoveEvents(o)},function(U){i.afterEase(o,U)},a),this}},{key:"flyTo",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;if(!a.essential&&sH()){var s=W$e(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(s,o)}this.stop(),a=Kt.exports.merge({offset:[0,0],speed:1.2,curve:1.42,easing:MD},a);var u=this.transform,l=this.getZoom(),f=this.getBearing(),h=this.getPitch(),p=this.getPadding(),v=a.zoom?vy(+a.zoom,u.minZoom,u.maxZoom):l,m=a.bearing?this.normalizeBearing(a.bearing,f):f,x=a.pitch?+a.pitch:h,E="padding"in a?a.padding:u.padding,A=u.zoomScale(v-l),L=Wa.convert(a.offset),k=u.centerPoint.add(L),R=u.pointLocation(k),D=Us.convert(a.center||R);this.normalizeCenter(D);var $=u.project(R),j=u.project(D).sub($),H=a.curve,ee=Math.max(u.width,u.height),U=ee/A,W=j.mag();if("minZoom"in a){var Q=vy(Math.min(a.minZoom,l,v),u.minZoom,u.maxZoom),te=ee/u.zoomScale(Q-l);H=Math.sqrt(te/W*2)}var ie=H*H;function ve(Lt){var rn=(U*U-ee*ee+(Lt?-1:1)*ie*ie*W*W)/(2*(Lt?U:ee)*ie*W);return Math.log(Math.sqrt(rn*rn+1)-rn)}function me(Lt){return(Math.exp(Lt)-Math.exp(-Lt))/2}function Re(Lt){return(Math.exp(Lt)+Math.exp(-Lt))/2}function We(Lt){return me(Lt)/Re(Lt)}var je=ve(0),lt=function(rn){return Re(je)/Re(je+H*rn)},dt=function(rn){return ee*((Re(je)*We(je+H*rn)-me(je))/ie)/W},ct=(ve(1)-je)/H;if(Math.abs(W)<1e-6||!isFinite(ct)){if(Math.abs(ee-U)<1e-6)return this.easeTo(a,o);var Tt=U<ee?-1:1;ct=Math.abs(Math.log(U/ee))/H,dt=function(){return 0},lt=function(rn){return Math.exp(Tt*H*rn)}}if("duration"in a)a.duration=+a.duration;else{var It="screenSpeed"in a?+a.screenSpeed/H:+a.speed;a.duration=1e3*ct/It}return a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this.zooming=!0,this.rotating=f!==m,this.pitching=x!==h,this.padding=!u.isPaddingEqual(E),this.prepareEase(o,!1),this.ease(function(Lt){var rn=Lt*ct,wn=1/lt(rn);u.zoom=Lt===1?v:l+u.scaleZoom(wn),i.rotating&&(u.bearing=Bd(f,m,Lt)),i.pitching&&(u.pitch=Bd(h,x,Lt)),i.padding&&(u.interpolatePadding(p,E,Lt),k=u.centerPoint.add(L));var zn=Lt===1?D:u.unproject($.add(j.mult(dt(rn))).mult(wn));u.setLocationAtPoint(u.renderWorldCopies?zn.wrap():zn,k),i.fireMoveEvents(o)},function(){return i.afterEase(o)},a),this}},{key:"fitScreenCoordinates",value:function(i,a,o,s,u){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Wa.convert(i)),this.transform.pointLocation(Wa.convert(a)),o,s),s,u)}},{key:"stop",value:function(i,a){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var o=this.onEaseEnd;delete this.onEaseEnd,o.call(this,a)}return this}},{key:"normalizeBearing",value:function(i,a){i=a6(i,-180,180);var o=Math.abs(i-a);return Math.abs(i-360-a)<o&&(i-=360),Math.abs(i+360-a)<o&&(i+=360),i}},{key:"normalizeCenter",value:function(i){var a=this.transform;if(!(!a.renderWorldCopies||a.lngRange)){var o=i.lng-a.center.lng;i.lng+=o>180?-360:o<-180?360:0}}},{key:"fireMoveEvents",value:function(i){this.emit("move",new jo("move",i)),this.zooming&&this.emit("zoom",new jo("zoom",i)),this.rotating&&this.emit("rotate",new jo("rotate",i)),this.pitching&&this.emit("rotate",new jo("pitch",i))}},{key:"prepareEase",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!a&&!o.moving&&this.emit("movestart",new jo("movestart",i)),this.zooming&&!o.zooming&&this.emit("zoomstart",new jo("zoomstart",i)),this.rotating&&!o.rotating&&this.emit("rotatestart",new jo("rotatestart",i)),this.pitching&&!o.pitching&&this.emit("pitchstart",new jo("pitchstart",i))}},{key:"afterEase",value:function(i,a){if(!(this.easeId&&a&&this.easeId===a)){delete this.easeId;var o=this.zooming,s=this.rotating,u=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,o&&this.emit("zoomend",new jo("zoomend",i)),s&&this.emit("rotateend",new jo("rotateend",i)),u&&this.emit("pitchend",new jo("pitchend",i)),this.emit("moveend",new jo("moveend",i))}}},{key:"ease",value:function(i,a,o){o.animate===!1||o.duration===0?(i(1),a()):(this.easeStart=z0(),this.easeOptions=o,this.onEaseFrame=i,this.onEaseEnd=a,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(i,a,o,s){var u={top:0,bottom:0,right:0,left:0};if(s=Kt.exports.merge({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},s),typeof s.padding=="number"){var l=s.padding;s.padding={top:l,bottom:l,right:l,left:l}}s.padding=Kt.exports.merge(u,s.padding);var f=this.transform,h=f.padding,p=f.project(Us.convert(i)),v=f.project(Us.convert(a)),m=p.rotate(-o*Math.PI/180),x=v.rotate(-o*Math.PI/180),E=new Wa(Math.max(m.x,x.x),Math.max(m.y,x.y)),A=new Wa(Math.min(m.x,x.x),Math.min(m.y,x.y)),L=E.sub(A),k=(f.width-(h.left+h.right+s.padding.left+s.padding.right))/L.x,R=(f.height-(h.top+h.bottom+s.padding.top+s.padding.bottom))/L.y;if(!(R<0||k<0)){var D=Math.min(f.scaleZoom(f.scale*Math.min(k,R)),s.maxZoom),$=Wa.convert(s.offset),j=(s.padding.left-s.padding.right)/2,H=(s.padding.top-s.padding.bottom)/2,ee=new Wa($.x+j,$.y+H),U=ee.mult(f.scale/f.zoomScale(D)),W=f.unproject(p.add(v).div(2).sub(U));return{center:W,zoom:D,bearing:o}}}},{key:"fitInternal",value:function(i,a,o){return i?(a=Kt.exports.merge(i,a),delete a.padding,a.linear?this.easeTo(a,o):this.flyTo(a,o)):this}}]),t}(zf.exports.EventEmitter);function kD(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=AGe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function AGe(e,r){if(!!e){if(typeof e=="string")return yH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return yH(e,r)}}function yH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var bs={};bs.create=function(e,r,t){var n=Hn.document.createElement(e);return r!==void 0&&(n.className=r),t&&t.appendChild(n),n};bs.createNS=function(e,r){var t=Hn.document.createElementNS(e,r);return t};var Xx=Hn.document&&Hn.document.documentElement.style;function hie(e){if(!Xx)return e[0];var r=kD(e),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n in Xx)return n}}catch(i){r.e(i)}finally{r.f()}return e[0]}var YC=hie(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),pie;bs.disableDrag=function(){Xx&&YC&&(pie=Xx[YC],Xx[YC]="none")};bs.enableDrag=function(){Xx&&YC&&(Xx[YC]=pie)};var TGe=hie(["transform","WebkitTransform"]);bs.setTransform=function(e,r){e.style[TGe]=r};var yL=!1;try{var wT=Object.defineProperty({},"passive",{get:function(){yL=!0}});Hn.addEventListener("test",wT,wT),Hn.removeEventListener("test",wT,wT)}catch{yL=!1}bs.addEventListener=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&yL?e.addEventListener(r,t,n):e.addEventListener(r,t,n.capture)};bs.removeEventListener=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&yL?e.removeEventListener(r,t,n):e.removeEventListener(r,t,n.capture)};var _H=function e(r){r.preventDefault(),r.stopPropagation(),Hn.removeEventListener("click",e,!0)};bs.suppressClick=function(){ns||(Hn.addEventListener("click",_H,!0),setTimeout(function(){Hn.removeEventListener("click",_H,!0)},0))};bs.mousePos=function(e,r){if(ns)return new Wa(r.clientX-e.left-0,r.clientY-e.top-0);var t=e.getBoundingClientRect();return new Wa(r.clientX-t.left-e.clientLeft,r.clientY-t.top-e.clientTop)};bs.touchPos=function(e,r){if(ns){var s=[],u=kD(r),l;try{for(u.s();!(l=u.n()).done;){var f=l.value;s.push(new Wa(f.clientX-e.left,f.clientY-e.top))}}catch(h){u.e(h)}finally{u.f()}return s}else{var t=e.getBoundingClientRect(),n=[],i=kD(r),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;n.push(new Wa(o.clientX-t.left-e.clientLeft,o.clientY-t.top-e.clientTop))}}catch(h){i.e(h)}finally{i.f()}return n}};bs.mouseButton=function(e){return ns&&typeof Hn.InstallTrigger!="undefined"&&e.button===2&&e.ctrlKey&&Hn.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button};bs.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};function MGe(e){var r=LGe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function LGe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ey=function(e){er(t,e);var r=MGe(t);function t(n,i,a){var o,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};st(this,t);var u=bs.mousePos(i.getCanvasContainer(),a),l=i.unproject(u);return o=r.call(this,n,u_({point:u,lngLat:l,originalEvent:a},s)),o.defaultPrevented=!1,o.target=i,o}return ot(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(jo);function IGe(e){var r=kGe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function kGe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var CT=function(e){er(t,e);var r=IGe(t);function t(n,i,a){var o;st(this,t);var s=n==="touchend"?a.changedTouches:a.touches,u=bs.touchPos(i.getCanvasContainer(),s),l=u.map(function(p){return i.unproject(p)}),f=u.reduce(function(p,v,m,x){return p.add(v.div(x.length))},new Wa(0,0)),h=i.unproject(f);return o=r.call(this,n,{points:u,point:f,lngLats:l,lngLat:h,originalEvent:a}),o.defaultPrevented=!1,o}return ot(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(jo);function PGe(e){var r=RGe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function RGe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var OGe=function(e){er(t,e);var r=PGe(t);function t(n,i,a){var o;return st(this,t),o=r.call(this,n,{originalEvent:a}),o.defaultPrevented=!1,o}return ot(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(jo),FGe=function(){function e(r){st(this,e),this.map=r}return ot(e,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(t){this.map.emit(t.type,new ey(t.type,this.map,t))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new ey("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(t){this.delayContextMenu?this.contextMenuEvent=t:this.map.emit(t.type,new ey(t.type,this.map,t)),this.map.listeners("contextmenu")&&t.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),e}(),DGe=function(){function e(r,t){st(this,e),this.map=r,this.el=r.getCanvasContainer(),this.container=r.getContainer(),this.clickTolerance=t.clickTolerance||1}return ot(e,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"mousedown",value:function(t,n){!this.isEnabled()||!(t.shiftKey&&t.button===0)||(bs.disableDrag(),this.startPos=this.lastPos=n,this.active=!0)}},{key:"mousemoveWindow",value:function(t,n){if(!!this.active){var i=n;if(!(this.lastPos.equals(i)||!this.box&&i.dist(this.startPos)<this.clickTolerance)){var a=this.startPos;this.lastPos=i,this.box||(this.box=bs.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",t));var o=Math.min(a.x,i.x),s=Math.max(a.x,i.x),u=Math.min(a.y,i.y),l=Math.max(a.y,i.y);bs.setTransform(this.box,"translate(".concat(o,"px,").concat(u,"px)")),this.box&&(this.box.style.width="".concat(s-o,"px"),this.box.style.height="".concat(l-u,"px"))}}}},{key:"mouseupWindow",value:function(t,n){var i=this;if(!!this.active&&t.button===0){var a=this.startPos,o=n;if(this.reset(),bs.suppressClick(),a.x===o.x&&a.y===o.y)this.fireEvent("boxzoomcancel",t);else return this.map.emit("boxzoomend",new jo("boxzoomend",{originalEvent:t})),{cameraAnimation:function(u){return u.fitScreenCoordinates(a,o,i.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(t){!this.active||t.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",t))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(bs.remove(this.box),this.box=null),bs.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(t,n){return this.map.emit(t,new jo(t,{originalEvent:n}))}}]),e}(),BGe=function(){function e(){st(this,e),this.reset()}return ot(e,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(t,n){return t.preventDefault(),{cameraAnimation:function(a){a.easeTo({duration:300,zoom:a.getZoom()+(t.shiftKey?-1:1),around:a.unproject(n)},{originalEvent:t})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function NGe(e){var r=zGe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function zGe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var $Ge=function(e){er(t,e);var r=NGe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","renderFrame"),n}return ot(t)}(jo);function UGe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=VGe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function VGe(e,r){if(!!e){if(typeof e=="string")return xH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xH(e,r)}}function xH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Sk={linearity:.3,easing:o6(0,0,.3,1)},GGe=u_({deceleration:2500,maxSpeed:1400},Sk),HGe=u_({deceleration:20,maxSpeed:1400},Sk),jGe=u_({deceleration:1e3,maxSpeed:360},Sk),WGe=u_({deceleration:1e3,maxSpeed:90},Sk),XGe=function(){function e(r){st(this,e),this.map=r,this.clear()}return ot(e,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(t){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:z0(),settings:t})}},{key:"drainInertiaBuffer",value:function(){for(var t=this.inertiaBuffer,n=z0(),i=160;t.length>0&&n-t[0].time>i;)t.shift()}},{key:"onMoveEnd",value:function(t){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var n={zoom:0,bearing:0,pitch:0,pan:new Wa(0,0),pinchAround:void 0,around:void 0},i=UGe(this.inertiaBuffer),a;try{for(i.s();!(a=i.n()).done;){var o=a.value.settings;n.zoom+=o.zoomDelta||0,n.bearing+=o.bearingDelta||0,n.pitch+=o.pitchDelta||0,o.panDelta&&n.pan._add(o.panDelta),o.around&&(n.around=o.around),o.pinchAround&&(n.pinchAround=o.pinchAround)}}catch(x){i.e(x)}finally{i.f()}var s=this.inertiaBuffer[this.inertiaBuffer.length-1],u=s.time-this.inertiaBuffer[0].time,l={};if(n.pan.mag()){var f=ST(n.pan.mag(),u,u_({},GGe,t||{}));l.offset=n.pan.mult(f.amount/n.pan.mag()),l.center=this.map.transform.center,ET(l,f)}if(n.zoom){var h=ST(n.zoom,u,HGe);l.zoom=this.map.transform.zoom+h.amount,ET(l,h)}if(n.bearing){var p=ST(n.bearing,u,jGe);l.bearing=this.map.transform.bearing+vy(p.amount,-179,179),ET(l,p)}if(n.pitch){var v=ST(n.pitch,u,WGe);l.pitch=this.map.transform.pitch+v.amount,ET(l,v)}if(l.zoom||l.bearing){var m=n.pinchAround===void 0?n.around:n.pinchAround;l.around=m?this.map.unproject(m):this.map.getCenter()}return this.clear(),u_(l,{noMoveStart:!0})}}}]),e}();function ET(e,r){(!e.duration||e.duration<r.duration)&&(e.duration=r.duration,e.easing=r.easing)}function ST(e,r,t){var n=t.maxSpeed,i=t.linearity,a=t.deceleration,o=vy(e*i/(r/1e3),-n,n),s=Math.abs(o)/(a*i);return{easing:t.easing,duration:s*1e3,amount:o*(s/2)}}var YGe={panStep:100,bearingStep:15,pitchStep:10},ZGe=function(){function e(){st(this,e);var r=YGe;this.panStep=r.panStep,this.bearingStep=r.bearingStep,this.pitchStep=r.pitchStep}return ot(e,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(t){var n=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var i=0,a=0,o=0,s=0,u=0;switch(t.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:t.shiftKey?a=-1:(t.preventDefault(),s=-1);break;case 39:t.shiftKey?a=1:(t.preventDefault(),s=1);break;case 38:t.shiftKey?o=1:(t.preventDefault(),u=-1);break;case 40:t.shiftKey?o=-1:(t.preventDefault(),u=1);break;default:return}return{cameraAnimation:function(f){var h=f.getZoom();f.easeTo({duration:300,easeId:"keyboardHandler",easing:qGe,zoom:i?Math.round(h)+i*(t.shiftKey?2:1):h,bearing:f.getBearing()+a*n.bearingStep,pitch:f.getPitch()+o*n.pitchStep,offset:[-s*n.panStep,-u*n.panStep],center:f.getCenter()},{originalEvent:t})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function qGe(e){return e*(2-e)}var KGe=function(){function e(r,t){st(this,e),this.map=r,this.clickTolerance=t.clickTolerance}return ot(e,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(t){return this.firePreventable(new OGe(t.type,this.map,t))}},{key:"mousedown",value:function(t,n){return this.mousedownPos=n,this.firePreventable(new ey(t.type,this.map,t))}},{key:"mouseup",value:function(t){this.map.emit(t.type,new ey(t.type,this.map,t))}},{key:"click",value:function(t,n){this.mousedownPos&&this.mousedownPos.dist(n)>=this.clickTolerance||this.map.emit(t.type,new ey(t.type,this.map,t))}},{key:"dblclick",value:function(t){return this.firePreventable(new ey(t.type,this.map,t))}},{key:"mouseover",value:function(t){this.map.emit(t.type,new ey(t.type,this.map,t))}},{key:"mouseout",value:function(t){this.map.emit(t.type,new ey(t.type,this.map,t))}},{key:"touchstart",value:function(t){return this.firePreventable(new CT(t.type,this.map,t))}},{key:"touchmove",value:function(t){this.map.emit(t.type,new CT(t.type,this.map,t))}},{key:"touchend",value:function(t){this.map.emit(t.type,new CT(t.type,this.map,t))}},{key:"touchcancel",value:function(t){this.map.emit(t.type,new CT(t.type,this.map,t))}},{key:"firePreventable",value:function(t){if(this.map.emit(t.type,t),t.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),e}(),AT,Ak=0,u6=2,QGe=(AT={},X(AT,Ak,1),X(AT,u6,2),AT);function JGe(e,r){var t=QGe[r];return e.buttons===void 0||(e.buttons&t)!==t}var l6=function(){function e(r){st(this,e),this.reset(),this.clickTolerance=r.clickTolerance||1}return ot(e,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(t,n){if(!this.lastPoint){var i=bs.mouseButton(t);!this.correctButton(t,i)||(this.lastPoint=n,this.eventButton=i)}}},{key:"mousemoveWindow",value:function(t,n){var i=this.lastPoint;if(!!i){if(t.preventDefault(),JGe(t,this.eventButton)){this.reset();return}if(!(!this.moved&&n.dist(i)<this.clickTolerance))return this.moved=!0,this.lastPoint=n,this.move(i,n)}}},{key:"mouseupWindow",value:function(t){if(!!this.lastPoint){var n=bs.mouseButton(t);n===this.eventButton&&(this.moved&&bs.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(t,n){return!1}},{key:"move",value:function(t,n){}}]),e}();function eHe(e){var r=tHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function tHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rHe=function(e){er(t,e);var r=eHe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"mousedown",value:function(i,a){Yv(ze(t.prototype),"mousedown",this).call(this,i,a),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(i,a){return{around:a,panDelta:a.sub(i)}}},{key:"correctButton",value:function(i,a){return a===Ak&&!i.ctrlKey}}]),t}(l6);function nHe(e){var r=iHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function iHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var aHe=function(e){er(t,e);var r=nHe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"correctButton",value:function(i,a){return a===Ak&&i.ctrlKey||a===u6}},{key:"move",value:function(i,a){var o=-.5,s=(a.y-i.y)*o;if(s)return this.active=!0,{pitchDelta:s}}},{key:"contextmenu",value:function(i){i.preventDefault()}}]),t}(l6);function oHe(e){var r=sHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function sHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var uHe=function(e){er(t,e);var r=oHe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"contextmenu",value:function(i){i.preventDefault()}},{key:"correctButton",value:function(i,a){return a===Ak&&i.ctrlKey||a===u6}},{key:"move",value:function(i,a){var o=.8,s=(a.x-i.x)*o;if(s)return this.active=!0,{bearingDelta:s}}}]),t}(l6),bH=4.000244140625,lHe=1/100,cHe=1/450,fHe=2,hHe=function(){function e(r,t){var n=this;st(this,e),X(this,"onScrollFrame",function(){if(!!n.frameId&&(n.frameId=null,!!n.isActive())){var i=n.map.transform;if(n.delta!==0){var a=n.type==="wheel"&&Math.abs(n.delta)>bH?n.wheelZoomRate:n.defaultZoomRate,o=fHe/(1+Math.exp(-Math.abs(n.delta*a)));n.delta<0&&o!==0&&(o=1/o);var s=typeof n.targetZoom=="number"?i.zoomScale(n.targetZoom):i.scale;n.targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(s*o))),n.type==="wheel"&&(n.startZoom=i.zoom,n.easing=n.smoothOutEasing(200)),n.delta=0}var u=typeof n.targetZoom=="number"?n.targetZoom:i.zoom,l=n.startZoom,f=n.easing,h=!1,p;if(n.type==="wheel"&&l&&f){var v=Math.min((z0()-n.lastWheelEventTime)/200,1),m=f(v);p=Bd(l,u,m),v<1?n.frameId||(n.frameId=!0):h=!0}else p=u,h=!0;return n.active=!0,h&&(n.active=!1,n.finishTimeout=setTimeout(function(){n.zooming=!1,n.handler.triggerRenderFrame(),delete n.targetZoom,delete n.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!h,zoomDelta:p-i.zoom,around:n.aroundPoint,originalEvent:n.lastWheelEvent}}}),this.map=r,this.el=r.getCanvasContainer(),this.handler=t,this.delta=0,this.defaultZoomRate=lHe,this.wheelZoomRate=cHe}return ot(e,[{key:"setZoomRate",value:function(t){this.defaultZoomRate=t}},{key:"setWheelZoomRate",value:function(t){this.wheelZoomRate=t}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(t){this.isEnabled()||(this.enabled=!0,this.aroundCenter=t&&t.around==="center")}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"wheel",value:function(t){if(!!this.isEnabled()){var n=t.deltaMode===window.WheelEvent.DOM_DELTA_LINE?t.deltaY*40:t.deltaY,i=z0(),a=i-(this.lastWheelEventTime||0);this.lastWheelEventTime=i,n!==0&&n%bH===0?this.type="wheel":n!==0&&Math.abs(n)<4?this.type="trackpad":a>400?(this.type=null,this.lastValue=n,this.timeout=setTimeout(this.onTimeout,40,t)):this.type||(this.type=Math.abs(a*n)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,n+=this.lastValue)),t.shiftKey&&n&&(n=n/4),this.type&&(this.lastWheelEvent=t,this.delta-=n,this.active||this.start(t)),t.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(t){this.type="wheel",this.delta-=this.lastValue,!this.active&&this.start&&this.start(t)}},{key:"start",value:function(t){if(!!this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var n=bs.mousePos(this.el,t);this.around=Us.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(n)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(t){var n=MD;if(this.prevEase){var i=this.prevEase,a=(z0()-i.start)/i.duration,o=i.easing(a+.01)-i.easing(a),s=.27/Math.sqrt(o*o+1e-4)*.01,u=Math.sqrt(.27*.27-s*s);n=o6(s,u,.25,1)}return this.prevEase={start:z0(),duration:t,easing:n},n}}]),e}(),pHe=function(){function e(r,t){st(this,e),this.clickZoom=r,this.tapZoom=t}return ot(e,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),e}(),dHe=function(){function e(r,t,n){st(this,e),this.el=r,this.mousePan=t,this.touchPan=n}return ot(e,[{key:"enable",value:function(t){this.inertiaOptions=t||{},this.mousePan.enable(),this.touchPan.enable(),ns||this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),ns||this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),e}(),vHe=function(){function e(r,t,n){st(this,e),this.pitchWithRotate=r.pitchWithRotate,this.mouseRotate=t,this.mousePitch=n}return ot(e,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),e}(),gHe=function(){function e(r,t,n,i){st(this,e),this.el=r,this.touchZoom=t,this.touchRotate=n,this.tapDragZoom=i,this.rotationDisabled=!1,this.enabled=!0}return ot(e,[{key:"enable",value:function(t){this.touchZoom.enable(t),this.rotationDisabled||this.touchRotate.enable(t),this.tapDragZoom.enable(),ns||this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),ns||this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),e}();function PD(e,r){for(var t={},n=0;n<e.length;n++)t[e[n].identifier]=r[n];return t}function mHe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=yHe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function yHe(e,r){if(!!e){if(typeof e=="string")return wH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return wH(e,r)}}function wH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _He(e){var r=new Wa(0,0),t=mHe(e),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;r._add(i)}}catch(a){t.e(a)}finally{t.f()}return r.div(e.length)}var die=500,xHe=500,vie=30,bHe=function(){function e(r){st(this,e),this.reset(),this.numTouches=r.numTouches}return ot(e,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(t,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=_He(n),this.touches=PD(i,n)))}},{key:"touchmove",value:function(t,n,i){if(!(this.aborted||!this.centroid)){var a=PD(i,n);for(var o in this.touches)if(this.touches[o]){var s=this.touches[o],u=a[o];(!u||u.dist(s)>vie)&&(this.aborted=!0)}}}},{key:"touchend",value:function(t,n,i){if((!this.centroid||t.timeStamp-this.startTime>xHe)&&(this.aborted=!0),i.length===0){var a=!this.aborted&&this.centroid;if(this.reset(),a)return a}}}]),e}(),RD=function(){function e(r){st(this,e),this.singleTap=new bHe(r),this.numTaps=r.numTaps,this.reset()}return ot(e,[{key:"reset",value:function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(t,n,i){this.singleTap.touchstart(t,n,i)}},{key:"touchmove",value:function(t,n,i){this.singleTap.touchmove(t,n,i)}},{key:"touchend",value:function(t,n,i){var a=this.singleTap.touchend(t,n,i);if(a){var o=t.timeStamp-this.lastTime<die,s=!this.lastTap||this.lastTap.dist(a)<vie;if((!o||!s)&&this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=a,this.count===this.numTaps)return this.reset(),a}}}]),e}(),wHe=function(){function e(){st(this,e),this.tap=new RD({numTouches:1,numTaps:1}),this.reset()}return ot(e,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(t,n,i){this.swipePoint||(this.tapTime&&t.timeStamp-this.tapTime>die&&this.reset(),this.tapTime?i.length>0&&(this.swipePoint=n[0],this.swipeTouch=i[0].identifier):this.tap.touchstart(t,n,i))}},{key:"touchmove",value:function(t,n,i){if(!this.tapTime)this.tap.touchmove(t,n,i);else if(this.swipePoint){if(i[0].identifier!==this.swipeTouch)return;var a=n[0],o=a.y-this.swipePoint.y;return this.swipePoint=a,t.preventDefault(),this.active=!0,{zoomDelta:o/128}}}},{key:"touchend",value:function(t,n,i){if(this.tapTime)this.swipePoint&&i.length===0&&this.reset();else{var a=this.tap.touchend(t,n,i);a&&(this.tapTime=t.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),CHe=function(){function e(){st(this,e),this.zoomIn=new RD({numTouches:1,numTaps:2}),this.zoomOut=new RD({numTouches:2,numTaps:1}),this.reset()}return ot(e,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(t,n,i){this.zoomIn.touchstart(t,n,i),this.zoomOut.touchstart(t,n,i)}},{key:"touchmove",value:function(t,n,i){this.zoomIn.touchmove(t,n,i),this.zoomOut.touchmove(t,n,i)}},{key:"touchend",value:function(t,n,i){var a=this,o=this.zoomIn.touchend(t,n,i),s=this.zoomOut.touchend(t,n,i);if(o)return this.active=!0,t.preventDefault(),setTimeout(function(){return a.reset()},0),{cameraAnimation:function(l){return l.easeTo({duration:300,zoom:l.getZoom()+1,around:l.unproject(o)},{originalEvent:t})}};if(s)return this.active=!0,t.preventDefault(),setTimeout(function(){return a.reset()},0),{cameraAnimation:function(l){return l.easeTo({duration:300,zoom:l.getZoom()-1,around:l.unproject(s)},{originalEvent:t})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),EHe=function(){function e(r){st(this,e),this.minTouches=1,this.clickTolerance=r.clickTolerance||1,this.reset()}return ot(e,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Wa(0,0)}},{key:"touchstart",value:function(t,n,i){return this.calculateTransform(t,n,i)}},{key:"touchmove",value:function(t,n,i){if(!!this.active)return t.preventDefault(),this.calculateTransform(t,n,i)}},{key:"touchend",value:function(t,n,i){this.calculateTransform(t,n,i),this.active&&i.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(t,n,i){i.length>0&&(this.active=!0);var a=PD(i,n),o=new Wa(0,0),s=new Wa(0,0),u=0;for(var l in a)if(a[l]){var f=a[l],h=this.touches[l];h&&(o._add(f),s._add(f.sub(h)),u++,a[l]=f)}if(this.touches=a,!(u<this.minTouches||!s.mag())){var p=s.div(u);if(this.sum._add(p),!(this.sum.mag()<this.clickTolerance)){var v=o.div(u);return{around:v,panDelta:p}}}}}]),e}(),c6=function(){function e(){st(this,e),this.reset()}return ot(e,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(t){}},{key:"move",value:function(t,n,i){}},{key:"touchstart",value:function(t,n,i){this.firstTwoTouches||i.length<2||(this.firstTwoTouches=[i[0].identifier,i[1].identifier],this.start([n[0],n[1]]))}},{key:"touchmove",value:function(t,n,i){if(!!this.firstTwoTouches){t.preventDefault();var a=tn(this.firstTwoTouches,2),o=a[0],s=a[1],u=TT(i,n,o),l=TT(i,n,s);if(!(!u||!l)){var f=this.aroundCenter?null:u.add(l).div(2);return this.move([u,l],f,t)}}}},{key:"touchend",value:function(t,n,i){if(!!this.firstTwoTouches){var a=tn(this.firstTwoTouches,2),o=a[0],s=a[1],u=TT(i,n,o),l=TT(i,n,s);u&&l||(this.active&&bs.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(t){this.enabled=!0,this.aroundCenter=!!t&&t.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function TT(e,r,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return r[n]}function SHe(e){var r=AHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function AHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function AO(e){return Math.abs(e.y)>Math.abs(e.x)}var THe=100,MHe=function(e){er(t,e);var r=SHe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"reset",value:function(){Yv(ze(t.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(i){this.lastPoints=i,AO(i[0].sub(i[1]))&&(this.valid=!1)}},{key:"move",value:function(i,a,o){var s=i[0].sub(this.lastPoints[0]),u=i[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(s,u,o.timeStamp),!!this.valid){this.lastPoints=i,this.active=!0;var l=(s.y+u.y)/2,f=-.5;return{pitchDelta:l*f}}}},{key:"gestureBeginsVertically",value:function(i,a,o){if(this.valid!==void 0)return this.valid;var s=2,u=i.mag()>=s,l=a.mag()>=s;if(!(!u&&!l)){if(!u||!l)return this.firstMove===void 0&&(this.firstMove=o),o-this.firstMove<THe?void 0:!1;var f=i.y>0==a.y>0;return AO(i)&&AO(a)&&f}}}]),t}(c6);function LHe(e){var r=IHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function IHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var kHe=25;function CH(e,r){return e.angleWith(r)*180/Math.PI}var PHe=function(e){er(t,e);var r=LHe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"reset",value:function(){Yv(ze(t.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(i){this.startVector=this.vector=i[0].sub(i[1]),this.minDiameter=i[0].dist(i[1])}},{key:"move",value:function(i,a){var o=this.vector;if(this.vector=i[0].sub(i[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:CH(this.vector,o),pinchAround:a}}},{key:"isBelowThreshold",value:function(i){this.minDiameter=Math.min(this.minDiameter,i.mag());var a=Math.PI*this.minDiameter,o=kHe/a*360,s=CH(i,this.startVector);return Math.abs(s)<o}}]),t}(c6);function RHe(e){var r=OHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function OHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var FHe=.1;function EH(e,r){return Math.log(e/r)/Math.LN2}var DHe=function(e){er(t,e);var r=RHe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"reset",value:function(){Yv(ze(t.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(i){this.startDistance=this.distance=i[0].dist(i[1])}},{key:"move",value:function(i,a){var o=this.distance;if(this.distance=i[0].dist(i[1]),!(!this.active&&Math.abs(EH(this.distance,this.startDistance))<FHe))return this.active=!0,{zoomDelta:EH(this.distance,o),pinchAround:a}}}]),t}(c6);function cx(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=BHe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function BHe(e,r){if(!!e){if(typeof e=="string")return SH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return SH(e,r)}}function SH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var MT=function(r){return r.zoom||r.drag||r.pitch||r.rotate};function TO(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var gie=function(){function e(r,t){var n=this;st(this,e),X(this,"handleWindowEvent",function(h){n.handleEvent(h,"".concat(h.type,"Window"))}),X(this,"handleEvent",function(h,p){if(h.type==="blur"){n.stop();return}n.updatingCamera=!0;var v=h.type==="renderFrame"?void 0:h,m={needsRenderFrame:!1},x={},E={},A=h.touches?n.getMapTouches(h.touches):void 0,L=A?bs.touchPos(n.el,A):bs.mousePos(n.el,h),k=cx(n.handlers),R;try{for(k.s();!(R=k.n()).done;){var D=R.value,$=D.handlerName,j=D.handler,H=D.allowed;if(!!j.isEnabled()){var ee=void 0;if(n.blockedByActive(E,H,$))j.reset();else{var U=p||h.type;j&&j[U]&&(ee=j[U](h,L,A),n.mergeIHandlerResult(m,x,ee,$,v),ee&&ee.needsRenderFrame&&n.triggerRenderFrame())}(ee||j.isActive())&&(E[$]=j)}}}catch(ie){k.e(ie)}finally{k.f()}var W={};for(var Q in n.previousActiveHandlers)E[Q]||(W[Q]=v);n.previousActiveHandlers=E,(Object.keys(W).length||TO(m))&&(n.changes.push([m,x,W]),n.triggerRenderFrame()),(Object.keys(E).length||TO(m))&&n.map.stop(!0),n.updatingCamera=!1;var te=m.cameraAnimation;te&&(n.inertia.clear(),n.fireEvents({},{}),n.changes=[],te(n.map))}),this.map=r,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new XGe(r),this.bearingSnap=t.bearingSnap,this.rotateEnabled=t.rotateEnabled,this.pitchEnabled=t.pitchEnabled,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(t);var i=this.el;if(this.listeners=[],ns)Hn.document.addEventListener("touchstart",function(h){n.handleEvent(h)},{}),Hn.document.addEventListener("touchmove",function(h){n.handleEvent(h)},{}),Hn.document.addEventListener("touchend",function(h){n.handleEvent(h)},{}),Hn.document.addEventListener("touchcancel",function(h){n.handleEvent(h)},{});else{this.listeners=[[i,"touchstart",{passive:!1}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];var a=cx(this.listeners),o;try{for(a.s();!(o=a.n()).done;){var s=tn(o.value,3),u=s[0],l=s[1],f=s[2];bs.addEventListener(u,l,u===window.document?this.handleWindowEvent:this.handleEvent,f)}}catch(h){a.e(h)}finally{a.f()}}}return ot(e,[{key:"destroy",value:function(){var t=cx(this.listeners),n;try{for(t.s();!(n=t.n()).done;){var i=tn(n.value,3),a=i[0],o=i[1],s=i[2];bs.removeEventListener(a,o,a===window.document?this.handleWindowEvent:this.handleEvent,s)}}catch(u){t.e(u)}finally{t.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var t=cx(this.handlers),n;try{for(t.s();!(n=t.n()).done;){var i=n.value.handler;i.reset()}}catch(a){t.e(a)}finally{t.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var t=cx(this.handlers),n;try{for(t.s();!(n=t.n()).done;){var i=n.value.handler;if(i.isActive())return!0}}catch(a){t.e(a)}finally{t.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(MT(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(t,n,i,a,o){if(!!i){Kt.exports.merge(t,i);var s={handlerName:a,originalEvent:i.originalEvent||o};i.zoomDelta!==void 0&&(n.zoom=s),i.panDelta!==void 0&&(n.drag=s),i.pitchDelta!==void 0&&(n.pitch=s),i.bearingDelta!==void 0&&(n.rotate=s)}}},{key:"triggerRenderFrame",value:function(){var t=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(n){delete t.frameId,t.handleEvent(new $Ge("renderFrame",{timeStamp:n})),t.applyChanges()}))}},{key:"addDefaultHandlers",value:function(t){var n=this.map,i=n.getCanvasContainer();this.add("mapEvent",new KGe(n,t));var a=n.boxZoom=new DGe(n,t);this.add("boxZoom",a);var o=new CHe,s=new BGe;n.doubleClickZoom=new pHe(s,o),this.add("tapZoom",o),this.add("clickZoom",s);var u=new wHe;this.add("tapDragZoom",u);var l=n.touchPitch=new MHe;this.add("touchPitch",l);var f=new aHe(t),h=new uHe(t);n.dragRotate=new vHe(t,f,h),this.add("mouseRotate",f,["mousePitch"]),this.add("mousePitch",h,["mouseRotate"]);var p=new rHe(t),v=new EHe(t);n.dragPan=new dHe(i,p,v),this.add("mousePan",p),this.add("touchPan",v,["touchZoom","touchRotate"]);var m=new PHe,x=new DHe;n.touchZoomRotate=new gHe(i,x,m,u),this.add("touchRotate",m,["touchPan","touchZoom"]),this.add("touchZoom",x,["touchPan","touchRotate"]);var E=n.scrollZoom=new hHe(n,this);this.add("scrollZoom",E,["mousePan"]);var A=n.keyboard=new ZGe;this.add("keyboard",A),this.add("blockableMapEvent",new FGe(n));for(var L=0,k=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];L<k.length;L++){var R=k[L];t.interactive&&t[R]&&n[R].enable(t[R])}}},{key:"add",value:function(t,n,i){this.handlers.push({handlerName:t,handler:n,allowed:i}),this.handlersById[t]=n}},{key:"blockedByActive",value:function(t,n,i){for(var a in t)if(a!==i&&(!n||n.indexOf(a)<0))return!0;return!1}},{key:"getMapTouches",value:function(t){var n=[],i=cx(t),a;try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.target;(ns||this.el.contains(s))&&n.push(o)}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"applyChanges",value:function(){var t={},n={},i={},a=cx(this.changes),o;try{for(a.s();!(o=a.n()).done;){var s=tn(o.value,3),u=s[0],l=s[1],f=s[2];u.panDelta&&(t.panDelta=(t.panDelta||new Wa(0,0))._add(u.panDelta)),u.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+u.pitchDelta),u.around!==void 0&&(t.around=u.around),u.pinchAround!==void 0&&(t.pinchAround=u.pinchAround),u.noInertia&&(t.noInertia=u.noInertia),Kt.exports.merge(n,l),Kt.exports.merge(i,f)}}catch(h){a.e(h)}finally{a.f()}this.updateMapTransform(t,n,i),this.changes=[]}},{key:"updateMapTransform",value:function(t,n,i){var a=this.map,o=a.transform;if(!TO(t))return this.fireEvents(n,i);var s=t.panDelta,u=t.zoomDelta,l=t.bearingDelta,f=t.pitchDelta,h=t.pinchAround,p=t.around;h!==void 0&&(p=h),a.stop(!0),p=p||a.transform.centerPoint;var v=o.pointLocation(s?p.sub(s):p);l&&this.rotateEnabled&&(o.bearing+=l),f&&this.pitchEnabled&&(o.pitch+=f),u&&(o.zoom+=u),o.setLocationAtPoint(v,p),this.map.update(),t.noInertia||this.inertia.record(t),this.fireEvents(n,i)}},{key:"fireEvents",value:function(t,n){var i=this,a=MT(this.eventsInProgress),o=MT(t),s={};for(var u in t)if(t[u]){var l=t[u].originalEvent;this.eventsInProgress[u]||(s["".concat(u,"start")]=l),this.eventsInProgress[u]=t[u]}!a&&o&&this.fireEvent("movestart",o.originalEvent);for(var f in s)s[f]&&this.fireEvent(f,s[f]);t.rotate&&(this.bearingChanged=!0),o&&this.fireEvent("move",o.originalEvent);for(var h in t)if(t[h]){var p=t[h].originalEvent;this.fireEvent(h,p)}var v={},m;for(var x in this.eventsInProgress)if(this.eventsInProgress[x]){var E=this.eventsInProgress[x],A=E.handlerName,L=E.originalEvent;this.handlersById[A].isActive()||(delete this.eventsInProgress[x],m=n[A]||L,v["".concat(x,"end")]=m)}for(var k in v)v[k]&&this.fireEvent(k,v[k]);var R=MT(this.eventsInProgress);if((a||o)&&!R){this.updatingCamera=!0;var D=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),$=function(H){return H!==0&&-i.bearingSnap<H&&H<i.bearingSnap};D?($(D.bearing||this.map.getBearing())&&(D.bearing=0),this.map.easeTo(D,{originalEvent:m})):(this.map.emit("moveend",new jo("moveend",{originalEvent:m})),$(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(t,n){this.map.emit(t,new jo(t,n?{originalEvent:n}:{}))}}]),e}(),NHe=function(){function e(r){var t=this;st(this,e),X(this,"onHashChange",function(){var n=t.getCurrentHash();if(n.length>=3&&!n.some(function(a){return isNaN(+a)})){var i=t.map.dragRotate.isEnabled()&&t.map.touchZoomRotate.isEnabled()?+(n[3]||0):t.map.getBearing();return t.map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:i,pitch:+(n[4]||0)}),!0}return!1}),X(this,"getCurrentHash",function(){var n=window.location.hash.replace("#","");if(t.hashName){var i;return n.split("&").map(function(a){return a.split("=")}).forEach(function(a){a[0]===t.hashName&&(i=a)}),(i&&i[1]||"").split("/")}return n.split("/")}),X(this,"updateHashUnthrottled",function(){var n=t.getHashString();try{window.history.replaceState(window.history.state,"",n)}catch{}}),this.hashName=r&&encodeURIComponent(r),this.updateHash=Kt.exports.throttle(this.updateHashUnthrottled,30*1e3/100)}return ot(e,[{key:"addTo",value:function(t){return this.map=t,Hn.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return Hn.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(t){var n=this.map.getCenter(),i=Math.round(this.map.getZoom()*100)/100,a=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,a),s=Math.round(n.lng*o)/o,u=Math.round(n.lat*o)/o,l=this.map.getBearing(),f=this.map.getPitch(),h="";if(t?h+="/".concat(s,"/").concat(u,"/").concat(i):h+="".concat(i,"/").concat(u,"/").concat(s),(l||f)&&(h+="/".concat(Math.round(l*10)/10)),f&&(h+="/".concat(Math.round(f))),this.hashName){var p=this.hashName,v=!1,m=window.location.hash.slice(1).split("&").map(function(x){var E=x.split("=")[0];return E===p?(v=!0,"".concat(E,"=").concat(h)):x}).filter(function(x){return x});return v||m.push("".concat(p,"=").concat(h)),"#".concat(m.join("&"))}return"#".concat(h)}}]),e}();Hn.performance;function AH(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=zHe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function zHe(e,r){if(!!e){if(typeof e=="string")return TH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return TH(e,r)}}function TH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var mie=function(){function e(){st(this,e),this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return ot(e,[{key:"add",value:function(t){var n=++this.id,i=this.queue;return i.push({callback:t,id:n,cancelled:!1}),n}},{key:"remove",value:function(t){var n=this.currentlyRunning,i=n?this.queue.concat(n):this.queue,a=AH(i),o;try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.id===t){s.cancelled=!0;return}}}catch(u){a.e(u)}finally{a.f()}}},{key:"run",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=this.currentlyRunning=this.queue;this.queue=[];var i=AH(n),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!o.cancelled&&(o.callback(t),this.cleared))break}}catch(s){i.e(s)}finally{i.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),e}();function $He(e){var r=UHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function UHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function VHe(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var a=r.body||r.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):r.documentElement.appendChild(i)}var o=r.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(r.createTextNode(e)),i.appendChild(o),o}}VHe(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var gM=-2,yie=22,Bb=0,mM=60,GHe={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:gM,maxZoom:yie,minPitch:Bb,maxPitch:mM,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0,pitchEnabled:!0,rotateEnabled:!0},MH=function(e){er(t,e);var r=$He(t);function t(n){var i;if(st(this,t),i=r.call(this,Kt.exports.merge({},GHe,n)),X(He(i),"renderTaskQueue",new mie),X(He(i),"trackResize",!0),X(He(i),"onWindowOnline",function(){i.update()}),X(He(i),"onWindowResize",function(o){i.trackResize&&i.resize({originalEvent:o}).update()}),ns?i.initMiniContainer():i.initContainer(),i.resize(),i.handlers=new gie(He(i),i.options),typeof window!="undefined"&&(window.addEventListener("online",i.onWindowOnline,!1),window.addEventListener("resize",i.onWindowResize,!1),window.addEventListener("orientationchange",i.onWindowResize,!1)),!ns){var a=typeof n.hash=="string"&&n.hash||void 0;n.hash&&(i.hash=new NHe(a).addTo(He(i)))}return(!i.hash||!i.hash.onHashChange())&&(i.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(i.resize(),i.fitBounds(n.bounds,Kt.exports.merge({},n.fitBoundsOptions,{duration:0})))),i}return ot(t,[{key:"resize",value:function(i){var a=this.containerDimensions(),o=tn(a,2),s=o[0],u=o[1];if(this.transform.resize(s,u),ns)return this;var l=!this.moving;return l&&(this.stop(),this.emit("movestart",new Hn.Event("movestart",i)),this.emit("move",new Hn.Event("move",i))),this.emit("resize",new Hn.Event("resize",i)),l&&this.emit("moveend",new Hn.Event("moveend",i)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(i){return this.transform.locationPoint(Us.convert(i))}},{key:"unproject",value:function(i){return this.transform.pointLocation(Wa.convert(i))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(i){this.transform.setMaxBounds(WE.convert(i))}},{key:"setStyle",value:function(i){}},{key:"setMinZoom",value:function(i){if(i=i==null?gM:i,i>=gM&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this.getZoom()<i&&this.setZoom(i),this;throw new Error("minZoom must be between ".concat(gM," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(i){if(i=i==null?yie:i,i>=this.transform.minZoom)return this.transform.maxZoom=i,this.getZoom()>i&&this.setZoom(i),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(i){if(i=i==null?Bb:i,i<Bb)throw new Error("minPitch must be greater than or equal to ".concat(Bb));if(i>=Bb&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this.getPitch()<i&&this.setPitch(i),this;throw new Error("minPitch must be between ".concat(Bb," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(i){if(i=i==null?mM:i,i>mM)throw new Error("maxPitch must be less than or equal to ".concat(mM));if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this.getPitch()>i&&this.setPitch(i),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(i){this.transform.renderWorldCopies=!!i}},{key:"remove",value:function(){this.container.removeChild(this.canvasContainer),this.canvasContainer=null,this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(i){return this.update(),this.renderTaskQueue.add(i)}},{key:"cancelRenderFrame",value:function(i){return this.renderTaskQueue.remove(i)}},{key:"triggerRepaint",value:function(){var i=this;this.frame||(this.frame=mL(function(a){i.frame=null,i.update(a)}))}},{key:"update",value:function(i){var a=this;this.frame||(this.frame=mL(function(o){a.frame=null,a.renderTaskQueue.run(i)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var i=this.container;i.classList.add("l7-map");var a=this.canvasContainer=xs("div","l7-canvas-container",i);this.options.interactive&&a.classList.add("l7-interactive")}},{key:"initMiniContainer",value:function(){this.container=this.options.canvas,this.canvasContainer=this.container}},{key:"containerDimensions",value:function(){var i=0,a=0;return this.container&&(ns?(i=this.container.width/Hn.devicePixelRatio,a=this.container.height/Hn.devicePixelRatio):(i=this.container.clientWidth,a=this.container.clientHeight,i=i==0?400:i,a=a===0?300:a)),[i,a]}}]),t}(fie);function HHe(e){var r=jHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function jHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function WHe(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var a=r.body||r.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):r.documentElement.appendChild(i)}var o=r.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(r.createTextNode(e)),i.appendChild(o),o}}WHe(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var yM=-2,_ie=22,Nb=0,_M=60,XHe={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:yM,maxZoom:_ie,minPitch:Nb,maxPitch:_M,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0,pitchEnabled:!0,rotateEnabled:!0},YHe=function(e){er(t,e);var r=HHe(t);function t(n){var i;return st(this,t),i=r.call(this,Kt.exports.merge({},XHe,n)),X(He(i),"renderTaskQueue",new mie),X(He(i),"trackResize",!0),X(He(i),"onWindowOnline",function(){i.update()}),X(He(i),"onWindowResize",function(a){i.trackResize&&i.resize({originalEvent:a}).update()}),i.initContainer(),i.resize(),i.handlers=new gie(He(i),i.options),typeof window!="undefined"&&(window.addEventListener("online",i.onWindowOnline,!1),window.addEventListener("resize",i.onWindowResize,!1),window.addEventListener("orientationchange",i.onWindowResize,!1)),i}return ot(t,[{key:"resize",value:function(i){var a=this.containerDimensions(),o=a[0],s=a[1];this.transform.resize(o,s);var u=!this.moving;return u&&(this.stop(),this.emit("movestart",new Event("movestart",i)),this.emit("move",new Event("move",i))),this.emit("resize",new Event("resize",i)),u&&this.emit("moveend",new Event("moveend",i)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(i){return this.transform.locationPoint(Us.convert(i))}},{key:"unproject",value:function(i){return this.transform.pointLocation(Wa.convert(i))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(i){this.transform.setMaxBounds(WE.convert(i))}},{key:"setStyle",value:function(i){}},{key:"setMinZoom",value:function(i){if(i=i==null?yM:i,i>=yM&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this.getZoom()<i&&this.setZoom(i),this;throw new Error("minZoom must be between ".concat(yM," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(i){if(i=i==null?_ie:i,i>=this.transform.minZoom)return this.transform.maxZoom=i,this.getZoom()>i&&this.setZoom(i),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(i){if(i=i==null?Nb:i,i<Nb)throw new Error("minPitch must be greater than or equal to ".concat(Nb));if(i>=Nb&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this.getPitch()<i&&this.setPitch(i),this;throw new Error("minPitch must be between ".concat(Nb," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(i){if(i=i==null?_M:i,i>_M)throw new Error("maxPitch must be less than or equal to ".concat(_M));if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this.getPitch()>i&&this.setPitch(i),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(i){this.transform.renderWorldCopies=!!i}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(i){return this.update(),this.renderTaskQueue.add(i)}},{key:"cancelRenderFrame",value:function(i){return this.renderTaskQueue.remove(i)}},{key:"triggerRepaint",value:function(){var i=this;this.frame||(this.frame=mL(function(a){i.frame=null,i.update(a)}))}},{key:"update",value:function(i){var a=this;this.frame||(this.frame=mL(function(o){a.frame=null,a.renderTaskQueue.run(i)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var i=this.container;i.classList.add("l7-map");var a=this.canvasContainer=xs("div","l7-canvas-container",i);this.options.interactive&&a.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var i=0,a=0;return this.container&&(i=this.container.clientWidth||400,a=this.container.clientHeight||300),[i,a]}},{key:"resizeCanvas",value:function(i,a){var o=pu||1;this.canvas.width=o*i,this.canvas.height=o*a,this.canvas.style.width="".concat(i,"px"),this.canvas.style.height="".concat(a,"px")}}]),t}(fie),ZHe=function(){function e(){st(this,e),X(this,"xzReg",-Math.PI*.6),X(this,"yReg",Math.PI*.2),X(this,"earthCameraRadius",200),X(this,"earthCameraZoom",1),X(this,"cameraPosition",O0()),X(this,"projectionMatrix",ts()),X(this,"modelMatrix",ts()),X(this,"viewMatrix",ts()),X(this,"viewProjectionMatrix",ts()),X(this,"ViewProjectionMatrixUncentered",ts()),X(this,"viewUncenteredMatrix",ts())}return ot(e,[{key:"syncWithMapCamera",value:function(t){var n=t.viewportHeight,i=n===void 0?1:n,a=t.viewportWidth,o=a===void 0?1:a,s=o/i,u=.1,l=1e4,f=20;N2(this.projectionMatrix,f,s,u,l);var h=this.earthCameraRadius*Math.cos(this.xzReg),p=this.earthCameraRadius*Math.sin(this.xzReg),v=this.earthCameraRadius*Math.sin(this.yReg);this.cameraPosition=Io(h,v,p),F0(this.cameraPosition,this.cameraPosition),F3(this.cameraPosition,this.cameraPosition,Io(this.earthCameraRadius,this.earthCameraRadius,this.earthCameraRadius)),D3(this.cameraPosition,this.cameraPosition,this.earthCameraZoom);var m=O0();kM(m,this.cameraPosition,Io(0,1,0));var x=Io(0,1,0);kM(x,m,this.cameraPosition);var E=Io(0,0,0);uI(this.viewMatrix,this.cameraPosition,E,x),this.viewUncenteredMatrix=sI(this.viewMatrix),ff(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ff(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"rotateY",value:function(t){this.xzReg+=t*Math.min(this.earthCameraZoom*this.earthCameraZoom,1)}},{key:"rotateX",value:function(t){this.yReg+=t*Math.min(this.earthCameraZoom*this.earthCameraZoom,1)}},{key:"scaleZoom",value:function(t){this.earthCameraZoom+=t,this.earthCameraZoom=Math.max(this.earthCameraZoom,.6)}},{key:"getZoom",value:function(){return 4}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[0,0]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return this.modelMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),LH={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},IH,kH,PH,RH,OH,FH,Eb,DH,BH,NH,zH,$H={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},qHe=12,Tk=(IH=Ri(),kH=ba(Mt.MapConfig),PH=ba(Mt.IGlobalConfigService),RH=ba(Mt.ICoordinateSystemService),OH=ba(Mt.IEventEmitter),IH(FH=(Eb=function(){function e(){var r=this;st(this,e),X(this,"version",ko.L7MAP),X(this,"simpleMapCoord",new Yne),X(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),ua(this,"config",DH,this),ua(this,"configService",BH,this),ua(this,"coordinateSystemService",NH,this),ua(this,"eventEmitter",zH,this),X(this,"handleCameraChanged",function(t){var n=r.map.getCenter(),i=n.lat,a=n.lng;r.emit("mapchange"),r.viewport.syncWithMapCamera({bearing:r.map.getBearing(),center:[a,i],viewportHeight:r.map.transform.height,pitch:r.map.getPitch(),viewportWidth:r.map.transform.width,zoom:r.map.getZoom(),cameraHeight:0}),r.updateCoordinateSystemService(),r.cameraChangedCallback(r.viewport)})}return ot(e,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getCanvasContainer();this.markerContainer=xs("div","l7-marker-container",t),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"getOverlayContainer",value:function(){}},{key:"on",value:function(t,n){GE.indexOf(t)!==-1?this.eventEmitter.on(t,n):this.map.on($H[t]||t,n)}},{key:"off",value:function(t,n){this.map.off($H[t]||t,n),this.eventEmitter.off(t,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version===ko.SIMPLE)return this.simpleMapCoord.getSize();var t=this.map.transform;return[t.width,t.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(t){return this.map.setZoom(t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(t){this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(t){this.map.setBearing(t)}},{key:"zoomIn",value:function(t,n){this.map.zoomIn(t,n)}},{key:"zoomOut",value:function(t,n){this.map.zoomOut(t,n)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([t,n])}},{key:"fitBounds",value:function(t,n){this.map.fitBounds(t,n)}},{key:"setMaxZoom",value:function(t){this.map.setMaxZoom(t)}},{key:"setMinZoom",value:function(t){this.map.setMinZoom(t)}},{key:"setMapStatus",value:function(t){t.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),t.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),t.dragEnable===!1&&this.map.dragPan.disable(),t.dragEnable===!0&&this.map.dragPan.enable(),t.rotateEnable===!1&&this.map.dragRotate.disable(),t.dragEnable===!0&&this.map.dragRotate.enable(),t.keyboardEnable===!1&&this.map.keyboard.disable(),t.keyboardEnable===!0&&this.map.keyboard.enable(),t.zoomEnable===!1&&this.map.scrollZoom.disable(),t.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(t,n){this.map.flyTo({zoom:t,center:n})}},{key:"setMapStyle",value:function(t){this.map.setStyle(this.getMapStyle(t))}},{key:"meterToCoord",value:function(t,n){return 1}},{key:"pixelToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToPixel",value:function(t){return this.map.project(t)}},{key:"containerToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToContainer",value:function(t){return this.map.project(t)}},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];(n=this.eventEmitter).emit.apply(n,[t].concat(a))}},{key:"once",value:function(t){for(var n,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];(n=this.eventEmitter).once.apply(n,[t].concat(a))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(t){var n=this.map.getCanvas(),i=t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png");return i}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"creatMapContainer",value:function(t){var n=t;return typeof t=="string"&&(n=document.getElementById(t)),n}},{key:"updateView",value:function(t){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:t.bearing,center:t.center,viewportHeight:t.viewportHeight,pitch:t.pitch,viewportWidth:t.viewportWidth,zoom:t.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}},{key:"updateCoordinateSystemService",value:function(){var t=this.config.offsetCoordinate,n=t===void 0?!0:t;this.viewport.getZoom()>qHe&&n?this.coordinateSystemService.setCoordinateSystem(sc.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(sc.LNGLAT)}},{key:"getMapStyle",value:function(t){return typeof t!="string"?t:LH[t]?LH[t]:t}}]),e}(),DH=ia(Eb.prototype,"config",[kH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BH=ia(Eb.prototype,"configService",[PH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NH=ia(Eb.prototype,"coordinateSystemService",[RH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zH=ia(Eb.prototype,"eventEmitter",[OH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eb))||FH),KHe=["id","style","rotation"],UH,VH;function QHe(e){var r=JHe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function JHe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var GH={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},eje=12,tje=(UH=Ri(),UH(VH=function(e){er(t,e);var r=QHe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"version",ko.GLOBEL),X(He(n),"dragging",!1),X(He(n),"handleCameraChanged",function(s){n.emit("mapchange");var u=2e3;n.handleCameraChanging=!0,n.handleCameraTimer&&clearTimeout(n.handleCameraTimer),n.handleCameraTimer=setTimeout(function(){n.handleCameraChanging=!1},u);var l=.02;s.type&&s.originalEvent&&(s.originalEvent.type==="wheel"&&n.viewport.scaleZoom(.01*Math.sign(s.originalEvent.wheelDelta)*-1),Math.abs(s.originalEvent.movementX)>Math.abs(s.originalEvent.movementY)?s.originalEvent.movementX>0?n.viewport.rotateY(l):s.originalEvent.movementX<0&&n.viewport.rotateY(-l):s.originalEvent.movementY>0?n.viewport.rotateX(l):s.originalEvent.movementY<0&&n.viewport.rotateX(-l));var f=n.config.offsetCoordinate,h=f===void 0?!0:f;n.viewport.syncWithMapCamera({viewportHeight:n.map.transform.height,viewportWidth:n.map.transform.width}),n.viewport.getZoom()>eje&&h?n.coordinateSystemService.setCoordinateSystem(sc.LNGLAT_OFFSET):n.coordinateSystemService.setCoordinateSystem(sc.LNGLAT),n.cameraChangedCallback(n.viewport)}),n}return ot(t,[{key:"lngLatToMercator",value:function(i,a){throw new Error("Method not implemented.")}},{key:"getModelMatrix",value:function(i,a,o,s,u){throw new Error("Method not implemented.")}},{key:"on",value:function(i,a){GE.indexOf(i)!==-1?this.eventEmitter.on(i,a):this.map.on(GH[i]||i,a)}},{key:"off",value:function(i,a){this.map.off(GH[i]||i,a),this.eventEmitter.off(i,a)}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var i=this.map.transform;return[i.width,i.height]}},{key:"getType",value:function(){return"earth"}},{key:"init",value:function(){var n=Hi(Xr.mark(function a(){var o,s,u,l,f,h,p,v;return Xr.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:o=this.config,s=o.id,u=s===void 0?"map":s,l=o.style,f=l===void 0?"light":l,h=o.rotation,p=h===void 0?0:h,v=oc(o,KHe),this.viewport=new ZHe,this.$mapContainer=this.creatMapContainer(u),this.map=new YHe(Et({container:this.$mapContainer,style:this.getMapStyle(f),bearing:p},v)),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged({});case 7:case"end":return x.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"destroy",value:function(){var i,a;(i=this.$mapContainer)===null||i===void 0||(a=i.parentNode)===null||a===void 0||a.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];(a=this.eventEmitter).emit.apply(a,[i].concat(s))}},{key:"once",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];(a=this.eventEmitter).once.apply(a,[i].concat(s))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}},{key:"rotateY",value:function(i){var a=i||{},o=a.force,s=o===void 0?!1:o,u=a.reg,l=u===void 0?.01:u;this.handleCameraChanging&&!s||this.viewport&&(this.viewport.rotateY(l),this.viewport.syncWithMapCamera({viewportHeight:this.map.transform.height,viewportWidth:this.map.transform.width}),this.cameraChangedCallback(this.viewport))}}]),t}(Tk))||VH);function rje(e){var r=nje();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function nje(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ije=function(e){er(t,e);var r=rje(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getServiceConstructor",value:function(){return tje}}]),t}(K2),aje=["id","style","rotation","mapInstance","version","mapSize","interactive"],oje=["id","style","rotation","mapInstance","canvas","hasBaseMap"],HH,jH;function sje(e){var r=uje();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function uje(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var lje=12,cje=(HH=Ri(),HH(jH=function(e){er(t,e);var r=sje(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"version",ko.L7MAP),X(He(n),"handleMiniCameraChanged",function(s,u,l,f,h){var p=n.config.offsetCoordinate,v=p===void 0?!0:p;n.viewport.syncWithMapCamera({bearing:f,center:[s,u],viewportHeight:n.map.transform.height,pitch:h,viewportWidth:n.map.transform.width,zoom:l,cameraHeight:0}),n.viewport.getZoom()>lje&&v?n.coordinateSystemService.setCoordinateSystem(sc.LNGLAT_OFFSET):n.coordinateSystemService.setCoordinateSystem(sc.LNGLAT),n.cameraChangedCallback(n.viewport)}),n}return ot(t,[{key:"lngLatToMercator",value:function(i,a){throw new Error("Method not implemented.")}},{key:"getModelMatrix",value:function(){throw new Error("Method not implemented.")}},{key:"init",value:function(){var n=Hi(Xr.mark(function a(){var o,s,u,l,f,h,p,v,m,x,E,A,L,k,R;return Xr.wrap(function($){for(;;)switch($.prev=$.next){case 0:o=this.config,s=o.id,u=s===void 0?"map":s,l=o.style,f=l===void 0?"light":l,h=o.rotation,p=h===void 0?0:h,v=o.mapInstance,m=o.version,x=m===void 0?"L7MAP":m,E=o.mapSize,A=E===void 0?1e4:E,L=o.interactive,k=L===void 0?!0:L,R=oc(o,aje),this.viewport=new gL,this.version=x,this.simpleMapCoord.setSize(A),x===ko.SIMPLE&&R.center&&(R.center=this.simpleMapCoord.unproject(R.center)),v?(this.map=v,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(u),this.map=new MH(Et({container:this.$mapContainer,style:this.getMapStyle(f),bearing:p},R))),this.map.on("load",this.handleCameraChanged),k&&this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return $.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"initMiniMap",value:function(){var n=Hi(Xr.mark(function a(){var o=this,s,u,l,f,h,p,v,m,x,E,A;return Xr.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:s=this.config,s.id,u=s.style,l=u===void 0?"light":u,f=s.rotation,h=f===void 0?0:f,s.mapInstance,p=s.canvas,v=p===void 0?null:p,m=s.hasBaseMap,x=m===void 0?!1:m,E=oc(s,oje),this.viewport=new gL,this.$mapContainer=v,this.map=new MH(Et({container:this.$mapContainer,style:this.getMapStyle(l),bearing:h,canvas:v},E)),x?(A=this.map.getCenter(),this.handleMiniCameraChanged(A.lng,A.lat,this.map.getZoom(),this.map.getBearing(),this.map.getPitch()),Hn.document.addEventListener("mapCameaParams",function(R){var D=R.e,$=D.longitude,j=D.latitude,H=D.scale,ee=D.bearing,U=D.pitch;o.handleMiniCameraChanged($,j,H-1.25,ee,U)})):(this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged());case 5:case"end":return k.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"exportMap",value:function(i){var a=this.map.getCanvas(),o=i==="jpg"?a==null?void 0:a.toDataURL("image/jpeg"):a==null?void 0:a.toDataURL("image/png");return o}}]),t}(Tk))||jH);function fje(e){var r=hje();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function hje(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pje=function(e){er(t,e);var r=fje(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getServiceConstructor",value:function(){return cje}}]),t}(K2),f6={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(jp,function(){var t,n,i;function a(o,s){if(!t)t=s;else if(!n)n=s;else{var u="var sharedChunk = {}; ("+t+")(sharedChunk); ("+n+")(sharedChunk);",l={};t(l),i=s(l),typeof window!="undefined"&&(i.workerUrl=window.URL.createObjectURL(new Blob([u],{type:"text/javascript"})))}}return a(["exports"],function(o){function s(c,d){return c(d={exports:{}},d.exports),d.exports}var u=l;function l(c,d,g,C){this.cx=3*c,this.bx=3*(g-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(C-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=C,this.p2x=g,this.p2y=C}l.prototype.sampleCurveX=function(c){return((this.ax*c+this.bx)*c+this.cx)*c},l.prototype.sampleCurveY=function(c){return((this.ay*c+this.by)*c+this.cy)*c},l.prototype.sampleCurveDerivativeX=function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},l.prototype.solveCurveX=function(c,d){var g,C,M,I,O;for(d===void 0&&(d=1e-6),M=c,O=0;O<8;O++){if(I=this.sampleCurveX(M)-c,Math.abs(I)<d)return M;var z=this.sampleCurveDerivativeX(M);if(Math.abs(z)<1e-6)break;M-=I/z}if((M=c)<(g=0))return g;if(M>(C=1))return C;for(;g<C;){if(I=this.sampleCurveX(M),Math.abs(I-c)<d)return M;c>I?g=M:C=M,M=.5*(C-g)+g}return M},l.prototype.solve=function(c,d){return this.sampleCurveY(this.solveCurveX(c,d))};var f=h;function h(c,d){this.x=c,this.y=d}h.prototype={clone:function(){return new h(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,d){return this.clone()._rotateAround(c,d)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var d=c.x-this.x,g=c.y-this.y;return d*d+g*g},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)},_matMult:function(c){var d=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=d,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var d=Math.cos(c),g=Math.sin(c),C=g*this.x+d*this.y;return this.x=d*this.x-g*this.y,this.y=C,this},_rotateAround:function(c,d){var g=Math.cos(c),C=Math.sin(c),M=d.y+C*(this.x-d.x)+g*(this.y-d.y);return this.x=d.x+g*(this.x-d.x)-C*(this.y-d.y),this.y=M,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},h.convert=function(c){return c instanceof h?c:Array.isArray(c)?new h(c[0],c[1]):c};var p=typeof self!="undefined"?self:{},v=Math.pow(2,53)-1;function m(c,d,g,C){var M=new u(c,d,g,C);return function(I){return M.solve(I)}}var x=m(.25,.1,.25,1);function E(c,d,g){return Math.min(g,Math.max(d,c))}function A(c,d,g){var C=g-d,M=((c-d)%C+C)%C+d;return M===d?g:M}function L(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var C=0,M=d;C<M.length;C+=1){var I=M[C];for(var O in I)c[O]=I[O]}return c}var k=1;function R(){return k++}function D(){return function c(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function $(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function j(c,d){c.forEach(function(g){d[g]&&(d[g]=d[g].bind(d))})}function H(c,d){return c.indexOf(d,c.length-d.length)!==-1}function ee(c,d,g){var C={};for(var M in c)C[M]=d.call(g||this,c[M],M,c);return C}function U(c,d,g){var C={};for(var M in c)d.call(g||this,c[M],M,c)&&(C[M]=c[M]);return C}function W(c){return Array.isArray(c)?c.map(W):typeof c=="object"&&c?ee(c,W):c}var Q={};function te(c){Q[c]||(typeof console!="undefined"&&console.warn(c),Q[c]=!0)}function ie(c,d,g){return(g.y-c.y)*(d.x-c.x)>(d.y-c.y)*(g.x-c.x)}function ve(c){for(var d=0,g=0,C=c.length,M=C-1,I=void 0,O=void 0;g<C;M=g++)d+=((O=c[M]).x-(I=c[g]).x)*(I.y+O.y);return d}function me(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Re(c){var d={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(C,M,I,O){var z=I||O;return d[M]=!z||z.toLowerCase(),""}),d["max-age"]){var g=parseInt(d["max-age"],10);isNaN(g)?delete d["max-age"]:d["max-age"]=g}return d}var We=null;function je(c){if(We==null){var d=c.navigator?c.navigator.userAgent:null;We=!!c.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return We}function lt(c){try{var d=p[c];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch{return!1}}var dt,ct,Tt,It,Lt=p.performance&&p.performance.now?p.performance.now.bind(p.performance):Date.now.bind(Date),rn=p.requestAnimationFrame||p.mozRequestAnimationFrame||p.webkitRequestAnimationFrame||p.msRequestAnimationFrame,wn=p.cancelAnimationFrame||p.mozCancelAnimationFrame||p.webkitCancelAnimationFrame||p.msCancelAnimationFrame,zn={now:Lt,frame:function(c){var d=rn(c);return{cancel:function(){return wn(d)}}},getImageData:function(c,d){d===void 0&&(d=0);var g=p.document.createElement("canvas"),C=g.getContext("2d");if(!C)throw new Error("failed to create canvas 2d context");return g.width=c.width,g.height=c.height,C.drawImage(c,0,0,c.width,c.height),C.getImageData(-d,-d,c.width+2*d,c.height+2*d)},resolveURL:function(c){return dt||(dt=p.document.createElement("a")),dt.href=c,dt.href},hardwareConcurrency:p.navigator&&p.navigator.hardwareConcurrency||4,get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(ct==null&&(ct=p.matchMedia("(prefers-reduced-motion: reduce)")),ct.matches)}},Zt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},nn={supported:!1,testSupport:function(c){!mn&&It&&(zt?Vr(c):Tt=c)}},mn=!1,zt=!1;function Vr(c){var d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,It),c.isContextLost())return;nn.supported=!0}catch{}c.deleteTexture(d),mn=!0}p.document&&((It=p.document.createElement("img")).onload=function(){Tt&&Vr(Tt),Tt=null,zt=!0},It.onerror=function(){mn=!0,Tt=null},It.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var On="01",Si=function(c,d){this._transformRequestFn=c,this._customAccessToken=d,this._createSkuToken()};function Fn(c){return c.indexOf("mapbox:")===0}Si.prototype._createSkuToken=function(){var c=function(){for(var d="",g=0;g<10;g++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",On,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt},Si.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Si.prototype.transformRequest=function(c,d){return this._transformRequestFn&&this._transformRequestFn(c,d)||{url:c}},Si.prototype.normalizeStyleURL=function(c,d){if(!Fn(c))return c;var g=Va(c);return g.path="/styles/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},Si.prototype.normalizeGlyphsURL=function(c,d){if(!Fn(c))return c;var g=Va(c);return g.path="/fonts/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},Si.prototype.normalizeSourceURL=function(c,d){if(!Fn(c))return c;var g=Va(c);return g.path="/v4/"+g.authority+".json",g.params.push("secure"),this._makeAPIURL(g,this._customAccessToken||d)},Si.prototype.normalizeSpriteURL=function(c,d,g,C){var M=Va(c);return Fn(c)?(M.path="/styles/v1"+M.path+"/sprite"+d+g,this._makeAPIURL(M,this._customAccessToken||C)):(M.path+=""+d+g,to(M))},Si.prototype.normalizeTileURL=function(c,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Fn(c))return c;var g=Va(c);g.path=g.path.replace(/(\.(png|jpg)\d*)(?=$)/,(zn.devicePixelRatio>=2||d===512?"@2x":"")+(nn.supported?".webp":"$1")),g.path=g.path.replace(/^.+\/v4\//,"/"),g.path="/v4"+g.path;var C=this._customAccessToken||function(M){for(var I=0,O=M;I<O.length;I+=1){var z=O[I].match(/^access_token=(.*)$/);if(z)return z[1]}return null}(g.params)||Zt.ACCESS_TOKEN;return Zt.REQUIRE_ACCESS_TOKEN&&C&&this._skuToken&&g.params.push("sku="+this._skuToken),this._makeAPIURL(g,C)},Si.prototype.canonicalizeTileURL=function(c,d){var g=Va(c);if(!g.path.match(/(^\/v4\/)/)||!g.path.match(/\.[\w]+$/))return c;var C="mapbox://tiles/";C+=g.path.replace("/v4/","");var M=g.params;return d&&(M=M.filter(function(I){return!I.match(/^access_token=/)})),M.length&&(C+="?"+M.join("&")),C},Si.prototype.canonicalizeTileset=function(c,d){for(var g=!!d&&Fn(d),C=[],M=0,I=c.tiles||[];M<I.length;M+=1){var O=I[M];Ua(O)?C.push(this.canonicalizeTileURL(O,g)):C.push(O)}return C},Si.prototype._makeAPIURL=function(c,d){var g="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",C=Va(Zt.API_URL);if(c.protocol=C.protocol,c.authority=C.authority,c.protocol==="http"){var M=c.params.indexOf("secure");M>=0&&c.params.splice(M,1)}if(C.path!=="/"&&(c.path=""+C.path+c.path),!Zt.REQUIRE_ACCESS_TOKEN)return to(c);if(!(d=d||Zt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+g);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+g);return c.params=c.params.filter(function(I){return I.indexOf("access_token")===-1}),c.params.push("access_token="+d),to(c)};var Ai=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ua(c){return Ai.test(c)}var va=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Va(c){var d=c.match(va);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function to(c){var d=c.params.length?"?"+c.params.join("&"):"";return c.protocol+"://"+c.authority+c.path+d}function Os(c){if(!c)return null;var d=c.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(d[1]).split("").map(function(g){return"%"+("00"+g.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Ro=function(c){this.type=c,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Ro.prototype.getStorageKey=function(c){var d,g=Os(Zt.ACCESS_TOKEN);return d=g&&g.u?p.btoa(encodeURIComponent(g.u).replace(/%([0-9A-F]{2})/g,function(C,M){return String.fromCharCode(Number("0x"+M))})):Zt.ACCESS_TOKEN||"",c?"mapbox.eventData."+c+":"+d:"mapbox.eventData:"+d},Ro.prototype.fetchEventData=function(){var c=lt("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{var C=p.localStorage.getItem(d);C&&(this.eventData=JSON.parse(C));var M=p.localStorage.getItem(g);M&&(this.anonId=M)}catch{te("Unable to read from LocalStorage")}},Ro.prototype.saveEventData=function(){var c=lt("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{p.localStorage.setItem(g,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(d,JSON.stringify(this.eventData))}catch{te("Unable to write to LocalStorage")}},Ro.prototype.processRequests=function(c){},Ro.prototype.postEvent=function(c,d,g,C){var M=this;if(Zt.EVENTS_URL){var I=Va(Zt.EVENTS_URL);I.params.push("access_token="+(C||Zt.ACCESS_TOKEN||""));var O={event:this.type,created:new Date(c).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:On,userId:this.anonId},z=d?L(O,d):O,G={url:to(I),headers:{"Content-Type":"text/plain"},body:JSON.stringify([z])};this.pendingRequest=fo(G,function(q){M.pendingRequest=null,g(q),M.saveEventData(),M.processRequests(C)})}},Ro.prototype.queueRequest=function(c,d){this.queue.push(c),this.processRequests(d)};var ne,Qt,gr=function(c){function d(){c.call(this,"map.load"),this.success={},this.skuToken=""}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(g,C,M,I){this.skuToken=M,(Zt.EVENTS_URL&&I||Zt.ACCESS_TOKEN&&Array.isArray(g)&&g.some(function(O){return Fn(O)||Ua(O)}))&&this.queueRequest({id:C,timestamp:Date.now()},I)},d.prototype.processRequests=function(g){var C=this;if(!this.pendingRequest&&this.queue.length!==0){var M=this.queue.shift(),I=M.id,O=M.timestamp;I&&this.success[I]||(this.anonId||this.fetchEventData(),$(this.anonId)||(this.anonId=D()),this.postEvent(O,{skuToken:this.skuToken},function(z){z||I&&(C.success[I]=!0)},g))}},d}(Ro),hn=new(function(c){function d(g){c.call(this,"appUserTurnstile"),this._customAccessToken=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(g,C){Zt.EVENTS_URL&&Zt.ACCESS_TOKEN&&Array.isArray(g)&&g.some(function(M){return Fn(M)||Ua(M)})&&this.queueRequest(Date.now(),C)},d.prototype.processRequests=function(g){var C=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var M=Os(Zt.ACCESS_TOKEN),I=M?M.u:Zt.ACCESS_TOKEN,O=I!==this.eventData.tokenU;$(this.anonId)||(this.anonId=D(),O=!0);var z=this.queue.shift();if(this.eventData.lastSuccess){var G=new Date(this.eventData.lastSuccess),q=new Date(z),re=(z-this.eventData.lastSuccess)/864e5;O=O||re>=1||re<-1||G.getDate()!==q.getDate()}else O=!0;if(!O)return this.processRequests();this.postEvent(z,{"enabled.telemetry":!1},function(oe){oe||(C.eventData.lastSuccess=z,C.eventData.tokenU=I)},g)}},d}(Ro)),$n=hn.postTurnstileEvent.bind(hn),Ta=new gr,Qn=Ta.postMapLoadEvent.bind(Ta),ci=500,Wn=50;function Ti(){p.caches&&!ne&&(ne=p.caches.open("mapbox-tiles"))}function Li(c){var d=c.indexOf("?");return d<0?c:c.slice(0,d)}var Oo,Fo=1/0;function xl(){return Oo==null&&(Oo=p.OffscreenCanvas&&new p.OffscreenCanvas(1,1).getContext("2d")&&typeof p.createImageBitmap=="function"),Oo}var Fc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Fc);var gf=function(c){function d(g,C,M){C===401&&Ua(M)&&(g+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),c.call(this,g),this.status=C,this.url=M,this.name=this.constructor.name,this.message=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),Gl=me()?function(){return self.worker&&self.worker.referrer}:function(){return(p.location.protocol==="blob:"?p.parent:p).location.href},iu,bl,Dc=function(c,d){if(!(/^file:/.test(g=c.url)||/^file:/.test(Gl())&&!/^\w+:/.test(g))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(C,M){var I,O=new p.AbortController,z=new p.Request(C.url,{method:C.method||"GET",body:C.body,credentials:C.credentials,headers:C.headers,referrer:Gl(),signal:O.signal}),G=!1,q=!1,re=(I=z.url).indexOf("sku=")>0&&Ua(I);C.type==="json"&&z.headers.set("Accept","application/json");var oe=function(pe,De,$e){if(!q){if(pe&&pe.message!=="SecurityError"&&te(pe),De&&$e)return ce(De);var tt=Date.now();p.fetch(z).then(function(Ze){if(Ze.ok){var mt=re?Ze.clone():null;return ce(Ze,mt,tt)}return M(new gf(Ze.statusText,Ze.status,C.url))}).catch(function(Ze){Ze.code!==20&&M(new Error(Ze.message))})}},ce=function(pe,De,$e){(C.type==="arrayBuffer"?pe.arrayBuffer():C.type==="json"?pe.json():pe.text()).then(function(tt){q||(De&&$e&&function(Ze,mt,At){if(Ti(),ne){var Nt={status:mt.status,statusText:mt.statusText,headers:new p.Headers};mt.headers.forEach(function(ir,Mr){return Nt.headers.set(Mr,ir)});var Vt=Re(mt.headers.get("Cache-Control")||"");Vt["no-store"]||(Vt["max-age"]&&Nt.headers.set("Expires",new Date(At+1e3*Vt["max-age"]).toUTCString()),new Date(Nt.headers.get("Expires")).getTime()-At<42e4||function(ir,Mr){if(Qt===void 0)try{new Response(new ReadableStream),Qt=!0}catch{Qt=!1}Qt?Mr(ir.body):ir.blob().then(Mr)}(mt,function(ir){var Mr=new p.Response(ir,Nt);Ti(),ne&&ne.then(function(Wr){return Wr.put(Li(Ze.url),Mr)}).catch(function(Wr){return te(Wr.message)})}))}}(z,De,$e),G=!0,M(null,tt,pe.headers.get("Cache-Control"),pe.headers.get("Expires")))}).catch(function(tt){q||M(new Error(tt.message))})};return re?function(pe,De){if(Ti(),!ne)return De(null);var $e=Li(pe.url);ne.then(function(tt){tt.match($e).then(function(Ze){var mt=function(At){if(!At)return!1;var Nt=new Date(At.headers.get("Expires")||0),Vt=Re(At.headers.get("Cache-Control")||"");return Nt>Date.now()&&!Vt["no-cache"]}(Ze);tt.delete($e),mt&&tt.put($e,Ze.clone()),De(null,Ze,mt)}).catch(De)}).catch(De)}(z,oe):oe(null,null),{cancel:function(){q=!0,G||O.abort()}}}(c,d);if(me()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,d,void 0,!0)}var g;return function(C,M){var I=new p.XMLHttpRequest;for(var O in I.open(C.method||"GET",C.url,!0),C.type==="arrayBuffer"&&(I.responseType="arraybuffer"),C.headers)I.setRequestHeader(O,C.headers[O]);return C.type==="json"&&(I.responseType="text",I.setRequestHeader("Accept","application/json")),I.withCredentials=C.credentials==="include",I.onerror=function(){M(new Error(I.statusText))},I.onload=function(){if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){var z=I.response;if(C.type==="json")try{z=JSON.parse(I.response)}catch(G){return M(G)}M(null,z,I.getResponseHeader("Cache-Control"),I.getResponseHeader("Expires"))}else M(new gf(I.statusText,I.status,C.url))},I.send(C.body),{cancel:function(){return I.abort()}}}(c,d)},mf=function(c,d){return Dc(L(c,{type:"arrayBuffer"}),d)},fo=function(c,d){return Dc(L(c,{method:"POST"}),d)},ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";iu=[],bl=0;var ue=function(c,d){if(nn.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),bl>=Zt.MAX_PARALLEL_IMAGE_REQUESTS){var g={requestParameters:c,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return iu.push(g),g}bl++;var C=!1,M=function(){if(!C)for(C=!0,bl--;iu.length&&bl<Zt.MAX_PARALLEL_IMAGE_REQUESTS;){var O=iu.shift();O.cancelled||(O.cancel=ue(O.requestParameters,O.callback).cancel)}},I=mf(c,function(O,z,G,q){M(),O?d(O):z&&(xl()?function(re,oe){var ce=new p.Blob([new Uint8Array(re)],{type:"image/png"});p.createImageBitmap(ce).then(function(pe){oe(null,pe)}).catch(function(pe){oe(new Error("Could not load image because of "+pe.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(z,d):function(re,oe,ce,pe){var De=new p.Image,$e=p.URL;De.onload=function(){oe(null,De),$e.revokeObjectURL(De.src),De.onload=null,p.requestAnimationFrame(function(){De.src=ae})},De.onerror=function(){return oe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var tt=new p.Blob([new Uint8Array(re)],{type:"image/png"});De.cacheControl=ce,De.expires=pe,De.src=re.byteLength?$e.createObjectURL(tt):ae}(z,d,G,q))});return{cancel:function(){I.cancel(),M()}}};function fe(c,d,g){g[c]&&g[c].indexOf(d)!==-1||(g[c]=g[c]||[],g[c].push(d))}function Ce(c,d,g){if(g&&g[c]){var C=g[c].indexOf(d);C!==-1&&g[c].splice(C,1)}}var Ne=function(c,d){d===void 0&&(d={}),L(this,d),this.type=c},it=function(c){function d(g,C){C===void 0&&(C={}),c.call(this,"error",L({error:g},C))}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Ne),pt=function(){};pt.prototype.on=function(c,d){return this._listeners=this._listeners||{},fe(c,d,this._listeners),this},pt.prototype.off=function(c,d){return Ce(c,d,this._listeners),Ce(c,d,this._oneTimeListeners),this},pt.prototype.once=function(c,d){return this._oneTimeListeners=this._oneTimeListeners||{},fe(c,d,this._oneTimeListeners),this},pt.prototype.fire=function(c,d){typeof c=="string"&&(c=new Ne(c,d||{}));var g=c.type;if(this.listens(g)){c.target=this;for(var C=0,M=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];C<M.length;C+=1)M[C].call(this,c);for(var I=0,O=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];I<O.length;I+=1){var z=O[I];Ce(g,z,this._oneTimeListeners),z.call(this,c)}var G=this._eventedParent;G&&(L(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),G.fire(c))}else c instanceof it&&console.error(c.error);return this},pt.prototype.listens=function(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)},pt.prototype.setEventedParent=function(c,d){return this._eventedParent=c,this._eventedParentData=d,this};var _e={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ge=function(c,d,g,C){this.message=(c?c+": ":"")+g,C&&(this.identifier=C),d!=null&&d.__line__&&(this.line=d.__line__)};function wt(c){var d=c.value;return d?[new Ge(c.key,d,"constants have been deprecated as of v8")]:[]}function cr(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var C=0,M=d;C<M.length;C+=1){var I=M[C];for(var O in I)c[O]=I[O]}return c}function fr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function $t(c){if(Array.isArray(c))return c.map($t);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){var d={};for(var g in c)d[g]=$t(c[g]);return d}return fr(c)}var pr=function(c){function d(g,C){c.call(this,C),this.message=C,this.key=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Error),Rr=function(c,d){d===void 0&&(d=[]),this.parent=c,this.bindings={};for(var g=0,C=d;g<C.length;g+=1){var M=C[g];this.bindings[M[0]]=M[1]}};Rr.prototype.concat=function(c){return new Rr(this,c)},Rr.prototype.get=function(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(c+" not found in scope.")},Rr.prototype.has=function(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)};var cn={kind:"null"},Ht={kind:"number"},an={kind:"string"},Br={kind:"boolean"},$r={kind:"color"},Ln={kind:"object"},Tr={kind:"value"},Sn={kind:"collator"},pi={kind:"formatted"},oi={kind:"resolvedImage"};function Pi(c,d){return{kind:"array",itemType:c,N:d}}function Oi(c){if(c.kind==="array"){var d=Oi(c.itemType);return typeof c.N=="number"?"array<"+d+", "+c.N+">":c.itemType.kind==="value"?"array":"array<"+d+">"}return c.kind}var Gs=[cn,Ht,an,Br,$r,pi,Ln,Pi(Tr),oi];function Qi(c,d){if(d.kind==="error")return null;if(c.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!Qi(c.itemType,d.itemType))&&(typeof c.N!="number"||c.N===d.N))return null}else{if(c.kind===d.kind)return null;if(c.kind==="value"){for(var g=0,C=Gs;g<C.length;g+=1)if(!Qi(C[g],d))return null}}return"Expected "+Oi(c)+" but found "+Oi(d)+" instead."}function Ki(c,d){return d.some(function(g){return g.kind===c.kind})}function oa(c,d){return d.some(function(g){return g==="null"?c===null:g==="array"?Array.isArray(c):g==="object"?c&&!Array.isArray(c)&&typeof c=="object":g===typeof c})}var bi=s(function(c,d){var g={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function C(z){return(z=Math.round(z))<0?0:z>255?255:z}function M(z){return C(z[z.length-1]==="%"?parseFloat(z)/100*255:parseInt(z))}function I(z){return(G=z[z.length-1]==="%"?parseFloat(z)/100:parseFloat(z))<0?0:G>1?1:G;var G}function O(z,G,q){return q<0?q+=1:q>1&&(q-=1),6*q<1?z+(G-z)*q*6:2*q<1?G:3*q<2?z+(G-z)*(2/3-q)*6:z}try{d.parseCSSColor=function(z){var G,q=z.replace(/ /g,"").toLowerCase();if(q in g)return g[q].slice();if(q[0]==="#")return q.length===4?(G=parseInt(q.substr(1),16))>=0&&G<=4095?[(3840&G)>>4|(3840&G)>>8,240&G|(240&G)>>4,15&G|(15&G)<<4,1]:null:q.length===7&&(G=parseInt(q.substr(1),16))>=0&&G<=16777215?[(16711680&G)>>16,(65280&G)>>8,255&G,1]:null;var re=q.indexOf("("),oe=q.indexOf(")");if(re!==-1&&oe+1===q.length){var ce=q.substr(0,re),pe=q.substr(re+1,oe-(re+1)).split(","),De=1;switch(ce){case"rgba":if(pe.length!==4)return null;De=I(pe.pop());case"rgb":return pe.length!==3?null:[M(pe[0]),M(pe[1]),M(pe[2]),De];case"hsla":if(pe.length!==4)return null;De=I(pe.pop());case"hsl":if(pe.length!==3)return null;var $e=(parseFloat(pe[0])%360+360)%360/360,tt=I(pe[1]),Ze=I(pe[2]),mt=Ze<=.5?Ze*(tt+1):Ze+tt-Ze*tt,At=2*Ze-mt;return[C(255*O(At,mt,$e+1/3)),C(255*O(At,mt,$e)),C(255*O(At,mt,$e-1/3)),De];default:return null}}return null}}catch{}}).parseCSSColor,Ni=function(c,d,g,C){C===void 0&&(C=1),this.r=c,this.g=d,this.b=g,this.a=C};Ni.parse=function(c){if(c){if(c instanceof Ni)return c;if(typeof c=="string"){var d=bi(c);if(d)return new Ni(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},Ni.prototype.toString=function(){var c=this.toArray(),d=c[1],g=c[2],C=c[3];return"rgba("+Math.round(c[0])+","+Math.round(d)+","+Math.round(g)+","+C+")"},Ni.prototype.toArray=function(){var c=this.a;return c===0?[0,0,0,0]:[255*this.r/c,255*this.g/c,255*this.b/c,c]},Ni.black=new Ni(0,0,0,1),Ni.white=new Ni(1,1,1,1),Ni.transparent=new Ni(0,0,0,0),Ni.red=new Ni(1,0,0,1);var Fs=function(c,d,g){this.sensitivity=c?d?"variant":"case":d?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Fs.prototype.compare=function(c,d){return this.collator.compare(c,d)},Fs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Xu=function(c,d,g,C,M){this.text=c,this.image=d,this.scale=g,this.fontStack=C,this.textColor=M},ho=function(c){this.sections=c};ho.fromString=function(c){return new ho([new Xu(c,null,null,null,null)])},ho.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(c){return c.text.length!==0||c.image&&c.image.name.length!==0})},ho.factory=function(c){return c instanceof ho?c:ho.fromString(c)},ho.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(c){return c.text}).join("")},ho.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var C=g[d];if(C.image)c.push(["image",C.image.name]);else{c.push(C.text);var M={};C.fontStack&&(M["text-font"]=["literal",C.fontStack.split(",")]),C.scale&&(M["font-scale"]=C.scale),C.textColor&&(M["text-color"]=["rgba"].concat(C.textColor.toArray())),c.push(M)}}return c};var au=function(c){this.name=c.name,this.available=c.available};function bp(c,d,g,C){return typeof c=="number"&&c>=0&&c<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof g=="number"&&g>=0&&g<=255?C===void 0||typeof C=="number"&&C>=0&&C<=1?null:"Invalid rgba value ["+[c,d,g,C].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof C=="number"?[c,d,g,C]:[c,d,g]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Bc(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Ni||c instanceof Fs||c instanceof ho||c instanceof au)return!0;if(Array.isArray(c)){for(var d=0,g=c;d<g.length;d+=1)if(!Bc(g[d]))return!1;return!0}if(typeof c=="object"){for(var C in c)if(!Bc(c[C]))return!1;return!0}return!1}function ya(c){if(c===null)return cn;if(typeof c=="string")return an;if(typeof c=="boolean")return Br;if(typeof c=="number")return Ht;if(c instanceof Ni)return $r;if(c instanceof Fs)return Sn;if(c instanceof ho)return pi;if(c instanceof au)return oi;if(Array.isArray(c)){for(var d,g=c.length,C=0,M=c;C<M.length;C+=1){var I=ya(M[C]);if(d){if(d===I)continue;d=Tr;break}d=I}return Pi(d||Tr,g)}return Ln}function yf(c){var d=typeof c;return c===null?"":d==="string"||d==="number"||d==="boolean"?String(c):c instanceof Ni||c instanceof ho||c instanceof au?c.toString():JSON.stringify(c)}au.prototype.toString=function(){return this.name},au.fromString=function(c){return c?new au({name:c,available:!1}):null},au.prototype.serialize=function(){return["image",this.name]};var Ds=function(c,d){this.type=c,this.value=d};Ds.parse=function(c,d){if(c.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(!Bc(c[1]))return d.error("invalid value");var g=c[1],C=ya(g),M=d.expectedType;return C.kind!=="array"||C.N!==0||!M||M.kind!=="array"||typeof M.N=="number"&&M.N!==0||(C=M),new Ds(C,g)},Ds.prototype.evaluate=function(){return this.value},Ds.prototype.eachChild=function(){},Ds.prototype.outputDefined=function(){return!0},Ds.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ni?["rgba"].concat(this.value.toArray()):this.value instanceof ho?this.value.serialize():this.value};var po=function(c){this.name="ExpressionEvaluationError",this.message=c};po.prototype.toJSON=function(){return this.message};var _u={string:an,number:Ht,boolean:Br,object:Ln},Za=function(c,d){this.type=c,this.args=d};Za.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g,C=1,M=c[0];if(M==="array"){var I,O;if(c.length>2){var z=c[1];if(typeof z!="string"||!(z in _u)||z==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);I=_u[z],C++}else I=Tr;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return d.error('The length argument to "array" must be a positive integer literal',2);O=c[2],C++}g=Pi(I,O)}else g=_u[M];for(var G=[];C<c.length;C++){var q=d.parse(c[C],C,Tr);if(!q)return null;G.push(q)}return new Za(g,G)},Za.prototype.evaluate=function(c){for(var d=0;d<this.args.length;d++){var g=this.args[d].evaluate(c);if(!Qi(this.type,ya(g)))return g;if(d===this.args.length-1)throw new po("Expected value to be of type "+Oi(this.type)+", but found "+Oi(ya(g))+" instead.")}return null},Za.prototype.eachChild=function(c){this.args.forEach(c)},Za.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Za.prototype.serialize=function(){var c=this.type,d=[c.kind];if(c.kind==="array"){var g=c.itemType;if(g.kind==="string"||g.kind==="number"||g.kind==="boolean"){d.push(g.kind);var C=c.N;(typeof C=="number"||this.args.length>1)&&d.push(C)}}return d.concat(this.args.map(function(M){return M.serialize()}))};var Pu=function(c){this.type=pi,this.sections=c};Pu.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[1];if(!Array.isArray(g)&&typeof g=="object")return d.error("First argument must be an image or text section.");for(var C=[],M=!1,I=1;I<=c.length-1;++I){var O=c[I];if(M&&typeof O=="object"&&!Array.isArray(O)){M=!1;var z=null;if(O["font-scale"]&&!(z=d.parse(O["font-scale"],1,Ht)))return null;var G=null;if(O["text-font"]&&!(G=d.parse(O["text-font"],1,Pi(an))))return null;var q=null;if(O["text-color"]&&!(q=d.parse(O["text-color"],1,$r)))return null;var re=C[C.length-1];re.scale=z,re.font=G,re.textColor=q}else{var oe=d.parse(c[I],1,Tr);if(!oe)return null;var ce=oe.type.kind;if(ce!=="string"&&ce!=="value"&&ce!=="null"&&ce!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");M=!0,C.push({content:oe,scale:null,font:null,textColor:null})}}return new Pu(C)},Pu.prototype.evaluate=function(c){return new ho(this.sections.map(function(d){var g=d.content.evaluate(c);return ya(g)===oi?new Xu("",g,null,null,null):new Xu(yf(g),null,d.scale?d.scale.evaluate(c):null,d.font?d.font.evaluate(c).join(","):null,d.textColor?d.textColor.evaluate(c):null)}))},Pu.prototype.eachChild=function(c){for(var d=0,g=this.sections;d<g.length;d+=1){var C=g[d];c(C.content),C.scale&&c(C.scale),C.font&&c(C.font),C.textColor&&c(C.textColor)}},Pu.prototype.outputDefined=function(){return!1},Pu.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var C=g[d];c.push(C.content.serialize());var M={};C.scale&&(M["font-scale"]=C.scale.serialize()),C.font&&(M["text-font"]=C.font.serialize()),C.textColor&&(M["text-color"]=C.textColor.serialize()),c.push(M)}return c};var bo=function(c){this.type=oi,this.input=c};bo.parse=function(c,d){if(c.length!==2)return d.error("Expected two arguments.");var g=d.parse(c[1],1,an);return g?new bo(g):d.error("No image name provided.")},bo.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=au.fromString(d);return g&&c.availableImages&&(g.available=c.availableImages.indexOf(d)>-1),g},bo.prototype.eachChild=function(c){c(this.input)},bo.prototype.outputDefined=function(){return!1},bo.prototype.serialize=function(){return["image",this.input.serialize()]};var yh={"to-boolean":Br,"to-color":$r,"to-number":Ht,"to-string":an},Yu=function(c,d){this.type=c,this.args=d};Yu.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[0];if((g==="to-boolean"||g==="to-string")&&c.length!==2)return d.error("Expected one argument.");for(var C=yh[g],M=[],I=1;I<c.length;I++){var O=d.parse(c[I],I,Tr);if(!O)return null;M.push(O)}return new Yu(C,M)},Yu.prototype.evaluate=function(c){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(c));if(this.type.kind==="color"){for(var d,g,C=0,M=this.args;C<M.length;C+=1){if(g=null,(d=M[C].evaluate(c))instanceof Ni)return d;if(typeof d=="string"){var I=c.parseColor(d);if(I)return I}else if(Array.isArray(d)&&!(g=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":bp(d[0],d[1],d[2],d[3])))return new Ni(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new po(g||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var O=null,z=0,G=this.args;z<G.length;z+=1){if((O=G[z].evaluate(c))===null)return 0;var q=Number(O);if(!isNaN(q))return q}throw new po("Could not convert "+JSON.stringify(O)+" to number.")}return this.type.kind==="formatted"?ho.fromString(yf(this.args[0].evaluate(c))):this.type.kind==="resolvedImage"?au.fromString(yf(this.args[0].evaluate(c))):yf(this.args[0].evaluate(c))},Yu.prototype.eachChild=function(c){this.args.forEach(c)},Yu.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Yu.prototype.serialize=function(){if(this.type.kind==="formatted")return new Pu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new bo(this.args[0]).serialize();var c=["to-"+this.type.kind];return this.eachChild(function(d){c.push(d.serialize())}),c};var _h=["Unknown","Point","LineString","Polygon"],wl=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};wl.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},wl.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?_h[this.feature.type]:this.feature.type:null},wl.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},wl.prototype.canonicalID=function(){return this.canonical},wl.prototype.properties=function(){return this.feature&&this.feature.properties||{}},wl.prototype.parseColor=function(c){var d=this._parseColorCache[c];return d||(d=this._parseColorCache[c]=Ni.parse(c)),d};var ws=function(c,d,g,C){this.name=c,this.type=d,this._evaluate=g,this.args=C};ws.prototype.evaluate=function(c){return this._evaluate(c,this.args)},ws.prototype.eachChild=function(c){this.args.forEach(c)},ws.prototype.outputDefined=function(){return!1},ws.prototype.serialize=function(){return[this.name].concat(this.args.map(function(c){return c.serialize()}))},ws.parse=function(c,d){var g,C=c[0],M=ws.definitions[C];if(!M)return d.error('Unknown expression "'+C+'". If you wanted a literal array, use ["literal", [...]].',0);for(var I=Array.isArray(M)?M[0]:M.type,O=Array.isArray(M)?[[M[1],M[2]]]:M.overloads,z=O.filter(function(Yn){var gn=Yn[0];return!Array.isArray(gn)||gn.length===c.length-1}),G=null,q=0,re=z;q<re.length;q+=1){var oe=re[q],ce=oe[0],pe=oe[1];G=new wh(d.registry,d.path,null,d.scope);for(var De=[],$e=!1,tt=1;tt<c.length;tt++){var Ze=c[tt],mt=Array.isArray(ce)?ce[tt-1]:ce.type,At=G.parse(Ze,1+De.length,mt);if(!At){$e=!0;break}De.push(At)}if(!$e)if(Array.isArray(ce)&&ce.length!==De.length)G.error("Expected "+ce.length+" arguments, but found "+De.length+" instead.");else{for(var Nt=0;Nt<De.length;Nt++){var Vt=Array.isArray(ce)?ce[Nt]:ce.type,ir=De[Nt];G.concat(Nt+1).checkSubtype(Vt,ir.type)}if(G.errors.length===0)return new ws(C,I,pe,De)}}if(z.length===1)(g=d.errors).push.apply(g,G.errors);else{for(var Mr=(z.length?z:O).map(function(Yn){var gn;return gn=Yn[0],Array.isArray(gn)?"("+gn.map(Oi).join(", ")+")":"("+Oi(gn.type)+"...)"}).join(" | "),Wr=[],Vn=1;Vn<c.length;Vn++){var fn=d.parse(c[Vn],1+Wr.length);if(!fn)return null;Wr.push(Oi(fn.type))}d.error("Expected arguments of type "+Mr+", but found ("+Wr.join(", ")+") instead.")}return null},ws.register=function(c,d){for(var g in ws.definitions=d,d)c[g]=ws};var Ru=function(c,d,g){this.type=Sn,this.locale=g,this.caseSensitive=c,this.diacriticSensitive=d};function he(c,d){c[0]=Math.min(c[0],d[0]),c[1]=Math.min(c[1],d[1]),c[2]=Math.max(c[2],d[0]),c[3]=Math.max(c[3],d[1])}function Te(c,d){return!(c[0]<=d[0]||c[2]>=d[2]||c[1]<=d[1]||c[3]>=d[3])}function et(c,d){var g=(180+c[0])/360,C=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,M=Math.pow(2,d.z);return[Math.round(g*M*8192),Math.round(C*M*8192)]}function jt(c,d,g){return d[1]>c[1]!=g[1]>c[1]&&c[0]<(g[0]-d[0])*(c[1]-d[1])/(g[1]-d[1])+d[0]}function Or(c,d){for(var g,C,M,I,O,z,G,q=!1,re=0,oe=d.length;re<oe;re++)for(var ce=d[re],pe=0,De=ce.length;pe<De-1;pe++){if((I=(g=c)[0]-(C=ce[pe])[0])*(G=g[1]-(M=ce[pe+1])[1])-(z=g[0]-M[0])*(O=g[1]-C[1])==0&&I*z<=0&&O*G<=0)return!1;jt(c,ce[pe],ce[pe+1])&&(q=!q)}return q}function Bn(c,d){for(var g=0;g<d.length;g++)if(Or(c,d[g]))return!0;return!1}function Ji(c,d,g,C){var M=C[0]-g[0],I=C[1]-g[1],O=(c[0]-g[0])*I-M*(c[1]-g[1]),z=(d[0]-g[0])*I-M*(d[1]-g[1]);return O>0&&z<0||O<0&&z>0}function Bs(c,d,g){for(var C=0,M=g;C<M.length;C+=1)for(var I=M[C],O=0;O<I.length-1;++O)if((oe=[(re=I[O+1])[0]-(q=I[O])[0],re[1]-q[1]])[0]*(ce=[(G=d)[0]-(z=c)[0],G[1]-z[1]])[1]-oe[1]*ce[0]!=0&&Ji(z,G,q,re)&&Ji(q,re,z,G))return!0;var z,G,q,re,oe,ce;return!1}function Hs(c,d){for(var g=0;g<c.length;++g)if(!Or(c[g],d))return!1;for(var C=0;C<c.length-1;++C)if(Bs(c[C],c[C+1],d))return!1;return!0}function xu(c,d){for(var g=0;g<d.length;g++)if(Hs(c,d[g]))return!0;return!1}function js(c,d,g){for(var C=[],M=0;M<c.length;M++){for(var I=[],O=0;O<c[M].length;O++){var z=et(c[M][O],g);he(d,z),I.push(z)}C.push(I)}return C}function dm(c,d,g){for(var C=[],M=0;M<c.length;M++){var I=js(c[M],d,g);C.push(I)}return C}function nv(c,d,g,C){if(c[0]<g[0]||c[0]>g[2]){var M=.5*C,I=c[0]-g[0]>M?-C:g[0]-c[0]>M?C:0;I===0&&(I=c[0]-g[2]>M?-C:g[2]-c[0]>M?C:0),c[0]+=I}he(d,c)}function zy(c,d,g,C){for(var M=8192*Math.pow(2,C.z),I=[8192*C.x,8192*C.y],O=[],z=0,G=c;z<G.length;z+=1)for(var q=0,re=G[z];q<re.length;q+=1){var oe=re[q],ce=[oe.x+I[0],oe.y+I[1]];nv(ce,d,g,M),O.push(ce)}return O}function ng(c,d,g,C){for(var M,I=8192*Math.pow(2,C.z),O=[8192*C.x,8192*C.y],z=[],G=0,q=c;G<q.length;G+=1){for(var re=[],oe=0,ce=q[G];oe<ce.length;oe+=1){var pe=ce[oe],De=[pe.x+O[0],pe.y+O[1]];he(d,De),re.push(De)}z.push(re)}if(d[2]-d[0]<=I/2){(M=d)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(var $e=0,tt=z;$e<tt.length;$e+=1)for(var Ze=0,mt=tt[$e];Ze<mt.length;Ze+=1)nv(mt[Ze],d,g,I)}return z}Ru.parse=function(c,d){if(c.length!==2)return d.error("Expected one argument.");var g=c[1];if(typeof g!="object"||Array.isArray(g))return d.error("Collator options argument must be an object.");var C=d.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,Br);if(!C)return null;var M=d.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,Br);if(!M)return null;var I=null;return g.locale&&!(I=d.parse(g.locale,1,an))?null:new Ru(C,M,I)},Ru.prototype.evaluate=function(c){return new Fs(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)},Ru.prototype.eachChild=function(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)},Ru.prototype.outputDefined=function(){return!1},Ru.prototype.serialize=function(){var c={};return c["case-sensitive"]=this.caseSensitive.serialize(),c["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(c.locale=this.locale.serialize()),["collator",c]};var Cl=function(c,d){this.type=Br,this.geojson=c,this.geometries=d};function xh(c){if(c instanceof ws&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Cl)return!1;var d=!0;return c.eachChild(function(g){d&&!xh(g)&&(d=!1)}),d}function bh(c){if(c instanceof ws&&c.name==="feature-state")return!1;var d=!0;return c.eachChild(function(g){d&&!bh(g)&&(d=!1)}),d}function wp(c,d){if(c instanceof ws&&d.indexOf(c.name)>=0)return!1;var g=!0;return c.eachChild(function(C){g&&!wp(C,d)&&(g=!1)}),g}Cl.parse=function(c,d){if(c.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(Bc(c[1])){var g=c[1];if(g.type==="FeatureCollection")for(var C=0;C<g.features.length;++C){var M=g.features[C].geometry.type;if(M==="Polygon"||M==="MultiPolygon")return new Cl(g,g.features[C].geometry)}else if(g.type==="Feature"){var I=g.geometry.type;if(I==="Polygon"||I==="MultiPolygon")return new Cl(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Cl(g,g)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Cl.prototype.evaluate=function(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(d,g){var C=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],I=d.canonicalID();if(g.type==="Polygon"){var O=js(g.coordinates,M,I),z=zy(d.geometry(),C,M,I);if(!Te(C,M))return!1;for(var G=0,q=z;G<q.length;G+=1)if(!Or(q[G],O))return!1}if(g.type==="MultiPolygon"){var re=dm(g.coordinates,M,I),oe=zy(d.geometry(),C,M,I);if(!Te(C,M))return!1;for(var ce=0,pe=oe;ce<pe.length;ce+=1)if(!Bn(pe[ce],re))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(d,g){var C=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],I=d.canonicalID();if(g.type==="Polygon"){var O=js(g.coordinates,M,I),z=ng(d.geometry(),C,M,I);if(!Te(C,M))return!1;for(var G=0,q=z;G<q.length;G+=1)if(!Hs(q[G],O))return!1}if(g.type==="MultiPolygon"){var re=dm(g.coordinates,M,I),oe=ng(d.geometry(),C,M,I);if(!Te(C,M))return!1;for(var ce=0,pe=oe;ce<pe.length;ce+=1)if(!xu(pe[ce],re))return!1}return!0}(c,this.geometries)}return!1},Cl.prototype.eachChild=function(){},Cl.prototype.outputDefined=function(){return!0},Cl.prototype.serialize=function(){return["within",this.geojson]};var El=function(c,d){this.type=d.type,this.name=c,this.boundExpression=d};El.parse=function(c,d){if(c.length!==2||typeof c[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var g=c[1];return d.scope.has(g)?new El(g,d.scope.get(g)):d.error('Unknown variable "'+g+'". Make sure "'+g+'" has been bound in an enclosing "let" expression before using it.',1)},El.prototype.evaluate=function(c){return this.boundExpression.evaluate(c)},El.prototype.eachChild=function(){},El.prototype.outputDefined=function(){return!1},El.prototype.serialize=function(){return["var",this.name]};var wh=function(c,d,g,C,M){d===void 0&&(d=[]),C===void 0&&(C=new Rr),M===void 0&&(M=[]),this.registry=c,this.path=d,this.key=d.map(function(I){return"["+I+"]"}).join(""),this.scope=C,this.errors=M,this.expectedType=g};function wo(c,d){for(var g,C=c.length-1,M=0,I=C,O=0;M<=I;)if((g=c[O=Math.floor((M+I)/2)])<=d){if(O===C||d<c[O+1])return O;M=O+1}else{if(!(g>d))throw new po("Input is not a number.");I=O-1}return 0}wh.prototype.parse=function(c,d,g,C,M){return M===void 0&&(M={}),d?this.concat(d,g,C)._parse(c,M):this._parse(c,M)},wh.prototype._parse=function(c,d){function g(q,re,oe){return oe==="assert"?new Za(re,[q]):oe==="coerce"?new Yu(re,[q]):q}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var C=c[0];if(typeof C!="string")return this.error("Expression name must be a string, but found "+typeof C+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var M=this.registry[C];if(M){var I=M.parse(c,this);if(!I)return null;if(this.expectedType){var O=this.expectedType,z=I.type;if(O.kind!=="string"&&O.kind!=="number"&&O.kind!=="boolean"&&O.kind!=="object"&&O.kind!=="array"||z.kind!=="value")if(O.kind!=="color"&&O.kind!=="formatted"&&O.kind!=="resolvedImage"||z.kind!=="value"&&z.kind!=="string"){if(this.checkSubtype(O,z))return null}else I=g(I,O,d.typeAnnotation||"coerce");else I=g(I,O,d.typeAnnotation||"assert")}if(!(I instanceof Ds)&&I.type.kind!=="resolvedImage"&&function q(re){if(re instanceof El)return q(re.boundExpression);if(re instanceof ws&&re.name==="error"||re instanceof Ru||re instanceof Cl)return!1;var oe=re instanceof Yu||re instanceof Za,ce=!0;return re.eachChild(function(pe){ce=oe?ce&&q(pe):ce&&pe instanceof Ds}),!!ce&&xh(re)&&wp(re,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(I)){var G=new wl;try{I=new Ds(I.type,I.evaluate(G))}catch(q){return this.error(q.message),null}}return I}return this.error('Unknown expression "'+C+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof c+" instead.")},wh.prototype.concat=function(c,d,g){var C=typeof c=="number"?this.path.concat(c):this.path,M=g?this.scope.concat(g):this.scope;return new wh(this.registry,C,d||null,M,this.errors)},wh.prototype.error=function(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];var C=""+this.key+d.map(function(M){return"["+M+"]"}).join("");this.errors.push(new pr(C,c))},wh.prototype.checkSubtype=function(c,d){var g=Qi(c,d);return g&&this.error(g),g};var ea=function(c,d,g){this.type=c,this.input=d,this.labels=[],this.outputs=[];for(var C=0,M=g;C<M.length;C+=1){var I=M[C],O=I[1];this.labels.push(I[0]),this.outputs.push(O)}};function us(c,d,g){return c*(1-g)+d*g}ea.parse=function(c,d){if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");var g=d.parse(c[1],1,Ht);if(!g)return null;var C=[],M=null;d.expectedType&&d.expectedType.kind!=="value"&&(M=d.expectedType);for(var I=1;I<c.length;I+=2){var O=I===1?-1/0:c[I],z=c[I+1],G=I,q=I+1;if(typeof O!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(C.length&&C[C.length-1][0]>=O)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',G);var re=d.parse(z,q,M);if(!re)return null;M=M||re.type,C.push([O,re])}return new ea(M,g,C)},ea.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var C=this.input.evaluate(c);if(C<=d[0])return g[0].evaluate(c);var M=d.length;return C>=d[M-1]?g[M-1].evaluate(c):g[wo(d,C)].evaluate(c)},ea.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},ea.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},ea.prototype.serialize=function(){for(var c=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&c.push(this.labels[d]),c.push(this.outputs[d].serialize());return c};var Cp=Object.freeze({__proto__:null,number:us,color:function(c,d,g){return new Ni(us(c.r,d.r,g),us(c.g,d.g,g),us(c.b,d.b,g),us(c.a,d.a,g))},array:function(c,d,g){return c.map(function(C,M){return us(C,d[M],g)})}}),vm=6/29*3*(6/29),P_=Math.PI/180,gm=180/Math.PI;function iv(c){return c>.008856451679035631?Math.pow(c,1/3):c/vm+4/29}function Nc(c){return c>6/29?c*c*c:vm*(c-4/29)}function sd(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Ws(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function av(c){var d=Ws(c.r),g=Ws(c.g),C=Ws(c.b),M=iv((.4124564*d+.3575761*g+.1804375*C)/.95047),I=iv((.2126729*d+.7151522*g+.072175*C)/1);return{l:116*I-16,a:500*(M-I),b:200*(I-iv((.0193339*d+.119192*g+.9503041*C)/1.08883)),alpha:c.a}}function Ch(c){var d=(c.l+16)/116,g=isNaN(c.a)?d:d+c.a/500,C=isNaN(c.b)?d:d-c.b/200;return d=1*Nc(d),g=.95047*Nc(g),C=1.08883*Nc(C),new Ni(sd(3.2404542*g-1.5371385*d-.4985314*C),sd(-.969266*g+1.8760108*d+.041556*C),sd(.0556434*g-.2040259*d+1.0572252*C),c.alpha)}function $y(c,d,g){var C=d-c;return c+g*(C>180||C<-180?C-360*Math.round(C/360):C)}var Ep={forward:av,reverse:Ch,interpolate:function(c,d,g){return{l:us(c.l,d.l,g),a:us(c.a,d.a,g),b:us(c.b,d.b,g),alpha:us(c.alpha,d.alpha,g)}}},Zu={forward:function(c){var d=av(c),g=d.l,C=d.a,M=d.b,I=Math.atan2(M,C)*gm;return{h:I<0?I+360:I,c:Math.sqrt(C*C+M*M),l:g,alpha:c.a}},reverse:function(c){var d=c.h*P_,g=c.c;return Ch({l:c.l,a:Math.cos(d)*g,b:Math.sin(d)*g,alpha:c.alpha})},interpolate:function(c,d,g){return{h:$y(c.h,d.h,g),c:us(c.c,d.c,g),l:us(c.l,d.l,g),alpha:us(c.alpha,d.alpha,g)}}},mm=Object.freeze({__proto__:null,lab:Ep,hcl:Zu}),ou=function(c,d,g,C,M){this.type=c,this.operator=d,this.interpolation=g,this.input=C,this.labels=[],this.outputs=[];for(var I=0,O=M;I<O.length;I+=1){var z=O[I],G=z[1];this.labels.push(z[0]),this.outputs.push(G)}};function ig(c,d,g,C){var M=C-g,I=c-g;return M===0?0:d===1?I/M:(Math.pow(d,I)-1)/(Math.pow(d,M)-1)}ou.interpolationFactor=function(c,d,g,C){var M=0;if(c.name==="exponential")M=ig(d,c.base,g,C);else if(c.name==="linear")M=ig(d,1,g,C);else if(c.name==="cubic-bezier"){var I=c.controlPoints;M=new u(I[0],I[1],I[2],I[3]).solve(ig(d,1,g,C))}return M},ou.parse=function(c,d){var g=c[0],C=c[1],M=c[2],I=c.slice(3);if(!Array.isArray(C)||C.length===0)return d.error("Expected an interpolation type expression.",1);if(C[0]==="linear")C={name:"linear"};else if(C[0]==="exponential"){var O=C[1];if(typeof O!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);C={name:"exponential",base:O}}else{if(C[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(C[0]),1,0);var z=C.slice(1);if(z.length!==4||z.some(function(tt){return typeof tt!="number"||tt<0||tt>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);C={name:"cubic-bezier",controlPoints:z}}if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(M=d.parse(M,2,Ht)))return null;var G=[],q=null;g==="interpolate-hcl"||g==="interpolate-lab"?q=$r:d.expectedType&&d.expectedType.kind!=="value"&&(q=d.expectedType);for(var re=0;re<I.length;re+=2){var oe=I[re],ce=I[re+1],pe=re+3,De=re+4;if(typeof oe!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if(G.length&&G[G.length-1][0]>=oe)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',pe);var $e=d.parse(ce,De,q);if(!$e)return null;q=q||$e.type,G.push([oe,$e])}return q.kind==="number"||q.kind==="color"||q.kind==="array"&&q.itemType.kind==="number"&&typeof q.N=="number"?new ou(q,g,C,M,G):d.error("Type "+Oi(q)+" is not interpolatable.")},ou.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var C=this.input.evaluate(c);if(C<=d[0])return g[0].evaluate(c);var M=d.length;if(C>=d[M-1])return g[M-1].evaluate(c);var I=wo(d,C),O=ou.interpolationFactor(this.interpolation,C,d[I],d[I+1]),z=g[I].evaluate(c),G=g[I+1].evaluate(c);return this.operator==="interpolate"?Cp[this.type.kind.toLowerCase()](z,G,O):this.operator==="interpolate-hcl"?Zu.reverse(Zu.interpolate(Zu.forward(z),Zu.forward(G),O)):Ep.reverse(Ep.interpolate(Ep.forward(z),Ep.forward(G),O))},ou.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},ou.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},ou.prototype.serialize=function(){var c;c=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,c,this.input.serialize()],g=0;g<this.labels.length;g++)d.push(this.labels[g],this.outputs[g].serialize());return d};var qu=function(c,d){this.type=c,this.args=d};qu.parse=function(c,d){if(c.length<2)return d.error("Expectected at least one argument.");var g=null,C=d.expectedType;C&&C.kind!=="value"&&(g=C);for(var M=[],I=0,O=c.slice(1);I<O.length;I+=1){var z=d.parse(O[I],1+M.length,g,void 0,{typeAnnotation:"omit"});if(!z)return null;g=g||z.type,M.push(z)}var G=C&&M.some(function(q){return Qi(C,q.type)});return new qu(G?Tr:g,M)},qu.prototype.evaluate=function(c){for(var d,g=null,C=0,M=0,I=this.args;M<I.length&&(C++,(g=I[M].evaluate(c))&&g instanceof au&&!g.available&&(d||(d=g.name),g=null,C===this.args.length&&(g=d)),g===null);M+=1);return g},qu.prototype.eachChild=function(c){this.args.forEach(c)},qu.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},qu.prototype.serialize=function(){var c=["coalesce"];return this.eachChild(function(d){c.push(d.serialize())}),c};var Vf=function(c,d){this.type=d.type,this.bindings=[].concat(c),this.result=d};Vf.prototype.evaluate=function(c){return this.result.evaluate(c)},Vf.prototype.eachChild=function(c){for(var d=0,g=this.bindings;d<g.length;d+=1)c(g[d][1]);c(this.result)},Vf.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found "+(c.length-1)+" instead.");for(var g=[],C=1;C<c.length-1;C+=2){var M=c[C];if(typeof M!="string")return d.error("Expected string, but found "+typeof M+" instead.",C);if(/[^a-zA-Z0-9_]/.test(M))return d.error("Variable names must contain only alphanumeric characters or '_'.",C);var I=d.parse(c[C+1],C+1);if(!I)return null;g.push([M,I])}var O=d.parse(c[c.length-1],c.length-1,d.expectedType,g);return O?new Vf(g,O):null},Vf.prototype.outputDefined=function(){return this.result.outputDefined()},Vf.prototype.serialize=function(){for(var c=["let"],d=0,g=this.bindings;d<g.length;d+=1){var C=g[d];c.push(C[0],C[1].serialize())}return c.push(this.result.serialize()),c};var Eh=function(c,d,g){this.type=c,this.index=d,this.input=g};Eh.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Ht),C=d.parse(c[2],2,Pi(d.expectedType||Tr));return g&&C?new Eh(C.type.itemType,g,C):null},Eh.prototype.evaluate=function(c){var d=this.index.evaluate(c),g=this.input.evaluate(c);if(d<0)throw new po("Array index out of bounds: "+d+" < 0.");if(d>=g.length)throw new po("Array index out of bounds: "+d+" > "+(g.length-1)+".");if(d!==Math.floor(d))throw new po("Array index must be an integer, but found "+d+" instead.");return g[d]},Eh.prototype.eachChild=function(c){c(this.index),c(this.input)},Eh.prototype.outputDefined=function(){return!1},Eh.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var hs=function(c,d){this.type=Br,this.needle=c,this.haystack=d};hs.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Tr),C=d.parse(c[2],2,Tr);return g&&C?Ki(g.type,[Br,an,Ht,cn,Tr])?new hs(g,C):d.error("Expected first argument to be of type boolean, string, number or null, but found "+Oi(g.type)+" instead"):null},hs.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!g)return!1;if(!oa(d,["boolean","string","number","null"]))throw new po("Expected first argument to be of type boolean, string, number or null, but found "+Oi(ya(d))+" instead.");if(!oa(g,["string","array"]))throw new po("Expected second argument to be of type array or string, but found "+Oi(ya(g))+" instead.");return g.indexOf(d)>=0},hs.prototype.eachChild=function(c){c(this.needle),c(this.haystack)},hs.prototype.outputDefined=function(){return!0},hs.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Sh=function(c,d,g){this.type=Ht,this.needle=c,this.haystack=d,this.fromIndex=g};Sh.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Tr),C=d.parse(c[2],2,Tr);if(!g||!C)return null;if(!Ki(g.type,[Br,an,Ht,cn,Tr]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+Oi(g.type)+" instead");if(c.length===4){var M=d.parse(c[3],3,Ht);return M?new Sh(g,C,M):null}return new Sh(g,C)},Sh.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!oa(d,["boolean","string","number","null"]))throw new po("Expected first argument to be of type boolean, string, number or null, but found "+Oi(ya(d))+" instead.");if(!oa(g,["string","array"]))throw new po("Expected second argument to be of type array or string, but found "+Oi(ya(g))+" instead.");if(this.fromIndex){var C=this.fromIndex.evaluate(c);return g.indexOf(d,C)}return g.indexOf(d)},Sh.prototype.eachChild=function(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)},Sh.prototype.outputDefined=function(){return!1},Sh.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var c=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),c]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ps=function(c,d,g,C,M,I){this.inputType=c,this.type=d,this.input=g,this.cases=C,this.outputs=M,this.otherwise=I};ps.parse=function(c,d){if(c.length<5)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if(c.length%2!=1)return d.error("Expected an even number of arguments.");var g,C;d.expectedType&&d.expectedType.kind!=="value"&&(C=d.expectedType);for(var M={},I=[],O=2;O<c.length-1;O+=2){var z=c[O],G=c[O+1];Array.isArray(z)||(z=[z]);var q=d.concat(O);if(z.length===0)return q.error("Expected at least one branch label.");for(var re=0,oe=z;re<oe.length;re+=1){var ce=oe[re];if(typeof ce!="number"&&typeof ce!="string")return q.error("Branch labels must be numbers or strings.");if(typeof ce=="number"&&Math.abs(ce)>Number.MAX_SAFE_INTEGER)return q.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof ce=="number"&&Math.floor(ce)!==ce)return q.error("Numeric branch labels must be integer values.");if(g){if(q.checkSubtype(g,ya(ce)))return null}else g=ya(ce);if(M[String(ce)]!==void 0)return q.error("Branch labels must be unique.");M[String(ce)]=I.length}var pe=d.parse(G,O,C);if(!pe)return null;C=C||pe.type,I.push(pe)}var De=d.parse(c[1],1,Tr);if(!De)return null;var $e=d.parse(c[c.length-1],c.length-1,C);return $e?De.type.kind!=="value"&&d.concat(1).checkSubtype(g,De.type)?null:new ps(g,C,De,M,I,$e):null},ps.prototype.evaluate=function(c){var d=this.input.evaluate(c);return(ya(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(c)},ps.prototype.eachChild=function(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)},ps.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})&&this.otherwise.outputDefined()},ps.prototype.serialize=function(){for(var c=this,d=["match",this.input.serialize()],g=[],C={},M=0,I=Object.keys(this.cases).sort();M<I.length;M+=1){var O=I[M];(oe=C[this.cases[O]])===void 0?(C[this.cases[O]]=g.length,g.push([this.cases[O],[O]])):g[oe][1].push(O)}for(var z=function(pe){return c.inputType.kind==="number"?Number(pe):pe},G=0,q=g;G<q.length;G+=1){var re=q[G],oe=re[0],ce=re[1];d.push(ce.length===1?z(ce[0]):ce.map(z)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var Ah=function(c,d,g){this.type=c,this.branches=d,this.otherwise=g};Ah.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found only "+(c.length-1)+".");if(c.length%2!=0)return d.error("Expected an odd number of arguments.");var g;d.expectedType&&d.expectedType.kind!=="value"&&(g=d.expectedType);for(var C=[],M=1;M<c.length-1;M+=2){var I=d.parse(c[M],M,Br);if(!I)return null;var O=d.parse(c[M+1],M+1,g);if(!O)return null;C.push([I,O]),g=g||O.type}var z=d.parse(c[c.length-1],c.length-1,g);return z?new Ah(g,C,z):null},Ah.prototype.evaluate=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var C=g[d],M=C[1];if(C[0].evaluate(c))return M.evaluate(c)}return this.otherwise.evaluate(c)},Ah.prototype.eachChild=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var C=g[d],M=C[1];c(C[0]),c(M)}c(this.otherwise)},Ah.prototype.outputDefined=function(){return this.branches.every(function(c){return c[1].outputDefined()})&&this.otherwise.outputDefined()},Ah.prototype.serialize=function(){var c=["case"];return this.eachChild(function(d){c.push(d.serialize())}),c};var Sl=function(c,d,g,C){this.type=c,this.input=d,this.beginIndex=g,this.endIndex=C};function _f(c,d){return c==="=="||c==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function zc(c,d,g,C){return C.compare(d,g)===0}function Ma(c,d,g){var C=c!=="=="&&c!=="!=";return function(){function M(I,O,z){this.type=Br,this.lhs=I,this.rhs=O,this.collator=z,this.hasUntypedArgument=I.type.kind==="value"||O.type.kind==="value"}return M.parse=function(I,O){if(I.length!==3&&I.length!==4)return O.error("Expected two or three arguments.");var z=I[0],G=O.parse(I[1],1,Tr);if(!G)return null;if(!_f(z,G.type))return O.concat(1).error('"'+z+`" comparisons are not supported for type '`+Oi(G.type)+"'.");var q=O.parse(I[2],2,Tr);if(!q)return null;if(!_f(z,q.type))return O.concat(2).error('"'+z+`" comparisons are not supported for type '`+Oi(q.type)+"'.");if(G.type.kind!==q.type.kind&&G.type.kind!=="value"&&q.type.kind!=="value")return O.error("Cannot compare types '"+Oi(G.type)+"' and '"+Oi(q.type)+"'.");C&&(G.type.kind==="value"&&q.type.kind!=="value"?G=new Za(q.type,[G]):G.type.kind!=="value"&&q.type.kind==="value"&&(q=new Za(G.type,[q])));var re=null;if(I.length===4){if(G.type.kind!=="string"&&q.type.kind!=="string"&&G.type.kind!=="value"&&q.type.kind!=="value")return O.error("Cannot use collator to compare non-string types.");if(!(re=O.parse(I[3],3,Sn)))return null}return new M(G,q,re)},M.prototype.evaluate=function(I){var O=this.lhs.evaluate(I),z=this.rhs.evaluate(I);if(C&&this.hasUntypedArgument){var G=ya(O),q=ya(z);if(G.kind!==q.kind||G.kind!=="string"&&G.kind!=="number")throw new po('Expected arguments for "'+c+'" to be (string, string) or (number, number), but found ('+G.kind+", "+q.kind+") instead.")}if(this.collator&&!C&&this.hasUntypedArgument){var re=ya(O),oe=ya(z);if(re.kind!=="string"||oe.kind!=="string")return d(I,O,z)}return this.collator?g(I,O,z,this.collator.evaluate(I)):d(I,O,z)},M.prototype.eachChild=function(I){I(this.lhs),I(this.rhs),this.collator&&I(this.collator)},M.prototype.outputDefined=function(){return!0},M.prototype.serialize=function(){var I=[c];return this.eachChild(function(O){I.push(O.serialize())}),I},M}()}Sl.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Tr),C=d.parse(c[2],2,Ht);if(!g||!C)return null;if(!Ki(g.type,[Pi(Tr),an,Tr]))return d.error("Expected first argument to be of type array or string, but found "+Oi(g.type)+" instead");if(c.length===4){var M=d.parse(c[3],3,Ht);return M?new Sl(g.type,g,C,M):null}return new Sl(g.type,g,C)},Sl.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=this.beginIndex.evaluate(c);if(!oa(d,["string","array"]))throw new po("Expected first argument to be of type array or string, but found "+Oi(ya(d))+" instead.");if(this.endIndex){var C=this.endIndex.evaluate(c);return d.slice(g,C)}return d.slice(g)},Sl.prototype.eachChild=function(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)},Sl.prototype.outputDefined=function(){return!1},Sl.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var c=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),c]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var ls=Ma("==",function(c,d,g){return d===g},zc),$c=Ma("!=",function(c,d,g){return d!==g},function(c,d,g,C){return!zc(0,d,g,C)}),ag=Ma("<",function(c,d,g){return d<g},function(c,d,g,C){return C.compare(d,g)<0}),ym=Ma(">",function(c,d,g){return d>g},function(c,d,g,C){return C.compare(d,g)>0}),og=Ma("<=",function(c,d,g){return d<=g},function(c,d,g,C){return C.compare(d,g)<=0}),Uy=Ma(">=",function(c,d,g){return d>=g},function(c,d,g,C){return C.compare(d,g)>=0}),Th=function(c,d,g,C,M){this.type=an,this.number=c,this.locale=d,this.currency=g,this.minFractionDigits=C,this.maxFractionDigits=M};Th.parse=function(c,d){if(c.length!==3)return d.error("Expected two arguments.");var g=d.parse(c[1],1,Ht);if(!g)return null;var C=c[2];if(typeof C!="object"||Array.isArray(C))return d.error("NumberFormat options argument must be an object.");var M=null;if(C.locale&&!(M=d.parse(C.locale,1,an)))return null;var I=null;if(C.currency&&!(I=d.parse(C.currency,1,an)))return null;var O=null;if(C["min-fraction-digits"]&&!(O=d.parse(C["min-fraction-digits"],1,Ht)))return null;var z=null;return C["max-fraction-digits"]&&!(z=d.parse(C["max-fraction-digits"],1,Ht))?null:new Th(g,M,I,O,z)},Th.prototype.evaluate=function(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))},Th.prototype.eachChild=function(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)},Th.prototype.outputDefined=function(){return!1},Th.prototype.serialize=function(){var c={};return this.locale&&(c.locale=this.locale.serialize()),this.currency&&(c.currency=this.currency.serialize()),this.minFractionDigits&&(c["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(c["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),c]};var ro=function(c){this.type=Ht,this.input=c};ro.parse=function(c,d){if(c.length!==2)return d.error("Expected 1 argument, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+Oi(g.type)+" instead."):new ro(g):null},ro.prototype.evaluate=function(c){var d=this.input.evaluate(c);if(typeof d=="string"||Array.isArray(d))return d.length;throw new po("Expected value to be of type string or array, but found "+Oi(ya(d))+" instead.")},ro.prototype.eachChild=function(c){c(this.input)},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){var c=["length"];return this.eachChild(function(d){c.push(d.serialize())}),c};var Gf={"==":ls,"!=":$c,">":ym,"<":ag,">=":Uy,"<=":og,array:Za,at:Eh,boolean:Za,case:Ah,coalesce:qu,collator:Ru,format:Pu,image:bo,in:hs,"index-of":Sh,interpolate:ou,"interpolate-hcl":ou,"interpolate-lab":ou,length:ro,let:Vf,literal:Ds,match:ps,number:Za,"number-format":Th,object:Za,slice:Sl,step:ea,string:Za,"to-boolean":Yu,"to-color":Yu,"to-number":Yu,"to-string":Yu,var:El,within:Cl};function ov(c,d){var g=d[0],C=d[1],M=d[2],I=d[3];g=g.evaluate(c),C=C.evaluate(c),M=M.evaluate(c);var O=I?I.evaluate(c):1,z=bp(g,C,M,O);if(z)throw new po(z);return new Ni(g/255*O,C/255*O,M/255*O,O)}function Ku(c,d){return c in d}function sv(c,d){var g=d[c];return g===void 0?null:g}function Uc(c){return{type:c}}function Hf(c){return{result:"success",value:c}}function Vc(c){return{result:"error",value:c}}function lc(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function Sp(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Mh(c){return!!c.expression&&c.expression.interpolated}function Ga(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function Lh(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Vy(c){return c}function Ap(c,d,g){return c!==void 0?c:d!==void 0?d:g!==void 0?g:void 0}function Al(c,d,g,C,M){return Ap(typeof g===M?C[g]:void 0,c.default,d.default)}function _m(c,d,g){if(Ga(g)!=="number")return Ap(c.default,d.default);var C=c.stops.length;if(C===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[C-1][0])return c.stops[C-1][1];var M=wo(c.stops.map(function(I){return I[0]}),g);return c.stops[M][1]}function ud(c,d,g){var C=c.base!==void 0?c.base:1;if(Ga(g)!=="number")return Ap(c.default,d.default);var M=c.stops.length;if(M===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[M-1][0])return c.stops[M-1][1];var I=wo(c.stops.map(function(oe){return oe[0]}),g),O=function(oe,ce,pe,De){var $e=De-pe,tt=oe-pe;return $e===0?0:ce===1?tt/$e:(Math.pow(ce,tt)-1)/(Math.pow(ce,$e)-1)}(g,C,c.stops[I][0],c.stops[I+1][0]),z=c.stops[I][1],G=c.stops[I+1][1],q=Cp[d.type]||Vy;if(c.colorSpace&&c.colorSpace!=="rgb"){var re=mm[c.colorSpace];q=function(oe,ce){return re.reverse(re.interpolate(re.forward(oe),re.forward(ce),O))}}return typeof z.evaluate=="function"?{evaluate:function(){for(var oe=[],ce=arguments.length;ce--;)oe[ce]=arguments[ce];var pe=z.evaluate.apply(void 0,oe),De=G.evaluate.apply(void 0,oe);if(pe!==void 0&&De!==void 0)return q(pe,De,O)}}:q(z,G,O)}function Tp(c,d,g){return d.type==="color"?g=Ni.parse(g):d.type==="formatted"?g=ho.fromString(g.toString()):d.type==="resolvedImage"?g=au.fromString(g.toString()):Ga(g)===d.type||d.type==="enum"&&d.values[g]||(g=void 0),Ap(g,c.default,d.default)}ws.register(Gf,{error:[{kind:"error"},[an],function(c,d){throw new po(d[0].evaluate(c))}],typeof:[an,[Tr],function(c,d){return Oi(ya(d[0].evaluate(c)))}],"to-rgba":[Pi(Ht,4),[$r],function(c,d){return d[0].evaluate(c).toArray()}],rgb:[$r,[Ht,Ht,Ht],ov],rgba:[$r,[Ht,Ht,Ht,Ht],ov],has:{type:Br,overloads:[[[an],function(c,d){return Ku(d[0].evaluate(c),c.properties())}],[[an,Ln],function(c,d){var g=d[1];return Ku(d[0].evaluate(c),g.evaluate(c))}]]},get:{type:Tr,overloads:[[[an],function(c,d){return sv(d[0].evaluate(c),c.properties())}],[[an,Ln],function(c,d){var g=d[1];return sv(d[0].evaluate(c),g.evaluate(c))}]]},"feature-state":[Tr,[an],function(c,d){return sv(d[0].evaluate(c),c.featureState||{})}],properties:[Ln,[],function(c){return c.properties()}],"geometry-type":[an,[],function(c){return c.geometryType()}],id:[Tr,[],function(c){return c.id()}],zoom:[Ht,[],function(c){return c.globals.zoom}],"heatmap-density":[Ht,[],function(c){return c.globals.heatmapDensity||0}],"line-progress":[Ht,[],function(c){return c.globals.lineProgress||0}],accumulated:[Tr,[],function(c){return c.globals.accumulated===void 0?null:c.globals.accumulated}],"+":[Ht,Uc(Ht),function(c,d){for(var g=0,C=0,M=d;C<M.length;C+=1)g+=M[C].evaluate(c);return g}],"*":[Ht,Uc(Ht),function(c,d){for(var g=1,C=0,M=d;C<M.length;C+=1)g*=M[C].evaluate(c);return g}],"-":{type:Ht,overloads:[[[Ht,Ht],function(c,d){var g=d[1];return d[0].evaluate(c)-g.evaluate(c)}],[[Ht],function(c,d){return-d[0].evaluate(c)}]]},"/":[Ht,[Ht,Ht],function(c,d){var g=d[1];return d[0].evaluate(c)/g.evaluate(c)}],"%":[Ht,[Ht,Ht],function(c,d){var g=d[1];return d[0].evaluate(c)%g.evaluate(c)}],ln2:[Ht,[],function(){return Math.LN2}],pi:[Ht,[],function(){return Math.PI}],e:[Ht,[],function(){return Math.E}],"^":[Ht,[Ht,Ht],function(c,d){var g=d[1];return Math.pow(d[0].evaluate(c),g.evaluate(c))}],sqrt:[Ht,[Ht],function(c,d){return Math.sqrt(d[0].evaluate(c))}],log10:[Ht,[Ht],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN10}],ln:[Ht,[Ht],function(c,d){return Math.log(d[0].evaluate(c))}],log2:[Ht,[Ht],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN2}],sin:[Ht,[Ht],function(c,d){return Math.sin(d[0].evaluate(c))}],cos:[Ht,[Ht],function(c,d){return Math.cos(d[0].evaluate(c))}],tan:[Ht,[Ht],function(c,d){return Math.tan(d[0].evaluate(c))}],asin:[Ht,[Ht],function(c,d){return Math.asin(d[0].evaluate(c))}],acos:[Ht,[Ht],function(c,d){return Math.acos(d[0].evaluate(c))}],atan:[Ht,[Ht],function(c,d){return Math.atan(d[0].evaluate(c))}],min:[Ht,Uc(Ht),function(c,d){return Math.min.apply(Math,d.map(function(g){return g.evaluate(c)}))}],max:[Ht,Uc(Ht),function(c,d){return Math.max.apply(Math,d.map(function(g){return g.evaluate(c)}))}],abs:[Ht,[Ht],function(c,d){return Math.abs(d[0].evaluate(c))}],round:[Ht,[Ht],function(c,d){var g=d[0].evaluate(c);return g<0?-Math.round(-g):Math.round(g)}],floor:[Ht,[Ht],function(c,d){return Math.floor(d[0].evaluate(c))}],ceil:[Ht,[Ht],function(c,d){return Math.ceil(d[0].evaluate(c))}],"filter-==":[Br,[an,Tr],function(c,d){var g=d[0],C=d[1];return c.properties()[g.value]===C.value}],"filter-id-==":[Br,[Tr],function(c,d){var g=d[0];return c.id()===g.value}],"filter-type-==":[Br,[an],function(c,d){var g=d[0];return c.geometryType()===g.value}],"filter-<":[Br,[an,Tr],function(c,d){var g=d[0],C=d[1],M=c.properties()[g.value],I=C.value;return typeof M==typeof I&&M<I}],"filter-id-<":[Br,[Tr],function(c,d){var g=d[0],C=c.id(),M=g.value;return typeof C==typeof M&&C<M}],"filter->":[Br,[an,Tr],function(c,d){var g=d[0],C=d[1],M=c.properties()[g.value],I=C.value;return typeof M==typeof I&&M>I}],"filter-id->":[Br,[Tr],function(c,d){var g=d[0],C=c.id(),M=g.value;return typeof C==typeof M&&C>M}],"filter-<=":[Br,[an,Tr],function(c,d){var g=d[0],C=d[1],M=c.properties()[g.value],I=C.value;return typeof M==typeof I&&M<=I}],"filter-id-<=":[Br,[Tr],function(c,d){var g=d[0],C=c.id(),M=g.value;return typeof C==typeof M&&C<=M}],"filter->=":[Br,[an,Tr],function(c,d){var g=d[0],C=d[1],M=c.properties()[g.value],I=C.value;return typeof M==typeof I&&M>=I}],"filter-id->=":[Br,[Tr],function(c,d){var g=d[0],C=c.id(),M=g.value;return typeof C==typeof M&&C>=M}],"filter-has":[Br,[Tr],function(c,d){return d[0].value in c.properties()}],"filter-has-id":[Br,[],function(c){return c.id()!==null&&c.id()!==void 0}],"filter-type-in":[Br,[Pi(an)],function(c,d){return d[0].value.indexOf(c.geometryType())>=0}],"filter-id-in":[Br,[Pi(Tr)],function(c,d){return d[0].value.indexOf(c.id())>=0}],"filter-in-small":[Br,[an,Pi(Tr)],function(c,d){var g=d[0];return d[1].value.indexOf(c.properties()[g.value])>=0}],"filter-in-large":[Br,[an,Pi(Tr)],function(c,d){var g=d[0],C=d[1];return function(M,I,O,z){for(;O<=z;){var G=O+z>>1;if(I[G]===M)return!0;I[G]>M?z=G-1:O=G+1}return!1}(c.properties()[g.value],C.value,0,C.value.length-1)}],all:{type:Br,overloads:[[[Br,Br],function(c,d){var g=d[1];return d[0].evaluate(c)&&g.evaluate(c)}],[Uc(Br),function(c,d){for(var g=0,C=d;g<C.length;g+=1)if(!C[g].evaluate(c))return!1;return!0}]]},any:{type:Br,overloads:[[[Br,Br],function(c,d){var g=d[1];return d[0].evaluate(c)||g.evaluate(c)}],[Uc(Br),function(c,d){for(var g=0,C=d;g<C.length;g+=1)if(C[g].evaluate(c))return!0;return!1}]]},"!":[Br,[Br],function(c,d){return!d[0].evaluate(c)}],"is-supported-script":[Br,[an],function(c,d){var g=c.globals&&c.globals.isSupportedScript;return!g||g(d[0].evaluate(c))}],upcase:[an,[an],function(c,d){return d[0].evaluate(c).toUpperCase()}],downcase:[an,[an],function(c,d){return d[0].evaluate(c).toLowerCase()}],concat:[an,Uc(Tr),function(c,d){return d.map(function(g){return yf(g.evaluate(c))}).join("")}],"resolved-locale":[an,[Sn],function(c,d){return d[0].evaluate(c).resolvedLocale()}]});var xf=function(c,d){this.expression=c,this._warningHistory={},this._evaluator=new wl,this._defaultValue=d?function(g){return g.type==="color"&&Lh(g.default)?new Ni(0,0,0,0):g.type==="color"?Ni.parse(g.default)||null:g.default===void 0?null:g.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function Mp(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Gf}function ld(c,d){var g=new wh(Gf,[],d?function(M){var I={color:$r,string:an,number:Ht,enum:an,boolean:Br,formatted:pi,resolvedImage:oi};return M.type==="array"?Pi(I[M.value]||Tr,M.length):I[M.type]}(d):void 0),C=g.parse(c,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return C?Hf(new xf(C,d)):Vc(g.errors)}xf.prototype.evaluateWithoutErrorHandling=function(c,d,g,C,M,I){return this._evaluator.globals=c,this._evaluator.feature=d,this._evaluator.featureState=g,this._evaluator.canonical=C,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=I,this.expression.evaluate(this._evaluator)},xf.prototype.evaluate=function(c,d,g,C,M,I){this._evaluator.globals=c,this._evaluator.feature=d||null,this._evaluator.featureState=g||null,this._evaluator.canonical=C,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=I||null;try{var O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new po("Expected value to be one of "+Object.keys(this._enumValues).map(function(z){return JSON.stringify(z)}).join(", ")+", but found "+JSON.stringify(O)+" instead.");return O}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console!="undefined"&&console.warn(z.message)),this._defaultValue}};var bf=function(c,d){this.kind=c,this._styleExpression=d,this.isStateDependent=c!=="constant"&&!bh(d.expression)};bf.prototype.evaluateWithoutErrorHandling=function(c,d,g,C,M,I){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,C,M,I)},bf.prototype.evaluate=function(c,d,g,C,M,I){return this._styleExpression.evaluate(c,d,g,C,M,I)};var Ih=function(c,d,g,C){this.kind=c,this.zoomStops=g,this._styleExpression=d,this.isStateDependent=c!=="camera"&&!bh(d.expression),this.interpolationType=C};function sg(c,d){if((c=ld(c,d)).result==="error")return c;var g=c.value.expression,C=xh(g);if(!C&&!lc(d))return Vc([new pr("","data expressions not supported")]);var M=wp(g,["zoom"]);if(!M&&!Sp(d))return Vc([new pr("","zoom expressions not supported")]);var I=function O(z){var G=null;if(z instanceof Vf)G=O(z.result);else if(z instanceof qu)for(var q=0,re=z.args;q<re.length&&!(G=O(re[q]));q+=1);else(z instanceof ea||z instanceof ou)&&z.input instanceof ws&&z.input.name==="zoom"&&(G=z);return G instanceof pr||z.eachChild(function(oe){var ce=O(oe);ce instanceof pr?G=ce:!G&&ce?G=new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):G&&ce&&G!==ce&&(G=new pr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),G}(g);return I||M?I instanceof pr?Vc([I]):I instanceof ou&&!Mh(d)?Vc([new pr("",'"interpolate" expressions cannot be used with this property')]):Hf(I?new Ih(C?"camera":"composite",c.value,I.labels,I instanceof ou?I.interpolation:void 0):new bf(C?"constant":"source",c.value)):Vc([new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ih.prototype.evaluateWithoutErrorHandling=function(c,d,g,C,M,I){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,C,M,I)},Ih.prototype.evaluate=function(c,d,g,C,M,I){return this._styleExpression.evaluate(c,d,g,C,M,I)},Ih.prototype.interpolationFactor=function(c,d,g){return this.interpolationType?ou.interpolationFactor(this.interpolationType,c,d,g):0};var Hl=function(c,d){this._parameters=c,this._specification=d,cr(this,function g(C,M){var I,O,z,G=M.type==="color",q=C.stops&&typeof C.stops[0][0]=="object",re=q||!(q||C.property!==void 0),oe=C.type||(Mh(M)?"exponential":"interval");if(G&&((C=cr({},C)).stops&&(C.stops=C.stops.map(function(fn){return[fn[0],Ni.parse(fn[1])]})),C.default=Ni.parse(C.default?C.default:M.default)),C.colorSpace&&C.colorSpace!=="rgb"&&!mm[C.colorSpace])throw new Error("Unknown color space: "+C.colorSpace);if(oe==="exponential")I=ud;else if(oe==="interval")I=_m;else if(oe==="categorical"){I=Al,O=Object.create(null);for(var ce=0,pe=C.stops;ce<pe.length;ce+=1){var De=pe[ce];O[De[0]]=De[1]}z=typeof C.stops[0][0]}else{if(oe!=="identity")throw new Error('Unknown function type "'+oe+'"');I=Tp}if(q){for(var $e={},tt=[],Ze=0;Ze<C.stops.length;Ze++){var mt=C.stops[Ze],At=mt[0].zoom;$e[At]===void 0&&($e[At]={zoom:At,type:C.type,property:C.property,default:C.default,stops:[]},tt.push(At)),$e[At].stops.push([mt[0].value,mt[1]])}for(var Nt=[],Vt=0,ir=tt;Vt<ir.length;Vt+=1){var Mr=ir[Vt];Nt.push([$e[Mr].zoom,g($e[Mr],M)])}var Wr={name:"linear"};return{kind:"composite",interpolationType:Wr,interpolationFactor:ou.interpolationFactor.bind(void 0,Wr),zoomStops:Nt.map(function(fn){return fn[0]}),evaluate:function(fn,Yn){var gn=fn.zoom;return ud({stops:Nt,base:C.base},M,gn).evaluate(gn,Yn)}}}if(re){var Vn=oe==="exponential"?{name:"exponential",base:C.base!==void 0?C.base:1}:null;return{kind:"camera",interpolationType:Vn,interpolationFactor:ou.interpolationFactor.bind(void 0,Vn),zoomStops:C.stops.map(function(fn){return fn[0]}),evaluate:function(fn){return I(C,M,fn.zoom,O,z)}}}return{kind:"source",evaluate:function(fn,Yn){var gn=Yn&&Yn.properties?Yn.properties[C.property]:void 0;return gn===void 0?Ap(C.default,M.default):I(C,M,gn,O,z)}}}(this._parameters,this._specification))};function jl(c){var d=c.key,g=c.value,C=c.valueSpec||{},M=c.objectElementValidators||{},I=c.style,O=c.styleSpec,z=[],G=Ga(g);if(G!=="object")return[new Ge(d,g,"object expected, "+G+" found")];for(var q in g){var re=q.split(".")[0],oe=C[re]||C["*"],ce=void 0;if(M[re])ce=M[re];else if(C[re])ce=Un;else if(M["*"])ce=M["*"];else{if(!C["*"]){z.push(new Ge(d,g[q],'unknown property "'+q+'"'));continue}ce=Un}z=z.concat(ce({key:(d&&d+".")+q,value:g[q],valueSpec:oe,style:I,styleSpec:O,object:g,objectKey:q},g))}for(var pe in C)M[pe]||C[pe].required&&C[pe].default===void 0&&g[pe]===void 0&&z.push(new Ge(d,g,'missing required property "'+pe+'"'));return z}function xm(c){var d=c.value,g=c.valueSpec,C=c.style,M=c.styleSpec,I=c.key,O=c.arrayElementValidator||Un;if(Ga(d)!=="array")return[new Ge(I,d,"array expected, "+Ga(d)+" found")];if(g.length&&d.length!==g.length)return[new Ge(I,d,"array length "+g.length+" expected, length "+d.length+" found")];if(g["min-length"]&&d.length<g["min-length"])return[new Ge(I,d,"array length at least "+g["min-length"]+" expected, length "+d.length+" found")];var z={type:g.value,values:g.values};M.$version<7&&(z.function=g.function),Ga(g.value)==="object"&&(z=g.value);for(var G=[],q=0;q<d.length;q++)G=G.concat(O({array:d,arrayIndex:q,value:d[q],valueSpec:z,style:C,styleSpec:M,key:I+"["+q+"]"}));return G}function uv(c){var d=c.key,g=c.value,C=c.valueSpec,M=Ga(g);return M==="number"&&g!=g&&(M="NaN"),M!=="number"?[new Ge(d,g,"number expected, "+M+" found")]:"minimum"in C&&g<C.minimum?[new Ge(d,g,g+" is less than the minimum value "+C.minimum)]:"maximum"in C&&g>C.maximum?[new Ge(d,g,g+" is greater than the maximum value "+C.maximum)]:[]}function ug(c){var d,g,C,M=c.valueSpec,I=fr(c.value.type),O={},z=I!=="categorical"&&c.value.property===void 0,G=!z,q=Ga(c.value.stops)==="array"&&Ga(c.value.stops[0])==="array"&&Ga(c.value.stops[0][0])==="object",re=jl({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(pe){if(I==="identity")return[new Ge(pe.key,pe.value,'identity function may not have a "stops" property')];var De=[],$e=pe.value;return De=De.concat(xm({key:pe.key,value:$e,valueSpec:pe.valueSpec,style:pe.style,styleSpec:pe.styleSpec,arrayElementValidator:oe})),Ga($e)==="array"&&$e.length===0&&De.push(new Ge(pe.key,$e,"array must have at least one stop")),De},default:function(pe){return Un({key:pe.key,value:pe.value,valueSpec:M,style:pe.style,styleSpec:pe.styleSpec})}}});return I==="identity"&&z&&re.push(new Ge(c.key,c.value,'missing required property "property"')),I==="identity"||c.value.stops||re.push(new Ge(c.key,c.value,'missing required property "stops"')),I==="exponential"&&c.valueSpec.expression&&!Mh(c.valueSpec)&&re.push(new Ge(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(G&&!lc(c.valueSpec)?re.push(new Ge(c.key,c.value,"property functions not supported")):z&&!Sp(c.valueSpec)&&re.push(new Ge(c.key,c.value,"zoom functions not supported"))),I!=="categorical"&&!q||c.value.property!==void 0||re.push(new Ge(c.key,c.value,'"property" property is required')),re;function oe(pe){var De=[],$e=pe.value,tt=pe.key;if(Ga($e)!=="array")return[new Ge(tt,$e,"array expected, "+Ga($e)+" found")];if($e.length!==2)return[new Ge(tt,$e,"array length 2 expected, length "+$e.length+" found")];if(q){if(Ga($e[0])!=="object")return[new Ge(tt,$e,"object expected, "+Ga($e[0])+" found")];if($e[0].zoom===void 0)return[new Ge(tt,$e,"object stop key must have zoom")];if($e[0].value===void 0)return[new Ge(tt,$e,"object stop key must have value")];if(C&&C>fr($e[0].zoom))return[new Ge(tt,$e[0].zoom,"stop zoom values must appear in ascending order")];fr($e[0].zoom)!==C&&(C=fr($e[0].zoom),g=void 0,O={}),De=De.concat(jl({key:tt+"[0]",value:$e[0],valueSpec:{zoom:{}},style:pe.style,styleSpec:pe.styleSpec,objectElementValidators:{zoom:uv,value:ce}}))}else De=De.concat(ce({key:tt+"[0]",value:$e[0],valueSpec:{},style:pe.style,styleSpec:pe.styleSpec},$e));return Mp($t($e[1]))?De.concat([new Ge(tt+"[1]",$e[1],"expressions are not allowed in function stops.")]):De.concat(Un({key:tt+"[1]",value:$e[1],valueSpec:M,style:pe.style,styleSpec:pe.styleSpec}))}function ce(pe,De){var $e=Ga(pe.value),tt=fr(pe.value),Ze=pe.value!==null?pe.value:De;if(d){if($e!==d)return[new Ge(pe.key,Ze,$e+" stop domain type must match previous stop domain type "+d)]}else d=$e;if($e!=="number"&&$e!=="string"&&$e!=="boolean")return[new Ge(pe.key,Ze,"stop domain value must be a number, string, or boolean")];if($e!=="number"&&I!=="categorical"){var mt="number expected, "+$e+" found";return lc(M)&&I===void 0&&(mt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ge(pe.key,Ze,mt)]}return I!=="categorical"||$e!=="number"||isFinite(tt)&&Math.floor(tt)===tt?I!=="categorical"&&$e==="number"&&g!==void 0&&tt<g?[new Ge(pe.key,Ze,"stop domain values must appear in ascending order")]:(g=tt,I==="categorical"&&tt in O?[new Ge(pe.key,Ze,"stop domain values must be unique")]:(O[tt]=!0,[])):[new Ge(pe.key,Ze,"integer expected, found "+tt)]}}function fl(c){var d=(c.expressionContext==="property"?sg:ld)($t(c.value),c.valueSpec);if(d.result==="error")return d.value.map(function(C){return new Ge(""+c.key+C.key,c.value,C.message)});var g=d.value.expression||d.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!g.outputDefined())return[new Ge(c.key,c.value,'Invalid data expression for "'+c.propertyKey+'". Output values must be contained as literals within the expression.')];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!bh(g))return[new Ge(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!bh(g))return[new Ge(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!wp(g,["zoom","feature-state"]))return[new Ge(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!xh(g))return[new Ge(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function jf(c){var d=c.key,g=c.value,C=c.valueSpec,M=[];return Array.isArray(C.values)?C.values.indexOf(fr(g))===-1&&M.push(new Ge(d,g,"expected one of ["+C.values.join(", ")+"], "+JSON.stringify(g)+" found")):Object.keys(C.values).indexOf(fr(g))===-1&&M.push(new Ge(d,g,"expected one of ["+Object.keys(C.values).join(", ")+"], "+JSON.stringify(g)+" found")),M}function lv(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(var d=0,g=c.slice(1);d<g.length;d+=1){var C=g[d];if(!lv(C)&&typeof C!="boolean")return!1}return!0;default:return!0}}Hl.deserialize=function(c){return new Hl(c._parameters,c._specification)},Hl.serialize=function(c){return{_parameters:c._parameters,_specification:c._specification}};var lg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cv(c){if(c==null)return{filter:function(){return!0},needGeometry:!1};lv(c)||(c=Qu(c));var d=ld(c,lg);if(d.result==="error")throw new Error(d.value.map(function(g){return g.key+": "+g.message}).join(", "));return{filter:function(g,C,M){return d.value.evaluate(g,C,{},M)},needGeometry:function g(C){if(!Array.isArray(C))return!1;if(C[0]==="within")return!0;for(var M=1;M<C.length;M++)if(g(C[M]))return!0;return!1}(c)}}function Gc(c,d){return c<d?-1:c>d?1:0}function Qu(c){if(!c)return!0;var d,g=c[0];return c.length<=1?g!=="any":g==="=="?cd(c[1],c[2],"=="):g==="!="?cg(cd(c[1],c[2],"==")):g==="<"||g===">"||g==="<="||g===">="?cd(c[1],c[2],g):g==="any"?(d=c.slice(1),["any"].concat(d.map(Qu))):g==="all"?["all"].concat(c.slice(1).map(Qu)):g==="none"?["all"].concat(c.slice(1).map(Qu).map(cg)):g==="in"?fd(c[1],c.slice(2)):g==="!in"?cg(fd(c[1],c.slice(2))):g==="has"?Gy(c[1]):g==="!has"?cg(Gy(c[1])):g!=="within"||c}function cd(c,d,g){switch(c){case"$type":return["filter-type-"+g,d];case"$id":return["filter-id-"+g,d];default:return["filter-"+g,c,d]}}function fd(c,d){if(d.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(g){return typeof g!=typeof d[0]})?["filter-in-large",c,["literal",d.sort(Gc)]]:["filter-in-small",c,["literal",d]]}}function Gy(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function cg(c){return["!",c]}function bm(c){return lv($t(c.value))?fl(cr({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(g){var C=g.value,M=g.key;if(Ga(C)!=="array")return[new Ge(M,C,"array expected, "+Ga(C)+" found")];var I,O=g.styleSpec,z=[];if(C.length<1)return[new Ge(M,C,"filter array must have at least 1 element")];switch(z=z.concat(jf({key:M+"[0]",value:C[0],valueSpec:O.filter_operator,style:g.style,styleSpec:g.styleSpec})),fr(C[0])){case"<":case"<=":case">":case">=":C.length>=2&&fr(C[1])==="$type"&&z.push(new Ge(M,C,'"$type" cannot be use with operator "'+C[0]+'"'));case"==":case"!=":C.length!==3&&z.push(new Ge(M,C,'filter array for operator "'+C[0]+'" must have 3 elements'));case"in":case"!in":C.length>=2&&(I=Ga(C[1]))!=="string"&&z.push(new Ge(M+"[1]",C[1],"string expected, "+I+" found"));for(var G=2;G<C.length;G++)I=Ga(C[G]),fr(C[1])==="$type"?z=z.concat(jf({key:M+"["+G+"]",value:C[G],valueSpec:O.geometry_type,style:g.style,styleSpec:g.styleSpec})):I!=="string"&&I!=="number"&&I!=="boolean"&&z.push(new Ge(M+"["+G+"]",C[G],"string, number, or boolean expected, "+I+" found"));break;case"any":case"all":case"none":for(var q=1;q<C.length;q++)z=z.concat(d({key:M+"["+q+"]",value:C[q],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":I=Ga(C[1]),C.length!==2?z.push(new Ge(M,C,'filter array for "'+C[0]+'" operator must have 2 elements')):I!=="string"&&z.push(new Ge(M+"[1]",C[1],"string expected, "+I+" found"));break;case"within":I=Ga(C[1]),C.length!==2?z.push(new Ge(M,C,'filter array for "'+C[0]+'" operator must have 2 elements')):I!=="object"&&z.push(new Ge(M+"[1]",C[1],"object expected, "+I+" found"))}return z}(c)}function fv(c,d){var g=c.key,C=c.style,M=c.styleSpec,I=c.value,O=c.objectKey,z=M[d+"_"+c.layerType];if(!z)return[];var G=O.match(/^(.*)-transition$/);if(d==="paint"&&G&&z[G[1]]&&z[G[1]].transition)return Un({key:g,value:I,valueSpec:M.transition,style:C,styleSpec:M});var q,re=c.valueSpec||z[O];if(!re)return[new Ge(g,I,'unknown property "'+O+'"')];if(Ga(I)==="string"&&lc(re)&&!re.tokens&&(q=/^{([^}]+)}$/.exec(I)))return[new Ge(g,I,'"'+O+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(q[1])+" }`.")];var oe=[];return c.layerType==="symbol"&&(O==="text-field"&&C&&!C.glyphs&&oe.push(new Ge(g,I,'use of "text-field" requires a style "glyphs" property')),O==="text-font"&&Lh($t(I))&&fr(I.type)==="identity"&&oe.push(new Ge(g,I,'"text-font" does not support identity functions'))),oe.concat(Un({key:c.key,value:I,valueSpec:re,style:C,styleSpec:M,expressionContext:"property",propertyType:d,propertyKey:O}))}function kh(c){return fv(c,"paint")}function bt(c){return fv(c,"layout")}function lr(c){var d=[],g=c.value,C=c.key,M=c.style,I=c.styleSpec;g.type||g.ref||d.push(new Ge(C,g,'either "type" or "ref" is required'));var O,z=fr(g.type),G=fr(g.ref);if(g.id)for(var q=fr(g.id),re=0;re<c.arrayIndex;re++){var oe=M.layers[re];fr(oe.id)===q&&d.push(new Ge(C,g.id,'duplicate layer id "'+g.id+'", previously used at line '+oe.id.__line__))}if("ref"in g)["type","source","source-layer","filter","layout"].forEach(function(De){De in g&&d.push(new Ge(C,g[De],'"'+De+'" is prohibited for ref layers'))}),M.layers.forEach(function(De){fr(De.id)===G&&(O=De)}),O?O.ref?d.push(new Ge(C,g.ref,"ref cannot reference another ref layer")):z=fr(O.type):d.push(new Ge(C,g.ref,'ref layer "'+G+'" not found'));else if(z!=="background")if(g.source){var ce=M.sources&&M.sources[g.source],pe=ce&&fr(ce.type);ce?pe==="vector"&&z==="raster"?d.push(new Ge(C,g.source,'layer "'+g.id+'" requires a raster source')):pe==="raster"&&z!=="raster"?d.push(new Ge(C,g.source,'layer "'+g.id+'" requires a vector source')):pe!=="vector"||g["source-layer"]?pe==="raster-dem"&&z!=="hillshade"?d.push(new Ge(C,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):z!=="line"||!g.paint||!g.paint["line-gradient"]||pe==="geojson"&&ce.lineMetrics||d.push(new Ge(C,g,'layer "'+g.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new Ge(C,g,'layer "'+g.id+'" must specify a "source-layer"')):d.push(new Ge(C,g.source,'source "'+g.source+'" not found'))}else d.push(new Ge(C,g,'missing required property "source"'));return d=d.concat(jl({key:C,value:g,valueSpec:I.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Un({key:C+".type",value:g.type,valueSpec:I.layer.type,style:c.style,styleSpec:c.styleSpec,object:g,objectKey:"type"})},filter:bm,layout:function(De){return jl({layer:g,key:De.key,value:De.value,style:De.style,styleSpec:De.styleSpec,objectElementValidators:{"*":function($e){return bt(cr({layerType:z},$e))}}})},paint:function(De){return jl({layer:g,key:De.key,value:De.value,style:De.style,styleSpec:De.styleSpec,objectElementValidators:{"*":function($e){return kh(cr({layerType:z},$e))}}})}}}))}function Xt(c){var d=c.value,g=c.key,C=Ga(d);return C!=="string"?[new Ge(g,d,"string expected, "+C+" found")]:[]}var Jr={promoteId:function(c){var d=c.key,g=c.value;if(Ga(g)==="string")return Xt({key:d,value:g});var C=[];for(var M in g)C.push.apply(C,Xt({key:d+"."+M,value:g[M]}));return C}};function Ii(c){var d=c.value,g=c.key,C=c.styleSpec,M=c.style;if(!d.type)return[new Ge(g,d,'"type" is required')];var I,O=fr(d.type);switch(O){case"vector":case"raster":case"raster-dem":return jl({key:g,value:d,valueSpec:C["source_"+O.replace("-","_")],style:c.style,styleSpec:C,objectElementValidators:Jr});case"geojson":if(I=jl({key:g,value:d,valueSpec:C.source_geojson,style:M,styleSpec:C,objectElementValidators:Jr}),d.cluster)for(var z in d.clusterProperties){var G=d.clusterProperties[z],q=G[0],re=typeof q=="string"?[q,["accumulated"],["get",z]]:q;I.push.apply(I,fl({key:g+"."+z+".map",value:G[1],expressionContext:"cluster-map"})),I.push.apply(I,fl({key:g+"."+z+".reduce",value:re,expressionContext:"cluster-reduce"}))}return I;case"video":return jl({key:g,value:d,valueSpec:C.source_video,style:M,styleSpec:C});case"image":return jl({key:g,value:d,valueSpec:C.source_image,style:M,styleSpec:C});case"canvas":return[new Ge(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return jf({key:g+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:M,styleSpec:C})}}function ga(c){var d=c.value,g=c.styleSpec,C=g.light,M=c.style,I=[],O=Ga(d);if(d===void 0)return I;if(O!=="object")return I.concat([new Ge("light",d,"object expected, "+O+" found")]);for(var z in d){var G=z.match(/^(.*)-transition$/);I=I.concat(G&&C[G[1]]&&C[G[1]].transition?Un({key:z,value:d[z],valueSpec:g.transition,style:M,styleSpec:g}):C[z]?Un({key:z,value:d[z],valueSpec:C[z],style:M,styleSpec:g}):[new Ge(z,d[z],'unknown property "'+z+'"')])}return I}var To={"*":function(){return[]},array:xm,boolean:function(c){var d=c.value,g=c.key,C=Ga(d);return C!=="boolean"?[new Ge(g,d,"boolean expected, "+C+" found")]:[]},number:uv,color:function(c){var d=c.key,g=c.value,C=Ga(g);return C!=="string"?[new Ge(d,g,"color expected, "+C+" found")]:bi(g)===null?[new Ge(d,g,'color expected, "'+g+'" found')]:[]},constants:wt,enum:jf,filter:bm,function:ug,layer:lr,object:jl,source:Ii,light:ga,string:Xt,formatted:function(c){return Xt(c).length===0?[]:fl(c)},resolvedImage:function(c){return Xt(c).length===0?[]:fl(c)}};function Un(c){var d=c.value,g=c.valueSpec,C=c.styleSpec;return g.expression&&Lh(fr(d))?ug(c):g.expression&&Mp($t(d))?fl(c):g.type&&To[g.type]?To[g.type](c):jl(cr({},c,{valueSpec:g.type?C[g.type]:g}))}function qa(c){var d=c.value,g=c.key,C=Xt(c);return C.length||(d.indexOf("{fontstack}")===-1&&C.push(new Ge(g,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&C.push(new Ge(g,d,'"glyphs" url must include a "{range}" token'))),C}function Ju(c,d){d===void 0&&(d=_e);var g=[];return g=g.concat(Un({key:"",value:c,valueSpec:d.$root,styleSpec:d,style:c,objectElementValidators:{glyphs:qa,"*":function(){return[]}}})),c.constants&&(g=g.concat(wt({key:"constants",value:c.constants,style:c,styleSpec:d}))),el(g)}function el(c){return[].concat(c).sort(function(d,g){return d.line-g.line})}function Wf(c){return function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];return el(c.apply(this,d))}}Ju.source=Wf(Ii),Ju.light=Wf(ga),Ju.layer=Wf(lr),Ju.filter=Wf(bm),Ju.paintProperty=Wf(kh),Ju.layoutProperty=Wf(bt);var hv=Ju,hd=hv.light,fg=hv.paintProperty,Ph=hv.layoutProperty;function Fa(c,d){var g=!1;if(d&&d.length)for(var C=0,M=d;C<M.length;C+=1)c.fire(new it(new Error(M[C].message))),g=!0;return g}var wf=Do;function Do(c,d,g){var C=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var M=new Int32Array(this.arrayBuffer);c=M[0],this.d=(d=M[1])+2*(g=M[2]);for(var I=0;I<this.d*this.d;I++){var O=M[3+I],z=M[3+I+1];C.push(O===z?null:M.subarray(O,z))}var G=M[3+C.length+1];this.keys=M.subarray(M[3+C.length],G),this.bboxes=M.subarray(G),this.insert=this._insertReadonly}else{this.d=d+2*g;for(var q=0;q<this.d*this.d;q++)C.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=c,this.padding=g,this.scale=d/c,this.uid=0;var re=g/d*c;this.min=-re,this.max=c+re}Do.prototype.insert=function(c,d,g,C,M){this._forEachCell(d,g,C,M,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(C),this.bboxes.push(M)},Do.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Do.prototype._insertCell=function(c,d,g,C,M,I){this.cells[M].push(I)},Do.prototype.query=function(c,d,g,C,M){var I=this.min,O=this.max;if(c<=I&&d<=I&&O<=g&&O<=C&&!M)return Array.prototype.slice.call(this.keys);var z=[];return this._forEachCell(c,d,g,C,this._queryCell,z,{},M),z},Do.prototype._queryCell=function(c,d,g,C,M,I,O,z){var G=this.cells[M];if(G!==null)for(var q=this.keys,re=this.bboxes,oe=0;oe<G.length;oe++){var ce=G[oe];if(O[ce]===void 0){var pe=4*ce;(z?z(re[pe+0],re[pe+1],re[pe+2],re[pe+3]):c<=re[pe+2]&&d<=re[pe+3]&&g>=re[pe+0]&&C>=re[pe+1])?(O[ce]=!0,I.push(q[ce])):O[ce]=!1}}},Do.prototype._forEachCell=function(c,d,g,C,M,I,O,z){for(var G=this._convertToCellCoord(c),q=this._convertToCellCoord(d),re=this._convertToCellCoord(g),oe=this._convertToCellCoord(C),ce=G;ce<=re;ce++)for(var pe=q;pe<=oe;pe++){var De=this.d*pe+ce;if((!z||z(this._convertFromCellCoord(ce),this._convertFromCellCoord(pe),this._convertFromCellCoord(ce+1),this._convertFromCellCoord(pe+1)))&&M.call(this,c,d,g,C,De,I,O,z))return}},Do.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},Do.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},Do.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,d=3+this.cells.length+1+1,g=0,C=0;C<this.cells.length;C++)g+=this.cells[C].length;var M=new Int32Array(d+g+this.keys.length+this.bboxes.length);M[0]=this.extent,M[1]=this.n,M[2]=this.padding;for(var I=d,O=0;O<c.length;O++){var z=c[O];M[3+O]=I,M.set(z,I),I+=z.length}return M[3+c.length]=I,M.set(this.keys,I),M[3+c.length+1]=I+=this.keys.length,M.set(this.bboxes,I),I+=this.bboxes.length,M.buffer};var Rh=p.ImageData,pv=p.ImageBitmap,Da={};function dn(c,d,g){g===void 0&&(g={}),Object.defineProperty(d,"_classRegistryKey",{value:c,writeable:!1}),Da[c]={klass:d,omit:g.omit||[],shallow:g.shallow||[]}}for(var bu in dn("Object",Object),wf.serialize=function(c,d){var g=c.toArrayBuffer();return d&&d.push(g),{buffer:g}},wf.deserialize=function(c){return new wf(c.buffer)},dn("Grid",wf),dn("Color",Ni),dn("Error",Error),dn("ResolvedImage",au),dn("StylePropertyFunction",Hl),dn("StyleExpression",xf,{omit:["_evaluator"]}),dn("ZoomDependentExpression",Ih),dn("ZoomConstantExpression",bf),dn("CompoundExpression",ws,{omit:["_evaluate"]}),Gf)Gf[bu]._classRegistryKey||dn("Expression_"+bu,Gf[bu]);function cc(c){return c&&typeof ArrayBuffer!="undefined"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Cf(c){return pv&&c instanceof pv}function Wl(c,d){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(cc(c)||Cf(c))return d&&d.push(c),c;if(ArrayBuffer.isView(c)){var g=c;return d&&d.push(g.buffer),g}if(c instanceof Rh)return d&&d.push(c.data.buffer),c;if(Array.isArray(c)){for(var C=[],M=0,I=c;M<I.length;M+=1)C.push(Wl(I[M],d));return C}if(typeof c=="object"){var O=c.constructor,z=O._classRegistryKey;if(!z)throw new Error("can't serialize object of unregistered class");var G=O.serialize?O.serialize(c,d):{};if(!O.serialize){for(var q in c)if(c.hasOwnProperty(q)&&!(Da[z].omit.indexOf(q)>=0)){var re=c[q];G[q]=Da[z].shallow.indexOf(q)>=0?re:Wl(re,d)}c instanceof Error&&(G.message=c.message)}if(G.$name)throw new Error("$name property is reserved for worker serialization logic.");return z!=="Object"&&(G.$name=z),G}throw new Error("can't serialize object of type "+typeof c)}function wu(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||cc(c)||Cf(c)||ArrayBuffer.isView(c)||c instanceof Rh)return c;if(Array.isArray(c))return c.map(wu);if(typeof c=="object"){var d=c.$name||"Object",g=Da[d].klass;if(!g)throw new Error("can't deserialize unregistered class "+d);if(g.deserialize)return g.deserialize(c);for(var C=Object.create(g.prototype),M=0,I=Object.keys(c);M<I.length;M+=1){var O=I[M];if(O!=="$name"){var z=c[O];C[O]=Da[d].shallow.indexOf(O)>=0?z:wu(z)}}return C}throw new Error("can't deserialize object of type "+typeof c)}var dv=function(){this.first=!0};dv.prototype.update=function(c,d){var g=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=d),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=g,!0))};var Yr={"Latin-1 Supplement":function(c){return c>=128&&c<=255},Arabic:function(c){return c>=1536&&c<=1791},"Arabic Supplement":function(c){return c>=1872&&c<=1919},"Arabic Extended-A":function(c){return c>=2208&&c<=2303},"Hangul Jamo":function(c){return c>=4352&&c<=4607},"Unified Canadian Aboriginal Syllabics":function(c){return c>=5120&&c<=5759},Khmer:function(c){return c>=6016&&c<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(c){return c>=6320&&c<=6399},"General Punctuation":function(c){return c>=8192&&c<=8303},"Letterlike Symbols":function(c){return c>=8448&&c<=8527},"Number Forms":function(c){return c>=8528&&c<=8591},"Miscellaneous Technical":function(c){return c>=8960&&c<=9215},"Control Pictures":function(c){return c>=9216&&c<=9279},"Optical Character Recognition":function(c){return c>=9280&&c<=9311},"Enclosed Alphanumerics":function(c){return c>=9312&&c<=9471},"Geometric Shapes":function(c){return c>=9632&&c<=9727},"Miscellaneous Symbols":function(c){return c>=9728&&c<=9983},"Miscellaneous Symbols and Arrows":function(c){return c>=11008&&c<=11263},"CJK Radicals Supplement":function(c){return c>=11904&&c<=12031},"Kangxi Radicals":function(c){return c>=12032&&c<=12255},"Ideographic Description Characters":function(c){return c>=12272&&c<=12287},"CJK Symbols and Punctuation":function(c){return c>=12288&&c<=12351},Hiragana:function(c){return c>=12352&&c<=12447},Katakana:function(c){return c>=12448&&c<=12543},Bopomofo:function(c){return c>=12544&&c<=12591},"Hangul Compatibility Jamo":function(c){return c>=12592&&c<=12687},Kanbun:function(c){return c>=12688&&c<=12703},"Bopomofo Extended":function(c){return c>=12704&&c<=12735},"CJK Strokes":function(c){return c>=12736&&c<=12783},"Katakana Phonetic Extensions":function(c){return c>=12784&&c<=12799},"Enclosed CJK Letters and Months":function(c){return c>=12800&&c<=13055},"CJK Compatibility":function(c){return c>=13056&&c<=13311},"CJK Unified Ideographs Extension A":function(c){return c>=13312&&c<=19903},"Yijing Hexagram Symbols":function(c){return c>=19904&&c<=19967},"CJK Unified Ideographs":function(c){return c>=19968&&c<=40959},"Yi Syllables":function(c){return c>=40960&&c<=42127},"Yi Radicals":function(c){return c>=42128&&c<=42191},"Hangul Jamo Extended-A":function(c){return c>=43360&&c<=43391},"Hangul Syllables":function(c){return c>=44032&&c<=55215},"Hangul Jamo Extended-B":function(c){return c>=55216&&c<=55295},"Private Use Area":function(c){return c>=57344&&c<=63743},"CJK Compatibility Ideographs":function(c){return c>=63744&&c<=64255},"Arabic Presentation Forms-A":function(c){return c>=64336&&c<=65023},"Vertical Forms":function(c){return c>=65040&&c<=65055},"CJK Compatibility Forms":function(c){return c>=65072&&c<=65103},"Small Form Variants":function(c){return c>=65104&&c<=65135},"Arabic Presentation Forms-B":function(c){return c>=65136&&c<=65279},"Halfwidth and Fullwidth Forms":function(c){return c>=65280&&c<=65519}};function Hc(c){for(var d=0,g=c;d<g.length;d+=1)if(Cs(g[d].charCodeAt(0)))return!0;return!1}function Cs(c){return!(c!==746&&c!==747&&(c<4352||!(Yr["Bopomofo Extended"](c)||Yr.Bopomofo(c)||Yr["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Yr["CJK Compatibility Ideographs"](c)||Yr["CJK Compatibility"](c)||Yr["CJK Radicals Supplement"](c)||Yr["CJK Strokes"](c)||!(!Yr["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Yr["CJK Unified Ideographs Extension A"](c)||Yr["CJK Unified Ideographs"](c)||Yr["Enclosed CJK Letters and Months"](c)||Yr["Hangul Compatibility Jamo"](c)||Yr["Hangul Jamo Extended-A"](c)||Yr["Hangul Jamo Extended-B"](c)||Yr["Hangul Jamo"](c)||Yr["Hangul Syllables"](c)||Yr.Hiragana(c)||Yr["Ideographic Description Characters"](c)||Yr.Kanbun(c)||Yr["Kangxi Radicals"](c)||Yr["Katakana Phonetic Extensions"](c)||Yr.Katakana(c)&&c!==12540||!(!Yr["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Yr["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Yr["Unified Canadian Aboriginal Syllabics"](c)||Yr["Unified Canadian Aboriginal Syllabics Extended"](c)||Yr["Vertical Forms"](c)||Yr["Yijing Hexagram Symbols"](c)||Yr["Yi Syllables"](c)||Yr["Yi Radicals"](c))))}function Oh(c){return!(Cs(c)||function(d){return!!(Yr["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||Yr["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||Yr["Letterlike Symbols"](d)||Yr["Number Forms"](d)||Yr["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||Yr["Control Pictures"](d)&&d!==9251||Yr["Optical Character Recognition"](d)||Yr["Enclosed Alphanumerics"](d)||Yr["Geometric Shapes"](d)||Yr["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||Yr["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||Yr["CJK Symbols and Punctuation"](d)||Yr.Katakana(d)||Yr["Private Use Area"](d)||Yr["CJK Compatibility Forms"](d)||Yr["Small Form Variants"](d)||Yr["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(c))}function su(c){return c>=1424&&c<=2303||Yr["Arabic Presentation Forms-A"](c)||Yr["Arabic Presentation Forms-B"](c)}function ds(c,d){return!(!d&&su(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Yr.Khmer(c))}function vv(c){for(var d=0,g=c;d<g.length;d+=1)if(su(g[d].charCodeAt(0)))return!0;return!1}var gv=null,Tl="unavailable",fc=null,mv=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Tl="error"),gv&&gv(c)};function Lp(){yv.fire(new Ne("pluginStateChange",{pluginStatus:Tl,pluginURL:fc}))}var yv=new pt,_v=function(){return Tl},Xl=function(){if(Tl!=="deferred"||!fc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Tl="loading",Lp(),fc&&mf({url:fc},function(c){c?mv(c):(Tl="loaded",Lp())})},Ml={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Tl==="loaded"||Ml.applyArabicShaping!=null},isLoading:function(){return Tl==="loading"},setState:function(c){Tl=c.pluginStatus,fc=c.pluginURL},isParsed:function(){return Ml.applyArabicShaping!=null&&Ml.processBidirectionalText!=null&&Ml.processStyledBidirectionalText!=null},getPluginURL:function(){return fc}},ti=function(c,d){this.zoom=c,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new dv,this.transition={})};ti.prototype.isSupportedScript=function(c){return function(d,g){for(var C=0,M=d;C<M.length;C+=1)if(!ds(M[C].charCodeAt(0),g))return!1;return!0}(c,Ml.isLoaded())},ti.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ti.prototype.getCrossfadeParameters=function(){var c=this.zoom,d=c-Math.floor(c),g=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*d}};var Bo=function(c,d){this.property=c,this.value=d,this.expression=function(g,C){if(Lh(g))return new Hl(g,C);if(Mp(g)){var M=sg(g,C);if(M.result==="error")throw new Error(M.value.map(function(O){return O.key+": "+O.message}).join(", "));return M.value}var I=g;return typeof g=="string"&&C.type==="color"&&(I=Ni.parse(g)),{kind:"constant",evaluate:function(){return I}}}(d===void 0?c.specification.default:d,c.specification)};Bo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Bo.prototype.possiblyEvaluate=function(c,d,g){return this.property.possiblyEvaluate(this,c,d,g)};var Yl=function(c){this.property=c,this.value=new Bo(c,void 0)};Yl.prototype.transitioned=function(c,d){return new jc(this.property,this.value,d,L({},c.transition,this.transition),c.now)},Yl.prototype.untransitioned=function(){return new jc(this.property,this.value,null,{},0)};var Cu=function(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)};Cu.prototype.getValue=function(c){return W(this._values[c].value.value)},Cu.prototype.setValue=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new Yl(this._values[c].property)),this._values[c].value=new Bo(this._values[c].property,d===null?void 0:W(d))},Cu.prototype.getTransition=function(c){return W(this._values[c].transition)},Cu.prototype.setTransition=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new Yl(this._values[c].property)),this._values[c].transition=W(d)||void 0},Cu.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var C=g[d],M=this.getValue(C);M!==void 0&&(c[C]=M);var I=this.getTransition(C);I!==void 0&&(c[C+"-transition"]=I)}return c},Cu.prototype.transitioned=function(c,d){for(var g=new Fh(this._properties),C=0,M=Object.keys(this._values);C<M.length;C+=1){var I=M[C];g._values[I]=this._values[I].transitioned(c,d._values[I])}return g},Cu.prototype.untransitioned=function(){for(var c=new Fh(this._properties),d=0,g=Object.keys(this._values);d<g.length;d+=1){var C=g[d];c._values[C]=this._values[C].untransitioned()}return c};var jc=function(c,d,g,C,M){this.property=c,this.value=d,this.begin=M+C.delay||0,this.end=this.begin+C.duration||0,c.specification.transition&&(C.delay||C.duration)&&(this.prior=g)};jc.prototype.possiblyEvaluate=function(c,d,g){var C=c.now||0,M=this.value.possiblyEvaluate(c,d,g),I=this.prior;if(I){if(C>this.end)return this.prior=null,M;if(this.value.isDataDriven())return this.prior=null,M;if(C<this.begin)return I.possiblyEvaluate(c,d,g);var O=(C-this.begin)/(this.end-this.begin);return this.property.interpolate(I.possiblyEvaluate(c,d,g),M,function(z){if(z<=0)return 0;if(z>=1)return 1;var G=z*z,q=G*z;return 4*(z<.5?q:3*(z-G)+q-.75)}(O))}return M};var Fh=function(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)};Fh.prototype.possiblyEvaluate=function(c,d,g){for(var C=new Dh(this._properties),M=0,I=Object.keys(this._values);M<I.length;M+=1){var O=I[M];C._values[O]=this._values[O].possiblyEvaluate(c,d,g)}return C},Fh.prototype.hasTransition=function(){for(var c=0,d=Object.keys(this._values);c<d.length;c+=1)if(this._values[d[c]].prior)return!0;return!1};var Xs=function(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)};Xs.prototype.getValue=function(c){return W(this._values[c].value)},Xs.prototype.setValue=function(c,d){this._values[c]=new Bo(this._values[c].property,d===null?void 0:W(d))},Xs.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var C=g[d],M=this.getValue(C);M!==void 0&&(c[C]=M)}return c},Xs.prototype.possiblyEvaluate=function(c,d,g){for(var C=new Dh(this._properties),M=0,I=Object.keys(this._values);M<I.length;M+=1){var O=I[M];C._values[O]=this._values[O].possiblyEvaluate(c,d,g)}return C};var vs=function(c,d,g){this.property=c,this.value=d,this.parameters=g};vs.prototype.isConstant=function(){return this.value.kind==="constant"},vs.prototype.constantOr=function(c){return this.value.kind==="constant"?this.value.value:c},vs.prototype.evaluate=function(c,d,g,C){return this.property.evaluate(this.value,this.parameters,c,d,g,C)};var Dh=function(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)};Dh.prototype.get=function(c){return this._values[c]};var Pn=function(c){this.specification=c};Pn.prototype.possiblyEvaluate=function(c,d){return c.expression.evaluate(d)},Pn.prototype.interpolate=function(c,d,g){var C=Cp[this.specification.type];return C?C(c,d,g):c};var _n=function(c,d){this.specification=c,this.overrides=d};_n.prototype.possiblyEvaluate=function(c,d,g,C){return new vs(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(d,null,{},g,C)}:c.expression,d)},_n.prototype.interpolate=function(c,d,g){if(c.value.kind!=="constant"||d.value.kind!=="constant")return c;if(c.value.value===void 0||d.value.value===void 0)return new vs(this,{kind:"constant",value:void 0},c.parameters);var C=Cp[this.specification.type];return C?new vs(this,{kind:"constant",value:C(c.value.value,d.value.value,g)},c.parameters):c},_n.prototype.evaluate=function(c,d,g,C,M,I){return c.kind==="constant"?c.value:c.evaluate(d,g,C,M,I)};var Xf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,C,M,I){if(g.value===void 0)return new vs(this,{kind:"constant",value:void 0},C);if(g.expression.kind==="constant"){var O=g.expression.evaluate(C,null,{},M,I),z=g.property.specification.type==="resolvedImage"&&typeof O!="string"?O.name:O,G=this._calculate(z,z,z,C);return new vs(this,{kind:"constant",value:G},C)}if(g.expression.kind==="camera"){var q=this._calculate(g.expression.evaluate({zoom:C.zoom-1}),g.expression.evaluate({zoom:C.zoom}),g.expression.evaluate({zoom:C.zoom+1}),C);return new vs(this,{kind:"constant",value:q},C)}return new vs(this,g.expression,C)},d.prototype.evaluate=function(g,C,M,I,O,z){if(g.kind==="source"){var G=g.evaluate(C,M,I,O,z);return this._calculate(G,G,G,C)}return g.kind==="composite"?this._calculate(g.evaluate({zoom:Math.floor(C.zoom)-1},M,I),g.evaluate({zoom:Math.floor(C.zoom)},M,I),g.evaluate({zoom:Math.floor(C.zoom)+1},M,I),C):g.value},d.prototype._calculate=function(g,C,M,I){return I.zoom>I.zoomHistory.lastIntegerZoom?{from:g,to:C}:{from:M,to:C}},d.prototype.interpolate=function(g){return g},d}(_n),Ys=function(c){this.specification=c};Ys.prototype.possiblyEvaluate=function(c,d,g,C){if(c.value!==void 0){if(c.expression.kind==="constant"){var M=c.expression.evaluate(d,null,{},g,C);return this._calculate(M,M,M,d)}return this._calculate(c.expression.evaluate(new ti(Math.floor(d.zoom-1),d)),c.expression.evaluate(new ti(Math.floor(d.zoom),d)),c.expression.evaluate(new ti(Math.floor(d.zoom+1),d)),d)}},Ys.prototype._calculate=function(c,d,g,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:c,to:d}:{from:g,to:d}},Ys.prototype.interpolate=function(c){return c};var Ou=function(c){this.specification=c};Ou.prototype.possiblyEvaluate=function(c,d,g,C){return!!c.expression.evaluate(d,null,{},g,C)},Ou.prototype.interpolate=function(){return!1};var uu=function(c){for(var d in this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],c){var g=c[d];g.specification.overridable&&this.overridableProperties.push(d);var C=this.defaultPropertyValues[d]=new Bo(g,void 0),M=this.defaultTransitionablePropertyValues[d]=new Yl(g);this.defaultTransitioningPropertyValues[d]=M.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=C.possiblyEvaluate({})}};dn("DataDrivenProperty",_n),dn("DataConstantProperty",Pn),dn("CrossFadedDataDrivenProperty",Xf),dn("CrossFadedProperty",Ys),dn("ColorRampProperty",Ou);var Wc=function(c){function d(g,C){if(c.call(this),this.id=g.id,this.type=g.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},g.type!=="custom"&&(this.metadata=(g=g).metadata,this.minzoom=g.minzoom,this.maxzoom=g.maxzoom,g.type!=="background"&&(this.source=g.source,this.sourceLayer=g["source-layer"],this.filter=g.filter),C.layout&&(this._unevaluatedLayout=new Xs(C.layout)),C.paint)){for(var M in this._transitionablePaint=new Cu(C.paint),g.paint)this.setPaintProperty(M,g.paint[M],{validate:!1});for(var I in g.layout)this.setLayoutProperty(I,g.layout[I],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Dh(C.paint)}}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(g){return g==="visibility"?this.visibility:this._unevaluatedLayout.getValue(g)},d.prototype.setLayoutProperty=function(g,C,M){M===void 0&&(M={}),C!=null&&this._validate(Ph,"layers."+this.id+".layout."+g,g,C,M)||(g!=="visibility"?this._unevaluatedLayout.setValue(g,C):this.visibility=C)},d.prototype.getPaintProperty=function(g){return H(g,"-transition")?this._transitionablePaint.getTransition(g.slice(0,-11)):this._transitionablePaint.getValue(g)},d.prototype.setPaintProperty=function(g,C,M){if(M===void 0&&(M={}),C!=null&&this._validate(fg,"layers."+this.id+".paint."+g,g,C,M))return!1;if(H(g,"-transition"))return this._transitionablePaint.setTransition(g.slice(0,-11),C||void 0),!1;var I=this._transitionablePaint._values[g],O=I.property.specification["property-type"]==="cross-faded-data-driven",z=I.value.isDataDriven(),G=I.value;this._transitionablePaint.setValue(g,C),this._handleSpecialPaintPropertyUpdate(g);var q=this._transitionablePaint._values[g].value;return q.isDataDriven()||z||O||this._handleOverridablePaintPropertyUpdate(g,G,q)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){},d.prototype._handleOverridablePaintPropertyUpdate=function(g,C,M){return!1},d.prototype.isHidden=function(g){return!!(this.minzoom&&g<this.minzoom)||!!(this.maxzoom&&g>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(g){this._transitioningPaint=this._transitionablePaint.transitioned(g,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(g,C){g.getCrossfadeParameters&&(this._crossfadeParameters=g.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(g,void 0,C)),this.paint=this._transitioningPaint.possiblyEvaluate(g,void 0,C)},d.prototype.serialize=function(){var g={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(g.layout=g.layout||{},g.layout.visibility=this.visibility),U(g,function(C,M){return!(C===void 0||M==="layout"&&!Object.keys(C).length||M==="paint"&&!Object.keys(C).length)})},d.prototype._validate=function(g,C,M,I,O){return O===void 0&&(O={}),(!O||O.validate!==!1)&&Fa(this,g.call(hv,{key:C,layerType:this.type,objectKey:M,value:I,styleSpec:_e,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var g in this.paint._values){var C=this.paint.get(g);if(C instanceof vs&&lc(C.property.specification)&&(C.value.kind==="source"||C.value.kind==="composite")&&C.value.isStateDependent)return!0}return!1},d}(pt),hg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ll=function(c,d){this._structArray=c,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},La=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Es(c,d){d===void 0&&(d=1);var g=0,C=0;return{members:c.map(function(M){var I=hg[M.type].BYTES_PER_ELEMENT,O=g=Il(g,Math.max(d,I)),z=M.components||1;return C=Math.max(C,I),g+=I*z,{name:M.name,type:M.type,components:z,offset:O}}),size:Il(g,Math.max(C,d)),alignment:d}}function Il(c,d){return Math.ceil(c/d)*d}La.serialize=function(c,d){return c._trim(),d&&(c.isTransferred=!0,d.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}},La.deserialize=function(c){var d=Object.create(this.prototype);return d.arrayBuffer=c.arrayBuffer,d.length=c.length,d.capacity=c.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},La.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},La.prototype.clear=function(){this.length=0},La.prototype.resize=function(c){this.reserve(c),this.length=c},La.prototype.reserve=function(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},La.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ef=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C){var M=this.length;return this.resize(M+1),this.emplace(M,g,C)},d.prototype.emplace=function(g,C,M){var I=2*g;return this.int16[I+0]=C,this.int16[I+1]=M,g},d}(La);Ef.prototype.bytesPerElement=4,dn("StructArrayLayout2i4",Ef);var be=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I){var O=this.length;return this.resize(O+1),this.emplace(O,g,C,M,I)},d.prototype.emplace=function(g,C,M,I,O){var z=4*g;return this.int16[z+0]=C,this.int16[z+1]=M,this.int16[z+2]=I,this.int16[z+3]=O,g},d}(La);be.prototype.bytesPerElement=8,dn("StructArrayLayout4i8",be);var Fu=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z){var G=this.length;return this.resize(G+1),this.emplace(G,g,C,M,I,O,z)},d.prototype.emplace=function(g,C,M,I,O,z,G){var q=6*g;return this.int16[q+0]=C,this.int16[q+1]=M,this.int16[q+2]=I,this.int16[q+3]=O,this.int16[q+4]=z,this.int16[q+5]=G,g},d}(La);Fu.prototype.bytesPerElement=12,dn("StructArrayLayout2i4i12",Fu);var Eu=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z){var G=this.length;return this.resize(G+1),this.emplace(G,g,C,M,I,O,z)},d.prototype.emplace=function(g,C,M,I,O,z,G){var q=4*g,re=8*g;return this.int16[q+0]=C,this.int16[q+1]=M,this.uint8[re+4]=I,this.uint8[re+5]=O,this.uint8[re+6]=z,this.uint8[re+7]=G,g},d}(La);Eu.prototype.bytesPerElement=8,dn("StructArrayLayout2i4ub8",Eu);var Su=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C){var M=this.length;return this.resize(M+1),this.emplace(M,g,C)},d.prototype.emplace=function(g,C,M){var I=2*g;return this.float32[I+0]=C,this.float32[I+1]=M,g},d}(La);Su.prototype.bytesPerElement=8,dn("StructArrayLayout2f8",Su);var zi=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z,G,q,re,oe){var ce=this.length;return this.resize(ce+1),this.emplace(ce,g,C,M,I,O,z,G,q,re,oe)},d.prototype.emplace=function(g,C,M,I,O,z,G,q,re,oe,ce){var pe=10*g;return this.uint16[pe+0]=C,this.uint16[pe+1]=M,this.uint16[pe+2]=I,this.uint16[pe+3]=O,this.uint16[pe+4]=z,this.uint16[pe+5]=G,this.uint16[pe+6]=q,this.uint16[pe+7]=re,this.uint16[pe+8]=oe,this.uint16[pe+9]=ce,g},d}(La);zi.prototype.bytesPerElement=20,dn("StructArrayLayout10ui20",zi);var xv=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z,G,q,re,oe,ce,pe){var De=this.length;return this.resize(De+1),this.emplace(De,g,C,M,I,O,z,G,q,re,oe,ce,pe)},d.prototype.emplace=function(g,C,M,I,O,z,G,q,re,oe,ce,pe,De){var $e=12*g;return this.int16[$e+0]=C,this.int16[$e+1]=M,this.int16[$e+2]=I,this.int16[$e+3]=O,this.uint16[$e+4]=z,this.uint16[$e+5]=G,this.uint16[$e+6]=q,this.uint16[$e+7]=re,this.int16[$e+8]=oe,this.int16[$e+9]=ce,this.int16[$e+10]=pe,this.int16[$e+11]=De,g},d}(La);xv.prototype.bytesPerElement=24,dn("StructArrayLayout4i4ui4i24",xv);var Ip=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M){var I=this.length;return this.resize(I+1),this.emplace(I,g,C,M)},d.prototype.emplace=function(g,C,M,I){var O=3*g;return this.float32[O+0]=C,this.float32[O+1]=M,this.float32[O+2]=I,g},d}(La);Ip.prototype.bytesPerElement=12,dn("StructArrayLayout3f12",Ip);var bv=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var C=this.length;return this.resize(C+1),this.emplace(C,g)},d.prototype.emplace=function(g,C){return this.uint32[1*g+0]=C,g},d}(La);bv.prototype.bytesPerElement=4,dn("StructArrayLayout1ul4",bv);var Yf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z,G,q,re){var oe=this.length;return this.resize(oe+1),this.emplace(oe,g,C,M,I,O,z,G,q,re)},d.prototype.emplace=function(g,C,M,I,O,z,G,q,re,oe){var ce=10*g,pe=5*g;return this.int16[ce+0]=C,this.int16[ce+1]=M,this.int16[ce+2]=I,this.int16[ce+3]=O,this.int16[ce+4]=z,this.int16[ce+5]=G,this.uint32[pe+3]=q,this.uint16[ce+8]=re,this.uint16[ce+9]=oe,g},d}(La);Yf.prototype.bytesPerElement=20,dn("StructArrayLayout6i1ul2ui20",Yf);var pd=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z){var G=this.length;return this.resize(G+1),this.emplace(G,g,C,M,I,O,z)},d.prototype.emplace=function(g,C,M,I,O,z,G){var q=6*g;return this.int16[q+0]=C,this.int16[q+1]=M,this.int16[q+2]=I,this.int16[q+3]=O,this.int16[q+4]=z,this.int16[q+5]=G,g},d}(La);pd.prototype.bytesPerElement=12,dn("StructArrayLayout2i2i2i12",pd);var kp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O){var z=this.length;return this.resize(z+1),this.emplace(z,g,C,M,I,O)},d.prototype.emplace=function(g,C,M,I,O,z){var G=4*g,q=8*g;return this.float32[G+0]=C,this.float32[G+1]=M,this.float32[G+2]=I,this.int16[q+6]=O,this.int16[q+7]=z,g},d}(La);kp.prototype.bytesPerElement=16,dn("StructArrayLayout2f1f2i16",kp);var wm=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I){var O=this.length;return this.resize(O+1),this.emplace(O,g,C,M,I)},d.prototype.emplace=function(g,C,M,I,O){var z=12*g,G=3*g;return this.uint8[z+0]=C,this.uint8[z+1]=M,this.float32[G+1]=I,this.float32[G+2]=O,g},d}(La);wm.prototype.bytesPerElement=12,dn("StructArrayLayout2ub2f12",wm);var Bh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M){var I=this.length;return this.resize(I+1),this.emplace(I,g,C,M)},d.prototype.emplace=function(g,C,M,I){var O=3*g;return this.uint16[O+0]=C,this.uint16[O+1]=M,this.uint16[O+2]=I,g},d}(La);Bh.prototype.bytesPerElement=6,dn("StructArrayLayout3ui6",Bh);var Nh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z,G,q,re,oe,ce,pe,De,$e,tt,Ze,mt){var At=this.length;return this.resize(At+1),this.emplace(At,g,C,M,I,O,z,G,q,re,oe,ce,pe,De,$e,tt,Ze,mt)},d.prototype.emplace=function(g,C,M,I,O,z,G,q,re,oe,ce,pe,De,$e,tt,Ze,mt,At){var Nt=24*g,Vt=12*g,ir=48*g;return this.int16[Nt+0]=C,this.int16[Nt+1]=M,this.uint16[Nt+2]=I,this.uint16[Nt+3]=O,this.uint32[Vt+2]=z,this.uint32[Vt+3]=G,this.uint32[Vt+4]=q,this.uint16[Nt+10]=re,this.uint16[Nt+11]=oe,this.uint16[Nt+12]=ce,this.float32[Vt+7]=pe,this.float32[Vt+8]=De,this.uint8[ir+36]=$e,this.uint8[ir+37]=tt,this.uint8[ir+38]=Ze,this.uint32[Vt+10]=mt,this.int16[Nt+22]=At,g},d}(La);Nh.prototype.bytesPerElement=48,dn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Nh);var Zl=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I,O,z,G,q,re,oe,ce,pe,De,$e,tt,Ze,mt,At,Nt,Vt,ir,Mr,Wr,Vn,fn,Yn,gn,Fi){var ai=this.length;return this.resize(ai+1),this.emplace(ai,g,C,M,I,O,z,G,q,re,oe,ce,pe,De,$e,tt,Ze,mt,At,Nt,Vt,ir,Mr,Wr,Vn,fn,Yn,gn,Fi)},d.prototype.emplace=function(g,C,M,I,O,z,G,q,re,oe,ce,pe,De,$e,tt,Ze,mt,At,Nt,Vt,ir,Mr,Wr,Vn,fn,Yn,gn,Fi,ai){var In=34*g,Xi=17*g;return this.int16[In+0]=C,this.int16[In+1]=M,this.int16[In+2]=I,this.int16[In+3]=O,this.int16[In+4]=z,this.int16[In+5]=G,this.int16[In+6]=q,this.int16[In+7]=re,this.uint16[In+8]=oe,this.uint16[In+9]=ce,this.uint16[In+10]=pe,this.uint16[In+11]=De,this.uint16[In+12]=$e,this.uint16[In+13]=tt,this.uint16[In+14]=Ze,this.uint16[In+15]=mt,this.uint16[In+16]=At,this.uint16[In+17]=Nt,this.uint16[In+18]=Vt,this.uint16[In+19]=ir,this.uint16[In+20]=Mr,this.uint16[In+21]=Wr,this.uint16[In+22]=Vn,this.uint32[Xi+12]=fn,this.float32[Xi+13]=Yn,this.float32[Xi+14]=gn,this.float32[Xi+15]=Fi,this.float32[Xi+16]=ai,g},d}(La);Zl.prototype.bytesPerElement=68,dn("StructArrayLayout8i15ui1ul4f68",Zl);var Zf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var C=this.length;return this.resize(C+1),this.emplace(C,g)},d.prototype.emplace=function(g,C){return this.float32[1*g+0]=C,g},d}(La);Zf.prototype.bytesPerElement=4,dn("StructArrayLayout1f4",Zf);var hc=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M){var I=this.length;return this.resize(I+1),this.emplace(I,g,C,M)},d.prototype.emplace=function(g,C,M,I){var O=3*g;return this.int16[O+0]=C,this.int16[O+1]=M,this.int16[O+2]=I,g},d}(La);hc.prototype.bytesPerElement=6,dn("StructArrayLayout3i6",hc);var Cm=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M){var I=this.length;return this.resize(I+1),this.emplace(I,g,C,M)},d.prototype.emplace=function(g,C,M,I){var O=4*g;return this.uint32[2*g+0]=C,this.uint16[O+2]=M,this.uint16[O+3]=I,g},d}(La);Cm.prototype.bytesPerElement=8,dn("StructArrayLayout1ul2ui8",Cm);var Pp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C){var M=this.length;return this.resize(M+1),this.emplace(M,g,C)},d.prototype.emplace=function(g,C,M){var I=2*g;return this.uint16[I+0]=C,this.uint16[I+1]=M,g},d}(La);Pp.prototype.bytesPerElement=4,dn("StructArrayLayout2ui4",Pp);var dd=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var C=this.length;return this.resize(C+1),this.emplace(C,g)},d.prototype.emplace=function(g,C){return this.uint16[1*g+0]=C,g},d}(La);dd.prototype.bytesPerElement=2,dn("StructArrayLayout1ui2",dd);var pc=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,C,M,I){var O=this.length;return this.resize(O+1),this.emplace(O,g,C,M,I)},d.prototype.emplace=function(g,C,M,I,O){var z=4*g;return this.float32[z+0]=C,this.float32[z+1]=M,this.float32[z+2]=I,this.float32[z+3]=O,g},d}(La);pc.prototype.bytesPerElement=16,dn("StructArrayLayout4f16",pc);var y=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return g.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},g.x1.get=function(){return this._structArray.int16[this._pos2+2]},g.y1.get=function(){return this._structArray.int16[this._pos2+3]},g.x2.get=function(){return this._structArray.int16[this._pos2+4]},g.y2.get=function(){return this._structArray.int16[this._pos2+5]},g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.anchorPoint.get=function(){return new f(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,g),d}(Ll);y.prototype.size=20;var b=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new y(this,g)},d}(Yf);dn("CollisionBoxArray",b);var _=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},g.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},g.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},g.segment.get=function(){return this._structArray.uint16[this._pos2+10]},g.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},g.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},g.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},g.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},g.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},g.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},g.placedOrientation.set=function(C){this._structArray.uint8[this._pos1+37]=C},g.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},g.hidden.set=function(C){this._structArray.uint8[this._pos1+38]=C},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},g.crossTileID.set=function(C){this._structArray.uint32[this._pos4+10]=C},g.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,g),d}(Ll);_.prototype.size=48;var S=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new _(this,g)},d}(Nh);dn("PlacedSymbolArray",S);var P=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},g.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},g.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},g.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},g.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},g.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},g.key.get=function(){return this._structArray.uint16[this._pos2+8]},g.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},g.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},g.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},g.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},g.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},g.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},g.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},g.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},g.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},g.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},g.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},g.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},g.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},g.crossTileID.set=function(C){this._structArray.uint32[this._pos4+12]=C},g.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},g.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},g.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},g.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,g),d}(Ll);P.prototype.size=68;var F=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new P(this,g)},d}(Zl);dn("SymbolInstanceArray",F);var N=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getoffsetX=function(g){return this.float32[1*g+0]},d}(Zf);dn("GlyphOffsetArray",N);var V=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getx=function(g){return this.int16[3*g+0]},d.prototype.gety=function(g){return this.int16[3*g+1]},d.prototype.gettileUnitDistanceFromAnchor=function(g){return this.int16[3*g+2]},d}(hc);dn("SymbolLineVertexArray",V);var J=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,g),d}(Ll);J.prototype.size=8;var se=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new J(this,g)},d}(Cm);dn("FeatureIndexArray",se);var de=Es([{name:"a_pos",components:2,type:"Int16"}],4).members,xe=function(c){c===void 0&&(c=[]),this.segments=c};function Ee(c,d){return 256*(c=E(Math.floor(c),0,255))+E(Math.floor(d),0,255)}xe.prototype.prepareSegment=function(c,d,g,C){var M=this.segments[this.segments.length-1];return c>xe.MAX_VERTEX_ARRAY_LENGTH&&te("Max vertices per segment is "+xe.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+c),(!M||M.vertexLength+c>xe.MAX_VERTEX_ARRAY_LENGTH||M.sortKey!==C)&&(M={vertexOffset:d.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},C!==void 0&&(M.sortKey=C),this.segments.push(M)),M},xe.prototype.get=function(){return this.segments},xe.prototype.destroy=function(){for(var c=0,d=this.segments;c<d.length;c+=1){var g=d[c];for(var C in g.vaos)g.vaos[C].destroy()}},xe.simpleSegment=function(c,d,g,C){return new xe([{vertexOffset:c,primitiveOffset:d,vertexLength:g,primitiveLength:C,vaos:{},sortKey:0}])},xe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn("SegmentVector",xe);var Ue=Es([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Be=s(function(c){c.exports=function(d,g){var C,M,I,O,z,G,q,re;for(M=d.length-(C=3&d.length),I=g,z=3432918353,G=461845907,re=0;re<M;)q=255&d.charCodeAt(re)|(255&d.charCodeAt(++re))<<8|(255&d.charCodeAt(++re))<<16|(255&d.charCodeAt(++re))<<24,++re,I=27492+(65535&(O=5*(65535&(I=(I^=q=(65535&(q=(q=(65535&q)*z+(((q>>>16)*z&65535)<<16)&4294967295)<<15|q>>>17))*G+(((q>>>16)*G&65535)<<16)&4294967295)<<13|I>>>19))+((5*(I>>>16)&65535)<<16)&4294967295))+((58964+(O>>>16)&65535)<<16);switch(q=0,C){case 3:q^=(255&d.charCodeAt(re+2))<<16;case 2:q^=(255&d.charCodeAt(re+1))<<8;case 1:I^=q=(65535&(q=(q=(65535&(q^=255&d.charCodeAt(re)))*z+(((q>>>16)*z&65535)<<16)&4294967295)<<15|q>>>17))*G+(((q>>>16)*G&65535)<<16)&4294967295}return I^=d.length,I=2246822507*(65535&(I^=I>>>16))+((2246822507*(I>>>16)&65535)<<16)&4294967295,I=3266489909*(65535&(I^=I>>>13))+((3266489909*(I>>>16)&65535)<<16)&4294967295,(I^=I>>>16)>>>0}}),Ke=s(function(c){c.exports=function(d,g){for(var C,M=d.length,I=g^M,O=0;M>=4;)C=1540483477*(65535&(C=255&d.charCodeAt(O)|(255&d.charCodeAt(++O))<<8|(255&d.charCodeAt(++O))<<16|(255&d.charCodeAt(++O))<<24))+((1540483477*(C>>>16)&65535)<<16),I=1540483477*(65535&I)+((1540483477*(I>>>16)&65535)<<16)^(C=1540483477*(65535&(C^=C>>>24))+((1540483477*(C>>>16)&65535)<<16)),M-=4,++O;switch(M){case 3:I^=(255&d.charCodeAt(O+2))<<16;case 2:I^=(255&d.charCodeAt(O+1))<<8;case 1:I=1540483477*(65535&(I^=255&d.charCodeAt(O)))+((1540483477*(I>>>16)&65535)<<16)}return I=1540483477*(65535&(I^=I>>>13))+((1540483477*(I>>>16)&65535)<<16),(I^=I>>>15)>>>0}}),Oe=Be,Qe=Ke;Oe.murmur3=Be,Oe.murmur2=Qe;var ft=function(){this.ids=[],this.positions=[],this.indexed=!1};ft.prototype.add=function(c,d,g,C){this.ids.push(Ut(c)),this.positions.push(d,g,C)},ft.prototype.getPositions=function(c){for(var d=Ut(c),g=0,C=this.ids.length-1;g<C;){var M=g+C>>1;this.ids[M]>=d?C=M:g=M+1}for(var I=[];this.ids[g]===d;)I.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return I},ft.serialize=function(c,d){var g=new Float64Array(c.ids),C=new Uint32Array(c.positions);return function M(I,O,z,G){for(;z<G;){for(var q=I[z+G>>1],re=z-1,oe=G+1;;){do re++;while(I[re]<q);do oe--;while(I[oe]>q);if(re>=oe)break;Bt(I,re,oe),Bt(O,3*re,3*oe),Bt(O,3*re+1,3*oe+1),Bt(O,3*re+2,3*oe+2)}oe-z<G-oe?(M(I,O,z,oe),z=oe+1):(M(I,O,oe+1,G),G=oe)}}(g,C,0,g.length-1),d&&d.push(g.buffer,C.buffer),{ids:g,positions:C}},ft.deserialize=function(c){var d=new ft;return d.ids=c.ids,d.positions=c.positions,d.indexed=!0,d};var xt=Math.pow(2,53)-1;function Ut(c){var d=+c;return!isNaN(d)&&d<=xt?d:Oe(String(c))}function Bt(c,d,g){var C=c[d];c[d]=c[g],c[g]=C}dn("FeaturePositionMap",ft);var Wt=function(c,d){this.gl=c.gl,this.location=d},hr=function(c){function d(g,C){c.call(this,g,C),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1i(this.location,g))},d}(Wt),yr=function(c){function d(g,C){c.call(this,g,C),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1f(this.location,g))},d}(Wt),Ir=function(c){function d(g,C){c.call(this,g,C),this.current=[0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]||(this.current=g,this.gl.uniform2f(this.location,g[0],g[1]))},d}(Wt),Kr=function(c){function d(g,C){c.call(this,g,C),this.current=[0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]||(this.current=g,this.gl.uniform3f(this.location,g[0],g[1],g[2]))},d}(Wt),An=function(c){function d(g,C){c.call(this,g,C),this.current=[0,0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]&&g[3]===this.current[3]||(this.current=g,this.gl.uniform4f(this.location,g[0],g[1],g[2],g[3]))},d}(Wt),Nn=function(c){function d(g,C){c.call(this,g,C),this.current=Ni.transparent}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g.r===this.current.r&&g.g===this.current.g&&g.b===this.current.b&&g.a===this.current.a||(this.current=g,this.gl.uniform4f(this.location,g.r,g.g,g.b,g.a))},d}(Wt),Dn=new Float32Array(16),sa=function(c){function d(g,C){c.call(this,g,C),this.current=Dn}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){if(g[12]!==this.current[12]||g[0]!==this.current[0])return this.current=g,void this.gl.uniformMatrix4fv(this.location,!1,g);for(var C=1;C<16;C++)if(g[C]!==this.current[C]){this.current=g,this.gl.uniformMatrix4fv(this.location,!1,g);break}},d}(Wt);function on(c){return[Ee(255*c.r,255*c.g),Ee(255*c.b,255*c.a)]}var qn=function(c,d,g){this.value=c,this.uniformNames=d.map(function(C){return"u_"+C}),this.type=g};qn.prototype.setUniform=function(c,d,g){c.set(g.constantOr(this.value))},qn.prototype.getBinding=function(c,d,g){return this.type==="color"?new Nn(c,d):new yr(c,d)};var di=function(c,d){this.uniformNames=d.map(function(g){return"u_"+g}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};di.prototype.setConstantPatternPositions=function(c,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=c.tlbr},di.prototype.setUniform=function(c,d,g,C){var M=C==="u_pattern_to"?this.patternTo:C==="u_pattern_from"?this.patternFrom:C==="u_pixel_ratio_to"?this.pixelRatioTo:C==="u_pixel_ratio_from"?this.pixelRatioFrom:null;M&&c.set(M)},di.prototype.getBinding=function(c,d,g){return g.substr(0,9)==="u_pattern"?new An(c,d):new yr(c,d)};var si=function(c,d,g,C){this.expression=c,this.type=g,this.maxValue=0,this.paintVertexAttributes=d.map(function(M){return{name:"a_"+M,type:"Float32",components:g==="color"?2:1,offset:0}}),this.paintVertexArray=new C};si.prototype.populatePaintArray=function(c,d,g,C,M){var I=this.paintVertexArray.length,O=this.expression.evaluate(new ti(0),d,{},C,[],M);this.paintVertexArray.resize(c),this._setPaintValue(I,c,O)},si.prototype.updatePaintArray=function(c,d,g,C){var M=this.expression.evaluate({zoom:0},g,C);this._setPaintValue(c,d,M)},si.prototype._setPaintValue=function(c,d,g){if(this.type==="color")for(var C=on(g),M=c;M<d;M++)this.paintVertexArray.emplace(M,C[0],C[1]);else{for(var I=c;I<d;I++)this.paintVertexArray.emplace(I,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}},si.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},si.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Jn=function(c,d,g,C,M,I){this.expression=c,this.uniformNames=d.map(function(O){return"u_"+O+"_t"}),this.type=g,this.useIntegerZoom=C,this.zoom=M,this.maxValue=0,this.paintVertexAttributes=d.map(function(O){return{name:"a_"+O,type:"Float32",components:g==="color"?4:2,offset:0}}),this.paintVertexArray=new I};Jn.prototype.populatePaintArray=function(c,d,g,C,M){var I=this.expression.evaluate(new ti(this.zoom),d,{},C,[],M),O=this.expression.evaluate(new ti(this.zoom+1),d,{},C,[],M),z=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(z,c,I,O)},Jn.prototype.updatePaintArray=function(c,d,g,C){var M=this.expression.evaluate({zoom:this.zoom},g,C),I=this.expression.evaluate({zoom:this.zoom+1},g,C);this._setPaintValue(c,d,M,I)},Jn.prototype._setPaintValue=function(c,d,g,C){if(this.type==="color")for(var M=on(g),I=on(C),O=c;O<d;O++)this.paintVertexArray.emplace(O,M[0],M[1],I[0],I[1]);else{for(var z=c;z<d;z++)this.paintVertexArray.emplace(z,g,C);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(C))}},Jn.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Jn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Jn.prototype.setUniform=function(c,d){var g=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,C=E(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);c.set(C)},Jn.prototype.getBinding=function(c,d,g){return new yr(c,d)};var wi=function(c,d,g,C,M,I){this.expression=c,this.type=d,this.useIntegerZoom=g,this.zoom=C,this.layerId=I,this.zoomInPaintVertexArray=new M,this.zoomOutPaintVertexArray=new M};wi.prototype.populatePaintArray=function(c,d,g){var C=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(C,c,d.patterns&&d.patterns[this.layerId],g)},wi.prototype.updatePaintArray=function(c,d,g,C,M){this._setPaintValues(c,d,g.patterns&&g.patterns[this.layerId],M)},wi.prototype._setPaintValues=function(c,d,g,C){if(C&&g){var M=C[g.min],I=C[g.mid],O=C[g.max];if(M&&I&&O)for(var z=c;z<d;z++)this.zoomInPaintVertexArray.emplace(z,I.tl[0],I.tl[1],I.br[0],I.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],I.pixelRatio,M.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,I.tl[0],I.tl[1],I.br[0],I.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],I.pixelRatio,O.pixelRatio)}},wi.prototype.upload=function(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,Ue.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,Ue.members,this.expression.isStateDependent))},wi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ri=function(c,d,g){this.binders={},this._buffers=[];var C=[];for(var M in c.paint._values)if(g(M)){var I=c.paint.get(M);if(I instanceof vs&&lc(I.property.specification)){var O=Zo(M,c.type),z=I.value,G=I.property.specification.type,q=I.property.useIntegerZoom,re=I.property.specification["property-type"],oe=re==="cross-faded"||re==="cross-faded-data-driven";if(z.kind==="constant")this.binders[M]=oe?new di(z.value,O):new qn(z.value,O,G),C.push("/u_"+M);else if(z.kind==="source"||oe){var ce=No(M,G,"source");this.binders[M]=oe?new wi(z,G,q,d,ce,c.id):new si(z,O,G,ce),C.push("/a_"+M)}else{var pe=No(M,G,"composite");this.binders[M]=new Jn(z,O,G,q,d,pe),C.push("/z_"+M)}}}this.cacheKey=C.sort().join("")};ri.prototype.getMaxValue=function(c){var d=this.binders[c];return d instanceof si||d instanceof Jn?d.maxValue:0},ri.prototype.populatePaintArrays=function(c,d,g,C,M){for(var I in this.binders){var O=this.binders[I];(O instanceof si||O instanceof Jn||O instanceof wi)&&O.populatePaintArray(c,d,g,C,M)}},ri.prototype.setConstantPatternPositions=function(c,d){for(var g in this.binders){var C=this.binders[g];C instanceof di&&C.setConstantPatternPositions(c,d)}},ri.prototype.updatePaintArrays=function(c,d,g,C,M){var I=!1;for(var O in c)for(var z=0,G=d.getPositions(O);z<G.length;z+=1){var q=G[z],re=g.feature(q.index);for(var oe in this.binders){var ce=this.binders[oe];if((ce instanceof si||ce instanceof Jn||ce instanceof wi)&&ce.expression.isStateDependent===!0){var pe=C.paint.get(oe);ce.expression=pe.value,ce.updatePaintArray(q.start,q.end,re,c[O],M),I=!0}}}return I},ri.prototype.defines=function(){var c=[];for(var d in this.binders){var g=this.binders[d];(g instanceof qn||g instanceof di)&&c.push.apply(c,g.uniformNames.map(function(C){return"#define HAS_UNIFORM_"+C}))}return c},ri.prototype.getBinderAttributes=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof si||g instanceof Jn)for(var C=0;C<g.paintVertexAttributes.length;C++)c.push(g.paintVertexAttributes[C].name);else if(g instanceof wi)for(var M=0;M<Ue.members.length;M++)c.push(Ue.members[M].name)}return c},ri.prototype.getBinderUniforms=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof qn||g instanceof di||g instanceof Jn)for(var C=0,M=g.uniformNames;C<M.length;C+=1)c.push(M[C])}return c},ri.prototype.getPaintVertexBuffers=function(){return this._buffers},ri.prototype.getUniforms=function(c,d){var g=[];for(var C in this.binders){var M=this.binders[C];if(M instanceof qn||M instanceof di||M instanceof Jn)for(var I=0,O=M.uniformNames;I<O.length;I+=1){var z=O[I];if(d[z]){var G=M.getBinding(c,d[z],z);g.push({name:z,property:C,binding:G})}}}return g},ri.prototype.setUniforms=function(c,d,g,C){for(var M=0,I=d;M<I.length;M+=1){var O=I[M],z=O.name,G=O.property;this.binders[G].setUniform(O.binding,C,g.get(G),z)}},ri.prototype.updatePaintBuffers=function(c){for(var d in this._buffers=[],this.binders){var g=this.binders[d];if(c&&g instanceof wi){var C=c.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;C&&this._buffers.push(C)}else(g instanceof si||g instanceof Jn)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}},ri.prototype.upload=function(c){for(var d in this.binders){var g=this.binders[d];(g instanceof si||g instanceof Jn||g instanceof wi)&&g.upload(c)}this.updatePaintBuffers()},ri.prototype.destroy=function(){for(var c in this.binders){var d=this.binders[c];(d instanceof si||d instanceof Jn||d instanceof wi)&&d.destroy()}};var Tn=function(c,d,g){g===void 0&&(g=function(){return!0}),this.programConfigurations={};for(var C=0,M=c;C<M.length;C+=1){var I=M[C];this.programConfigurations[I.id]=new ri(I,d,g)}this.needsUpload=!1,this._featureMap=new ft,this._bufferOffset=0};function Zo(c,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(d+"-","").replace(/-/g,"_")]}function No(c,d,g){var C={color:{source:Su,composite:pc},number:{source:Zf,composite:Su}},M=function(I){return{"line-pattern":{source:zi,composite:zi},"fill-pattern":{source:zi,composite:zi},"fill-extrusion-pattern":{source:zi,composite:zi}}[I]}(c);return M&&M[g]||C[d][g]}Tn.prototype.populatePaintArrays=function(c,d,g,C,M,I){for(var O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(c,d,C,M,I);d.id!==void 0&&this._featureMap.add(d.id,g,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0},Tn.prototype.updatePaintArrays=function(c,d,g,C){for(var M=0,I=g;M<I.length;M+=1){var O=I[M];this.needsUpload=this.programConfigurations[O.id].updatePaintArrays(c,this._featureMap,d,O,C)||this.needsUpload}},Tn.prototype.get=function(c){return this.programConfigurations[c]},Tn.prototype.upload=function(c){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(c);this.needsUpload=!1}},Tn.prototype.destroy=function(){for(var c in this.programConfigurations)this.programConfigurations[c].destroy()},dn("ConstantBinder",qn),dn("CrossFadedConstantBinder",di),dn("SourceExpressionBinder",si),dn("CrossFadedCompositeBinder",wi),dn("CompositeExpressionBinder",Jn),dn("ProgramConfiguration",ri,{omit:["_buffers"]}),dn("ProgramConfigurationSet",Tn);var Mo=Math.pow(2,14)-1,Ss=-Mo-1;function vo(c){for(var d=8192/c.extent,g=c.loadGeometry(),C=0;C<g.length;C++)for(var M=g[C],I=0;I<M.length;I++){var O=M[I],z=Math.round(O.x*d),G=Math.round(O.y*d);O.x=E(z,Ss,Mo),O.y=E(G,Ss,Mo),(z<O.x||z>O.x+1||G<O.y||G>O.y+1)&&te("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return g}function no(c,d){return{type:c.type,id:c.id,properties:c.properties,geometry:d?vo(c):[]}}function Du(c,d,g,C,M){c.emplaceBack(2*d+(C+1)/2,2*g+(M+1)/2)}var Ha=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Ef,this.indexArray=new Bh,this.segments=new xe,this.programConfigurations=new Tn(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function Xc(c,d){for(var g=0;g<c.length;g++)if(Yc(d,c[g]))return!0;for(var C=0;C<d.length;C++)if(Yc(c,d[C]))return!0;return!!qf(c,d)}function tl(c,d,g){return!!Yc(c,d)||!!Kl(d,c,g)}function dc(c,d){if(c.length===1)return Op(d,c[0]);for(var g=0;g<d.length;g++)for(var C=d[g],M=0;M<C.length;M++)if(Yc(c,C[M]))return!0;for(var I=0;I<c.length;I++)if(Op(d,c[I]))return!0;for(var O=0;O<d.length;O++)if(qf(c,d[O]))return!0;return!1}function ql(c,d,g){if(c.length>1){if(qf(c,d))return!0;for(var C=0;C<d.length;C++)if(Kl(d[C],c,g))return!0}for(var M=0;M<c.length;M++)if(Kl(c[M],d,g))return!0;return!1}function qf(c,d){if(c.length===0||d.length===0)return!1;for(var g=0;g<c.length-1;g++)for(var C=c[g],M=c[g+1],I=0;I<d.length-1;I++)if(Rp(C,M,d[I],d[I+1]))return!0;return!1}function Rp(c,d,g,C){return ie(c,g,C)!==ie(d,g,C)&&ie(c,d,g)!==ie(c,d,C)}function Kl(c,d,g){var C=g*g;if(d.length===1)return c.distSqr(d[0])<C;for(var M=1;M<d.length;M++)if(Kf(c,d[M-1],d[M])<C)return!0;return!1}function Kf(c,d,g){var C=d.distSqr(g);if(C===0)return c.distSqr(d);var M=((c.x-d.x)*(g.x-d.x)+(c.y-d.y)*(g.y-d.y))/C;return c.distSqr(M<0?d:M>1?g:g.sub(d)._mult(M)._add(d))}function Op(c,d){for(var g,C,M,I=!1,O=0;O<c.length;O++)for(var z=0,G=(g=c[O]).length-1;z<g.length;G=z++)(C=g[z]).y>d.y!=(M=g[G]).y>d.y&&d.x<(M.x-C.x)*(d.y-C.y)/(M.y-C.y)+C.x&&(I=!I);return I}function Yc(c,d){for(var g=!1,C=0,M=c.length-1;C<c.length;M=C++){var I=c[C],O=c[M];I.y>d.y!=O.y>d.y&&d.x<(O.x-I.x)*(d.y-I.y)/(O.y-I.y)+I.x&&(g=!g)}return g}function Zc(c,d,g){var C=g[0],M=g[2];if(c.x<C.x&&d.x<C.x||c.x>M.x&&d.x>M.x||c.y<C.y&&d.y<C.y||c.y>M.y&&d.y>M.y)return!1;var I=ie(c,d,g[0]);return I!==ie(c,d,g[1])||I!==ie(c,d,g[2])||I!==ie(c,d,g[3])}function qc(c,d,g){var C=d.paint.get(c).value;return C.kind==="constant"?C.value:g.programConfigurations.get(d.id).getMaxValue(c)}function Ns(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Ql(c,d,g,C,M){if(!d[0]&&!d[1])return c;var I=f.convert(d)._mult(M);g==="viewport"&&I._rotate(-C);for(var O=[],z=0;z<c.length;z++)O.push(c[z].sub(I));return O}Ha.prototype.populate=function(c,d,g){var C=this.layers[0],M=[],I=null;C.type==="circle"&&(I=C.layout.get("circle-sort-key"));for(var O=0,z=c;O<z.length;O+=1){var G=z[O],q=G.feature,re=G.id,oe=G.index,ce=G.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,De=no(q,pe);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),De,g)){var $e=I?I.evaluate(De,{},g):void 0,tt={id:re,properties:q.properties,type:q.type,sourceLayerIndex:ce,index:oe,geometry:pe?De.geometry:vo(q),patterns:{},sortKey:$e};M.push(tt)}}I&&M.sort(function(Wr,Vn){return Wr.sortKey-Vn.sortKey});for(var Ze=0,mt=M;Ze<mt.length;Ze+=1){var At=mt[Ze],Nt=At.geometry,Vt=At.index,ir=At.sourceLayerIndex,Mr=c[Vt].feature;this.addFeature(At,Nt,Vt,g),d.featureIndex.insert(Mr,Nt,Vt,ir,this.index)}},Ha.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Ha.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ha.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ha.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,de),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},Ha.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ha.prototype.addFeature=function(c,d,g,C){for(var M=0,I=d;M<I.length;M+=1)for(var O=0,z=I[M];O<z.length;O+=1){var G=z[O],q=G.x,re=G.y;if(!(q<0||q>=8192||re<0||re>=8192)){var oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),ce=oe.vertexLength;Du(this.layoutVertexArray,q,re,-1,-1),Du(this.layoutVertexArray,q,re,1,-1),Du(this.layoutVertexArray,q,re,1,1),Du(this.layoutVertexArray,q,re,-1,1),this.indexArray.emplaceBack(ce,ce+1,ce+2),this.indexArray.emplaceBack(ce,ce+3,ce+2),oe.vertexLength+=4,oe.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,{},C)},dn("CircleBucket",Ha,{omit:["layers"]});var Sf=new uu({"circle-sort-key":new _n(_e.layout_circle["circle-sort-key"])}),zh={paint:new uu({"circle-radius":new _n(_e.paint_circle["circle-radius"]),"circle-color":new _n(_e.paint_circle["circle-color"]),"circle-blur":new _n(_e.paint_circle["circle-blur"]),"circle-opacity":new _n(_e.paint_circle["circle-opacity"]),"circle-translate":new Pn(_e.paint_circle["circle-translate"]),"circle-translate-anchor":new Pn(_e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Pn(_e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Pn(_e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _n(_e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _n(_e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _n(_e.paint_circle["circle-stroke-opacity"])}),layout:Sf},ma=typeof Float32Array!="undefined"?Float32Array:Array;function hl(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Zs(c,d,g){var C=d[0],M=d[1],I=d[2],O=d[3],z=d[4],G=d[5],q=d[6],re=d[7],oe=d[8],ce=d[9],pe=d[10],De=d[11],$e=d[12],tt=d[13],Ze=d[14],mt=d[15],At=g[0],Nt=g[1],Vt=g[2],ir=g[3];return c[0]=At*C+Nt*z+Vt*oe+ir*$e,c[1]=At*M+Nt*G+Vt*ce+ir*tt,c[2]=At*I+Nt*q+Vt*pe+ir*Ze,c[3]=At*O+Nt*re+Vt*De+ir*mt,c[4]=(At=g[4])*C+(Nt=g[5])*z+(Vt=g[6])*oe+(ir=g[7])*$e,c[5]=At*M+Nt*G+Vt*ce+ir*tt,c[6]=At*I+Nt*q+Vt*pe+ir*Ze,c[7]=At*O+Nt*re+Vt*De+ir*mt,c[8]=(At=g[8])*C+(Nt=g[9])*z+(Vt=g[10])*oe+(ir=g[11])*$e,c[9]=At*M+Nt*G+Vt*ce+ir*tt,c[10]=At*I+Nt*q+Vt*pe+ir*Ze,c[11]=At*O+Nt*re+Vt*De+ir*mt,c[12]=(At=g[12])*C+(Nt=g[13])*z+(Vt=g[14])*oe+(ir=g[15])*$e,c[13]=At*M+Nt*G+Vt*ce+ir*tt,c[14]=At*I+Nt*q+Vt*pe+ir*Ze,c[15]=At*O+Nt*re+Vt*De+ir*mt,c}Math.hypot||(Math.hypot=function(){for(var c=arguments,d=0,g=arguments.length;g--;)d+=c[g]*c[g];return Math.sqrt(d)});var Af,pg=Zs;function kl(c,d,g){var C=d[0],M=d[1],I=d[2],O=d[3];return c[0]=g[0]*C+g[4]*M+g[8]*I+g[12]*O,c[1]=g[1]*C+g[5]*M+g[9]*I+g[13]*O,c[2]=g[2]*C+g[6]*M+g[10]*I+g[14]*O,c[3]=g[3]*C+g[7]*M+g[11]*I+g[15]*O,c}Af=new ma(3),ma!=Float32Array&&(Af[0]=0,Af[1]=0,Af[2]=0),function(){var c=new ma(4);ma!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0)}();var vd=(function(){var c=new ma(2);ma!=Float32Array&&(c[0]=0,c[1]=0)}(),function(c){function d(g){c.call(this,g,zh)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new Ha(g)},d.prototype.queryRadius=function(g){var C=g;return qc("circle-radius",this,C)+qc("circle-stroke-width",this,C)+Ns(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(g,C,M,I,O,z,G,q){for(var re=Ql(g,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,G),oe=this.paint.get("circle-radius").evaluate(C,M)+this.paint.get("circle-stroke-width").evaluate(C,M),ce=this.paint.get("circle-pitch-alignment")==="map",pe=ce?re:function(Mr,Wr){return Mr.map(function(Vn){return vc(Vn,Wr)})}(re,q),De=ce?oe*G:oe,$e=0,tt=I;$e<tt.length;$e+=1)for(var Ze=0,mt=tt[$e];Ze<mt.length;Ze+=1){var At=mt[Ze],Nt=ce?At:vc(At,q),Vt=De,ir=kl([],[At.x,At.y,0,1],q);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Vt*=ir[3]/z.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Vt*=z.cameraToCenterDistance/ir[3]),tl(pe,Nt,Vt))return!0}return!1},d}(Wc));function vc(c,d){var g=kl([],[c.x,c.y,0,1],d);return new f(g[0]/g[3],g[1]/g[3])}var Fp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Ha);function Jl(c,d,g,C){var M=d.width,I=d.height;if(C){if(C instanceof Uint8ClampedArray)C=new Uint8Array(C.buffer);else if(C.length!==M*I*g)throw new RangeError("mismatched image size")}else C=new Uint8Array(M*I*g);return c.width=M,c.height=I,c.data=C,c}function Tf(c,d,g){var C=d.width,M=d.height;if(C!==c.width||M!==c.height){var I=Jl({},{width:C,height:M},g);$h(c,I,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,C),height:Math.min(c.height,M)},g),c.width=C,c.height=M,c.data=I.data}}function $h(c,d,g,C,M,I){if(M.width===0||M.height===0)return d;if(M.width>c.width||M.height>c.height||g.x>c.width-M.width||g.y>c.height-M.height)throw new RangeError("out of range source coordinates for image copy");if(M.width>d.width||M.height>d.height||C.x>d.width-M.width||C.y>d.height-M.height)throw new RangeError("out of range destination coordinates for image copy");for(var O=c.data,z=d.data,G=0;G<M.height;G++)for(var q=((g.y+G)*c.width+g.x)*I,re=((C.y+G)*d.width+C.x)*I,oe=0;oe<M.width*I;oe++)z[re+oe]=O[q+oe];return d}dn("HeatmapBucket",Fp,{omit:["layers"]});var gc=function(c,d){Jl(this,c,1,d)};gc.prototype.resize=function(c){Tf(this,c,1)},gc.prototype.clone=function(){return new gc({width:this.width,height:this.height},new Uint8Array(this.data))},gc.copy=function(c,d,g,C,M){$h(c,d,g,C,M,1)};var Bu=function(c,d){Jl(this,c,4,d)};Bu.prototype.resize=function(c){Tf(this,c,4)},Bu.prototype.replace=function(c,d){d?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c},Bu.prototype.clone=function(){return new Bu({width:this.width,height:this.height},new Uint8Array(this.data))},Bu.copy=function(c,d,g,C,M){$h(c,d,g,C,M,4)},dn("AlphaImage",gc),dn("RGBAImage",Bu);var Em={paint:new uu({"heatmap-radius":new _n(_e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _n(_e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Pn(_e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ou(_e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Pn(_e.paint_heatmap["heatmap-opacity"])})};function dg(c){var d={},g=c.resolution||256,C=c.clips?c.clips.length:1,M=c.image||new Bu({width:g,height:C}),I=function(De,$e,tt){d[c.evaluationKey]=tt;var Ze=c.expression.evaluate(d);M.data[De+$e+0]=Math.floor(255*Ze.r/Ze.a),M.data[De+$e+1]=Math.floor(255*Ze.g/Ze.a),M.data[De+$e+2]=Math.floor(255*Ze.b/Ze.a),M.data[De+$e+3]=Math.floor(255*Ze.a)};if(c.clips)for(var O=0,z=0;O<C;++O,z+=4*g)for(var G=0,q=0;G<g;G++,q+=4){var re=G/(g-1),oe=c.clips[O];I(z,q,oe.start*(1-re)+oe.end*re)}else for(var ce=0,pe=0;ce<g;ce++,pe+=4)I(0,pe,ce/(g-1));return M}var Sm=function(c){function d(g){c.call(this,g,Em),this._updateColorRamp()}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new Fp(g)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=dg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(Wc),Hy={paint:new uu({"hillshade-illumination-direction":new Pn(_e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Pn(_e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Pn(_e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Pn(_e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Pn(_e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Pn(_e.paint_hillshade["hillshade-accent-color"])})},gd=function(c){function d(g){c.call(this,g,Hy)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(Wc),vg=Es([{name:"a_pos",components:2,type:"Int16"}],4).members,Am=Tm,_a=Tm;function Tm(c,d,g){g=g||2;var C,M,I,O,z,G,q,re=d&&d.length,oe=re?d[0]*g:c.length,ce=R_(c,0,oe,g,!0),pe=[];if(!ce||ce.next===ce.prev)return pe;if(re&&(ce=function($e,tt,Ze,mt){var At,Nt,Vt,ir=[];for(At=0,Nt=tt.length;At<Nt;At++)(Vt=R_($e,tt[At]*mt,At<Nt-1?tt[At+1]*mt:$e.length,mt,!1))===Vt.next&&(Vt.steiner=!0),ir.push(Qc(Vt));for(ir.sort(Mm),At=0;At<ir.length;At++)F_(ir[At],Ze),Ze=Kc(Ze,Ze.next);return Ze}(c,d,ce,g)),c.length>80*g){C=I=c[0],M=O=c[1];for(var De=g;De<oe;De+=g)(z=c[De])<C&&(C=z),(G=c[De+1])<M&&(M=G),z>I&&(I=z),G>O&&(O=G);q=(q=Math.max(I-C,O-M))!==0?1/q:0}return gg(ce,pe,g,C,M,q),pe}function R_(c,d,g,C,M){var I,O;if(M===Av(c,d,g,C)>0)for(I=d;I<g;I+=C)O=Lf(I,c[I],c[I+1],O);else for(I=g-C;I>=d;I-=C)O=Lf(I,c[I],c[I+1],O);return O&&wv(O,O.next)&&(Sv(O),O=O.next),O}function Kc(c,d){if(!c)return c;d||(d=c);var g,C=c;do if(g=!1,C.steiner||!wv(C,C.next)&&As(C.prev,C,C.next)!==0)C=C.next;else{if(Sv(C),(C=d=C.prev)===C.next)break;g=!0}while(g||C!==d);return d}function gg(c,d,g,C,M,I,O){if(c){!O&&I&&function(re,oe,ce,pe){var De=re;do De.z===null&&(De.z=jy(De.x,De.y,oe,ce,pe)),De.prevZ=De.prev,De.nextZ=De.next,De=De.next;while(De!==re);De.prevZ.nextZ=null,De.prevZ=null,function($e){var tt,Ze,mt,At,Nt,Vt,ir,Mr,Wr=1;do{for(Ze=$e,$e=null,Nt=null,Vt=0;Ze;){for(Vt++,mt=Ze,ir=0,tt=0;tt<Wr&&(ir++,mt=mt.nextZ);tt++);for(Mr=Wr;ir>0||Mr>0&&mt;)ir!==0&&(Mr===0||!mt||Ze.z<=mt.z)?(At=Ze,Ze=Ze.nextZ,ir--):(At=mt,mt=mt.nextZ,Mr--),Nt?Nt.nextZ=At:$e=At,At.prevZ=Nt,Nt=At;Ze=mt}Nt.nextZ=null,Wr*=2}while(Vt>1)}(De)}(c,C,M,I);for(var z,G,q=c;c.prev!==c.next;)if(z=c.prev,G=c.next,I?O_(c,C,M,I):mg(c))d.push(z.i/g),d.push(c.i/g),d.push(G.i/g),Sv(c),c=G.next,q=G.next;else if((c=G)===q){O?O===1?gg(c=Mf(Kc(c),d,g),d,g,C,M,I,2):O===2&&mw(c,d,g,C,M,I):gg(Kc(c),d,g,C,M,I,1);break}}}function mg(c){var d=c.prev,g=c,C=c.next;if(As(d,g,C)>=0)return!1;for(var M=c.next.next;M!==c.prev;){if(Jc(d.x,d.y,g.x,g.y,C.x,C.y,M.x,M.y)&&As(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function O_(c,d,g,C){var M=c.prev,I=c,O=c.next;if(As(M,I,O)>=0)return!1;for(var z=M.x>I.x?M.x>O.x?M.x:O.x:I.x>O.x?I.x:O.x,G=M.y>I.y?M.y>O.y?M.y:O.y:I.y>O.y?I.y:O.y,q=jy(M.x<I.x?M.x<O.x?M.x:O.x:I.x<O.x?I.x:O.x,M.y<I.y?M.y<O.y?M.y:O.y:I.y<O.y?I.y:O.y,d,g,C),re=jy(z,G,d,g,C),oe=c.prevZ,ce=c.nextZ;oe&&oe.z>=q&&ce&&ce.z<=re;){if(oe!==c.prev&&oe!==c.next&&Jc(M.x,M.y,I.x,I.y,O.x,O.y,oe.x,oe.y)&&As(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,ce!==c.prev&&ce!==c.next&&Jc(M.x,M.y,I.x,I.y,O.x,O.y,ce.x,ce.y)&&As(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;oe&&oe.z>=q;){if(oe!==c.prev&&oe!==c.next&&Jc(M.x,M.y,I.x,I.y,O.x,O.y,oe.x,oe.y)&&As(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;ce&&ce.z<=re;){if(ce!==c.prev&&ce!==c.next&&Jc(M.x,M.y,I.x,I.y,O.x,O.y,ce.x,ce.y)&&As(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function Mf(c,d,g){var C=c;do{var M=C.prev,I=C.next.next;!wv(M,I)&&B_(M,C,C.next,I)&&Uh(M,I)&&Uh(I,M)&&(d.push(M.i/g),d.push(C.i/g),d.push(I.i/g),Sv(C),Sv(C.next),C=c=I),C=C.next}while(C!==c);return Kc(C)}function mw(c,d,g,C,M,I){var O=c;do{for(var z=O.next.next;z!==O.prev;){if(O.i!==z.i&&D_(O,z)){var G=Ev(O,z);return O=Kc(O,O.next),G=Kc(G,G.next),gg(O,d,g,C,M,I),void gg(G,d,g,C,M,I)}z=z.next}O=O.next}while(O!==c)}function Mm(c,d){return c.x-d.x}function F_(c,d){if(d=function(C,M){var I,O=M,z=C.x,G=C.y,q=-1/0;do{if(G<=O.y&&G>=O.next.y&&O.next.y!==O.y){var re=O.x+(G-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(re<=z&&re>q){if(q=re,re===z){if(G===O.y)return O;if(G===O.next.y)return O.next}I=O.x<O.next.x?O:O.next}}O=O.next}while(O!==M);if(!I)return null;if(z===q)return I;var oe,ce=I,pe=I.x,De=I.y,$e=1/0;O=I;do z>=O.x&&O.x>=pe&&z!==O.x&&Jc(G<De?z:q,G,pe,De,G<De?q:z,G,O.x,O.y)&&(oe=Math.abs(G-O.y)/(z-O.x),Uh(O,C)&&(oe<$e||oe===$e&&(O.x>I.x||O.x===I.x&&U1(I,O)))&&(I=O,$e=oe)),O=O.next;while(O!==ce);return I}(c,d)){var g=Ev(d,c);Kc(d,d.next),Kc(g,g.next)}}function U1(c,d){return As(c.prev,c,d.prev)<0&&As(d.next,c,c.next)<0}function jy(c,d,g,C,M){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-g)*M)|c<<8))|c<<4))|c<<2))|c<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-C)*M)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function Qc(c){var d=c,g=c;do(d.x<g.x||d.x===g.x&&d.y<g.y)&&(g=d),d=d.next;while(d!==c);return g}function Jc(c,d,g,C,M,I,O,z){return(M-O)*(d-z)-(c-O)*(I-z)>=0&&(c-O)*(C-z)-(g-O)*(d-z)>=0&&(g-O)*(I-z)-(M-O)*(C-z)>=0}function D_(c,d){return c.next.i!==d.i&&c.prev.i!==d.i&&!function(g,C){var M=g;do{if(M.i!==g.i&&M.next.i!==g.i&&M.i!==C.i&&M.next.i!==C.i&&B_(M,M.next,g,C))return!0;M=M.next}while(M!==g);return!1}(c,d)&&(Uh(c,d)&&Uh(d,c)&&function(g,C){var M=g,I=!1,O=(g.x+C.x)/2,z=(g.y+C.y)/2;do M.y>z!=M.next.y>z&&M.next.y!==M.y&&O<(M.next.x-M.x)*(z-M.y)/(M.next.y-M.y)+M.x&&(I=!I),M=M.next;while(M!==g);return I}(c,d)&&(As(c.prev,c,d.prev)||As(c,d.prev,d))||wv(c,d)&&As(c.prev,c,c.next)>0&&As(d.prev,d,d.next)>0)}function As(c,d,g){return(d.y-c.y)*(g.x-d.x)-(d.x-c.x)*(g.y-d.y)}function wv(c,d){return c.x===d.x&&c.y===d.y}function B_(c,d,g,C){var M=Cv(As(c,d,g)),I=Cv(As(c,d,C)),O=Cv(As(g,C,c)),z=Cv(As(g,C,d));return M!==I&&O!==z||!(M!==0||!yg(c,g,d))||!(I!==0||!yg(c,C,d))||!(O!==0||!yg(g,c,C))||!(z!==0||!yg(g,d,C))}function yg(c,d,g){return d.x<=Math.max(c.x,g.x)&&d.x>=Math.min(c.x,g.x)&&d.y<=Math.max(c.y,g.y)&&d.y>=Math.min(c.y,g.y)}function Cv(c){return c>0?1:c<0?-1:0}function Uh(c,d){return As(c.prev,c,c.next)<0?As(c,d,c.next)>=0&&As(c,c.prev,d)>=0:As(c,d,c.prev)<0||As(c,c.next,d)<0}function Ev(c,d){var g=new ef(c.i,c.x,c.y),C=new ef(d.i,d.x,d.y),M=c.next,I=d.prev;return c.next=d,d.prev=c,g.next=M,M.prev=g,C.next=g,g.prev=C,I.next=C,C.prev=I,C}function Lf(c,d,g,C){var M=new ef(c,d,g);return C?(M.next=C.next,M.prev=C,C.next.prev=M,C.next=M):(M.prev=M,M.next=M),M}function Sv(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function ef(c,d,g){this.i=c,this.x=d,this.y=g,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Av(c,d,g,C){for(var M=0,I=d,O=g-C;I<g;I+=C)M+=(c[O]-c[I])*(c[I+1]+c[O+1]),O=I;return M}function Lm(c,d,g,C,M){(function I(O,z,G,q,re){for(;q>G;){if(q-G>600){var oe=q-G+1,ce=z-G+1,pe=Math.log(oe),De=.5*Math.exp(2*pe/3),$e=.5*Math.sqrt(pe*De*(oe-De)/oe)*(ce-oe/2<0?-1:1);I(O,z,Math.max(G,Math.floor(z-ce*De/oe+$e)),Math.min(q,Math.floor(z+(oe-ce)*De/oe+$e)),re)}var tt=O[z],Ze=G,mt=q;for(Dp(O,G,z),re(O[q],tt)>0&&Dp(O,G,q);Ze<mt;){for(Dp(O,Ze,mt),Ze++,mt--;re(O[Ze],tt)<0;)Ze++;for(;re(O[mt],tt)>0;)mt--}re(O[G],tt)===0?Dp(O,G,mt):Dp(O,++mt,q),mt<=z&&(G=mt+1),z<=mt&&(q=mt-1)}})(c,d,g||0,C||c.length-1,M||Wy)}function Dp(c,d,g){var C=c[d];c[d]=c[g],c[g]=C}function Wy(c,d){return c<d?-1:c>d?1:0}function _g(c,d){var g=c.length;if(g<=1)return[c];for(var C,M,I=[],O=0;O<g;O++){var z=ve(c[O]);z!==0&&(c[O].area=Math.abs(z),M===void 0&&(M=z<0),M===z<0?(C&&I.push(C),C=[c[O]]):C.push(c[O]))}if(C&&I.push(C),d>1)for(var G=0;G<I.length;G++)I[G].length<=d||(Lm(I[G],d,1,I[G].length-1,Xy),I[G]=I[G].slice(0,d));return I}function Xy(c,d){return d.area-c.area}function md(c,d,g){for(var C=g.patternDependencies,M=!1,I=0,O=d;I<O.length;I+=1){var z=O[I].paint.get(c+"-pattern");z.isConstant()||(M=!0);var G=z.constantOr(null);G&&(M=!0,C[G.to]=!0,C[G.from]=!0)}return M}function yd(c,d,g,C,M){for(var I=M.patternDependencies,O=0,z=d;O<z.length;O+=1){var G=z[O],q=G.paint.get(c+"-pattern").value;if(q.kind!=="constant"){var re=q.evaluate({zoom:C-1},g,{},M.availableImages),oe=q.evaluate({zoom:C},g,{},M.availableImages),ce=q.evaluate({zoom:C+1},g,{},M.availableImages);oe=oe&&oe.name?oe.name:oe,ce=ce&&ce.name?ce.name:ce,I[re=re&&re.name?re.name:re]=!0,I[oe]=!0,I[ce]=!0,g.patterns[G.id]={min:re,mid:oe,max:ce}}}return g}Tm.deviation=function(c,d,g,C){var M=d&&d.length,I=Math.abs(Av(c,0,M?d[0]*g:c.length,g));if(M)for(var O=0,z=d.length;O<z;O++)I-=Math.abs(Av(c,d[O]*g,O<z-1?d[O+1]*g:c.length,g));var G=0;for(O=0;O<C.length;O+=3){var q=C[O]*g,re=C[O+1]*g,oe=C[O+2]*g;G+=Math.abs((c[q]-c[oe])*(c[re+1]-c[q+1])-(c[q]-c[re])*(c[oe+1]-c[q+1]))}return I===0&&G===0?0:Math.abs((G-I)/I)},Tm.flatten=function(c){for(var d=c[0][0].length,g={vertices:[],holes:[],dimensions:d},C=0,M=0;M<c.length;M++){for(var I=0;I<c[M].length;I++)for(var O=0;O<d;O++)g.vertices.push(c[M][I][O]);M>0&&g.holes.push(C+=c[M-1].length)}return g},Am.default=_a;var ec=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ef,this.indexArray=new Bh,this.indexArray2=new Pp,this.programConfigurations=new Tn(c.layers,c.zoom),this.segments=new xe,this.segments2=new xe,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};ec.prototype.populate=function(c,d,g){this.hasPattern=md("fill",this.layers,d);for(var C=this.layers[0].layout.get("fill-sort-key"),M=[],I=0,O=c;I<O.length;I+=1){var z=O[I],G=z.feature,q=z.id,re=z.index,oe=z.sourceLayerIndex,ce=this.layers[0]._featureFilter.needGeometry,pe=no(G,ce);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),pe,g)){var De=C?C.evaluate(pe,{},g,d.availableImages):void 0,$e={id:q,properties:G.properties,type:G.type,sourceLayerIndex:oe,index:re,geometry:ce?pe.geometry:vo(G),patterns:{},sortKey:De};M.push($e)}}C&&M.sort(function(Mr,Wr){return Mr.sortKey-Wr.sortKey});for(var tt=0,Ze=M;tt<Ze.length;tt+=1){var mt=Ze[tt],At=mt.geometry,Nt=mt.index,Vt=mt.sourceLayerIndex;if(this.hasPattern){var ir=yd("fill",this.layers,mt,this.zoom,d);this.patternFeatures.push(ir)}else this.addFeature(mt,At,Nt,g,{});d.featureIndex.insert(c[Nt].feature,At,Nt,Vt,this.index)}},ec.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},ec.prototype.addFeatures=function(c,d,g){for(var C=0,M=this.patternFeatures;C<M.length;C+=1){var I=M[C];this.addFeature(I,I.geometry,I.index,d,g)}},ec.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ec.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ec.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,vg),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0},ec.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ec.prototype.addFeature=function(c,d,g,C,M){for(var I=0,O=_g(d,500);I<O.length;I+=1){for(var z=O[I],G=0,q=0,re=z;q<re.length;q+=1)G+=re[q].length;for(var oe=this.segments.prepareSegment(G,this.layoutVertexArray,this.indexArray),ce=oe.vertexLength,pe=[],De=[],$e=0,tt=z;$e<tt.length;$e+=1){var Ze=tt[$e];if(Ze.length!==0){Ze!==z[0]&&De.push(pe.length/2);var mt=this.segments2.prepareSegment(Ze.length,this.layoutVertexArray,this.indexArray2),At=mt.vertexLength;this.layoutVertexArray.emplaceBack(Ze[0].x,Ze[0].y),this.indexArray2.emplaceBack(At+Ze.length-1,At),pe.push(Ze[0].x),pe.push(Ze[0].y);for(var Nt=1;Nt<Ze.length;Nt++)this.layoutVertexArray.emplaceBack(Ze[Nt].x,Ze[Nt].y),this.indexArray2.emplaceBack(At+Nt-1,At+Nt),pe.push(Ze[Nt].x),pe.push(Ze[Nt].y);mt.vertexLength+=Ze.length,mt.primitiveLength+=Ze.length}}for(var Vt=Am(pe,De),ir=0;ir<Vt.length;ir+=3)this.indexArray.emplaceBack(ce+Vt[ir],ce+Vt[ir+1],ce+Vt[ir+2]);oe.vertexLength+=G,oe.primitiveLength+=Vt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,M,C)},dn("FillBucket",ec,{omit:["layers","patternFeatures"]});var xg=new uu({"fill-sort-key":new _n(_e.layout_fill["fill-sort-key"])}),bg={paint:new uu({"fill-antialias":new Pn(_e.paint_fill["fill-antialias"]),"fill-opacity":new _n(_e.paint_fill["fill-opacity"]),"fill-color":new _n(_e.paint_fill["fill-color"]),"fill-outline-color":new _n(_e.paint_fill["fill-outline-color"]),"fill-translate":new Pn(_e.paint_fill["fill-translate"]),"fill-translate-anchor":new Pn(_e.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xf(_e.paint_fill["fill-pattern"])}),layout:xg},Pl=function(c){function d(g){c.call(this,g,bg)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,C){c.prototype.recalculate.call(this,g,C);var M=this.paint._values["fill-outline-color"];M.value.kind==="constant"&&M.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(g){return new ec(g)},d.prototype.queryRadius=function(){return Ns(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(g,C,M,I,O,z,G){return dc(Ql(g,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,G),I)},d.prototype.isTileClipped=function(){return!0},d}(Wc),mc=Es([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,_d=Tv;function Tv(c,d,g,C,M){this.properties={},this.extent=g,this.type=0,this._pbf=c,this._geometry=-1,this._keys=C,this._values=M,c.readFields(wg,this,d)}function wg(c,d,g){c==1?d.id=g.readVarint():c==2?function(C,M){for(var I=C.readVarint()+C.pos;C.pos<I;){var O=M._keys[C.readVarint()],z=M._values[C.readVarint()];M.properties[O]=z}}(g,d):c==3?d.type=g.readVarint():c==4&&(d._geometry=g.pos)}function Cg(c){for(var d,g,C=0,M=0,I=c.length,O=I-1;M<I;O=M++)C+=((g=c[O]).x-(d=c[M]).x)*(d.y+g.y);return C}Tv.types=["Unknown","Point","LineString","Polygon"],Tv.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d,g=c.readVarint()+c.pos,C=1,M=0,I=0,O=0,z=[];c.pos<g;){if(M<=0){var G=c.readVarint();C=7&G,M=G>>3}if(M--,C===1||C===2)I+=c.readSVarint(),O+=c.readSVarint(),C===1&&(d&&z.push(d),d=[]),d.push(new f(I,O));else{if(C!==7)throw new Error("unknown command "+C);d&&d.push(d[0].clone())}}return d&&z.push(d),z},Tv.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,g=1,C=0,M=0,I=0,O=1/0,z=-1/0,G=1/0,q=-1/0;c.pos<d;){if(C<=0){var re=c.readVarint();g=7&re,C=re>>3}if(C--,g===1||g===2)(M+=c.readSVarint())<O&&(O=M),M>z&&(z=M),(I+=c.readSVarint())<G&&(G=I),I>q&&(q=I);else if(g!==7)throw new Error("unknown command "+g)}return[O,G,z,q]},Tv.prototype.toGeoJSON=function(c,d,g){var C,M,I=this.extent*Math.pow(2,g),O=this.extent*c,z=this.extent*d,G=this.loadGeometry(),q=Tv.types[this.type];function re(pe){for(var De=0;De<pe.length;De++){var $e=pe[De];pe[De]=[360*($e.x+O)/I-180,360/Math.PI*Math.atan(Math.exp((180-360*($e.y+z)/I)*Math.PI/180))-90]}}switch(this.type){case 1:var oe=[];for(C=0;C<G.length;C++)oe[C]=G[C][0];re(G=oe);break;case 2:for(C=0;C<G.length;C++)re(G[C]);break;case 3:for(G=function(pe){var De=pe.length;if(De<=1)return[pe];for(var $e,tt,Ze=[],mt=0;mt<De;mt++){var At=Cg(pe[mt]);At!==0&&(tt===void 0&&(tt=At<0),tt===At<0?($e&&Ze.push($e),$e=[pe[mt]]):$e.push(pe[mt]))}return $e&&Ze.push($e),Ze}(G),C=0;C<G.length;C++)for(M=0;M<G[C].length;M++)re(G[C][M])}G.length===1?G=G[0]:q="Multi"+q;var ce={type:"Feature",geometry:{type:q,coordinates:G},properties:this.properties};return"id"in this&&(ce.id=this.id),ce};var N_=z_;function z_(c,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(xd,this,d),this.length=this._features.length}function xd(c,d,g){c===15?d.version=g.readVarint():c===1?d.name=g.readString():c===5?d.extent=g.readVarint():c===2?d._features.push(g.pos):c===3?d._keys.push(g.readString()):c===4&&d._values.push(function(C){for(var M=null,I=C.readVarint()+C.pos;C.pos<I;){var O=C.readVarint()>>3;M=O===1?C.readString():O===2?C.readFloat():O===3?C.readDouble():O===4?C.readVarint64():O===5?C.readVarint():O===6?C.readSVarint():O===7?C.readBoolean():null}return M}(g))}function $_(c,d,g){if(c===3){var C=new N_(g,g.readVarint()+g.pos);C.length&&(d[C.name]=C)}}z_.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var d=this._pbf.readVarint()+this._pbf.pos;return new _d(this._pbf,d,this.extent,this._keys,this._values)};var If={VectorTile:function(c,d){this.layers=c.readFields($_,{},d)},VectorTileFeature:_d,VectorTileLayer:N_},Eg=If.VectorTileFeature.types,U_=Math.pow(2,13);function Mv(c,d,g,C,M,I,O,z){c.emplaceBack(d,g,2*Math.floor(C*U_)+O,M*U_*2,I*U_*2,Math.round(z))}var kf=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Fu,this.indexArray=new Bh,this.programConfigurations=new Tn(c.layers,c.zoom),this.segments=new xe,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function tf(c,d){return c.x===d.x&&(c.x<0||c.x>8192)||c.y===d.y&&(c.y<0||c.y>8192)}kf.prototype.populate=function(c,d,g){this.features=[],this.hasPattern=md("fill-extrusion",this.layers,d);for(var C=0,M=c;C<M.length;C+=1){var I=M[C],O=I.feature,z=I.id,G=I.index,q=I.sourceLayerIndex,re=this.layers[0]._featureFilter.needGeometry,oe=no(O,re);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),oe,g)){var ce={id:z,sourceLayerIndex:q,index:G,geometry:re?oe.geometry:vo(O),properties:O.properties,type:O.type,patterns:{}};this.hasPattern?this.features.push(yd("fill-extrusion",this.layers,ce,this.zoom,d)):this.addFeature(ce,ce.geometry,G,g,{}),d.featureIndex.insert(O,ce.geometry,G,q,this.index,!0)}}},kf.prototype.addFeatures=function(c,d,g){for(var C=0,M=this.features;C<M.length;C+=1){var I=M[C];this.addFeature(I,I.geometry,I.index,d,g)}},kf.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},kf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},kf.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},kf.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,mc),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},kf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},kf.prototype.addFeature=function(c,d,g,C,M){for(var I=0,O=_g(d,500);I<O.length;I+=1){for(var z=O[I],G=0,q=0,re=z;q<re.length;q+=1)G+=re[q].length;for(var oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ce=0,pe=z;ce<pe.length;ce+=1){var De=pe[ce];if(De.length!==0&&!((Xi=De).every(function(Mi){return Mi.x<0})||Xi.every(function(Mi){return Mi.x>8192})||Xi.every(function(Mi){return Mi.y<0})||Xi.every(function(Mi){return Mi.y>8192})))for(var $e=0,tt=0;tt<De.length;tt++){var Ze=De[tt];if(tt>=1){var mt=De[tt-1];if(!tf(Ze,mt)){oe.vertexLength+4>xe.MAX_VERTEX_ARRAY_LENGTH&&(oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var At=Ze.sub(mt)._perp()._unit(),Nt=mt.dist(Ze);$e+Nt>32768&&($e=0),Mv(this.layoutVertexArray,Ze.x,Ze.y,At.x,At.y,0,0,$e),Mv(this.layoutVertexArray,Ze.x,Ze.y,At.x,At.y,0,1,$e),Mv(this.layoutVertexArray,mt.x,mt.y,At.x,At.y,0,0,$e+=Nt),Mv(this.layoutVertexArray,mt.x,mt.y,At.x,At.y,0,1,$e);var Vt=oe.vertexLength;this.indexArray.emplaceBack(Vt,Vt+2,Vt+1),this.indexArray.emplaceBack(Vt+1,Vt+2,Vt+3),oe.vertexLength+=4,oe.primitiveLength+=2}}}}if(oe.vertexLength+G>xe.MAX_VERTEX_ARRAY_LENGTH&&(oe=this.segments.prepareSegment(G,this.layoutVertexArray,this.indexArray)),Eg[c.type]==="Polygon"){for(var ir=[],Mr=[],Wr=oe.vertexLength,Vn=0,fn=z;Vn<fn.length;Vn+=1){var Yn=fn[Vn];if(Yn.length!==0){Yn!==z[0]&&Mr.push(ir.length/2);for(var gn=0;gn<Yn.length;gn++){var Fi=Yn[gn];Mv(this.layoutVertexArray,Fi.x,Fi.y,0,0,1,1,0),ir.push(Fi.x),ir.push(Fi.y)}}}for(var ai=Am(ir,Mr),In=0;In<ai.length;In+=3)this.indexArray.emplaceBack(Wr+ai[In],Wr+ai[In+2],Wr+ai[In+1]);oe.primitiveLength+=ai.length/3,oe.vertexLength+=G}}var Xi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,M,C)},dn("FillExtrusionBucket",kf,{omit:["layers","features"]});var V_={paint:new uu({"fill-extrusion-opacity":new Pn(_e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _n(_e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Pn(_e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Pn(_e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xf(_e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _n(_e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _n(_e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Pn(_e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Bp=function(c){function d(g){c.call(this,g,V_)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new kf(g)},d.prototype.queryRadius=function(){return Ns(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(g,C,M,I,O,z,G,q){var re=Ql(g,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,G),oe=this.paint.get("fill-extrusion-height").evaluate(C,M),ce=this.paint.get("fill-extrusion-base").evaluate(C,M),pe=function($e,tt,Ze,mt){for(var At=[],Nt=0,Vt=$e;Nt<Vt.length;Nt+=1){var ir=Vt[Nt],Mr=[ir.x,ir.y,0,1];kl(Mr,Mr,tt),At.push(new f(Mr[0]/Mr[3],Mr[1]/Mr[3]))}return At}(re,q),De=function($e,tt,Ze,mt){for(var At=[],Nt=[],Vt=mt[8]*tt,ir=mt[9]*tt,Mr=mt[10]*tt,Wr=mt[11]*tt,Vn=mt[8]*Ze,fn=mt[9]*Ze,Yn=mt[10]*Ze,gn=mt[11]*Ze,Fi=0,ai=$e;Fi<ai.length;Fi+=1){for(var In=[],Xi=[],Mi=0,ca=ai[Fi];Mi<ca.length;Mi+=1){var Zn=ca[Mi],Ia=Zn.x,qo=Zn.y,Ko=mt[0]*Ia+mt[4]*qo+mt[12],zo=mt[1]*Ia+mt[5]*qo+mt[13],Qo=mt[2]*Ia+mt[6]*qo+mt[14],Ms=mt[3]*Ia+mt[7]*qo+mt[15],Js=Qo+Mr,hu=Ms+Wr,Ol=Ko+Vn,$u=zo+fn,Fl=Qo+Yn,$s=Ms+gn,Uu=new f((Ko+Vt)/hu,(zo+ir)/hu);Uu.z=Js/hu,In.push(Uu);var na=new f(Ol/$s,$u/$s);na.z=Fl/$s,Xi.push(na)}At.push(In),Nt.push(Xi)}return[At,Nt]}(I,ce,oe,q);return function($e,tt,Ze){var mt=1/0;dc(Ze,tt)&&(mt=Sg(Ze,tt[0]));for(var At=0;At<tt.length;At++)for(var Nt=tt[At],Vt=$e[At],ir=0;ir<Nt.length-1;ir++){var Mr=Nt[ir],Wr=[Mr,Nt[ir+1],Vt[ir+1],Vt[ir],Mr];Xc(Ze,Wr)&&(mt=Math.min(mt,Sg(Ze,Wr)))}return mt!==1/0&&mt}(De[0],De[1],pe)},d}(Wc);function yc(c,d){return c.x*d.x+c.y*d.y}function Sg(c,d){if(c.length===1){for(var g,C=0,M=d[C++];!g||M.equals(g);)if(!(g=d[C++]))return 1/0;for(;C<d.length;C++){var I=d[C],O=c[0],z=g.sub(M),G=I.sub(M),q=O.sub(M),re=yc(z,z),oe=yc(z,G),ce=yc(G,G),pe=yc(q,z),De=yc(q,G),$e=re*ce-oe*oe,tt=(ce*pe-oe*De)/$e,Ze=(re*De-oe*pe)/$e,mt=M.z*(1-tt-Ze)+g.z*tt+I.z*Ze;if(isFinite(mt))return mt}return 1/0}for(var At=1/0,Nt=0,Vt=d;Nt<Vt.length;Nt+=1)At=Math.min(At,Vt[Nt].z);return At}var G_=Es([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Im=Es([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,km=If.VectorTileFeature.types,lu=Math.cos(Math.PI/180*37.5),Qf=Math.pow(2,14)/.5,Ca=function(c){var d=this;this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(g){return g.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(g){d.gradients[g.id]={}}),this.layoutVertexArray=new Eu,this.layoutVertexArray2=new Su,this.indexArray=new Bh,this.programConfigurations=new Tn(c.layers,c.zoom),this.segments=new xe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(g){return g.isStateDependent()}).map(function(g){return g.id})};Ca.prototype.populate=function(c,d,g){this.hasPattern=md("line",this.layers,d);for(var C=this.layers[0].layout.get("line-sort-key"),M=[],I=0,O=c;I<O.length;I+=1){var z=O[I],G=z.feature,q=z.id,re=z.index,oe=z.sourceLayerIndex,ce=this.layers[0]._featureFilter.needGeometry,pe=no(G,ce);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),pe,g)){var De=C?C.evaluate(pe,{},g):void 0,$e={id:q,properties:G.properties,type:G.type,sourceLayerIndex:oe,index:re,geometry:ce?pe.geometry:vo(G),patterns:{},sortKey:De};M.push($e)}}C&&M.sort(function(Mr,Wr){return Mr.sortKey-Wr.sortKey});for(var tt=0,Ze=M;tt<Ze.length;tt+=1){var mt=Ze[tt],At=mt.geometry,Nt=mt.index,Vt=mt.sourceLayerIndex;if(this.hasPattern){var ir=yd("line",this.layers,mt,this.zoom,d);this.patternFeatures.push(ir)}else this.addFeature(mt,At,Nt,g,{});d.featureIndex.insert(c[Nt].feature,At,Nt,Vt,this.index)}},Ca.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Ca.prototype.addFeatures=function(c,d,g){for(var C=0,M=this.patternFeatures;C<M.length;C+=1){var I=M[C];this.addFeature(I,I.geometry,I.index,d,g)}},Ca.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ca.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ca.prototype.upload=function(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,Im)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,G_),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},Ca.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ca.prototype.lineFeatureClips=function(c){if(c.properties&&c.properties.hasOwnProperty("mapbox_clip_start")&&c.properties.hasOwnProperty("mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}},Ca.prototype.addFeature=function(c,d,g,C,M){var I=this.layers[0].layout,O=I.get("line-join").evaluate(c,{}),z=I.get("line-cap"),G=I.get("line-miter-limit"),q=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(var re=0,oe=d;re<oe.length;re+=1)this.addLine(oe[re],c,O,z,G,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,M,C)},Ca.prototype.addLine=function(c,d,g,C,M,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var O=0;O<c.length-1;O++)this.totalDistance+=c[O].dist(c[O+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var z=km[d.type]==="Polygon",G=c.length;G>=2&&c[G-1].equals(c[G-2]);)G--;for(var q=0;q<G-1&&c[q].equals(c[q+1]);)q++;if(!(G<(z?3:2))){g==="bevel"&&(M=1.05);var re,oe=this.overscaling<=16?122880/(512*this.overscaling):0,ce=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray),pe=void 0,De=void 0,$e=void 0,tt=void 0;this.e1=this.e2=-1,z&&(tt=c[q].sub(re=c[G-2])._unit()._perp());for(var Ze=q;Ze<G;Ze++)if(!(De=Ze===G-1?z?c[q+1]:void 0:c[Ze+1])||!c[Ze].equals(De)){tt&&($e=tt),re&&(pe=re),re=c[Ze],tt=De?De.sub(re)._unit()._perp():$e;var mt=($e=$e||tt).add(tt);mt.x===0&&mt.y===0||mt._unit();var At=$e.x*tt.x+$e.y*tt.y,Nt=mt.x*tt.x+mt.y*tt.y,Vt=Nt!==0?1/Nt:1/0,ir=2*Math.sqrt(2-2*Nt),Mr=Nt<lu&&pe&&De,Wr=$e.x*tt.y-$e.y*tt.x>0;if(Mr&&Ze>q){var Vn=re.dist(pe);if(Vn>2*oe){var fn=re.sub(re.sub(pe)._mult(oe/Vn)._round());this.updateDistance(pe,fn),this.addCurrentVertex(fn,$e,0,0,ce),pe=fn}}var Yn=pe&&De,gn=Yn?g:z?"butt":C;if(Yn&&gn==="round"&&(Vt<I?gn="miter":Vt<=2&&(gn="fakeround")),gn==="miter"&&Vt>M&&(gn="bevel"),gn==="bevel"&&(Vt>2&&(gn="flipbevel"),Vt<M&&(gn="miter")),pe&&this.updateDistance(pe,re),gn==="miter")mt._mult(Vt),this.addCurrentVertex(re,mt,0,0,ce);else if(gn==="flipbevel"){if(Vt>100)mt=tt.mult(-1);else{var Fi=Vt*$e.add(tt).mag()/$e.sub(tt).mag();mt._perp()._mult(Fi*(Wr?-1:1))}this.addCurrentVertex(re,mt,0,0,ce),this.addCurrentVertex(re,mt.mult(-1),0,0,ce)}else if(gn==="bevel"||gn==="fakeround"){var ai=-Math.sqrt(Vt*Vt-1),In=Wr?ai:0,Xi=Wr?0:ai;if(pe&&this.addCurrentVertex(re,$e,In,Xi,ce),gn==="fakeround")for(var Mi=Math.round(180*ir/Math.PI/20),ca=1;ca<Mi;ca++){var Zn=ca/Mi;if(Zn!==.5){var Ia=Zn-.5;Zn+=Zn*Ia*(Zn-1)*((1.0904+At*(At*(3.55645-1.43519*At)-3.2452))*Ia*Ia+(.848013+At*(.215638*At-1.06021)))}var qo=tt.sub($e)._mult(Zn)._add($e)._unit()._mult(Wr?-1:1);this.addHalfVertex(re,qo.x,qo.y,!1,Wr,0,ce)}De&&this.addCurrentVertex(re,tt,-In,-Xi,ce)}else if(gn==="butt")this.addCurrentVertex(re,mt,0,0,ce);else if(gn==="square"){var Ko=pe?1:-1;this.addCurrentVertex(re,mt,Ko,Ko,ce)}else gn==="round"&&(pe&&(this.addCurrentVertex(re,$e,0,0,ce),this.addCurrentVertex(re,$e,1,1,ce,!0)),De&&(this.addCurrentVertex(re,tt,-1,-1,ce,!0),this.addCurrentVertex(re,tt,0,0,ce)));if(Mr&&Ze<G-1){var zo=re.dist(De);if(zo>2*oe){var Qo=re.add(De.sub(re)._mult(oe/zo)._round());this.updateDistance(re,Qo),this.addCurrentVertex(Qo,tt,0,0,ce),re=Qo}}}}},Ca.prototype.addCurrentVertex=function(c,d,g,C,M,I){I===void 0&&(I=!1);var O=d.y*C-d.x,z=-d.y-d.x*C;this.addHalfVertex(c,d.x+d.y*g,d.y-d.x*g,I,!1,g,M),this.addHalfVertex(c,O,z,I,!0,-C,M),this.distance>Qf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(c,d,g,C,M,I))},Ca.prototype.addHalfVertex=function(c,d,g,C,M,I,O){var z=.5*(this.lineClips?this.scaledDistance*(Qf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c.x<<1)+(C?1:0),(c.y<<1)+(M?1:0),Math.round(63*d)+128,Math.round(63*g)+128,1+(I===0?0:I<0?-1:1)|(63&z)<<2,z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var G=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,G),O.primitiveLength++),M?this.e2=G:this.e1=G},Ca.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ca.prototype.updateDistance=function(c,d){this.distance+=c.dist(d),this.updateScaledDistance()},dn("LineBucket",Ca,{omit:["layers","patternFeatures"]});var tc=new uu({"line-cap":new Pn(_e.layout_line["line-cap"]),"line-join":new _n(_e.layout_line["line-join"]),"line-miter-limit":new Pn(_e.layout_line["line-miter-limit"]),"line-round-limit":new Pn(_e.layout_line["line-round-limit"]),"line-sort-key":new _n(_e.layout_line["line-sort-key"])}),Jf={paint:new uu({"line-opacity":new _n(_e.paint_line["line-opacity"]),"line-color":new _n(_e.paint_line["line-color"]),"line-translate":new Pn(_e.paint_line["line-translate"]),"line-translate-anchor":new Pn(_e.paint_line["line-translate-anchor"]),"line-width":new _n(_e.paint_line["line-width"]),"line-gap-width":new _n(_e.paint_line["line-gap-width"]),"line-offset":new _n(_e.paint_line["line-offset"]),"line-blur":new _n(_e.paint_line["line-blur"]),"line-dasharray":new Ys(_e.paint_line["line-dasharray"]),"line-pattern":new Xf(_e.paint_line["line-pattern"]),"line-gradient":new Ou(_e.paint_line["line-gradient"])}),layout:tc},H_=new(function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,C){return C=new ti(Math.floor(C.zoom),{now:C.now,fadeDuration:C.fadeDuration,zoomHistory:C.zoomHistory,transition:C.transition}),c.prototype.possiblyEvaluate.call(this,g,C)},d.prototype.evaluate=function(g,C,M,I){return C=L({},C,{zoom:Math.floor(C.zoom)}),c.prototype.evaluate.call(this,g,C,M,I)},d}(_n))(Jf.paint.properties["line-width"].specification);H_.useIntegerZoom=!0;var V1=function(c){function d(g){c.call(this,g,Jf),this.gradientVersion=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ea,this.gradientVersion=(this.gradientVersion+1)%v)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(g,C){c.prototype.recalculate.call(this,g,C),this.paint._values["line-floorwidth"]=H_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,g)},d.prototype.createBucket=function(g){return new Ca(g)},d.prototype.queryRadius=function(g){var C=g,M=G1(qc("line-width",this,C),qc("line-gap-width",this,C)),I=qc("line-offset",this,C);return M/2+Math.abs(I)+Ns(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(g,C,M,I,O,z,G){var q=Ql(g,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,G),re=G/2*G1(this.paint.get("line-width").evaluate(C,M),this.paint.get("line-gap-width").evaluate(C,M)),oe=this.paint.get("line-offset").evaluate(C,M);return oe&&(I=function(ce,pe){for(var De=[],$e=new f(0,0),tt=0;tt<ce.length;tt++){for(var Ze=ce[tt],mt=[],At=0;At<Ze.length;At++){var Nt=Ze[At],Vt=Ze[At+1],ir=At===0?$e:Nt.sub(Ze[At-1])._unit()._perp(),Mr=At===Ze.length-1?$e:Vt.sub(Nt)._unit()._perp(),Wr=ir._add(Mr)._unit();Wr._mult(1/(Wr.x*Mr.x+Wr.y*Mr.y)),mt.push(Wr._mult(pe)._add(Nt))}De.push(mt)}return De}(I,oe*G)),function(ce,pe,De){for(var $e=0;$e<pe.length;$e++){var tt=pe[$e];if(ce.length>=3){for(var Ze=0;Ze<tt.length;Ze++)if(Yc(ce,tt[Ze]))return!0}if(ql(ce,tt,De))return!0}return!1}(q,I,re)},d.prototype.isTileClipped=function(){return!0},d}(Wc);function G1(c,d){return d>0?d+2*c:c}var H1=Es([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),j1=Es([{name:"a_projected_pos",components:3,type:"Float32"}],4),yw=(Es([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Es([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Vh=(Es([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Es([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),j_=Es([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function W_(c,d,g){return c.sections.forEach(function(C){C.text=function(M,I,O){var z=I.layout.get("text-transform").evaluate(O,{});return z==="uppercase"?M=M.toLocaleUpperCase():z==="lowercase"&&(M=M.toLocaleLowerCase()),Ml.applyArabicShaping&&(M=Ml.applyArabicShaping(M)),M}(C.text,d,g)}),c}Es([{name:"triangle",components:3,type:"Uint16"}]),Es([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Es([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Es([{type:"Float32",name:"offsetX"}]),Es([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Lv={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ag=function(c,d,g,C,M){var I,O,z=8*M-C-1,G=(1<<z)-1,q=G>>1,re=-7,oe=g?M-1:0,ce=g?-1:1,pe=c[d+oe];for(oe+=ce,I=pe&(1<<-re)-1,pe>>=-re,re+=z;re>0;I=256*I+c[d+oe],oe+=ce,re-=8);for(O=I&(1<<-re)-1,I>>=-re,re+=C;re>0;O=256*O+c[d+oe],oe+=ce,re-=8);if(I===0)I=1-q;else{if(I===G)return O?NaN:1/0*(pe?-1:1);O+=Math.pow(2,C),I-=q}return(pe?-1:1)*O*Math.pow(2,I-C)},bd=function(c,d,g,C,M,I){var O,z,G,q=8*I-M-1,re=(1<<q)-1,oe=re>>1,ce=M===23?Math.pow(2,-24)-Math.pow(2,-77):0,pe=C?0:I-1,De=C?1:-1,$e=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(z=isNaN(d)?1:0,O=re):(O=Math.floor(Math.log(d)/Math.LN2),d*(G=Math.pow(2,-O))<1&&(O--,G*=2),(d+=O+oe>=1?ce/G:ce*Math.pow(2,1-oe))*G>=2&&(O++,G/=2),O+oe>=re?(z=0,O=re):O+oe>=1?(z=(d*G-1)*Math.pow(2,M),O+=oe):(z=d*Math.pow(2,oe-1)*Math.pow(2,M),O=0));M>=8;c[g+pe]=255&z,pe+=De,z/=256,M-=8);for(O=O<<M|z,q+=M;q>0;c[g+pe]=255&O,pe+=De,O/=256,q-=8);c[g+pe-De]|=128*$e},yi=ja;function ja(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}ja.Varint=0,ja.Fixed64=1,ja.Bytes=2,ja.Fixed32=5;var Yy=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Rl(c){return c.type===ja.Bytes?c.readVarint()+c.pos:c.pos+1}function Tg(c,d,g){return g?4294967296*d+(c>>>0):4294967296*(d>>>0)+(c>>>0)}function Z(c,d,g){var C=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));g.realloc(C);for(var M=g.pos-1;M>=c;M--)g.buf[M+C]=g.buf[M]}function Se(c,d){for(var g=0;g<c.length;g++)d.writeVarint(c[g])}function Ve(c,d){for(var g=0;g<c.length;g++)d.writeSVarint(c[g])}function Rt(c,d){for(var g=0;g<c.length;g++)d.writeFloat(c[g])}function tr(c,d){for(var g=0;g<c.length;g++)d.writeDouble(c[g])}function kt(c,d){for(var g=0;g<c.length;g++)d.writeBoolean(c[g])}function Yt(c,d){for(var g=0;g<c.length;g++)d.writeFixed32(c[g])}function sr(c,d){for(var g=0;g<c.length;g++)d.writeSFixed32(c[g])}function mr(c,d){for(var g=0;g<c.length;g++)d.writeFixed64(c[g])}function Cr(c,d){for(var g=0;g<c.length;g++)d.writeSFixed64(c[g])}function wr(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+16777216*c[d+3]}function dr(c,d,g){c[g]=d,c[g+1]=d>>>8,c[g+2]=d>>>16,c[g+3]=d>>>24}function xr(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+(c[d+3]<<24)}function vr(c,d,g){c===1&&g.readMessage(Er,d)}function Er(c,d,g){if(c===3){var C=g.readMessage(_t,{}),M=C.width,I=C.height,O=C.left,z=C.top,G=C.advance;d.push({id:C.id,bitmap:new gc({width:M+6,height:I+6},C.bitmap),metrics:{width:M,height:I,left:O,top:z,advance:G}})}}function _t(c,d,g){c===1?d.id=g.readVarint():c===2?d.bitmap=g.readBytes():c===3?d.width=g.readVarint():c===4?d.height=g.readVarint():c===5?d.left=g.readSVarint():c===6?d.top=g.readSVarint():c===7&&(d.advance=g.readVarint())}function Gt(c){for(var d=0,g=0,C=0,M=c;C<M.length;C+=1){var I=M[C];d+=I.w*I.h,g=Math.max(g,I.w)}c.sort(function($e,tt){return tt.h-$e.h});for(var O=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),g),h:1/0}],z=0,G=0,q=0,re=c;q<re.length;q+=1)for(var oe=re[q],ce=O.length-1;ce>=0;ce--){var pe=O[ce];if(!(oe.w>pe.w||oe.h>pe.h)){if(oe.x=pe.x,oe.y=pe.y,G=Math.max(G,oe.y+oe.h),z=Math.max(z,oe.x+oe.w),oe.w===pe.w&&oe.h===pe.h){var De=O.pop();ce<O.length&&(O[ce]=De)}else oe.h===pe.h?(pe.x+=oe.w,pe.w-=oe.w):oe.w===pe.w?(pe.y+=oe.h,pe.h-=oe.h):(O.push({x:pe.x+oe.w,y:pe.y,w:pe.w-oe.w,h:oe.h}),pe.y+=oe.h,pe.h-=oe.h);break}}return{w:z,h:G,fill:d/(z*G)||0}}ja.prototype={destroy:function(){this.buf=null},readFields:function(c,d,g){for(g=g||this.length;this.pos<g;){var C=this.readVarint(),M=C>>3,I=this.pos;this.type=7&C,c(M,d,this),this.pos===I&&this.skip(C)}return d},readMessage:function(c,d){return this.readFields(c,d,this.readVarint()+this.pos)},readFixed32:function(){var c=wr(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=xr(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=wr(this.buf,this.pos)+4294967296*wr(this.buf,this.pos+4);return this.pos+=8,c},readSFixed64:function(){var c=wr(this.buf,this.pos)+4294967296*xr(this.buf,this.pos+4);return this.pos+=8,c},readFloat:function(){var c=Ag(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=Ag(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var d,g,C=this.buf;return d=127&(g=C[this.pos++]),g<128?d:(d|=(127&(g=C[this.pos++]))<<7,g<128?d:(d|=(127&(g=C[this.pos++]))<<14,g<128?d:(d|=(127&(g=C[this.pos++]))<<21,g<128?d:function(M,I,O){var z,G,q=O.buf;if(z=(112&(G=q[O.pos++]))>>4,G<128||(z|=(127&(G=q[O.pos++]))<<3,G<128)||(z|=(127&(G=q[O.pos++]))<<10,G<128)||(z|=(127&(G=q[O.pos++]))<<17,G<128)||(z|=(127&(G=q[O.pos++]))<<24,G<128)||(z|=(1&(G=q[O.pos++]))<<31,G<128))return Tg(M,z,I);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(g=C[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var c=this.readVarint()+this.pos,d=this.pos;return this.pos=c,c-d>=12&&Yy?function(g,C,M){return Yy.decode(g.subarray(C,M))}(this.buf,d,c):function(g,C,M){for(var I="",O=C;O<M;){var z,G,q,re=g[O],oe=null,ce=re>239?4:re>223?3:re>191?2:1;if(O+ce>M)break;ce===1?re<128&&(oe=re):ce===2?(192&(z=g[O+1]))==128&&(oe=(31&re)<<6|63&z)<=127&&(oe=null):ce===3?(G=g[O+2],(192&(z=g[O+1]))==128&&(192&G)==128&&((oe=(15&re)<<12|(63&z)<<6|63&G)<=2047||oe>=55296&&oe<=57343)&&(oe=null)):ce===4&&(G=g[O+2],q=g[O+3],(192&(z=g[O+1]))==128&&(192&G)==128&&(192&q)==128&&((oe=(15&re)<<18|(63&z)<<12|(63&G)<<6|63&q)<=65535||oe>=1114112)&&(oe=null)),oe===null?(oe=65533,ce=1):oe>65535&&(oe-=65536,I+=String.fromCharCode(oe>>>10&1023|55296),oe=56320|1023&oe),I+=String.fromCharCode(oe),O+=ce}return I}(this.buf,d,c)},readBytes:function(){var c=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,c);return this.pos=c,d},readPackedVarint:function(c,d){if(this.type!==ja.Bytes)return c.push(this.readVarint(d));var g=Rl(this);for(c=c||[];this.pos<g;)c.push(this.readVarint(d));return c},readPackedSVarint:function(c){if(this.type!==ja.Bytes)return c.push(this.readSVarint());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==ja.Bytes)return c.push(this.readBoolean());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==ja.Bytes)return c.push(this.readFloat());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==ja.Bytes)return c.push(this.readDouble());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==ja.Bytes)return c.push(this.readFixed32());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==ja.Bytes)return c.push(this.readSFixed32());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==ja.Bytes)return c.push(this.readFixed64());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==ja.Bytes)return c.push(this.readSFixed64());var d=Rl(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed64());return c},skip:function(c){var d=7&c;if(d===ja.Varint)for(;this.buf[this.pos++]>127;);else if(d===ja.Bytes)this.pos=this.readVarint()+this.pos;else if(d===ja.Fixed32)this.pos+=4;else{if(d!==ja.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(c,d){this.writeVarint(c<<3|d)},realloc:function(c){for(var d=this.length||16;d<this.pos+c;)d*=2;if(d!==this.length){var g=new Uint8Array(d);g.set(this.buf),this.buf=g,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),dr(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),dr(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),dr(this.buf,-1&c,this.pos),dr(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),dr(this.buf,-1&c,this.pos),dr(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(d,g){var C,M;if(d>=0?(C=d%4294967296|0,M=d/4294967296|0):(M=~(-d/4294967296),4294967295^(C=~(-d%4294967296))?C=C+1|0:(C=0,M=M+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(I,O,z){z.buf[z.pos++]=127&I|128,I>>>=7,z.buf[z.pos++]=127&I|128,I>>>=7,z.buf[z.pos++]=127&I|128,I>>>=7,z.buf[z.pos++]=127&I|128,z.buf[z.pos]=127&(I>>>=7)}(C,0,g),function(I,O){var z=(7&I)<<4;O.buf[O.pos++]|=z|((I>>>=3)?128:0),I&&(O.buf[O.pos++]=127&I|((I>>>=7)?128:0),I&&(O.buf[O.pos++]=127&I|((I>>>=7)?128:0),I&&(O.buf[O.pos++]=127&I|((I>>>=7)?128:0),I&&(O.buf[O.pos++]=127&I|((I>>>=7)?128:0),I&&(O.buf[O.pos++]=127&I)))))}(M,g)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(Boolean(c))},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var d=this.pos;this.pos=function(C,M,I){for(var O,z,G=0;G<M.length;G++){if((O=M.charCodeAt(G))>55295&&O<57344){if(!z){O>56319||G+1===M.length?(C[I++]=239,C[I++]=191,C[I++]=189):z=O;continue}if(O<56320){C[I++]=239,C[I++]=191,C[I++]=189,z=O;continue}O=z-55296<<10|O-56320|65536,z=null}else z&&(C[I++]=239,C[I++]=191,C[I++]=189,z=null);O<128?C[I++]=O:(O<2048?C[I++]=O>>6|192:(O<65536?C[I++]=O>>12|224:(C[I++]=O>>18|240,C[I++]=O>>12&63|128),C[I++]=O>>6&63|128),C[I++]=63&O|128)}return I}(this.buf,c,this.pos);var g=this.pos-d;g>=128&&Z(d,g,this),this.pos=d-1,this.writeVarint(g),this.pos+=g},writeFloat:function(c){this.realloc(4),bd(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),bd(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var d=c.length;this.writeVarint(d),this.realloc(d);for(var g=0;g<d;g++)this.buf[this.pos++]=c[g]},writeRawMessage:function(c,d){this.pos++;var g=this.pos;c(d,this);var C=this.pos-g;C>=128&&Z(g,C,this),this.pos=g-1,this.writeVarint(C),this.pos+=C},writeMessage:function(c,d,g){this.writeTag(c,ja.Bytes),this.writeRawMessage(d,g)},writePackedVarint:function(c,d){d.length&&this.writeMessage(c,Se,d)},writePackedSVarint:function(c,d){d.length&&this.writeMessage(c,Ve,d)},writePackedBoolean:function(c,d){d.length&&this.writeMessage(c,kt,d)},writePackedFloat:function(c,d){d.length&&this.writeMessage(c,Rt,d)},writePackedDouble:function(c,d){d.length&&this.writeMessage(c,tr,d)},writePackedFixed32:function(c,d){d.length&&this.writeMessage(c,Yt,d)},writePackedSFixed32:function(c,d){d.length&&this.writeMessage(c,sr,d)},writePackedFixed64:function(c,d){d.length&&this.writeMessage(c,mr,d)},writePackedSFixed64:function(c,d){d.length&&this.writeMessage(c,Cr,d)},writeBytesField:function(c,d){this.writeTag(c,ja.Bytes),this.writeBytes(d)},writeFixed32Field:function(c,d){this.writeTag(c,ja.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(c,d){this.writeTag(c,ja.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(c,d){this.writeTag(c,ja.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(c,d){this.writeTag(c,ja.Fixed64),this.writeSFixed64(d)},writeVarintField:function(c,d){this.writeTag(c,ja.Varint),this.writeVarint(d)},writeSVarintField:function(c,d){this.writeTag(c,ja.Varint),this.writeSVarint(d)},writeStringField:function(c,d){this.writeTag(c,ja.Bytes),this.writeString(d)},writeFloatField:function(c,d){this.writeTag(c,ja.Fixed32),this.writeFloat(d)},writeDoubleField:function(c,d){this.writeTag(c,ja.Fixed64),this.writeDouble(d)},writeBooleanField:function(c,d){this.writeVarintField(c,Boolean(d))}};var _r=function(c,d){var g=d.pixelRatio,C=d.version,M=d.stretchX,I=d.stretchY,O=d.content;this.paddedRect=c,this.pixelRatio=g,this.stretchX=M,this.stretchY=I,this.content=O,this.version=C},Zr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Zr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Zr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Zr.tlbr.get=function(){return this.tl.concat(this.br)},Zr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(_r.prototype,Zr);var or=function(c,d){var g={},C={};this.haveRenderCallbacks=[];var M=[];this.addImages(c,g,M),this.addImages(d,C,M);var I=Gt(M),O=new Bu({width:I.w||1,height:I.h||1});for(var z in c){var G=c[z],q=g[z].paddedRect;Bu.copy(G.data,O,{x:0,y:0},{x:q.x+1,y:q.y+1},G.data)}for(var re in d){var oe=d[re],ce=C[re].paddedRect,pe=ce.x+1,De=ce.y+1,$e=oe.data.width,tt=oe.data.height;Bu.copy(oe.data,O,{x:0,y:0},{x:pe,y:De},oe.data),Bu.copy(oe.data,O,{x:0,y:tt-1},{x:pe,y:De-1},{width:$e,height:1}),Bu.copy(oe.data,O,{x:0,y:0},{x:pe,y:De+tt},{width:$e,height:1}),Bu.copy(oe.data,O,{x:$e-1,y:0},{x:pe-1,y:De},{width:1,height:tt}),Bu.copy(oe.data,O,{x:0,y:0},{x:pe+$e,y:De},{width:1,height:tt})}this.image=O,this.iconPositions=g,this.patternPositions=C};or.prototype.addImages=function(c,d,g){for(var C in c){var M=c[C],I={x:0,y:0,w:M.data.width+2,h:M.data.height+2};g.push(I),d[C]=new _r(I,M),M.hasRenderCallback&&this.haveRenderCallbacks.push(C)}},or.prototype.patchUpdatedImages=function(c,d){for(var g in c.dispatchRenderCallbacks(this.haveRenderCallbacks),c.updatedImages)this.patchUpdatedImage(this.iconPositions[g],c.getImage(g),d),this.patchUpdatedImage(this.patternPositions[g],c.getImage(g),d)},or.prototype.patchUpdatedImage=function(c,d,g){if(c&&d&&c.version!==d.version){c.version=d.version;var C=c.tl;g.update(d.data,void 0,{x:C[0],y:C[1]})}},dn("ImagePosition",_r),dn("ImageAtlas",or);var Fr={horizontal:1,vertical:2,horizontalOnly:3},Hr=function(){this.scale=1,this.fontStack="",this.imageName=null};Hr.forText=function(c,d){var g=new Hr;return g.scale=c||1,g.fontStack=d,g},Hr.forImage=function(c){var d=new Hr;return d.imageName=c,d};var xn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Jt(c,d,g,C,M,I,O,z,G,q,re,oe,ce,pe,De,$e){var tt,Ze=xn.fromFeature(c,M);oe===Fr.vertical&&Ze.verticalizePunctuation();var mt=Ml.processBidirectionalText,At=Ml.processStyledBidirectionalText;if(mt&&Ze.sections.length===1){tt=[];for(var Nt=0,Vt=mt(Ze.toString(),li(Ze,q,I,d,C,pe,De));Nt<Vt.length;Nt+=1){var ir=Vt[Nt],Mr=new xn;Mr.text=ir,Mr.sections=Ze.sections;for(var Wr=0;Wr<ir.length;Wr++)Mr.sectionIndex.push(0);tt.push(Mr)}}else if(At){tt=[];for(var Vn=0,fn=At(Ze.text,Ze.sectionIndex,li(Ze,q,I,d,C,pe,De));Vn<fn.length;Vn+=1){var Yn=fn[Vn],gn=new xn;gn.text=Yn[0],gn.sectionIndex=Yn[1],gn.sections=Ze.sections,tt.push(gn)}}else tt=function(In,Xi){for(var Mi=[],ca=In.text,Zn=0,Ia=0,qo=Xi;Ia<qo.length;Ia+=1){var Ko=qo[Ia];Mi.push(In.substring(Zn,Ko)),Zn=Ko}return Zn<ca.length&&Mi.push(In.substring(Zn,ca.length)),Mi}(Ze,li(Ze,q,I,d,C,pe,De));var Fi=[],ai={positionedLines:Fi,text:Ze.toString(),top:re[1],bottom:re[1],left:re[0],right:re[0],writingMode:oe,iconsInText:!1,verticalizable:!1};return function(In,Xi,Mi,ca,Zn,Ia,qo,Ko,zo,Qo,Ms,Js){for(var hu=0,Ol=-17,$u=0,Fl=0,$s=Ko==="right"?1:Ko==="left"?0:.5,Uu=0,na=0,mo=Zn;na<mo.length;na+=1){var Qa=mo[na];Qa.trim();var xa=Qa.getMaxScale(),rc=24*(xa-1),pl={positionedGlyphs:[],lineOffset:0};In.positionedLines[Uu]=pl;var $o=pl.positionedGlyphs,ao=0;if(Qa.length()){for(var dl=0;dl<Qa.length();dl++){var ka=Qa.getSection(dl),bc=Qa.getSectionIndex(dl),Ci=Qa.getCharCode(dl),wd=0,Ra=null,Uo=null,Hh=null,th=24,Fm=!(zo===Fr.horizontal||!Ms&&!Cs(Ci)||Ms&&(qt[Ci]||(Wh=Ci,Yr.Arabic(Wh)||Yr["Arabic Supplement"](Wh)||Yr["Arabic Extended-A"](Wh)||Yr["Arabic Presentation Forms-A"](Wh)||Yr["Arabic Presentation Forms-B"](Wh))));if(ka.imageName){var Ky=ca[ka.imageName];if(!Ky)continue;Hh=ka.imageName,In.iconsInText=In.iconsInText||!0,Uo=Ky.paddedRect;var Pv=Ky.displaySize;ka.scale=24*ka.scale/Js,wd=rc+(24-Pv[1]*ka.scale),th=(Ra={width:Pv[0],height:Pv[1],left:1,top:-3,advance:Fm?Pv[1]:Pv[0]}).advance;var Qy=Fm?Pv[0]*ka.scale-24*xa:Pv[1]*ka.scale-24*xa;Qy>0&&Qy>ao&&(ao=Qy)}else{var X1=Mi[ka.fontStack],Lg=X1&&X1[Ci];if(Lg&&Lg.rect)Uo=Lg.rect,Ra=Lg.metrics;else{var q_=Xi[ka.fontStack],jh=q_&&q_[Ci];if(!jh)continue;Ra=jh.metrics}wd=24*(xa-ka.scale)}Fm?(In.verticalizable=!0,$o.push({glyph:Ci,imageName:Hh,x:hu,y:Ol+wd,vertical:Fm,scale:ka.scale,fontStack:ka.fontStack,sectionIndex:bc,metrics:Ra,rect:Uo}),hu+=th*ka.scale+Qo):($o.push({glyph:Ci,imageName:Hh,x:hu,y:Ol+wd,vertical:Fm,scale:ka.scale,fontStack:ka.fontStack,sectionIndex:bc,metrics:Ra,rect:Uo}),hu+=Ra.advance*ka.scale+Qo)}$o.length!==0&&($u=Math.max(hu-Qo,$u),sn($o,0,$o.length-1,$s,ao)),hu=0;var K_=Ia*xa+ao;pl.lineOffset=Math.max(ao,rc),Ol+=K_,Fl=Math.max(K_,Fl),++Uu}else Ol+=Ia,++Uu}var Wh,ms=Ol- -17,ys=ii(qo),Rv=ys.horizontalAlign,Jy=ys.verticalAlign;(function(Y1,Z1,Q_,J_,q1,e0,Ov,Dm,K1){var Bm,Nm=(Z1-Q_)*q1;Bm=e0!==Ov?-Dm*J_- -17:(-J_*K1+.5)*Ov;for(var Dl=0,Cd=Y1;Dl<Cd.length;Dl+=1)for(var zm=0,ex=Cd[Dl].positionedGlyphs;zm<ex.length;zm+=1){var t0=ex[zm];t0.x+=Nm,t0.y+=Bm}})(In.positionedLines,$s,Rv,Jy,$u,Fl,Ia,ms,Zn.length),In.top+=-Jy*ms,In.bottom=In.top+ms,In.left+=-Rv*$u,In.right=In.left+$u}(ai,d,g,C,tt,O,z,G,oe,q,ce,$e),!function(In){for(var Xi=0,Mi=In;Xi<Mi.length;Xi+=1)if(Mi[Xi].positionedGlyphs.length!==0)return!1;return!0}(Fi)&&ai}xn.fromFeature=function(c,d){for(var g=new xn,C=0;C<c.sections.length;C++){var M=c.sections[C];M.image?g.addImageSection(M):g.addTextSection(M,d)}return g},xn.prototype.length=function(){return this.text.length},xn.prototype.getSection=function(c){return this.sections[this.sectionIndex[c]]},xn.prototype.getSectionIndex=function(c){return this.sectionIndex[c]},xn.prototype.getCharCode=function(c){return this.text.charCodeAt(c)},xn.prototype.verticalizePunctuation=function(){this.text=function(c){for(var d="",g=0;g<c.length;g++){var C=c.charCodeAt(g+1)||null,M=c.charCodeAt(g-1)||null;d+=C&&Oh(C)&&!Lv[c[g+1]]||M&&Oh(M)&&!Lv[c[g-1]]||!Lv[c[g]]?c[g]:Lv[c[g]]}return d}(this.text)},xn.prototype.trim=function(){for(var c=0,d=0;d<this.text.length&&qt[this.text.charCodeAt(d)];d++)c++;for(var g=this.text.length,C=this.text.length-1;C>=0&&C>=c&&qt[this.text.charCodeAt(C)];C--)g--;this.text=this.text.substring(c,g),this.sectionIndex=this.sectionIndex.slice(c,g)},xn.prototype.substring=function(c,d){var g=new xn;return g.text=this.text.substring(c,d),g.sectionIndex=this.sectionIndex.slice(c,d),g.sections=this.sections,g},xn.prototype.toString=function(){return this.text},xn.prototype.getMaxScale=function(){var c=this;return this.sectionIndex.reduce(function(d,g){return Math.max(d,c.sections[g].scale)},0)},xn.prototype.addTextSection=function(c,d){this.text+=c.text,this.sections.push(Hr.forText(c.scale,c.fontStack||d));for(var g=this.sections.length-1,C=0;C<c.text.length;++C)this.sectionIndex.push(g)},xn.prototype.addImageSection=function(c){var d=c.image?c.image.name:"";if(d.length!==0){var g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Hr.forImage(d)),this.sectionIndex.push(this.sections.length-1)):te("Reached maximum number of images 6401")}else te("Can't add FormattedSection with an empty image.")},xn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var qt={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},jr={};function Ur(c,d,g,C,M,I){if(d.imageName){var O=C[d.imageName];return O?O.displaySize[0]*d.scale*24/I+M:0}var z=g[d.fontStack],G=z&&z[c];return G?G.metrics.advance*d.scale+M:0}function br(c,d,g,C){var M=Math.pow(c-d,2);return C?c<d?M/2:2*M:M+Math.abs(g)*g}function qr(c,d,g){var C=0;return c===10&&(C-=1e4),g&&(C+=150),c!==40&&c!==65288||(C+=50),d!==41&&d!==65289||(C+=50),C}function Qr(c,d,g,C,M,I){for(var O=null,z=br(d,g,M,I),G=0,q=C;G<q.length;G+=1){var re=q[G],oe=br(d-re.x,g,M,I)+re.badness;oe<=z&&(O=re,z=oe)}return{index:c,x:d,priorBreak:O,badness:z}}function li(c,d,g,C,M,I,O){if(I!=="point")return[];if(!c)return[];for(var z,G=[],q=function(tt,Ze,mt,At,Nt,Vt){for(var ir=0,Mr=0;Mr<tt.length();Mr++){var Wr=tt.getSection(Mr);ir+=Ur(tt.getCharCode(Mr),Wr,At,Nt,Ze,Vt)}return ir/Math.max(1,Math.ceil(ir/mt))}(c,d,g,C,M,O),re=c.text.indexOf("\u200B")>=0,oe=0,ce=0;ce<c.length();ce++){var pe=c.getSection(ce),De=c.getCharCode(ce);if(qt[De]||(oe+=Ur(De,pe,C,M,d,O)),ce<c.length()-1){var $e=!((z=De)<11904||!(Yr["Bopomofo Extended"](z)||Yr.Bopomofo(z)||Yr["CJK Compatibility Forms"](z)||Yr["CJK Compatibility Ideographs"](z)||Yr["CJK Compatibility"](z)||Yr["CJK Radicals Supplement"](z)||Yr["CJK Strokes"](z)||Yr["CJK Symbols and Punctuation"](z)||Yr["CJK Unified Ideographs Extension A"](z)||Yr["CJK Unified Ideographs"](z)||Yr["Enclosed CJK Letters and Months"](z)||Yr["Halfwidth and Fullwidth Forms"](z)||Yr.Hiragana(z)||Yr["Ideographic Description Characters"](z)||Yr["Kangxi Radicals"](z)||Yr["Katakana Phonetic Extensions"](z)||Yr.Katakana(z)||Yr["Vertical Forms"](z)||Yr["Yi Radicals"](z)||Yr["Yi Syllables"](z)));(jr[De]||$e||pe.imageName)&&G.push(Qr(ce+1,oe,q,G,qr(De,c.getCharCode(ce+1),$e&&re),!1))}}return function tt(Ze){return Ze?tt(Ze.priorBreak).concat(Ze.index):[]}(Qr(c.length(),oe,q,G,0,!0))}function ii(c){var d=.5,g=.5;switch(c){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:d,verticalAlign:g}}function sn(c,d,g,C,M){if(C||M)for(var I=c[g],O=(c[g].x+I.metrics.advance*I.scale)*C,z=d;z<=g;z++)c[z].x-=O,c[z].y+=M}function ln(c,d,g,C,M,I){var O,z=c.image;if(z.content){var G=z.content,q=z.pixelRatio||1;O=[G[0]/q,G[1]/q,z.displaySize[0]-G[2]/q,z.displaySize[1]-G[3]/q]}var re,oe,ce,pe,De=d.left*I,$e=d.right*I;g==="width"||g==="both"?(pe=M[0]+De-C[3],oe=M[0]+$e+C[1]):oe=(pe=M[0]+(De+$e-z.displaySize[0])/2)+z.displaySize[0];var tt=d.top*I,Ze=d.bottom*I;return g==="height"||g==="both"?(re=M[1]+tt-C[0],ce=M[1]+Ze+C[2]):ce=(re=M[1]+(tt+Ze-z.displaySize[1])/2)+z.displaySize[1],{image:z,top:re,right:oe,bottom:ce,left:pe,collisionPadding:O}}jr[10]=!0,jr[32]=!0,jr[38]=!0,jr[40]=!0,jr[41]=!0,jr[43]=!0,jr[45]=!0,jr[47]=!0,jr[173]=!0,jr[183]=!0,jr[8203]=!0,jr[8208]=!0,jr[8211]=!0,jr[8231]=!0;var Xn=function(c){function d(g,C,M,I){c.call(this,g,C),this.angle=M,I!==void 0&&(this.segment=I)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(f);function fi(c,d){var g=d.expression;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new ti(c+1))};if(g.kind==="source")return{kind:"source"};for(var C=g.zoomStops,M=g.interpolationType,I=0;I<C.length&&C[I]<=c;)I++;for(var O=I=Math.max(0,I-1);O<C.length&&C[O]<c+1;)O++;O=Math.min(C.length-1,O);var z=C[I],G=C[O];return g.kind==="composite"?{kind:"composite",minZoom:z,maxZoom:G,interpolationType:M}:{kind:"camera",minZoom:z,maxZoom:G,minSize:g.evaluate(new ti(z)),maxSize:g.evaluate(new ti(G)),interpolationType:M}}function _i(c,d,g){var C=d.uSize,M=g.lowerSize;return c.kind==="source"?M/128:c.kind==="composite"?us(M/128,g.upperSize/128,d.uSizeT):C}function Ka(c,d){var g=0,C=0;if(c.kind==="constant")C=c.layoutSize;else if(c.kind!=="source"){var M=c.interpolationType,I=M?E(ou.interpolationFactor(M,d,c.minZoom,c.maxZoom),0,1):0;c.kind==="camera"?C=us(c.minSize,c.maxSize,I):g=I}return{uSizeT:g,uSize:C}}dn("Anchor",Xn);var gs=Object.freeze({__proto__:null,getSizeData:fi,evaluateSizeForFeature:_i,evaluateSizeForZoom:Ka,SIZE_PACK_FACTOR:128});function Vi(c,d,g,C,M){if(d.segment===void 0)return!0;for(var I=d,O=d.segment+1,z=0;z>-g/2;){if(--O<0)return!1;z-=c[O].dist(I),I=c[O]}z+=c[O].dist(c[O+1]),O++;for(var G=[],q=0;z<g/2;){var re=c[O],oe=c[O+1];if(!oe)return!1;var ce=c[O-1].angleTo(re)-re.angleTo(oe);for(ce=Math.abs((ce+3*Math.PI)%(2*Math.PI)-Math.PI),G.push({distance:z,angleDelta:ce}),q+=ce;z-G[0].distance>C;)q-=G.shift().angleDelta;if(q>M)return!1;O++,z+=re.dist(oe)}return!0}function Au(c){for(var d=0,g=0;g<c.length-1;g++)d+=c[g].dist(c[g+1]);return d}function Co(c,d,g){return c?.6*d*g:0}function qs(c,d){return Math.max(c?c.right-c.left:0,d?d.right-d.left:0)}function zs(c,d,g,C,M,I){for(var O=Co(g,M,I),z=qs(g,C)*I,G=0,q=Au(c)/2,re=0;re<c.length-1;re++){var oe=c[re],ce=c[re+1],pe=oe.dist(ce);if(G+pe>q){var De=(q-G)/pe,$e=us(oe.x,ce.x,De),tt=us(oe.y,ce.y,De),Ze=new Xn($e,tt,ce.angleTo(oe),re);return Ze._round(),!O||Vi(c,Ze,z,O,d)?Ze:void 0}G+=pe}}function Tu(c,d,g,C,M,I,O,z,G){var q=Co(C,I,O),re=qs(C,M),oe=re*O,ce=c[0].x===0||c[0].x===G||c[0].y===0||c[0].y===G;return d-oe<d/4&&(d=oe+d/4),function pe(De,$e,tt,Ze,mt,At,Nt,Vt,ir){for(var Mr=At/2,Wr=Au(De),Vn=0,fn=$e-tt,Yn=[],gn=0;gn<De.length-1;gn++){for(var Fi=De[gn],ai=De[gn+1],In=Fi.dist(ai),Xi=ai.angleTo(Fi);fn+tt<Vn+In;){var Mi=((fn+=tt)-Vn)/In,ca=us(Fi.x,ai.x,Mi),Zn=us(Fi.y,ai.y,Mi);if(ca>=0&&ca<ir&&Zn>=0&&Zn<ir&&fn-Mr>=0&&fn+Mr<=Wr){var Ia=new Xn(ca,Zn,Xi,gn);Ia._round(),Ze&&!Vi(De,Ia,At,Ze,mt)||Yn.push(Ia)}}Vn+=In}return Vt||Yn.length||Nt||(Yn=pe(De,Vn/2,tt,Ze,mt,At,Nt,!0,ir)),Yn}(c,ce?d/2*z%d:(re/2+2*I)*O*z%d,d,q,g,oe,ce,!1,G)}function Mu(c,d,g,C,M){for(var I=[],O=0;O<c.length;O++)for(var z=c[O],G=void 0,q=0;q<z.length-1;q++){var re=z[q],oe=z[q+1];re.x<d&&oe.x<d||(re.x<d?re=new f(d,re.y+(d-re.x)/(oe.x-re.x)*(oe.y-re.y))._round():oe.x<d&&(oe=new f(d,re.y+(d-re.x)/(oe.x-re.x)*(oe.y-re.y))._round()),re.y<g&&oe.y<g||(re.y<g?re=new f(re.x+(g-re.y)/(oe.y-re.y)*(oe.x-re.x),g)._round():oe.y<g&&(oe=new f(re.x+(g-re.y)/(oe.y-re.y)*(oe.x-re.x),g)._round()),re.x>=C&&oe.x>=C||(re.x>=C?re=new f(C,re.y+(C-re.x)/(oe.x-re.x)*(oe.y-re.y))._round():oe.x>=C&&(oe=new f(C,re.y+(C-re.x)/(oe.x-re.x)*(oe.y-re.y))._round()),re.y>=M&&oe.y>=M||(re.y>=M?re=new f(re.x+(M-re.y)/(oe.y-re.y)*(oe.x-re.x),M)._round():oe.y>=M&&(oe=new f(re.x+(M-re.y)/(oe.y-re.y)*(oe.x-re.x),M)._round()),G&&re.equals(G[G.length-1])||I.push(G=[re]),G.push(oe)))))}return I}function Nu(c,d,g,C){var M=[],I=c.image,O=I.pixelRatio,z=I.paddedRect.w-2,G=I.paddedRect.h-2,q=c.right-c.left,re=c.bottom-c.top,oe=I.stretchX||[[0,z]],ce=I.stretchY||[[0,G]],pe=function(ca,Zn){return ca+Zn[1]-Zn[0]},De=oe.reduce(pe,0),$e=ce.reduce(pe,0),tt=z-De,Ze=G-$e,mt=0,At=De,Nt=0,Vt=$e,ir=0,Mr=tt,Wr=0,Vn=Ze;if(I.content&&C){var fn=I.content;mt=cs(oe,0,fn[0]),Nt=cs(ce,0,fn[1]),At=cs(oe,fn[0],fn[2]),Vt=cs(ce,fn[1],fn[3]),ir=fn[0]-mt,Wr=fn[1]-Nt,Mr=fn[2]-fn[0]-At,Vn=fn[3]-fn[1]-Vt}var Yn=function(ca,Zn,Ia,qo){var Ko=Ks(ca.stretch-mt,At,q,c.left),zo=Ea(ca.fixed-ir,Mr,ca.stretch,De),Qo=Ks(Zn.stretch-Nt,Vt,re,c.top),Ms=Ea(Zn.fixed-Wr,Vn,Zn.stretch,$e),Js=Ks(Ia.stretch-mt,At,q,c.left),hu=Ea(Ia.fixed-ir,Mr,Ia.stretch,De),Ol=Ks(qo.stretch-Nt,Vt,re,c.top),$u=Ea(qo.fixed-Wr,Vn,qo.stretch,$e),Fl=new f(Ko,Qo),$s=new f(Js,Qo),Uu=new f(Js,Ol),na=new f(Ko,Ol),mo=new f(zo/O,Ms/O),Qa=new f(hu/O,$u/O),xa=d*Math.PI/180;if(xa){var rc=Math.sin(xa),pl=Math.cos(xa),$o=[pl,-rc,rc,pl];Fl._matMult($o),$s._matMult($o),na._matMult($o),Uu._matMult($o)}var ao=ca.stretch+ca.fixed,dl=Zn.stretch+Zn.fixed;return{tl:Fl,tr:$s,bl:na,br:Uu,tex:{x:I.paddedRect.x+1+ao,y:I.paddedRect.y+1+dl,w:Ia.stretch+Ia.fixed-ao,h:qo.stretch+qo.fixed-dl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mo,pixelOffsetBR:Qa,minFontScaleX:Mr/O/q,minFontScaleY:Vn/O/re,isSDF:g}};if(C&&(I.stretchX||I.stretchY))for(var gn=ki(oe,tt,De),Fi=ki(ce,Ze,$e),ai=0;ai<gn.length-1;ai++)for(var In=gn[ai],Xi=gn[ai+1],Mi=0;Mi<Fi.length-1;Mi++)M.push(Yn(In,Fi[Mi],Xi,Fi[Mi+1]));else M.push(Yn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:z+1},{fixed:0,stretch:G+1}));return M}function cs(c,d,g){for(var C=0,M=0,I=c;M<I.length;M+=1){var O=I[M];C+=Math.max(d,Math.min(g,O[1]))-Math.max(d,Math.min(g,O[0]))}return C}function ki(c,d,g){for(var C=[{fixed:-1,stretch:0}],M=0,I=c;M<I.length;M+=1){var O=I[M],z=O[0],G=O[1],q=C[C.length-1];C.push({fixed:z-q.stretch,stretch:q.stretch}),C.push({fixed:z-q.stretch,stretch:q.stretch+(G-z)})}return C.push({fixed:d+1,stretch:g}),C}function Ks(c,d,g,C){return c/d*g+C}function Ea(c,d,g,C){return c-d*g/C}var Ts=function(c,d,g,C,M,I,O,z,G,q){if(this.boxStartIndex=c.length,G){var re=I.top,oe=I.bottom,ce=I.collisionPadding;ce&&(re-=ce[1],oe+=ce[3]);var pe=oe-re;pe>0&&(pe=Math.max(10,pe),this.circleDiameter=pe)}else{var De=I.top*O-z,$e=I.bottom*O+z,tt=I.left*O-z,Ze=I.right*O+z,mt=I.collisionPadding;if(mt&&(tt-=mt[0]*O,De-=mt[1]*O,Ze+=mt[2]*O,$e+=mt[3]*O),q){var At=new f(tt,De),Nt=new f(Ze,De),Vt=new f(tt,$e),ir=new f(Ze,$e),Mr=q*Math.PI/180;At._rotate(Mr),Nt._rotate(Mr),Vt._rotate(Mr),ir._rotate(Mr),tt=Math.min(At.x,Nt.x,Vt.x,ir.x),Ze=Math.max(At.x,Nt.x,Vt.x,ir.x),De=Math.min(At.y,Nt.y,Vt.y,ir.y),$e=Math.max(At.y,Nt.y,Vt.y,ir.y)}c.emplaceBack(d.x,d.y,tt,De,Ze,$e,g,C,M)}this.boxEndIndex=c.length},Kn=function(c,d){if(c===void 0&&(c=[]),d===void 0&&(d=Gi),this.data=c,this.length=this.data.length,this.compare=d,this.length>0)for(var g=(this.length>>1)-1;g>=0;g--)this._down(g)};function Gi(c,d){return c<d?-1:c>d?1:0}function io(c,d,g){d===void 0&&(d=1),g===void 0&&(g=!1);for(var C=1/0,M=1/0,I=-1/0,O=-1/0,z=c[0],G=0;G<z.length;G++){var q=z[G];(!G||q.x<C)&&(C=q.x),(!G||q.y<M)&&(M=q.y),(!G||q.x>I)&&(I=q.x),(!G||q.y>O)&&(O=q.y)}var re=Math.min(I-C,O-M),oe=re/2,ce=new Kn([],Qs);if(re===0)return new f(C,M);for(var pe=C;pe<I;pe+=re)for(var De=M;De<O;De+=re)ce.push(new _c(pe+oe,De+oe,oe,c));for(var $e=function(mt){for(var At=0,Nt=0,Vt=0,ir=mt[0],Mr=0,Wr=ir.length,Vn=Wr-1;Mr<Wr;Vn=Mr++){var fn=ir[Mr],Yn=ir[Vn],gn=fn.x*Yn.y-Yn.x*fn.y;Nt+=(fn.x+Yn.x)*gn,Vt+=(fn.y+Yn.y)*gn,At+=3*gn}return new _c(Nt/At,Vt/At,0,mt)}(c),tt=ce.length;ce.length;){var Ze=ce.pop();(Ze.d>$e.d||!$e.d)&&($e=Ze,g&&console.log("found best %d after %d probes",Math.round(1e4*Ze.d)/1e4,tt)),Ze.max-$e.d<=d||(ce.push(new _c(Ze.p.x-(oe=Ze.h/2),Ze.p.y-oe,oe,c)),ce.push(new _c(Ze.p.x+oe,Ze.p.y-oe,oe,c)),ce.push(new _c(Ze.p.x-oe,Ze.p.y+oe,oe,c)),ce.push(new _c(Ze.p.x+oe,Ze.p.y+oe,oe,c)),tt+=4)}return g&&(console.log("num probes: "+tt),console.log("best distance: "+$e.d)),$e.p}function Qs(c,d){return d.max-c.max}function _c(c,d,g,C){this.p=new f(c,d),this.h=g,this.d=function(M,I){for(var O=!1,z=1/0,G=0;G<I.length;G++)for(var q=I[G],re=0,oe=q.length,ce=oe-1;re<oe;ce=re++){var pe=q[re],De=q[ce];pe.y>M.y!=De.y>M.y&&M.x<(De.x-pe.x)*(M.y-pe.y)/(De.y-pe.y)+pe.x&&(O=!O),z=Math.min(z,Kf(M,pe,De))}return(O?1:-1)*Math.sqrt(z)}(this.p,C),this.max=this.d+this.h*Math.SQRT2}Kn.prototype.push=function(c){this.data.push(c),this.length++,this._up(this.length-1)},Kn.prototype.pop=function(){if(this.length!==0){var c=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),c}},Kn.prototype.peek=function(){return this.data[0]},Kn.prototype._up=function(c){for(var d=this.data,g=this.compare,C=d[c];c>0;){var M=c-1>>1,I=d[M];if(g(C,I)>=0)break;d[c]=I,c=M}d[c]=C},Kn.prototype._down=function(c){for(var d=this.data,g=this.compare,C=this.length>>1,M=d[c];c<C;){var I=1+(c<<1),O=d[I],z=I+1;if(z<this.length&&g(d[z],O)<0&&(I=z,O=d[z]),g(O,M)>=0)break;d[c]=O,c=I}d[c]=M};var Fe=Number.POSITIVE_INFINITY;function Ft(c,d){return d[1]!==Fe?function(g,C,M){var I=0,O=0;switch(C=Math.abs(C),M=Math.abs(M),g){case"top-right":case"top-left":case"top":O=M-7;break;case"bottom-right":case"bottom-left":case"bottom":O=7-M}switch(g){case"top-right":case"bottom-right":case"right":I=-C;break;case"top-left":case"bottom-left":case"left":I=C}return[I,O]}(c,d[0],d[1]):function(g,C){var M=0,I=0;C<0&&(C=0);var O=C/Math.sqrt(2);switch(g){case"top-right":case"top-left":I=O-7;break;case"bottom-right":case"bottom-left":I=7-O;break;case"bottom":I=7-C;break;case"top":I=C-7}switch(g){case"top-right":case"bottom-right":M=-O;break;case"top-left":case"bottom-left":M=O;break;case"left":M=C;break;case"right":M=-C}return[M,I]}(c,d[0])}function Ct(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vn(c,d,g,C,M,I,O,z,G,q,re,oe,ce,pe,De){var $e=function(Nt,Vt,ir,Mr,Wr,Vn,fn,Yn){for(var gn=Mr.layout.get("text-rotate").evaluate(Vn,{})*Math.PI/180,Fi=[],ai=0,In=Vt.positionedLines;ai<In.length;ai+=1)for(var Xi=In[ai],Mi=0,ca=Xi.positionedGlyphs;Mi<ca.length;Mi+=1){var Zn=ca[Mi];if(Zn.rect){var Ia=Zn.rect||{},qo=4,Ko=!0,zo=1,Qo=0,Ms=(Wr||Yn)&&Zn.vertical,Js=Zn.metrics.advance*Zn.scale/2;if(Yn&&Vt.verticalizable&&(Qo=Xi.lineOffset/2-(Zn.imageName?-(24-Zn.metrics.width*Zn.scale)/2:24*(Zn.scale-1))),Zn.imageName){var hu=fn[Zn.imageName];Ko=hu.sdf,qo=1/(zo=hu.pixelRatio)}var Ol=Wr?[Zn.x+Js,Zn.y]:[0,0],$u=Wr?[0,0]:[Zn.x+Js+ir[0],Zn.y+ir[1]-Qo],Fl=[0,0];Ms&&(Fl=$u,$u=[0,0]);var $s=(Zn.metrics.left-qo)*Zn.scale-Js+$u[0],Uu=(-Zn.metrics.top-qo)*Zn.scale+$u[1],na=$s+Ia.w*Zn.scale/zo,mo=Uu+Ia.h*Zn.scale/zo,Qa=new f($s,Uu),xa=new f(na,Uu),rc=new f($s,mo),pl=new f(na,mo);if(Ms){var $o=new f(-Js,Js- -17),ao=-Math.PI/2,dl=12-Js,ka=new f(22-dl,-(Zn.imageName?dl:0)),bc=new(Function.prototype.bind.apply(f,[null].concat(Fl)));Qa._rotateAround(ao,$o)._add(ka)._add(bc),xa._rotateAround(ao,$o)._add(ka)._add(bc),rc._rotateAround(ao,$o)._add(ka)._add(bc),pl._rotateAround(ao,$o)._add(ka)._add(bc)}if(gn){var Ci=Math.sin(gn),wd=Math.cos(gn),Ra=[wd,-Ci,Ci,wd];Qa._matMult(Ra),xa._matMult(Ra),rc._matMult(Ra),pl._matMult(Ra)}var Uo=new f(0,0),Hh=new f(0,0);Fi.push({tl:Qa,tr:xa,bl:rc,br:pl,tex:Ia,writingMode:Vt.writingMode,glyphOffset:Ol,sectionIndex:Zn.sectionIndex,isSDF:Ko,pixelOffsetTL:Uo,pixelOffsetBR:Hh,minFontScaleX:0,minFontScaleY:0})}}return Fi}(0,g,z,M,I,O,C,c.allowVerticalPlacement),tt=c.textSizeData,Ze=null;tt.kind==="source"?(Ze=[128*M.layout.get("text-size").evaluate(O,{})])[0]>32640&&te(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):tt.kind==="composite"&&((Ze=[128*pe.compositeTextSizes[0].evaluate(O,{},De),128*pe.compositeTextSizes[1].evaluate(O,{},De)])[0]>32640||Ze[1]>32640)&&te(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),c.addSymbols(c.text,$e,Ze,z,I,O,q,d,G.lineStartIndex,G.lineLength,ce,De);for(var mt=0,At=re;mt<At.length;mt+=1)oe[At[mt]]=c.text.placedSymbolArray.length-1;return 4*$e.length}function Wi(c){for(var d in c)return c[d];return null}function ke(c,d,g,C){var M=c.compareText;if(d in M){for(var I=M[d],O=I.length-1;O>=0;O--)if(C.dist(I[O])<g)return!0}else M[d]=[];return M[d].push(C),!1}var ge=If.VectorTileFeature.types,Ye=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function yt(c,d,g,C,M,I,O,z,G,q,re,oe,ce){var pe=z?Math.min(32640,Math.round(z[0])):0,De=z?Math.min(32640,Math.round(z[1])):0;c.emplaceBack(d,g,Math.round(32*C),Math.round(32*M),I,O,(pe<<1)+(G?1:0),De,16*q,16*re,256*oe,256*ce)}function Ot(c,d,g){c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g)}function at(c){for(var d=0,g=c.sections;d<g.length;d+=1)if(vv(g[d].text))return!0;return!1}var Je=function(c){this.layoutVertexArray=new xv,this.indexArray=new Bh,this.programConfigurations=c,this.segments=new xe,this.dynamicLayoutVertexArray=new Ip,this.opacityVertexArray=new bv,this.placedSymbolArray=new S};Je.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Je.prototype.upload=function(c,d,g,C){this.isEmpty()||(g&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,H1.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,j1.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,Ye,!0),this.opacityVertexBuffer.itemSize=1),(g||C)&&this.programConfigurations.upload(c))},Je.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},dn("SymbolBuffers",Je);var ht=function(c,d,g){this.layoutVertexArray=new c,this.layoutAttributes=d,this.indexArray=new g,this.segments=new xe,this.collisionVertexArray=new wm};ht.prototype.upload=function(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,yw.members,!0)},ht.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},dn("CollisionBuffers",ht);var ye=function(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=hl([]),this.placementViewportMatrix=hl([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=fi(this.zoom,d["text-size"]),this.iconSizeData=fi(this.zoom,d["icon-size"]);var g=this.layers[0].layout,C=g.get("symbol-sort-key"),M=g.get("symbol-z-order");this.canOverlap=g.get("text-allow-overlap")||g.get("icon-allow-overlap")||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=M!=="viewport-y"&&C.constantOr(1)!==void 0,this.sortFeaturesByY=(M==="viewport-y"||M==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(function(I){return Fr[I]})),this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id}),this.sourceID=c.sourceID};ye.prototype.createArrays=function(){this.text=new Je(new Tn(this.layers,this.zoom,function(c){return/^text/.test(c)})),this.icon=new Je(new Tn(this.layers,this.zoom,function(c){return/^icon/.test(c)})),this.glyphOffsetArray=new N,this.lineVertexArray=new V,this.symbolInstances=new F},ye.prototype.calculateGlyphDependencies=function(c,d,g,C,M){for(var I=0;I<c.length;I++)if(d[c.charCodeAt(I)]=!0,(g||C)&&M){var O=Lv[c.charAt(I)];O&&(d[O.charCodeAt(0)]=!0)}},ye.prototype.populate=function(c,d,g){var C=this.layers[0],M=C.layout,I=M.get("text-font"),O=M.get("text-field"),z=M.get("icon-image"),G=(O.value.kind!=="constant"||O.value.value instanceof ho&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),q=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,re=M.get("symbol-sort-key");if(this.features=[],G||q){for(var oe=d.iconDependencies,ce=d.glyphDependencies,pe=d.availableImages,De=new ti(this.zoom),$e=0,tt=c;$e<tt.length;$e+=1){var Ze=tt[$e],mt=Ze.feature,At=Ze.id,Nt=Ze.index,Vt=Ze.sourceLayerIndex,ir=C._featureFilter.needGeometry,Mr=no(mt,ir);if(C._featureFilter.filter(De,Mr,g)){ir||(Mr.geometry=vo(mt));var Wr=void 0;if(G){var Vn=C.getValueAndResolveTokens("text-field",Mr,g,pe),fn=ho.factory(Vn);at(fn)&&(this.hasRTLText=!0),(!this.hasRTLText||_v()==="unavailable"||this.hasRTLText&&Ml.isParsed())&&(Wr=W_(fn,C,Mr))}var Yn=void 0;if(q){var gn=C.getValueAndResolveTokens("icon-image",Mr,g,pe);Yn=gn instanceof au?gn:au.fromString(gn)}if(Wr||Yn){var Fi=this.sortFeaturesByKey?re.evaluate(Mr,{},g):void 0;if(this.features.push({id:At,text:Wr,icon:Yn,index:Nt,sourceLayerIndex:Vt,geometry:Mr.geometry,properties:mt.properties,type:ge[mt.type],sortKey:Fi}),Yn&&(oe[Yn.name]=!0),Wr){var ai=I.evaluate(Mr,{},g).join(","),In=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Fr.vertical)>=0;for(var Xi=0,Mi=Wr.sections;Xi<Mi.length;Xi+=1){var ca=Mi[Xi];if(ca.image)oe[ca.image.name]=!0;else{var Zn=Hc(Wr.toString()),Ia=ca.fontStack||ai,qo=ce[Ia]=ce[Ia]||{};this.calculateGlyphDependencies(ca.text,qo,In,this.allowVerticalPlacement,Zn)}}}}}}M.get("symbol-placement")==="line"&&(this.features=function(Ko){var zo={},Qo={},Ms=[],Js=0;function hu($o){Ms.push(Ko[$o]),Js++}function Ol($o,ao,dl){var ka=Qo[$o];return delete Qo[$o],Qo[ao]=ka,Ms[ka].geometry[0].pop(),Ms[ka].geometry[0]=Ms[ka].geometry[0].concat(dl[0]),ka}function $u($o,ao,dl){var ka=zo[ao];return delete zo[ao],zo[$o]=ka,Ms[ka].geometry[0].shift(),Ms[ka].geometry[0]=dl[0].concat(Ms[ka].geometry[0]),ka}function Fl($o,ao,dl){var ka=dl?ao[0][ao[0].length-1]:ao[0][0];return $o+":"+ka.x+":"+ka.y}for(var $s=0;$s<Ko.length;$s++){var Uu=Ko[$s],na=Uu.geometry,mo=Uu.text?Uu.text.toString():null;if(mo){var Qa=Fl(mo,na),xa=Fl(mo,na,!0);if(Qa in Qo&&xa in zo&&Qo[Qa]!==zo[xa]){var rc=$u(Qa,xa,na),pl=Ol(Qa,xa,Ms[rc].geometry);delete zo[Qa],delete Qo[xa],Qo[Fl(mo,Ms[pl].geometry,!0)]=pl,Ms[rc].geometry=null}else Qa in Qo?Ol(Qa,xa,na):xa in zo?$u(Qa,xa,na):(hu($s),zo[Qa]=Js-1,Qo[xa]=Js-1)}else hu($s)}return Ms.filter(function($o){return $o.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ko,zo){return Ko.sortKey-zo.sortKey})}},ye.prototype.update=function(c,d,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,d,this.layers,g),this.icon.programConfigurations.updatePaintArrays(c,d,this.layers,g))},ye.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ye.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ye.prototype.upload=function(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ye.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ye.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ye.prototype.addToLineVertexArray=function(c,d){var g=this.lineVertexArray.length;if(c.segment!==void 0){for(var C=c.dist(d[c.segment+1]),M=c.dist(d[c.segment]),I={},O=c.segment+1;O<d.length;O++)I[O]={x:d[O].x,y:d[O].y,tileUnitDistanceFromAnchor:C},O<d.length-1&&(C+=d[O+1].dist(d[O]));for(var z=c.segment||0;z>=0;z--)I[z]={x:d[z].x,y:d[z].y,tileUnitDistanceFromAnchor:M},z>0&&(M+=d[z-1].dist(d[z]));for(var G=0;G<d.length;G++){var q=I[G];this.lineVertexArray.emplaceBack(q.x,q.y,q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}},ye.prototype.addSymbols=function(c,d,g,C,M,I,O,z,G,q,re,oe){for(var ce=c.indexArray,pe=c.layoutVertexArray,De=c.segments.prepareSegment(4*d.length,pe,ce,this.canOverlap?I.sortKey:void 0),$e=this.glyphOffsetArray.length,tt=De.vertexLength,Ze=this.allowVerticalPlacement&&O===Fr.vertical?Math.PI/2:0,mt=I.text&&I.text.sections,At=0;At<d.length;At++){var Nt=d[At],Vt=Nt.tl,ir=Nt.tr,Mr=Nt.bl,Wr=Nt.br,Vn=Nt.tex,fn=Nt.pixelOffsetTL,Yn=Nt.pixelOffsetBR,gn=Nt.minFontScaleX,Fi=Nt.minFontScaleY,ai=Nt.glyphOffset,In=Nt.isSDF,Xi=Nt.sectionIndex,Mi=De.vertexLength,ca=ai[1];yt(pe,z.x,z.y,Vt.x,ca+Vt.y,Vn.x,Vn.y,g,In,fn.x,fn.y,gn,Fi),yt(pe,z.x,z.y,ir.x,ca+ir.y,Vn.x+Vn.w,Vn.y,g,In,Yn.x,fn.y,gn,Fi),yt(pe,z.x,z.y,Mr.x,ca+Mr.y,Vn.x,Vn.y+Vn.h,g,In,fn.x,Yn.y,gn,Fi),yt(pe,z.x,z.y,Wr.x,ca+Wr.y,Vn.x+Vn.w,Vn.y+Vn.h,g,In,Yn.x,Yn.y,gn,Fi),Ot(c.dynamicLayoutVertexArray,z,Ze),ce.emplaceBack(Mi,Mi+1,Mi+2),ce.emplaceBack(Mi+1,Mi+2,Mi+3),De.vertexLength+=4,De.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ai[0]),At!==d.length-1&&Xi===d[At+1].sectionIndex||c.programConfigurations.populatePaintArrays(pe.length,I,I.index,{},oe,mt&&mt[Xi])}c.placedSymbolArray.emplaceBack(z.x,z.y,$e,this.glyphOffsetArray.length-$e,tt,G,q,z.segment,g?g[0]:0,g?g[1]:0,C[0],C[1],O,0,!1,0,re)},ye.prototype._addCollisionDebugVertex=function(c,d,g,C,M,I){return d.emplaceBack(0,0),c.emplaceBack(g.x,g.y,C,M,Math.round(I.x),Math.round(I.y))},ye.prototype.addCollisionDebugVertices=function(c,d,g,C,M,I,O){var z=M.segments.prepareSegment(4,M.layoutVertexArray,M.indexArray),G=z.vertexLength,q=M.layoutVertexArray,re=M.collisionVertexArray,oe=O.anchorX,ce=O.anchorY;this._addCollisionDebugVertex(q,re,I,oe,ce,new f(c,d)),this._addCollisionDebugVertex(q,re,I,oe,ce,new f(g,d)),this._addCollisionDebugVertex(q,re,I,oe,ce,new f(g,C)),this._addCollisionDebugVertex(q,re,I,oe,ce,new f(c,C)),z.vertexLength+=4;var pe=M.indexArray;pe.emplaceBack(G,G+1),pe.emplaceBack(G+1,G+2),pe.emplaceBack(G+2,G+3),pe.emplaceBack(G+3,G),z.primitiveLength+=4},ye.prototype.addDebugCollisionBoxes=function(c,d,g,C){for(var M=c;M<d;M++){var I=this.collisionBoxArray.get(M);this.addCollisionDebugVertices(I.x1,I.y1,I.x2,I.y2,C?this.textCollisionBox:this.iconCollisionBox,I.anchorPoint,g)}},ye.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ht(pd,Vh.members,Pp),this.iconCollisionBox=new ht(pd,Vh.members,Pp);for(var c=0;c<this.symbolInstances.length;c++){var d=this.symbolInstances.get(c);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},ye.prototype._deserializeCollisionBoxesForSymbol=function(c,d,g,C,M,I,O,z,G){for(var q={},re=d;re<g;re++){var oe=c.get(re);q.textBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},q.textFeatureIndex=oe.featureIndex;break}for(var ce=C;ce<M;ce++){var pe=c.get(ce);q.verticalTextBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},q.verticalTextFeatureIndex=pe.featureIndex;break}for(var De=I;De<O;De++){var $e=c.get(De);q.iconBox={x1:$e.x1,y1:$e.y1,x2:$e.x2,y2:$e.y2,anchorPointX:$e.anchorPointX,anchorPointY:$e.anchorPointY},q.iconFeatureIndex=$e.featureIndex;break}for(var tt=z;tt<G;tt++){var Ze=c.get(tt);q.verticalIconBox={x1:Ze.x1,y1:Ze.y1,x2:Ze.x2,y2:Ze.y2,anchorPointX:Ze.anchorPointX,anchorPointY:Ze.anchorPointY},q.verticalIconFeatureIndex=Ze.featureIndex;break}return q},ye.prototype.deserializeCollisionBoxes=function(c){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var g=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}},ye.prototype.hasTextData=function(){return this.text.segments.get().length>0},ye.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ye.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ye.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ye.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ye.prototype.addIndicesForPlacedSymbol=function(c,d){for(var g=c.placedSymbolArray.get(d),C=g.vertexStartIndex+4*g.numGlyphs,M=g.vertexStartIndex;M<C;M+=4)c.indexArray.emplaceBack(M,M+1,M+2),c.indexArray.emplaceBack(M+1,M+2,M+3)},ye.prototype.getSortedSymbolIndexes=function(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(c),g=Math.cos(c),C=[],M=[],I=[],O=0;O<this.symbolInstances.length;++O){I.push(O);var z=this.symbolInstances.get(O);C.push(0|Math.round(d*z.anchorX+g*z.anchorY)),M.push(z.featureIndex)}return I.sort(function(G,q){return C[G]-C[q]||M[q]-M[G]}),I},ye.prototype.addToSortKeyRanges=function(c,d){var g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===d?g.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:c,symbolInstanceEnd:c+1})},ye.prototype.sortFeatures=function(c){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var g=0,C=this.symbolInstanceIndexes;g<C.length;g+=1){var M=this.symbolInstances.get(C[g]);this.featureSortOrder.push(M.featureIndex),[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach(function(I,O,z){I>=0&&z.indexOf(I)===O&&d.addIndicesForPlacedSymbol(d.text,I)}),M.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,M.verticalPlacedTextSymbolIndex),M.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.placedIconSymbolIndex),M.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},dn("SymbolBucket",ye,{omit:["layers","collisionBoxArray","features","compareText"]}),ye.MAX_GLYPHS=65535,ye.addDynamicAttributes=Ot;var qe=new uu({"symbol-placement":new Pn(_e.layout_symbol["symbol-placement"]),"symbol-spacing":new Pn(_e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Pn(_e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _n(_e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Pn(_e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Pn(_e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Pn(_e.layout_symbol["icon-ignore-placement"]),"icon-optional":new Pn(_e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Pn(_e.layout_symbol["icon-rotation-alignment"]),"icon-size":new _n(_e.layout_symbol["icon-size"]),"icon-text-fit":new Pn(_e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Pn(_e.layout_symbol["icon-text-fit-padding"]),"icon-image":new _n(_e.layout_symbol["icon-image"]),"icon-rotate":new _n(_e.layout_symbol["icon-rotate"]),"icon-padding":new Pn(_e.layout_symbol["icon-padding"]),"icon-keep-upright":new Pn(_e.layout_symbol["icon-keep-upright"]),"icon-offset":new _n(_e.layout_symbol["icon-offset"]),"icon-anchor":new _n(_e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Pn(_e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Pn(_e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Pn(_e.layout_symbol["text-rotation-alignment"]),"text-field":new _n(_e.layout_symbol["text-field"]),"text-font":new _n(_e.layout_symbol["text-font"]),"text-size":new _n(_e.layout_symbol["text-size"]),"text-max-width":new _n(_e.layout_symbol["text-max-width"]),"text-line-height":new Pn(_e.layout_symbol["text-line-height"]),"text-letter-spacing":new _n(_e.layout_symbol["text-letter-spacing"]),"text-justify":new _n(_e.layout_symbol["text-justify"]),"text-radial-offset":new _n(_e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Pn(_e.layout_symbol["text-variable-anchor"]),"text-anchor":new _n(_e.layout_symbol["text-anchor"]),"text-max-angle":new Pn(_e.layout_symbol["text-max-angle"]),"text-writing-mode":new Pn(_e.layout_symbol["text-writing-mode"]),"text-rotate":new _n(_e.layout_symbol["text-rotate"]),"text-padding":new Pn(_e.layout_symbol["text-padding"]),"text-keep-upright":new Pn(_e.layout_symbol["text-keep-upright"]),"text-transform":new _n(_e.layout_symbol["text-transform"]),"text-offset":new _n(_e.layout_symbol["text-offset"]),"text-allow-overlap":new Pn(_e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Pn(_e.layout_symbol["text-ignore-placement"]),"text-optional":new Pn(_e.layout_symbol["text-optional"])}),Pe={paint:new uu({"icon-opacity":new _n(_e.paint_symbol["icon-opacity"]),"icon-color":new _n(_e.paint_symbol["icon-color"]),"icon-halo-color":new _n(_e.paint_symbol["icon-halo-color"]),"icon-halo-width":new _n(_e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _n(_e.paint_symbol["icon-halo-blur"]),"icon-translate":new Pn(_e.paint_symbol["icon-translate"]),"icon-translate-anchor":new Pn(_e.paint_symbol["icon-translate-anchor"]),"text-opacity":new _n(_e.paint_symbol["text-opacity"]),"text-color":new _n(_e.paint_symbol["text-color"],{runtimeType:$r,getOverride:function(c){return c.textColor},hasOverride:function(c){return!!c.textColor}}),"text-halo-color":new _n(_e.paint_symbol["text-halo-color"]),"text-halo-width":new _n(_e.paint_symbol["text-halo-width"]),"text-halo-blur":new _n(_e.paint_symbol["text-halo-blur"]),"text-translate":new Pn(_e.paint_symbol["text-translate"]),"text-translate-anchor":new Pn(_e.paint_symbol["text-translate-anchor"])}),layout:qe},vt=function(c){this.type=c.property.overrides?c.property.overrides.runtimeType:cn,this.defaultValue=c};vt.prototype.evaluate=function(c){if(c.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(c.formattedSection))return d.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default},vt.prototype.eachChild=function(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)},vt.prototype.outputDefined=function(){return!1},vt.prototype.serialize=function(){return null},dn("FormatSectionOverride",vt,{omit:["defaultValue"]});var St=function(c){function d(g){c.call(this,g,Pe)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,C){if(c.prototype.recalculate.call(this,g,C),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var M=this.layout.get("text-writing-mode");if(M){for(var I=[],O=0,z=M;O<z.length;O+=1){var G=z[O];I.indexOf(G)<0&&I.push(G)}this.layout._values["text-writing-mode"]=I}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(g,C,M,I){var O=this.layout.get(g).evaluate(C,{},M,I),z=this._unevaluatedLayout._values[g];return z.isDataDriven()||Mp(z.value)||!O?O:function(G,q){return q.replace(/{([^{}]+)}/g,function(re,oe){return oe in G?String(G[oe]):""})}(C.properties,O)},d.prototype.createBucket=function(g){return new ye(g)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var g=0,C=Pe.paint.overridableProperties;g<C.length;g+=1){var M=C[g];if(d.hasPaintOverride(this.layout,M)){var I,O=this.paint.get(M),z=new vt(O),G=new xf(z,O.property.specification);I=O.value.kind==="constant"||O.value.kind==="source"?new bf("source",G):new Ih("composite",G,O.value.zoomStops,O.value._interpolationType),this.paint._values[M]=new vs(O.property,I,O.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(g,C,M){return!(!this.layout||C.isDataDriven()||M.isDataDriven())&&d.hasPaintOverride(this.layout,g)},d.hasPaintOverride=function(g,C){var M=g.get("text-field"),I=Pe.paint.properties[C],O=!1,z=function(re){for(var oe=0,ce=re;oe<ce.length;oe+=1)if(I.overrides&&I.overrides.hasOverride(ce[oe]))return void(O=!0)};if(M.value.kind==="constant"&&M.value.value instanceof ho)z(M.value.value.sections);else if(M.value.kind==="source"){var G=function(re){O||(re instanceof Ds&&ya(re.value)===pi?z(re.value.sections):re instanceof Pu?z(re.sections):re.eachChild(G))},q=M.value;q._styleExpression&&G(q._styleExpression.expression)}return O},d}(Wc),ur={paint:new uu({"background-color":new Pn(_e.paint_background["background-color"]),"background-pattern":new Ys(_e.paint_background["background-pattern"]),"background-opacity":new Pn(_e.paint_background["background-opacity"])})},Nr=function(c){function d(g){c.call(this,g,ur)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Wc),zr={paint:new uu({"raster-opacity":new Pn(_e.paint_raster["raster-opacity"]),"raster-hue-rotate":new Pn(_e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Pn(_e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Pn(_e.paint_raster["raster-brightness-max"]),"raster-saturation":new Pn(_e.paint_raster["raster-saturation"]),"raster-contrast":new Pn(_e.paint_raster["raster-contrast"]),"raster-resampling":new Pn(_e.paint_raster["raster-resampling"]),"raster-fade-duration":new Pn(_e.paint_raster["raster-fade-duration"])})},un=function(c){function d(g){c.call(this,g,zr)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Wc),Dr=function(c){function d(g){c.call(this,g,{}),this.implementation=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(g){this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},d.prototype.onRemove=function(g){this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},d}(Wc),Mn={circle:vd,heatmap:Sm,hillshade:gd,fill:Pl,"fill-extrusion":Bp,line:V1,symbol:St,background:Nr,raster:un},pn=p.HTMLImageElement,bn=p.HTMLCanvasElement,Cn=p.HTMLVideoElement,En=p.ImageData,ni=p.ImageBitmap,Pa=function(c,d,g,C){this.context=c,this.format=g,this.texture=c.gl.createTexture(),this.update(d,C)};Pa.prototype.update=function(c,d,g){var C=c.width,M=c.height,I=!(this.size&&this.size[0]===C&&this.size[1]===M||g),O=this.context,z=O.gl;if(this.useMipmap=Boolean(d&&d.useMipmap),z.bindTexture(z.TEXTURE_2D,this.texture),O.pixelStoreUnpackFlipY.set(!1),O.pixelStoreUnpack.set(1),O.pixelStoreUnpackPremultiplyAlpha.set(this.format===z.RGBA&&(!d||d.premultiply!==!1)),I)this.size=[C,M],c instanceof pn||c instanceof bn||c instanceof Cn||c instanceof En||ni&&c instanceof ni?z.texImage2D(z.TEXTURE_2D,0,this.format,this.format,z.UNSIGNED_BYTE,c):z.texImage2D(z.TEXTURE_2D,0,this.format,C,M,0,this.format,z.UNSIGNED_BYTE,c.data);else{var G=g||{x:0,y:0},q=G.x,re=G.y;c instanceof pn||c instanceof bn||c instanceof Cn||c instanceof En||ni&&c instanceof ni?z.texSubImage2D(z.TEXTURE_2D,0,q,re,z.RGBA,z.UNSIGNED_BYTE,c):z.texSubImage2D(z.TEXTURE_2D,0,q,re,C,M,z.RGBA,z.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&z.generateMipmap(z.TEXTURE_2D)},Pa.prototype.bind=function(c,d,g){var C=this.context.gl;C.bindTexture(C.TEXTURE_2D,this.texture),g!==C.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=C.LINEAR),c!==this.filter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,c),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,g||c),this.filter=c),d!==this.wrap&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,d),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,d),this.wrap=d)},Pa.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Pa.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var cu=function(c){var d=this;this._callback=c,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};cu.prototype.trigger=function(){var c=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){c._triggered=!1,c._callback()},0))},cu.prototype.remove=function(){delete this._channel,this._callback=function(){}};var xc=function(c,d,g){this.target=c,this.parent=d,this.mapId=g,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},j(["receive","process"],this),this.invoker=new cu(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=me()?c:p};function Gh(c,d,g){var C=2*Math.PI*6378137/256/Math.pow(2,g);return[c*C-2*Math.PI*6378137/2,d*C-2*Math.PI*6378137/2]}xc.prototype.send=function(c,d,g,C,M){var I=this;M===void 0&&(M=!1);var O=Math.round(1e18*Math.random()).toString(36).substring(0,10);g&&(this.callbacks[O]=g);var z=je(this.globalScope)?void 0:[];return this.target.postMessage({id:O,type:c,hasCallback:!!g,targetMapId:C,mustQueue:M,sourceMapId:this.mapId,data:Wl(d,z)},z),{cancel:function(){g&&delete I.callbacks[O],I.target.postMessage({id:O,type:"<cancel>",targetMapId:C,sourceMapId:I.mapId})}}},xc.prototype.receive=function(c){var d=c.data,g=d.id;if(g&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[g];var C=this.cancelCallbacks[g];delete this.cancelCallbacks[g],C&&C()}else me()||d.mustQueue?(this.tasks[g]=d,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,d)},xc.prototype.process=function(){if(this.taskQueue.length){var c=this.taskQueue.shift(),d=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(c,d)}},xc.prototype.processTask=function(c,d){var g=this;if(d.type==="<response>"){var C=this.callbacks[c];delete this.callbacks[c],C&&(d.error?C(wu(d.error)):C(null,wu(d.data)))}else{var M=!1,I=je(this.globalScope)?void 0:[],O=d.hasCallback?function(re,oe){M=!0,delete g.cancelCallbacks[c],g.target.postMessage({id:c,type:"<response>",sourceMapId:g.mapId,error:re?Wl(re):null,data:Wl(oe,I)},I)}:function(re){M=!0},z=null,G=wu(d.data);if(this.parent[d.type])z=this.parent[d.type](d.sourceMapId,G,O);else if(this.parent.getWorkerSource){var q=d.type.split(".");z=this.parent.getWorkerSource(d.sourceMapId,q[0],G.source)[q[1]](G,O)}else O(new Error("Could not find function "+d.type));!M&&z&&z.cancel&&(this.cancelCallbacks[c]=z.cancel)}},xc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var go=function(c,d){c&&(d?this.setSouthWest(c).setNorthEast(d):c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1]))};go.prototype.setNorthEast=function(c){return this._ne=c instanceof ta?new ta(c.lng,c.lat):ta.convert(c),this},go.prototype.setSouthWest=function(c){return this._sw=c instanceof ta?new ta(c.lng,c.lat):ta.convert(c),this},go.prototype.extend=function(c){var d,g,C=this._sw,M=this._ne;if(c instanceof ta)d=c,g=c;else{if(!(c instanceof go))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(go.convert(c)):this.extend(ta.convert(c)):this;if(g=c._ne,!(d=c._sw)||!g)return this}return C||M?(C.lng=Math.min(d.lng,C.lng),C.lat=Math.min(d.lat,C.lat),M.lng=Math.max(g.lng,M.lng),M.lat=Math.max(g.lat,M.lat)):(this._sw=new ta(d.lng,d.lat),this._ne=new ta(g.lng,g.lat)),this},go.prototype.getCenter=function(){return new ta((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},go.prototype.getSouthWest=function(){return this._sw},go.prototype.getNorthEast=function(){return this._ne},go.prototype.getNorthWest=function(){return new ta(this.getWest(),this.getNorth())},go.prototype.getSouthEast=function(){return new ta(this.getEast(),this.getSouth())},go.prototype.getWest=function(){return this._sw.lng},go.prototype.getSouth=function(){return this._sw.lat},go.prototype.getEast=function(){return this._ne.lng},go.prototype.getNorth=function(){return this._ne.lat},go.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},go.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},go.prototype.isEmpty=function(){return!(this._sw&&this._ne)},go.prototype.contains=function(c){var d=ta.convert(c),g=d.lng,C=d.lat,M=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(M=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=C&&C<=this._ne.lat&&M},go.convert=function(c){return!c||c instanceof go?c:new go(c)};var ta=function(c,d){if(isNaN(c)||isNaN(d))throw new Error("Invalid LngLat object: ("+c+", "+d+")");if(this.lng=+c,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ta.prototype.wrap=function(){return new ta(A(this.lng,-180,180),this.lat)},ta.prototype.toArray=function(){return[this.lng,this.lat]},ta.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ta.prototype.distanceTo=function(c){var d=Math.PI/180,g=this.lat*d,C=c.lat*d,M=Math.sin(g)*Math.sin(C)+Math.cos(g)*Math.cos(C)*Math.cos((c.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(M,1))},ta.prototype.toBounds=function(c){c===void 0&&(c=0);var d=360*c/40075017,g=d/Math.cos(Math.PI/180*this.lat);return new go(new ta(this.lng-g,this.lat-d),new ta(this.lng+g,this.lat+d))},ta.convert=function(c){if(c instanceof ta)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new ta(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new ta(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var eh=2*Math.PI*63710088e-1;function rf(c){return eh*Math.cos(c*Math.PI/180)}function Pm(c){return(180+c)/360}function nf(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function X_(c,d){return c/rf(d)}function _w(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}var Rm=function(c,d,g){g===void 0&&(g=0),this.x=+c,this.y=+d,this.z=+g};Rm.fromLngLat=function(c,d){d===void 0&&(d=0);var g=ta.convert(c);return new Rm(Pm(g.lng),nf(g.lat),X_(d,g.lat))},Rm.prototype.toLngLat=function(){return new ta(360*this.x-180,_w(this.y))},Rm.prototype.toAltitude=function(){return this.z*rf(_w(this.y))},Rm.prototype.meterInMercatorCoordinateUnits=function(){return 1/eh*(c=_w(this.y),1/Math.cos(c*Math.PI/180));var c};var Om=function(c,d,g){this.z=c,this.x=d,this.y=g,this.key=Y_(0,c,c,d,g)};Om.prototype.equals=function(c){return this.z===c.z&&this.x===c.x&&this.y===c.y},Om.prototype.url=function(c,d){var g,C,M,I,O,z=(C=this.y,M=this.z,I=Gh(256*(g=this.x),256*(C=Math.pow(2,M)-C-1),M),O=Gh(256*(g+1),256*(C+1),M),I[0]+","+I[1]+","+O[0]+","+O[1]),G=function(q,re,oe){for(var ce,pe="",De=q;De>0;De--)pe+=(re&(ce=1<<De-1)?1:0)+(oe&ce?2:0);return pe}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",G).replace("{bbox-epsg-3857}",z)},Om.prototype.getTilePoint=function(c){var d=Math.pow(2,this.z);return new f(8192*(c.x*d-this.x),8192*(c.y*d-this.y))},Om.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var rA=function(c,d){this.wrap=c,this.canonical=d,this.key=Y_(c,d.z,d.z,d.x,d.y)},fu=function(c,d,g,C,M){this.overscaledZ=c,this.wrap=d,this.canonical=new Om(g,+C,+M),this.key=Y_(d,c,g,C,M)};function Y_(c,d,g,C,M){(c*=2)<0&&(c=-1*c-1);var I=1<<g;return(I*I*c+I*M+C).toString(36)+g.toString(36)+d.toString(36)}fu.prototype.equals=function(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)},fu.prototype.scaledTo=function(c){var d=this.canonical.z-c;return c>this.canonical.z?new fu(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fu(c,this.wrap,c,this.canonical.x>>d,this.canonical.y>>d)},fu.prototype.calculateScaledKey=function(c,d){var g=this.canonical.z-c;return c>this.canonical.z?Y_(this.wrap*+d,c,this.canonical.z,this.canonical.x,this.canonical.y):Y_(this.wrap*+d,c,c,this.canonical.x>>g,this.canonical.y>>g)},fu.prototype.isChildOf=function(c){if(c.wrap!==this.wrap)return!1;var d=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>d&&c.canonical.y===this.canonical.y>>d},fu.prototype.children=function(c){if(this.overscaledZ>=c)return[new fu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,g=2*this.canonical.x,C=2*this.canonical.y;return[new fu(d,this.wrap,d,g,C),new fu(d,this.wrap,d,g+1,C),new fu(d,this.wrap,d,g,C+1),new fu(d,this.wrap,d,g+1,C+1)]},fu.prototype.isLessThan=function(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))},fu.prototype.wrapped=function(){return new fu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},fu.prototype.unwrapTo=function(c){return new fu(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)},fu.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},fu.prototype.toUnwrapped=function(){return new rA(this.wrap,this.canonical)},fu.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},fu.prototype.getTilePoint=function(c){return this.canonical.getTilePoint(new Rm(c.x-this.wrap,c.y))},dn("CanonicalTileID",Om),dn("OverscaledTileID",fu,{omit:["posMatrix"]});var Iv=function(c,d,g){if(this.uid=c,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(g&&g!=="mapbox"&&g!=="terrarium")return te('"'+g+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var C=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=g||"mapbox";for(var M=0;M<C;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(C,M)]=this.data[this._idx(C-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,C)]=this.data[this._idx(M,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)]};Iv.prototype.get=function(c,d){var g=new Uint8Array(this.data.buffer),C=4*this._idx(c,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(g[C],g[C+1],g[C+2])},Iv.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Iv.prototype._idx=function(c,d){if(c<-1||c>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(c+1)},Iv.prototype._unpackMapbox=function(c,d,g){return(256*c*256+256*d+g)/10-1e4},Iv.prototype._unpackTerrarium=function(c,d,g){return 256*c+d+g/256-32768},Iv.prototype.getPixels=function(){return new Bu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Iv.prototype.backfillBorder=function(c,d,g){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");var C=d*this.dim,M=d*this.dim+this.dim,I=g*this.dim,O=g*this.dim+this.dim;switch(d){case-1:C=M-1;break;case 1:M=C+1}switch(g){case-1:I=O-1;break;case 1:O=I+1}for(var z=-d*this.dim,G=-g*this.dim,q=I;q<O;q++)for(var re=C;re<M;re++)this.data[this._idx(re,q)]=c.data[this._idx(re+z,q+G)]},dn("DEMData",Iv);var Z_=function(c){this._stringToNumber={},this._numberToString=[];for(var d=0;d<c.length;d++){var g=c[d];this._stringToNumber[g]=d,this._numberToString[d]=g}};Z_.prototype.encode=function(c){return this._stringToNumber[c]},Z_.prototype.decode=function(c){return this._numberToString[c]};var W1=function(c,d,g,C,M){this.type="Feature",this._vectorTileFeature=c,c._z=d,c._x=g,c._y=C,this.properties=c.properties,this.id=M},Zy={geometry:{configurable:!0}};Zy.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Zy.geometry.set=function(c){this._geometry=c},W1.prototype.toJSON=function(){var c={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(c[d]=this[d]);return c},Object.defineProperties(W1.prototype,Zy);var qy=function(){this.state={},this.stateChanges={},this.deletedStates={}};qy.prototype.updateState=function(c,d,g){var C=String(d);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][C]=this.stateChanges[c][C]||{},L(this.stateChanges[c][C],g),this.deletedStates[c]===null)for(var M in this.deletedStates[c]={},this.state[c])M!==C&&(this.deletedStates[c][M]=null);else if(this.deletedStates[c]&&this.deletedStates[c][C]===null)for(var I in this.deletedStates[c][C]={},this.state[c][C])g[I]||(this.deletedStates[c][C][I]=null);else for(var O in g)this.deletedStates[c]&&this.deletedStates[c][C]&&this.deletedStates[c][C][O]===null&&delete this.deletedStates[c][C][O]},qy.prototype.removeFeatureState=function(c,d,g){if(this.deletedStates[c]!==null){var C=String(d);if(this.deletedStates[c]=this.deletedStates[c]||{},g&&d!==void 0)this.deletedStates[c][C]!==null&&(this.deletedStates[c][C]=this.deletedStates[c][C]||{},this.deletedStates[c][C][g]=null);else if(d!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][C])for(g in this.deletedStates[c][C]={},this.stateChanges[c][C])this.deletedStates[c][C][g]=null;else this.deletedStates[c][C]=null;else this.deletedStates[c]=null}},qy.prototype.getState=function(c,d){var g=String(d),C=L({},(this.state[c]||{})[g],(this.stateChanges[c]||{})[g]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){var M=this.deletedStates[c][d];if(M===null)return{};for(var I in M)delete C[I]}return C},qy.prototype.initializeTileState=function(c,d){c.setFeatureState(this.state,d)},qy.prototype.coalesceChanges=function(c,d){var g={};for(var C in this.stateChanges){this.state[C]=this.state[C]||{};var M={};for(var I in this.stateChanges[C])this.state[C][I]||(this.state[C][I]={}),L(this.state[C][I],this.stateChanges[C][I]),M[I]=this.state[C][I];g[C]=M}for(var O in this.deletedStates){this.state[O]=this.state[O]||{};var z={};if(this.deletedStates[O]===null)for(var G in this.state[O])z[G]={},this.state[O][G]={};else for(var q in this.deletedStates[O]){if(this.deletedStates[O][q]===null)this.state[O][q]={};else for(var re=0,oe=Object.keys(this.deletedStates[O][q]);re<oe.length;re+=1)delete this.state[O][q][oe[re]];z[q]=this.state[O][q]}g[O]=g[O]||{},L(g[O],z)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(var ce in c)c[ce].setFeatureState(g,d)};var kv=function(c,d){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new wf(8192,16,0),this.grid3D=new wf(8192,16,0),this.featureIndexArray=new se,this.promoteId=d};function nA(c,d,g,C,M){return ee(c,function(I,O){var z=d instanceof Dh?d.get(O):null;return z&&z.evaluate?z.evaluate(g,C,M):z})}function iA(c){for(var d=1/0,g=1/0,C=-1/0,M=-1/0,I=0,O=c;I<O.length;I+=1){var z=O[I];d=Math.min(d,z.x),g=Math.min(g,z.y),C=Math.max(C,z.x),M=Math.max(M,z.y)}return{minX:d,minY:g,maxX:C,maxY:M}}function NP(c,d){return d-c}kv.prototype.insert=function(c,d,g,C,M,I){var O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,C,M);for(var z=I?this.grid3D:this.grid,G=0;G<d.length;G++){for(var q=d[G],re=[1/0,1/0,-1/0,-1/0],oe=0;oe<q.length;oe++){var ce=q[oe];re[0]=Math.min(re[0],ce.x),re[1]=Math.min(re[1],ce.y),re[2]=Math.max(re[2],ce.x),re[3]=Math.max(re[3],ce.y)}re[0]<8192&&re[1]<8192&&re[2]>=0&&re[3]>=0&&z.insert(O,re[0],re[1],re[2],re[3])}},kv.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new If.VectorTile(new yi(this.rawTileData)).layers,this.sourceLayerCoder=new Z_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},kv.prototype.query=function(c,d,g,C){var M=this;this.loadVTLayers();for(var I=c.params||{},O=8192/c.tileSize/c.scale,z=cv(I.filter),G=c.queryGeometry,q=c.queryPadding*O,re=iA(G),oe=this.grid.query(re.minX-q,re.minY-q,re.maxX+q,re.maxY+q),ce=iA(c.cameraQueryGeometry),pe=this.grid3D.query(ce.minX-q,ce.minY-q,ce.maxX+q,ce.maxY+q,function(Nt,Vt,ir,Mr){return function(Wr,Vn,fn,Yn,gn){for(var Fi=0,ai=Wr;Fi<ai.length;Fi+=1){var In=ai[Fi];if(Vn<=In.x&&fn<=In.y&&Yn>=In.x&&gn>=In.y)return!0}var Xi=[new f(Vn,fn),new f(Vn,gn),new f(Yn,gn),new f(Yn,fn)];if(Wr.length>2){for(var Mi=0,ca=Xi;Mi<ca.length;Mi+=1)if(Yc(Wr,ca[Mi]))return!0}for(var Zn=0;Zn<Wr.length-1;Zn++)if(Zc(Wr[Zn],Wr[Zn+1],Xi))return!0;return!1}(c.cameraQueryGeometry,Nt-q,Vt-q,ir+q,Mr+q)}),De=0,$e=pe;De<$e.length;De+=1)oe.push($e[De]);oe.sort(NP);for(var tt,Ze={},mt=function(Nt){var Vt=oe[Nt];if(Vt!==tt){tt=Vt;var ir=M.featureIndexArray.get(Vt),Mr=null;M.loadMatchingFeature(Ze,ir.bucketIndex,ir.sourceLayerIndex,ir.featureIndex,z,I.layers,I.availableImages,d,g,C,function(Wr,Vn,fn){return Mr||(Mr=vo(Wr)),Vn.queryIntersectsFeature(G,Wr,fn,Mr,M.z,c.transform,O,c.pixelPosMatrix)})}},At=0;At<oe.length;At++)mt(At);return Ze},kv.prototype.loadMatchingFeature=function(c,d,g,C,M,I,O,z,G,q,re){var oe=this.bucketLayerIDs[d];if(!I||function(Wr,Vn){for(var fn=0;fn<Wr.length;fn++)if(Vn.indexOf(Wr[fn])>=0)return!0;return!1}(I,oe)){var ce=this.sourceLayerCoder.decode(g),pe=this.vtLayers[ce].feature(C);if(M.needGeometry){var De=no(pe,!0);if(!M.filter(new ti(this.tileID.overscaledZ),De,this.tileID.canonical))return}else if(!M.filter(new ti(this.tileID.overscaledZ),pe))return;for(var $e=this.getId(pe,ce),tt=0;tt<oe.length;tt++){var Ze=oe[tt];if(!(I&&I.indexOf(Ze)<0)){var mt=z[Ze];if(mt){var At={};$e!==void 0&&q&&(At=q.getState(mt.sourceLayer||"_geojsonTileLayer",$e));var Nt=L({},G[Ze]);Nt.paint=nA(Nt.paint,mt.paint,pe,At,O),Nt.layout=nA(Nt.layout,mt.layout,pe,At,O);var Vt=!re||re(pe,mt,At);if(Vt){var ir=new W1(pe,this.z,this.x,this.y,$e);ir.layer=Nt;var Mr=c[Ze];Mr===void 0&&(Mr=c[Ze]=[]),Mr.push({featureIndex:C,feature:ir,intersectionZ:Vt})}}}}}},kv.prototype.lookupSymbolFeatures=function(c,d,g,C,M,I,O,z){var G={};this.loadVTLayers();for(var q=cv(M),re=0,oe=c;re<oe.length;re+=1)this.loadMatchingFeature(G,g,C,oe[re],q,I,O,z,d);return G},kv.prototype.hasLayer=function(c){for(var d=0,g=this.bucketLayerIDs;d<g.length;d+=1)for(var C=0,M=g[d];C<M.length;C+=1)if(c===M[C])return!0;return!1},kv.prototype.getId=function(c,d){var g=c.id;return this.promoteId&&typeof(g=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(g=Number(g)),g},dn("FeatureIndex",kv,{omit:["rawTileData","sourceLayerCoder"]});var zu=function(c,d){this.tileID=c,this.uid=R(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};zu.prototype.registerFadeDuration=function(c){var d=c+this.timeAdded;d<zn.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},zu.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},zu.prototype.loadVectorData=function(c,d,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){for(var C in c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(q,re){var oe={};if(!re)return oe;for(var ce=function(){var $e=De[pe],tt=$e.layerIds.map(function(At){return re.getLayer(At)}).filter(Boolean);if(tt.length!==0){$e.layers=tt,$e.stateDependentLayerIds&&($e.stateDependentLayers=$e.stateDependentLayerIds.map(function(At){return tt.filter(function(Nt){return Nt.id===At})[0]}));for(var Ze=0,mt=tt;Ze<mt.length;Ze+=1)oe[mt[Ze].id]=$e}},pe=0,De=q;pe<De.length;pe+=1)ce();return oe}(c.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var M=this.buckets[C];if(M instanceof ye){if(this.hasSymbolBuckets=!0,!g)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var I in this.buckets){var O=this.buckets[I];if(O instanceof ye&&O.hasRTLText){this.hasRTLText=!0,Ml.isLoading()||Ml.isLoaded()||_v()!=="deferred"||Xl();break}}for(var z in this.queryPadding=0,this.buckets){var G=this.buckets[z];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(z).queryRadius(G))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new b},zu.prototype.unloadVectorData=function(){for(var c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},zu.prototype.getBucket=function(c){return this.buckets[c.id]},zu.prototype.upload=function(c){for(var d in this.buckets){var g=this.buckets[d];g.uploadPending()&&g.upload(c)}var C=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pa(c,this.imageAtlas.image,C.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pa(c,this.glyphAtlasImage,C.ALPHA),this.glyphAtlasImage=null)},zu.prototype.prepare=function(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)},zu.prototype.queryRenderedFeatures=function(c,d,g,C,M,I,O,z,G,q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:M,scale:I,tileSize:this.tileSize,pixelPosMatrix:q,transform:z,params:O,queryPadding:this.queryPadding*G},c,d,g):{}},zu.prototype.querySourceFeatures=function(c,d){var g=this.latestFeatureIndex;if(g&&g.rawTileData){var C=g.loadVTLayers(),M=d?d.sourceLayer:"",I=C._geojsonTileLayer||C[M];if(I)for(var O=cv(d&&d.filter),z=this.tileID.canonical,G=z.z,q=z.x,re=z.y,oe={z:G,x:q,y:re},ce=0;ce<I.length;ce++){var pe=I.feature(ce);if(O.needGeometry){var De=no(pe,!0);if(!O.filter(new ti(this.tileID.overscaledZ),De,this.tileID.canonical))continue}else if(!O.filter(new ti(this.tileID.overscaledZ),pe))continue;var $e=g.getId(pe,M),tt=new W1(pe,G,q,re,$e);tt.tile=oe,c.push(tt)}}},zu.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},zu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},zu.prototype.setExpiryData=function(c){var d=this.expirationTime;if(c.cacheControl){var g=Re(c.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){var C=Date.now(),M=!1;if(this.expirationTime>C)M=!1;else if(d)if(this.expirationTime<d)M=!0;else{var I=this.expirationTime-d;I?this.expirationTime=C+Math.max(I,3e4):M=!0}else M=!0;M?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},zu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},zu.prototype.setFeatureState=function(c,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(c).length!==0){var g=this.latestFeatureIndex.loadVTLayers();for(var C in this.buckets)if(d.style.hasLayer(C)){var M=this.buckets[C],I=M.layers[0].sourceLayer||"_geojsonTileLayer",O=g[I],z=c[I];if(O&&z&&Object.keys(z).length!==0){M.update(z,O,this.imageAtlas&&this.imageAtlas.patternPositions||{});var G=d&&d.style&&d.style.getLayer(C);G&&(this.queryPadding=Math.max(this.queryPadding,G.queryRadius(M)))}}}},zu.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},zu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<zn.now()},zu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},zu.prototype.setHoldDuration=function(c){this.symbolFadeHoldUntil=zn.now()+c},zu.prototype.setDependencies=function(c,d){for(var g={},C=0,M=d;C<M.length;C+=1)g[M[C]]=!0;this.dependencies[c]=g},zu.prototype.hasDependency=function(c,d){for(var g=0,C=c;g<C.length;g+=1){var M=this.dependencies[C[g]];if(M){for(var I=0,O=d;I<O.length;I+=1)if(M[O[I]])return!0}}return!1};var Mg=p.performance,aA=function(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},Mg.mark(this._marks.start)};aA.prototype.finish=function(){Mg.mark(this._marks.end);var c=Mg.getEntriesByName(this._marks.measure);return c.length===0&&(Mg.measure(this._marks.measure,this._marks.start,this._marks.end),c=Mg.getEntriesByName(this._marks.measure),Mg.clearMarks(this._marks.start),Mg.clearMarks(this._marks.end),Mg.clearMeasures(this._marks.measure)),c},o.Actor=xc,o.AlphaImage=gc,o.CanonicalTileID=Om,o.CollisionBoxArray=b,o.Color=Ni,o.DEMData=Iv,o.DataConstantProperty=Pn,o.DictionaryCoder=Z_,o.EXTENT=8192,o.ErrorEvent=it,o.EvaluationParameters=ti,o.Event=Ne,o.Evented=pt,o.FeatureIndex=kv,o.FillBucket=ec,o.FillExtrusionBucket=kf,o.ImageAtlas=or,o.ImagePosition=_r,o.LineBucket=Ca,o.LngLat=ta,o.LngLatBounds=go,o.MercatorCoordinate=Rm,o.ONE_EM=24,o.OverscaledTileID=fu,o.Point=f,o.Point$1=f,o.Properties=uu,o.Protobuf=yi,o.RGBAImage=Bu,o.RequestManager=Si,o.RequestPerformance=aA,o.ResourceType=Fc,o.SegmentVector=xe,o.SourceFeatureState=qy,o.StructArrayLayout1ui2=dd,o.StructArrayLayout2f1f2i16=kp,o.StructArrayLayout2i4=Ef,o.StructArrayLayout3ui6=Bh,o.StructArrayLayout4i8=be,o.SymbolBucket=ye,o.Texture=Pa,o.Tile=zu,o.Transitionable=Cu,o.Uniform1f=yr,o.Uniform1i=hr,o.Uniform2f=Ir,o.Uniform3f=Kr,o.Uniform4f=An,o.UniformColor=Nn,o.UniformMatrix4f=sa,o.UnwrappedTileID=rA,o.ValidationError=Ge,o.WritingMode=Fr,o.ZoomHistory=dv,o.add=function(c,d,g){return c[0]=d[0]+g[0],c[1]=d[1]+g[1],c[2]=d[2]+g[2],c},o.addDynamicAttributes=Ot,o.asyncAll=function(c,d,g){if(!c.length)return g(null,[]);var C=c.length,M=new Array(c.length),I=null;c.forEach(function(O,z){d(O,function(G,q){G&&(I=G),M[z]=q,--C==0&&g(I,M)})})},o.bezier=m,o.bindAll=j,o.browser=zn,o.cacheEntryPossiblyAdded=function(c){++Fo>Wn&&(c.getActor().send("enforceCacheSizeLimit",ci),Fo=0)},o.clamp=E,o.clearTileCache=function(c){var d=p.caches.delete("mapbox-tiles");c&&d.catch(c).then(function(){return c()})},o.clipLine=Mu,o.clone=function(c){var d=new ma(16);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15],d},o.clone$1=W,o.clone$2=function(c){var d=new ma(3);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d},o.collisionCircleLayout=j_,o.config=Zt,o.create=function(){var c=new ma(16);return ma!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},o.create$1=function(){var c=new ma(9);return ma!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c},o.create$2=function(){var c=new ma(4);return ma!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},o.createCommonjsModule=s,o.createExpression=ld,o.createLayout=Es,o.createStyleLayer=function(c){return c.type==="custom"?new Dr(c):new Mn[c.type](c)},o.cross=function(c,d,g){var C=d[0],M=d[1],I=d[2],O=g[0],z=g[1],G=g[2];return c[0]=M*G-I*z,c[1]=I*O-C*G,c[2]=C*z-M*O,c},o.deepEqual=function c(d,g){if(Array.isArray(d)){if(!Array.isArray(g)||d.length!==g.length)return!1;for(var C=0;C<d.length;C++)if(!c(d[C],g[C]))return!1;return!0}if(typeof d=="object"&&d!==null&&g!==null){if(typeof g!="object"||Object.keys(d).length!==Object.keys(g).length)return!1;for(var M in d)if(!c(d[M],g[M]))return!1;return!0}return d===g},o.dot=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]},o.dot$1=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]+c[3]*d[3]},o.ease=x,o.emitValidationErrors=Fa,o.endsWith=H,o.enforceCacheSizeLimit=function(c){Ti(),ne&&ne.then(function(d){d.keys().then(function(g){for(var C=0;C<g.length-c;C++)d.delete(g[C])})})},o.evaluateSizeForFeature=_i,o.evaluateSizeForZoom=Ka,o.evaluateVariableOffset=Ft,o.evented=yv,o.extend=L,o.featureFilter=cv,o.filterObject=U,o.fromRotation=function(c,d){var g=Math.sin(d),C=Math.cos(d);return c[0]=C,c[1]=g,c[2]=0,c[3]=-g,c[4]=C,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},o.getAnchorAlignment=ii,o.getAnchorJustification=Ct,o.getArrayBuffer=mf,o.getImage=ue,o.getJSON=function(c,d){return Dc(L(c,{type:"json"}),d)},o.getRTLTextPluginStatus=_v,o.getReferrer=Gl,o.getVideo=function(c,d){var g,C,M=p.document.createElement("video");M.muted=!0,M.onloadstart=function(){d(null,M)};for(var I=0;I<c.length;I++){var O=p.document.createElement("source");g=c[I],C=void 0,(C=p.document.createElement("a")).href=g,(C.protocol!==p.document.location.protocol||C.host!==p.document.location.host)&&(M.crossOrigin="Anonymous"),O.src=c[I],M.appendChild(O)}return{cancel:function(){}}},o.identity=hl,o.invert=function(c,d){var g=d[0],C=d[1],M=d[2],I=d[3],O=d[4],z=d[5],G=d[6],q=d[7],re=d[8],oe=d[9],ce=d[10],pe=d[11],De=d[12],$e=d[13],tt=d[14],Ze=d[15],mt=g*z-C*O,At=g*G-M*O,Nt=g*q-I*O,Vt=C*G-M*z,ir=C*q-I*z,Mr=M*q-I*G,Wr=re*$e-oe*De,Vn=re*tt-ce*De,fn=re*Ze-pe*De,Yn=oe*tt-ce*$e,gn=oe*Ze-pe*$e,Fi=ce*Ze-pe*tt,ai=mt*Fi-At*gn+Nt*Yn+Vt*fn-ir*Vn+Mr*Wr;return ai?(c[0]=(z*Fi-G*gn+q*Yn)*(ai=1/ai),c[1]=(M*gn-C*Fi-I*Yn)*ai,c[2]=($e*Mr-tt*ir+Ze*Vt)*ai,c[3]=(ce*ir-oe*Mr-pe*Vt)*ai,c[4]=(G*fn-O*Fi-q*Vn)*ai,c[5]=(g*Fi-M*fn+I*Vn)*ai,c[6]=(tt*Nt-De*Mr-Ze*At)*ai,c[7]=(re*Mr-ce*Nt+pe*At)*ai,c[8]=(O*gn-z*fn+q*Wr)*ai,c[9]=(C*fn-g*gn-I*Wr)*ai,c[10]=(De*ir-$e*Nt+Ze*mt)*ai,c[11]=(oe*Nt-re*ir-pe*mt)*ai,c[12]=(z*Vn-O*Yn-G*Wr)*ai,c[13]=(g*Yn-C*Vn+M*Wr)*ai,c[14]=($e*At-De*Vt-tt*mt)*ai,c[15]=(re*Vt-oe*At+ce*mt)*ai,c):null},o.isChar=Yr,o.isMapboxURL=Fn,o.keysDifference=function(c,d){var g=[];for(var C in c)C in d||g.push(C);return g},o.makeRequest=Dc,o.mapObject=ee,o.mercatorXfromLng=Pm,o.mercatorYfromLat=nf,o.mercatorZfromAltitude=X_,o.mul=pg,o.multiply=Zs,o.mvt=If,o.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},o.normalize=function(c,d){var g=d[0],C=d[1],M=d[2],I=g*g+C*C+M*M;return I>0&&(I=1/Math.sqrt(I)),c[0]=d[0]*I,c[1]=d[1]*I,c[2]=d[2]*I,c},o.number=us,o.offscreenCanvasSupported=xl,o.ortho=function(c,d,g,C,M,I,O){var z=1/(d-g),G=1/(C-M),q=1/(I-O);return c[0]=-2*z,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*G,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*q,c[11]=0,c[12]=(d+g)*z,c[13]=(M+C)*G,c[14]=(O+I)*q,c[15]=1,c},o.parseGlyphPBF=function(c){return new yi(c).readFields(vr,[])},o.pbf=yi,o.performSymbolLayout=function(c,d,g,C,M,I,O){c.createArrays(),c.tilePixelRatio=8192/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;var z=c.layers[0].layout,G=c.layers[0]._unevaluatedLayout._values,q={};if(c.textSizeData.kind==="composite"){var re=c.textSizeData,oe=re.maxZoom;q.compositeTextSizes=[G["text-size"].possiblyEvaluate(new ti(re.minZoom),O),G["text-size"].possiblyEvaluate(new ti(oe),O)]}if(c.iconSizeData.kind==="composite"){var ce=c.iconSizeData,pe=ce.maxZoom;q.compositeIconSizes=[G["icon-size"].possiblyEvaluate(new ti(ce.minZoom),O),G["icon-size"].possiblyEvaluate(new ti(pe),O)]}q.layoutTextSize=G["text-size"].possiblyEvaluate(new ti(c.zoom+1),O),q.layoutIconSize=G["icon-size"].possiblyEvaluate(new ti(c.zoom+1),O),q.textMaxSize=G["text-size"].possiblyEvaluate(new ti(18));for(var De=24*z.get("text-line-height"),$e=z.get("text-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",tt=z.get("text-keep-upright"),Ze=z.get("text-size"),mt=function(){var Vt=Nt[At],ir=z.get("text-font").evaluate(Vt,{},O).join(","),Mr=Ze.evaluate(Vt,{},O),Wr=q.layoutTextSize.evaluate(Vt,{},O),Vn=q.layoutIconSize.evaluate(Vt,{},O),fn={horizontal:{},vertical:void 0},Yn=Vt.text,gn=[0,0];if(Yn){var Fi=Yn.toString(),ai=24*z.get("text-letter-spacing").evaluate(Vt,{},O),In=function(na){for(var mo=0,Qa=na;mo<Qa.length;mo+=1)if(xa=Qa[mo].charCodeAt(0),Yr.Arabic(xa)||Yr["Arabic Supplement"](xa)||Yr["Arabic Extended-A"](xa)||Yr["Arabic Presentation Forms-A"](xa)||Yr["Arabic Presentation Forms-B"](xa))return!1;var xa;return!0}(Fi)?ai:0,Xi=z.get("text-anchor").evaluate(Vt,{},O),Mi=z.get("text-variable-anchor");if(!Mi){var ca=z.get("text-radial-offset").evaluate(Vt,{},O);gn=ca?Ft(Xi,[24*ca,Fe]):z.get("text-offset").evaluate(Vt,{},O).map(function(na){return 24*na})}var Zn=$e?"center":z.get("text-justify").evaluate(Vt,{},O),Ia=z.get("symbol-placement"),qo=Ia==="point"?24*z.get("text-max-width").evaluate(Vt,{},O):0,Ko=function(){c.allowVerticalPlacement&&Hc(Fi)&&(fn.vertical=Jt(Yn,d,g,M,ir,qo,De,Xi,"left",In,gn,Fr.vertical,!0,Ia,Wr,Mr))};if(!$e&&Mi){for(var zo=Zn==="auto"?Mi.map(function(na){return Ct(na)}):[Zn],Qo=!1,Ms=0;Ms<zo.length;Ms++){var Js=zo[Ms];if(!fn.horizontal[Js])if(Qo)fn.horizontal[Js]=fn.horizontal[0];else{var hu=Jt(Yn,d,g,M,ir,qo,De,"center",Js,In,gn,Fr.horizontal,!1,Ia,Wr,Mr);hu&&(fn.horizontal[Js]=hu,Qo=hu.positionedLines.length===1)}}Ko()}else{Zn==="auto"&&(Zn=Ct(Xi));var Ol=Jt(Yn,d,g,M,ir,qo,De,Xi,Zn,In,gn,Fr.horizontal,!1,Ia,Wr,Mr);Ol&&(fn.horizontal[Zn]=Ol),Ko(),Hc(Fi)&&$e&&tt&&(fn.vertical=Jt(Yn,d,g,M,ir,qo,De,Xi,Zn,In,gn,Fr.vertical,!1,Ia,Wr,Mr))}}var $u=void 0,Fl=!1;if(Vt.icon&&Vt.icon.name){var $s=C[Vt.icon.name];$s&&($u=function(na,mo,Qa){var xa=ii(Qa),rc=mo[0]-na.displaySize[0]*xa.horizontalAlign,pl=mo[1]-na.displaySize[1]*xa.verticalAlign;return{image:na,top:pl,bottom:pl+na.displaySize[1],left:rc,right:rc+na.displaySize[0]}}(M[Vt.icon.name],z.get("icon-offset").evaluate(Vt,{},O),z.get("icon-anchor").evaluate(Vt,{},O)),Fl=$s.sdf,c.sdfIcons===void 0?c.sdfIcons=$s.sdf:c.sdfIcons!==$s.sdf&&te("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($s.pixelRatio!==c.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}var Uu=Wi(fn.horizontal)||fn.vertical;c.iconsInText=!!Uu&&Uu.iconsInText,(Uu||$u)&&function(na,mo,Qa,xa,rc,pl,$o,ao,dl,ka,bc){var Ci=pl.textMaxSize.evaluate(mo,{});Ci===void 0&&(Ci=$o);var wd,Ra=na.layers[0].layout,Uo=Ra.get("icon-offset").evaluate(mo,{},bc),Hh=Wi(Qa.horizontal),th=$o/24,Fm=na.tilePixelRatio*th,Ky=na.tilePixelRatio*Ci/24,Pv=na.tilePixelRatio*ao,Qy=na.tilePixelRatio*Ra.get("symbol-spacing"),X1=Ra.get("text-padding")*na.tilePixelRatio,Lg=Ra.get("icon-padding")*na.tilePixelRatio,q_=Ra.get("text-max-angle")/180*Math.PI,jh=Ra.get("text-rotation-alignment")==="map"&&Ra.get("symbol-placement")!=="point",K_=Ra.get("icon-rotation-alignment")==="map"&&Ra.get("symbol-placement")!=="point",Wh=Ra.get("symbol-placement"),ms=Qy/2,ys=Ra.get("icon-text-fit");xa&&ys!=="none"&&(na.allowVerticalPlacement&&Qa.vertical&&(wd=ln(xa,Qa.vertical,ys,Ra.get("icon-text-fit-padding"),Uo,th)),Hh&&(xa=ln(xa,Hh,ys,Ra.get("icon-text-fit-padding"),Uo,th)));var Rv=function(sA,wc){wc.x<0||wc.x>=8192||wc.y<0||wc.y>=8192||function(Ls,Np,Vo,Ig,J1,tx,eb,Sd,tb,rx,rb,nb,bw,uA,nx,lA,cA,fA,hA,ib,Pf,r0,pA,Ad,zP){var vl,rl,n0,i0,a0,$m=Ls.addToLineVertexArray(Np,Vo),dA=0,vA=0,gA=0,ww=0,Cw=-1,Ew=-1,Fv={},Sw=Oe(""),ab=0,Aw=0;if(Sd._unevaluatedLayout.getValue("text-radial-offset")===void 0?(ab=(vl=Sd.layout.get("text-offset").evaluate(Pf,{},Ad).map(function(ax){return 24*ax}))[0],Aw=vl[1]):(ab=24*Sd.layout.get("text-radial-offset").evaluate(Pf,{},Ad),Aw=Fe),Ls.allowVerticalPlacement&&Ig.vertical){var mA=Sd.layout.get("text-rotate").evaluate(Pf,{},Ad)+90;i0=new Ts(tb,Np,rx,rb,nb,Ig.vertical,bw,uA,nx,mA),eb&&(a0=new Ts(tb,Np,rx,rb,nb,eb,cA,fA,nx,mA))}if(J1){var Tw=Sd.layout.get("icon-rotate").evaluate(Pf,{}),yA=Sd.layout.get("icon-text-fit")!=="none",Um=Nu(J1,Tw,pA,yA),Mw=eb?Nu(eb,Tw,pA,yA):void 0;n0=new Ts(tb,Np,rx,rb,nb,J1,cA,fA,!1,Tw),dA=4*Um.length;var _A=Ls.iconSizeData,ix=null;_A.kind==="source"?(ix=[128*Sd.layout.get("icon-size").evaluate(Pf,{})])[0]>32640&&te(Ls.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):_A.kind==="composite"&&((ix=[128*r0.compositeIconSizes[0].evaluate(Pf,{},Ad),128*r0.compositeIconSizes[1].evaluate(Pf,{},Ad)])[0]>32640||ix[1]>32640)&&te(Ls.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ls.addSymbols(Ls.icon,Um,ix,ib,hA,Pf,!1,Np,$m.lineStartIndex,$m.lineLength,-1,Ad),Cw=Ls.icon.placedSymbolArray.length-1,Mw&&(vA=4*Mw.length,Ls.addSymbols(Ls.icon,Mw,ix,ib,hA,Pf,Fr.vertical,Np,$m.lineStartIndex,$m.lineLength,-1,Ad),Ew=Ls.icon.placedSymbolArray.length-1)}for(var xA in Ig.horizontal){var ob=Ig.horizontal[xA];if(!rl){Sw=Oe(ob.text);var bA=Sd.layout.get("text-rotate").evaluate(Pf,{},Ad);rl=new Ts(tb,Np,rx,rb,nb,ob,bw,uA,nx,bA)}var Lw=ob.positionedLines.length===1;if(gA+=vn(Ls,Np,ob,tx,Sd,nx,Pf,lA,$m,Ig.vertical?Fr.horizontal:Fr.horizontalOnly,Lw?Object.keys(Ig.horizontal):[xA],Fv,Cw,r0,Ad),Lw)break}Ig.vertical&&(ww+=vn(Ls,Np,Ig.vertical,tx,Sd,nx,Pf,lA,$m,Fr.vertical,["vertical"],Fv,Ew,r0,Ad));var $P=rl?rl.boxStartIndex:Ls.collisionBoxArray.length,UP=rl?rl.boxEndIndex:Ls.collisionBoxArray.length,VP=i0?i0.boxStartIndex:Ls.collisionBoxArray.length,GP=i0?i0.boxEndIndex:Ls.collisionBoxArray.length,HP=n0?n0.boxStartIndex:Ls.collisionBoxArray.length,jP=n0?n0.boxEndIndex:Ls.collisionBoxArray.length,WP=a0?a0.boxStartIndex:Ls.collisionBoxArray.length,XP=a0?a0.boxEndIndex:Ls.collisionBoxArray.length,Td=-1,sb=function(ax,CA){return ax&&ax.circleDiameter?Math.max(ax.circleDiameter,CA):CA};Td=sb(rl,Td),Td=sb(i0,Td),Td=sb(n0,Td);var wA=(Td=sb(a0,Td))>-1?1:0;wA&&(Td*=zP/24),Ls.glyphOffsetArray.length>=ye.MAX_GLYPHS&&te("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Pf.sortKey!==void 0&&Ls.addToSortKeyRanges(Ls.symbolInstances.length,Pf.sortKey),Ls.symbolInstances.emplaceBack(Np.x,Np.y,Fv.right>=0?Fv.right:-1,Fv.center>=0?Fv.center:-1,Fv.left>=0?Fv.left:-1,Fv.vertical||-1,Cw,Ew,Sw,$P,UP,VP,GP,HP,jP,WP,XP,rx,gA,ww,dA,vA,wA,0,bw,ab,Aw,Td)}(na,wc,sA,Qa,xa,rc,wd,na.layers[0],na.collisionBoxArray,mo.index,mo.sourceLayerIndex,na.index,Fm,X1,jh,dl,Pv,Lg,K_,Uo,mo,pl,ka,bc,$o)};if(Wh==="line")for(var Jy=0,Y1=Mu(mo.geometry,0,0,8192,8192);Jy<Y1.length;Jy+=1)for(var Z1=Y1[Jy],Q_=0,J_=Tu(Z1,Qy,q_,Qa.vertical||Hh,xa,24,Ky,na.overscaling,8192);Q_<J_.length;Q_+=1){var q1=J_[Q_];Hh&&ke(na,Hh.text,ms,q1)||Rv(Z1,q1)}else if(Wh==="line-center")for(var e0=0,Ov=mo.geometry;e0<Ov.length;e0+=1){var Dm=Ov[e0];if(Dm.length>1){var K1=zs(Dm,q_,Qa.vertical||Hh,xa,24,Ky);K1&&Rv(Dm,K1)}}else if(mo.type==="Polygon")for(var Bm=0,Nm=_g(mo.geometry,0);Bm<Nm.length;Bm+=1){var Dl=Nm[Bm],Cd=io(Dl,16);Rv(Dl[0],new Xn(Cd.x,Cd.y,0))}else if(mo.type==="LineString")for(var zm=0,ex=mo.geometry;zm<ex.length;zm+=1){var t0=ex[zm];Rv(t0,new Xn(t0[0].x,t0[0].y,0))}else if(mo.type==="Point")for(var xw=0,oA=mo.geometry;xw<oA.length;xw+=1)for(var Q1=0,Ed=oA[xw];Q1<Ed.length;Q1+=1){var fa=Ed[Q1];Rv([fa],new Xn(fa.x,fa.y,0))}}(c,Vt,fn,$u,C,q,Wr,Vn,gn,Fl,O)},At=0,Nt=c.features;At<Nt.length;At+=1)mt();I&&c.generateCollisionDebugBuffers()},o.perspective=function(c,d,g,C,M){var I,O=1/Math.tan(d/2);return c[0]=O/g,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=O,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,M!=null&&M!==1/0?(c[10]=(M+C)*(I=1/(C-M)),c[14]=2*M*C*I):(c[10]=-1,c[14]=-2*C),c},o.pick=function(c,d){for(var g={},C=0;C<d.length;C++){var M=d[C];M in c&&(g[M]=c[M])}return g},o.plugin=Ml,o.polygonIntersectsPolygon=Xc,o.postMapLoadEvent=Qn,o.postTurnstileEvent=$n,o.potpack=Gt,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=dn,o.registerForPluginStateChange=function(c){return c({pluginStatus:Tl,pluginURL:fc}),yv.on("pluginStateChange",c),c},o.renderColorRamp=dg,o.rotate=function(c,d,g){var C=d[0],M=d[1],I=d[2],O=d[3],z=Math.sin(g),G=Math.cos(g);return c[0]=C*G+I*z,c[1]=M*G+O*z,c[2]=C*-z+I*G,c[3]=M*-z+O*G,c},o.rotateX=function(c,d,g){var C=Math.sin(g),M=Math.cos(g),I=d[4],O=d[5],z=d[6],G=d[7],q=d[8],re=d[9],oe=d[10],ce=d[11];return d!==c&&(c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[4]=I*M+q*C,c[5]=O*M+re*C,c[6]=z*M+oe*C,c[7]=G*M+ce*C,c[8]=q*M-I*C,c[9]=re*M-O*C,c[10]=oe*M-z*C,c[11]=ce*M-G*C,c},o.rotateZ=function(c,d,g){var C=Math.sin(g),M=Math.cos(g),I=d[0],O=d[1],z=d[2],G=d[3],q=d[4],re=d[5],oe=d[6],ce=d[7];return d!==c&&(c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[0]=I*M+q*C,c[1]=O*M+re*C,c[2]=z*M+oe*C,c[3]=G*M+ce*C,c[4]=q*M-I*C,c[5]=re*M-O*C,c[6]=oe*M-z*C,c[7]=ce*M-G*C,c},o.scale=function(c,d,g){var C=g[0],M=g[1],I=g[2];return c[0]=d[0]*C,c[1]=d[1]*C,c[2]=d[2]*C,c[3]=d[3]*C,c[4]=d[4]*M,c[5]=d[5]*M,c[6]=d[6]*M,c[7]=d[7]*M,c[8]=d[8]*I,c[9]=d[9]*I,c[10]=d[10]*I,c[11]=d[11]*I,c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],c},o.scale$1=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c[3]=d[3]*g,c},o.scale$2=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c},o.setCacheLimits=function(c,d){ci=c,Wn=d},o.setRTLTextPlugin=function(c,d,g){if(g===void 0&&(g=!1),Tl==="deferred"||Tl==="loading"||Tl==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");fc=zn.resolveURL(c),Tl="deferred",gv=d,Lp(),g||Xl()},o.sphericalToCartesian=function(c){var d=c[0],g=c[1],C=c[2];return g+=90,g*=Math.PI/180,C*=Math.PI/180,{x:d*Math.cos(g)*Math.sin(C),y:d*Math.sin(g)*Math.sin(C),z:d*Math.cos(C)}},o.sqrLen=function(c){var d=c[0],g=c[1];return d*d+g*g},o.styleSpec=_e,o.sub=function(c,d,g){return c[0]=d[0]-g[0],c[1]=d[1]-g[1],c[2]=d[2]-g[2],c},o.symbolSize=gs,o.transformMat3=function(c,d,g){var C=d[0],M=d[1],I=d[2];return c[0]=C*g[0]+M*g[3]+I*g[6],c[1]=C*g[1]+M*g[4]+I*g[7],c[2]=C*g[2]+M*g[5]+I*g[8],c},o.transformMat4=kl,o.translate=function(c,d,g){var C,M,I,O,z,G,q,re,oe,ce,pe,De,$e=g[0],tt=g[1],Ze=g[2];return d===c?(c[12]=d[0]*$e+d[4]*tt+d[8]*Ze+d[12],c[13]=d[1]*$e+d[5]*tt+d[9]*Ze+d[13],c[14]=d[2]*$e+d[6]*tt+d[10]*Ze+d[14],c[15]=d[3]*$e+d[7]*tt+d[11]*Ze+d[15]):(M=d[1],I=d[2],O=d[3],z=d[4],G=d[5],q=d[6],re=d[7],oe=d[8],ce=d[9],pe=d[10],De=d[11],c[0]=C=d[0],c[1]=M,c[2]=I,c[3]=O,c[4]=z,c[5]=G,c[6]=q,c[7]=re,c[8]=oe,c[9]=ce,c[10]=pe,c[11]=De,c[12]=C*$e+z*tt+oe*Ze+d[12],c[13]=M*$e+G*tt+ce*Ze+d[13],c[14]=I*$e+q*tt+pe*Ze+d[14],c[15]=O*$e+re*tt+De*Ze+d[15]),c},o.triggerPluginCompletionEvent=mv,o.uniqueId=R,o.validateCustomStyleLayer=function(c){var d=[],g=c.id;return g===void 0&&d.push({message:"layers."+g+': missing required property "id"'}),c.render===void 0&&d.push({message:"layers."+g+': missing required method "render"'}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&d.push({message:"layers."+g+': property "renderingMode" must be either "2d" or "3d"'}),d},o.validateLight=hd,o.validateStyle=hv,o.values=function(c){var d=[];for(var g in c)d.push(c[g]);return d},o.vectorTile=If,o.version="1.13.2",o.warnOnce=te,o.webpSupported=nn,o.window=p,o.wrap=A}),a(["./shared"],function(o){function s(ae){var ue=typeof ae;if(ue==="number"||ue==="boolean"||ue==="string"||ae==null)return JSON.stringify(ae);if(Array.isArray(ae)){for(var fe="[",Ce=0,Ne=ae;Ce<Ne.length;Ce+=1)fe+=s(Ne[Ce])+",";return fe+"]"}for(var it=Object.keys(ae).sort(),pt="{",_e=0;_e<it.length;_e++)pt+=JSON.stringify(it[_e])+":"+s(ae[it[_e]])+",";return pt+"}"}function u(ae){for(var ue="",fe=0,Ce=o.refProperties;fe<Ce.length;fe+=1)ue+="/"+s(ae[Ce[fe]]);return ue}var l=function(ae){this.keyCache={},ae&&this.replace(ae)};l.prototype.replace=function(ae){this._layerConfigs={},this._layers={},this.update(ae,[])},l.prototype.update=function(ae,ue){for(var fe=this,Ce=0,Ne=ae;Ce<Ne.length;Ce+=1){var it=Ne[Ce];this._layerConfigs[it.id]=it;var pt=this._layers[it.id]=o.createStyleLayer(it);pt._featureFilter=o.featureFilter(pt.filter),this.keyCache[it.id]&&delete this.keyCache[it.id]}for(var _e=0,Ge=ue;_e<Ge.length;_e+=1){var wt=Ge[_e];delete this.keyCache[wt],delete this._layerConfigs[wt],delete this._layers[wt]}this.familiesBySource={};for(var cr=0,fr=function(Br,$r){for(var Ln={},Tr=0;Tr<Br.length;Tr++){var Sn=$r&&$r[Br[Tr].id]||u(Br[Tr]);$r&&($r[Br[Tr].id]=Sn);var pi=Ln[Sn];pi||(pi=Ln[Sn]=[]),pi.push(Br[Tr])}var oi=[];for(var Pi in Ln)oi.push(Ln[Pi]);return oi}(o.values(this._layerConfigs),this.keyCache);cr<fr.length;cr+=1){var $t=fr[cr].map(function(Br){return fe._layers[Br.id]}),pr=$t[0];if(pr.visibility!=="none"){var Rr=pr.source||"",cn=this.familiesBySource[Rr];cn||(cn=this.familiesBySource[Rr]={});var Ht=pr.sourceLayer||"_geojsonTileLayer",an=cn[Ht];an||(an=cn[Ht]=[]),an.push($t)}}};var f=function(ae){var ue={},fe=[];for(var Ce in ae){var Ne=ae[Ce],it=ue[Ce]={};for(var pt in Ne){var _e=Ne[+pt];if(_e&&_e.bitmap.width!==0&&_e.bitmap.height!==0){var Ge={x:0,y:0,w:_e.bitmap.width+2,h:_e.bitmap.height+2};fe.push(Ge),it[pt]={rect:Ge,metrics:_e.metrics}}}}var wt=o.potpack(fe),cr=new o.AlphaImage({width:wt.w||1,height:wt.h||1});for(var fr in ae){var $t=ae[fr];for(var pr in $t){var Rr=$t[+pr];if(Rr&&Rr.bitmap.width!==0&&Rr.bitmap.height!==0){var cn=ue[fr][pr].rect;o.AlphaImage.copy(Rr.bitmap,cr,{x:0,y:0},{x:cn.x+1,y:cn.y+1},Rr.bitmap)}}}this.image=cr,this.positions=ue};o.register("GlyphAtlas",f);var h=function(ae){this.tileID=new o.OverscaledTileID(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.uid=ae.uid,this.zoom=ae.zoom,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.collectResourceTiming,this.returnDependencies=!!ae.returnDependencies,this.promoteId=ae.promoteId};function p(ae,ue,fe){for(var Ce=new o.EvaluationParameters(ue),Ne=0,it=ae;Ne<it.length;Ne+=1)it[Ne].recalculate(Ce,fe)}function v(ae,ue){var fe=o.getArrayBuffer(ae.request,function(Ce,Ne,it,pt){Ce?ue(Ce):Ne&&ue(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(Ne)),rawData:Ne,cacheControl:it,expires:pt})});return function(){fe.cancel(),ue()}}h.prototype.parse=function(ae,ue,fe,Ce,Ne){var it=this;this.status="parsing",this.data=ae,this.collisionBoxArray=new o.CollisionBoxArray;var pt=new o.DictionaryCoder(Object.keys(ae.layers).sort()),_e=new o.FeatureIndex(this.tileID,this.promoteId);_e.bucketLayerIDs=[];var Ge,wt,cr,fr,$t={},pr={featureIndex:_e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:fe},Rr=ue.familiesBySource[this.source];for(var cn in Rr){var Ht=ae.layers[cn];if(Ht){Ht.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+cn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var an=pt.encode(cn),Br=[],$r=0;$r<Ht.length;$r++){var Ln=Ht.feature($r),Tr=_e.getId(Ln,cn);Br.push({feature:Ln,id:Tr,index:$r,sourceLayerIndex:an})}for(var Sn=0,pi=Rr[cn];Sn<pi.length;Sn+=1){var oi=pi[Sn],Pi=oi[0];Pi.minzoom&&this.zoom<Math.floor(Pi.minzoom)||Pi.maxzoom&&this.zoom>=Pi.maxzoom||Pi.visibility!=="none"&&(p(oi,this.zoom,fe),($t[Pi.id]=Pi.createBucket({index:_e.bucketLayerIDs.length,layers:oi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:an,sourceID:this.source})).populate(Br,pr,this.tileID.canonical),_e.bucketLayerIDs.push(oi.map(function(oa){return oa.id})))}}}var Oi=o.mapObject(pr.glyphDependencies,function(oa){return Object.keys(oa).map(Number)});Object.keys(Oi).length?Ce.send("getGlyphs",{uid:this.uid,stacks:Oi},function(oa,bi){Ge||(Ge=oa,wt=bi,Ki.call(it))}):wt={};var Gs=Object.keys(pr.iconDependencies);Gs.length?Ce.send("getImages",{icons:Gs,source:this.source,tileID:this.tileID,type:"icons"},function(oa,bi){Ge||(Ge=oa,cr=bi,Ki.call(it))}):cr={};var Qi=Object.keys(pr.patternDependencies);function Ki(){if(Ge)return Ne(Ge);if(wt&&cr&&fr){var oa=new f(wt),bi=new o.ImageAtlas(cr,fr);for(var Ni in $t){var Fs=$t[Ni];Fs instanceof o.SymbolBucket?(p(Fs.layers,this.zoom,fe),o.performSymbolLayout(Fs,wt,oa.positions,cr,bi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Fs.hasPattern&&(Fs instanceof o.LineBucket||Fs instanceof o.FillBucket||Fs instanceof o.FillExtrusionBucket)&&(p(Fs.layers,this.zoom,fe),Fs.addFeatures(pr,this.tileID.canonical,bi.patternPositions))}this.status="done",Ne(null,{buckets:o.values($t).filter(function(Xu){return!Xu.isEmpty()}),featureIndex:_e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:oa.image,imageAtlas:bi,glyphMap:this.returnDependencies?wt:null,iconMap:this.returnDependencies?cr:null,glyphPositions:this.returnDependencies?oa.positions:null})}}Qi.length?Ce.send("getImages",{icons:Qi,source:this.source,tileID:this.tileID,type:"patterns"},function(oa,bi){Ge||(Ge=oa,fr=bi,Ki.call(it))}):fr={},Ki.call(this)};var m=function(ae,ue,fe,Ce){this.actor=ae,this.layerIndex=ue,this.availableImages=fe,this.loadVectorData=Ce||v,this.loading={},this.loaded={}};m.prototype.loadTile=function(ae,ue){var fe=this,Ce=ae.uid;this.loading||(this.loading={});var Ne=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new o.RequestPerformance(ae.request),it=this.loading[Ce]=new h(ae);it.abort=this.loadVectorData(ae,function(pt,_e){if(delete fe.loading[Ce],pt||!_e)return it.status="done",fe.loaded[Ce]=it,ue(pt);var Ge=_e.rawData,wt={};_e.expires&&(wt.expires=_e.expires),_e.cacheControl&&(wt.cacheControl=_e.cacheControl);var cr={};if(Ne){var fr=Ne.finish();fr&&(cr.resourceTiming=JSON.parse(JSON.stringify(fr)))}it.vectorTile=_e.vectorTile,it.parse(_e.vectorTile,fe.layerIndex,fe.availableImages,fe.actor,function($t,pr){if($t||!pr)return ue($t);ue(null,o.extend({rawTileData:Ge.slice(0)},pr,wt,cr))}),fe.loaded=fe.loaded||{},fe.loaded[Ce]=it})},m.prototype.reloadTile=function(ae,ue){var fe=this,Ce=this.loaded,Ne=ae.uid,it=this;if(Ce&&Ce[Ne]){var pt=Ce[Ne];pt.showCollisionBoxes=ae.showCollisionBoxes;var _e=function(Ge,wt){var cr=pt.reloadCallback;cr&&(delete pt.reloadCallback,pt.parse(pt.vectorTile,it.layerIndex,fe.availableImages,it.actor,cr)),ue(Ge,wt)};pt.status==="parsing"?pt.reloadCallback=_e:pt.status==="done"&&(pt.vectorTile?pt.parse(pt.vectorTile,this.layerIndex,this.availableImages,this.actor,_e):_e())}},m.prototype.abortTile=function(ae,ue){var fe=this.loading,Ce=ae.uid;fe&&fe[Ce]&&fe[Ce].abort&&(fe[Ce].abort(),delete fe[Ce]),ue()},m.prototype.removeTile=function(ae,ue){var fe=this.loaded,Ce=ae.uid;fe&&fe[Ce]&&delete fe[Ce],ue()};var x=o.window.ImageBitmap,E=function(){this.loaded={}};function A(ae,ue){if(ae.length!==0){L(ae[0],ue);for(var fe=1;fe<ae.length;fe++)L(ae[fe],!ue)}}function L(ae,ue){for(var fe=0,Ce=0,Ne=ae.length,it=Ne-1;Ce<Ne;it=Ce++)fe+=(ae[Ce][0]-ae[it][0])*(ae[it][1]+ae[Ce][1]);fe>=0!=!!ue&&ae.reverse()}E.prototype.loadTile=function(ae,ue){var fe=ae.uid,Ce=ae.encoding,Ne=ae.rawImageData,it=x&&Ne instanceof x?this.getImageData(Ne):Ne,pt=new o.DEMData(fe,it,Ce);this.loaded=this.loaded||{},this.loaded[fe]=pt,ue(null,pt)},E.prototype.getImageData=function(ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ae.width,ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=ae.width,this.offscreenCanvas.height=ae.height,this.offscreenCanvasContext.drawImage(ae,0,0,ae.width,ae.height);var ue=this.offscreenCanvasContext.getImageData(-1,-1,ae.width+2,ae.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:ue.width,height:ue.height},ue.data)},E.prototype.removeTile=function(ae){var ue=this.loaded,fe=ae.uid;ue&&ue[fe]&&delete ue[fe]};var k=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,R=function(ae){this._feature=ae,this.extent=o.EXTENT,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))};R.prototype.loadGeometry=function(){if(this._feature.type===1){for(var ae=[],ue=0,fe=this._feature.geometry;ue<fe.length;ue+=1){var Ce=fe[ue];ae.push([new o.Point$1(Ce[0],Ce[1])])}return ae}for(var Ne=[],it=0,pt=this._feature.geometry;it<pt.length;it+=1){for(var _e=[],Ge=0,wt=pt[it];Ge<wt.length;Ge+=1){var cr=wt[Ge];_e.push(new o.Point$1(cr[0],cr[1]))}Ne.push(_e)}return Ne},R.prototype.toGeoJSON=function(ae,ue,fe){return k.call(this,ae,ue,fe)};var D=function(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=ae.length,this._features=ae};D.prototype.feature=function(ae){return new R(this._features[ae])};var $=o.vectorTile.VectorTileFeature,j=H;function H(ae,ue){this.options=ue||{},this.features=ae,this.length=ae.length}function ee(ae,ue){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=ue||4096}H.prototype.feature=function(ae){return new ee(this.features[ae],this.options.extent)},ee.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var ue=0;ue<ae.length;ue++){for(var fe=ae[ue],Ce=[],Ne=0;Ne<fe.length;Ne++)Ce.push(new o.Point$1(fe[Ne][0],fe[Ne][1]));this.geometry.push(Ce)}return this.geometry},ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,ue=1/0,fe=-1/0,Ce=1/0,Ne=-1/0,it=0;it<ae.length;it++)for(var pt=ae[it],_e=0;_e<pt.length;_e++){var Ge=pt[_e];ue=Math.min(ue,Ge.x),fe=Math.max(fe,Ge.x),Ce=Math.min(Ce,Ge.y),Ne=Math.max(Ne,Ge.y)}return[ue,Ce,fe,Ne]},ee.prototype.toGeoJSON=$.prototype.toGeoJSON;var U=Q,W=j;function Q(ae){var ue=new o.pbf;return function(fe,Ce){for(var Ne in fe.layers)Ce.writeMessage(3,te,fe.layers[Ne])}(ae,ue),ue.finish()}function te(ae,ue){var fe;ue.writeVarintField(15,ae.version||1),ue.writeStringField(1,ae.name||""),ue.writeVarintField(5,ae.extent||4096);var Ce={keys:[],values:[],keycache:{},valuecache:{}};for(fe=0;fe<ae.length;fe++)Ce.feature=ae.feature(fe),ue.writeMessage(2,ie,Ce);var Ne=Ce.keys;for(fe=0;fe<Ne.length;fe++)ue.writeStringField(3,Ne[fe]);var it=Ce.values;for(fe=0;fe<it.length;fe++)ue.writeMessage(4,je,it[fe])}function ie(ae,ue){var fe=ae.feature;fe.id!==void 0&&ue.writeVarintField(1,fe.id),ue.writeMessage(2,ve,ae),ue.writeVarintField(3,fe.type),ue.writeMessage(4,We,fe)}function ve(ae,ue){var fe=ae.feature,Ce=ae.keys,Ne=ae.values,it=ae.keycache,pt=ae.valuecache;for(var _e in fe.properties){var Ge=it[_e];Ge===void 0&&(Ce.push(_e),it[_e]=Ge=Ce.length-1),ue.writeVarint(Ge);var wt=fe.properties[_e],cr=typeof wt;cr!=="string"&&cr!=="boolean"&&cr!=="number"&&(wt=JSON.stringify(wt));var fr=cr+":"+wt,$t=pt[fr];$t===void 0&&(Ne.push(wt),pt[fr]=$t=Ne.length-1),ue.writeVarint($t)}}function me(ae,ue){return(ue<<3)+(7&ae)}function Re(ae){return ae<<1^ae>>31}function We(ae,ue){for(var fe=ae.loadGeometry(),Ce=ae.type,Ne=0,it=0,pt=fe.length,_e=0;_e<pt;_e++){var Ge=fe[_e],wt=1;Ce===1&&(wt=Ge.length),ue.writeVarint(me(1,wt));for(var cr=Ce===3?Ge.length-1:Ge.length,fr=0;fr<cr;fr++){fr===1&&Ce!==1&&ue.writeVarint(me(2,cr-1));var $t=Ge[fr].x-Ne,pr=Ge[fr].y-it;ue.writeVarint(Re($t)),ue.writeVarint(Re(pr)),Ne+=$t,it+=pr}Ce===3&&ue.writeVarint(me(7,1))}}function je(ae,ue){var fe=typeof ae;fe==="string"?ue.writeStringField(1,ae):fe==="boolean"?ue.writeBooleanField(7,ae):fe==="number"&&(ae%1!=0?ue.writeDoubleField(3,ae):ae<0?ue.writeSVarintField(6,ae):ue.writeVarintField(5,ae))}function lt(ae,ue,fe,Ce){dt(ae,fe,Ce),dt(ue,2*fe,2*Ce),dt(ue,2*fe+1,2*Ce+1)}function dt(ae,ue,fe){var Ce=ae[ue];ae[ue]=ae[fe],ae[fe]=Ce}function ct(ae,ue,fe,Ce){var Ne=ae-fe,it=ue-Ce;return Ne*Ne+it*it}U.fromVectorTileJs=Q,U.fromGeojsonVt=function(ae,ue){ue=ue||{};var fe={};for(var Ce in ae)fe[Ce]=new j(ae[Ce].features,ue),fe[Ce].name=Ce,fe[Ce].version=ue.version,fe[Ce].extent=ue.extent;return Q({layers:fe})},U.GeoJSONWrapper=W;var Tt=function(ae){return ae[0]},It=function(ae){return ae[1]},Lt=function(ae,ue,fe,Ce,Ne){ue===void 0&&(ue=Tt),fe===void 0&&(fe=It),Ce===void 0&&(Ce=64),Ne===void 0&&(Ne=Float64Array),this.nodeSize=Ce,this.points=ae;for(var it=ae.length<65536?Uint16Array:Uint32Array,pt=this.ids=new it(ae.length),_e=this.coords=new Ne(2*ae.length),Ge=0;Ge<ae.length;Ge++)pt[Ge]=Ge,_e[2*Ge]=ue(ae[Ge]),_e[2*Ge+1]=fe(ae[Ge]);(function wt(cr,fr,$t,pr,Rr,cn){if(!(Rr-pr<=$t)){var Ht=pr+Rr>>1;(function an(Br,$r,Ln,Tr,Sn,pi){for(;Sn>Tr;){if(Sn-Tr>600){var oi=Sn-Tr+1,Pi=Ln-Tr+1,Oi=Math.log(oi),Gs=.5*Math.exp(2*Oi/3),Qi=.5*Math.sqrt(Oi*Gs*(oi-Gs)/oi)*(Pi-oi/2<0?-1:1);an(Br,$r,Ln,Math.max(Tr,Math.floor(Ln-Pi*Gs/oi+Qi)),Math.min(Sn,Math.floor(Ln+(oi-Pi)*Gs/oi+Qi)),pi)}var Ki=$r[2*Ln+pi],oa=Tr,bi=Sn;for(lt(Br,$r,Tr,Ln),$r[2*Sn+pi]>Ki&&lt(Br,$r,Tr,Sn);oa<bi;){for(lt(Br,$r,oa,bi),oa++,bi--;$r[2*oa+pi]<Ki;)oa++;for(;$r[2*bi+pi]>Ki;)bi--}$r[2*Tr+pi]===Ki?lt(Br,$r,Tr,bi):lt(Br,$r,++bi,Sn),bi<=Ln&&(Tr=bi+1),Ln<=bi&&(Sn=bi-1)}})(cr,fr,Ht,pr,Rr,cn%2),wt(cr,fr,$t,pr,Ht-1,cn+1),wt(cr,fr,$t,Ht+1,Rr,cn+1)}})(pt,_e,Ce,0,pt.length-1,0)};Lt.prototype.range=function(ae,ue,fe,Ce){return function(Ne,it,pt,_e,Ge,wt,cr){for(var fr,$t,pr=[0,Ne.length-1,0],Rr=[];pr.length;){var cn=pr.pop(),Ht=pr.pop(),an=pr.pop();if(Ht-an<=cr)for(var Br=an;Br<=Ht;Br++)$t=it[2*Br+1],(fr=it[2*Br])>=pt&&fr<=Ge&&$t>=_e&&$t<=wt&&Rr.push(Ne[Br]);else{var $r=Math.floor((an+Ht)/2);$t=it[2*$r+1],(fr=it[2*$r])>=pt&&fr<=Ge&&$t>=_e&&$t<=wt&&Rr.push(Ne[$r]);var Ln=(cn+1)%2;(cn===0?pt<=fr:_e<=$t)&&(pr.push(an),pr.push($r-1),pr.push(Ln)),(cn===0?Ge>=fr:wt>=$t)&&(pr.push($r+1),pr.push(Ht),pr.push(Ln))}}return Rr}(this.ids,this.coords,ae,ue,fe,Ce,this.nodeSize)},Lt.prototype.within=function(ae,ue,fe){return function(Ce,Ne,it,pt,_e,Ge){for(var wt=[0,Ce.length-1,0],cr=[],fr=_e*_e;wt.length;){var $t=wt.pop(),pr=wt.pop(),Rr=wt.pop();if(pr-Rr<=Ge)for(var cn=Rr;cn<=pr;cn++)ct(Ne[2*cn],Ne[2*cn+1],it,pt)<=fr&&cr.push(Ce[cn]);else{var Ht=Math.floor((Rr+pr)/2),an=Ne[2*Ht],Br=Ne[2*Ht+1];ct(an,Br,it,pt)<=fr&&cr.push(Ce[Ht]);var $r=($t+1)%2;($t===0?it-_e<=an:pt-_e<=Br)&&(wt.push(Rr),wt.push(Ht-1),wt.push($r)),($t===0?it+_e>=an:pt+_e>=Br)&&(wt.push(Ht+1),wt.push(pr),wt.push($r))}}return cr}(this.ids,this.coords,ae,ue,fe,this.nodeSize)};var rn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ae){return ae}},wn=function(ae){this.options=On(Object.create(rn),ae),this.trees=new Array(this.options.maxZoom+1)};function zn(ae,ue,fe,Ce,Ne){return{x:ae,y:ue,zoom:1/0,id:fe,parentId:-1,numPoints:Ce,properties:Ne}}function Zt(ae,ue){var fe=ae.geometry.coordinates,Ce=fe[1];return{x:zt(fe[0]),y:Vr(Ce),zoom:1/0,index:ue,parentId:-1}}function nn(ae){return{type:"Feature",id:ae.id,properties:mn(ae),geometry:{type:"Point",coordinates:[(Ce=ae.x,360*(Ce-.5)),(ue=ae.y,fe=(180-360*ue)*Math.PI/180,360*Math.atan(Math.exp(fe))/Math.PI-90)]}};var ue,fe,Ce}function mn(ae){var ue=ae.numPoints,fe=ue>=1e4?Math.round(ue/1e3)+"k":ue>=1e3?Math.round(ue/100)/10+"k":ue;return On(On({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:ue,point_count_abbreviated:fe})}function zt(ae){return ae/360+.5}function Vr(ae){var ue=Math.sin(ae*Math.PI/180),fe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return fe<0?0:fe>1?1:fe}function On(ae,ue){for(var fe in ue)ae[fe]=ue[fe];return ae}function Si(ae){return ae.x}function Fn(ae){return ae.y}function Ai(ae,ue,fe,Ce,Ne,it){var pt=Ne-fe,_e=it-Ce;if(pt!==0||_e!==0){var Ge=((ae-fe)*pt+(ue-Ce)*_e)/(pt*pt+_e*_e);Ge>1?(fe=Ne,Ce=it):Ge>0&&(fe+=pt*Ge,Ce+=_e*Ge)}return(pt=ae-fe)*pt+(_e=ue-Ce)*_e}function Ua(ae,ue,fe,Ce){var Ne={id:ae===void 0?null:ae,type:ue,geometry:fe,tags:Ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(it){var pt=it.geometry,_e=it.type;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")va(it,pt);else if(_e==="Polygon"||_e==="MultiLineString")for(var Ge=0;Ge<pt.length;Ge++)va(it,pt[Ge]);else if(_e==="MultiPolygon")for(Ge=0;Ge<pt.length;Ge++)for(var wt=0;wt<pt[Ge].length;wt++)va(it,pt[Ge][wt])}(Ne),Ne}function va(ae,ue){for(var fe=0;fe<ue.length;fe+=3)ae.minX=Math.min(ae.minX,ue[fe]),ae.minY=Math.min(ae.minY,ue[fe+1]),ae.maxX=Math.max(ae.maxX,ue[fe]),ae.maxY=Math.max(ae.maxY,ue[fe+1])}function Va(ae,ue,fe,Ce){if(ue.geometry){var Ne=ue.geometry.coordinates,it=ue.geometry.type,pt=Math.pow(fe.tolerance/((1<<fe.maxZoom)*fe.extent),2),_e=[],Ge=ue.id;if(fe.promoteId?Ge=ue.properties[fe.promoteId]:fe.generateId&&(Ge=Ce||0),it==="Point")to(Ne,_e);else if(it==="MultiPoint")for(var wt=0;wt<Ne.length;wt++)to(Ne[wt],_e);else if(it==="LineString")Os(Ne,_e,pt,!1);else if(it==="MultiLineString"){if(fe.lineMetrics){for(wt=0;wt<Ne.length;wt++)Os(Ne[wt],_e=[],pt,!1),ae.push(Ua(Ge,"LineString",_e,ue.properties));return}Ro(Ne,_e,pt,!1)}else if(it==="Polygon")Ro(Ne,_e,pt,!0);else{if(it!=="MultiPolygon"){if(it==="GeometryCollection"){for(wt=0;wt<ue.geometry.geometries.length;wt++)Va(ae,{id:Ge,geometry:ue.geometry.geometries[wt],properties:ue.properties},fe,Ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for(wt=0;wt<Ne.length;wt++){var cr=[];Ro(Ne[wt],cr,pt,!0),_e.push(cr)}}ae.push(Ua(Ge,it,_e,ue.properties))}}function to(ae,ue){ue.push(ne(ae[0])),ue.push(Qt(ae[1])),ue.push(0)}function Os(ae,ue,fe,Ce){for(var Ne,it,pt=0,_e=0;_e<ae.length;_e++){var Ge=ne(ae[_e][0]),wt=Qt(ae[_e][1]);ue.push(Ge),ue.push(wt),ue.push(0),_e>0&&(pt+=Ce?(Ne*wt-Ge*it)/2:Math.sqrt(Math.pow(Ge-Ne,2)+Math.pow(wt-it,2))),Ne=Ge,it=wt}var cr=ue.length-3;ue[2]=1,function fr($t,pr,Rr,cn){for(var Ht,an=cn,Br=Rr-pr>>1,$r=Rr-pr,Ln=$t[pr],Tr=$t[pr+1],Sn=$t[Rr],pi=$t[Rr+1],oi=pr+3;oi<Rr;oi+=3){var Pi=Ai($t[oi],$t[oi+1],Ln,Tr,Sn,pi);if(Pi>an)Ht=oi,an=Pi;else if(Pi===an){var Oi=Math.abs(oi-Br);Oi<$r&&(Ht=oi,$r=Oi)}}an>cn&&(Ht-pr>3&&fr($t,pr,Ht,cn),$t[Ht+2]=an,Rr-Ht>3&&fr($t,Ht,Rr,cn))}(ue,0,cr,fe),ue[cr+2]=1,ue.size=Math.abs(pt),ue.start=0,ue.end=ue.size}function Ro(ae,ue,fe,Ce){for(var Ne=0;Ne<ae.length;Ne++){var it=[];Os(ae[Ne],it,fe,Ce),ue.push(it)}}function ne(ae){return ae/360+.5}function Qt(ae){var ue=Math.sin(ae*Math.PI/180),fe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return fe<0?0:fe>1?1:fe}function gr(ae,ue,fe,Ce,Ne,it,pt,_e){if(Ce/=ue,it>=(fe/=ue)&&pt<Ce)return ae;if(pt<fe||it>=Ce)return null;for(var Ge=[],wt=0;wt<ae.length;wt++){var cr=ae[wt],fr=cr.geometry,$t=cr.type,pr=Ne===0?cr.minX:cr.minY,Rr=Ne===0?cr.maxX:cr.maxY;if(pr>=fe&&Rr<Ce)Ge.push(cr);else if(!(Rr<fe||pr>=Ce)){var cn=[];if($t==="Point"||$t==="MultiPoint")hn(fr,cn,fe,Ce,Ne);else if($t==="LineString")$n(fr,cn,fe,Ce,Ne,!1,_e.lineMetrics);else if($t==="MultiLineString")Qn(fr,cn,fe,Ce,Ne,!1);else if($t==="Polygon")Qn(fr,cn,fe,Ce,Ne,!0);else if($t==="MultiPolygon")for(var Ht=0;Ht<fr.length;Ht++){var an=[];Qn(fr[Ht],an,fe,Ce,Ne,!0),an.length&&cn.push(an)}if(cn.length){if(_e.lineMetrics&&$t==="LineString"){for(Ht=0;Ht<cn.length;Ht++)Ge.push(Ua(cr.id,$t,cn[Ht],cr.tags));continue}$t!=="LineString"&&$t!=="MultiLineString"||(cn.length===1?($t="LineString",cn=cn[0]):$t="MultiLineString"),$t!=="Point"&&$t!=="MultiPoint"||($t=cn.length===3?"Point":"MultiPoint"),Ge.push(Ua(cr.id,$t,cn,cr.tags))}}}return Ge.length?Ge:null}function hn(ae,ue,fe,Ce,Ne){for(var it=0;it<ae.length;it+=3){var pt=ae[it+Ne];pt>=fe&&pt<=Ce&&(ue.push(ae[it]),ue.push(ae[it+1]),ue.push(ae[it+2]))}}function $n(ae,ue,fe,Ce,Ne,it,pt){for(var _e,Ge,wt=Ta(ae),cr=Ne===0?Wn:Ti,fr=ae.start,$t=0;$t<ae.length-3;$t+=3){var pr=ae[$t],Rr=ae[$t+1],cn=ae[$t+2],Ht=ae[$t+3],an=ae[$t+4],Br=Ne===0?pr:Rr,$r=Ne===0?Ht:an,Ln=!1;pt&&(_e=Math.sqrt(Math.pow(pr-Ht,2)+Math.pow(Rr-an,2))),Br<fe?$r>fe&&(Ge=cr(wt,pr,Rr,Ht,an,fe),pt&&(wt.start=fr+_e*Ge)):Br>Ce?$r<Ce&&(Ge=cr(wt,pr,Rr,Ht,an,Ce),pt&&(wt.start=fr+_e*Ge)):ci(wt,pr,Rr,cn),$r<fe&&Br>=fe&&(Ge=cr(wt,pr,Rr,Ht,an,fe),Ln=!0),$r>Ce&&Br<=Ce&&(Ge=cr(wt,pr,Rr,Ht,an,Ce),Ln=!0),!it&&Ln&&(pt&&(wt.end=fr+_e*Ge),ue.push(wt),wt=Ta(ae)),pt&&(fr+=_e)}var Tr=ae.length-3;pr=ae[Tr],Rr=ae[Tr+1],cn=ae[Tr+2],(Br=Ne===0?pr:Rr)>=fe&&Br<=Ce&&ci(wt,pr,Rr,cn),Tr=wt.length-3,it&&Tr>=3&&(wt[Tr]!==wt[0]||wt[Tr+1]!==wt[1])&&ci(wt,wt[0],wt[1],wt[2]),wt.length&&ue.push(wt)}function Ta(ae){var ue=[];return ue.size=ae.size,ue.start=ae.start,ue.end=ae.end,ue}function Qn(ae,ue,fe,Ce,Ne,it){for(var pt=0;pt<ae.length;pt++)$n(ae[pt],ue,fe,Ce,Ne,it,!1)}function ci(ae,ue,fe,Ce){ae.push(ue),ae.push(fe),ae.push(Ce)}function Wn(ae,ue,fe,Ce,Ne,it){var pt=(it-ue)/(Ce-ue);return ae.push(it),ae.push(fe+(Ne-fe)*pt),ae.push(1),pt}function Ti(ae,ue,fe,Ce,Ne,it){var pt=(it-fe)/(Ne-fe);return ae.push(ue+(Ce-ue)*pt),ae.push(it),ae.push(1),pt}function Li(ae,ue){for(var fe=[],Ce=0;Ce<ae.length;Ce++){var Ne,it=ae[Ce],pt=it.type;if(pt==="Point"||pt==="MultiPoint"||pt==="LineString")Ne=Oo(it.geometry,ue);else if(pt==="MultiLineString"||pt==="Polygon"){Ne=[];for(var _e=0;_e<it.geometry.length;_e++)Ne.push(Oo(it.geometry[_e],ue))}else if(pt==="MultiPolygon")for(Ne=[],_e=0;_e<it.geometry.length;_e++){for(var Ge=[],wt=0;wt<it.geometry[_e].length;wt++)Ge.push(Oo(it.geometry[_e][wt],ue));Ne.push(Ge)}fe.push(Ua(it.id,pt,Ne,it.tags))}return fe}function Oo(ae,ue){var fe=[];fe.size=ae.size,ae.start!==void 0&&(fe.start=ae.start,fe.end=ae.end);for(var Ce=0;Ce<ae.length;Ce+=3)fe.push(ae[Ce]+ue,ae[Ce+1],ae[Ce+2]);return fe}function Fo(ae,ue){if(ae.transformed)return ae;var fe,Ce,Ne,it=1<<ae.z,pt=ae.x,_e=ae.y;for(fe=0;fe<ae.features.length;fe++){var Ge=ae.features[fe],wt=Ge.geometry,cr=Ge.type;if(Ge.geometry=[],cr===1)for(Ce=0;Ce<wt.length;Ce+=2)Ge.geometry.push(xl(wt[Ce],wt[Ce+1],ue,it,pt,_e));else for(Ce=0;Ce<wt.length;Ce++){var fr=[];for(Ne=0;Ne<wt[Ce].length;Ne+=2)fr.push(xl(wt[Ce][Ne],wt[Ce][Ne+1],ue,it,pt,_e));Ge.geometry.push(fr)}}return ae.transformed=!0,ae}function xl(ae,ue,fe,Ce,Ne,it){return[Math.round(fe*(ae*Ce-Ne)),Math.round(fe*(ue*Ce-it))]}function Fc(ae,ue,fe,Ce,Ne){for(var it=ue===Ne.maxZoom?0:Ne.tolerance/((1<<ue)*Ne.extent),pt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:fe,y:Ce,z:ue,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},_e=0;_e<ae.length;_e++){pt.numFeatures++,gf(pt,ae[_e],it,Ne);var Ge=ae[_e].minX,wt=ae[_e].minY,cr=ae[_e].maxX,fr=ae[_e].maxY;Ge<pt.minX&&(pt.minX=Ge),wt<pt.minY&&(pt.minY=wt),cr>pt.maxX&&(pt.maxX=cr),fr>pt.maxY&&(pt.maxY=fr)}return pt}function gf(ae,ue,fe,Ce){var Ne=ue.geometry,it=ue.type,pt=[];if(it==="Point"||it==="MultiPoint")for(var _e=0;_e<Ne.length;_e+=3)pt.push(Ne[_e]),pt.push(Ne[_e+1]),ae.numPoints++,ae.numSimplified++;else if(it==="LineString")Gl(pt,Ne,ae,fe,!1,!1);else if(it==="MultiLineString"||it==="Polygon")for(_e=0;_e<Ne.length;_e++)Gl(pt,Ne[_e],ae,fe,it==="Polygon",_e===0);else if(it==="MultiPolygon")for(var Ge=0;Ge<Ne.length;Ge++){var wt=Ne[Ge];for(_e=0;_e<wt.length;_e++)Gl(pt,wt[_e],ae,fe,!0,_e===0)}if(pt.length){var cr=ue.tags||null;if(it==="LineString"&&Ce.lineMetrics){for(var fr in cr={},ue.tags)cr[fr]=ue.tags[fr];cr.mapbox_clip_start=Ne.start/Ne.size,cr.mapbox_clip_end=Ne.end/Ne.size}var $t={geometry:pt,type:it==="Polygon"||it==="MultiPolygon"?3:it==="LineString"||it==="MultiLineString"?2:1,tags:cr};ue.id!==null&&($t.id=ue.id),ae.features.push($t)}}function Gl(ae,ue,fe,Ce,Ne,it){var pt=Ce*Ce;if(Ce>0&&ue.size<(Ne?pt:Ce))fe.numPoints+=ue.length/3;else{for(var _e=[],Ge=0;Ge<ue.length;Ge+=3)(Ce===0||ue[Ge+2]>pt)&&(fe.numSimplified++,_e.push(ue[Ge]),_e.push(ue[Ge+1])),fe.numPoints++;Ne&&function(wt,cr){for(var fr=0,$t=0,pr=wt.length,Rr=pr-2;$t<pr;Rr=$t,$t+=2)fr+=(wt[$t]-wt[Rr])*(wt[$t+1]+wt[Rr+1]);if(fr>0===cr)for($t=0,pr=wt.length;$t<pr/2;$t+=2){var cn=wt[$t],Ht=wt[$t+1];wt[$t]=wt[pr-2-$t],wt[$t+1]=wt[pr-1-$t],wt[pr-2-$t]=cn,wt[pr-1-$t]=Ht}}(_e,it),ae.push(_e)}}function iu(ae,ue){var fe=(ue=this.options=function(Ne,it){for(var pt in it)Ne[pt]=it[pt];return Ne}(Object.create(this.options),ue)).debug;if(fe&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ce=function(Ne,it){var pt=[];if(Ne.type==="FeatureCollection")for(var _e=0;_e<Ne.features.length;_e++)Va(pt,Ne.features[_e],it,_e);else Va(pt,Ne.type==="Feature"?Ne:{geometry:Ne},it);return pt}(ae,ue);this.tiles={},this.tileCoords=[],fe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Ce=function(Ne,it){var pt=it.buffer/it.extent,_e=Ne,Ge=gr(Ne,1,-1-pt,pt,0,-1,2,it),wt=gr(Ne,1,1-pt,2+pt,0,-1,2,it);return(Ge||wt)&&(_e=gr(Ne,1,-pt,1+pt,0,-1,2,it)||[],Ge&&(_e=Li(Ge,1).concat(_e)),wt&&(_e=_e.concat(Li(wt,-1)))),_e}(Ce,ue)).length&&this.splitTile(Ce,0,0,0),fe&&(Ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function bl(ae,ue,fe){return 32*((1<<ae)*fe+ue)+ae}function Dc(ae,ue){var fe=ae.tileID.canonical;if(!this._geoJSONIndex)return ue(null,null);var Ce=this._geoJSONIndex.getTile(fe.z,fe.x,fe.y);if(!Ce)return ue(null,null);var Ne=new D(Ce.features),it=U(Ne);it.byteOffset===0&&it.byteLength===it.buffer.byteLength||(it=new Uint8Array(it)),ue(null,{vectorTile:Ne,rawData:it.buffer})}wn.prototype.load=function(ae){var ue=this.options,fe=ue.log,Ce=ue.minZoom,Ne=ue.maxZoom,it=ue.nodeSize;fe&&console.time("total time");var pt="prepare "+ae.length+" points";fe&&console.time(pt),this.points=ae;for(var _e=[],Ge=0;Ge<ae.length;Ge++)ae[Ge].geometry&&_e.push(Zt(ae[Ge],Ge));this.trees[Ne+1]=new Lt(_e,Si,Fn,it,Float32Array),fe&&console.timeEnd(pt);for(var wt=Ne;wt>=Ce;wt--){var cr=+Date.now();_e=this._cluster(_e,wt),this.trees[wt]=new Lt(_e,Si,Fn,it,Float32Array),fe&&console.log("z%d: %d clusters in %dms",wt,_e.length,+Date.now()-cr)}return fe&&console.timeEnd("total time"),this},wn.prototype.getClusters=function(ae,ue){var fe=((ae[0]+180)%360+360)%360-180,Ce=Math.max(-90,Math.min(90,ae[1])),Ne=ae[2]===180?180:((ae[2]+180)%360+360)%360-180,it=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)fe=-180,Ne=180;else if(fe>Ne){var pt=this.getClusters([fe,Ce,180,it],ue),_e=this.getClusters([-180,Ce,Ne,it],ue);return pt.concat(_e)}for(var Ge=this.trees[this._limitZoom(ue)],wt=[],cr=0,fr=Ge.range(zt(fe),Vr(it),zt(Ne),Vr(Ce));cr<fr.length;cr+=1){var $t=Ge.points[fr[cr]];wt.push($t.numPoints?nn($t):this.points[$t.index])}return wt},wn.prototype.getChildren=function(ae){var ue=this._getOriginId(ae),fe=this._getOriginZoom(ae),Ce="No cluster with the specified id.",Ne=this.trees[fe];if(!Ne)throw new Error(Ce);var it=Ne.points[ue];if(!it)throw new Error(Ce);for(var pt=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),_e=[],Ge=0,wt=Ne.within(it.x,it.y,pt);Ge<wt.length;Ge+=1){var cr=Ne.points[wt[Ge]];cr.parentId===ae&&_e.push(cr.numPoints?nn(cr):this.points[cr.index])}if(_e.length===0)throw new Error(Ce);return _e},wn.prototype.getLeaves=function(ae,ue,fe){var Ce=[];return this._appendLeaves(Ce,ae,ue=ue||10,fe=fe||0,0),Ce},wn.prototype.getTile=function(ae,ue,fe){var Ce=this.trees[this._limitZoom(ae)],Ne=Math.pow(2,ae),it=this.options,pt=it.radius/it.extent,_e=(fe-pt)/Ne,Ge=(fe+1+pt)/Ne,wt={features:[]};return this._addTileFeatures(Ce.range((ue-pt)/Ne,_e,(ue+1+pt)/Ne,Ge),Ce.points,ue,fe,Ne,wt),ue===0&&this._addTileFeatures(Ce.range(1-pt/Ne,_e,1,Ge),Ce.points,Ne,fe,Ne,wt),ue===Ne-1&&this._addTileFeatures(Ce.range(0,_e,pt/Ne,Ge),Ce.points,-1,fe,Ne,wt),wt.features.length?wt:null},wn.prototype.getClusterExpansionZoom=function(ae){for(var ue=this._getOriginZoom(ae)-1;ue<=this.options.maxZoom;){var fe=this.getChildren(ae);if(ue++,fe.length!==1)break;ae=fe[0].properties.cluster_id}return ue},wn.prototype._appendLeaves=function(ae,ue,fe,Ce,Ne){for(var it=0,pt=this.getChildren(ue);it<pt.length;it+=1){var _e=pt[it],Ge=_e.properties;if(Ge&&Ge.cluster?Ne+Ge.point_count<=Ce?Ne+=Ge.point_count:Ne=this._appendLeaves(ae,Ge.cluster_id,fe,Ce,Ne):Ne<Ce?Ne++:ae.push(_e),ae.length===fe)break}return Ne},wn.prototype._addTileFeatures=function(ae,ue,fe,Ce,Ne,it){for(var pt=0,_e=ae;pt<_e.length;pt+=1){var Ge=ue[_e[pt]],wt=Ge.numPoints,cr={type:1,geometry:[[Math.round(this.options.extent*(Ge.x*Ne-fe)),Math.round(this.options.extent*(Ge.y*Ne-Ce))]],tags:wt?mn(Ge):this.points[Ge.index].properties},fr=void 0;wt?fr=Ge.id:this.options.generateId?fr=Ge.index:this.points[Ge.index].id&&(fr=this.points[Ge.index].id),fr!==void 0&&(cr.id=fr),it.features.push(cr)}},wn.prototype._limitZoom=function(ae){return Math.max(this.options.minZoom,Math.min(+ae,this.options.maxZoom+1))},wn.prototype._cluster=function(ae,ue){for(var fe=[],Ce=this.options,Ne=Ce.reduce,it=Ce.minPoints,pt=Ce.radius/(Ce.extent*Math.pow(2,ue)),_e=0;_e<ae.length;_e++){var Ge=ae[_e];if(!(Ge.zoom<=ue)){Ge.zoom=ue;for(var wt=this.trees[ue+1],cr=wt.within(Ge.x,Ge.y,pt),fr=Ge.numPoints||1,$t=fr,pr=0,Rr=cr;pr<Rr.length;pr+=1){var cn=wt.points[Rr[pr]];cn.zoom>ue&&($t+=cn.numPoints||1)}if($t>=it){for(var Ht=Ge.x*fr,an=Ge.y*fr,Br=Ne&&fr>1?this._map(Ge,!0):null,$r=(_e<<5)+(ue+1)+this.points.length,Ln=0,Tr=cr;Ln<Tr.length;Ln+=1){var Sn=wt.points[Tr[Ln]];if(!(Sn.zoom<=ue)){Sn.zoom=ue;var pi=Sn.numPoints||1;Ht+=Sn.x*pi,an+=Sn.y*pi,Sn.parentId=$r,Ne&&(Br||(Br=this._map(Ge,!0)),Ne(Br,this._map(Sn)))}}Ge.parentId=$r,fe.push(zn(Ht/$t,an/$t,$r,$t,Br))}else if(fe.push(Ge),$t>1)for(var oi=0,Pi=cr;oi<Pi.length;oi+=1){var Oi=wt.points[Pi[oi]];Oi.zoom<=ue||(Oi.zoom=ue,fe.push(Oi))}}}return fe},wn.prototype._getOriginId=function(ae){return ae-this.points.length>>5},wn.prototype._getOriginZoom=function(ae){return(ae-this.points.length)%32},wn.prototype._map=function(ae,ue){if(ae.numPoints)return ue?On({},ae.properties):ae.properties;var fe=this.points[ae.index].properties,Ce=this.options.map(fe);return ue&&Ce===fe?On({},Ce):Ce},iu.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},iu.prototype.splitTile=function(ae,ue,fe,Ce,Ne,it,pt){for(var _e=[ae,ue,fe,Ce],Ge=this.options,wt=Ge.debug;_e.length;){Ce=_e.pop(),fe=_e.pop(),ue=_e.pop(),ae=_e.pop();var cr=1<<ue,fr=bl(ue,fe,Ce),$t=this.tiles[fr];if(!$t&&(wt>1&&console.time("creation"),$t=this.tiles[fr]=Fc(ae,ue,fe,Ce,Ge),this.tileCoords.push({z:ue,x:fe,y:Ce}),wt)){wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,fe,Ce,$t.numFeatures,$t.numPoints,$t.numSimplified),console.timeEnd("creation"));var pr="z"+ue;this.stats[pr]=(this.stats[pr]||0)+1,this.total++}if($t.source=ae,Ne){if(ue===Ge.maxZoom||ue===Ne)continue;var Rr=1<<Ne-ue;if(fe!==Math.floor(it/Rr)||Ce!==Math.floor(pt/Rr))continue}else if(ue===Ge.indexMaxZoom||$t.numPoints<=Ge.indexMaxPoints)continue;if($t.source=null,ae.length!==0){wt>1&&console.time("clipping");var cn,Ht,an,Br,$r,Ln,Tr=.5*Ge.buffer/Ge.extent,Sn=.5-Tr,pi=.5+Tr,oi=1+Tr;cn=Ht=an=Br=null,$r=gr(ae,cr,fe-Tr,fe+pi,0,$t.minX,$t.maxX,Ge),Ln=gr(ae,cr,fe+Sn,fe+oi,0,$t.minX,$t.maxX,Ge),ae=null,$r&&(cn=gr($r,cr,Ce-Tr,Ce+pi,1,$t.minY,$t.maxY,Ge),Ht=gr($r,cr,Ce+Sn,Ce+oi,1,$t.minY,$t.maxY,Ge),$r=null),Ln&&(an=gr(Ln,cr,Ce-Tr,Ce+pi,1,$t.minY,$t.maxY,Ge),Br=gr(Ln,cr,Ce+Sn,Ce+oi,1,$t.minY,$t.maxY,Ge),Ln=null),wt>1&&console.timeEnd("clipping"),_e.push(cn||[],ue+1,2*fe,2*Ce),_e.push(Ht||[],ue+1,2*fe,2*Ce+1),_e.push(an||[],ue+1,2*fe+1,2*Ce),_e.push(Br||[],ue+1,2*fe+1,2*Ce+1)}}},iu.prototype.getTile=function(ae,ue,fe){var Ce=this.options,Ne=Ce.extent,it=Ce.debug;if(ae<0||ae>24)return null;var pt=1<<ae,_e=bl(ae,ue=(ue%pt+pt)%pt,fe);if(this.tiles[_e])return Fo(this.tiles[_e],Ne);it>1&&console.log("drilling down to z%d-%d-%d",ae,ue,fe);for(var Ge,wt=ae,cr=ue,fr=fe;!Ge&&wt>0;)wt--,cr=Math.floor(cr/2),fr=Math.floor(fr/2),Ge=this.tiles[bl(wt,cr,fr)];return Ge&&Ge.source?(it>1&&console.log("found parent tile z%d-%d-%d",wt,cr,fr),it>1&&console.time("drilling down"),this.splitTile(Ge.source,wt,cr,fr,ae,ue,fe),it>1&&console.timeEnd("drilling down"),this.tiles[_e]?Fo(this.tiles[_e],Ne):null):null};var mf=function(ae){function ue(fe,Ce,Ne,it){ae.call(this,fe,Ce,Ne,Dc),it&&(this.loadGeoJSON=it)}return ae&&(ue.__proto__=ae),(ue.prototype=Object.create(ae&&ae.prototype)).constructor=ue,ue.prototype.loadData=function(fe,Ce){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Ce,this._pendingLoadDataParams=fe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},ue.prototype._loadData=function(){var fe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Ce=this._pendingCallback,Ne=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var it=!!(Ne&&Ne.request&&Ne.request.collectResourceTiming)&&new o.RequestPerformance(Ne.request);this.loadGeoJSON(Ne,function(pt,_e){if(pt||!_e)return Ce(pt);if(typeof _e!="object")return Ce(new Error("Input data given to '"+Ne.source+"' is not a valid GeoJSON object."));(function $t(pr,Rr){var cn,Ht=pr&&pr.type;if(Ht==="FeatureCollection")for(cn=0;cn<pr.features.length;cn++)$t(pr.features[cn],Rr);else if(Ht==="GeometryCollection")for(cn=0;cn<pr.geometries.length;cn++)$t(pr.geometries[cn],Rr);else if(Ht==="Feature")$t(pr.geometry,Rr);else if(Ht==="Polygon")A(pr.coordinates,Rr);else if(Ht==="MultiPolygon")for(cn=0;cn<pr.coordinates.length;cn++)A(pr.coordinates[cn],Rr);return pr})(_e,!0);try{if(Ne.filter){var Ge=o.createExpression(Ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ge.result==="error")throw new Error(Ge.value.map(function($t){return $t.key+": "+$t.message}).join(", "));var wt=_e.features.filter(function($t){return Ge.value.evaluate({zoom:0},$t)});_e={type:"FeatureCollection",features:wt}}fe._geoJSONIndex=Ne.cluster?new wn(function($t){var pr=$t.superclusterOptions,Rr=$t.clusterProperties;if(!Rr||!pr)return pr;for(var cn={},Ht={},an={accumulated:null,zoom:0},Br={properties:null},$r=Object.keys(Rr),Ln=0,Tr=$r;Ln<Tr.length;Ln+=1){var Sn=Tr[Ln],pi=Rr[Sn],oi=pi[0],Pi=o.createExpression(pi[1]),Oi=o.createExpression(typeof oi=="string"?[oi,["accumulated"],["get",Sn]]:oi);cn[Sn]=Pi.value,Ht[Sn]=Oi.value}return pr.map=function(Gs){Br.properties=Gs;for(var Qi={},Ki=0,oa=$r;Ki<oa.length;Ki+=1){var bi=oa[Ki];Qi[bi]=cn[bi].evaluate(an,Br)}return Qi},pr.reduce=function(Gs,Qi){Br.properties=Qi;for(var Ki=0,oa=$r;Ki<oa.length;Ki+=1){var bi=oa[Ki];an.accumulated=Gs[bi],Gs[bi]=Ht[bi].evaluate(an,Br)}},pr}(Ne)).load(_e.features):function($t,pr){return new iu($t,pr)}(_e,Ne.geojsonVtOptions)}catch($t){return Ce($t)}fe.loaded={};var cr={};if(it){var fr=it.finish();fr&&(cr.resourceTiming={},cr.resourceTiming[Ne.source]=JSON.parse(JSON.stringify(fr)))}Ce(null,cr)})}},ue.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},ue.prototype.reloadTile=function(fe,Ce){var Ne=this.loaded;return Ne&&Ne[fe.uid]?ae.prototype.reloadTile.call(this,fe,Ce):this.loadTile(fe,Ce)},ue.prototype.loadGeoJSON=function(fe,Ce){if(fe.request)o.getJSON(fe.request,Ce);else{if(typeof fe.data!="string")return Ce(new Error("Input data given to '"+fe.source+"' is not a valid GeoJSON object."));try{return Ce(null,JSON.parse(fe.data))}catch{return Ce(new Error("Input data given to '"+fe.source+"' is not a valid GeoJSON object."))}}},ue.prototype.removeSource=function(fe,Ce){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Ce()},ue.prototype.getClusterExpansionZoom=function(fe,Ce){try{Ce(null,this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId))}catch(Ne){Ce(Ne)}},ue.prototype.getClusterChildren=function(fe,Ce){try{Ce(null,this._geoJSONIndex.getChildren(fe.clusterId))}catch(Ne){Ce(Ne)}},ue.prototype.getClusterLeaves=function(fe,Ce){try{Ce(null,this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset))}catch(Ne){Ce(Ne)}},ue}(m),fo=function(ae){var ue=this;this.self=ae,this.actor=new o.Actor(ae,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:m,geojson:mf},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(fe,Ce){if(ue.workerSourceTypes[fe])throw new Error('Worker source with name "'+fe+'" already registered.');ue.workerSourceTypes[fe]=Ce},this.self.registerRTLTextPlugin=function(fe){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=fe.applyArabicShaping,o.plugin.processBidirectionalText=fe.processBidirectionalText,o.plugin.processStyledBidirectionalText=fe.processStyledBidirectionalText}};return fo.prototype.setReferrer=function(ae,ue){this.referrer=ue},fo.prototype.setImages=function(ae,ue,fe){for(var Ce in this.availableImages[ae]=ue,this.workerSources[ae]){var Ne=this.workerSources[ae][Ce];for(var it in Ne)Ne[it].availableImages=ue}fe()},fo.prototype.setLayers=function(ae,ue,fe){this.getLayerIndex(ae).replace(ue),fe()},fo.prototype.updateLayers=function(ae,ue,fe){this.getLayerIndex(ae).update(ue.layers,ue.removedIds),fe()},fo.prototype.loadTile=function(ae,ue,fe){this.getWorkerSource(ae,ue.type,ue.source).loadTile(ue,fe)},fo.prototype.loadDEMTile=function(ae,ue,fe){this.getDEMWorkerSource(ae,ue.source).loadTile(ue,fe)},fo.prototype.reloadTile=function(ae,ue,fe){this.getWorkerSource(ae,ue.type,ue.source).reloadTile(ue,fe)},fo.prototype.abortTile=function(ae,ue,fe){this.getWorkerSource(ae,ue.type,ue.source).abortTile(ue,fe)},fo.prototype.removeTile=function(ae,ue,fe){this.getWorkerSource(ae,ue.type,ue.source).removeTile(ue,fe)},fo.prototype.removeDEMTile=function(ae,ue){this.getDEMWorkerSource(ae,ue.source).removeTile(ue)},fo.prototype.removeSource=function(ae,ue,fe){if(this.workerSources[ae]&&this.workerSources[ae][ue.type]&&this.workerSources[ae][ue.type][ue.source]){var Ce=this.workerSources[ae][ue.type][ue.source];delete this.workerSources[ae][ue.type][ue.source],Ce.removeSource!==void 0?Ce.removeSource(ue,fe):fe()}},fo.prototype.loadWorkerSource=function(ae,ue,fe){try{this.self.importScripts(ue.url),fe()}catch(Ce){fe(Ce.toString())}},fo.prototype.syncRTLPluginState=function(ae,ue,fe){try{o.plugin.setState(ue);var Ce=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&Ce!=null){this.self.importScripts(Ce);var Ne=o.plugin.isParsed();fe(Ne?void 0:new Error("RTL Text Plugin failed to import scripts from "+Ce),Ne)}}catch(it){fe(it.toString())}},fo.prototype.getAvailableImages=function(ae){var ue=this.availableImages[ae];return ue||(ue=[]),ue},fo.prototype.getLayerIndex=function(ae){var ue=this.layerIndexes[ae];return ue||(ue=this.layerIndexes[ae]=new l),ue},fo.prototype.getWorkerSource=function(ae,ue,fe){var Ce=this;return this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][ue]||(this.workerSources[ae][ue]={}),this.workerSources[ae][ue][fe]||(this.workerSources[ae][ue][fe]=new this.workerSourceTypes[ue]({send:function(Ne,it,pt){Ce.actor.send(Ne,it,pt,ae)}},this.getLayerIndex(ae),this.getAvailableImages(ae))),this.workerSources[ae][ue][fe]},fo.prototype.getDEMWorkerSource=function(ae,ue){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][ue]||(this.demWorkerSources[ae][ue]=new E),this.demWorkerSources[ae][ue]},fo.prototype.enforceCacheSizeLimit=function(ae,ue){o.enforceCacheSizeLimit(ue)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new fo(self)),fo}),a(["./shared"],function(o){var s=o.createCommonjsModule(function(y){function b(P){return!_(P)}function _(P){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var N,V,J=new Blob([""],{type:"text/javascript"}),se=URL.createObjectURL(J);try{V=new Worker(se),N=!0}catch{N=!1}return V&&V.terminate(),URL.revokeObjectURL(se),N}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var N=document.createElement("canvas");N.width=N.height=1;var V=N.getContext("2d");if(!V)return!1;var J=V.getImageData(0,0,1,1);return J&&J.width===N.width}()?(S[F=P&&P.failIfMajorPerformanceCaveat]===void 0&&(S[F]=function(N){var V=function(se){var de=document.createElement("canvas"),xe=Object.create(b.webGLContextAttributes);return xe.failIfMajorPerformanceCaveat=se,de.probablySupportsContext?de.probablySupportsContext("webgl",xe)||de.probablySupportsContext("experimental-webgl",xe):de.supportsContext?de.supportsContext("webgl",xe)||de.supportsContext("experimental-webgl",xe):de.getContext("webgl",xe)||de.getContext("experimental-webgl",xe)}(N);if(!V)return!1;var J=V.createShader(V.VERTEX_SHADER);return!(!J||V.isContextLost())&&(V.shaderSource(J,"void main() {}"),V.compileShader(J),V.getShaderParameter(J,V.COMPILE_STATUS)===!0)}(F)),S[F]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var F}y.exports?y.exports=b:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=b,window.mapboxgl.notSupportedReason=_);var S={};b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),u={create:function(y,b,_){var S=o.window.document.createElement(y);return b!==void 0&&(S.className=b),_&&_.appendChild(S),S},createNS:function(y,b){return o.window.document.createElementNS(y,b)}},l=o.window.document&&o.window.document.documentElement.style;function f(y){if(!l)return y[0];for(var b=0;b<y.length;b++)if(y[b]in l)return y[b];return y[0]}var h,p=f(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);u.disableDrag=function(){l&&p&&(h=l[p],l[p]="none")},u.enableDrag=function(){l&&p&&(l[p]=h)};var v=f(["transform","WebkitTransform"]);u.setTransform=function(y,b){y.style[v]=b};var m=!1;try{var x=Object.defineProperty({},"passive",{get:function(){m=!0}});o.window.addEventListener("test",x,x),o.window.removeEventListener("test",x,x)}catch{m=!1}u.addEventListener=function(y,b,_,S){S===void 0&&(S={}),y.addEventListener(b,_,"passive"in S&&m?S:S.capture)},u.removeEventListener=function(y,b,_,S){S===void 0&&(S={}),y.removeEventListener(b,_,"passive"in S&&m?S:S.capture)};var E=function(y){y.preventDefault(),y.stopPropagation(),o.window.removeEventListener("click",E,!0)};function A(y){var b=y.userImage;return!!(b&&b.render&&b.render())&&(y.data.replace(new Uint8Array(b.data.buffer)),!0)}u.suppressClick=function(){o.window.addEventListener("click",E,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",E,!0)},0)},u.mousePos=function(y,b){var _=y.getBoundingClientRect();return new o.Point(b.clientX-_.left-y.clientLeft,b.clientY-_.top-y.clientTop)},u.touchPos=function(y,b){for(var _=y.getBoundingClientRect(),S=[],P=0;P<b.length;P++)S.push(new o.Point(b[P].clientX-_.left-y.clientLeft,b[P].clientY-_.top-y.clientTop));return S},u.mouseButton=function(y){return o.window.InstallTrigger!==void 0&&y.button===2&&y.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button},u.remove=function(y){y.parentNode&&y.parentNode.removeChild(y)};var L=function(y){function b(){y.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.isLoaded=function(){return this.loaded},b.prototype.setLoaded=function(_){if(this.loaded!==_&&(this.loaded=_,_)){for(var S=0,P=this.requestors;S<P.length;S+=1){var F=P[S];this._notify(F.ids,F.callback)}this.requestors=[]}},b.prototype.getImage=function(_){return this.images[_]},b.prototype.addImage=function(_,S){this._validate(_,S)&&(this.images[_]=S)},b.prototype._validate=function(_,S){var P=!0;return this._validateStretch(S.stretchX,S.data&&S.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+_+'" has invalid "stretchX" value'))),P=!1),this._validateStretch(S.stretchY,S.data&&S.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+_+'" has invalid "stretchY" value'))),P=!1),this._validateContent(S.content,S)||(this.fire(new o.ErrorEvent(new Error('Image "'+_+'" has invalid "content" value'))),P=!1),P},b.prototype._validateStretch=function(_,S){if(!_)return!0;for(var P=0,F=0,N=_;F<N.length;F+=1){var V=N[F];if(V[0]<P||V[1]<V[0]||S<V[1])return!1;P=V[1]}return!0},b.prototype._validateContent=function(_,S){return!(_&&(_.length!==4||_[0]<0||S.data.width<_[0]||_[1]<0||S.data.height<_[1]||_[2]<0||S.data.width<_[2]||_[3]<0||S.data.height<_[3]||_[2]<_[0]||_[3]<_[1]))},b.prototype.updateImage=function(_,S){S.version=this.images[_].version+1,this.images[_]=S,this.updatedImages[_]=!0},b.prototype.removeImage=function(_){var S=this.images[_];delete this.images[_],delete this.patterns[_],S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()},b.prototype.listImages=function(){return Object.keys(this.images)},b.prototype.getImages=function(_,S){var P=!0;if(!this.isLoaded())for(var F=0,N=_;F<N.length;F+=1)this.images[N[F]]||(P=!1);this.isLoaded()||P?this._notify(_,S):this.requestors.push({ids:_,callback:S})},b.prototype._notify=function(_,S){for(var P={},F=0,N=_;F<N.length;F+=1){var V=N[F];this.images[V]||this.fire(new o.Event("styleimagemissing",{id:V}));var J=this.images[V];J?P[V]={data:J.data.clone(),pixelRatio:J.pixelRatio,sdf:J.sdf,version:J.version,stretchX:J.stretchX,stretchY:J.stretchY,content:J.content,hasRenderCallback:Boolean(J.userImage&&J.userImage.render)}:o.warnOnce('Image "'+V+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}S(null,P)},b.prototype.getPixelSize=function(){var _=this.atlasImage;return{width:_.width,height:_.height}},b.prototype.getPattern=function(_){var S=this.patterns[_],P=this.getImage(_);if(!P)return null;if(S&&S.position.version===P.version)return S.position;if(S)S.position.version=P.version;else{var F={w:P.data.width+2,h:P.data.height+2,x:0,y:0},N=new o.ImagePosition(F,P);this.patterns[_]={bin:F,position:N}}return this._updatePatternAtlas(),this.patterns[_].position},b.prototype.bind=function(_){var S=_.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(_,this.atlasImage,S.RGBA),this.atlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE)},b.prototype._updatePatternAtlas=function(){var _=[];for(var S in this.patterns)_.push(this.patterns[S].bin);var P=o.potpack(_),F=P.w,N=P.h,V=this.atlasImage;for(var J in V.resize({width:F||1,height:N||1}),this.patterns){var se=this.patterns[J].bin,de=se.x+1,xe=se.y+1,Ee=this.images[J].data,Ue=Ee.width,Be=Ee.height;o.RGBAImage.copy(Ee,V,{x:0,y:0},{x:de,y:xe},{width:Ue,height:Be}),o.RGBAImage.copy(Ee,V,{x:0,y:Be-1},{x:de,y:xe-1},{width:Ue,height:1}),o.RGBAImage.copy(Ee,V,{x:0,y:0},{x:de,y:xe+Be},{width:Ue,height:1}),o.RGBAImage.copy(Ee,V,{x:Ue-1,y:0},{x:de-1,y:xe},{width:1,height:Be}),o.RGBAImage.copy(Ee,V,{x:0,y:0},{x:de+Ue,y:xe},{width:1,height:Be})}this.dirty=!0},b.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},b.prototype.dispatchRenderCallbacks=function(_){for(var S=0,P=_;S<P.length;S+=1){var F=P[S];if(!this.callbackDispatchedThisFrame[F]){this.callbackDispatchedThisFrame[F]=!0;var N=this.images[F];A(N)&&this.updateImage(F,N)}}},b}(o.Evented),k=$,R=$,D=1e20;function $(y,b,_,S,P,F){this.fontSize=y||24,this.buffer=b===void 0?3:b,this.cutoff=S||.25,this.fontFamily=P||"sans-serif",this.fontWeight=F||"normal",this.radius=_||8;var N=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=N,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.d=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Int16Array(N),this.middle=Math.round(N/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function j(y,b,_,S,P,F,N){for(var V=0;V<b;V++){for(var J=0;J<_;J++)S[J]=y[J*b+V];for(H(S,P,F,N,_),J=0;J<_;J++)y[J*b+V]=P[J]}for(J=0;J<_;J++){for(V=0;V<b;V++)S[V]=y[J*b+V];for(H(S,P,F,N,b),V=0;V<b;V++)y[J*b+V]=Math.sqrt(P[V])}}function H(y,b,_,S,P){_[0]=0,S[0]=-D,S[1]=+D;for(var F=1,N=0;F<P;F++){for(var V=(y[F]+F*F-(y[_[N]]+_[N]*_[N]))/(2*F-2*_[N]);V<=S[N];)N--,V=(y[F]+F*F-(y[_[N]]+_[N]*_[N]))/(2*F-2*_[N]);_[++N]=F,S[N]=V,S[N+1]=+D}for(F=0,N=0;F<P;F++){for(;S[N+1]<F;)N++;b[F]=(F-_[N])*(F-_[N])+y[_[N]]}}$.prototype.draw=function(y){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(y,this.buffer,this.middle);for(var b=this.ctx.getImageData(0,0,this.size,this.size),_=new Uint8ClampedArray(this.size*this.size),S=0;S<this.size*this.size;S++){var P=b.data[4*S+3]/255;this.gridOuter[S]=P===1?0:P===0?D:Math.pow(Math.max(0,.5-P),2),this.gridInner[S]=P===1?D:P===0?0:Math.pow(Math.max(0,P-.5),2)}for(j(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),j(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),S=0;S<this.size*this.size;S++)_[S]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[S]-this.gridInner[S])/this.radius+this.cutoff))));return _},k.default=R;var ee=function(y,b){this.requestManager=y,this.localIdeographFontFamily=b,this.entries={}};ee.prototype.setURL=function(y){this.url=y},ee.prototype.getGlyphs=function(y,b){var _=this,S=[];for(var P in y)for(var F=0,N=y[P];F<N.length;F+=1)S.push({stack:P,id:N[F]});o.asyncAll(S,function(V,J){var se=V.stack,de=V.id,xe=_.entries[se];xe||(xe=_.entries[se]={glyphs:{},requests:{},ranges:{}});var Ee=xe.glyphs[de];if(Ee===void 0){if(Ee=_._tinySDF(xe,se,de))return xe.glyphs[de]=Ee,void J(null,{stack:se,id:de,glyph:Ee});var Ue=Math.floor(de/256);if(256*Ue>65535)J(new Error("glyphs > 65535 not supported"));else if(xe.ranges[Ue])J(null,{stack:se,id:de,glyph:Ee});else{var Be=xe.requests[Ue];Be||(Be=xe.requests[Ue]=[],ee.loadGlyphRange(se,Ue,_.url,_.requestManager,function(Ke,Oe){if(Oe){for(var Qe in Oe)_._doesCharSupportLocalGlyph(+Qe)||(xe.glyphs[+Qe]=Oe[+Qe]);xe.ranges[Ue]=!0}for(var ft=0,xt=Be;ft<xt.length;ft+=1)(0,xt[ft])(Ke,Oe);delete xe.requests[Ue]})),Be.push(function(Ke,Oe){Ke?J(Ke):Oe&&J(null,{stack:se,id:de,glyph:Oe[de]||null})})}}else J(null,{stack:se,id:de,glyph:Ee})},function(V,J){if(V)b(V);else if(J){for(var se={},de=0,xe=J;de<xe.length;de+=1){var Ee=xe[de],Ue=Ee.stack,Be=Ee.id,Ke=Ee.glyph;(se[Ue]||(se[Ue]={}))[Be]=Ke&&{id:Ke.id,bitmap:Ke.bitmap.clone(),metrics:Ke.metrics}}b(null,se)}})},ee.prototype._doesCharSupportLocalGlyph=function(y){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](y)||o.isChar["Hangul Syllables"](y)||o.isChar.Hiragana(y)||o.isChar.Katakana(y))},ee.prototype._tinySDF=function(y,b,_){var S=this.localIdeographFontFamily;if(S&&this._doesCharSupportLocalGlyph(_)){var P=y.tinySDF;if(!P){var F="400";/bold/i.test(b)?F="900":/medium/i.test(b)?F="500":/light/i.test(b)&&(F="200"),P=y.tinySDF=new ee.TinySDF(24,3,8,.25,S,F)}return{id:_,bitmap:new o.AlphaImage({width:30,height:30},P.draw(String.fromCharCode(_))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ee.loadGlyphRange=function(y,b,_,S,P){var F=256*b,N=F+255,V=S.transformRequest(S.normalizeGlyphsURL(_).replace("{fontstack}",y).replace("{range}",F+"-"+N),o.ResourceType.Glyphs);o.getArrayBuffer(V,function(J,se){if(J)P(J);else if(se){for(var de={},xe=0,Ee=o.parseGlyphPBF(se);xe<Ee.length;xe+=1){var Ue=Ee[xe];de[Ue.id]=Ue}P(null,de)}})},ee.TinySDF=k;var U=function(){this.specification=o.styleSpec.light.position};U.prototype.possiblyEvaluate=function(y,b){return o.sphericalToCartesian(y.expression.evaluate(b))},U.prototype.interpolate=function(y,b,_){return{x:o.number(y.x,b.x,_),y:o.number(y.y,b.y,_),z:o.number(y.z,b.z,_)}};var W=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new U,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),Q=function(y){function b(_){y.call(this),this._transitionable=new o.Transitionable(W),this.setLight(_),this._transitioning=this._transitionable.untransitioned()}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getLight=function(){return this._transitionable.serialize()},b.prototype.setLight=function(_,S){if(S===void 0&&(S={}),!this._validate(o.validateLight,_,S))for(var P in _){var F=_[P];o.endsWith(P,"-transition")?this._transitionable.setTransition(P.slice(0,-11),F):this._transitionable.setValue(P,F)}},b.prototype.updateTransitions=function(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)},b.prototype.hasTransition=function(){return this._transitioning.hasTransition()},b.prototype.recalculate=function(_){this.properties=this._transitioning.possiblyEvaluate(_)},b.prototype._validate=function(_,S,P){return(!P||P.validate!==!1)&&o.emitValidationErrors(this,_.call(o.validateStyle,o.extend({value:S,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},b}(o.Evented),te=function(y,b){this.width=y,this.height=b,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};te.prototype.getDash=function(y,b){var _=y.join(",")+String(b);return this.dashEntry[_]||(this.dashEntry[_]=this.addDash(y,b)),this.dashEntry[_]},te.prototype.getDashRanges=function(y,b,_){var S=[],P=y.length%2==1?-y[y.length-1]*_:0,F=y[0]*_,N=!0;S.push({left:P,right:F,isDash:N,zeroLength:y[0]===0});for(var V=y[0],J=1;J<y.length;J++){var se=y[J];S.push({left:P=V*_,right:F=(V+=se)*_,isDash:N=!N,zeroLength:se===0})}return S},te.prototype.addRoundDash=function(y,b,_){for(var S=b/2,P=-_;P<=_;P++)for(var F=this.width*(this.nextRow+_+P),N=0,V=y[N],J=0;J<this.width;J++){J/V.right>1&&(V=y[++N]);var se=Math.abs(J-V.left),de=Math.abs(J-V.right),xe=Math.min(se,de),Ee=void 0,Ue=P/_*(S+1);if(V.isDash){var Be=S-Math.abs(Ue);Ee=Math.sqrt(xe*xe+Be*Be)}else Ee=S-Math.sqrt(xe*xe+Ue*Ue);this.data[F+J]=Math.max(0,Math.min(255,Ee+128))}},te.prototype.addRegularDash=function(y){for(var b=y.length-1;b>=0;--b){var _=y[b],S=y[b+1];_.zeroLength?y.splice(b,1):S&&S.isDash===_.isDash&&(S.left=_.left,y.splice(b,1))}var P=y[0],F=y[y.length-1];P.isDash===F.isDash&&(P.left=F.left-this.width,F.right=P.right+this.width);for(var N=this.width*this.nextRow,V=0,J=y[V],se=0;se<this.width;se++){se/J.right>1&&(J=y[++V]);var de=Math.abs(se-J.left),xe=Math.abs(se-J.right),Ee=Math.min(de,xe);this.data[N+se]=Math.max(0,Math.min(255,(J.isDash?Ee:-Ee)+128))}},te.prototype.addDash=function(y,b){var _=b?7:0,S=2*_+1;if(this.nextRow+S>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var P=0,F=0;F<y.length;F++)P+=y[F];if(P!==0){var N=this.width/P,V=this.getDashRanges(y,this.width,N);b?this.addRoundDash(V,N,_):this.addRegularDash(V)}var J={y:(this.nextRow+_+.5)/this.height,height:2*_/this.height,width:P};return this.nextRow+=S,this.dirty=!0,J},te.prototype.bind=function(y){var b=y.gl;this.texture?(b.bindTexture(b.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,b.texSubImage2D(b.TEXTURE_2D,0,0,0,this.width,this.height,b.ALPHA,b.UNSIGNED_BYTE,this.data))):(this.texture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texImage2D(b.TEXTURE_2D,0,b.ALPHA,this.width,this.height,0,b.ALPHA,b.UNSIGNED_BYTE,this.data))};var ie=function y(b,_){this.workerPool=b,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var S=this.workerPool.acquire(this.id),P=0;P<S.length;P++){var F=new y.Actor(S[P],_,this.id);F.name="Worker "+P,this.actors.push(F)}};function ve(y,b,_){var S=function(P,F){if(P)return _(P);if(F){var N=o.pick(o.extend(F,y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);F.vector_layers&&(N.vectorLayers=F.vector_layers,N.vectorLayerIds=N.vectorLayers.map(function(V){return V.id})),N.tiles=b.canonicalizeTileset(N,y.url),_(null,N)}};return y.url?o.getJSON(b.transformRequest(b.normalizeSourceURL(y.url),o.ResourceType.Source),S):o.browser.frame(function(){return S(null,y)})}ie.prototype.broadcast=function(y,b,_){o.asyncAll(this.actors,function(S,P){S.send(y,b,P)},_=_||function(){})},ie.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ie.prototype.remove=function(){this.actors.forEach(function(y){y.remove()}),this.actors=[],this.workerPool.release(this.id)},ie.Actor=o.Actor;var me=function(y,b,_){this.bounds=o.LngLatBounds.convert(this.validateBounds(y)),this.minzoom=b||0,this.maxzoom=_||24};me.prototype.validateBounds=function(y){return Array.isArray(y)&&y.length===4?[Math.max(-180,y[0]),Math.max(-90,y[1]),Math.min(180,y[2]),Math.min(90,y[3])]:[-180,-90,180,90]},me.prototype.contains=function(y){var b=Math.pow(2,y.z),_=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*b),S=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*b),P=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*b),F=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*b);return y.x>=_&&y.x<P&&y.y>=S&&y.y<F};var Re=function(y){function b(_,S,P,F){if(y.call(this),this.id=_,this.dispatcher=P,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(S,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},S),this._collectResourceTiming=S.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(F)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ve(this._options,this.map._requestManager,function(S,P){_._tileJSONRequest=null,_._loaded=!0,S?_.fire(new o.ErrorEvent(S)):P&&(o.extend(_,P),P.bounds&&(_.tileBounds=new me(P.bounds,_.minzoom,_.maxzoom)),o.postTurnstileEvent(P.tiles,_.map._requestManager._customAccessToken),o.postMapLoadEvent(P.tiles,_.map._getMapId(),_.map._requestManager._skuToken,_.map._requestManager._customAccessToken),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},b.prototype.loaded=function(){return this._loaded},b.prototype.hasTile=function(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.setSourceProperty=function(_){this._tileJSONRequest&&this._tileJSONRequest.cancel(),_(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},b.prototype.setTiles=function(_){var S=this;return this.setSourceProperty(function(){S._options.tiles=_}),this},b.prototype.setUrl=function(_){var S=this;return this.setSourceProperty(function(){S.url=_,S._options.url=_}),this},b.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},b.prototype.serialize=function(){return o.extend({},this._options)},b.prototype.loadTile=function(_,S){var P=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),F={request:this.map._requestManager.transformRequest(P,o.ResourceType.Tile),uid:_.uid,tileID:_.tileID,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function N(V,J){return delete _.request,_.aborted?S(null):V&&V.status!==404?S(V):(J&&J.resourceTiming&&(_.resourceTiming=J.resourceTiming),this.map._refreshExpiredTiles&&J&&_.setExpiryData(J),_.loadVectorData(J,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),S(null),void(_.reloadCallback&&(this.loadTile(_,_.reloadCallback),_.reloadCallback=null)))}F.request.collectResourceTiming=this._collectResourceTiming,_.actor&&_.state!=="expired"?_.state==="loading"?_.reloadCallback=S:_.request=_.actor.send("reloadTile",F,N.bind(this)):(_.actor=this.dispatcher.getActor(),_.request=_.actor.send("loadTile",F,N.bind(this)))},b.prototype.abortTile=function(_){_.request&&(_.request.cancel(),delete _.request),_.actor&&_.actor.send("abortTile",{uid:_.uid,type:this.type,source:this.id},void 0)},b.prototype.unloadTile=function(_){_.unloadVectorData(),_.actor&&_.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id},void 0)},b.prototype.hasTransition=function(){return!1},b}(o.Evented),We=function(y){function b(_,S,P,F){y.call(this),this.id=_,this.dispatcher=P,this.setEventedParent(F),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},S),o.extend(this,o.pick(S,["url","scheme","tileSize"]))}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ve(this._options,this.map._requestManager,function(S,P){_._tileJSONRequest=null,_._loaded=!0,S?_.fire(new o.ErrorEvent(S)):P&&(o.extend(_,P),P.bounds&&(_.tileBounds=new me(P.bounds,_.minzoom,_.maxzoom)),o.postTurnstileEvent(P.tiles),o.postMapLoadEvent(P.tiles,_.map._getMapId(),_.map._requestManager._skuToken),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},b.prototype.loaded=function(){return this._loaded},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},b.prototype.serialize=function(){return o.extend({},this._options)},b.prototype.hasTile=function(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)},b.prototype.loadTile=function(_,S){var P=this,F=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);_.request=o.getImage(this.map._requestManager.transformRequest(F,o.ResourceType.Tile),function(N,V){if(delete _.request,_.aborted)_.state="unloaded",S(null);else if(N)_.state="errored",S(N);else if(V){P.map._refreshExpiredTiles&&_.setExpiryData(V),delete V.cacheControl,delete V.expires;var J=P.map.painter.context,se=J.gl;_.texture=P.map.painter.getTileTexture(V.width),_.texture?_.texture.update(V,{useMipmap:!0}):(_.texture=new o.Texture(J,V,se.RGBA,{useMipmap:!0}),_.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE,se.LINEAR_MIPMAP_NEAREST),J.extTextureFilterAnisotropic&&se.texParameterf(se.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax)),_.state="loaded",o.cacheEntryPossiblyAdded(P.dispatcher),S(null)}})},b.prototype.abortTile=function(_,S){_.request&&(_.request.cancel(),delete _.request),S()},b.prototype.unloadTile=function(_,S){_.texture&&this.map.painter.saveTileTexture(_.texture),S()},b.prototype.hasTransition=function(){return!1},b}(o.Evented),je=function(y){function b(_,S,P,F){y.call(this,_,S,P,F),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},S),this.encoding=S.encoding||"mapbox"}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},b.prototype.loadTile=function(_,S){var P=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function F(N,V){N&&(_.state="errored",S(N)),V&&(_.dem=V,_.needsHillshadePrepare=!0,_.state="loaded",S(null))}_.request=o.getImage(this.map._requestManager.transformRequest(P,o.ResourceType.Tile),function(N,V){if(delete _.request,_.aborted)_.state="unloaded",S(null);else if(N)_.state="errored",S(N);else if(V){this.map._refreshExpiredTiles&&_.setExpiryData(V),delete V.cacheControl,delete V.expires;var J=o.window.ImageBitmap&&V instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?V:o.browser.getImageData(V,1),se={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:J,encoding:this.encoding};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",se,F.bind(this)))}}.bind(this)),_.neighboringTiles=this._getNeighboringTiles(_.tileID)},b.prototype._getNeighboringTiles=function(_){var S=_.canonical,P=Math.pow(2,S.z),F=(S.x-1+P)%P,N=S.x===0?_.wrap-1:_.wrap,V=(S.x+1+P)%P,J=S.x+1===P?_.wrap+1:_.wrap,se={};return se[new o.OverscaledTileID(_.overscaledZ,N,S.z,F,S.y).key]={backfilled:!1},se[new o.OverscaledTileID(_.overscaledZ,J,S.z,V,S.y).key]={backfilled:!1},S.y>0&&(se[new o.OverscaledTileID(_.overscaledZ,N,S.z,F,S.y-1).key]={backfilled:!1},se[new o.OverscaledTileID(_.overscaledZ,_.wrap,S.z,S.x,S.y-1).key]={backfilled:!1},se[new o.OverscaledTileID(_.overscaledZ,J,S.z,V,S.y-1).key]={backfilled:!1}),S.y+1<P&&(se[new o.OverscaledTileID(_.overscaledZ,N,S.z,F,S.y+1).key]={backfilled:!1},se[new o.OverscaledTileID(_.overscaledZ,_.wrap,S.z,S.x,S.y+1).key]={backfilled:!1},se[new o.OverscaledTileID(_.overscaledZ,J,S.z,V,S.y+1).key]={backfilled:!1}),se},b.prototype.unloadTile=function(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded",_.actor&&_.actor.send("removeDEMTile",{uid:_.uid,source:this.id})},b}(We),lt=function(y){function b(_,S,P,F){y.call(this),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=P.getActor(),this.setEventedParent(F),this._data=S.data,this._options=o.extend({},S),this._collectResourceTiming=S.collectResourceTiming,this._resourceTiming=[],S.maxzoom!==void 0&&(this.maxzoom=S.maxzoom),S.type&&(this.type=S.type),S.attribution&&(this.attribution=S.attribution),this.promoteId=S.promoteId;var N=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:S.cluster||!1,geojsonVtOptions:{buffer:(S.buffer!==void 0?S.buffer:128)*N,tolerance:(S.tolerance!==void 0?S.tolerance:.375)*N,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:S.lineMetrics||!1,generateId:S.generateId||!1},superclusterOptions:{maxZoom:S.clusterMaxZoom!==void 0?Math.min(S.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,S.clusterMinPoints||2),extent:o.EXTENT,radius:(S.clusterRadius||50)*N,log:!1,generateId:S.generateId||!1},clusterProperties:S.clusterProperties,filter:S.filter},S.workerOptions)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(S){if(S)_.fire(new o.ErrorEvent(S));else{var P={dataType:"source",sourceDataType:"metadata"};_._collectResourceTiming&&_._resourceTiming&&_._resourceTiming.length>0&&(P.resourceTiming=_._resourceTiming,_._resourceTiming=[]),_.fire(new o.Event("data",P))}})},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.setData=function(_){var S=this;return this._data=_,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(P){if(P)S.fire(new o.ErrorEvent(P));else{var F={dataType:"source",sourceDataType:"content"};S._collectResourceTiming&&S._resourceTiming&&S._resourceTiming.length>0&&(F.resourceTiming=S._resourceTiming,S._resourceTiming=[]),S.fire(new o.Event("data",F))}}),this},b.prototype.getClusterExpansionZoom=function(_,S){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},S),this},b.prototype.getClusterChildren=function(_,S){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},S),this},b.prototype.getClusterLeaves=function(_,S,P,F){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:S,offset:P},F),this},b.prototype._updateWorkerData=function(_){var S=this;this._loaded=!1;var P=o.extend({},this.workerOptions),F=this._data;typeof F=="string"?(P.request=this.map._requestManager.transformRequest(o.browser.resolveURL(F),o.ResourceType.Source),P.request.collectResourceTiming=this._collectResourceTiming):P.data=JSON.stringify(F),this.actor.send(this.type+".loadData",P,function(N,V){S._removed||V&&V.abandoned||(S._loaded=!0,V&&V.resourceTiming&&V.resourceTiming[S.id]&&(S._resourceTiming=V.resourceTiming[S.id].slice(0)),S.actor.send(S.type+".coalesce",{source:P.source},null),_(N))})},b.prototype.loaded=function(){return this._loaded},b.prototype.loadTile=function(_,S){var P=this,F=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(F,{type:this.type,uid:_.uid,tileID:_.tileID,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(N,V){return delete _.request,_.unloadVectorData(),_.aborted?S(null):N?S(N):(_.loadVectorData(V,P.map.painter,F==="reloadTile"),S(null))})},b.prototype.abortTile=function(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0},b.prototype.unloadTile=function(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})},b.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},b.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},b.prototype.hasTransition=function(){return!1},b}(o.Evented),dt=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ct=function(y){function b(_,S,P,F){y.call(this),this.id=_,this.dispatcher=P,this.coordinates=S.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(F),this.options=S}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(_,S){var P=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(F,N){P._loaded=!0,F?P.fire(new o.ErrorEvent(F)):N&&(P.image=N,_&&(P.coordinates=_),S&&S(),P._finishLoading())})},b.prototype.loaded=function(){return this._loaded},b.prototype.updateImage=function(_){var S=this;return this.image&&_.url?(this.options.url=_.url,this.load(_.coordinates,function(){S.texture=null}),this):this},b.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.setCoordinates=function(_){var S=this;this.coordinates=_;var P=_.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(N){for(var V=1/0,J=1/0,se=-1/0,de=-1/0,xe=0,Ee=N;xe<Ee.length;xe+=1){var Ue=Ee[xe];V=Math.min(V,Ue.x),J=Math.min(J,Ue.y),se=Math.max(se,Ue.x),de=Math.max(de,Ue.y)}var Be=Math.max(se-V,de-J),Ke=Math.max(0,Math.floor(-Math.log(Be)/Math.LN2)),Oe=Math.pow(2,Ke);return new o.CanonicalTileID(Ke,Math.floor((V+se)/2*Oe),Math.floor((J+de)/2*Oe))}(P),this.minzoom=this.maxzoom=this.tileID.z;var F=P.map(function(N){return S.tileID.getTilePoint(N)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(F[0].x,F[0].y,0,0),this._boundsArray.emplaceBack(F[1].x,F[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(F[3].x,F[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(F[2].x,F[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},b.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var _=this.map.painter.context,S=_.gl;for(var P in this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,dt.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(_,this.image,S.RGBA),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE)),this.tiles){var F=this.tiles[P];F.state!=="loaded"&&(F.state="loaded",F.texture=this.texture)}}},b.prototype.loadTile=function(_,S){this.tileID&&this.tileID.equals(_.tileID.canonical)?(this.tiles[String(_.tileID.wrap)]=_,_.buckets={},S(null)):(_.state="errored",S(null))},b.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},b.prototype.hasTransition=function(){return!1},b}(o.Evented),Tt=function(y){function b(_,S,P,F){y.call(this,_,S,P,F),this.roundZoom=!0,this.type="video",this.options=S}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this._loaded=!1;var S=this.options;this.urls=[];for(var P=0,F=S.urls;P<F.length;P+=1)this.urls.push(this.map._requestManager.transformRequest(F[P],o.ResourceType.Source).url);o.getVideo(this.urls,function(N,V){_._loaded=!0,N?_.fire(new o.ErrorEvent(N)):V&&(_.video=V,_.video.loop=!0,_.video.addEventListener("playing",function(){_.map.triggerRepaint()}),_.map&&_.video.play(),_._finishLoading())})},b.prototype.pause=function(){this.video&&this.video.pause()},b.prototype.play=function(){this.video&&this.video.play()},b.prototype.seek=function(_){if(this.video){var S=this.video.seekable;_<S.start(0)||_>S.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+S.start(0)+" and "+S.end(0)+"-second mark."))):this.video.currentTime=_}},b.prototype.getVideo=function(){return this.video},b.prototype.onAdd=function(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},b.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var _=this.map.painter.context,S=_.gl;for(var P in this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,dt.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.texSubImage2D(S.TEXTURE_2D,0,0,0,S.RGBA,S.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(_,this.video,S.RGBA),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE)),this.tiles){var F=this.tiles[P];F.state!=="loaded"&&(F.state="loaded",F.texture=this.texture)}}},b.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},b.prototype.hasTransition=function(){return this.video&&!this.video.paused},b}(ct),It=function(y){function b(_,S,P,F){y.call(this,_,S,P,F),S.coordinates?Array.isArray(S.coordinates)&&S.coordinates.length===4&&!S.coordinates.some(function(N){return!Array.isArray(N)||N.length!==2||N.some(function(V){return typeof V!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'missing required property "coordinates"'))),S.animate&&typeof S.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'optional "animate" property must be a boolean value'))),S.canvas?typeof S.canvas=="string"||S.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'missing required property "canvas"'))),this.options=S,this.animate=S.animate===void 0||S.animate}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},b.prototype.getCanvas=function(){return this.canvas},b.prototype.onAdd=function(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()},b.prototype.onRemove=function(){this.pause()},b.prototype.prepare=function(){var _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var S=this.map.painter.context,P=S.gl;for(var F in this.boundsBuffer||(this.boundsBuffer=S.createVertexBuffer(this._boundsArray,dt.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(S,this.canvas,P.RGBA,{premultiply:!0}),this.tiles){var N=this.tiles[F];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture)}}},b.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},b.prototype.hasTransition=function(){return this._playing},b.prototype._hasInvalidDimensions=function(){for(var _=0,S=[this.canvas.width,this.canvas.height];_<S.length;_+=1){var P=S[_];if(isNaN(P)||P<=0)return!0}return!1},b}(ct),Lt={vector:Re,raster:We,"raster-dem":je,geojson:lt,video:Tt,image:ct,canvas:It};function rn(y,b){var _=o.identity([]);return o.translate(_,_,[1,1,0]),o.scale(_,_,[.5*y.width,.5*y.height,1]),o.multiply(_,_,y.calculatePosMatrix(b.toUnwrapped()))}function wn(y,b,_,S,P,F){var N=function(Ke,Oe,Qe){if(Ke)for(var ft=0,xt=Ke;ft<xt.length;ft+=1){var Ut=Oe[xt[ft]];if(Ut&&Ut.source===Qe&&Ut.type==="fill-extrusion")return!0}else for(var Bt in Oe){var Wt=Oe[Bt];if(Wt.source===Qe&&Wt.type==="fill-extrusion")return!0}return!1}(P&&P.layers,b,y.id),V=F.maxPitchScaleFactor(),J=y.tilesIn(S,V,N);J.sort(zn);for(var se=[],de=0,xe=J;de<xe.length;de+=1){var Ee=xe[de];se.push({wrappedTileID:Ee.tileID.wrapped().key,queryResults:Ee.tile.queryRenderedFeatures(b,_,y._state,Ee.queryGeometry,Ee.cameraQueryGeometry,Ee.scale,P,F,V,rn(y.transform,Ee.tileID))})}var Ue=function(Ke){for(var Oe={},Qe={},ft=0,xt=Ke;ft<xt.length;ft+=1){var Ut=xt[ft],Bt=Ut.queryResults,Wt=Ut.wrappedTileID,hr=Qe[Wt]=Qe[Wt]||{};for(var yr in Bt)for(var Ir=Bt[yr],Kr=hr[yr]=hr[yr]||{},An=Oe[yr]=Oe[yr]||[],Nn=0,Dn=Ir;Nn<Dn.length;Nn+=1){var sa=Dn[Nn];Kr[sa.featureIndex]||(Kr[sa.featureIndex]=!0,An.push(sa))}}return Oe}(se);for(var Be in Ue)Ue[Be].forEach(function(Ke){var Oe=Ke.feature,Qe=y.getFeatureState(Oe.layer["source-layer"],Oe.id);Oe.source=Oe.layer.source,Oe.layer["source-layer"]&&(Oe.sourceLayer=Oe.layer["source-layer"]),Oe.state=Qe});return Ue}function zn(y,b){var _=y.tileID,S=b.tileID;return _.overscaledZ-S.overscaledZ||_.canonical.y-S.canonical.y||_.wrap-S.wrap||_.canonical.x-S.canonical.x}var Zt=function(y,b){this.max=y,this.onRemove=b,this.reset()};Zt.prototype.reset=function(){for(var y in this.data)for(var b=0,_=this.data[y];b<_.length;b+=1){var S=_[b];S.timeout&&clearTimeout(S.timeout),this.onRemove(S.value)}return this.data={},this.order=[],this},Zt.prototype.add=function(y,b,_){var S=this,P=y.wrapped().key;this.data[P]===void 0&&(this.data[P]=[]);var F={value:b,timeout:void 0};if(_!==void 0&&(F.timeout=setTimeout(function(){S.remove(y,F)},_)),this.data[P].push(F),this.order.push(P),this.order.length>this.max){var N=this._getAndRemoveByKey(this.order[0]);N&&this.onRemove(N)}return this},Zt.prototype.has=function(y){return y.wrapped().key in this.data},Zt.prototype.getAndRemove=function(y){return this.has(y)?this._getAndRemoveByKey(y.wrapped().key):null},Zt.prototype._getAndRemoveByKey=function(y){var b=this.data[y].shift();return b.timeout&&clearTimeout(b.timeout),this.data[y].length===0&&delete this.data[y],this.order.splice(this.order.indexOf(y),1),b.value},Zt.prototype.getByKey=function(y){var b=this.data[y];return b?b[0].value:null},Zt.prototype.get=function(y){return this.has(y)?this.data[y.wrapped().key][0].value:null},Zt.prototype.remove=function(y,b){if(!this.has(y))return this;var _=y.wrapped().key,S=b===void 0?0:this.data[_].indexOf(b),P=this.data[_][S];return this.data[_].splice(S,1),P.timeout&&clearTimeout(P.timeout),this.data[_].length===0&&delete this.data[_],this.onRemove(P.value),this.order.splice(this.order.indexOf(_),1),this},Zt.prototype.setMaxSize=function(y){for(this.max=y;this.order.length>this.max;){var b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this},Zt.prototype.filter=function(y){var b=[];for(var _ in this.data)for(var S=0,P=this.data[_];S<P.length;S+=1){var F=P[S];y(F.value)||b.push(F)}for(var N=0,V=b;N<V.length;N+=1){var J=V[N];this.remove(J.value.tileID,J)}};var nn=function(y,b,_){this.context=y;var S=y.gl;this.buffer=S.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),y.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};nn.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},nn.prototype.updateData=function(y){var b=this.context.gl;this.context.unbindVAO(),this.bind(),b.bufferSubData(b.ELEMENT_ARRAY_BUFFER,0,y.arrayBuffer)},nn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var mn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},zt=function(y,b,_,S){this.length=b.length,this.attributes=_,this.itemSize=b.bytesPerElement,this.dynamicDraw=S,this.context=y;var P=y.gl;this.buffer=P.createBuffer(),y.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};zt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},zt.prototype.updateData=function(y){var b=this.context.gl;this.bind(),b.bufferSubData(b.ARRAY_BUFFER,0,y.arrayBuffer)},zt.prototype.enableAttributes=function(y,b){for(var _=0;_<this.attributes.length;_++){var S=b.attributes[this.attributes[_].name];S!==void 0&&y.enableVertexAttribArray(S)}},zt.prototype.setVertexAttribPointers=function(y,b,_){for(var S=0;S<this.attributes.length;S++){var P=this.attributes[S],F=b.attributes[P.name];F!==void 0&&y.vertexAttribPointer(F,P.components,y[mn[P.type]],!1,this.itemSize,P.offset+this.itemSize*(_||0))}},zt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Vr=function(y){this.gl=y.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Vr.prototype.get=function(){return this.current},Vr.prototype.set=function(y){},Vr.prototype.getDefault=function(){return this.default},Vr.prototype.setDefault=function(){this.set(this.default)};var On=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return o.Color.transparent},b.prototype.set=function(_){var S=this.current;(_.r!==S.r||_.g!==S.g||_.b!==S.b||_.a!==S.a||this.dirty)&&(this.gl.clearColor(_.r,_.g,_.b,_.a),this.current=_,this.dirty=!1)},b}(Vr),Si=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 1},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.clearDepth(_),this.current=_,this.dirty=!1)},b}(Vr),Fn=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 0},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.clearStencil(_),this.current=_,this.dirty=!1)},b}(Vr),Ai=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return[!0,!0,!0,!0]},b.prototype.set=function(_){var S=this.current;(_[0]!==S[0]||_[1]!==S[1]||_[2]!==S[2]||_[3]!==S[3]||this.dirty)&&(this.gl.colorMask(_[0],_[1],_[2],_[3]),this.current=_,this.dirty=!1)},b}(Vr),Ua=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!0},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.depthMask(_),this.current=_,this.dirty=!1)},b}(Vr),va=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 255},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.stencilMask(_),this.current=_,this.dirty=!1)},b}(Vr),Va=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},b.prototype.set=function(_){var S=this.current;(_.func!==S.func||_.ref!==S.ref||_.mask!==S.mask||this.dirty)&&(this.gl.stencilFunc(_.func,_.ref,_.mask),this.current=_,this.dirty=!1)},b}(Vr),to=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){var _=this.gl;return[_.KEEP,_.KEEP,_.KEEP]},b.prototype.set=function(_){var S=this.current;(_[0]!==S[0]||_[1]!==S[1]||_[2]!==S[2]||this.dirty)&&(this.gl.stencilOp(_[0],_[1],_[2]),this.current=_,this.dirty=!1)},b}(Vr),Os=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;_?S.enable(S.STENCIL_TEST):S.disable(S.STENCIL_TEST),this.current=_,this.dirty=!1}},b}(Vr),Ro=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return[0,1]},b.prototype.set=function(_){var S=this.current;(_[0]!==S[0]||_[1]!==S[1]||this.dirty)&&(this.gl.depthRange(_[0],_[1]),this.current=_,this.dirty=!1)},b}(Vr),ne=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;_?S.enable(S.DEPTH_TEST):S.disable(S.DEPTH_TEST),this.current=_,this.dirty=!1}},b}(Vr),Qt=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.LESS},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.depthFunc(_),this.current=_,this.dirty=!1)},b}(Vr),gr=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;_?S.enable(S.BLEND):S.disable(S.BLEND),this.current=_,this.dirty=!1}},b}(Vr),hn=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){var _=this.gl;return[_.ONE,_.ZERO]},b.prototype.set=function(_){var S=this.current;(_[0]!==S[0]||_[1]!==S[1]||this.dirty)&&(this.gl.blendFunc(_[0],_[1]),this.current=_,this.dirty=!1)},b}(Vr),$n=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return o.Color.transparent},b.prototype.set=function(_){var S=this.current;(_.r!==S.r||_.g!==S.g||_.b!==S.b||_.a!==S.a||this.dirty)&&(this.gl.blendColor(_.r,_.g,_.b,_.a),this.current=_,this.dirty=!1)},b}(Vr),Ta=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.FUNC_ADD},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.blendEquation(_),this.current=_,this.dirty=!1)},b}(Vr),Qn=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;_?S.enable(S.CULL_FACE):S.disable(S.CULL_FACE),this.current=_,this.dirty=!1}},b}(Vr),ci=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.BACK},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.cullFace(_),this.current=_,this.dirty=!1)},b}(Vr),Wn=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.CCW},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.frontFace(_),this.current=_,this.dirty=!1)},b}(Vr),Ti=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)},b}(Vr),Li=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.TEXTURE0},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.activeTexture(_),this.current=_,this.dirty=!1)},b}(Vr),Oo=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){var _=this.gl;return[0,0,_.drawingBufferWidth,_.drawingBufferHeight]},b.prototype.set=function(_){var S=this.current;(_[0]!==S[0]||_[1]!==S[1]||_[2]!==S[2]||_[3]!==S[3]||this.dirty)&&(this.gl.viewport(_[0],_[1],_[2],_[3]),this.current=_,this.dirty=!1)},b}(Vr),Fo=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;S.bindFramebuffer(S.FRAMEBUFFER,_),this.current=_,this.dirty=!1}},b}(Vr),xl=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;S.bindRenderbuffer(S.RENDERBUFFER,_),this.current=_,this.dirty=!1}},b}(Vr),Fc=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;S.bindTexture(S.TEXTURE_2D,_),this.current=_,this.dirty=!1}},b}(Vr),gf=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;S.bindBuffer(S.ARRAY_BUFFER,_),this.current=_,this.dirty=!1}},b}(Vr),Gl=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){var S=this.gl;S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,_),this.current=_,this.dirty=!1},b}(Vr),iu=function(y){function b(_){y.call(this,_),this.vao=_.extVertexArrayObject}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){this.vao&&(_!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(_),this.current=_,this.dirty=!1)},b}(Vr),bl=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 4},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;S.pixelStorei(S.UNPACK_ALIGNMENT,_),this.current=_,this.dirty=!1}},b}(Vr),Dc=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;S.pixelStorei(S.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_),this.current=_,this.dirty=!1}},b}(Vr),mf=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var S=this.gl;S.pixelStorei(S.UNPACK_FLIP_Y_WEBGL,_),this.current=_,this.dirty=!1}},b}(Vr),fo=function(y){function b(_,S){y.call(this,_),this.context=_,this.parent=S}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b}(Vr),ae=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.setDirty=function(){this.dirty=!0},b.prototype.set=function(_){if(_!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var S=this.gl;S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_2D,_,0),this.current=_,this.dirty=!1}},b}(fo),ue=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.set=function(_){if(_!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var S=this.gl;S.framebufferRenderbuffer(S.FRAMEBUFFER,S.DEPTH_ATTACHMENT,S.RENDERBUFFER,_),this.current=_,this.dirty=!1}},b}(fo),fe=function(y,b,_,S){this.context=y,this.width=b,this.height=_;var P=this.framebuffer=y.gl.createFramebuffer();this.colorAttachment=new ae(y,P),S&&(this.depthAttachment=new ue(y,P))};fe.prototype.destroy=function(){var y=this.context.gl,b=this.colorAttachment.get();if(b&&y.deleteTexture(b),this.depthAttachment){var _=this.depthAttachment.get();_&&y.deleteRenderbuffer(_)}y.deleteFramebuffer(this.framebuffer)};var Ce=function(y,b,_){this.func=y,this.mask=b,this.range=_};Ce.ReadOnly=!1,Ce.ReadWrite=!0,Ce.disabled=new Ce(519,Ce.ReadOnly,[0,1]);var Ne=function(y,b,_,S,P,F){this.test=y,this.ref=b,this.mask=_,this.fail=S,this.depthFail=P,this.pass=F};Ne.disabled=new Ne({func:519,mask:0},0,0,7680,7680,7680);var it=function(y,b,_){this.blendFunction=y,this.blendColor=b,this.mask=_};it.disabled=new it(it.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),it.unblended=new it(it.Replace,o.Color.transparent,[!0,!0,!0,!0]),it.alphaBlended=new it([1,771],o.Color.transparent,[!0,!0,!0,!0]);var pt=function(y,b,_){this.enable=y,this.mode=b,this.frontFace=_};pt.disabled=new pt(!1,1029,2305),pt.backCCW=new pt(!0,1029,2305);var _e=function(y){this.gl=y,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new On(this),this.clearDepth=new Si(this),this.clearStencil=new Fn(this),this.colorMask=new Ai(this),this.depthMask=new Ua(this),this.stencilMask=new va(this),this.stencilFunc=new Va(this),this.stencilOp=new to(this),this.stencilTest=new Os(this),this.depthRange=new Ro(this),this.depthTest=new ne(this),this.depthFunc=new Qt(this),this.blend=new gr(this),this.blendFunc=new hn(this),this.blendColor=new $n(this),this.blendEquation=new Ta(this),this.cullFace=new Qn(this),this.cullFaceSide=new ci(this),this.frontFace=new Wn(this),this.program=new Ti(this),this.activeTexture=new Li(this),this.viewport=new Oo(this),this.bindFramebuffer=new Fo(this),this.bindRenderbuffer=new xl(this),this.bindTexture=new Fc(this),this.bindVertexBuffer=new gf(this),this.bindElementBuffer=new Gl(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new iu(this),this.pixelStoreUnpack=new bl(this),this.pixelStoreUnpackPremultiplyAlpha=new Dc(this),this.pixelStoreUnpackFlipY=new mf(this),this.extTextureFilterAnisotropic=y.getExtension("EXT_texture_filter_anisotropic")||y.getExtension("MOZ_EXT_texture_filter_anisotropic")||y.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=y.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=y.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(y.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=y.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=y.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=y.getParameter(y.MAX_TEXTURE_SIZE)};_e.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},_e.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},_e.prototype.createIndexBuffer=function(y,b){return new nn(this,y,b)},_e.prototype.createVertexBuffer=function(y,b,_){return new zt(this,y,b,_)},_e.prototype.createRenderbuffer=function(y,b,_){var S=this.gl,P=S.createRenderbuffer();return this.bindRenderbuffer.set(P),S.renderbufferStorage(S.RENDERBUFFER,y,b,_),this.bindRenderbuffer.set(null),P},_e.prototype.createFramebuffer=function(y,b,_){return new fe(this,y,b,_)},_e.prototype.clear=function(y){var b=y.color,_=y.depth,S=this.gl,P=0;b&&(P|=S.COLOR_BUFFER_BIT,this.clearColor.set(b),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(P|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),S.clear(P)},_e.prototype.setCullFace=function(y){y.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(y.mode),this.frontFace.set(y.frontFace))},_e.prototype.setDepthMode=function(y){y.func!==this.gl.ALWAYS||y.mask?(this.depthTest.set(!0),this.depthFunc.set(y.func),this.depthMask.set(y.mask),this.depthRange.set(y.range)):this.depthTest.set(!1)},_e.prototype.setStencilMode=function(y){y.test.func!==this.gl.ALWAYS||y.mask?(this.stencilTest.set(!0),this.stencilMask.set(y.mask),this.stencilOp.set([y.fail,y.depthFail,y.pass]),this.stencilFunc.set({func:y.test.func,ref:y.ref,mask:y.test.mask})):this.stencilTest.set(!1)},_e.prototype.setColorMode=function(y){o.deepEqual(y.blendFunction,it.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(y.blendFunction),this.blendColor.set(y.blendColor)),this.colorMask.set(y.mask)},_e.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ge=function(y){function b(_,S,P){var F=this;y.call(this),this.id=_,this.dispatcher=P,this.on("data",function(N){N.dataType==="source"&&N.sourceDataType==="metadata"&&(F._sourceLoaded=!0),F._sourceLoaded&&!F._paused&&N.dataType==="source"&&N.sourceDataType==="content"&&(F.reload(),F.transform&&F.update(F.transform))}),this.on("error",function(){F._sourceErrored=!0}),this._source=function(N,V,J,se){var de=new Lt[V.type](N,V,J,se);if(de.id!==N)throw new Error("Expected Source id to be "+N+" instead of "+de.id);return o.bindAll(["load","abort","unload","serialize","prepare"],de),de}(_,S,P,this),this._tiles={},this._cache=new Zt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.onAdd=function(_){this.map=_,this._maxTileCacheSize=_?_._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(_)},b.prototype.onRemove=function(_){this._source&&this._source.onRemove&&this._source.onRemove(_)},b.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var _ in this._tiles){var S=this._tiles[_];if(S.state!=="loaded"&&S.state!=="errored")return!1}return!0},b.prototype.getSource=function(){return this._source},b.prototype.pause=function(){this._paused=!0},b.prototype.resume=function(){if(this._paused){var _=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,_&&this.reload(),this.transform&&this.update(this.transform)}},b.prototype._loadTile=function(_,S){return this._source.loadTile(_,S)},b.prototype._unloadTile=function(_){if(this._source.unloadTile)return this._source.unloadTile(_,function(){})},b.prototype._abortTile=function(_){if(this._source.abortTile)return this._source.abortTile(_,function(){})},b.prototype.serialize=function(){return this._source.serialize()},b.prototype.prepare=function(_){for(var S in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var P=this._tiles[S];P.upload(_),P.prepare(this.map.style.imageManager)}},b.prototype.getIds=function(){return o.values(this._tiles).map(function(_){return _.tileID}).sort(wt).map(function(_){return _.key})},b.prototype.getRenderableIds=function(_){var S=this,P=[];for(var F in this._tiles)this._isIdRenderable(F,_)&&P.push(this._tiles[F]);return _?P.sort(function(N,V){var J=N.tileID,se=V.tileID,de=new o.Point(J.canonical.x,J.canonical.y)._rotate(S.transform.angle),xe=new o.Point(se.canonical.x,se.canonical.y)._rotate(S.transform.angle);return J.overscaledZ-se.overscaledZ||xe.y-de.y||xe.x-de.x}).map(function(N){return N.tileID.key}):P.map(function(N){return N.tileID}).sort(wt).map(function(N){return N.key})},b.prototype.hasRenderableParent=function(_){var S=this.findLoadedParent(_,0);return!!S&&this._isIdRenderable(S.tileID.key)},b.prototype._isIdRenderable=function(_,S){return this._tiles[_]&&this._tiles[_].hasData()&&!this._coveredTiles[_]&&(S||!this._tiles[_].holdingForFade())},b.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var _ in this._cache.reset(),this._tiles)this._tiles[_].state!=="errored"&&this._reloadTile(_,"reloading")},b.prototype._reloadTile=function(_,S){var P=this._tiles[_];P&&(P.state!=="loading"&&(P.state=S),this._loadTile(P,this._tileLoaded.bind(this,P,_,S)))},b.prototype._tileLoaded=function(_,S,P,F){if(F)return _.state="errored",void(F.status!==404?this._source.fire(new o.ErrorEvent(F,{tile:_})):this.update(this.transform));_.timeAdded=o.browser.now(),P==="expired"&&(_.refreshedUponExpiration=!0),this._setTileReloadTimer(S,_),this.getSource().type==="raster-dem"&&_.dem&&this._backfillDEM(_),this._state.initializeTileState(_,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:_,coord:_.tileID}))},b.prototype._backfillDEM=function(_){for(var S=this.getRenderableIds(),P=0;P<S.length;P++){var F=S[P];if(_.neighboringTiles&&_.neighboringTiles[F]){var N=this.getTileByID(F);V(_,N),V(N,_)}}function V(J,se){J.needsHillshadePrepare=!0;var de=se.tileID.canonical.x-J.tileID.canonical.x,xe=se.tileID.canonical.y-J.tileID.canonical.y,Ee=Math.pow(2,J.tileID.canonical.z),Ue=se.tileID.key;de===0&&xe===0||Math.abs(xe)>1||(Math.abs(de)>1&&(Math.abs(de+Ee)===1?de+=Ee:Math.abs(de-Ee)===1&&(de-=Ee)),se.dem&&J.dem&&(J.dem.backfillBorder(se.dem,de,xe),J.neighboringTiles&&J.neighboringTiles[Ue]&&(J.neighboringTiles[Ue].backfilled=!0)))}},b.prototype.getTile=function(_){return this.getTileByID(_.key)},b.prototype.getTileByID=function(_){return this._tiles[_]},b.prototype._retainLoadedChildren=function(_,S,P,F){for(var N in this._tiles){var V=this._tiles[N];if(!(F[N]||!V.hasData()||V.tileID.overscaledZ<=S||V.tileID.overscaledZ>P)){for(var J=V.tileID;V&&V.tileID.overscaledZ>S+1;){var se=V.tileID.scaledTo(V.tileID.overscaledZ-1);(V=this._tiles[se.key])&&V.hasData()&&(J=se)}for(var de=J;de.overscaledZ>S;)if(_[(de=de.scaledTo(de.overscaledZ-1)).key]){F[J.key]=J;break}}}},b.prototype.findLoadedParent=function(_,S){if(_.key in this._loadedParentTiles){var P=this._loadedParentTiles[_.key];return P&&P.tileID.overscaledZ>=S?P:null}for(var F=_.overscaledZ-1;F>=S;F--){var N=_.scaledTo(F),V=this._getLoadedTile(N);if(V)return V}},b.prototype._getLoadedTile=function(_){var S=this._tiles[_.key];return S&&S.hasData()?S:this._cache.getByKey(_.wrapped().key)},b.prototype.updateCacheSize=function(_){var S=Math.ceil(_.width/this._source.tileSize)+1,P=Math.ceil(_.height/this._source.tileSize)+1,F=Math.floor(S*P*5),N=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,F):F;this._cache.setMaxSize(N)},b.prototype.handleWrapJump=function(_){var S=Math.round((_-(this._prevLng===void 0?_:this._prevLng))/360);if(this._prevLng=_,S){var P={};for(var F in this._tiles){var N=this._tiles[F];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+S),P[N.tileID.key]=N}for(var V in this._tiles=P,this._timers)clearTimeout(this._timers[V]),delete this._timers[V];for(var J in this._tiles)this._setTileReloadTimer(J,this._tiles[J])}},b.prototype.update=function(_){var S=this;if(this.transform=_,this._sourceLoaded&&!this._paused){var P;this.updateCacheSize(_),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?P=_.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(hr){return new o.OverscaledTileID(hr.canonical.z,hr.wrap,hr.canonical.z,hr.canonical.x,hr.canonical.y)}):(P=_.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(P=P.filter(function(hr){return S._source.hasTile(hr)}))):P=[];var F=_.coveringZoomLevel(this._source),N=Math.max(F-b.maxOverzooming,this._source.minzoom),V=Math.max(F+b.maxUnderzooming,this._source.minzoom),J=this._updateRetainedTiles(P,F);if(cr(this._source.type)){for(var se={},de={},xe=0,Ee=Object.keys(J);xe<Ee.length;xe+=1){var Ue=Ee[xe],Be=J[Ue],Ke=this._tiles[Ue];if(Ke&&!(Ke.fadeEndTime&&Ke.fadeEndTime<=o.browser.now())){var Oe=this.findLoadedParent(Be,N);Oe&&(this._addTile(Oe.tileID),se[Oe.tileID.key]=Oe.tileID),de[Ue]=Be}}for(var Qe in this._retainLoadedChildren(de,F,V,J),se)J[Qe]||(this._coveredTiles[Qe]=!0,J[Qe]=se[Qe])}for(var ft in J)this._tiles[ft].clearFadeHold();for(var xt=0,Ut=o.keysDifference(this._tiles,J);xt<Ut.length;xt+=1){var Bt=Ut[xt],Wt=this._tiles[Bt];Wt.hasSymbolBuckets&&!Wt.holdingForFade()?Wt.setHoldDuration(this.map._fadeDuration):Wt.hasSymbolBuckets&&!Wt.symbolFadeFinished()||this._removeTile(Bt)}this._updateLoadedParentTileCache()}},b.prototype.releaseSymbolFadeTiles=function(){for(var _ in this._tiles)this._tiles[_].holdingForFade()&&this._removeTile(_)},b.prototype._updateRetainedTiles=function(_,S){for(var P={},F={},N=Math.max(S-b.maxOverzooming,this._source.minzoom),V=Math.max(S+b.maxUnderzooming,this._source.minzoom),J={},se=0,de=_;se<de.length;se+=1){var xe=de[se],Ee=this._addTile(xe);P[xe.key]=xe,Ee.hasData()||S<this._source.maxzoom&&(J[xe.key]=xe)}this._retainLoadedChildren(J,S,V,P);for(var Ue=0,Be=_;Ue<Be.length;Ue+=1){var Ke=Be[Ue],Oe=this._tiles[Ke.key];if(!Oe.hasData()){if(S+1>this._source.maxzoom){var Qe=Ke.children(this._source.maxzoom)[0],ft=this.getTile(Qe);if(ft&&ft.hasData()){P[Qe.key]=Qe;continue}}else{var xt=Ke.children(this._source.maxzoom);if(P[xt[0].key]&&P[xt[1].key]&&P[xt[2].key]&&P[xt[3].key])continue}for(var Ut=Oe.wasRequested(),Bt=Ke.overscaledZ-1;Bt>=N;--Bt){var Wt=Ke.scaledTo(Bt);if(F[Wt.key]||(F[Wt.key]=!0,!(Oe=this.getTile(Wt))&&Ut&&(Oe=this._addTile(Wt)),Oe&&(P[Wt.key]=Wt,Ut=Oe.wasRequested(),Oe.hasData())))break}}}return P},b.prototype._updateLoadedParentTileCache=function(){for(var _ in this._loadedParentTiles={},this._tiles){for(var S=[],P=void 0,F=this._tiles[_].tileID;F.overscaledZ>0;){if(F.key in this._loadedParentTiles){P=this._loadedParentTiles[F.key];break}S.push(F.key);var N=F.scaledTo(F.overscaledZ-1);if(P=this._getLoadedTile(N))break;F=N}for(var V=0,J=S;V<J.length;V+=1)this._loadedParentTiles[J[V]]=P}},b.prototype._addTile=function(_){var S=this._tiles[_.key];if(S)return S;(S=this._cache.getAndRemove(_))&&(this._setTileReloadTimer(_.key,S),S.tileID=_,this._state.initializeTileState(S,this.map?this.map.painter:null),this._cacheTimers[_.key]&&(clearTimeout(this._cacheTimers[_.key]),delete this._cacheTimers[_.key],this._setTileReloadTimer(_.key,S)));var P=Boolean(S);return P||(S=new o.Tile(_,this._source.tileSize*_.overscaleFactor()),this._loadTile(S,this._tileLoaded.bind(this,S,_.key,S.state))),S?(S.uses++,this._tiles[_.key]=S,P||this._source.fire(new o.Event("dataloading",{tile:S,coord:S.tileID,dataType:"source"})),S):null},b.prototype._setTileReloadTimer=function(_,S){var P=this;_ in this._timers&&(clearTimeout(this._timers[_]),delete this._timers[_]);var F=S.getExpiryTimeout();F&&(this._timers[_]=setTimeout(function(){P._reloadTile(_,"expired"),delete P._timers[_]},F))},b.prototype._removeTile=function(_){var S=this._tiles[_];S&&(S.uses--,delete this._tiles[_],this._timers[_]&&(clearTimeout(this._timers[_]),delete this._timers[_]),S.uses>0||(S.hasData()&&S.state!=="reloading"?this._cache.add(S.tileID,S,S.getExpiryTimeout()):(S.aborted=!0,this._abortTile(S),this._unloadTile(S))))},b.prototype.clearTiles=function(){for(var _ in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(_);this._cache.reset()},b.prototype.tilesIn=function(_,S,P){var F=this,N=[],V=this.transform;if(!V)return N;for(var J=P?V.getCameraQueryGeometry(_):_,se=_.map(function(Bt){return V.pointCoordinate(Bt)}),de=J.map(function(Bt){return V.pointCoordinate(Bt)}),xe=this.getIds(),Ee=1/0,Ue=1/0,Be=-1/0,Ke=-1/0,Oe=0,Qe=de;Oe<Qe.length;Oe+=1){var ft=Qe[Oe];Ee=Math.min(Ee,ft.x),Ue=Math.min(Ue,ft.y),Be=Math.max(Be,ft.x),Ke=Math.max(Ke,ft.y)}for(var xt=function(Bt){var Wt=F._tiles[xe[Bt]];if(!Wt.holdingForFade()){var hr=Wt.tileID,yr=Math.pow(2,V.zoom-Wt.tileID.overscaledZ),Ir=S*Wt.queryPadding*o.EXTENT/Wt.tileSize/yr,Kr=[hr.getTilePoint(new o.MercatorCoordinate(Ee,Ue)),hr.getTilePoint(new o.MercatorCoordinate(Be,Ke))];if(Kr[0].x-Ir<o.EXTENT&&Kr[0].y-Ir<o.EXTENT&&Kr[1].x+Ir>=0&&Kr[1].y+Ir>=0){var An=se.map(function(Dn){return hr.getTilePoint(Dn)}),Nn=de.map(function(Dn){return hr.getTilePoint(Dn)});N.push({tile:Wt,tileID:hr,queryGeometry:An,cameraQueryGeometry:Nn,scale:yr})}}},Ut=0;Ut<xe.length;Ut++)xt(Ut);return N},b.prototype.getVisibleCoordinates=function(_){for(var S=this,P=this.getRenderableIds(_).map(function(J){return S._tiles[J].tileID}),F=0,N=P;F<N.length;F+=1){var V=N[F];V.posMatrix=this.transform.calculatePosMatrix(V.toUnwrapped())}return P},b.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(cr(this._source.type))for(var _ in this._tiles){var S=this._tiles[_];if(S.fadeEndTime!==void 0&&S.fadeEndTime>=o.browser.now())return!0}return!1},b.prototype.setFeatureState=function(_,S,P){this._state.updateState(_=_||"_geojsonTileLayer",S,P)},b.prototype.removeFeatureState=function(_,S,P){this._state.removeFeatureState(_=_||"_geojsonTileLayer",S,P)},b.prototype.getFeatureState=function(_,S){return this._state.getState(_=_||"_geojsonTileLayer",S)},b.prototype.setDependencies=function(_,S,P){var F=this._tiles[_];F&&F.setDependencies(S,P)},b.prototype.reloadTilesForDependencies=function(_,S){for(var P in this._tiles)this._tiles[P].hasDependency(_,S)&&this._reloadTile(P,"reloading");this._cache.filter(function(F){return!F.hasDependency(_,S)})},b}(o.Evented);function wt(y,b){var _=Math.abs(2*y.wrap)-+(y.wrap<0),S=Math.abs(2*b.wrap)-+(b.wrap<0);return y.overscaledZ-b.overscaledZ||S-_||b.canonical.y-y.canonical.y||b.canonical.x-y.canonical.x}function cr(y){return y==="raster"||y==="image"||y==="video"}function fr(){return new o.window.Worker(pc.workerUrl)}Ge.maxOverzooming=10,Ge.maxUnderzooming=3;var $t="mapboxgl_preloaded_worker_pool",pr=function(){this.active={}};pr.prototype.acquire=function(y){if(!this.workers)for(this.workers=[];this.workers.length<pr.workerCount;)this.workers.push(new fr);return this.active[y]=!0,this.workers.slice()},pr.prototype.release=function(y){delete this.active[y],this.numActive()===0&&(this.workers.forEach(function(b){b.terminate()}),this.workers=null)},pr.prototype.isPreloaded=function(){return!!this.active[$t]},pr.prototype.numActive=function(){return Object.keys(this.active).length};var Rr,cn=Math.floor(o.browser.hardwareConcurrency/2);function Ht(){return Rr||(Rr=new pr),Rr}function an(y,b){var _={};for(var S in y)S!=="ref"&&(_[S]=y[S]);return o.refProperties.forEach(function(P){P in b&&(_[P]=b[P])}),_}function Br(y){y=y.slice();for(var b=Object.create(null),_=0;_<y.length;_++)b[y[_].id]=y[_];for(var S=0;S<y.length;S++)"ref"in y[S]&&(y[S]=an(y[S],b[y[S].ref]));return y}pr.workerCount=Math.max(Math.min(cn,6),1);var $r={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ln(y,b,_){_.push({command:$r.addSource,args:[y,b[y]]})}function Tr(y,b,_){b.push({command:$r.removeSource,args:[y]}),_[y]=!0}function Sn(y,b,_,S){Tr(y,_,S),Ln(y,b,_)}function pi(y,b,_){var S;for(S in y[_])if(y[_].hasOwnProperty(S)&&S!=="data"&&!o.deepEqual(y[_][S],b[_][S]))return!1;for(S in b[_])if(b[_].hasOwnProperty(S)&&S!=="data"&&!o.deepEqual(y[_][S],b[_][S]))return!1;return!0}function oi(y,b,_,S,P,F){var N;for(N in b=b||{},y=y||{})y.hasOwnProperty(N)&&(o.deepEqual(y[N],b[N])||_.push({command:F,args:[S,N,b[N],P]}));for(N in b)b.hasOwnProperty(N)&&!y.hasOwnProperty(N)&&(o.deepEqual(y[N],b[N])||_.push({command:F,args:[S,N,b[N],P]}))}function Pi(y){return y.id}function Oi(y,b){return y[b.id]=b,y}var Gs=function(y,b){this.reset(y,b)};Gs.prototype.reset=function(y,b){this.points=y||[],this._distances=[0];for(var _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(b||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Gs.prototype.lerp=function(y){if(this.points.length===1)return this.points[0];y=o.clamp(y,0,1);for(var b=1,_=this._distances[b],S=y*this.paddedLength+this.padding;_<S&&b<this._distances.length;)_=this._distances[++b];var P=b-1,F=this._distances[P],N=_-F,V=N>0?(S-F)/N:0;return this.points[P].mult(1-V).add(this.points[b].mult(V))};var Qi=function(y,b,_){var S=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(y/_),this.yCellCount=Math.ceil(b/_);for(var F=0;F<this.xCellCount*this.yCellCount;F++)S.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=y,this.height=b,this.xScale=this.xCellCount/y,this.yScale=this.yCellCount/b,this.boxUid=0,this.circleUid=0};function Ki(y,b,_,S,P){var F=o.create();return b?(o.scale(F,F,[1/P,1/P,1]),_||o.rotateZ(F,F,S.angle)):o.multiply(F,S.labelPlaneMatrix,y),F}function oa(y,b,_,S,P){if(b){var F=o.clone(y);return o.scale(F,F,[P,P,1]),_||o.rotateZ(F,F,-S.angle),F}return S.glCoordMatrix}function bi(y,b){var _=[y.x,y.y,0,1];po(_,_,b);var S=_[3];return{point:new o.Point(_[0]/S,_[1]/S),signedDistanceFromCamera:S}}function Ni(y,b){return .5+y/b*.5}function Fs(y,b){var _=y[0]/y[3],S=y[1]/y[3];return _>=-b[0]&&_<=b[0]&&S>=-b[1]&&S<=b[1]}function Xu(y,b,_,S,P,F,N,V){var J=S?y.textSizeData:y.iconSizeData,se=o.evaluateSizeForZoom(J,_.transform.zoom),de=[256/_.width*2+1,256/_.height*2+1],xe=S?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;xe.clear();for(var Ee=y.lineVertexArray,Ue=S?y.text.placedSymbolArray:y.icon.placedSymbolArray,Be=_.transform.width/_.transform.height,Ke=!1,Oe=0;Oe<Ue.length;Oe++){var Qe=Ue.get(Oe);if(Qe.hidden||Qe.writingMode===o.WritingMode.vertical&&!Ke)Ds(Qe.numGlyphs,xe);else{Ke=!1;var ft=[Qe.anchorX,Qe.anchorY,0,1];if(o.transformMat4(ft,ft,b),Fs(ft,de)){var xt=Ni(_.transform.cameraToCenterDistance,ft[3]),Ut=o.evaluateSizeForFeature(J,se,Qe),Bt=N?Ut/xt:Ut*xt,Wt=new o.Point(Qe.anchorX,Qe.anchorY),hr=bi(Wt,P).point,yr={},Ir=bp(Qe,Bt,!1,V,b,P,F,y.glyphOffsetArray,Ee,xe,hr,Wt,yr,Be);Ke=Ir.useVertical,(Ir.notEnoughRoom||Ke||Ir.needsFlipping&&bp(Qe,Bt,!0,V,b,P,F,y.glyphOffsetArray,Ee,xe,hr,Wt,yr,Be).notEnoughRoom)&&Ds(Qe.numGlyphs,xe)}else Ds(Qe.numGlyphs,xe)}}S?y.text.dynamicLayoutVertexBuffer.updateData(xe):y.icon.dynamicLayoutVertexBuffer.updateData(xe)}function ho(y,b,_,S,P,F,N,V,J,se,de){var xe=V.glyphStartIndex+V.numGlyphs,Ee=V.lineStartIndex,Ue=V.lineStartIndex+V.lineLength,Be=b.getoffsetX(V.glyphStartIndex),Ke=b.getoffsetX(xe-1),Oe=ya(y*Be,_,S,P,F,N,V.segment,Ee,Ue,J,se,de);if(!Oe)return null;var Qe=ya(y*Ke,_,S,P,F,N,V.segment,Ee,Ue,J,se,de);return Qe?{first:Oe,last:Qe}:null}function au(y,b,_,S){return y===o.WritingMode.horizontal&&Math.abs(_.y-b.y)>Math.abs(_.x-b.x)*S?{useVertical:!0}:(y===o.WritingMode.vertical?b.y<_.y:b.x>_.x)?{needsFlipping:!0}:null}function bp(y,b,_,S,P,F,N,V,J,se,de,xe,Ee,Ue){var Be,Ke=b/24,Oe=y.lineOffsetX*Ke,Qe=y.lineOffsetY*Ke;if(y.numGlyphs>1){var ft=y.glyphStartIndex+y.numGlyphs,xt=y.lineStartIndex,Ut=y.lineStartIndex+y.lineLength,Bt=ho(Ke,V,Oe,Qe,_,de,xe,y,J,F,Ee);if(!Bt)return{notEnoughRoom:!0};var Wt=bi(Bt.first.point,N).point,hr=bi(Bt.last.point,N).point;if(S&&!_){var yr=au(y.writingMode,Wt,hr,Ue);if(yr)return yr}Be=[Bt.first];for(var Ir=y.glyphStartIndex+1;Ir<ft-1;Ir++)Be.push(ya(Ke*V.getoffsetX(Ir),Oe,Qe,_,de,xe,y.segment,xt,Ut,J,F,Ee));Be.push(Bt.last)}else{if(S&&!_){var Kr=bi(xe,P).point,An=y.lineStartIndex+y.segment+1,Nn=new o.Point(J.getx(An),J.gety(An)),Dn=bi(Nn,P),sa=Dn.signedDistanceFromCamera>0?Dn.point:Bc(xe,Nn,Kr,1,P),on=au(y.writingMode,Kr,sa,Ue);if(on)return on}var qn=ya(Ke*V.getoffsetX(y.glyphStartIndex),Oe,Qe,_,de,xe,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,J,F,Ee);if(!qn)return{notEnoughRoom:!0};Be=[qn]}for(var di=0,si=Be;di<si.length;di+=1){var Jn=si[di];o.addDynamicAttributes(se,Jn.point,Jn.angle)}return{}}function Bc(y,b,_,S,P){var F=bi(y.add(y.sub(b)._unit()),P).point,N=_.sub(F);return _.add(N._mult(S/N.mag()))}function ya(y,b,_,S,P,F,N,V,J,se,de,xe){var Ee=S?y-b:y+b,Ue=Ee>0?1:-1,Be=0;S&&(Ue*=-1,Be=Math.PI),Ue<0&&(Be+=Math.PI);for(var Ke=Ue>0?V+N:V+N+1,Oe=P,Qe=P,ft=0,xt=0,Ut=Math.abs(Ee),Bt=[];ft+xt<=Ut;){if((Ke+=Ue)<V||Ke>=J)return null;if(Qe=Oe,Bt.push(Oe),(Oe=xe[Ke])===void 0){var Wt=new o.Point(se.getx(Ke),se.gety(Ke)),hr=bi(Wt,de);if(hr.signedDistanceFromCamera>0)Oe=xe[Ke]=hr.point;else{var yr=Ke-Ue;Oe=Bc(ft===0?F:new o.Point(se.getx(yr),se.gety(yr)),Wt,Qe,Ut-ft+1,de)}}ft+=xt,xt=Qe.dist(Oe)}var Ir=(Ut-ft)/xt,Kr=Oe.sub(Qe),An=Kr.mult(Ir)._add(Qe);An._add(Kr._unit()._perp()._mult(_*Ue));var Nn=Be+Math.atan2(Oe.y-Qe.y,Oe.x-Qe.x);return Bt.push(An),{point:An,angle:Nn,path:Bt}}Qi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Qi.prototype.insert=function(y,b,_,S,P){this._forEachCell(b,_,S,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(y),this.bboxes.push(b),this.bboxes.push(_),this.bboxes.push(S),this.bboxes.push(P)},Qi.prototype.insertCircle=function(y,b,_,S){this._forEachCell(b-S,_-S,b+S,_+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(y),this.circles.push(b),this.circles.push(_),this.circles.push(S)},Qi.prototype._insertBoxCell=function(y,b,_,S,P,F){this.boxCells[P].push(F)},Qi.prototype._insertCircleCell=function(y,b,_,S,P,F){this.circleCells[P].push(F)},Qi.prototype._query=function(y,b,_,S,P,F){if(_<0||y>this.width||S<0||b>this.height)return!P&&[];var N=[];if(y<=0&&b<=0&&this.width<=_&&this.height<=S){if(P)return!0;for(var V=0;V<this.boxKeys.length;V++)N.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(var J=0;J<this.circleKeys.length;J++){var se=this.circles[3*J],de=this.circles[3*J+1],xe=this.circles[3*J+2];N.push({key:this.circleKeys[J],x1:se-xe,y1:de-xe,x2:se+xe,y2:de+xe})}return F?N.filter(F):N}return this._forEachCell(y,b,_,S,this._queryCell,N,{hitTest:P,seenUids:{box:{},circle:{}}},F),P?N.length>0:N},Qi.prototype._queryCircle=function(y,b,_,S,P){var F=y-_,N=y+_,V=b-_,J=b+_;if(N<0||F>this.width||J<0||V>this.height)return!S&&[];var se=[];return this._forEachCell(F,V,N,J,this._queryCellCircle,se,{hitTest:S,circle:{x:y,y:b,radius:_},seenUids:{box:{},circle:{}}},P),S?se.length>0:se},Qi.prototype.query=function(y,b,_,S,P){return this._query(y,b,_,S,!1,P)},Qi.prototype.hitTest=function(y,b,_,S,P){return this._query(y,b,_,S,!0,P)},Qi.prototype.hitTestCircle=function(y,b,_,S){return this._queryCircle(y,b,_,!0,S)},Qi.prototype._queryCell=function(y,b,_,S,P,F,N,V){var J=N.seenUids,se=this.boxCells[P];if(se!==null)for(var de=this.bboxes,xe=0,Ee=se;xe<Ee.length;xe+=1){var Ue=Ee[xe];if(!J.box[Ue]){J.box[Ue]=!0;var Be=4*Ue;if(y<=de[Be+2]&&b<=de[Be+3]&&_>=de[Be+0]&&S>=de[Be+1]&&(!V||V(this.boxKeys[Ue]))){if(N.hitTest)return F.push(!0),!0;F.push({key:this.boxKeys[Ue],x1:de[Be],y1:de[Be+1],x2:de[Be+2],y2:de[Be+3]})}}}var Ke=this.circleCells[P];if(Ke!==null)for(var Oe=this.circles,Qe=0,ft=Ke;Qe<ft.length;Qe+=1){var xt=ft[Qe];if(!J.circle[xt]){J.circle[xt]=!0;var Ut=3*xt;if(this._circleAndRectCollide(Oe[Ut],Oe[Ut+1],Oe[Ut+2],y,b,_,S)&&(!V||V(this.circleKeys[xt]))){if(N.hitTest)return F.push(!0),!0;var Bt=Oe[Ut],Wt=Oe[Ut+1],hr=Oe[Ut+2];F.push({key:this.circleKeys[xt],x1:Bt-hr,y1:Wt-hr,x2:Bt+hr,y2:Wt+hr})}}}},Qi.prototype._queryCellCircle=function(y,b,_,S,P,F,N,V){var J=N.circle,se=N.seenUids,de=this.boxCells[P];if(de!==null)for(var xe=this.bboxes,Ee=0,Ue=de;Ee<Ue.length;Ee+=1){var Be=Ue[Ee];if(!se.box[Be]){se.box[Be]=!0;var Ke=4*Be;if(this._circleAndRectCollide(J.x,J.y,J.radius,xe[Ke+0],xe[Ke+1],xe[Ke+2],xe[Ke+3])&&(!V||V(this.boxKeys[Be])))return F.push(!0),!0}}var Oe=this.circleCells[P];if(Oe!==null)for(var Qe=this.circles,ft=0,xt=Oe;ft<xt.length;ft+=1){var Ut=xt[ft];if(!se.circle[Ut]){se.circle[Ut]=!0;var Bt=3*Ut;if(this._circlesCollide(Qe[Bt],Qe[Bt+1],Qe[Bt+2],J.x,J.y,J.radius)&&(!V||V(this.circleKeys[Ut])))return F.push(!0),!0}}},Qi.prototype._forEachCell=function(y,b,_,S,P,F,N,V){for(var J=this._convertToXCellCoord(y),se=this._convertToYCellCoord(b),de=this._convertToXCellCoord(_),xe=this._convertToYCellCoord(S),Ee=J;Ee<=de;Ee++)for(var Ue=se;Ue<=xe;Ue++)if(P.call(this,y,b,_,S,this.xCellCount*Ue+Ee,F,N,V))return},Qi.prototype._convertToXCellCoord=function(y){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(y*this.xScale)))},Qi.prototype._convertToYCellCoord=function(y){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(y*this.yScale)))},Qi.prototype._circlesCollide=function(y,b,_,S,P,F){var N=S-y,V=P-b,J=_+F;return J*J>N*N+V*V},Qi.prototype._circleAndRectCollide=function(y,b,_,S,P,F,N){var V=(F-S)/2,J=Math.abs(y-(S+V));if(J>V+_)return!1;var se=(N-P)/2,de=Math.abs(b-(P+se));if(de>se+_)return!1;if(J<=V||de<=se)return!0;var xe=J-V,Ee=de-se;return xe*xe+Ee*Ee<=_*_};var yf=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ds(y,b){for(var _=0;_<y;_++){var S=b.length;b.resize(S+4),b.float32.set(yf,3*S)}}function po(y,b,_){var S=b[0],P=b[1];return y[0]=_[0]*S+_[4]*P+_[12],y[1]=_[1]*S+_[5]*P+_[13],y[3]=_[3]*S+_[7]*P+_[15],y}var _u=function(y,b,_){b===void 0&&(b=new Qi(y.width+200,y.height+200,25)),_===void 0&&(_=new Qi(y.width+200,y.height+200,25)),this.transform=y,this.grid=b,this.ignoredGrid=_,this.pitchfactor=Math.cos(y._pitch)*y.cameraToCenterDistance,this.screenRightBoundary=y.width+100,this.screenBottomBoundary=y.height+100,this.gridRightBoundary=y.width+200,this.gridBottomBoundary=y.height+200};function Za(y,b,_){return b*(o.EXTENT/(y.tileSize*Math.pow(2,_-y.tileID.overscaledZ)))}_u.prototype.placeCollisionBox=function(y,b,_,S,P){var F=this.projectAndGetPerspectiveRatio(S,y.anchorPointX,y.anchorPointY),N=_*F.perspectiveRatio,V=y.x1*N+F.point.x,J=y.y1*N+F.point.y,se=y.x2*N+F.point.x,de=y.y2*N+F.point.y;return!this.isInsideGrid(V,J,se,de)||!b&&this.grid.hitTest(V,J,se,de,P)?{box:[],offscreen:!1}:{box:[V,J,se,de],offscreen:this.isOffscreen(V,J,se,de)}},_u.prototype.placeCollisionCircles=function(y,b,_,S,P,F,N,V,J,se,de,xe,Ee){var Ue=[],Be=new o.Point(b.anchorX,b.anchorY),Ke=bi(Be,F),Oe=Ni(this.transform.cameraToCenterDistance,Ke.signedDistanceFromCamera),Qe=(se?P/Oe:P*Oe)/o.ONE_EM,ft=bi(Be,N).point,xt=ho(Qe,S,b.lineOffsetX*Qe,b.lineOffsetY*Qe,!1,ft,Be,b,_,N,{}),Ut=!1,Bt=!1,Wt=!0;if(xt){for(var hr=.5*xe*Oe+Ee,yr=new o.Point(-100,-100),Ir=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),Kr=new Gs,An=xt.first,Nn=xt.last,Dn=[],sa=An.path.length-1;sa>=1;sa--)Dn.push(An.path[sa]);for(var on=1;on<Nn.path.length;on++)Dn.push(Nn.path[on]);var qn=2.5*hr;if(V){var di=Dn.map(function(ql){return bi(ql,V)});Dn=di.some(function(ql){return ql.signedDistanceFromCamera<=0})?[]:di.map(function(ql){return ql.point})}var si=[];if(Dn.length>0){for(var Jn=Dn[0].clone(),wi=Dn[0].clone(),ri=1;ri<Dn.length;ri++)Jn.x=Math.min(Jn.x,Dn[ri].x),Jn.y=Math.min(Jn.y,Dn[ri].y),wi.x=Math.max(wi.x,Dn[ri].x),wi.y=Math.max(wi.y,Dn[ri].y);si=Jn.x>=yr.x&&wi.x<=Ir.x&&Jn.y>=yr.y&&wi.y<=Ir.y?[Dn]:wi.x<yr.x||Jn.x>Ir.x||wi.y<yr.y||Jn.y>Ir.y?[]:o.clipLine([Dn],yr.x,yr.y,Ir.x,Ir.y)}for(var Tn=0,Zo=si;Tn<Zo.length;Tn+=1){var No;Kr.reset(Zo[Tn],.25*hr),No=Kr.length<=.5*hr?1:Math.ceil(Kr.paddedLength/qn)+1;for(var Mo=0;Mo<No;Mo++){var Ss=Mo/Math.max(No-1,1),vo=Kr.lerp(Ss),no=vo.x+100,Du=vo.y+100;Ue.push(no,Du,hr,0);var Ha=no-hr,Xc=Du-hr,tl=no+hr,dc=Du+hr;if(Wt=Wt&&this.isOffscreen(Ha,Xc,tl,dc),Bt=Bt||this.isInsideGrid(Ha,Xc,tl,dc),!y&&this.grid.hitTestCircle(no,Du,hr,de)&&(Ut=!0,!J))return{circles:[],offscreen:!1,collisionDetected:Ut}}}}return{circles:!J&&Ut||!Bt?[]:Ue,offscreen:Wt,collisionDetected:Ut}},_u.prototype.queryRenderedSymbols=function(y){if(y.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var b=[],_=1/0,S=1/0,P=-1/0,F=-1/0,N=0,V=y;N<V.length;N+=1){var J=V[N],se=new o.Point(J.x+100,J.y+100);_=Math.min(_,se.x),S=Math.min(S,se.y),P=Math.max(P,se.x),F=Math.max(F,se.y),b.push(se)}for(var de={},xe={},Ee=0,Ue=this.grid.query(_,S,P,F).concat(this.ignoredGrid.query(_,S,P,F));Ee<Ue.length;Ee+=1){var Be=Ue[Ee],Ke=Be.key;if(de[Ke.bucketInstanceId]===void 0&&(de[Ke.bucketInstanceId]={}),!de[Ke.bucketInstanceId][Ke.featureIndex]){var Oe=[new o.Point(Be.x1,Be.y1),new o.Point(Be.x2,Be.y1),new o.Point(Be.x2,Be.y2),new o.Point(Be.x1,Be.y2)];o.polygonIntersectsPolygon(b,Oe)&&(de[Ke.bucketInstanceId][Ke.featureIndex]=!0,xe[Ke.bucketInstanceId]===void 0&&(xe[Ke.bucketInstanceId]=[]),xe[Ke.bucketInstanceId].push(Ke.featureIndex))}}return xe},_u.prototype.insertCollisionBox=function(y,b,_,S,P){(b?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:S,collisionGroupID:P},y[0],y[1],y[2],y[3])},_u.prototype.insertCollisionCircles=function(y,b,_,S,P){for(var F=b?this.ignoredGrid:this.grid,N={bucketInstanceId:_,featureIndex:S,collisionGroupID:P},V=0;V<y.length;V+=4)F.insertCircle(N,y[V],y[V+1],y[V+2])},_u.prototype.projectAndGetPerspectiveRatio=function(y,b,_){var S=[b,_,0,1];return po(S,S,y),{point:new o.Point((S[0]/S[3]+1)/2*this.transform.width+100,(-S[1]/S[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/S[3]*.5}},_u.prototype.isOffscreen=function(y,b,_,S){return _<100||y>=this.screenRightBoundary||S<100||b>this.screenBottomBoundary},_u.prototype.isInsideGrid=function(y,b,_,S){return _>=0&&y<this.gridRightBoundary&&S>=0&&b<this.gridBottomBoundary},_u.prototype.getViewportMatrix=function(){var y=o.identity([]);return o.translate(y,y,[-100,-100,0]),y};var Pu=function(y,b,_,S){this.opacity=y?Math.max(0,Math.min(1,y.opacity+(y.placed?b:-b))):S&&_?1:0,this.placed=_};Pu.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var bo=function(y,b,_,S,P){this.text=new Pu(y?y.text:null,b,_,P),this.icon=new Pu(y?y.icon:null,b,S,P)};bo.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var yh=function(y,b,_){this.text=y,this.icon=b,this.skipFade=_},Yu=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},_h=function(y,b,_,S,P){this.bucketInstanceId=y,this.featureIndex=b,this.sourceLayerIndex=_,this.bucketIndex=S,this.tileID=P},wl=function(y){this.crossSourceCollisions=y,this.maxGroupID=0,this.collisionGroups={}};function ws(y,b,_,S,P){var F=o.getAnchorAlignment(y),N=-(F.horizontalAlign-.5)*b,V=-(F.verticalAlign-.5)*_,J=o.evaluateVariableOffset(y,S);return new o.Point(N+J[0]*P,V+J[1]*P)}function Ru(y,b,_,S,P,F){var N=y.x1,V=y.x2,J=y.y1,se=y.y2,de=y.anchorPointX,xe=y.anchorPointY,Ee=new o.Point(b,_);return S&&Ee._rotate(P?F:-F),{x1:N+Ee.x,y1:J+Ee.y,x2:V+Ee.x,y2:se+Ee.y,anchorPointX:de,anchorPointY:xe}}wl.prototype.get=function(y){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[y]){var b=++this.maxGroupID;this.collisionGroups[y]={ID:b,predicate:function(_){return _.collisionGroupID===b}}}return this.collisionGroups[y]};var he=function(y,b,_,S){this.transform=y.clone(),this.collisionIndex=new _u(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new wl(_),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}};function Te(y,b,_,S,P){y.emplaceBack(b?1:0,_?1:0,S||0,P||0),y.emplaceBack(b?1:0,_?1:0,S||0,P||0),y.emplaceBack(b?1:0,_?1:0,S||0,P||0),y.emplaceBack(b?1:0,_?1:0,S||0,P||0)}he.prototype.getBucketParts=function(y,b,_,S){var P=_.getBucket(b),F=_.latestFeatureIndex;if(P&&F&&b.id===P.layerIds[0]){var N=_.collisionBoxArray,V=P.layers[0].layout,J=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),se=_.tileSize/o.EXTENT,de=this.transform.calculatePosMatrix(_.tileID.toUnwrapped()),xe=V.get("text-pitch-alignment")==="map",Ee=V.get("text-rotation-alignment")==="map",Ue=Za(_,1,this.transform.zoom),Be=Ki(de,xe,Ee,this.transform,Ue),Ke=null;if(xe){var Oe=oa(de,xe,Ee,this.transform,Ue);Ke=o.multiply([],this.transform.labelPlaneMatrix,Oe)}this.retainedQueryData[P.bucketInstanceId]=new _h(P.bucketInstanceId,F,P.sourceLayerIndex,P.index,_.tileID);var Qe={bucket:P,layout:V,posMatrix:de,textLabelPlaneMatrix:Be,labelToScreenMatrix:Ke,scale:J,textPixelRatio:se,holdingForFade:_.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(S)for(var ft=0,xt=P.sortKeyRanges;ft<xt.length;ft+=1){var Ut=xt[ft];y.push({sortKey:Ut.sortKey,symbolInstanceStart:Ut.symbolInstanceStart,symbolInstanceEnd:Ut.symbolInstanceEnd,parameters:Qe})}else y.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:Qe})}},he.prototype.attemptAnchorPlacement=function(y,b,_,S,P,F,N,V,J,se,de,xe,Ee,Ue,Be){var Ke,Oe=[xe.textOffset0,xe.textOffset1],Qe=ws(y,_,S,Oe,P),ft=this.collisionIndex.placeCollisionBox(Ru(b,Qe.x,Qe.y,F,N,this.transform.angle),de,V,J,se.predicate);if(!Be||this.collisionIndex.placeCollisionBox(Ru(Be,Qe.x,Qe.y,F,N,this.transform.angle),de,V,J,se.predicate).box.length!==0)return ft.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[xe.crossTileID]&&this.prevPlacement.placements[xe.crossTileID]&&this.prevPlacement.placements[xe.crossTileID].text&&(Ke=this.prevPlacement.variableOffsets[xe.crossTileID].anchor),this.variableOffsets[xe.crossTileID]={textOffset:Oe,width:_,height:S,anchor:y,textBoxScale:P,prevAnchor:Ke},this.markUsedJustification(Ee,y,xe,Ue),Ee.allowVerticalPlacement&&(this.markUsedOrientation(Ee,Ue,xe),this.placedOrientations[xe.crossTileID]=Ue),{shift:Qe,placedGlyphBoxes:ft}):void 0},he.prototype.placeLayerBucketPart=function(y,b,_){var S=this,P=y.parameters,F=P.bucket,N=P.layout,V=P.posMatrix,J=P.textLabelPlaneMatrix,se=P.labelToScreenMatrix,de=P.textPixelRatio,xe=P.holdingForFade,Ee=P.collisionBoxArray,Ue=P.partiallyEvaluatedTextSize,Be=P.collisionGroup,Ke=N.get("text-optional"),Oe=N.get("icon-optional"),Qe=N.get("text-allow-overlap"),ft=N.get("icon-allow-overlap"),xt=N.get("text-rotation-alignment")==="map",Ut=N.get("text-pitch-alignment")==="map",Bt=N.get("icon-text-fit")!=="none",Wt=N.get("symbol-z-order")==="viewport-y",hr=Qe&&(ft||!F.hasIconData()||Oe),yr=ft&&(Qe||!F.hasTextData()||Ke);!F.collisionArrays&&Ee&&F.deserializeCollisionBoxes(Ee);var Ir=function(on,qn){if(!b[on.crossTileID])if(xe)S.placements[on.crossTileID]=new yh(!1,!1,!1);else{var di,si=!1,Jn=!1,wi=!0,ri=null,Tn={box:null,offscreen:null},Zo={box:null,offscreen:null},No=null,Mo=null,Ss=0,vo=0,no=0;qn.textFeatureIndex?Ss=qn.textFeatureIndex:on.useRuntimeCollisionCircles&&(Ss=on.featureIndex),qn.verticalTextFeatureIndex&&(vo=qn.verticalTextFeatureIndex);var Du=qn.textBox;if(Du){var Ha=function(ma){var hl=o.WritingMode.horizontal;if(F.allowVerticalPlacement&&!ma&&S.prevPlacement){var Zs=S.prevPlacement.placedOrientations[on.crossTileID];Zs&&(S.placedOrientations[on.crossTileID]=Zs,S.markUsedOrientation(F,hl=Zs,on))}return hl},Xc=function(ma,hl){if(F.allowVerticalPlacement&&on.numVerticalGlyphVertices>0&&qn.verticalTextBox)for(var Zs=0,Af=F.writingModes;Zs<Af.length&&(Af[Zs]===o.WritingMode.vertical?(Tn=hl(),Zo=Tn):Tn=ma(),!(Tn&&Tn.box&&Tn.box.length));Zs+=1);else Tn=ma()};if(N.get("text-variable-anchor")){var tl=N.get("text-variable-anchor");if(S.prevPlacement&&S.prevPlacement.variableOffsets[on.crossTileID]){var dc=S.prevPlacement.variableOffsets[on.crossTileID];tl.indexOf(dc.anchor)>0&&(tl=tl.filter(function(ma){return ma!==dc.anchor})).unshift(dc.anchor)}var ql=function(ma,hl,Zs){for(var Af=ma.x2-ma.x1,pg=ma.y2-ma.y1,kl=on.textBoxScale,vd=Bt&&!ft?hl:null,vc={box:[],offscreen:!1},Fp=Qe?2*tl.length:tl.length,Jl=0;Jl<Fp;++Jl){var Tf=S.attemptAnchorPlacement(tl[Jl%tl.length],ma,Af,pg,kl,xt,Ut,de,V,Be,Jl>=tl.length,on,F,Zs,vd);if(Tf&&(vc=Tf.placedGlyphBoxes)&&vc.box&&vc.box.length){si=!0,ri=Tf.shift;break}}return vc};Xc(function(){return ql(Du,qn.iconBox,o.WritingMode.horizontal)},function(){var ma=qn.verticalTextBox;return F.allowVerticalPlacement&&!(Tn&&Tn.box&&Tn.box.length)&&on.numVerticalGlyphVertices>0&&ma?ql(ma,qn.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Tn&&(si=Tn.box,wi=Tn.offscreen);var qf=Ha(Tn&&Tn.box);if(!si&&S.prevPlacement){var Rp=S.prevPlacement.variableOffsets[on.crossTileID];Rp&&(S.variableOffsets[on.crossTileID]=Rp,S.markUsedJustification(F,Rp.anchor,on,qf))}}else{var Kl=function(ma,hl){var Zs=S.collisionIndex.placeCollisionBox(ma,Qe,de,V,Be.predicate);return Zs&&Zs.box&&Zs.box.length&&(S.markUsedOrientation(F,hl,on),S.placedOrientations[on.crossTileID]=hl),Zs};Xc(function(){return Kl(Du,o.WritingMode.horizontal)},function(){var ma=qn.verticalTextBox;return F.allowVerticalPlacement&&on.numVerticalGlyphVertices>0&&ma?Kl(ma,o.WritingMode.vertical):{box:null,offscreen:null}}),Ha(Tn&&Tn.box&&Tn.box.length)}}if(si=(di=Tn)&&di.box&&di.box.length>0,wi=di&&di.offscreen,on.useRuntimeCollisionCircles){var Kf=F.text.placedSymbolArray.get(on.centerJustifiedTextSymbolIndex),Op=o.evaluateSizeForFeature(F.textSizeData,Ue,Kf),Yc=N.get("text-padding");No=S.collisionIndex.placeCollisionCircles(Qe,Kf,F.lineVertexArray,F.glyphOffsetArray,Op,V,J,se,_,Ut,Be.predicate,on.collisionCircleDiameter,Yc),si=Qe||No.circles.length>0&&!No.collisionDetected,wi=wi&&No.offscreen}if(qn.iconFeatureIndex&&(no=qn.iconFeatureIndex),qn.iconBox){var Zc=function(ma){var hl=Bt&&ri?Ru(ma,ri.x,ri.y,xt,Ut,S.transform.angle):ma;return S.collisionIndex.placeCollisionBox(hl,ft,de,V,Be.predicate)};Jn=Zo&&Zo.box&&Zo.box.length&&qn.verticalIconBox?(Mo=Zc(qn.verticalIconBox)).box.length>0:(Mo=Zc(qn.iconBox)).box.length>0,wi=wi&&Mo.offscreen}var qc=Ke||on.numHorizontalGlyphVertices===0&&on.numVerticalGlyphVertices===0,Ns=Oe||on.numIconVertices===0;if(qc||Ns?Ns?qc||(Jn=Jn&&si):si=Jn&&si:Jn=si=Jn&&si,si&&di&&di.box&&S.collisionIndex.insertCollisionBox(di.box,N.get("text-ignore-placement"),F.bucketInstanceId,Zo&&Zo.box&&vo?vo:Ss,Be.ID),Jn&&Mo&&S.collisionIndex.insertCollisionBox(Mo.box,N.get("icon-ignore-placement"),F.bucketInstanceId,no,Be.ID),No&&(si&&S.collisionIndex.insertCollisionCircles(No.circles,N.get("text-ignore-placement"),F.bucketInstanceId,Ss,Be.ID),_)){var Ql=F.bucketInstanceId,Sf=S.collisionCircleArrays[Ql];Sf===void 0&&(Sf=S.collisionCircleArrays[Ql]=new Yu);for(var zh=0;zh<No.circles.length;zh+=4)Sf.circles.push(No.circles[zh+0]),Sf.circles.push(No.circles[zh+1]),Sf.circles.push(No.circles[zh+2]),Sf.circles.push(No.collisionDetected?1:0)}S.placements[on.crossTileID]=new yh(si||hr,Jn||yr,wi||F.justReloaded),b[on.crossTileID]=!0}};if(Wt)for(var Kr=F.getSortedSymbolIndexes(this.transform.angle),An=Kr.length-1;An>=0;--An){var Nn=Kr[An];Ir(F.symbolInstances.get(Nn),F.collisionArrays[Nn])}else for(var Dn=y.symbolInstanceStart;Dn<y.symbolInstanceEnd;Dn++)Ir(F.symbolInstances.get(Dn),F.collisionArrays[Dn]);if(_&&F.bucketInstanceId in this.collisionCircleArrays){var sa=this.collisionCircleArrays[F.bucketInstanceId];o.invert(sa.invProjMatrix,V),sa.viewportMatrix=this.collisionIndex.getViewportMatrix()}F.justReloaded=!1},he.prototype.markUsedJustification=function(y,b,_,S){var P;P=S===o.WritingMode.vertical?_.verticalPlacedTextSymbolIndex:{left:_.leftJustifiedTextSymbolIndex,center:_.centerJustifiedTextSymbolIndex,right:_.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(b)];for(var F=0,N=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex,_.verticalPlacedTextSymbolIndex];F<N.length;F+=1){var V=N[F];V>=0&&(y.text.placedSymbolArray.get(V).crossTileID=P>=0&&V!==P?0:_.crossTileID)}},he.prototype.markUsedOrientation=function(y,b,_){for(var S=b===o.WritingMode.horizontal||b===o.WritingMode.horizontalOnly?b:0,P=b===o.WritingMode.vertical?b:0,F=0,N=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex];F<N.length;F+=1)y.text.placedSymbolArray.get(N[F]).placedOrientation=S;_.verticalPlacedTextSymbolIndex&&(y.text.placedSymbolArray.get(_.verticalPlacedTextSymbolIndex).placedOrientation=P)},he.prototype.commit=function(y){this.commitTime=y,this.zoomAtLastRecencyCheck=this.transform.zoom;var b=this.prevPlacement,_=!1;this.prevZoomAdjustment=b?b.zoomAdjustment(this.transform.zoom):0;var S=b?b.symbolFadeChange(y):1,P=b?b.opacities:{},F=b?b.variableOffsets:{},N=b?b.placedOrientations:{};for(var V in this.placements){var J=this.placements[V],se=P[V];se?(this.opacities[V]=new bo(se,S,J.text,J.icon),_=_||J.text!==se.text.placed||J.icon!==se.icon.placed):(this.opacities[V]=new bo(null,S,J.text,J.icon,J.skipFade),_=_||J.text||J.icon)}for(var de in P){var xe=P[de];if(!this.opacities[de]){var Ee=new bo(xe,S,!1,!1);Ee.isHidden()||(this.opacities[de]=Ee,_=_||xe.text.placed||xe.icon.placed)}}for(var Ue in F)this.variableOffsets[Ue]||!this.opacities[Ue]||this.opacities[Ue].isHidden()||(this.variableOffsets[Ue]=F[Ue]);for(var Be in N)this.placedOrientations[Be]||!this.opacities[Be]||this.opacities[Be].isHidden()||(this.placedOrientations[Be]=N[Be]);_?this.lastPlacementChangeTime=y:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=b?b.lastPlacementChangeTime:y)},he.prototype.updateLayerOpacities=function(y,b){for(var _={},S=0,P=b;S<P.length;S+=1){var F=P[S],N=F.getBucket(y);N&&F.latestFeatureIndex&&y.id===N.layerIds[0]&&this.updateBucketOpacities(N,_,F.collisionBoxArray)}},he.prototype.updateBucketOpacities=function(y,b,_){var S=this;y.hasTextData()&&y.text.opacityVertexArray.clear(),y.hasIconData()&&y.icon.opacityVertexArray.clear(),y.hasIconCollisionBoxData()&&y.iconCollisionBox.collisionVertexArray.clear(),y.hasTextCollisionBoxData()&&y.textCollisionBox.collisionVertexArray.clear();var P=y.layers[0].layout,F=new bo(null,0,!1,!1,!0),N=P.get("text-allow-overlap"),V=P.get("icon-allow-overlap"),J=P.get("text-variable-anchor"),se=P.get("text-rotation-alignment")==="map",de=P.get("text-pitch-alignment")==="map",xe=P.get("icon-text-fit")!=="none",Ee=new bo(null,0,N&&(V||!y.hasIconData()||P.get("icon-optional")),V&&(N||!y.hasTextData()||P.get("text-optional")),!0);!y.collisionArrays&&_&&(y.hasIconCollisionBoxData()||y.hasTextCollisionBoxData())&&y.deserializeCollisionBoxes(_);for(var Ue=function(Qe,ft,xt){for(var Ut=0;Ut<ft/4;Ut++)Qe.opacityVertexArray.emplaceBack(xt)},Be=function(Qe){var ft=y.symbolInstances.get(Qe),xt=ft.numHorizontalGlyphVertices,Ut=ft.numVerticalGlyphVertices,Bt=ft.crossTileID,Wt=S.opacities[Bt];b[Bt]?Wt=F:Wt||(S.opacities[Bt]=Wt=Ee),b[Bt]=!0;var hr=ft.numIconVertices>0,yr=S.placedOrientations[ft.crossTileID],Ir=yr===o.WritingMode.vertical,Kr=yr===o.WritingMode.horizontal||yr===o.WritingMode.horizontalOnly;if(xt>0||Ut>0){var An=xu(Wt.text);Ue(y.text,xt,Ir?js:An),Ue(y.text,Ut,Kr?js:An);var Nn=Wt.text.isHidden();[ft.rightJustifiedTextSymbolIndex,ft.centerJustifiedTextSymbolIndex,ft.leftJustifiedTextSymbolIndex].forEach(function(Tn){Tn>=0&&(y.text.placedSymbolArray.get(Tn).hidden=Nn||Ir?1:0)}),ft.verticalPlacedTextSymbolIndex>=0&&(y.text.placedSymbolArray.get(ft.verticalPlacedTextSymbolIndex).hidden=Nn||Kr?1:0);var Dn=S.variableOffsets[ft.crossTileID];Dn&&S.markUsedJustification(y,Dn.anchor,ft,yr);var sa=S.placedOrientations[ft.crossTileID];sa&&(S.markUsedJustification(y,"left",ft,sa),S.markUsedOrientation(y,sa,ft))}if(hr){var on=xu(Wt.icon),qn=!(xe&&ft.verticalPlacedIconSymbolIndex&&Ir);ft.placedIconSymbolIndex>=0&&(Ue(y.icon,ft.numIconVertices,qn?on:js),y.icon.placedSymbolArray.get(ft.placedIconSymbolIndex).hidden=Wt.icon.isHidden()),ft.verticalPlacedIconSymbolIndex>=0&&(Ue(y.icon,ft.numVerticalIconVertices,qn?js:on),y.icon.placedSymbolArray.get(ft.verticalPlacedIconSymbolIndex).hidden=Wt.icon.isHidden())}if(y.hasIconCollisionBoxData()||y.hasTextCollisionBoxData()){var di=y.collisionArrays[Qe];if(di){var si=new o.Point(0,0);if(di.textBox||di.verticalTextBox){var Jn=!0;if(J){var wi=S.variableOffsets[Bt];wi?(si=ws(wi.anchor,wi.width,wi.height,wi.textOffset,wi.textBoxScale),se&&si._rotate(de?S.transform.angle:-S.transform.angle)):Jn=!1}di.textBox&&Te(y.textCollisionBox.collisionVertexArray,Wt.text.placed,!Jn||Ir,si.x,si.y),di.verticalTextBox&&Te(y.textCollisionBox.collisionVertexArray,Wt.text.placed,!Jn||Kr,si.x,si.y)}var ri=Boolean(!Kr&&di.verticalIconBox);di.iconBox&&Te(y.iconCollisionBox.collisionVertexArray,Wt.icon.placed,ri,xe?si.x:0,xe?si.y:0),di.verticalIconBox&&Te(y.iconCollisionBox.collisionVertexArray,Wt.icon.placed,!ri,xe?si.x:0,xe?si.y:0)}}},Ke=0;Ke<y.symbolInstances.length;Ke++)Be(Ke);if(y.sortFeatures(this.transform.angle),this.retainedQueryData[y.bucketInstanceId]&&(this.retainedQueryData[y.bucketInstanceId].featureSortOrder=y.featureSortOrder),y.hasTextData()&&y.text.opacityVertexBuffer&&y.text.opacityVertexBuffer.updateData(y.text.opacityVertexArray),y.hasIconData()&&y.icon.opacityVertexBuffer&&y.icon.opacityVertexBuffer.updateData(y.icon.opacityVertexArray),y.hasIconCollisionBoxData()&&y.iconCollisionBox.collisionVertexBuffer&&y.iconCollisionBox.collisionVertexBuffer.updateData(y.iconCollisionBox.collisionVertexArray),y.hasTextCollisionBoxData()&&y.textCollisionBox.collisionVertexBuffer&&y.textCollisionBox.collisionVertexBuffer.updateData(y.textCollisionBox.collisionVertexArray),y.bucketInstanceId in this.collisionCircleArrays){var Oe=this.collisionCircleArrays[y.bucketInstanceId];y.placementInvProjMatrix=Oe.invProjMatrix,y.placementViewportMatrix=Oe.viewportMatrix,y.collisionCircleArray=Oe.circles,delete this.collisionCircleArrays[y.bucketInstanceId]}},he.prototype.symbolFadeChange=function(y){return this.fadeDuration===0?1:(y-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},he.prototype.zoomAdjustment=function(y){return Math.max(0,(this.transform.zoom-y)/1.5)},he.prototype.hasTransitions=function(y){return this.stale||y-this.lastPlacementChangeTime<this.fadeDuration},he.prototype.stillRecent=function(y,b){var _=this.zoomAtLastRecencyCheck===b?1-this.zoomAdjustment(b):1;return this.zoomAtLastRecencyCheck=b,this.commitTime+this.fadeDuration*_>y},he.prototype.setStale=function(){this.stale=!0};var et=Math.pow(2,25),jt=Math.pow(2,24),Or=Math.pow(2,17),Bn=Math.pow(2,16),Ji=Math.pow(2,9),Bs=Math.pow(2,8),Hs=Math.pow(2,1);function xu(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;var b=y.placed?1:0,_=Math.floor(127*y.opacity);return _*et+b*jt+_*Or+b*Bn+_*Ji+b*Bs+_*Hs+b}var js=0,dm=function(y){this._sortAcrossTiles=y.layout.get("symbol-z-order")!=="viewport-y"&&y.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};dm.prototype.continuePlacement=function(y,b,_,S,P){for(var F=this._bucketParts;this._currentTileIndex<y.length;)if(b.getBucketParts(F,S,y[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort(function(N,V){return N.sortKey-V.sortKey}));this._currentPartIndex<F.length;)if(b.placeLayerBucketPart(F[this._currentPartIndex],this._seenCrossTileIDs,_),this._currentPartIndex++,P())return!0;return!1};var nv=function(y,b,_,S,P,F,N){this.placement=new he(y,P,F,N),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=S,this._done=!1};nv.prototype.isDone=function(){return this._done},nv.prototype.continuePlacement=function(y,b,_){for(var S=this,P=o.browser.now(),F=function(){var J=o.browser.now()-P;return!S._forceFullPlacement&&J>2};this._currentPlacementIndex>=0;){var N=b[y[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=V)&&(!N.maxzoom||N.maxzoom>V)){if(this._inProgressLayer||(this._inProgressLayer=new dm(N)),this._inProgressLayer.continuePlacement(_[N.source],this.placement,this._showCollisionBoxes,N,F))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},nv.prototype.commit=function(y){return this.placement.commit(y),this.placement};var zy=512/o.EXTENT/2,ng=function(y,b,_){this.tileID=y,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(var S=0;S<b.length;S++){var P=b.get(S),F=P.key;this.indexedSymbolInstances[F]||(this.indexedSymbolInstances[F]=[]),this.indexedSymbolInstances[F].push({crossTileID:P.crossTileID,coord:this.getScaledCoordinates(P,y)})}};ng.prototype.getScaledCoordinates=function(y,b){var _=zy/Math.pow(2,b.canonical.z-this.tileID.canonical.z);return{x:Math.floor((b.canonical.x*o.EXTENT+y.anchorX)*_),y:Math.floor((b.canonical.y*o.EXTENT+y.anchorY)*_)}},ng.prototype.findMatches=function(y,b,_){for(var S=this.tileID.canonical.z<b.canonical.z?1:Math.pow(2,this.tileID.canonical.z-b.canonical.z),P=0;P<y.length;P++){var F=y.get(P);if(!F.crossTileID){var N=this.indexedSymbolInstances[F.key];if(N)for(var V=this.getScaledCoordinates(F,b),J=0,se=N;J<se.length;J+=1){var de=se[J];if(Math.abs(de.coord.x-V.x)<=S&&Math.abs(de.coord.y-V.y)<=S&&!_[de.crossTileID]){_[de.crossTileID]=!0,F.crossTileID=de.crossTileID;break}}}}};var Cl=function(){this.maxCrossTileID=0};Cl.prototype.generate=function(){return++this.maxCrossTileID};var xh=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};xh.prototype.handleWrapJump=function(y){var b=Math.round((y-this.lng)/360);if(b!==0)for(var _ in this.indexes){var S=this.indexes[_],P={};for(var F in S){var N=S[F];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+b),P[N.tileID.key]=N}this.indexes[_]=P}this.lng=y},xh.prototype.addBucket=function(y,b,_){if(this.indexes[y.overscaledZ]&&this.indexes[y.overscaledZ][y.key]){if(this.indexes[y.overscaledZ][y.key].bucketInstanceId===b.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(y.overscaledZ,this.indexes[y.overscaledZ][y.key])}for(var S=0;S<b.symbolInstances.length;S++)b.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[y.overscaledZ]||(this.usedCrossTileIDs[y.overscaledZ]={});var P=this.usedCrossTileIDs[y.overscaledZ];for(var F in this.indexes){var N=this.indexes[F];if(Number(F)>y.overscaledZ)for(var V in N){var J=N[V];J.tileID.isChildOf(y)&&J.findMatches(b.symbolInstances,y,P)}else{var se=N[y.scaledTo(Number(F)).key];se&&se.findMatches(b.symbolInstances,y,P)}}for(var de=0;de<b.symbolInstances.length;de++){var xe=b.symbolInstances.get(de);xe.crossTileID||(xe.crossTileID=_.generate(),P[xe.crossTileID]=!0)}return this.indexes[y.overscaledZ]===void 0&&(this.indexes[y.overscaledZ]={}),this.indexes[y.overscaledZ][y.key]=new ng(y,b.symbolInstances,b.bucketInstanceId),!0},xh.prototype.removeBucketCrossTileIDs=function(y,b){for(var _ in b.indexedSymbolInstances)for(var S=0,P=b.indexedSymbolInstances[_];S<P.length;S+=1)delete this.usedCrossTileIDs[y][P[S].crossTileID]},xh.prototype.removeStaleBuckets=function(y){var b=!1;for(var _ in this.indexes){var S=this.indexes[_];for(var P in S)y[S[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,S[P]),delete S[P],b=!0)}return b};var bh=function(){this.layerIndexes={},this.crossTileIDs=new Cl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};bh.prototype.addLayer=function(y,b,_){var S=this.layerIndexes[y.id];S===void 0&&(S=this.layerIndexes[y.id]=new xh);var P=!1,F={};S.handleWrapJump(_);for(var N=0,V=b;N<V.length;N+=1){var J=V[N],se=J.getBucket(y);se&&y.id===se.layerIds[0]&&(se.bucketInstanceId||(se.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(J.tileID,se,this.crossTileIDs)&&(P=!0),F[se.bucketInstanceId]=!0)}return S.removeStaleBuckets(F)&&(P=!0),P},bh.prototype.pruneUnusedLayers=function(y){var b={};for(var _ in y.forEach(function(S){b[S]=!0}),this.layerIndexes)b[_]||delete this.layerIndexes[_]};var wp=function(y,b){return o.emitValidationErrors(y,b&&b.filter(function(_){return _.identifier!=="source.canvas"}))},El=o.pick($r,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),wh=o.pick($r,["setCenter","setZoom","setBearing","setPitch"]),wo=function(){var y={},b=o.styleSpec.$version;for(var _ in o.styleSpec.$root){var S,P=o.styleSpec.$root[_];P.required&&(S=_==="version"?b:P.type==="array"?[]:{})!=null&&(y[_]=S)}return y}(),ea=function(y){function b(_,S){var P=this;S===void 0&&(S={}),y.call(this),this.map=_,this.dispatcher=new ie(Ht(),this),this.imageManager=new L,this.imageManager.setEventedParent(this),this.glyphManager=new ee(_._requestManager,S.localIdeographFontFamily),this.lineAtlas=new te(256,512),this.crossTileSymbolIndex=new bh,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var F=this;this._rtlTextPluginCallback=b.registerForPluginStateChange(function(N){F.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:N.pluginStatus,pluginURL:N.pluginURL},function(V,J){if(o.triggerPluginCompletionEvent(V),J&&J.every(function(de){return de}))for(var se in F.sourceCaches)F.sourceCaches[se].reload()})}),this.on("data",function(N){if(N.dataType==="source"&&N.sourceDataType==="metadata"){var V=P.sourceCaches[N.sourceId];if(V){var J=V.getSource();if(J&&J.vectorLayerIds)for(var se in P._layers){var de=P._layers[se];de.source===J.id&&P._validateLayer(de)}}}})}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.loadURL=function(_,S){var P=this;S===void 0&&(S={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var F=typeof S.validate=="boolean"?S.validate:!o.isMapboxURL(_);_=this.map._requestManager.normalizeStyleURL(_,S.accessToken);var N=this.map._requestManager.transformRequest(_,o.ResourceType.Style);this._request=o.getJSON(N,function(V,J){P._request=null,V?P.fire(new o.ErrorEvent(V)):J&&P._load(J,F)})},b.prototype.loadJSON=function(_,S){var P=this;S===void 0&&(S={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){P._request=null,P._load(_,S.validate!==!1)})},b.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(wo,!1)},b.prototype._load=function(_,S){if(!S||!wp(this,o.validateStyle(_))){for(var P in this._loaded=!0,this.stylesheet=_,_.sources)this.addSource(P,_.sources[P],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs);var F=Br(this.stylesheet.layers);this._order=F.map(function(se){return se.id}),this._layers={},this._serializedLayers={};for(var N=0,V=F;N<V.length;N+=1){var J=V[N];(J=o.createStyleLayer(J)).setEventedParent(this,{layer:{id:J.id}}),this._layers[J.id]=J,this._serializedLayers[J.id]=J.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Q(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},b.prototype._loadSprite=function(_){var S=this;this._spriteRequest=function(P,F,N){var V,J,se,de=o.browser.devicePixelRatio>1?"@2x":"",xe=o.getJSON(F.transformRequest(F.normalizeSpriteURL(P,de,".json"),o.ResourceType.SpriteJSON),function(Be,Ke){xe=null,se||(se=Be,V=Ke,Ue())}),Ee=o.getImage(F.transformRequest(F.normalizeSpriteURL(P,de,".png"),o.ResourceType.SpriteImage),function(Be,Ke){Ee=null,se||(se=Be,J=Ke,Ue())});function Ue(){if(se)N(se);else if(V&&J){var Be=o.browser.getImageData(J),Ke={};for(var Oe in V){var Qe=V[Oe],ft=Qe.width,xt=Qe.height,Ut=Qe.x,Bt=Qe.y,Wt=Qe.sdf,hr=Qe.pixelRatio,yr=Qe.stretchX,Ir=Qe.stretchY,Kr=Qe.content,An=new o.RGBAImage({width:ft,height:xt});o.RGBAImage.copy(Be,An,{x:Ut,y:Bt},{x:0,y:0},{width:ft,height:xt}),Ke[Oe]={data:An,pixelRatio:hr,sdf:Wt,stretchX:yr,stretchY:Ir,content:Kr}}N(null,Ke)}}return{cancel:function(){xe&&(xe.cancel(),xe=null),Ee&&(Ee.cancel(),Ee=null)}}}(_,this.map._requestManager,function(P,F){if(S._spriteRequest=null,P)S.fire(new o.ErrorEvent(P));else if(F)for(var N in F)S.imageManager.addImage(N,F[N]);S.imageManager.setLoaded(!0),S._availableImages=S.imageManager.listImages(),S.dispatcher.broadcast("setImages",S._availableImages),S.fire(new o.Event("data",{dataType:"style"}))})},b.prototype._validateLayer=function(_){var S=this.sourceCaches[_.source];if(S){var P=_.sourceLayer;if(P){var F=S.getSource();(F.type==="geojson"||F.vectorLayerIds&&F.vectorLayerIds.indexOf(P)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+P+'" does not exist on source "'+F.id+'" as specified by style layer "'+_.id+'"')))}}},b.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var _ in this.sourceCaches)if(!this.sourceCaches[_].loaded())return!1;return!!this.imageManager.isLoaded()},b.prototype._serializeLayers=function(_){for(var S=[],P=0,F=_;P<F.length;P+=1){var N=this._layers[F[P]];N.type!=="custom"&&S.push(N.serialize())}return S},b.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var _ in this.sourceCaches)if(this.sourceCaches[_].hasTransition())return!0;for(var S in this._layers)if(this._layers[S].hasTransition())return!0;return!1},b.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},b.prototype.update=function(_){if(this._loaded){var S=this._changed;if(this._changed){var P=Object.keys(this._updatedLayers),F=Object.keys(this._removedLayers);for(var N in(P.length||F.length)&&this._updateWorkerLayers(P,F),this._updatedSources){var V=this._updatedSources[N];V==="reload"?this._reloadSource(N):V==="clear"&&this._clearSource(N)}for(var J in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[J].updateTransitions(_);this.light.updateTransitions(_),this._resetUpdates()}var se={};for(var de in this.sourceCaches){var xe=this.sourceCaches[de];se[de]=xe.used,xe.used=!1}for(var Ee=0,Ue=this._order;Ee<Ue.length;Ee+=1){var Be=this._layers[Ue[Ee]];Be.recalculate(_,this._availableImages),!Be.isHidden(_.zoom)&&Be.source&&(this.sourceCaches[Be.source].used=!0)}for(var Ke in se){var Oe=this.sourceCaches[Ke];se[Ke]!==Oe.used&&Oe.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Ke}))}this.light.recalculate(_),this.z=_.zoom,S&&this.fire(new o.Event("data",{dataType:"style"}))}},b.prototype._updateTilesForChangedImages=function(){var _=Object.keys(this._changedImages);if(_.length){for(var S in this.sourceCaches)this.sourceCaches[S].reloadTilesForDependencies(["icons","patterns"],_);this._changedImages={}}},b.prototype._updateWorkerLayers=function(_,S){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(_),removedIds:S})},b.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},b.prototype.setState=function(_){var S=this;if(this._checkLoaded(),wp(this,o.validateStyle(_)))return!1;(_=o.clone$1(_)).layers=Br(_.layers);var P=function(N,V){if(!N)return[{command:$r.setStyle,args:[V]}];var J=[];try{if(!o.deepEqual(N.version,V.version))return[{command:$r.setStyle,args:[V]}];o.deepEqual(N.center,V.center)||J.push({command:$r.setCenter,args:[V.center]}),o.deepEqual(N.zoom,V.zoom)||J.push({command:$r.setZoom,args:[V.zoom]}),o.deepEqual(N.bearing,V.bearing)||J.push({command:$r.setBearing,args:[V.bearing]}),o.deepEqual(N.pitch,V.pitch)||J.push({command:$r.setPitch,args:[V.pitch]}),o.deepEqual(N.sprite,V.sprite)||J.push({command:$r.setSprite,args:[V.sprite]}),o.deepEqual(N.glyphs,V.glyphs)||J.push({command:$r.setGlyphs,args:[V.glyphs]}),o.deepEqual(N.transition,V.transition)||J.push({command:$r.setTransition,args:[V.transition]}),o.deepEqual(N.light,V.light)||J.push({command:$r.setLight,args:[V.light]});var se={},de=[];(function(Ee,Ue,Be,Ke){var Oe;for(Oe in Ue=Ue||{},Ee=Ee||{})Ee.hasOwnProperty(Oe)&&(Ue.hasOwnProperty(Oe)||Tr(Oe,Be,Ke));for(Oe in Ue)Ue.hasOwnProperty(Oe)&&(Ee.hasOwnProperty(Oe)?o.deepEqual(Ee[Oe],Ue[Oe])||(Ee[Oe].type==="geojson"&&Ue[Oe].type==="geojson"&&pi(Ee,Ue,Oe)?Be.push({command:$r.setGeoJSONSourceData,args:[Oe,Ue[Oe].data]}):Sn(Oe,Ue,Be,Ke)):Ln(Oe,Ue,Be))})(N.sources,V.sources,de,se);var xe=[];N.layers&&N.layers.forEach(function(Ee){se[Ee.source]?J.push({command:$r.removeLayer,args:[Ee.id]}):xe.push(Ee)}),J=J.concat(de),function(Ee,Ue,Be){Ue=Ue||[];var Ke,Oe,Qe,ft,xt,Ut,Bt,Wt=(Ee=Ee||[]).map(Pi),hr=Ue.map(Pi),yr=Ee.reduce(Oi,{}),Ir=Ue.reduce(Oi,{}),Kr=Wt.slice(),An=Object.create(null);for(Ke=0,Oe=0;Ke<Wt.length;Ke++)Ir.hasOwnProperty(Qe=Wt[Ke])?Oe++:(Be.push({command:$r.removeLayer,args:[Qe]}),Kr.splice(Kr.indexOf(Qe,Oe),1));for(Ke=0,Oe=0;Ke<hr.length;Ke++)Kr[Kr.length-1-Ke]!==(Qe=hr[hr.length-1-Ke])&&(yr.hasOwnProperty(Qe)?(Be.push({command:$r.removeLayer,args:[Qe]}),Kr.splice(Kr.lastIndexOf(Qe,Kr.length-Oe),1)):Oe++,Be.push({command:$r.addLayer,args:[Ir[Qe],Ut=Kr[Kr.length-Ke]]}),Kr.splice(Kr.length-Ke,0,Qe),An[Qe]=!0);for(Ke=0;Ke<hr.length;Ke++)if(ft=yr[Qe=hr[Ke]],xt=Ir[Qe],!An[Qe]&&!o.deepEqual(ft,xt))if(o.deepEqual(ft.source,xt.source)&&o.deepEqual(ft["source-layer"],xt["source-layer"])&&o.deepEqual(ft.type,xt.type)){for(Bt in oi(ft.layout,xt.layout,Be,Qe,null,$r.setLayoutProperty),oi(ft.paint,xt.paint,Be,Qe,null,$r.setPaintProperty),o.deepEqual(ft.filter,xt.filter)||Be.push({command:$r.setFilter,args:[Qe,xt.filter]}),o.deepEqual(ft.minzoom,xt.minzoom)&&o.deepEqual(ft.maxzoom,xt.maxzoom)||Be.push({command:$r.setLayerZoomRange,args:[Qe,xt.minzoom,xt.maxzoom]}),ft)ft.hasOwnProperty(Bt)&&Bt!=="layout"&&Bt!=="paint"&&Bt!=="filter"&&Bt!=="metadata"&&Bt!=="minzoom"&&Bt!=="maxzoom"&&(Bt.indexOf("paint.")===0?oi(ft[Bt],xt[Bt],Be,Qe,Bt.slice(6),$r.setPaintProperty):o.deepEqual(ft[Bt],xt[Bt])||Be.push({command:$r.setLayerProperty,args:[Qe,Bt,xt[Bt]]}));for(Bt in xt)xt.hasOwnProperty(Bt)&&!ft.hasOwnProperty(Bt)&&Bt!=="layout"&&Bt!=="paint"&&Bt!=="filter"&&Bt!=="metadata"&&Bt!=="minzoom"&&Bt!=="maxzoom"&&(Bt.indexOf("paint.")===0?oi(ft[Bt],xt[Bt],Be,Qe,Bt.slice(6),$r.setPaintProperty):o.deepEqual(ft[Bt],xt[Bt])||Be.push({command:$r.setLayerProperty,args:[Qe,Bt,xt[Bt]]}))}else Be.push({command:$r.removeLayer,args:[Qe]}),Ut=Kr[Kr.lastIndexOf(Qe)+1],Be.push({command:$r.addLayer,args:[xt,Ut]})}(xe,V.layers,J)}catch(Ee){console.warn("Unable to compute style diff:",Ee),J=[{command:$r.setStyle,args:[V]}]}return J}(this.serialize(),_).filter(function(N){return!(N.command in wh)});if(P.length===0)return!1;var F=P.filter(function(N){return!(N.command in El)});if(F.length>0)throw new Error("Unimplemented: "+F.map(function(N){return N.command}).join(", ")+".");return P.forEach(function(N){N.command!=="setTransition"&&S[N.command].apply(S,N.args)}),this.stylesheet=_,!0},b.prototype.addImage=function(_,S){if(this.getImage(_))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(_,S),this._afterImageUpdated(_)},b.prototype.updateImage=function(_,S){this.imageManager.updateImage(_,S)},b.prototype.getImage=function(_){return this.imageManager.getImage(_)},b.prototype.removeImage=function(_){if(!this.getImage(_))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(_),this._afterImageUpdated(_)},b.prototype._afterImageUpdated=function(_){this._availableImages=this.imageManager.listImages(),this._changedImages[_]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},b.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},b.prototype.addSource=function(_,S,P){var F=this;if(P===void 0&&(P={}),this._checkLoaded(),this.sourceCaches[_]!==void 0)throw new Error("There is already a source with this ID");if(!S.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(S).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(S.type)>=0&&this._validate(o.validateStyle.source,"sources."+_,S,null,P))){this.map&&this.map._collectResourceTiming&&(S.collectResourceTiming=!0);var N=this.sourceCaches[_]=new Ge(_,S,this.dispatcher);N.style=this,N.setEventedParent(this,function(){return{isSourceLoaded:F.loaded(),source:N.serialize(),sourceId:_}}),N.onAdd(this.map),this._changed=!0}},b.prototype.removeSource=function(_){if(this._checkLoaded(),this.sourceCaches[_]===void 0)throw new Error("There is no source with this ID");for(var S in this._layers)if(this._layers[S].source===_)return this.fire(new o.ErrorEvent(new Error('Source "'+_+'" cannot be removed while layer "'+S+'" is using it.')));var P=this.sourceCaches[_];delete this.sourceCaches[_],delete this._updatedSources[_],P.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_})),P.setEventedParent(null),P.clearTiles(),P.onRemove&&P.onRemove(this.map),this._changed=!0},b.prototype.setGeoJSONSourceData=function(_,S){this._checkLoaded(),this.sourceCaches[_].getSource().setData(S),this._changed=!0},b.prototype.getSource=function(_){return this.sourceCaches[_]&&this.sourceCaches[_].getSource()},b.prototype.addLayer=function(_,S,P){P===void 0&&(P={}),this._checkLoaded();var F=_.id;if(this.getLayer(F))this.fire(new o.ErrorEvent(new Error('Layer with id "'+F+'" already exists on this map')));else{var N;if(_.type==="custom"){if(wp(this,o.validateCustomStyleLayer(_)))return;N=o.createStyleLayer(_)}else{if(typeof _.source=="object"&&(this.addSource(F,_.source),_=o.clone$1(_),_=o.extend(_,{source:F})),this._validate(o.validateStyle.layer,"layers."+F,_,{arrayIndex:-1},P))return;N=o.createStyleLayer(_),this._validateLayer(N),N.setEventedParent(this,{layer:{id:F}}),this._serializedLayers[N.id]=N.serialize()}var V=S?this._order.indexOf(S):this._order.length;if(S&&V===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+S+'" does not exist on this map.')));else{if(this._order.splice(V,0,F),this._layerOrderChanged=!0,this._layers[F]=N,this._removedLayers[F]&&N.source&&N.type!=="custom"){var J=this._removedLayers[F];delete this._removedLayers[F],J.type!==N.type?this._updatedSources[N.source]="clear":(this._updatedSources[N.source]="reload",this.sourceCaches[N.source].pause())}this._updateLayer(N),N.onAdd&&N.onAdd(this.map)}}},b.prototype.moveLayer=function(_,S){if(this._checkLoaded(),this._changed=!0,this._layers[_]){if(_!==S){var P=this._order.indexOf(_);this._order.splice(P,1);var F=S?this._order.indexOf(S):this._order.length;S&&F===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+S+'" does not exist on this map.'))):(this._order.splice(F,0,_),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be moved.")))},b.prototype.removeLayer=function(_){this._checkLoaded();var S=this._layers[_];if(S){S.setEventedParent(null);var P=this._order.indexOf(_);this._order.splice(P,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[_]=S,delete this._layers[_],delete this._serializedLayers[_],delete this._updatedLayers[_],delete this._updatedPaintProps[_],S.onRemove&&S.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be removed.")))},b.prototype.getLayer=function(_){return this._layers[_]},b.prototype.hasLayer=function(_){return _ in this._layers},b.prototype.setLayerZoomRange=function(_,S,P){this._checkLoaded();var F=this.getLayer(_);F?F.minzoom===S&&F.maxzoom===P||(S!=null&&(F.minzoom=S),P!=null&&(F.maxzoom=P),this._updateLayer(F)):this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot have zoom extent.")))},b.prototype.setFilter=function(_,S,P){P===void 0&&(P={}),this._checkLoaded();var F=this.getLayer(_);if(F){if(!o.deepEqual(F.filter,S))return S==null?(F.filter=void 0,void this._updateLayer(F)):void(this._validate(o.validateStyle.filter,"layers."+F.id+".filter",S,null,P)||(F.filter=o.clone$1(S),this._updateLayer(F)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be filtered.")))},b.prototype.getFilter=function(_){return o.clone$1(this.getLayer(_).filter)},b.prototype.setLayoutProperty=function(_,S,P,F){F===void 0&&(F={}),this._checkLoaded();var N=this.getLayer(_);N?o.deepEqual(N.getLayoutProperty(S),P)||(N.setLayoutProperty(S,P,F),this._updateLayer(N)):this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be styled.")))},b.prototype.getLayoutProperty=function(_,S){var P=this.getLayer(_);if(P)return P.getLayoutProperty(S);this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style.")))},b.prototype.setPaintProperty=function(_,S,P,F){F===void 0&&(F={}),this._checkLoaded();var N=this.getLayer(_);N?o.deepEqual(N.getPaintProperty(S),P)||(N.setPaintProperty(S,P,F)&&this._updateLayer(N),this._changed=!0,this._updatedPaintProps[_]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be styled.")))},b.prototype.getPaintProperty=function(_,S){return this.getLayer(_).getPaintProperty(S)},b.prototype.setFeatureState=function(_,S){this._checkLoaded();var P=_.source,F=_.sourceLayer,N=this.sourceCaches[P];if(N!==void 0){var V=N.getSource().type;V==="geojson"&&F?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):V!=="vector"||F?(_.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),N.setFeatureState(F,_.id,S)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+P+"' does not exist in the map's style.")))},b.prototype.removeFeatureState=function(_,S){this._checkLoaded();var P=_.source,F=this.sourceCaches[P];if(F!==void 0){var N=F.getSource().type,V=N==="vector"?_.sourceLayer:void 0;N!=="vector"||V?S&&typeof _.id!="string"&&typeof _.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):F.removeFeatureState(V,_.id,S):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+P+"' does not exist in the map's style.")))},b.prototype.getFeatureState=function(_){this._checkLoaded();var S=_.source,P=_.sourceLayer,F=this.sourceCaches[S];if(F!==void 0){if(F.getSource().type!=="vector"||P)return _.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),F.getFeatureState(P,_.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+S+"' does not exist in the map's style.")))},b.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},b.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(_){return _.serialize()}),layers:this._serializeLayers(this._order)},function(_){return _!==void 0})},b.prototype._updateLayer=function(_){this._updatedLayers[_.id]=!0,_.source&&!this._updatedSources[_.source]&&this.sourceCaches[_.source].getSource().type!=="raster"&&(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause()),this._changed=!0},b.prototype._flattenAndSortRenderedFeatures=function(_){for(var S=this,P=function(yr){return S._layers[yr].type==="fill-extrusion"},F={},N=[],V=this._order.length-1;V>=0;V--){var J=this._order[V];if(P(J)){F[J]=V;for(var se=0,de=_;se<de.length;se+=1){var xe=de[se][J];if(xe)for(var Ee=0,Ue=xe;Ee<Ue.length;Ee+=1)N.push(Ue[Ee])}}}N.sort(function(yr,Ir){return Ir.intersectionZ-yr.intersectionZ});for(var Be=[],Ke=this._order.length-1;Ke>=0;Ke--){var Oe=this._order[Ke];if(P(Oe))for(var Qe=N.length-1;Qe>=0;Qe--){var ft=N[Qe].feature;if(F[ft.layer.id]<Ke)break;Be.push(ft),N.pop()}else for(var xt=0,Ut=_;xt<Ut.length;xt+=1){var Bt=Ut[xt][Oe];if(Bt)for(var Wt=0,hr=Bt;Wt<hr.length;Wt+=1)Be.push(hr[Wt].feature)}}return Be},b.prototype.queryRenderedFeatures=function(_,S,P){S&&S.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",S.filter,null,S);var F={};if(S&&S.layers){if(!Array.isArray(S.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var N=0,V=S.layers;N<V.length;N+=1){var J=V[N],se=this._layers[J];if(!se)return this.fire(new o.ErrorEvent(new Error("The layer '"+J+"' does not exist in the map's style and cannot be queried for features."))),[];F[se.source]=!0}}var de=[];for(var xe in S.availableImages=this._availableImages,this.sourceCaches)S.layers&&!F[xe]||de.push(wn(this.sourceCaches[xe],this._layers,this._serializedLayers,_,S,P));return this.placement&&de.push(function(Ee,Ue,Be,Ke,Oe,Qe,ft){for(var xt={},Ut=Qe.queryRenderedSymbols(Ke),Bt=[],Wt=0,hr=Object.keys(Ut).map(Number);Wt<hr.length;Wt+=1)Bt.push(ft[hr[Wt]]);Bt.sort(zn);for(var yr=function(){var Dn=Kr[Ir],sa=Dn.featureIndex.lookupSymbolFeatures(Ut[Dn.bucketInstanceId],Ue,Dn.bucketIndex,Dn.sourceLayerIndex,Oe.filter,Oe.layers,Oe.availableImages,Ee);for(var on in sa){var qn=xt[on]=xt[on]||[],di=sa[on];di.sort(function(wi,ri){var Tn=Dn.featureSortOrder;if(Tn){var Zo=Tn.indexOf(wi.featureIndex);return Tn.indexOf(ri.featureIndex)-Zo}return ri.featureIndex-wi.featureIndex});for(var si=0,Jn=di;si<Jn.length;si+=1)qn.push(Jn[si])}},Ir=0,Kr=Bt;Ir<Kr.length;Ir+=1)yr();var An=function(Dn){xt[Dn].forEach(function(sa){var on=sa.feature,qn=Be[Ee[Dn].source].getFeatureState(on.layer["source-layer"],on.id);on.source=on.layer.source,on.layer["source-layer"]&&(on.sourceLayer=on.layer["source-layer"]),on.state=qn})};for(var Nn in xt)An(Nn);return xt}(this._layers,this._serializedLayers,this.sourceCaches,_,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(de)},b.prototype.querySourceFeatures=function(_,S){S&&S.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",S.filter,null,S);var P=this.sourceCaches[_];return P?function(F,N){for(var V=F.getRenderableIds().map(function(Ue){return F.getTileByID(Ue)}),J=[],se={},de=0;de<V.length;de++){var xe=V[de],Ee=xe.tileID.canonical.key;se[Ee]||(se[Ee]=!0,xe.querySourceFeatures(J,N))}return J}(P,S):[]},b.prototype.addSourceType=function(_,S,P){return b.getSourceType(_)?P(new Error('A source type called "'+_+'" already exists.')):(b.setSourceType(_,S),S.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:_,url:S.workerSourceURL},P):P(null,null))},b.prototype.getLight=function(){return this.light.getLight()},b.prototype.setLight=function(_,S){S===void 0&&(S={}),this._checkLoaded();var P=this.light.getLight(),F=!1;for(var N in _)if(!o.deepEqual(_[N],P[N])){F=!0;break}if(F){var V={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(_,S),this.light.updateTransitions(V)}},b.prototype._validate=function(_,S,P,F,N){return N===void 0&&(N={}),(!N||N.validate!==!1)&&wp(this,_.call(o.validateStyle,o.extend({key:S,style:this.serialize(),value:P,styleSpec:o.styleSpec},F)))},b.prototype._remove=function(){for(var _ in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[_].setEventedParent(null);for(var S in this.sourceCaches)this.sourceCaches[S].clearTiles(),this.sourceCaches[S].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},b.prototype._clearSource=function(_){this.sourceCaches[_].clearTiles()},b.prototype._reloadSource=function(_){this.sourceCaches[_].resume(),this.sourceCaches[_].reload()},b.prototype._updateSources=function(_){for(var S in this.sourceCaches)this.sourceCaches[S].update(_)},b.prototype._generateCollisionBoxes=function(){for(var _ in this.sourceCaches)this._reloadSource(_)},b.prototype._updatePlacement=function(_,S,P,F,N){N===void 0&&(N=!1);for(var V=!1,J=!1,se={},de=0,xe=this._order;de<xe.length;de+=1){var Ee=this._layers[xe[de]];if(Ee.type==="symbol"){if(!se[Ee.source]){var Ue=this.sourceCaches[Ee.source];se[Ee.source]=Ue.getRenderableIds(!0).map(function(ft){return Ue.getTileByID(ft)}).sort(function(ft,xt){return xt.tileID.overscaledZ-ft.tileID.overscaledZ||(ft.tileID.isLessThan(xt.tileID)?-1:1)})}var Be=this.crossTileSymbolIndex.addLayer(Ee,se[Ee.source],_.center.lng);V=V||Be}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((N=N||this._layerOrderChanged||P===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),_.zoom))&&(this.pauseablePlacement=new nv(_,this._order,N,S,P,F,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,se),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),J=!0),V&&this.pauseablePlacement.placement.setStale()),J||V)for(var Ke=0,Oe=this._order;Ke<Oe.length;Ke+=1){var Qe=this._layers[Oe[Ke]];Qe.type==="symbol"&&this.placement.updateLayerOpacities(Qe,se[Qe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},b.prototype._releaseSymbolFadeTiles=function(){for(var _ in this.sourceCaches)this.sourceCaches[_].releaseSymbolFadeTiles()},b.prototype.getImages=function(_,S,P){this.imageManager.getImages(S.icons,P),this._updateTilesForChangedImages();var F=this.sourceCaches[S.source];F&&F.setDependencies(S.tileID.key,S.type,S.icons)},b.prototype.getGlyphs=function(_,S,P){this.glyphManager.getGlyphs(S.stacks,P)},b.prototype.getResource=function(_,S,P){return o.makeRequest(S,P)},b}(o.Evented);ea.getSourceType=function(y){return Lt[y]},ea.setSourceType=function(y,b){Lt[y]=b},ea.registerForPluginStateChange=o.registerForPluginStateChange;var us=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),Cp=Ma(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),vm=Ma(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),P_=Ma(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),gm=Ma(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),iv=Ma("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Nc=Ma(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),sd=Ma(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ws=Ma("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),av=Ma("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ch=Ma("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),$y=Ma(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ep=Ma(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Zu=Ma(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),mm=Ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),ou=Ma(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),ig=Ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),qu=Ma(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Vf=Ma(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Eh=Ma(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),hs=Ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Sh=Ma(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),ps=Ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Ah=Ma(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Sl=Ma(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),_f=Ma(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),zc=Ma(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Ma(y,b){var _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,S=b.match(/attribute ([\w]+) ([\w]+)/g),P=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),F=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),N=F?F.concat(P):P,V={};return{fragmentSource:y=y.replace(_,function(J,se,de,xe,Ee){return V[Ee]=!0,se==="define"?`
#ifndef HAS_UNIFORM_u_`+Ee+`
varying `+de+" "+xe+" "+Ee+`;
#else
uniform `+de+" "+xe+" u_"+Ee+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Ee+`
    `+de+" "+xe+" "+Ee+" = u_"+Ee+`;
#endif
`}),vertexSource:b=b.replace(_,function(J,se,de,xe,Ee){var Ue=xe==="float"?"vec2":"vec4",Be=Ee.match(/color/)?"color":Ue;return V[Ee]?se==="define"?`
#ifndef HAS_UNIFORM_u_`+Ee+`
uniform lowp float u_`+Ee+`_t;
attribute `+de+" "+Ue+" a_"+Ee+`;
varying `+de+" "+xe+" "+Ee+`;
#else
uniform `+de+" "+xe+" u_"+Ee+`;
#endif
`:Be==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Ee+`
    `+Ee+" = a_"+Ee+`;
#else
    `+de+" "+xe+" "+Ee+" = u_"+Ee+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Ee+`
    `+Ee+" = unpack_mix_"+Be+"(a_"+Ee+", u_"+Ee+`_t);
#else
    `+de+" "+xe+" "+Ee+" = u_"+Ee+`;
#endif
`:se==="define"?`
#ifndef HAS_UNIFORM_u_`+Ee+`
uniform lowp float u_`+Ee+`_t;
attribute `+de+" "+Ue+" a_"+Ee+`;
#else
uniform `+de+" "+xe+" u_"+Ee+`;
#endif
`:Be==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Ee+`
    `+de+" "+xe+" "+Ee+" = a_"+Ee+`;
#else
    `+de+" "+xe+" "+Ee+" = u_"+Ee+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Ee+`
    `+de+" "+xe+" "+Ee+" = unpack_mix_"+Be+"(a_"+Ee+", u_"+Ee+`_t);
#else
    `+de+" "+xe+" "+Ee+" = u_"+Ee+`;
#endif
`}),staticAttributes:S,staticUniforms:N}}var ls=Object.freeze({__proto__:null,prelude:Cp,background:vm,backgroundPattern:P_,circle:gm,clippingMask:iv,heatmap:Nc,heatmapTexture:sd,collisionBox:Ws,collisionCircle:av,debug:Ch,fill:$y,fillOutline:Ep,fillOutlinePattern:Zu,fillPattern:mm,fillExtrusion:ou,fillExtrusionPattern:ig,hillshadePrepare:qu,hillshade:Vf,line:Eh,lineGradient:hs,linePattern:Sh,lineSDF:ps,raster:Ah,symbolIcon:Sl,symbolSDF:_f,symbolTextAndIcon:zc}),$c=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ag(y){for(var b=[],_=0;_<y.length;_++)if(y[_]!==null){var S=y[_].split(" ");b.push(S.pop())}return b}$c.prototype.bind=function(y,b,_,S,P,F,N,V){this.context=y;for(var J=this.boundPaintVertexBuffers.length!==S.length,se=0;!J&&se<S.length;se++)this.boundPaintVertexBuffers[se]!==S[se]&&(J=!0);y.extVertexArrayObject&&this.vao&&this.boundProgram===b&&this.boundLayoutVertexBuffer===_&&!J&&this.boundIndexBuffer===P&&this.boundVertexOffset===F&&this.boundDynamicVertexBuffer===N&&this.boundDynamicVertexBuffer2===V?(y.bindVertexArrayOES.set(this.vao),N&&N.bind(),P&&P.dynamicDraw&&P.bind(),V&&V.bind()):this.freshBind(b,_,S,P,F,N,V)},$c.prototype.freshBind=function(y,b,_,S,P,F,N){var V,J=y.numAttributes,se=this.context,de=se.gl;if(se.extVertexArrayObject)this.vao&&this.destroy(),this.vao=se.extVertexArrayObject.createVertexArrayOES(),se.bindVertexArrayOES.set(this.vao),V=0,this.boundProgram=y,this.boundLayoutVertexBuffer=b,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=S,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=F,this.boundDynamicVertexBuffer2=N;else{V=se.currentNumAttributes||0;for(var xe=J;xe<V;xe++)de.disableVertexAttribArray(xe)}b.enableAttributes(de,y);for(var Ee=0,Ue=_;Ee<Ue.length;Ee+=1)Ue[Ee].enableAttributes(de,y);F&&F.enableAttributes(de,y),N&&N.enableAttributes(de,y),b.bind(),b.setVertexAttribPointers(de,y,P);for(var Be=0,Ke=_;Be<Ke.length;Be+=1){var Oe=Ke[Be];Oe.bind(),Oe.setVertexAttribPointers(de,y,P)}F&&(F.bind(),F.setVertexAttribPointers(de,y,P)),S&&S.bind(),N&&(N.bind(),N.setVertexAttribPointers(de,y,P)),se.currentNumAttributes=J},$c.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ym=function(y,b,_,S,P,F){var N=y.gl;this.program=N.createProgram();for(var V=ag(_.staticAttributes),J=S?S.getBinderAttributes():[],se=V.concat(J),de=_.staticUniforms?ag(_.staticUniforms):[],xe=S?S.getBinderUniforms():[],Ee=[],Ue=0,Be=de.concat(xe);Ue<Be.length;Ue+=1){var Ke=Be[Ue];Ee.indexOf(Ke)<0&&Ee.push(Ke)}var Oe=S?S.defines():[];F&&Oe.push("#define OVERDRAW_INSPECTOR;");var Qe=Oe.concat(Cp.fragmentSource,_.fragmentSource).join(`
`),ft=Oe.concat(Cp.vertexSource,_.vertexSource).join(`
`),xt=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())this.failedToCreate=!0;else{N.shaderSource(xt,Qe),N.compileShader(xt),N.attachShader(this.program,xt);var Ut=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())this.failedToCreate=!0;else{N.shaderSource(Ut,ft),N.compileShader(Ut),N.attachShader(this.program,Ut),this.attributes={};var Bt={};this.numAttributes=se.length;for(var Wt=0;Wt<this.numAttributes;Wt++)se[Wt]&&(N.bindAttribLocation(this.program,Wt,se[Wt]),this.attributes[se[Wt]]=Wt);N.linkProgram(this.program),N.deleteShader(Ut),N.deleteShader(xt);for(var hr=0;hr<Ee.length;hr++){var yr=Ee[hr];if(yr&&!Bt[yr]){var Ir=N.getUniformLocation(this.program,yr);Ir&&(Bt[yr]=Ir)}}this.fixedUniforms=P(y,Bt),this.binderUniforms=S?S.getUniforms(y,Bt):[]}}};function og(y,b,_){var S=1/Za(_,1,b.transform.tileZoom),P=Math.pow(2,_.tileID.overscaledZ),F=_.tileSize*Math.pow(2,b.transform.tileZoom)/P,N=F*(_.tileID.canonical.x+_.tileID.wrap*P),V=F*_.tileID.canonical.y;return{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[S,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[N>>16,V>>16],u_pixel_coord_lower:[65535&N,65535&V]}}ym.prototype.draw=function(y,b,_,S,P,F,N,V,J,se,de,xe,Ee,Ue,Be,Ke){var Oe,Qe=y.gl;if(!this.failedToCreate){for(var ft in y.program.set(this.program),y.setDepthMode(_),y.setStencilMode(S),y.setColorMode(P),y.setCullFace(F),this.fixedUniforms)this.fixedUniforms[ft].set(N[ft]);Ue&&Ue.setUniforms(y,this.binderUniforms,xe,{zoom:Ee});for(var xt=(Oe={},Oe[Qe.LINES]=2,Oe[Qe.TRIANGLES]=3,Oe[Qe.LINE_STRIP]=1,Oe)[b],Ut=0,Bt=de.get();Ut<Bt.length;Ut+=1){var Wt=Bt[Ut],hr=Wt.vaos||(Wt.vaos={});(hr[V]||(hr[V]=new $c)).bind(y,this,J,Ue?Ue.getPaintVertexBuffers():[],se,Wt.vertexOffset,Be,Ke),Qe.drawElements(b,Wt.primitiveLength*xt,Qe.UNSIGNED_SHORT,Wt.primitiveOffset*xt*2)}}};var Uy=function(y,b,_,S){var P=b.style.light,F=P.properties.get("position"),N=[F.x,F.y,F.z],V=o.create$1();P.properties.get("anchor")==="viewport"&&o.fromRotation(V,-b.transform.angle),o.transformMat3(N,N,V);var J=P.properties.get("color");return{u_matrix:y,u_lightpos:N,u_lightintensity:P.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+_,u_opacity:S}},Th=function(y,b,_,S,P,F,N){return o.extend(Uy(y,b,_,S),og(F,b,N),{u_height_factor:-Math.pow(2,P.overscaledZ)/N.tileSize/8})},ro=function(y){return{u_matrix:y}},Gf=function(y,b,_,S){return o.extend(ro(y),og(_,b,S))},ov=function(y,b){return{u_matrix:y,u_world:b}},Ku=function(y,b,_,S,P){return o.extend(Gf(y,b,_,S),{u_world:P})},sv=function(y,b,_,S){var P,F,N=y.transform;if(S.paint.get("circle-pitch-alignment")==="map"){var V=Za(_,1,N.zoom);P=!0,F=[V,V]}else P=!1,F=N.pixelsToGLUnits;return{u_camera_to_center_distance:N.cameraToCenterDistance,u_scale_with_map:+(S.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(b.posMatrix,_,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_pitch_with_map:+P,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:F}},Uc=function(y,b,_){var S=Za(_,1,b.zoom),P=Math.pow(2,b.zoom-_.tileID.overscaledZ),F=_.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:b.cameraToCenterDistance,u_pixels_to_tile_units:S,u_extrude_scale:[b.pixelsToGLUnits[0]/(S*P),b.pixelsToGLUnits[1]/(S*P)],u_overscale_factor:F}},Hf=function(y,b,_){return{u_matrix:y,u_inv_matrix:b,u_camera_to_center_distance:_.cameraToCenterDistance,u_viewport_size:[_.width,_.height]}},Vc=function(y,b,_){return _===void 0&&(_=1),{u_matrix:y,u_color:b,u_overlay:0,u_overlay_scale:_}},lc=function(y){return{u_matrix:y}},Sp=function(y,b,_,S){return{u_matrix:y,u_extrude_scale:Za(b,1,_),u_intensity:S}},Mh=function(y,b,_){var S=y.transform;return{u_matrix:Al(y,b,_),u_ratio:1/Za(b,1,S.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},Ga=function(y,b,_,S){return o.extend(Mh(y,b,_),{u_image:0,u_image_height:S})},Lh=function(y,b,_,S){var P=y.transform,F=Ap(b,P);return{u_matrix:Al(y,b,_),u_texsize:b.imageAtlasTexture.size,u_ratio:1/Za(b,1,P.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[F,S.fromScale,S.toScale],u_fade:S.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},Vy=function(y,b,_,S,P){var F=y.lineAtlas,N=Ap(b,y.transform),V=_.layout.get("line-cap")==="round",J=F.getDash(S.from,V),se=F.getDash(S.to,V),de=J.width*P.fromScale,xe=se.width*P.toScale;return o.extend(Mh(y,b,_),{u_patternscale_a:[N/de,-J.height/2],u_patternscale_b:[N/xe,-se.height/2],u_sdfgamma:F.width/(256*Math.min(de,xe)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:J.y,u_tex_y_b:se.y,u_mix:P.t})};function Ap(y,b){return 1/Za(y,1,b.tileZoom)}function Al(y,b,_){return y.translatePosMatrix(b.tileID.posMatrix,b,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}var _m=function(y,b,_,S,P){return{u_matrix:y,u_tl_parent:b,u_scale_parent:_,u_buffer_scale:1,u_fade_t:S.mix,u_opacity:S.opacity*P.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:P.paint.get("raster-brightness-min"),u_brightness_high:P.paint.get("raster-brightness-max"),u_saturation_factor:(N=P.paint.get("raster-saturation"),N>0?1-1/(1.001-N):-N),u_contrast_factor:(F=P.paint.get("raster-contrast"),F>0?1/(1-F):1+F),u_spin_weights:ud(P.paint.get("raster-hue-rotate"))};var F,N};function ud(y){y*=Math.PI/180;var b=Math.sin(y),_=Math.cos(y);return[(2*_+1)/3,(-Math.sqrt(3)*b-_+1)/3,(Math.sqrt(3)*b-_+1)/3]}var Tp,xf=function(y,b,_,S,P,F,N,V,J,se){var de=P.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:b?b.uSizeT:0,u_size:b?b.uSize:0,u_camera_to_center_distance:de.cameraToCenterDistance,u_pitch:de.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:de.width/de.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_matrix:F,u_label_plane_matrix:N,u_coord_matrix:V,u_is_text:+J,u_pitch_with_map:+S,u_texsize:se,u_texture:0}},Mp=function(y,b,_,S,P,F,N,V,J,se,de){var xe=P.transform;return o.extend(xf(y,b,_,S,P,F,N,V,J,se),{u_gamma_scale:S?Math.cos(xe._pitch)*xe.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+de})},ld=function(y,b,_,S,P,F,N,V,J,se){return o.extend(Mp(y,b,_,S,P,F,N,V,!0,J,!0),{u_texsize_icon:se,u_texture_icon:1})},bf=function(y,b,_){return{u_matrix:y,u_opacity:b,u_color:_}},Ih=function(y,b,_,S,P,F){return o.extend(function(N,V,J,se){var de=J.imageManager.getPattern(N.from.toString()),xe=J.imageManager.getPattern(N.to.toString()),Ee=J.imageManager.getPixelSize(),Ue=Ee.width,Be=Ee.height,Ke=Math.pow(2,se.tileID.overscaledZ),Oe=se.tileSize*Math.pow(2,J.transform.tileZoom)/Ke,Qe=Oe*(se.tileID.canonical.x+se.tileID.wrap*Ke),ft=Oe*se.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:de.tl,u_pattern_br_a:de.br,u_pattern_tl_b:xe.tl,u_pattern_br_b:xe.br,u_texsize:[Ue,Be],u_mix:V.t,u_pattern_size_a:de.displaySize,u_pattern_size_b:xe.displaySize,u_scale_a:V.fromScale,u_scale_b:V.toScale,u_tile_units_to_pixels:1/Za(se,1,J.transform.tileZoom),u_pixel_coord_upper:[Qe>>16,ft>>16],u_pixel_coord_lower:[65535&Qe,65535&ft]}}(S,F,_,P),{u_matrix:y,u_opacity:b})},sg={fillExtrusion:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_lightpos:new o.Uniform3f(y,b.u_lightpos),u_lightintensity:new o.Uniform1f(y,b.u_lightintensity),u_lightcolor:new o.Uniform3f(y,b.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,b.u_vertical_gradient),u_opacity:new o.Uniform1f(y,b.u_opacity)}},fillExtrusionPattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_lightpos:new o.Uniform3f(y,b.u_lightpos),u_lightintensity:new o.Uniform1f(y,b.u_lightintensity),u_lightcolor:new o.Uniform3f(y,b.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,b.u_vertical_gradient),u_height_factor:new o.Uniform1f(y,b.u_height_factor),u_image:new o.Uniform1i(y,b.u_image),u_texsize:new o.Uniform2f(y,b.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade),u_opacity:new o.Uniform1f(y,b.u_opacity)}},fill:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},fillPattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_image:new o.Uniform1i(y,b.u_image),u_texsize:new o.Uniform2f(y,b.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade)}},fillOutline:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_world:new o.Uniform2f(y,b.u_world)}},fillOutlinePattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_world:new o.Uniform2f(y,b.u_world),u_image:new o.Uniform1i(y,b.u_image),u_texsize:new o.Uniform2f(y,b.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade)}},circle:function(y,b){return{u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(y,b.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(y,b.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},collisionBox:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(y,b.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(y,b.u_extrude_scale),u_overscale_factor:new o.Uniform1f(y,b.u_overscale_factor)}},collisionCircle:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_inv_matrix:new o.UniformMatrix4f(y,b.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(y,b.u_viewport_size)}},debug:function(y,b){return{u_color:new o.UniformColor(y,b.u_color),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_overlay:new o.Uniform1i(y,b.u_overlay),u_overlay_scale:new o.Uniform1f(y,b.u_overlay_scale)}},clippingMask:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},heatmap:function(y,b){return{u_extrude_scale:new o.Uniform1f(y,b.u_extrude_scale),u_intensity:new o.Uniform1f(y,b.u_intensity),u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},heatmapTexture:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_world:new o.Uniform2f(y,b.u_world),u_image:new o.Uniform1i(y,b.u_image),u_color_ramp:new o.Uniform1i(y,b.u_color_ramp),u_opacity:new o.Uniform1f(y,b.u_opacity)}},hillshade:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_image:new o.Uniform1i(y,b.u_image),u_latrange:new o.Uniform2f(y,b.u_latrange),u_light:new o.Uniform2f(y,b.u_light),u_shadow:new o.UniformColor(y,b.u_shadow),u_highlight:new o.UniformColor(y,b.u_highlight),u_accent:new o.UniformColor(y,b.u_accent)}},hillshadePrepare:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_image:new o.Uniform1i(y,b.u_image),u_dimension:new o.Uniform2f(y,b.u_dimension),u_zoom:new o.Uniform1f(y,b.u_zoom),u_unpack:new o.Uniform4f(y,b.u_unpack)}},line:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels)}},lineGradient:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels),u_image:new o.Uniform1i(y,b.u_image),u_image_height:new o.Uniform1f(y,b.u_image_height)}},linePattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_texsize:new o.Uniform2f(y,b.u_texsize),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_image:new o.Uniform1i(y,b.u_image),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade)}},lineSDF:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(y,b.u_patternscale_a),u_patternscale_b:new o.Uniform2f(y,b.u_patternscale_b),u_sdfgamma:new o.Uniform1f(y,b.u_sdfgamma),u_image:new o.Uniform1i(y,b.u_image),u_tex_y_a:new o.Uniform1f(y,b.u_tex_y_a),u_tex_y_b:new o.Uniform1f(y,b.u_tex_y_b),u_mix:new o.Uniform1f(y,b.u_mix)}},raster:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_tl_parent:new o.Uniform2f(y,b.u_tl_parent),u_scale_parent:new o.Uniform1f(y,b.u_scale_parent),u_buffer_scale:new o.Uniform1f(y,b.u_buffer_scale),u_fade_t:new o.Uniform1f(y,b.u_fade_t),u_opacity:new o.Uniform1f(y,b.u_opacity),u_image0:new o.Uniform1i(y,b.u_image0),u_image1:new o.Uniform1i(y,b.u_image1),u_brightness_low:new o.Uniform1f(y,b.u_brightness_low),u_brightness_high:new o.Uniform1f(y,b.u_brightness_high),u_saturation_factor:new o.Uniform1f(y,b.u_saturation_factor),u_contrast_factor:new o.Uniform1f(y,b.u_contrast_factor),u_spin_weights:new o.Uniform3f(y,b.u_spin_weights)}},symbolIcon:function(y,b){return{u_is_size_zoom_constant:new o.Uniform1i(y,b.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,b.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,b.u_size_t),u_size:new o.Uniform1f(y,b.u_size),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,b.u_pitch),u_rotate_symbol:new o.Uniform1i(y,b.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,b.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,b.u_fade_change),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,b.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,b.u_coord_matrix),u_is_text:new o.Uniform1i(y,b.u_is_text),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_texsize:new o.Uniform2f(y,b.u_texsize),u_texture:new o.Uniform1i(y,b.u_texture)}},symbolSDF:function(y,b){return{u_is_size_zoom_constant:new o.Uniform1i(y,b.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,b.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,b.u_size_t),u_size:new o.Uniform1f(y,b.u_size),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,b.u_pitch),u_rotate_symbol:new o.Uniform1i(y,b.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,b.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,b.u_fade_change),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,b.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,b.u_coord_matrix),u_is_text:new o.Uniform1i(y,b.u_is_text),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_texsize:new o.Uniform2f(y,b.u_texsize),u_texture:new o.Uniform1i(y,b.u_texture),u_gamma_scale:new o.Uniform1f(y,b.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,b.u_is_halo)}},symbolTextAndIcon:function(y,b){return{u_is_size_zoom_constant:new o.Uniform1i(y,b.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,b.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,b.u_size_t),u_size:new o.Uniform1f(y,b.u_size),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,b.u_pitch),u_rotate_symbol:new o.Uniform1i(y,b.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,b.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,b.u_fade_change),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,b.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,b.u_coord_matrix),u_is_text:new o.Uniform1i(y,b.u_is_text),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_texsize:new o.Uniform2f(y,b.u_texsize),u_texsize_icon:new o.Uniform2f(y,b.u_texsize_icon),u_texture:new o.Uniform1i(y,b.u_texture),u_texture_icon:new o.Uniform1i(y,b.u_texture_icon),u_gamma_scale:new o.Uniform1f(y,b.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,b.u_is_halo)}},background:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_opacity:new o.Uniform1f(y,b.u_opacity),u_color:new o.UniformColor(y,b.u_color)}},backgroundPattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_opacity:new o.Uniform1f(y,b.u_opacity),u_image:new o.Uniform1i(y,b.u_image),u_pattern_tl_a:new o.Uniform2f(y,b.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(y,b.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(y,b.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(y,b.u_pattern_br_b),u_texsize:new o.Uniform2f(y,b.u_texsize),u_mix:new o.Uniform1f(y,b.u_mix),u_pattern_size_a:new o.Uniform2f(y,b.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(y,b.u_pattern_size_b),u_scale_a:new o.Uniform1f(y,b.u_scale_a),u_scale_b:new o.Uniform1f(y,b.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(y,b.u_tile_units_to_pixels)}}};function Hl(y,b,_,S,P,F,N){for(var V=y.context,J=V.gl,se=y.useProgram("collisionBox"),de=[],xe=0,Ee=0,Ue=0;Ue<S.length;Ue++){var Be=S[Ue],Ke=b.getTile(Be),Oe=Ke.getBucket(_);if(Oe){var Qe=Be.posMatrix;P[0]===0&&P[1]===0||(Qe=y.translatePosMatrix(Be.posMatrix,Ke,P,F));var ft=N?Oe.textCollisionBox:Oe.iconCollisionBox,xt=Oe.collisionCircleArray;if(xt.length>0){var Ut=o.create(),Bt=Qe;o.mul(Ut,Oe.placementInvProjMatrix,y.transform.glCoordMatrix),o.mul(Ut,Ut,Oe.placementViewportMatrix),de.push({circleArray:xt,circleOffset:Ee,transform:Bt,invTransform:Ut}),Ee=xe+=xt.length/4}ft&&se.draw(V,J.LINES,Ce.disabled,Ne.disabled,y.colorModeForRenderPass(),pt.disabled,Uc(Qe,y.transform,Ke),_.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,null,y.transform.zoom,null,null,ft.collisionVertexBuffer)}}if(N&&de.length){var Wt=y.useProgram("collisionCircle"),hr=new o.StructArrayLayout2f1f2i16;hr.resize(4*xe),hr._trim();for(var yr=0,Ir=0,Kr=de;Ir<Kr.length;Ir+=1)for(var An=Kr[Ir],Nn=0;Nn<An.circleArray.length/4;Nn++){var Dn=4*Nn,sa=An.circleArray[Dn+0],on=An.circleArray[Dn+1],qn=An.circleArray[Dn+2],di=An.circleArray[Dn+3];hr.emplace(yr++,sa,on,qn,di,0),hr.emplace(yr++,sa,on,qn,di,1),hr.emplace(yr++,sa,on,qn,di,2),hr.emplace(yr++,sa,on,qn,di,3)}(!Tp||Tp.length<2*xe)&&(Tp=function(No){var Mo=2*No,Ss=new o.StructArrayLayout3ui6;Ss.resize(Mo),Ss._trim();for(var vo=0;vo<Mo;vo++){var no=6*vo;Ss.uint16[no+0]=4*vo+0,Ss.uint16[no+1]=4*vo+1,Ss.uint16[no+2]=4*vo+2,Ss.uint16[no+3]=4*vo+2,Ss.uint16[no+4]=4*vo+3,Ss.uint16[no+5]=4*vo+0}return Ss}(xe));for(var si=V.createIndexBuffer(Tp,!0),Jn=V.createVertexBuffer(hr,o.collisionCircleLayout.members,!0),wi=0,ri=de;wi<ri.length;wi+=1){var Tn=ri[wi],Zo=Hf(Tn.transform,Tn.invTransform,y.transform);Wt.draw(V,J.TRIANGLES,Ce.disabled,Ne.disabled,y.colorModeForRenderPass(),pt.disabled,Zo,_.id,Jn,si,o.SegmentVector.simpleSegment(0,2*Tn.circleOffset,Tn.circleArray.length,Tn.circleArray.length/2),null,y.transform.zoom,null,null,null)}Jn.destroy(),si.destroy()}}var jl=o.identity(new Float32Array(16));function xm(y,b,_,S,P,F){var N=o.getAnchorAlignment(y),V=-(N.horizontalAlign-.5)*b,J=-(N.verticalAlign-.5)*_,se=o.evaluateVariableOffset(y,S);return new o.Point((V/P+se[0])*F,(J/P+se[1])*F)}function uv(y,b,_,S,P,F,N,V,J,se,de){var xe=y.text.placedSymbolArray,Ee=y.text.dynamicLayoutVertexArray,Ue=y.icon.dynamicLayoutVertexArray,Be={};Ee.clear();for(var Ke=0;Ke<xe.length;Ke++){var Oe=xe.get(Ke),Qe=Oe.hidden||!Oe.crossTileID||y.allowVerticalPlacement&&!Oe.placedOrientation?null:S[Oe.crossTileID];if(Qe){var ft=new o.Point(Oe.anchorX,Oe.anchorY),xt=bi(ft,_?V:N),Ut=Ni(F.cameraToCenterDistance,xt.signedDistanceFromCamera),Bt=P.evaluateSizeForFeature(y.textSizeData,se,Oe)*Ut/o.ONE_EM;_&&(Bt*=y.tilePixelRatio/J);for(var Wt=xm(Qe.anchor,Qe.width,Qe.height,Qe.textOffset,Qe.textBoxScale,Bt),hr=_?bi(ft.add(Wt),N).point:xt.point.add(b?Wt.rotate(-F.angle):Wt),yr=y.allowVerticalPlacement&&Oe.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Ir=0;Ir<Oe.numGlyphs;Ir++)o.addDynamicAttributes(Ee,hr,yr);de&&Oe.associatedIconIndex>=0&&(Be[Oe.associatedIconIndex]={shiftedAnchor:hr,angle:yr})}else Ds(Oe.numGlyphs,Ee)}if(de){Ue.clear();for(var Kr=y.icon.placedSymbolArray,An=0;An<Kr.length;An++){var Nn=Kr.get(An);if(Nn.hidden)Ds(Nn.numGlyphs,Ue);else{var Dn=Be[An];if(Dn)for(var sa=0;sa<Nn.numGlyphs;sa++)o.addDynamicAttributes(Ue,Dn.shiftedAnchor,Dn.angle);else Ds(Nn.numGlyphs,Ue)}}y.icon.dynamicLayoutVertexBuffer.updateData(Ue)}y.text.dynamicLayoutVertexBuffer.updateData(Ee)}function ug(y,b,_){return _.iconsInText&&b?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function fl(y,b,_,S,P,F,N,V,J,se,de,xe){for(var Ee=y.context,Ue=Ee.gl,Be=y.transform,Ke=V==="map",Oe=J==="map",Qe=Ke&&_.layout.get("symbol-placement")!=="point",ft=Ke&&!Oe&&!Qe,xt=_.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ut=!1,Bt=y.depthModeForSublayer(0,Ce.ReadOnly),Wt=_.layout.get("text-variable-anchor"),hr=[],yr=0,Ir=S;yr<Ir.length;yr+=1){var Kr=Ir[yr],An=b.getTile(Kr),Nn=An.getBucket(_);if(Nn){var Dn=P?Nn.text:Nn.icon;if(Dn&&Dn.segments.get().length){var sa=Dn.programConfigurations.get(_.id),on=P||Nn.sdfIcons,qn=P?Nn.textSizeData:Nn.iconSizeData,di=Oe||Be.pitch!==0,si=y.useProgram(ug(on,P,Nn),sa),Jn=o.evaluateSizeForZoom(qn,Be.zoom),wi=void 0,ri=[0,0],Tn=void 0,Zo=void 0,No=null,Mo=void 0;if(P)Tn=An.glyphAtlasTexture,Zo=Ue.LINEAR,wi=An.glyphAtlasTexture.size,Nn.iconsInText&&(ri=An.imageAtlasTexture.size,No=An.imageAtlasTexture,Mo=di||y.options.rotating||y.options.zooming||qn.kind==="composite"||qn.kind==="camera"?Ue.LINEAR:Ue.NEAREST);else{var Ss=_.layout.get("icon-size").constantOr(0)!==1||Nn.iconsNeedLinear;Tn=An.imageAtlasTexture,Zo=on||y.options.rotating||y.options.zooming||Ss||di?Ue.LINEAR:Ue.NEAREST,wi=An.imageAtlasTexture.size}var vo=Za(An,1,y.transform.zoom),no=Ki(Kr.posMatrix,Oe,Ke,y.transform,vo),Du=oa(Kr.posMatrix,Oe,Ke,y.transform,vo),Ha=Wt&&Nn.hasTextData(),Xc=_.layout.get("icon-text-fit")!=="none"&&Ha&&Nn.hasIconData();Qe&&Xu(Nn,Kr.posMatrix,y,P,no,Du,Oe,se);var tl=y.translatePosMatrix(Kr.posMatrix,An,F,N),dc=Qe||P&&Wt||Xc?jl:no,ql=y.translatePosMatrix(Du,An,F,N,!0),qf=on&&_.paint.get(P?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Rp={program:si,buffers:Dn,uniformValues:on?Nn.iconsInText?ld(qn.kind,Jn,ft,Oe,y,tl,dc,ql,wi,ri):Mp(qn.kind,Jn,ft,Oe,y,tl,dc,ql,P,wi,!0):xf(qn.kind,Jn,ft,Oe,y,tl,dc,ql,P,wi),atlasTexture:Tn,atlasTextureIcon:No,atlasInterpolation:Zo,atlasInterpolationIcon:Mo,isSDF:on,hasHalo:qf};if(xt&&Nn.canOverlap){Ut=!0;for(var Kl=0,Kf=Dn.segments.get();Kl<Kf.length;Kl+=1){var Op=Kf[Kl];hr.push({segments:new o.SegmentVector([Op]),sortKey:Op.sortKey,state:Rp})}}else hr.push({segments:Dn.segments,sortKey:0,state:Rp})}}}Ut&&hr.sort(function(Sf,zh){return Sf.sortKey-zh.sortKey});for(var Yc=0,Zc=hr;Yc<Zc.length;Yc+=1){var qc=Zc[Yc],Ns=qc.state;if(Ee.activeTexture.set(Ue.TEXTURE0),Ns.atlasTexture.bind(Ns.atlasInterpolation,Ue.CLAMP_TO_EDGE),Ns.atlasTextureIcon&&(Ee.activeTexture.set(Ue.TEXTURE1),Ns.atlasTextureIcon&&Ns.atlasTextureIcon.bind(Ns.atlasInterpolationIcon,Ue.CLAMP_TO_EDGE)),Ns.isSDF){var Ql=Ns.uniformValues;Ns.hasHalo&&(Ql.u_is_halo=1,jf(Ns.buffers,qc.segments,_,y,Ns.program,Bt,de,xe,Ql)),Ql.u_is_halo=0}jf(Ns.buffers,qc.segments,_,y,Ns.program,Bt,de,xe,Ns.uniformValues)}}function jf(y,b,_,S,P,F,N,V,J){var se=S.context;P.draw(se,se.gl.TRIANGLES,F,N,V,pt.disabled,J,_.id,y.layoutVertexBuffer,y.indexBuffer,b,_.paint,S.transform.zoom,y.programConfigurations.get(_.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function lv(y,b,_,S,P,F,N){var V,J,se,de,xe,Ee=y.context.gl,Ue=_.paint.get("fill-pattern"),Be=Ue&&Ue.constantOr(1),Ke=_.getCrossfadeParameters();N?(J=Be&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=Ee.LINES):(J=Be?"fillPattern":"fill",V=Ee.TRIANGLES);for(var Oe=0,Qe=S;Oe<Qe.length;Oe+=1){var ft=Qe[Oe],xt=b.getTile(ft);if(!Be||xt.patternsLoaded()){var Ut=xt.getBucket(_);if(Ut){var Bt=Ut.programConfigurations.get(_.id),Wt=y.useProgram(J,Bt);Be&&(y.context.activeTexture.set(Ee.TEXTURE0),xt.imageAtlasTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE),Bt.updatePaintBuffers(Ke));var hr=Ue.constantOr(null);if(hr&&xt.imageAtlas){var yr=xt.imageAtlas,Ir=yr.patternPositions[hr.to.toString()],Kr=yr.patternPositions[hr.from.toString()];Ir&&Kr&&Bt.setConstantPatternPositions(Ir,Kr)}var An=y.translatePosMatrix(ft.posMatrix,xt,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(N){de=Ut.indexBuffer2,xe=Ut.segments2;var Nn=[Ee.drawingBufferWidth,Ee.drawingBufferHeight];se=J==="fillOutlinePattern"&&Be?Ku(An,y,Ke,xt,Nn):ov(An,Nn)}else de=Ut.indexBuffer,xe=Ut.segments,se=Be?Gf(An,y,Ke,xt):ro(An);Wt.draw(y.context,V,P,y.stencilModeForClipping(ft),F,pt.disabled,se,_.id,Ut.layoutVertexBuffer,de,xe,_.paint,y.transform.zoom,Bt)}}}}function lg(y,b,_,S,P,F,N){for(var V=y.context,J=V.gl,se=_.paint.get("fill-extrusion-pattern"),de=se.constantOr(1),xe=_.getCrossfadeParameters(),Ee=_.paint.get("fill-extrusion-opacity"),Ue=0,Be=S;Ue<Be.length;Ue+=1){var Ke=Be[Ue],Oe=b.getTile(Ke),Qe=Oe.getBucket(_);if(Qe){var ft=Qe.programConfigurations.get(_.id),xt=y.useProgram(de?"fillExtrusionPattern":"fillExtrusion",ft);de&&(y.context.activeTexture.set(J.TEXTURE0),Oe.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),ft.updatePaintBuffers(xe));var Ut=se.constantOr(null);if(Ut&&Oe.imageAtlas){var Bt=Oe.imageAtlas,Wt=Bt.patternPositions[Ut.to.toString()],hr=Bt.patternPositions[Ut.from.toString()];Wt&&hr&&ft.setConstantPatternPositions(Wt,hr)}var yr=y.translatePosMatrix(Ke.posMatrix,Oe,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),Ir=_.paint.get("fill-extrusion-vertical-gradient"),Kr=de?Th(yr,y,Ir,Ee,Ke,xe,Oe):Uy(yr,y,Ir,Ee);xt.draw(V,V.gl.TRIANGLES,P,F,N,pt.backCCW,Kr,_.id,Qe.layoutVertexBuffer,Qe.indexBuffer,Qe.segments,_.paint,y.transform.zoom,ft)}}}function cv(y,b,_,S,P,F){var N=y.context,V=N.gl,J=b.fbo;if(J){var se=y.useProgram("hillshade");N.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,J.colorAttachment.get());var de=function(xe,Ee,Ue){var Be=Ue.paint.get("hillshade-shadow-color"),Ke=Ue.paint.get("hillshade-highlight-color"),Oe=Ue.paint.get("hillshade-accent-color"),Qe=Ue.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ue.paint.get("hillshade-illumination-anchor")==="viewport"&&(Qe-=xe.transform.angle);var ft,xt,Ut,Bt=!xe.options.moving;return{u_matrix:xe.transform.calculatePosMatrix(Ee.tileID.toUnwrapped(),Bt),u_image:0,u_latrange:(ft=Ee.tileID,xt=Math.pow(2,ft.canonical.z),Ut=ft.canonical.y,[new o.MercatorCoordinate(0,Ut/xt).toLngLat().lat,new o.MercatorCoordinate(0,(Ut+1)/xt).toLngLat().lat]),u_light:[Ue.paint.get("hillshade-exaggeration"),Qe],u_shadow:Be,u_highlight:Ke,u_accent:Oe}}(y,b,_);se.draw(N,V.TRIANGLES,S,P,F,pt.disabled,de,_.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}}function Gc(y,b,_,S,P,F){var N=y.context,V=N.gl,J=b.dem;if(J&&J.data){var se=J.dim,de=J.stride,xe=J.getPixels();if(N.activeTexture.set(V.TEXTURE1),N.pixelStoreUnpackPremultiplyAlpha.set(!1),b.demTexture=b.demTexture||y.getTileTexture(de),b.demTexture){var Ee=b.demTexture;Ee.update(xe,{premultiply:!1}),Ee.bind(V.NEAREST,V.CLAMP_TO_EDGE)}else b.demTexture=new o.Texture(N,xe,V.RGBA,{premultiply:!1}),b.demTexture.bind(V.NEAREST,V.CLAMP_TO_EDGE);N.activeTexture.set(V.TEXTURE0);var Ue=b.fbo;if(!Ue){var Be=new o.Texture(N,{width:se,height:se,data:null},V.RGBA);Be.bind(V.LINEAR,V.CLAMP_TO_EDGE),(Ue=b.fbo=N.createFramebuffer(se,se,!0)).colorAttachment.set(Be.texture)}N.bindFramebuffer.set(Ue.framebuffer),N.viewport.set([0,0,se,se]),y.useProgram("hillshadePrepare").draw(N,V.TRIANGLES,S,P,F,pt.disabled,function(Ke,Oe){var Qe=Oe.stride,ft=o.create();return o.ortho(ft,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ft,ft,[0,-o.EXTENT,0]),{u_matrix:ft,u_image:1,u_dimension:[Qe,Qe],u_zoom:Ke.overscaledZ,u_unpack:Oe.getUnpackVector()}}(b.tileID,J),_.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),b.needsHillshadePrepare=!1}}function Qu(y,b,_,S,P){var F=S.paint.get("raster-fade-duration");if(F>0){var N=o.browser.now(),V=(N-y.timeAdded)/F,J=b?(N-b.timeAdded)/F:-1,se=_.getSource(),de=P.coveringZoomLevel({tileSize:se.tileSize,roundZoom:se.roundZoom}),xe=!b||Math.abs(b.tileID.overscaledZ-de)>Math.abs(y.tileID.overscaledZ-de),Ee=xe&&y.refreshedUponExpiration?1:o.clamp(xe?V:1-J,0,1);return y.refreshedUponExpiration&&V>=1&&(y.refreshedUponExpiration=!1),b?{opacity:1,mix:1-Ee}:{opacity:Ee,mix:0}}return{opacity:1,mix:0}}var cd=new o.Color(1,0,0,1),fd=new o.Color(0,1,0,1),Gy=new o.Color(0,0,1,1),cg=new o.Color(1,0,1,1),bm=new o.Color(0,1,1,1);function fv(y,b,_,S){bt(y,0,b+_/2,y.transform.width,_,S)}function kh(y,b,_,S){bt(y,b-_/2,0,_,y.transform.height,S)}function bt(y,b,_,S,P,F){var N=y.context,V=N.gl;V.enable(V.SCISSOR_TEST),V.scissor(b*o.browser.devicePixelRatio,_*o.browser.devicePixelRatio,S*o.browser.devicePixelRatio,P*o.browser.devicePixelRatio),N.clear({color:F}),V.disable(V.SCISSOR_TEST)}function lr(y,b,_){var S=y.context,P=S.gl,F=_.posMatrix,N=y.useProgram("debug"),V=Ce.disabled,J=Ne.disabled,se=y.colorModeForRenderPass();S.activeTexture.set(P.TEXTURE0),y.emptyTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),N.draw(S,P.LINE_STRIP,V,J,se,pt.disabled,Vc(F,o.Color.red),"$debug",y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments);var de=b.getTileByID(_.key).latestRawTileData,xe=Math.floor((de&&de.byteLength||0)/1024),Ee=b.getTile(_).tileSize,Ue=512/Math.min(Ee,512)*(_.overscaledZ/y.transform.zoom)*.5,Be=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(Be+=" => "+_.overscaledZ),function(Ke,Oe){Ke.initDebugOverlayCanvas();var Qe=Ke.debugOverlayCanvas,ft=Ke.context.gl,xt=Ke.debugOverlayCanvas.getContext("2d");xt.clearRect(0,0,Qe.width,Qe.height),xt.shadowColor="white",xt.shadowBlur=2,xt.lineWidth=1.5,xt.strokeStyle="white",xt.textBaseline="top",xt.font="bold 36px Open Sans, sans-serif",xt.fillText(Oe,5,5),xt.strokeText(Oe,5,5),Ke.debugOverlayTexture.update(Qe),Ke.debugOverlayTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE)}(y,Be+" "+xe+"kb"),N.draw(S,P.TRIANGLES,V,J,it.alphaBlended,pt.disabled,Vc(F,o.Color.transparent,Ue),"$debug",y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments)}var Xt={symbol:function(y,b,_,S,P){if(y.renderPass==="translucent"){var F=Ne.disabled,N=y.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(V,J,se,de,xe,Ee,Ue){for(var Be=J.transform,Ke=xe==="map",Oe=Ee==="map",Qe=0,ft=V;Qe<ft.length;Qe+=1){var xt=ft[Qe],Ut=de.getTile(xt),Bt=Ut.getBucket(se);if(Bt&&Bt.text&&Bt.text.segments.get().length){var Wt=o.evaluateSizeForZoom(Bt.textSizeData,Be.zoom),hr=Za(Ut,1,J.transform.zoom),yr=Ki(xt.posMatrix,Oe,Ke,J.transform,hr),Ir=se.layout.get("icon-text-fit")!=="none"&&Bt.hasIconData();if(Wt){var Kr=Math.pow(2,Be.zoom-Ut.tileID.overscaledZ);uv(Bt,Ke,Oe,Ue,o.symbolSize,Be,yr,xt.posMatrix,Kr,Wt,Ir)}}}}(S,y,_,b,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),P),_.paint.get("icon-opacity").constantOr(1)!==0&&fl(y,b,_,S,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),F,N),_.paint.get("text-opacity").constantOr(1)!==0&&fl(y,b,_,S,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),F,N),b.map.showCollisionBoxes&&(Hl(y,b,_,S,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),Hl(y,b,_,S,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))}},circle:function(y,b,_,S){if(y.renderPass==="translucent"){var P=_.paint.get("circle-opacity"),F=_.paint.get("circle-stroke-width"),N=_.paint.get("circle-stroke-opacity"),V=_.layout.get("circle-sort-key").constantOr(1)!==void 0;if(P.constantOr(1)!==0||F.constantOr(1)!==0&&N.constantOr(1)!==0){for(var J=y.context,se=J.gl,de=y.depthModeForSublayer(0,Ce.ReadOnly),xe=Ne.disabled,Ee=y.colorModeForRenderPass(),Ue=[],Be=0;Be<S.length;Be++){var Ke=S[Be],Oe=b.getTile(Ke),Qe=Oe.getBucket(_);if(Qe){var ft=Qe.programConfigurations.get(_.id),xt={programConfiguration:ft,program:y.useProgram("circle",ft),layoutVertexBuffer:Qe.layoutVertexBuffer,indexBuffer:Qe.indexBuffer,uniformValues:sv(y,Ke,Oe,_)};if(V)for(var Ut=0,Bt=Qe.segments.get();Ut<Bt.length;Ut+=1){var Wt=Bt[Ut];Ue.push({segments:new o.SegmentVector([Wt]),sortKey:Wt.sortKey,state:xt})}else Ue.push({segments:Qe.segments,sortKey:0,state:xt})}}V&&Ue.sort(function(An,Nn){return An.sortKey-Nn.sortKey});for(var hr=0,yr=Ue;hr<yr.length;hr+=1){var Ir=yr[hr],Kr=Ir.state;Kr.program.draw(J,se.TRIANGLES,de,xe,Ee,pt.disabled,Kr.uniformValues,_.id,Kr.layoutVertexBuffer,Kr.indexBuffer,Ir.segments,_.paint,y.transform.zoom,Kr.programConfiguration)}}}},heatmap:function(y,b,_,S){if(_.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){var P=y.context,F=P.gl,N=Ne.disabled,V=new it([F.ONE,F.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(Ue,Be,Ke){var Oe=Ue.gl;Ue.activeTexture.set(Oe.TEXTURE1),Ue.viewport.set([0,0,Be.width/4,Be.height/4]);var Qe=Ke.heatmapFbo;if(Qe)Oe.bindTexture(Oe.TEXTURE_2D,Qe.colorAttachment.get()),Ue.bindFramebuffer.set(Qe.framebuffer);else{var ft=Oe.createTexture();Oe.bindTexture(Oe.TEXTURE_2D,ft),Oe.texParameteri(Oe.TEXTURE_2D,Oe.TEXTURE_WRAP_S,Oe.CLAMP_TO_EDGE),Oe.texParameteri(Oe.TEXTURE_2D,Oe.TEXTURE_WRAP_T,Oe.CLAMP_TO_EDGE),Oe.texParameteri(Oe.TEXTURE_2D,Oe.TEXTURE_MIN_FILTER,Oe.LINEAR),Oe.texParameteri(Oe.TEXTURE_2D,Oe.TEXTURE_MAG_FILTER,Oe.LINEAR),Qe=Ke.heatmapFbo=Ue.createFramebuffer(Be.width/4,Be.height/4,!1),function(xt,Ut,Bt,Wt){var hr=xt.gl;hr.texImage2D(hr.TEXTURE_2D,0,hr.RGBA,Ut.width/4,Ut.height/4,0,hr.RGBA,xt.extRenderToTextureHalfFloat?xt.extTextureHalfFloat.HALF_FLOAT_OES:hr.UNSIGNED_BYTE,null),Wt.colorAttachment.set(Bt)}(Ue,Be,ft,Qe)}})(P,y,_),P.clear({color:o.Color.transparent});for(var J=0;J<S.length;J++){var se=S[J];if(!b.hasRenderableParent(se)){var de=b.getTile(se),xe=de.getBucket(_);if(xe){var Ee=xe.programConfigurations.get(_.id);y.useProgram("heatmap",Ee).draw(P,F.TRIANGLES,Ce.disabled,N,V,pt.disabled,Sp(se.posMatrix,de,y.transform.zoom,_.paint.get("heatmap-intensity")),_.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,_.paint,y.transform.zoom,Ee)}}}P.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(Ue,Be){var Ke=Ue.context,Oe=Ke.gl,Qe=Be.heatmapFbo;if(Qe){Ke.activeTexture.set(Oe.TEXTURE0),Oe.bindTexture(Oe.TEXTURE_2D,Qe.colorAttachment.get()),Ke.activeTexture.set(Oe.TEXTURE1);var ft=Be.colorRampTexture;ft||(ft=Be.colorRampTexture=new o.Texture(Ke,Be.colorRamp,Oe.RGBA)),ft.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),Ue.useProgram("heatmapTexture").draw(Ke,Oe.TRIANGLES,Ce.disabled,Ne.disabled,Ue.colorModeForRenderPass(),pt.disabled,function(xt,Ut,Bt,Wt){var hr=o.create();o.ortho(hr,0,xt.width,xt.height,0,0,1);var yr=xt.context.gl;return{u_matrix:hr,u_world:[yr.drawingBufferWidth,yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ut.paint.get("heatmap-opacity")}}(Ue,Be),Be.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments,Be.paint,Ue.transform.zoom)}}(y,_))},line:function(y,b,_,S){if(y.renderPass==="translucent"){var P=_.paint.get("line-opacity"),F=_.paint.get("line-width");if(P.constantOr(1)!==0&&F.constantOr(1)!==0)for(var N=y.depthModeForSublayer(0,Ce.ReadOnly),V=y.colorModeForRenderPass(),J=_.paint.get("line-dasharray"),se=_.paint.get("line-pattern"),de=se.constantOr(1),xe=_.paint.get("line-gradient"),Ee=_.getCrossfadeParameters(),Ue=de?"linePattern":J?"lineSDF":xe?"lineGradient":"line",Be=y.context,Ke=Be.gl,Oe=!0,Qe=0,ft=S;Qe<ft.length;Qe+=1){var xt=ft[Qe],Ut=b.getTile(xt);if(!de||Ut.patternsLoaded()){var Bt=Ut.getBucket(_);if(Bt){var Wt=Bt.programConfigurations.get(_.id),hr=y.context.program.get(),yr=y.useProgram(Ue,Wt),Ir=Oe||yr.program!==hr,Kr=se.constantOr(null);if(Kr&&Ut.imageAtlas){var An=Ut.imageAtlas,Nn=An.patternPositions[Kr.to.toString()],Dn=An.patternPositions[Kr.from.toString()];Nn&&Dn&&Wt.setConstantPatternPositions(Nn,Dn)}var sa=de?Lh(y,Ut,_,Ee):J?Vy(y,Ut,_,J,Ee):xe?Ga(y,Ut,_,Bt.lineClipsArray.length):Mh(y,Ut,_);if(de)Be.activeTexture.set(Ke.TEXTURE0),Ut.imageAtlasTexture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),Wt.updatePaintBuffers(Ee);else if(J&&(Ir||y.lineAtlas.dirty))Be.activeTexture.set(Ke.TEXTURE0),y.lineAtlas.bind(Be);else if(xe){var on=Bt.gradients[_.id],qn=on.texture;if(_.gradientVersion!==on.version){var di=256;if(_.stepInterpolant){var si=b.getSource().maxzoom,Jn=xt.canonical.z===si?Math.ceil(1<<y.transform.maxZoom-xt.canonical.z):1;di=o.clamp(o.nextPowerOfTwo(Bt.maxLineLength/o.EXTENT*1024*Jn),256,Be.maxTextureSize)}on.gradient=o.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:di,image:on.gradient||void 0,clips:Bt.lineClipsArray}),on.texture?on.texture.update(on.gradient):on.texture=new o.Texture(Be,on.gradient,Ke.RGBA),on.version=_.gradientVersion,qn=on.texture}Be.activeTexture.set(Ke.TEXTURE0),qn.bind(_.stepInterpolant?Ke.NEAREST:Ke.LINEAR,Ke.CLAMP_TO_EDGE)}yr.draw(Be,Ke.TRIANGLES,N,y.stencilModeForClipping(xt),V,pt.disabled,sa,_.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,_.paint,y.transform.zoom,Wt,Bt.layoutVertexBuffer2),Oe=!1}}}}},fill:function(y,b,_,S){var P=_.paint.get("fill-color"),F=_.paint.get("fill-opacity");if(F.constantOr(1)!==0){var N=y.colorModeForRenderPass(),V=_.paint.get("fill-pattern"),J=y.opaquePassEnabledForLayer()&&!V.constantOr(1)&&P.constantOr(o.Color.transparent).a===1&&F.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===J){var se=y.depthModeForSublayer(1,y.renderPass==="opaque"?Ce.ReadWrite:Ce.ReadOnly);lv(y,b,_,S,se,N,!1)}if(y.renderPass==="translucent"&&_.paint.get("fill-antialias")){var de=y.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,Ce.ReadOnly);lv(y,b,_,S,de,N,!0)}}},"fill-extrusion":function(y,b,_,S){var P=_.paint.get("fill-extrusion-opacity");if(P!==0&&y.renderPass==="translucent"){var F=new Ce(y.context.gl.LEQUAL,Ce.ReadWrite,y.depthRangeFor3D);if(P!==1||_.paint.get("fill-extrusion-pattern").constantOr(1))lg(y,b,_,S,F,Ne.disabled,it.disabled),lg(y,b,_,S,F,y.stencilModeFor3D(),y.colorModeForRenderPass());else{var N=y.colorModeForRenderPass();lg(y,b,_,S,F,Ne.disabled,N)}}},hillshade:function(y,b,_,S){if(y.renderPass==="offscreen"||y.renderPass==="translucent"){for(var P=y.context,F=y.depthModeForSublayer(0,Ce.ReadOnly),N=y.colorModeForRenderPass(),V=y.renderPass==="translucent"?y.stencilConfigForOverlap(S):[{},S],J=V[0],se=0,de=V[1];se<de.length;se+=1){var xe=de[se],Ee=b.getTile(xe);Ee.needsHillshadePrepare&&y.renderPass==="offscreen"?Gc(y,Ee,_,F,Ne.disabled,N):y.renderPass==="translucent"&&cv(y,Ee,_,F,J[xe.overscaledZ],N)}P.viewport.set([0,0,y.width,y.height])}},raster:function(y,b,_,S){if(y.renderPass==="translucent"&&_.paint.get("raster-opacity")!==0&&S.length)for(var P=y.context,F=P.gl,N=b.getSource(),V=y.useProgram("raster"),J=y.colorModeForRenderPass(),se=N instanceof ct?[{},S]:y.stencilConfigForOverlap(S),de=se[0],xe=se[1],Ee=xe[xe.length-1].overscaledZ,Ue=!y.options.moving,Be=0,Ke=xe;Be<Ke.length;Be+=1){var Oe=Ke[Be],Qe=y.depthModeForSublayer(Oe.overscaledZ-Ee,_.paint.get("raster-opacity")===1?Ce.ReadWrite:Ce.ReadOnly,F.LESS),ft=b.getTile(Oe),xt=y.transform.calculatePosMatrix(Oe.toUnwrapped(),Ue);ft.registerFadeDuration(_.paint.get("raster-fade-duration"));var Ut=b.findLoadedParent(Oe,0),Bt=Qu(ft,Ut,b,_,y.transform),Wt=void 0,hr=void 0,yr=_.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;P.activeTexture.set(F.TEXTURE0),ft.texture.bind(yr,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),P.activeTexture.set(F.TEXTURE1),Ut?(Ut.texture.bind(yr,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),Wt=Math.pow(2,Ut.tileID.overscaledZ-ft.tileID.overscaledZ),hr=[ft.tileID.canonical.x*Wt%1,ft.tileID.canonical.y*Wt%1]):ft.texture.bind(yr,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);var Ir=_m(xt,hr||[0,0],Wt||1,Bt,_);N instanceof ct?V.draw(P,F.TRIANGLES,Qe,Ne.disabled,J,pt.disabled,Ir,_.id,N.boundsBuffer,y.quadTriangleIndexBuffer,N.boundsSegments):V.draw(P,F.TRIANGLES,Qe,de[Oe.overscaledZ],J,pt.disabled,Ir,_.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}},background:function(y,b,_){var S=_.paint.get("background-color"),P=_.paint.get("background-opacity");if(P!==0){var F=y.context,N=F.gl,V=y.transform,J=V.tileSize,se=_.paint.get("background-pattern");if(!y.isPatternMissing(se)){var de=!se&&S.a===1&&P===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass===de){var xe=Ne.disabled,Ee=y.depthModeForSublayer(0,de==="opaque"?Ce.ReadWrite:Ce.ReadOnly),Ue=y.colorModeForRenderPass(),Be=y.useProgram(se?"backgroundPattern":"background"),Ke=V.coveringTiles({tileSize:J});se&&(F.activeTexture.set(N.TEXTURE0),y.imageManager.bind(y.context));for(var Oe=_.getCrossfadeParameters(),Qe=0,ft=Ke;Qe<ft.length;Qe+=1){var xt=ft[Qe],Ut=y.transform.calculatePosMatrix(xt.toUnwrapped()),Bt=se?Ih(Ut,P,y,se,{tileID:xt,tileSize:J},Oe):bf(Ut,P,S);Be.draw(F,N.TRIANGLES,Ee,xe,Ue,pt.disabled,Bt,_.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}}}},debug:function(y,b,_){for(var S=0;S<_.length;S++)lr(y,b,_[S])},custom:function(y,b,_){var S=y.context,P=_.implementation;if(y.renderPass==="offscreen"){var F=P.prerender;F&&(y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),F.call(P,S.gl,y.transform.customLayerMatrix()),S.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),S.setStencilMode(Ne.disabled);var N=P.renderingMode==="3d"?new Ce(y.context.gl.LEQUAL,Ce.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Ce.ReadOnly);S.setDepthMode(N),P.render(S.gl,y.transform.customLayerMatrix()),S.setDirty(),y.setBaseState(),S.bindFramebuffer.set(null)}}},Jr=function(y,b){this.context=new _e(y),this.transform=b,this._tileTextures={},this.setup(),this.numSublayers=Ge.maxUnderzooming+Ge.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bh,this.gpuTimers={}};Jr.prototype.resize=function(y,b){if(this.width=y*o.browser.devicePixelRatio,this.height=b*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var _=0,S=this.style._order;_<S.length;_+=1)this.style._layers[S[_]].resize()},Jr.prototype.setup=function(){var y=this.context,b=new o.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(o.EXTENT,0),b.emplaceBack(0,o.EXTENT),b.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=y.createVertexBuffer(b,us.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var _=new o.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(o.EXTENT,0),_.emplaceBack(0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=y.createVertexBuffer(_,us.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var S=new o.StructArrayLayout4i8;S.emplaceBack(0,0,0,0),S.emplaceBack(o.EXTENT,0,o.EXTENT,0),S.emplaceBack(0,o.EXTENT,0,o.EXTENT),S.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=y.createVertexBuffer(S,dt.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var P=new o.StructArrayLayout2i4;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=y.createVertexBuffer(P,us.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var F=new o.StructArrayLayout1ui2;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=y.createIndexBuffer(F);var N=new o.StructArrayLayout3ui6;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=y.createIndexBuffer(N),this.emptyTexture=new o.Texture(y,{width:1,height:1,data:new Uint8Array([0,0,0,0])},y.gl.RGBA);var V=this.context.gl;this.stencilClearMode=new Ne({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO)},Jr.prototype.clearStencil=function(){var y=this.context,b=y.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var _=o.create();o.ortho(_,0,this.width,this.height,0,0,1),o.scale(_,_,[b.drawingBufferWidth,b.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(y,b.TRIANGLES,Ce.disabled,this.stencilClearMode,it.disabled,pt.disabled,lc(_),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Jr.prototype._renderTileClippingMasks=function(y,b){if(this.currentStencilSource!==y.source&&y.isTileClipped()&&b&&b.length){this.currentStencilSource=y.source;var _=this.context,S=_.gl;this.nextStencilID+b.length>256&&this.clearStencil(),_.setColorMode(it.disabled),_.setDepthMode(Ce.disabled);var P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var F=0,N=b;F<N.length;F+=1){var V=N[F],J=this._tileClippingMaskIDs[V.key]=this.nextStencilID++;P.draw(_,S.TRIANGLES,Ce.disabled,new Ne({func:S.ALWAYS,mask:0},J,255,S.KEEP,S.KEEP,S.REPLACE),it.disabled,pt.disabled,lc(V.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Jr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var y=this.nextStencilID++,b=this.context.gl;return new Ne({func:b.NOTEQUAL,mask:255},y,255,b.KEEP,b.KEEP,b.REPLACE)},Jr.prototype.stencilModeForClipping=function(y){var b=this.context.gl;return new Ne({func:b.EQUAL,mask:255},this._tileClippingMaskIDs[y.key],0,b.KEEP,b.KEEP,b.REPLACE)},Jr.prototype.stencilConfigForOverlap=function(y){var b,_=this.context.gl,S=y.sort(function(J,se){return se.overscaledZ-J.overscaledZ}),P=S[S.length-1].overscaledZ,F=S[0].overscaledZ-P+1;if(F>1){this.currentStencilSource=void 0,this.nextStencilID+F>256&&this.clearStencil();for(var N={},V=0;V<F;V++)N[V+P]=new Ne({func:_.GEQUAL,mask:255},V+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=F,[N,S]}return[(b={},b[P]=Ne.disabled,b),S]},Jr.prototype.colorModeForRenderPass=function(){var y=this.context.gl;return this._showOverdrawInspector?new it([y.CONSTANT_COLOR,y.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?it.unblended:it.alphaBlended},Jr.prototype.depthModeForSublayer=function(y,b,_){if(!this.opaquePassEnabledForLayer())return Ce.disabled;var S=1-((1+this.currentLayer)*this.numSublayers+y)*this.depthEpsilon;return new Ce(_||this.context.gl.LEQUAL,b,[S,S])},Jr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Jr.prototype.render=function(y,b){var _=this;this.style=y,this.options=b,this.lineAtlas=y.lineAtlas,this.imageManager=y.imageManager,this.glyphManager=y.glyphManager,this.symbolFadeChange=y.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var S=this.style._order,P=this.style.sourceCaches;for(var F in P){var N=P[F];N.used&&N.prepare(this.context)}var V,J,se={},de={},xe={};for(var Ee in P){var Ue=P[Ee];se[Ee]=Ue.getVisibleCoordinates(),de[Ee]=se[Ee].slice().reverse(),xe[Ee]=Ue.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Be=0;Be<S.length;Be++)if(this.style._layers[S[Be]].is3D()){this.opaquePassCutoff=Be;break}this.renderPass="offscreen";for(var Ke=0,Oe=S;Ke<Oe.length;Ke+=1){var Qe=this.style._layers[Oe[Ke]];if(Qe.hasOffscreenPass()&&!Qe.isHidden(this.transform.zoom)){var ft=de[Qe.source];(Qe.type==="custom"||ft.length)&&this.renderLayer(this,P[Qe.source],Qe,ft)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:b.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=b.showOverdrawInspector,this.depthRangeFor3D=[0,1-(y._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){var xt=this.style._layers[S[this.currentLayer]],Ut=P[xt.source],Bt=se[xt.source];this._renderTileClippingMasks(xt,Bt),this.renderLayer(this,Ut,xt,Bt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){var Wt=this.style._layers[S[this.currentLayer]],hr=P[Wt.source],yr=(Wt.type==="symbol"?xe:de)[Wt.source];this._renderTileClippingMasks(Wt,se[Wt.source]),this.renderLayer(this,hr,Wt,yr)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Ir){Ir.source&&!Ir.isHidden(_.transform.zoom)&&(Ir.source!==(J&&J.id)&&(J=_.style.sourceCaches[Ir.source]),(!V||V.getSource().maxzoom<J.getSource().maxzoom)&&(V=J))}),V&&Xt.debug(this,V,V.getVisibleCoordinates())),this.options.showPadding&&function(Ir){var Kr=Ir.transform.padding;fv(Ir,Ir.transform.height-(Kr.top||0),3,cd),fv(Ir,Kr.bottom||0,3,fd),kh(Ir,Kr.left||0,3,Gy),kh(Ir,Ir.transform.width-(Kr.right||0),3,cg);var An=Ir.transform.centerPoint;(function(Nn,Dn,sa,on){bt(Nn,Dn-1,sa-10,2,20,on),bt(Nn,Dn-10,sa-1,20,2,on)})(Ir,An.x,Ir.transform.height-An.y,bm)}(this),this.context.setDefault()},Jr.prototype.renderLayer=function(y,b,_,S){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="custom"||S.length)&&(this.id=_.id,this.gpuTimingStart(_),Xt[_.type](y,b,_,S,this.style.placement.variableOffsets),this.gpuTimingEnd())},Jr.prototype.gpuTimingStart=function(y){if(this.options.gpuTiming){var b=this.context.extTimerQuery,_=this.gpuTimers[y.id];_||(_=this.gpuTimers[y.id]={calls:0,cpuTime:0,query:b.createQueryEXT()}),_.calls++,b.beginQueryEXT(b.TIME_ELAPSED_EXT,_.query)}},Jr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var y=this.context.extTimerQuery;y.endQueryEXT(y.TIME_ELAPSED_EXT)}},Jr.prototype.collectGpuTimers=function(){var y=this.gpuTimers;return this.gpuTimers={},y},Jr.prototype.queryGpuTimers=function(y){var b={};for(var _ in y){var S=y[_],P=this.context.extTimerQuery,F=P.getQueryObjectEXT(S.query,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(S.query),b[_]=F}return b},Jr.prototype.translatePosMatrix=function(y,b,_,S,P){if(!_[0]&&!_[1])return y;var F=P?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(F){var N=Math.sin(F),V=Math.cos(F);_=[_[0]*V-_[1]*N,_[0]*N+_[1]*V]}var J=[P?_[0]:Za(b,_[0],this.transform.zoom),P?_[1]:Za(b,_[1],this.transform.zoom),0],se=new Float32Array(16);return o.translate(se,y,J),se},Jr.prototype.saveTileTexture=function(y){var b=this._tileTextures[y.size[0]];b?b.push(y):this._tileTextures[y.size[0]]=[y]},Jr.prototype.getTileTexture=function(y){var b=this._tileTextures[y];return b&&b.length>0?b.pop():null},Jr.prototype.isPatternMissing=function(y){if(!y)return!1;if(!y.from||!y.to)return!0;var b=this.imageManager.getPattern(y.from.toString()),_=this.imageManager.getPattern(y.to.toString());return!b||!_},Jr.prototype.useProgram=function(y,b){this.cache=this.cache||{};var _=""+y+(b?b.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[_]||(this.cache[_]=new ym(this.context,y,ls[y],b,sg[y],this._showOverdrawInspector)),this.cache[_]},Jr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Jr.prototype.setBaseState=function(){var y=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(y.FUNC_ADD)},Jr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Jr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ii=function(y,b){this.points=y,this.planes=b};Ii.fromInvProjectionMatrix=function(y,b,_){var S=Math.pow(2,_),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(N){return o.transformMat4([],N,y)}).map(function(N){return o.scale$1([],N,1/N[3]/b*S)}),F=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(N){var V=o.sub([],P[N[0]],P[N[1]]),J=o.sub([],P[N[2]],P[N[1]]),se=o.normalize([],o.cross([],V,J)),de=-o.dot(se,P[N[1]]);return se.concat(de)});return new Ii(P,F)};var ga=function(y,b){this.min=y,this.max=b,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};ga.prototype.quadrant=function(y){for(var b=[y%2==0,y<2],_=o.clone$2(this.min),S=o.clone$2(this.max),P=0;P<b.length;P++)_[P]=b[P]?this.min[P]:this.center[P],S[P]=b[P]?this.center[P]:this.max[P];return S[2]=this.max[2],new ga(_,S)},ga.prototype.distanceX=function(y){return Math.max(Math.min(this.max[0],y[0]),this.min[0])-y[0]},ga.prototype.distanceY=function(y){return Math.max(Math.min(this.max[1],y[1]),this.min[1])-y[1]},ga.prototype.intersects=function(y){for(var b=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],_=!0,S=0;S<y.planes.length;S++){for(var P=y.planes[S],F=0,N=0;N<b.length;N++)F+=o.dot$1(P,b[N])>=0;if(F===0)return 0;F!==b.length&&(_=!1)}if(_)return 2;for(var V=0;V<3;V++){for(var J=Number.MAX_VALUE,se=-Number.MAX_VALUE,de=0;de<y.points.length;de++){var xe=y.points[de][V]-this.min[V];J=Math.min(J,xe),se=Math.max(se,xe)}if(se<0||J>this.max[V]-this.min[V])return 0}return 1};var To=function(y,b,_,S){if(y===void 0&&(y=0),b===void 0&&(b=0),_===void 0&&(_=0),S===void 0&&(S=0),isNaN(y)||y<0||isNaN(b)||b<0||isNaN(_)||_<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=y,this.bottom=b,this.left=_,this.right=S};To.prototype.interpolate=function(y,b,_){return b.top!=null&&y.top!=null&&(this.top=o.number(y.top,b.top,_)),b.bottom!=null&&y.bottom!=null&&(this.bottom=o.number(y.bottom,b.bottom,_)),b.left!=null&&y.left!=null&&(this.left=o.number(y.left,b.left,_)),b.right!=null&&y.right!=null&&(this.right=o.number(y.right,b.right,_)),this},To.prototype.getCenter=function(y,b){var _=o.clamp((this.left+y-this.right)/2,0,y),S=o.clamp((this.top+b-this.bottom)/2,0,b);return new o.Point(_,S)},To.prototype.equals=function(y){return this.top===y.top&&this.bottom===y.bottom&&this.left===y.left&&this.right===y.right},To.prototype.clone=function(){return new To(this.top,this.bottom,this.left,this.right)},To.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Un=function(y,b,_,S,P){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=P===void 0||P,this._minZoom=y||0,this._maxZoom=b||22,this._minPitch=_==null?0:_,this._maxPitch=S==null?60:S,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new To,this._posMatrixCache={},this._alignedPosMatrixCache={}},qa={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Un.prototype.clone=function(){var y=new Un(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return y.tileSize=this.tileSize,y.latRange=this.latRange,y.width=this.width,y.height=this.height,y._center=this._center,y.zoom=this.zoom,y.angle=this.angle,y._fov=this._fov,y._pitch=this._pitch,y._unmodified=this._unmodified,y._edgeInsets=this._edgeInsets.clone(),y._calcMatrices(),y},qa.minZoom.get=function(){return this._minZoom},qa.minZoom.set=function(y){this._minZoom!==y&&(this._minZoom=y,this.zoom=Math.max(this.zoom,y))},qa.maxZoom.get=function(){return this._maxZoom},qa.maxZoom.set=function(y){this._maxZoom!==y&&(this._maxZoom=y,this.zoom=Math.min(this.zoom,y))},qa.minPitch.get=function(){return this._minPitch},qa.minPitch.set=function(y){this._minPitch!==y&&(this._minPitch=y,this.pitch=Math.max(this.pitch,y))},qa.maxPitch.get=function(){return this._maxPitch},qa.maxPitch.set=function(y){this._maxPitch!==y&&(this._maxPitch=y,this.pitch=Math.min(this.pitch,y))},qa.renderWorldCopies.get=function(){return this._renderWorldCopies},qa.renderWorldCopies.set=function(y){y===void 0?y=!0:y===null&&(y=!1),this._renderWorldCopies=y},qa.worldSize.get=function(){return this.tileSize*this.scale},qa.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},qa.size.get=function(){return new o.Point(this.width,this.height)},qa.bearing.get=function(){return-this.angle/Math.PI*180},qa.bearing.set=function(y){var b=-o.wrap(y,-180,180)*Math.PI/180;this.angle!==b&&(this._unmodified=!1,this.angle=b,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},qa.pitch.get=function(){return this._pitch/Math.PI*180},qa.pitch.set=function(y){var b=o.clamp(y,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==b&&(this._unmodified=!1,this._pitch=b,this._calcMatrices())},qa.fov.get=function(){return this._fov/Math.PI*180},qa.fov.set=function(y){y=Math.max(.01,Math.min(60,y)),this._fov!==y&&(this._unmodified=!1,this._fov=y/180*Math.PI,this._calcMatrices())},qa.zoom.get=function(){return this._zoom},qa.zoom.set=function(y){var b=Math.min(Math.max(y,this.minZoom),this.maxZoom);this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this.scale=this.zoomScale(b),this.tileZoom=Math.floor(b),this.zoomFraction=b-this.tileZoom,this._constrain(),this._calcMatrices())},qa.center.get=function(){return this._center},qa.center.set=function(y){y.lat===this._center.lat&&y.lng===this._center.lng||(this._unmodified=!1,this._center=y,this._constrain(),this._calcMatrices())},qa.padding.get=function(){return this._edgeInsets.toJSON()},qa.padding.set=function(y){this._edgeInsets.equals(y)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,y,1),this._calcMatrices())},qa.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Un.prototype.isPaddingEqual=function(y){return this._edgeInsets.equals(y)},Un.prototype.interpolatePadding=function(y,b,_){this._unmodified=!1,this._edgeInsets.interpolate(y,b,_),this._constrain(),this._calcMatrices()},Un.prototype.coveringZoomLevel=function(y){var b=(y.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/y.tileSize));return Math.max(0,b)},Un.prototype.getVisibleUnwrappedCoordinates=function(y){var b=[new o.UnwrappedTileID(0,y)];if(this._renderWorldCopies)for(var _=this.pointCoordinate(new o.Point(0,0)),S=this.pointCoordinate(new o.Point(this.width,0)),P=this.pointCoordinate(new o.Point(this.width,this.height)),F=this.pointCoordinate(new o.Point(0,this.height)),N=Math.floor(Math.min(_.x,S.x,P.x,F.x)),V=Math.floor(Math.max(_.x,S.x,P.x,F.x)),J=N-1;J<=V+1;J++)J!==0&&b.push(new o.UnwrappedTileID(J,y));return b},Un.prototype.coveringTiles=function(y){var b=this.coveringZoomLevel(y),_=b;if(y.minzoom!==void 0&&b<y.minzoom)return[];y.maxzoom!==void 0&&b>y.maxzoom&&(b=y.maxzoom);var S=o.MercatorCoordinate.fromLngLat(this.center),P=Math.pow(2,b),F=[P*S.x,P*S.y,0],N=Ii.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,b),V=y.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(V=b);var J=function(Ir){return{aabb:new ga([Ir*P,0,0],[(Ir+1)*P,P,0]),zoom:0,x:0,y:0,wrap:Ir,fullyVisible:!1}},se=[],de=[],xe=b,Ee=y.reparseOverscaled?_:b;if(this._renderWorldCopies)for(var Ue=1;Ue<=3;Ue++)se.push(J(-Ue)),se.push(J(Ue));for(se.push(J(0));se.length>0;){var Be=se.pop(),Ke=Be.x,Oe=Be.y,Qe=Be.fullyVisible;if(!Qe){var ft=Be.aabb.intersects(N);if(ft===0)continue;Qe=ft===2}var xt=Be.aabb.distanceX(F),Ut=Be.aabb.distanceY(F),Bt=Math.max(Math.abs(xt),Math.abs(Ut));if(Be.zoom===xe||Bt>3+(1<<xe-Be.zoom)-2&&Be.zoom>=V)de.push({tileID:new o.OverscaledTileID(Be.zoom===xe?Ee:Be.zoom,Be.wrap,Be.zoom,Ke,Oe),distanceSq:o.sqrLen([F[0]-.5-Ke,F[1]-.5-Oe])});else for(var Wt=0;Wt<4;Wt++){var hr=(Ke<<1)+Wt%2,yr=(Oe<<1)+(Wt>>1);se.push({aabb:Be.aabb.quadrant(Wt),zoom:Be.zoom+1,x:hr,y:yr,wrap:Be.wrap,fullyVisible:Qe})}}return de.sort(function(Ir,Kr){return Ir.distanceSq-Kr.distanceSq}).map(function(Ir){return Ir.tileID})},Un.prototype.resize=function(y,b){this.width=y,this.height=b,this.pixelsToGLUnits=[2/y,-2/b],this._constrain(),this._calcMatrices()},qa.unmodified.get=function(){return this._unmodified},Un.prototype.zoomScale=function(y){return Math.pow(2,y)},Un.prototype.scaleZoom=function(y){return Math.log(y)/Math.LN2},Un.prototype.project=function(y){var b=o.clamp(y.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(y.lng)*this.worldSize,o.mercatorYfromLat(b)*this.worldSize)},Un.prototype.unproject=function(y){return new o.MercatorCoordinate(y.x/this.worldSize,y.y/this.worldSize).toLngLat()},qa.point.get=function(){return this.project(this.center)},Un.prototype.setLocationAtPoint=function(y,b){var _=this.pointCoordinate(b),S=this.pointCoordinate(this.centerPoint),P=this.locationCoordinate(y),F=new o.MercatorCoordinate(P.x-(_.x-S.x),P.y-(_.y-S.y));this.center=this.coordinateLocation(F),this._renderWorldCopies&&(this.center=this.center.wrap())},Un.prototype.locationPoint=function(y){return this.coordinatePoint(this.locationCoordinate(y))},Un.prototype.pointLocation=function(y){return this.coordinateLocation(this.pointCoordinate(y))},Un.prototype.locationCoordinate=function(y){return o.MercatorCoordinate.fromLngLat(y)},Un.prototype.coordinateLocation=function(y){return y.toLngLat()},Un.prototype.pointCoordinate=function(y){var b=[y.x,y.y,0,1],_=[y.x,y.y,1,1];o.transformMat4(b,b,this.pixelMatrixInverse),o.transformMat4(_,_,this.pixelMatrixInverse);var S=b[3],P=_[3],F=b[1]/S,N=_[1]/P,V=b[2]/S,J=_[2]/P,se=V===J?0:(0-V)/(J-V);return new o.MercatorCoordinate(o.number(b[0]/S,_[0]/P,se)/this.worldSize,o.number(F,N,se)/this.worldSize)},Un.prototype.coordinatePoint=function(y){var b=[y.x*this.worldSize,y.y*this.worldSize,0,1];return o.transformMat4(b,b,this.pixelMatrix),new o.Point(b[0]/b[3],b[1]/b[3])},Un.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},Un.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Un.prototype.setMaxBounds=function(y){y?(this.lngRange=[y.getWest(),y.getEast()],this.latRange=[y.getSouth(),y.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Un.prototype.calculatePosMatrix=function(y,b){b===void 0&&(b=!1);var _=y.key,S=b?this._alignedPosMatrixCache:this._posMatrixCache;if(S[_])return S[_];var P=y.canonical,F=this.worldSize/this.zoomScale(P.z),N=P.x+Math.pow(2,P.z)*y.wrap,V=o.identity(new Float64Array(16));return o.translate(V,V,[N*F,P.y*F,0]),o.scale(V,V,[F/o.EXTENT,F/o.EXTENT,1]),o.multiply(V,b?this.alignedProjMatrix:this.projMatrix,V),S[_]=new Float32Array(V),S[_]},Un.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Un.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var y,b,_,S,P=-90,F=90,N=-180,V=180,J=this.size,se=this._unmodified;if(this.latRange){var de=this.latRange;P=o.mercatorYfromLat(de[1])*this.worldSize,y=(F=o.mercatorYfromLat(de[0])*this.worldSize)-P<J.y?J.y/(F-P):0}if(this.lngRange){var xe=this.lngRange;N=o.mercatorXfromLng(xe[0])*this.worldSize,b=(V=o.mercatorXfromLng(xe[1])*this.worldSize)-N<J.x?J.x/(V-N):0}var Ee=this.point,Ue=Math.max(b||0,y||0);if(Ue)return this.center=this.unproject(new o.Point(b?(V+N)/2:Ee.x,y?(F+P)/2:Ee.y)),this.zoom+=this.scaleZoom(Ue),this._unmodified=se,void(this._constraining=!1);if(this.latRange){var Be=Ee.y,Ke=J.y/2;Be-Ke<P&&(S=P+Ke),Be+Ke>F&&(S=F-Ke)}if(this.lngRange){var Oe=Ee.x,Qe=J.x/2;Oe-Qe<N&&(_=N+Qe),Oe+Qe>V&&(_=V-Qe)}_===void 0&&S===void 0||(this.center=this.unproject(new o.Point(_!==void 0?_:Ee.x,S!==void 0?S:Ee.y))),this._unmodified=se,this._constraining=!1}},Un.prototype._calcMatrices=function(){if(this.height){var y=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var b=Math.PI/2+this._pitch,_=this._fov*(.5+y.y/this.height),S=Math.sin(_)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-b-_,.01,Math.PI-.01)),P=this.point,F=P.x,N=P.y,V=1.01*(Math.cos(Math.PI/2-this._pitch)*S+this.cameraToCenterDistance),J=this.height/50,se=new Float64Array(16);o.perspective(se,this._fov,this.width/this.height,J,V),se[8]=2*-y.x/this.width,se[9]=2*y.y/this.height,o.scale(se,se,[1,-1,1]),o.translate(se,se,[0,0,-this.cameraToCenterDistance]),o.rotateX(se,se,this._pitch),o.rotateZ(se,se,this.angle),o.translate(se,se,[-F,-N,0]),this.mercatorMatrix=o.scale([],se,[this.worldSize,this.worldSize,this.worldSize]),o.scale(se,se,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=se,this.invProjMatrix=o.invert([],this.projMatrix);var de=this.width%2/2,xe=this.height%2/2,Ee=Math.cos(this.angle),Ue=Math.sin(this.angle),Be=F-Math.round(F)+Ee*de+Ue*xe,Ke=N-Math.round(N)+Ee*xe+Ue*de,Oe=new Float64Array(se);if(o.translate(Oe,Oe,[Be>.5?Be-1:Be,Ke>.5?Ke-1:Ke,0]),this.alignedProjMatrix=Oe,se=o.create(),o.scale(se,se,[this.width/2,-this.height/2,1]),o.translate(se,se,[1,-1,0]),this.labelPlaneMatrix=se,se=o.create(),o.scale(se,se,[1,-1,1]),o.translate(se,se,[-1,-1,0]),o.scale(se,se,[2/this.width,2/this.height,1]),this.glCoordMatrix=se,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(se=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=se,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Un.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var y=this.pointCoordinate(new o.Point(0,0)),b=[y.x*this.worldSize,y.y*this.worldSize,0,1];return o.transformMat4(b,b,this.pixelMatrix)[3]/this.cameraToCenterDistance},Un.prototype.getCameraPoint=function(){var y=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,y))},Un.prototype.getCameraQueryGeometry=function(y){var b=this.getCameraPoint();if(y.length===1)return[y[0],b];for(var _=b.x,S=b.y,P=b.x,F=b.y,N=0,V=y;N<V.length;N+=1){var J=V[N];_=Math.min(_,J.x),S=Math.min(S,J.y),P=Math.max(P,J.x),F=Math.max(F,J.y)}return[new o.Point(_,S),new o.Point(P,S),new o.Point(P,F),new o.Point(_,F),new o.Point(_,S)]},Object.defineProperties(Un.prototype,qa);var Ju=function(y){var b,_,S,P;this._hashName=y&&encodeURIComponent(y),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(b=this._updateHashUnthrottled.bind(this),_=!1,S=null,P=function(){S=null,_&&(b(),S=setTimeout(P,300),_=!1)},function(){return _=!0,S||P(),S})};Ju.prototype.addTo=function(y){return this._map=y,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ju.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ju.prototype.getHashString=function(y){var b=this._map.getCenter(),_=Math.round(100*this._map.getZoom())/100,S=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,S),F=Math.round(b.lng*P)/P,N=Math.round(b.lat*P)/P,V=this._map.getBearing(),J=this._map.getPitch(),se="";if(se+=y?"/"+F+"/"+N+"/"+_:_+"/"+N+"/"+F,(V||J)&&(se+="/"+Math.round(10*V)/10),J&&(se+="/"+Math.round(J)),this._hashName){var de=this._hashName,xe=!1,Ee=o.window.location.hash.slice(1).split("&").map(function(Ue){var Be=Ue.split("=")[0];return Be===de?(xe=!0,Be+"="+se):Ue}).filter(function(Ue){return Ue});return xe||Ee.push(de+"="+se),"#"+Ee.join("&")}return"#"+se},Ju.prototype._getCurrentHash=function(){var y,b=this,_=o.window.location.hash.replace("#","");return this._hashName?(_.split("&").map(function(S){return S.split("=")}).forEach(function(S){S[0]===b._hashName&&(y=S)}),(y&&y[1]||"").split("/")):_.split("/")},Ju.prototype._onHashChange=function(){var y=this._getCurrentHash();if(y.length>=3&&!y.some(function(_){return isNaN(_)})){var b=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(y[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+y[2],+y[1]],zoom:+y[0],bearing:b,pitch:+(y[4]||0)}),!0}return!1},Ju.prototype._updateHashUnthrottled=function(){var y=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,y)}catch{}};var el={linearity:.3,easing:o.bezier(0,0,.3,1)},Wf=o.extend({deceleration:2500,maxSpeed:1400},el),hv=o.extend({deceleration:20,maxSpeed:1400},el),hd=o.extend({deceleration:1e3,maxSpeed:360},el),fg=o.extend({deceleration:1e3,maxSpeed:90},el),Ph=function(y){this._map=y,this.clear()};function Fa(y,b){(!y.duration||y.duration<b.duration)&&(y.duration=b.duration,y.easing=b.easing)}function wf(y,b,_){var S=_.maxSpeed,P=_.linearity,F=_.deceleration,N=o.clamp(y*P/(b/1e3),-S,S),V=Math.abs(N)/(F*P);return{easing:_.easing,duration:1e3*V,amount:N*(V/2)}}Ph.prototype.clear=function(){this._inertiaBuffer=[]},Ph.prototype.record=function(y){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:y})},Ph.prototype._drainInertiaBuffer=function(){for(var y=this._inertiaBuffer,b=o.browser.now();y.length>0&&b-y[0].time>160;)y.shift()},Ph.prototype._onMoveEnd=function(y){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var b={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},_=0,S=this._inertiaBuffer;_<S.length;_+=1){var P=S[_].settings;b.zoom+=P.zoomDelta||0,b.bearing+=P.bearingDelta||0,b.pitch+=P.pitchDelta||0,P.panDelta&&b.pan._add(P.panDelta),P.around&&(b.around=P.around),P.pinchAround&&(b.pinchAround=P.pinchAround)}var F=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,N={};if(b.pan.mag()){var V=wf(b.pan.mag(),F,o.extend({},Wf,y||{}));N.offset=b.pan.mult(V.amount/b.pan.mag()),N.center=this._map.transform.center,Fa(N,V)}if(b.zoom){var J=wf(b.zoom,F,hv);N.zoom=this._map.transform.zoom+J.amount,Fa(N,J)}if(b.bearing){var se=wf(b.bearing,F,hd);N.bearing=this._map.transform.bearing+o.clamp(se.amount,-179,179),Fa(N,se)}if(b.pitch){var de=wf(b.pitch,F,fg);N.pitch=this._map.transform.pitch+de.amount,Fa(N,de)}if(N.zoom||N.bearing){var xe=b.pinchAround===void 0?b.around:b.pinchAround;N.around=xe?this._map.unproject(xe):this._map.getCenter()}return this.clear(),o.extend(N,{noMoveStart:!0})}};var Do=function(y){function b(S,P,F,N){N===void 0&&(N={});var V=u.mousePos(P.getCanvasContainer(),F),J=P.unproject(V);y.call(this,S,o.extend({point:V,lngLat:J,originalEvent:F},N)),this._defaultPrevented=!1,this.target=P}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},_.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,_),b}(o.Event),Rh=function(y){function b(S,P,F){var N=S==="touchend"?F.changedTouches:F.touches,V=u.touchPos(P.getCanvasContainer(),N),J=V.map(function(xe){return P.unproject(xe)}),se=V.reduce(function(xe,Ee,Ue,Be){return xe.add(Ee.div(Be.length))},new o.Point(0,0)),de=P.unproject(se);y.call(this,S,{points:V,point:se,lngLats:J,lngLat:de,originalEvent:F}),this._defaultPrevented=!1}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},_.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,_),b}(o.Event),pv=function(y){function b(S,P,F){y.call(this,S,{originalEvent:F}),this._defaultPrevented=!1}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},_.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,_),b}(o.Event),Da=function(y,b){this._map=y,this._clickTolerance=b.clickTolerance};Da.prototype.reset=function(){delete this._mousedownPos},Da.prototype.wheel=function(y){return this._firePreventable(new pv(y.type,this._map,y))},Da.prototype.mousedown=function(y,b){return this._mousedownPos=b,this._firePreventable(new Do(y.type,this._map,y))},Da.prototype.mouseup=function(y){this._map.fire(new Do(y.type,this._map,y))},Da.prototype.click=function(y,b){this._mousedownPos&&this._mousedownPos.dist(b)>=this._clickTolerance||this._map.fire(new Do(y.type,this._map,y))},Da.prototype.dblclick=function(y){return this._firePreventable(new Do(y.type,this._map,y))},Da.prototype.mouseover=function(y){this._map.fire(new Do(y.type,this._map,y))},Da.prototype.mouseout=function(y){this._map.fire(new Do(y.type,this._map,y))},Da.prototype.touchstart=function(y){return this._firePreventable(new Rh(y.type,this._map,y))},Da.prototype.touchmove=function(y){this._map.fire(new Rh(y.type,this._map,y))},Da.prototype.touchend=function(y){this._map.fire(new Rh(y.type,this._map,y))},Da.prototype.touchcancel=function(y){this._map.fire(new Rh(y.type,this._map,y))},Da.prototype._firePreventable=function(y){if(this._map.fire(y),y.defaultPrevented)return{}},Da.prototype.isEnabled=function(){return!0},Da.prototype.isActive=function(){return!1},Da.prototype.enable=function(){},Da.prototype.disable=function(){};var dn=function(y){this._map=y};dn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},dn.prototype.mousemove=function(y){this._map.fire(new Do(y.type,this._map,y))},dn.prototype.mousedown=function(){this._delayContextMenu=!0},dn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Do("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},dn.prototype.contextmenu=function(y){this._delayContextMenu?this._contextMenuEvent=y:this._map.fire(new Do(y.type,this._map,y)),this._map.listens("contextmenu")&&y.preventDefault()},dn.prototype.isEnabled=function(){return!0},dn.prototype.isActive=function(){return!1},dn.prototype.enable=function(){},dn.prototype.disable=function(){};var bu=function(y,b){this._map=y,this._el=y.getCanvasContainer(),this._container=y.getContainer(),this._clickTolerance=b.clickTolerance||1};function cc(y,b){for(var _={},S=0;S<y.length;S++)_[y[S].identifier]=b[S];return _}bu.prototype.isEnabled=function(){return!!this._enabled},bu.prototype.isActive=function(){return!!this._active},bu.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},bu.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},bu.prototype.mousedown=function(y,b){this.isEnabled()&&y.shiftKey&&y.button===0&&(u.disableDrag(),this._startPos=this._lastPos=b,this._active=!0)},bu.prototype.mousemoveWindow=function(y,b){if(this._active){var _=b;if(!(this._lastPos.equals(_)||!this._box&&_.dist(this._startPos)<this._clickTolerance)){var S=this._startPos;this._lastPos=_,this._box||(this._box=u.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",y));var P=Math.min(S.x,_.x),F=Math.max(S.x,_.x),N=Math.min(S.y,_.y),V=Math.max(S.y,_.y);u.setTransform(this._box,"translate("+P+"px,"+N+"px)"),this._box.style.width=F-P+"px",this._box.style.height=V-N+"px"}}},bu.prototype.mouseupWindow=function(y,b){var _=this;if(this._active&&y.button===0){var S=this._startPos,P=b;if(this.reset(),u.suppressClick(),S.x!==P.x||S.y!==P.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:y})),{cameraAnimation:function(F){return F.fitScreenCoordinates(S,P,_._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",y)}},bu.prototype.keydown=function(y){this._active&&y.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",y))},bu.prototype.blur=function(){this.reset()},bu.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(u.remove(this._box),this._box=null),u.enableDrag(),delete this._startPos,delete this._lastPos},bu.prototype._fireEvent=function(y,b){return this._map.fire(new o.Event(y,{originalEvent:b}))};var Cf=function(y){this.reset(),this.numTouches=y.numTouches};Cf.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Cf.prototype.touchstart=function(y,b,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=y.timeStamp),_.length===this.numTouches&&(this.centroid=function(S){for(var P=new o.Point(0,0),F=0,N=S;F<N.length;F+=1)P._add(N[F]);return P.div(S.length)}(b),this.touches=cc(_,b)))},Cf.prototype.touchmove=function(y,b,_){if(!this.aborted&&this.centroid){var S=cc(_,b);for(var P in this.touches){var F=S[P];(!F||F.dist(this.touches[P])>30)&&(this.aborted=!0)}}},Cf.prototype.touchend=function(y,b,_){if((!this.centroid||y.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){var S=!this.aborted&&this.centroid;if(this.reset(),S)return S}};var Wl=function(y){this.singleTap=new Cf(y),this.numTaps=y.numTaps,this.reset()};Wl.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Wl.prototype.touchstart=function(y,b,_){this.singleTap.touchstart(y,b,_)},Wl.prototype.touchmove=function(y,b,_){this.singleTap.touchmove(y,b,_)},Wl.prototype.touchend=function(y,b,_){var S=this.singleTap.touchend(y,b,_);if(S){var P=y.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(S)<30;if(P&&F||this.reset(),this.count++,this.lastTime=y.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}};var wu=function(){this._zoomIn=new Wl({numTouches:1,numTaps:2}),this._zoomOut=new Wl({numTouches:2,numTaps:1}),this.reset()};wu.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},wu.prototype.touchstart=function(y,b,_){this._zoomIn.touchstart(y,b,_),this._zoomOut.touchstart(y,b,_)},wu.prototype.touchmove=function(y,b,_){this._zoomIn.touchmove(y,b,_),this._zoomOut.touchmove(y,b,_)},wu.prototype.touchend=function(y,b,_){var S=this,P=this._zoomIn.touchend(y,b,_),F=this._zoomOut.touchend(y,b,_);return P?(this._active=!0,y.preventDefault(),setTimeout(function(){return S.reset()},0),{cameraAnimation:function(N){return N.easeTo({duration:300,zoom:N.getZoom()+1,around:N.unproject(P)},{originalEvent:y})}}):F?(this._active=!0,y.preventDefault(),setTimeout(function(){return S.reset()},0),{cameraAnimation:function(N){return N.easeTo({duration:300,zoom:N.getZoom()-1,around:N.unproject(F)},{originalEvent:y})}}):void 0},wu.prototype.touchcancel=function(){this.reset()},wu.prototype.enable=function(){this._enabled=!0},wu.prototype.disable=function(){this._enabled=!1,this.reset()},wu.prototype.isEnabled=function(){return this._enabled},wu.prototype.isActive=function(){return this._active};var dv={0:1,2:2},Yr=function(y){this.reset(),this._clickTolerance=y.clickTolerance||1};Yr.prototype.blur=function(){this.reset()},Yr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Yr.prototype._correctButton=function(y,b){return!1},Yr.prototype._move=function(y,b){return{}},Yr.prototype.mousedown=function(y,b){if(!this._lastPoint){var _=u.mouseButton(y);this._correctButton(y,_)&&(this._lastPoint=b,this._eventButton=_)}},Yr.prototype.mousemoveWindow=function(y,b){var _=this._lastPoint;if(_){if(y.preventDefault(),function(S,P){var F=dv[P];return S.buttons===void 0||(S.buttons&F)!==F}(y,this._eventButton))this.reset();else if(this._moved||!(b.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=b,this._move(_,b)}},Yr.prototype.mouseupWindow=function(y){this._lastPoint&&u.mouseButton(y)===this._eventButton&&(this._moved&&u.suppressClick(),this.reset())},Yr.prototype.enable=function(){this._enabled=!0},Yr.prototype.disable=function(){this._enabled=!1,this.reset()},Yr.prototype.isEnabled=function(){return this._enabled},Yr.prototype.isActive=function(){return this._active};var Hc=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.mousedown=function(_,S){y.prototype.mousedown.call(this,_,S),this._lastPoint&&(this._active=!0)},b.prototype._correctButton=function(_,S){return S===0&&!_.ctrlKey},b.prototype._move=function(_,S){return{around:S,panDelta:S.sub(_)}},b}(Yr),Cs=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype._correctButton=function(_,S){return S===0&&_.ctrlKey||S===2},b.prototype._move=function(_,S){var P=.8*(S.x-_.x);if(P)return this._active=!0,{bearingDelta:P}},b.prototype.contextmenu=function(_){_.preventDefault()},b}(Yr),Oh=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype._correctButton=function(_,S){return S===0&&_.ctrlKey||S===2},b.prototype._move=function(_,S){var P=-.5*(S.y-_.y);if(P)return this._active=!0,{pitchDelta:P}},b.prototype.contextmenu=function(_){_.preventDefault()},b}(Yr),su=function(y){this._minTouches=1,this._clickTolerance=y.clickTolerance||1,this.reset()};su.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},su.prototype.touchstart=function(y,b,_){return this._calculateTransform(y,b,_)},su.prototype.touchmove=function(y,b,_){if(this._active&&!(_.length<this._minTouches))return y.preventDefault(),this._calculateTransform(y,b,_)},su.prototype.touchend=function(y,b,_){this._calculateTransform(y,b,_),this._active&&_.length<this._minTouches&&this.reset()},su.prototype.touchcancel=function(){this.reset()},su.prototype._calculateTransform=function(y,b,_){_.length>0&&(this._active=!0);var S=cc(_,b),P=new o.Point(0,0),F=new o.Point(0,0),N=0;for(var V in S){var J=S[V],se=this._touches[V];se&&(P._add(J),F._add(J.sub(se)),N++,S[V]=J)}if(this._touches=S,!(N<this._minTouches)&&F.mag()){var de=F.div(N);if(this._sum._add(de),!(this._sum.mag()<this._clickTolerance))return{around:P.div(N),panDelta:de}}},su.prototype.enable=function(){this._enabled=!0},su.prototype.disable=function(){this._enabled=!1,this.reset()},su.prototype.isEnabled=function(){return this._enabled},su.prototype.isActive=function(){return this._active};var ds=function(){this.reset()};function vv(y,b,_){for(var S=0;S<y.length;S++)if(y[S].identifier===_)return b[S]}function gv(y,b){return Math.log(y/b)/Math.LN2}ds.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},ds.prototype._start=function(y){},ds.prototype._move=function(y,b,_){return{}},ds.prototype.touchstart=function(y,b,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([b[0],b[1]]))},ds.prototype.touchmove=function(y,b,_){if(this._firstTwoTouches){y.preventDefault();var S=this._firstTwoTouches,P=S[1],F=vv(_,b,S[0]),N=vv(_,b,P);if(F&&N){var V=this._aroundCenter?null:F.add(N).div(2);return this._move([F,N],V,y)}}},ds.prototype.touchend=function(y,b,_){if(this._firstTwoTouches){var S=this._firstTwoTouches,P=S[1],F=vv(_,b,S[0]),N=vv(_,b,P);F&&N||(this._active&&u.suppressClick(),this.reset())}},ds.prototype.touchcancel=function(){this.reset()},ds.prototype.enable=function(y){this._enabled=!0,this._aroundCenter=!!y&&y.around==="center"},ds.prototype.disable=function(){this._enabled=!1,this.reset()},ds.prototype.isEnabled=function(){return this._enabled},ds.prototype.isActive=function(){return this._active};var Tl=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.reset=function(){y.prototype.reset.call(this),delete this._distance,delete this._startDistance},b.prototype._start=function(_){this._startDistance=this._distance=_[0].dist(_[1])},b.prototype._move=function(_,S){var P=this._distance;if(this._distance=_[0].dist(_[1]),this._active||!(Math.abs(gv(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:gv(this._distance,P),pinchAround:S}},b}(ds);function fc(y,b){return 180*y.angleWith(b)/Math.PI}var mv=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.reset=function(){y.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},b.prototype._start=function(_){this._startVector=this._vector=_[0].sub(_[1]),this._minDiameter=_[0].dist(_[1])},b.prototype._move=function(_,S){var P=this._vector;if(this._vector=_[0].sub(_[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:fc(this._vector,P),pinchAround:S}},b.prototype._isBelowThreshold=function(_){this._minDiameter=Math.min(this._minDiameter,_.mag());var S=25/(Math.PI*this._minDiameter)*360,P=fc(_,this._startVector);return Math.abs(P)<S},b}(ds);function Lp(y){return Math.abs(y.y)>Math.abs(y.x)}var yv=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.reset=function(){y.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},b.prototype._start=function(_){this._lastPoints=_,Lp(_[0].sub(_[1]))&&(this._valid=!1)},b.prototype._move=function(_,S,P){var F=_[0].sub(this._lastPoints[0]),N=_[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(F,N,P.timeStamp),this._valid)return this._lastPoints=_,this._active=!0,{pitchDelta:(F.y+N.y)/2*-.5}},b.prototype.gestureBeginsVertically=function(_,S,P){if(this._valid!==void 0)return this._valid;var F=_.mag()>=2,N=S.mag()>=2;if(F||N){if(!F||!N)return this._firstMove===void 0&&(this._firstMove=P),P-this._firstMove<100&&void 0;var V=_.y>0==S.y>0;return Lp(_)&&Lp(S)&&V}},b}(ds),_v={panStep:100,bearingStep:15,pitchStep:10},Xl=function(){var y=_v;this._panStep=y.panStep,this._bearingStep=y.bearingStep,this._pitchStep=y.pitchStep,this._rotationDisabled=!1};function Ml(y){return y*(2-y)}Xl.prototype.blur=function(){this.reset()},Xl.prototype.reset=function(){this._active=!1},Xl.prototype.keydown=function(y){var b=this;if(!(y.altKey||y.ctrlKey||y.metaKey)){var _=0,S=0,P=0,F=0,N=0;switch(y.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:y.shiftKey?S=-1:(y.preventDefault(),F=-1);break;case 39:y.shiftKey?S=1:(y.preventDefault(),F=1);break;case 38:y.shiftKey?P=1:(y.preventDefault(),N=-1);break;case 40:y.shiftKey?P=-1:(y.preventDefault(),N=1);break;default:return}return this._rotationDisabled&&(S=0,P=0),{cameraAnimation:function(V){var J=V.getZoom();V.easeTo({duration:300,easeId:"keyboardHandler",easing:Ml,zoom:_?Math.round(J)+_*(y.shiftKey?2:1):J,bearing:V.getBearing()+S*b._bearingStep,pitch:V.getPitch()+P*b._pitchStep,offset:[-F*b._panStep,-N*b._panStep],center:V.getCenter()},{originalEvent:y})}}}},Xl.prototype.enable=function(){this._enabled=!0},Xl.prototype.disable=function(){this._enabled=!1,this.reset()},Xl.prototype.isEnabled=function(){return this._enabled},Xl.prototype.isActive=function(){return this._active},Xl.prototype.disableRotation=function(){this._rotationDisabled=!0},Xl.prototype.enableRotation=function(){this._rotationDisabled=!1};var ti=function(y,b){this._map=y,this._el=y.getCanvasContainer(),this._handler=b,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};ti.prototype.setZoomRate=function(y){this._defaultZoomRate=y},ti.prototype.setWheelZoomRate=function(y){this._wheelZoomRate=y},ti.prototype.isEnabled=function(){return!!this._enabled},ti.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ti.prototype.isZooming=function(){return!!this._zooming},ti.prototype.enable=function(y){this.isEnabled()||(this._enabled=!0,this._aroundCenter=y&&y.around==="center")},ti.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ti.prototype.wheel=function(y){if(this.isEnabled()){var b=y.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*y.deltaY:y.deltaY,_=o.browser.now(),S=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,b!==0&&b%4.000244140625==0?this._type="wheel":b!==0&&Math.abs(b)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=b,this._timeout=setTimeout(this._onTimeout,40,y)):this._type||(this._type=Math.abs(S*b)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,b+=this._lastValue)),y.shiftKey&&b&&(b/=4),this._type&&(this._lastWheelEvent=y,this._delta-=b,this._active||this._start(y)),y.preventDefault()}},ti.prototype._onTimeout=function(y){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(y)},ti.prototype._start=function(y){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var b=u.mousePos(this._el,y);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(b)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ti.prototype.renderFrame=function(){var y=this;if(this._frameId&&(this._frameId=null,this.isActive())){var b=this._map.transform;if(this._delta!==0){var _=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,S=2/(1+Math.exp(-Math.abs(this._delta*_)));this._delta<0&&S!==0&&(S=1/S);var P=typeof this._targetZoom=="number"?b.zoomScale(this._targetZoom):b.scale;this._targetZoom=Math.min(b.maxZoom,Math.max(b.minZoom,b.scaleZoom(P*S))),this._type==="wheel"&&(this._startZoom=b.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var F,N=typeof this._targetZoom=="number"?this._targetZoom:b.zoom,V=this._startZoom,J=this._easing,se=!1;if(this._type==="wheel"&&V&&J){var de=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),xe=J(de);F=o.number(V,N,xe),de<1?this._frameId||(this._frameId=!0):se=!0}else F=N,se=!0;return this._active=!0,se&&(this._active=!1,this._finishTimeout=setTimeout(function(){y._zooming=!1,y._handler._triggerRenderFrame(),delete y._targetZoom,delete y._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!se,zoomDelta:F-b.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ti.prototype._smoothOutEasing=function(y){var b=o.ease;if(this._prevEase){var _=this._prevEase,S=(o.browser.now()-_.start)/_.duration,P=_.easing(S+.01)-_.easing(S),F=.27/Math.sqrt(P*P+1e-4)*.01,N=Math.sqrt(.0729-F*F);b=o.bezier(F,N,.25,1)}return this._prevEase={start:o.browser.now(),duration:y,easing:b},b},ti.prototype.blur=function(){this.reset()},ti.prototype.reset=function(){this._active=!1};var Bo=function(y,b){this._clickZoom=y,this._tapZoom=b};Bo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Bo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Bo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Bo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Yl=function(){this.reset()};Yl.prototype.reset=function(){this._active=!1},Yl.prototype.blur=function(){this.reset()},Yl.prototype.dblclick=function(y,b){return y.preventDefault(),{cameraAnimation:function(_){_.easeTo({duration:300,zoom:_.getZoom()+(y.shiftKey?-1:1),around:_.unproject(b)},{originalEvent:y})}}},Yl.prototype.enable=function(){this._enabled=!0},Yl.prototype.disable=function(){this._enabled=!1,this.reset()},Yl.prototype.isEnabled=function(){return this._enabled},Yl.prototype.isActive=function(){return this._active};var Cu=function(){this._tap=new Wl({numTouches:1,numTaps:1}),this.reset()};Cu.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Cu.prototype.touchstart=function(y,b,_){this._swipePoint||(this._tapTime&&y.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=b[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(y,b,_))},Cu.prototype.touchmove=function(y,b,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;var S=b[0],P=S.y-this._swipePoint.y;return this._swipePoint=S,y.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(y,b,_)},Cu.prototype.touchend=function(y,b,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(y,b,_)&&(this._tapTime=y.timeStamp)},Cu.prototype.touchcancel=function(){this.reset()},Cu.prototype.enable=function(){this._enabled=!0},Cu.prototype.disable=function(){this._enabled=!1,this.reset()},Cu.prototype.isEnabled=function(){return this._enabled},Cu.prototype.isActive=function(){return this._active};var jc=function(y,b,_){this._el=y,this._mousePan=b,this._touchPan=_};jc.prototype.enable=function(y){this._inertiaOptions=y||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},jc.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},jc.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},jc.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Fh=function(y,b,_){this._pitchWithRotate=y.pitchWithRotate,this._mouseRotate=b,this._mousePitch=_};Fh.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Fh.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Fh.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Fh.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Xs=function(y,b,_,S){this._el=y,this._touchZoom=b,this._touchRotate=_,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0};Xs.prototype.enable=function(y){this._touchZoom.enable(y),this._rotationDisabled||this._touchRotate.enable(y),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Xs.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Xs.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Xs.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Xs.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Xs.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var vs=function(y){return y.zoom||y.drag||y.pitch||y.rotate},Dh=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b}(o.Event);function Pn(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}var _n=function(y,b){this._map=y,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ph(y),this._bearingSnap=b.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(b),o.bindAll(["handleEvent","handleWindowEvent"],this);var _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[o.window,"blur",void 0]];for(var S=0,P=this._listeners;S<P.length;S+=1){var F=P[S],N=F[0];u.addEventListener(N,F[1],N===o.window.document?this.handleWindowEvent:this.handleEvent,F[2])}};_n.prototype.destroy=function(){for(var y=0,b=this._listeners;y<b.length;y+=1){var _=b[y],S=_[0];u.removeEventListener(S,_[1],S===o.window.document?this.handleWindowEvent:this.handleEvent,_[2])}},_n.prototype._addDefaultHandlers=function(y){var b=this._map,_=b.getCanvasContainer();this._add("mapEvent",new Da(b,y));var S=b.boxZoom=new bu(b,y);this._add("boxZoom",S);var P=new wu,F=new Yl;b.doubleClickZoom=new Bo(F,P),this._add("tapZoom",P),this._add("clickZoom",F);var N=new Cu;this._add("tapDragZoom",N);var V=b.touchPitch=new yv;this._add("touchPitch",V);var J=new Cs(y),se=new Oh(y);b.dragRotate=new Fh(y,J,se),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",se,["mouseRotate"]);var de=new Hc(y),xe=new su(y);b.dragPan=new jc(_,de,xe),this._add("mousePan",de),this._add("touchPan",xe,["touchZoom","touchRotate"]);var Ee=new mv,Ue=new Tl;b.touchZoomRotate=new Xs(_,Ue,Ee,N),this._add("touchRotate",Ee,["touchPan","touchZoom"]),this._add("touchZoom",Ue,["touchPan","touchRotate"]);var Be=b.scrollZoom=new ti(b,this);this._add("scrollZoom",Be,["mousePan"]);var Ke=b.keyboard=new Xl;this._add("keyboard",Ke),this._add("blockableMapEvent",new dn(b));for(var Oe=0,Qe=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Oe<Qe.length;Oe+=1){var ft=Qe[Oe];y.interactive&&y[ft]&&b[ft].enable(y[ft])}},_n.prototype._add=function(y,b,_){this._handlers.push({handlerName:y,handler:b,allowed:_}),this._handlersById[y]=b},_n.prototype.stop=function(y){if(!this._updatingCamera){for(var b=0,_=this._handlers;b<_.length;b+=1)_[b].handler.reset();this._inertia.clear(),this._fireEvents({},{},y),this._changes=[]}},_n.prototype.isActive=function(){for(var y=0,b=this._handlers;y<b.length;y+=1)if(b[y].handler.isActive())return!0;return!1},_n.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},_n.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},_n.prototype.isMoving=function(){return Boolean(vs(this._eventsInProgress))||this.isZooming()},_n.prototype._blockedByActive=function(y,b,_){for(var S in y)if(S!==_&&(!b||b.indexOf(S)<0))return!0;return!1},_n.prototype.handleWindowEvent=function(y){this.handleEvent(y,y.type+"Window")},_n.prototype._getMapTouches=function(y){for(var b=[],_=0,S=y;_<S.length;_+=1){var P=S[_];this._el.contains(P.target)&&b.push(P)}return b},_n.prototype.handleEvent=function(y,b){this._updatingCamera=!0;for(var _=y.type==="renderFrame"?void 0:y,S={needsRenderFrame:!1},P={},F={},N=y.touches?this._getMapTouches(y.touches):void 0,V=N?u.touchPos(this._el,N):u.mousePos(this._el,y),J=0,se=this._handlers;J<se.length;J+=1){var de=se[J],xe=de.handlerName,Ee=de.handler,Ue=de.allowed;if(Ee.isEnabled()){var Be=void 0;this._blockedByActive(F,Ue,xe)?Ee.reset():Ee[b||y.type]&&(Be=Ee[b||y.type](y,V,N),this.mergeHandlerResult(S,P,Be,xe,_),Be&&Be.needsRenderFrame&&this._triggerRenderFrame()),(Be||Ee.isActive())&&(F[xe]=Ee)}}var Ke={};for(var Oe in this._previousActiveHandlers)F[Oe]||(Ke[Oe]=_);this._previousActiveHandlers=F,(Object.keys(Ke).length||Pn(S))&&(this._changes.push([S,P,Ke]),this._triggerRenderFrame()),(Object.keys(F).length||Pn(S))&&this._map._stop(!0),this._updatingCamera=!1;var Qe=S.cameraAnimation;Qe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Qe(this._map))},_n.prototype.mergeHandlerResult=function(y,b,_,S,P){if(_){o.extend(y,_);var F={handlerName:S,originalEvent:_.originalEvent||P};_.zoomDelta!==void 0&&(b.zoom=F),_.panDelta!==void 0&&(b.drag=F),_.pitchDelta!==void 0&&(b.pitch=F),_.bearingDelta!==void 0&&(b.rotate=F)}},_n.prototype._applyChanges=function(){for(var y={},b={},_={},S=0,P=this._changes;S<P.length;S+=1){var F=P[S],N=F[0],V=F[1],J=F[2];N.panDelta&&(y.panDelta=(y.panDelta||new o.Point(0,0))._add(N.panDelta)),N.zoomDelta&&(y.zoomDelta=(y.zoomDelta||0)+N.zoomDelta),N.bearingDelta&&(y.bearingDelta=(y.bearingDelta||0)+N.bearingDelta),N.pitchDelta&&(y.pitchDelta=(y.pitchDelta||0)+N.pitchDelta),N.around!==void 0&&(y.around=N.around),N.pinchAround!==void 0&&(y.pinchAround=N.pinchAround),N.noInertia&&(y.noInertia=N.noInertia),o.extend(b,V),o.extend(_,J)}this._updateMapTransform(y,b,_),this._changes=[]},_n.prototype._updateMapTransform=function(y,b,_){var S=this._map,P=S.transform;if(!Pn(y))return this._fireEvents(b,_,!0);var F=y.panDelta,N=y.zoomDelta,V=y.bearingDelta,J=y.pitchDelta,se=y.around,de=y.pinchAround;de!==void 0&&(se=de),S._stop(!0),se=se||S.transform.centerPoint;var xe=P.pointLocation(F?se.sub(F):se);V&&(P.bearing+=V),J&&(P.pitch+=J),N&&(P.zoom+=N),P.setLocationAtPoint(xe,se),this._map._update(),y.noInertia||this._inertia.record(y),this._fireEvents(b,_,!0)},_n.prototype._fireEvents=function(y,b,_){var S=this,P=vs(this._eventsInProgress),F=vs(y),N={};for(var V in y)this._eventsInProgress[V]||(N[V+"start"]=y[V].originalEvent),this._eventsInProgress[V]=y[V];for(var J in!P&&F&&this._fireEvent("movestart",F.originalEvent),N)this._fireEvent(J,N[J]);for(var se in F&&this._fireEvent("move",F.originalEvent),y)this._fireEvent(se,y[se].originalEvent);var de,xe={};for(var Ee in this._eventsInProgress){var Ue=this._eventsInProgress[Ee],Be=Ue.handlerName,Ke=Ue.originalEvent;this._handlersById[Be].isActive()||(delete this._eventsInProgress[Ee],xe[Ee+"end"]=de=b[Be]||Ke)}for(var Oe in xe)this._fireEvent(Oe,xe[Oe]);var Qe=vs(this._eventsInProgress);if(_&&(P||F)&&!Qe){this._updatingCamera=!0;var ft=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),xt=function(Ut){return Ut!==0&&-S._bearingSnap<Ut&&Ut<S._bearingSnap};ft?(xt(ft.bearing||this._map.getBearing())&&(ft.bearing=0),this._map.easeTo(ft,{originalEvent:de})):(this._map.fire(new o.Event("moveend",{originalEvent:de})),xt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},_n.prototype._fireEvent=function(y,b){this._map.fire(new o.Event(y,b?{originalEvent:b}:{}))},_n.prototype._requestFrame=function(){var y=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(b){delete y._frameId,y.handleEvent(new Dh("renderFrame",{timeStamp:b})),y._applyChanges()})},_n.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Xf=function(y){function b(_,S){y.call(this),this._moving=!1,this._zooming=!1,this.transform=_,this._bearingSnap=S.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},b.prototype.setCenter=function(_,S){return this.jumpTo({center:_},S)},b.prototype.panBy=function(_,S,P){return _=o.Point.convert(_).mult(-1),this.panTo(this.transform.center,o.extend({offset:_},S),P)},b.prototype.panTo=function(_,S,P){return this.easeTo(o.extend({center:_},S),P)},b.prototype.getZoom=function(){return this.transform.zoom},b.prototype.setZoom=function(_,S){return this.jumpTo({zoom:_},S),this},b.prototype.zoomTo=function(_,S,P){return this.easeTo(o.extend({zoom:_},S),P)},b.prototype.zoomIn=function(_,S){return this.zoomTo(this.getZoom()+1,_,S),this},b.prototype.zoomOut=function(_,S){return this.zoomTo(this.getZoom()-1,_,S),this},b.prototype.getBearing=function(){return this.transform.bearing},b.prototype.setBearing=function(_,S){return this.jumpTo({bearing:_},S),this},b.prototype.getPadding=function(){return this.transform.padding},b.prototype.setPadding=function(_,S){return this.jumpTo({padding:_},S),this},b.prototype.rotateTo=function(_,S,P){return this.easeTo(o.extend({bearing:_},S),P)},b.prototype.resetNorth=function(_,S){return this.rotateTo(0,o.extend({duration:1e3},_),S),this},b.prototype.resetNorthPitch=function(_,S){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},_),S),this},b.prototype.snapToNorth=function(_,S){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(_,S):this},b.prototype.getPitch=function(){return this.transform.pitch},b.prototype.setPitch=function(_,S){return this.jumpTo({pitch:_},S),this},b.prototype.cameraForBounds=function(_,S){_=o.LngLatBounds.convert(_);var P=S&&S.bearing||0;return this._cameraForBoxAndBearing(_.getNorthWest(),_.getSouthEast(),P,S)},b.prototype._cameraForBoxAndBearing=function(_,S,P,F){var N={top:0,bottom:0,right:0,left:0};if(typeof(F=o.extend({padding:N,offset:[0,0],maxZoom:this.transform.maxZoom},F)).padding=="number"){var V=F.padding;F.padding={top:V,bottom:V,right:V,left:V}}F.padding=o.extend(N,F.padding);var J=this.transform,se=J.padding,de=J.project(o.LngLat.convert(_)),xe=J.project(o.LngLat.convert(S)),Ee=de.rotate(-P*Math.PI/180),Ue=xe.rotate(-P*Math.PI/180),Be=new o.Point(Math.max(Ee.x,Ue.x),Math.max(Ee.y,Ue.y)),Ke=new o.Point(Math.min(Ee.x,Ue.x),Math.min(Ee.y,Ue.y)),Oe=Be.sub(Ke),Qe=(J.width-(se.left+se.right+F.padding.left+F.padding.right))/Oe.x,ft=(J.height-(se.top+se.bottom+F.padding.top+F.padding.bottom))/Oe.y;if(!(ft<0||Qe<0)){var xt=Math.min(J.scaleZoom(J.scale*Math.min(Qe,ft)),F.maxZoom),Ut=typeof F.offset.x=="number"?new o.Point(F.offset.x,F.offset.y):o.Point.convert(F.offset),Bt=new o.Point((F.padding.left-F.padding.right)/2,(F.padding.top-F.padding.bottom)/2).rotate(P*Math.PI/180),Wt=Ut.add(Bt).mult(J.scale/J.zoomScale(xt));return{center:J.unproject(de.add(xe).div(2).sub(Wt)),zoom:xt,bearing:P}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},b.prototype.fitBounds=function(_,S,P){return this._fitInternal(this.cameraForBounds(_,S),S,P)},b.prototype.fitScreenCoordinates=function(_,S,P,F,N){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(_)),this.transform.pointLocation(o.Point.convert(S)),P,F),F,N)},b.prototype._fitInternal=function(_,S,P){return _?(delete(S=o.extend(_,S)).padding,S.linear?this.easeTo(S,P):this.flyTo(S,P)):this},b.prototype.jumpTo=function(_,S){this.stop();var P=this.transform,F=!1,N=!1,V=!1;return"zoom"in _&&P.zoom!==+_.zoom&&(F=!0,P.zoom=+_.zoom),_.center!==void 0&&(P.center=o.LngLat.convert(_.center)),"bearing"in _&&P.bearing!==+_.bearing&&(N=!0,P.bearing=+_.bearing),"pitch"in _&&P.pitch!==+_.pitch&&(V=!0,P.pitch=+_.pitch),_.padding==null||P.isPaddingEqual(_.padding)||(P.padding=_.padding),this.fire(new o.Event("movestart",S)).fire(new o.Event("move",S)),F&&this.fire(new o.Event("zoomstart",S)).fire(new o.Event("zoom",S)).fire(new o.Event("zoomend",S)),N&&this.fire(new o.Event("rotatestart",S)).fire(new o.Event("rotate",S)).fire(new o.Event("rotateend",S)),V&&this.fire(new o.Event("pitchstart",S)).fire(new o.Event("pitch",S)).fire(new o.Event("pitchend",S)),this.fire(new o.Event("moveend",S))},b.prototype.easeTo=function(_,S){var P=this;this._stop(!1,_.easeId),((_=o.extend({offset:[0,0],duration:500,easing:o.ease},_)).animate===!1||!_.essential&&o.browser.prefersReducedMotion)&&(_.duration=0);var F=this.transform,N=this.getZoom(),V=this.getBearing(),J=this.getPitch(),se=this.getPadding(),de="zoom"in _?+_.zoom:N,xe="bearing"in _?this._normalizeBearing(_.bearing,V):V,Ee="pitch"in _?+_.pitch:J,Ue="padding"in _?_.padding:F.padding,Be=o.Point.convert(_.offset),Ke=F.centerPoint.add(Be),Oe=F.pointLocation(Ke),Qe=o.LngLat.convert(_.center||Oe);this._normalizeCenter(Qe);var ft,xt,Ut=F.project(Oe),Bt=F.project(Qe).sub(Ut),Wt=F.zoomScale(de-N);_.around&&(ft=o.LngLat.convert(_.around),xt=F.locationPoint(ft));var hr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||de!==N,this._rotating=this._rotating||V!==xe,this._pitching=this._pitching||Ee!==J,this._padding=!F.isPaddingEqual(Ue),this._easeId=_.easeId,this._prepareEase(S,_.noMoveStart,hr),this._ease(function(yr){if(P._zooming&&(F.zoom=o.number(N,de,yr)),P._rotating&&(F.bearing=o.number(V,xe,yr)),P._pitching&&(F.pitch=o.number(J,Ee,yr)),P._padding&&(F.interpolatePadding(se,Ue,yr),Ke=F.centerPoint.add(Be)),ft)F.setLocationAtPoint(ft,xt);else{var Ir=F.zoomScale(F.zoom-N),Kr=de>N?Math.min(2,Wt):Math.max(.5,Wt),An=Math.pow(Kr,1-yr),Nn=F.unproject(Ut.add(Bt.mult(yr*An)).mult(Ir));F.setLocationAtPoint(F.renderWorldCopies?Nn.wrap():Nn,Ke)}P._fireMoveEvents(S)},function(yr){P._afterEase(S,yr)},_),this},b.prototype._prepareEase=function(_,S,P){P===void 0&&(P={}),this._moving=!0,S||P.moving||this.fire(new o.Event("movestart",_)),this._zooming&&!P.zooming&&this.fire(new o.Event("zoomstart",_)),this._rotating&&!P.rotating&&this.fire(new o.Event("rotatestart",_)),this._pitching&&!P.pitching&&this.fire(new o.Event("pitchstart",_))},b.prototype._fireMoveEvents=function(_){this.fire(new o.Event("move",_)),this._zooming&&this.fire(new o.Event("zoom",_)),this._rotating&&this.fire(new o.Event("rotate",_)),this._pitching&&this.fire(new o.Event("pitch",_))},b.prototype._afterEase=function(_,S){if(!this._easeId||!S||this._easeId!==S){delete this._easeId;var P=this._zooming,F=this._rotating,N=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,P&&this.fire(new o.Event("zoomend",_)),F&&this.fire(new o.Event("rotateend",_)),N&&this.fire(new o.Event("pitchend",_)),this.fire(new o.Event("moveend",_))}},b.prototype.flyTo=function(_,S){var P=this;if(!_.essential&&o.browser.prefersReducedMotion){var F=o.pick(_,["center","zoom","bearing","pitch","around"]);return this.jumpTo(F,S)}this.stop(),_=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},_);var N=this.transform,V=this.getZoom(),J=this.getBearing(),se=this.getPitch(),de=this.getPadding(),xe="zoom"in _?o.clamp(+_.zoom,N.minZoom,N.maxZoom):V,Ee="bearing"in _?this._normalizeBearing(_.bearing,J):J,Ue="pitch"in _?+_.pitch:se,Be="padding"in _?_.padding:N.padding,Ke=N.zoomScale(xe-V),Oe=o.Point.convert(_.offset),Qe=N.centerPoint.add(Oe),ft=N.pointLocation(Qe),xt=o.LngLat.convert(_.center||ft);this._normalizeCenter(xt);var Ut=N.project(ft),Bt=N.project(xt).sub(Ut),Wt=_.curve,hr=Math.max(N.width,N.height),yr=hr/Ke,Ir=Bt.mag();if("minZoom"in _){var Kr=o.clamp(Math.min(_.minZoom,V,xe),N.minZoom,N.maxZoom),An=hr/N.zoomScale(Kr-V);Wt=Math.sqrt(An/Ir*2)}var Nn=Wt*Wt;function Dn(ri){var Tn=(yr*yr-hr*hr+(ri?-1:1)*Nn*Nn*Ir*Ir)/(2*(ri?yr:hr)*Nn*Ir);return Math.log(Math.sqrt(Tn*Tn+1)-Tn)}function sa(ri){return(Math.exp(ri)-Math.exp(-ri))/2}function on(ri){return(Math.exp(ri)+Math.exp(-ri))/2}var qn=Dn(0),di=function(ri){return on(qn)/on(qn+Wt*ri)},si=function(ri){return hr*((on(qn)*(sa(Tn=qn+Wt*ri)/on(Tn))-sa(qn))/Nn)/Ir;var Tn},Jn=(Dn(1)-qn)/Wt;if(Math.abs(Ir)<1e-6||!isFinite(Jn)){if(Math.abs(hr-yr)<1e-6)return this.easeTo(_,S);var wi=yr<hr?-1:1;Jn=Math.abs(Math.log(yr/hr))/Wt,si=function(){return 0},di=function(ri){return Math.exp(wi*Wt*ri)}}return _.duration="duration"in _?+_.duration:1e3*Jn/("screenSpeed"in _?+_.screenSpeed/Wt:+_.speed),_.maxDuration&&_.duration>_.maxDuration&&(_.duration=0),this._zooming=!0,this._rotating=J!==Ee,this._pitching=Ue!==se,this._padding=!N.isPaddingEqual(Be),this._prepareEase(S,!1),this._ease(function(ri){var Tn=ri*Jn,Zo=1/di(Tn);N.zoom=ri===1?xe:V+N.scaleZoom(Zo),P._rotating&&(N.bearing=o.number(J,Ee,ri)),P._pitching&&(N.pitch=o.number(se,Ue,ri)),P._padding&&(N.interpolatePadding(de,Be,ri),Qe=N.centerPoint.add(Oe));var No=ri===1?xt:N.unproject(Ut.add(Bt.mult(si(Tn))).mult(Zo));N.setLocationAtPoint(N.renderWorldCopies?No.wrap():No,Qe),P._fireMoveEvents(S)},function(){return P._afterEase(S)},_),this},b.prototype.isEasing=function(){return!!this._easeFrameId},b.prototype.stop=function(){return this._stop()},b.prototype._stop=function(_,S){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var P=this._onEaseEnd;delete this._onEaseEnd,P.call(this,S)}if(!_){var F=this.handlers;F&&F.stop(!1)}return this},b.prototype._ease=function(_,S,P){P.animate===!1||P.duration===0?(_(1),S()):(this._easeStart=o.browser.now(),this._easeOptions=P,this._onEaseFrame=_,this._onEaseEnd=S,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},b.prototype._renderFrameCallback=function(){var _=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},b.prototype._normalizeBearing=function(_,S){_=o.wrap(_,-180,180);var P=Math.abs(_-S);return Math.abs(_-360-S)<P&&(_-=360),Math.abs(_+360-S)<P&&(_+=360),_},b.prototype._normalizeCenter=function(_){var S=this.transform;if(S.renderWorldCopies&&!S.lngRange){var P=_.lng-S.center.lng;_.lng+=P>180?-360:P<-180?360:0}},b}(o.Evented),Ys=function(y){y===void 0&&(y={}),this.options=y,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ys.prototype.getDefaultPosition=function(){return"bottom-right"},Ys.prototype.onAdd=function(y){var b=this.options&&this.options.compact;return this._map=y,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=u.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=u.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),b&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),b===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ys.prototype.onRemove=function(){u.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ys.prototype._setElementTitle=function(y,b){var _=this._map._getUIString("AttributionControl."+b);y.title=_,y.setAttribute("aria-label",_)},Ys.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ys.prototype._updateEditLink=function(){var y=this._editLink;y||(y=this._editLink=this._container.querySelector(".mapbox-improve-map"));var b=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(y){var _=b.reduce(function(S,P,F){return P.value&&(S+=P.key+"="+P.value+(F<b.length-1?"&":"")),S},"?");y.href=o.config.FEEDBACK_URL+"/"+_+(this._map._hash?this._map._hash.getHashString(!0):""),y.rel="noopener nofollow",this._setElementTitle(y,"MapFeedback")}},Ys.prototype._updateData=function(y){!y||y.sourceDataType!=="metadata"&&y.sourceDataType!=="visibility"&&y.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ys.prototype._updateAttributions=function(){if(this._map.style){var y=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?y=y.concat(this.options.customAttribution.map(function(V){return typeof V!="string"?"":V})):typeof this.options.customAttribution=="string"&&y.push(this.options.customAttribution)),this._map.style.stylesheet){var b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}var _=this._map.style.sourceCaches;for(var S in _){var P=_[S];if(P.used){var F=P.getSource();F.attribution&&y.indexOf(F.attribution)<0&&y.push(F.attribution)}}y.sort(function(V,J){return V.length-J.length});var N=(y=y.filter(function(V,J){for(var se=J+1;se<y.length;se++)if(y[se].indexOf(V)>=0)return!1;return!0})).join(" | ");N!==this._attribHTML&&(this._attribHTML=N,y.length?(this._innerContainer.innerHTML=N,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ys.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Ou=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};Ou.prototype.onAdd=function(y){this._map=y,this._container=u.create("div","mapboxgl-ctrl");var b=u.create("a","mapboxgl-ctrl-logo");return b.target="_blank",b.rel="noopener nofollow",b.href="https://www.mapbox.com/",b.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),b.setAttribute("rel","noopener nofollow"),this._container.appendChild(b),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ou.prototype.onRemove=function(){u.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ou.prototype.getDefaultPosition=function(){return"bottom-left"},Ou.prototype._updateLogo=function(y){y&&y.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Ou.prototype._logoRequired=function(){if(this._map.style){var y=this._map.style.sourceCaches;for(var b in y)if(y[b].getSource().mapbox_logo)return!0;return!1}},Ou.prototype._updateCompact=function(){var y=this._container.children;if(y.length){var b=y[0];this._map.getCanvasContainer().offsetWidth<250?b.classList.add("mapboxgl-compact"):b.classList.remove("mapboxgl-compact")}};var uu=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};uu.prototype.add=function(y){var b=++this._id;return this._queue.push({callback:y,id:b,cancelled:!1}),b},uu.prototype.remove=function(y){for(var b=this._currentlyRunning,_=0,S=b?this._queue.concat(b):this._queue;_<S.length;_+=1){var P=S[_];if(P.id===y)return void(P.cancelled=!0)}},uu.prototype.run=function(y){y===void 0&&(y=0);var b=this._currentlyRunning=this._queue;this._queue=[];for(var _=0,S=b;_<S.length;_+=1){var P=S[_];if(!P.cancelled&&(P.callback(y),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},uu.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Wc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},hg=o.window.HTMLImageElement,Ll=o.window.HTMLElement,La=o.window.ImageBitmap,Es={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Il=function(y){function b(S){var P=this;if((S=o.extend({},Es,S)).minZoom!=null&&S.maxZoom!=null&&S.minZoom>S.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(S.minPitch!=null&&S.maxPitch!=null&&S.minPitch>S.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(S.minPitch!=null&&S.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(S.maxPitch!=null&&S.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var F=new Un(S.minZoom,S.maxZoom,S.minPitch,S.maxPitch,S.renderWorldCopies);if(y.call(this,F,S),this._interactive=S.interactive,this._maxTileCacheSize=S.maxTileCacheSize,this._failIfMajorPerformanceCaveat=S.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=S.preserveDrawingBuffer,this._antialias=S.antialias,this._trackResize=S.trackResize,this._bearingSnap=S.bearingSnap,this._refreshExpiredTiles=S.refreshExpiredTiles,this._fadeDuration=S.fadeDuration,this._crossSourceCollisions=S.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=S.collectResourceTiming,this._renderTaskQueue=new uu,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Wc,S.locale),this._clickTolerance=S.clickTolerance,this._requestManager=new o.RequestManager(S.transformRequest,S.accessToken),typeof S.container=="string"){if(this._container=o.window.document.getElementById(S.container),!this._container)throw new Error("Container '"+S.container+"' not found.")}else{if(!(S.container instanceof Ll))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=S.container}if(S.maxBounds&&this.setMaxBounds(S.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return P._update(!1)}),this.on("moveend",function(){return P._update(!1)}),this.on("zoom",function(){return P._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new _n(this,S),this._hash=S.hash&&new Ju(typeof S.hash=="string"&&S.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch}),S.bounds&&(this.resize(),this.fitBounds(S.bounds,o.extend({},S.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=S.localIdeographFontFamily,S.style&&this.setStyle(S.style,{localIdeographFontFamily:S.localIdeographFontFamily}),S.attributionControl&&this.addControl(new Ys({customAttribution:S.customAttribution})),this.addControl(new Ou,S.logoPosition),this.on("style.load",function(){P.transform.unmodified&&P.jumpTo(P.style.stylesheet)}),this.on("data",function(N){P._update(N.dataType==="style"),P.fire(new o.Event(N.dataType+"data",N))}),this.on("dataloading",function(N){P.fire(new o.Event(N.dataType+"dataloading",N))})}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return b.prototype._getMapId=function(){return this._mapId},b.prototype.addControl=function(S,P){if(P===void 0&&(P=S.getDefaultPosition?S.getDefaultPosition():"top-right"),!S||!S.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var F=S.onAdd(this);this._controls.push(S);var N=this._controlPositions[P];return P.indexOf("bottom")!==-1?N.insertBefore(F,N.firstChild):N.appendChild(F),this},b.prototype.removeControl=function(S){if(!S||!S.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var P=this._controls.indexOf(S);return P>-1&&this._controls.splice(P,1),S.onRemove(this),this},b.prototype.hasControl=function(S){return this._controls.indexOf(S)>-1},b.prototype.resize=function(S){var P=this._containerDimensions(),F=P[0],N=P[1];if(F===this.transform.width&&N===this.transform.height)return this;this._resizeCanvas(F,N),this.transform.resize(F,N),this.painter.resize(F,N);var V=!this._moving;return V&&this.fire(new o.Event("movestart",S)).fire(new o.Event("move",S)),this.fire(new o.Event("resize",S)),V&&this.fire(new o.Event("moveend",S)),this},b.prototype.getBounds=function(){return this.transform.getBounds()},b.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},b.prototype.setMaxBounds=function(S){return this.transform.setMaxBounds(o.LngLatBounds.convert(S)),this._update()},b.prototype.setMinZoom=function(S){if((S=S==null?-2:S)>=-2&&S<=this.transform.maxZoom)return this.transform.minZoom=S,this._update(),this.getZoom()<S&&this.setZoom(S),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},b.prototype.getMinZoom=function(){return this.transform.minZoom},b.prototype.setMaxZoom=function(S){if((S=S==null?22:S)>=this.transform.minZoom)return this.transform.maxZoom=S,this._update(),this.getZoom()>S&&this.setZoom(S),this;throw new Error("maxZoom must be greater than the current minZoom")},b.prototype.getMaxZoom=function(){return this.transform.maxZoom},b.prototype.setMinPitch=function(S){if((S=S==null?0:S)<0)throw new Error("minPitch must be greater than or equal to 0");if(S>=0&&S<=this.transform.maxPitch)return this.transform.minPitch=S,this._update(),this.getPitch()<S&&this.setPitch(S),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},b.prototype.getMinPitch=function(){return this.transform.minPitch},b.prototype.setMaxPitch=function(S){if((S=S==null?60:S)>60)throw new Error("maxPitch must be less than or equal to 60");if(S>=this.transform.minPitch)return this.transform.maxPitch=S,this._update(),this.getPitch()>S&&this.setPitch(S),this;throw new Error("maxPitch must be greater than the current minPitch")},b.prototype.getMaxPitch=function(){return this.transform.maxPitch},b.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},b.prototype.setRenderWorldCopies=function(S){return this.transform.renderWorldCopies=S,this._update()},b.prototype.project=function(S){return this.transform.locationPoint(o.LngLat.convert(S))},b.prototype.unproject=function(S){return this.transform.pointLocation(o.Point.convert(S))},b.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},b.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},b.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},b.prototype._createDelegatedListener=function(S,P,F){var N,V=this;if(S==="mouseenter"||S==="mouseover"){var J=!1;return{layer:P,listener:F,delegates:{mousemove:function(de){var xe=V.getLayer(P)?V.queryRenderedFeatures(de.point,{layers:[P]}):[];xe.length?J||(J=!0,F.call(V,new Do(S,V,de.originalEvent,{features:xe}))):J=!1},mouseout:function(){J=!1}}}}if(S==="mouseleave"||S==="mouseout"){var se=!1;return{layer:P,listener:F,delegates:{mousemove:function(de){(V.getLayer(P)?V.queryRenderedFeatures(de.point,{layers:[P]}):[]).length?se=!0:se&&(se=!1,F.call(V,new Do(S,V,de.originalEvent)))},mouseout:function(de){se&&(se=!1,F.call(V,new Do(S,V,de.originalEvent)))}}}}return{layer:P,listener:F,delegates:(N={},N[S]=function(de){var xe=V.getLayer(P)?V.queryRenderedFeatures(de.point,{layers:[P]}):[];xe.length&&(de.features=xe,F.call(V,de),delete de.features)},N)}},b.prototype.on=function(S,P,F){if(F===void 0)return y.prototype.on.call(this,S,P);var N=this._createDelegatedListener(S,P,F);for(var V in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[S]=this._delegatedListeners[S]||[],this._delegatedListeners[S].push(N),N.delegates)this.on(V,N.delegates[V]);return this},b.prototype.once=function(S,P,F){if(F===void 0)return y.prototype.once.call(this,S,P);var N=this._createDelegatedListener(S,P,F);for(var V in N.delegates)this.once(V,N.delegates[V]);return this},b.prototype.off=function(S,P,F){var N=this;return F===void 0?y.prototype.off.call(this,S,P):(this._delegatedListeners&&this._delegatedListeners[S]&&function(V){for(var J=V[S],se=0;se<J.length;se++){var de=J[se];if(de.layer===P&&de.listener===F){for(var xe in de.delegates)N.off(xe,de.delegates[xe]);return J.splice(se,1),N}}}(this._delegatedListeners),this)},b.prototype.queryRenderedFeatures=function(S,P){if(!this.style)return[];var F;if(P!==void 0||S===void 0||S instanceof o.Point||Array.isArray(S)||(P=S,S=void 0),P=P||{},(S=S||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof S[0]=="number")F=[o.Point.convert(S)];else{var N=o.Point.convert(S[0]),V=o.Point.convert(S[1]);F=[N,new o.Point(V.x,N.y),V,new o.Point(N.x,V.y),N]}return this.style.queryRenderedFeatures(F,P,this.transform)},b.prototype.querySourceFeatures=function(S,P){return this.style.querySourceFeatures(S,P)},b.prototype.setStyle=function(S,P){return(P=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},P)).diff!==!1&&P.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&S?(this._diffStyle(S,P),this):(this._localIdeographFontFamily=P.localIdeographFontFamily,this._updateStyle(S,P))},b.prototype._getUIString=function(S){var P=this._locale[S];if(P==null)throw new Error("Missing UI string '"+S+"'");return P},b.prototype._updateStyle=function(S,P){return this.style&&(this.style.setEventedParent(null),this.style._remove()),S?(this.style=new ea(this,P||{}),this.style.setEventedParent(this,{style:this.style}),typeof S=="string"?this.style.loadURL(S):this.style.loadJSON(S),this):(delete this.style,this)},b.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ea(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},b.prototype._diffStyle=function(S,P){var F=this;if(typeof S=="string"){var N=this._requestManager.normalizeStyleURL(S),V=this._requestManager.transformRequest(N,o.ResourceType.Style);o.getJSON(V,function(J,se){J?F.fire(new o.ErrorEvent(J)):se&&F._updateDiff(se,P)})}else typeof S=="object"&&this._updateDiff(S,P)},b.prototype._updateDiff=function(S,P){try{this.style.setState(S)&&this._update(!0)}catch(F){o.warnOnce("Unable to perform style diff: "+(F.message||F.error||F)+".  Rebuilding the style from scratch."),this._updateStyle(S,P)}},b.prototype.getStyle=function(){if(this.style)return this.style.serialize()},b.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},b.prototype.addSource=function(S,P){return this._lazyInitEmptyStyle(),this.style.addSource(S,P),this._update(!0)},b.prototype.isSourceLoaded=function(S){var P=this.style&&this.style.sourceCaches[S];if(P!==void 0)return P.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+S+"'")))},b.prototype.areTilesLoaded=function(){var S=this.style&&this.style.sourceCaches;for(var P in S){var F=S[P]._tiles;for(var N in F){var V=F[N];if(V.state!=="loaded"&&V.state!=="errored")return!1}}return!0},b.prototype.addSourceType=function(S,P,F){return this._lazyInitEmptyStyle(),this.style.addSourceType(S,P,F)},b.prototype.removeSource=function(S){return this.style.removeSource(S),this._update(!0)},b.prototype.getSource=function(S){return this.style.getSource(S)},b.prototype.addImage=function(S,P,F){F===void 0&&(F={});var N=F.pixelRatio;N===void 0&&(N=1);var V=F.sdf;V===void 0&&(V=!1);var J=F.stretchX,se=F.stretchY,de=F.content;if(this._lazyInitEmptyStyle(),P instanceof hg||La&&P instanceof La){var xe=o.browser.getImageData(P);this.style.addImage(S,{data:new o.RGBAImage({width:xe.width,height:xe.height},xe.data),pixelRatio:N,stretchX:J,stretchY:se,content:de,sdf:V,version:0})}else{if(P.width===void 0||P.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Ee=P;this.style.addImage(S,{data:new o.RGBAImage({width:P.width,height:P.height},new Uint8Array(P.data)),pixelRatio:N,stretchX:J,stretchY:se,content:de,sdf:V,version:0,userImage:Ee}),Ee.onAdd&&Ee.onAdd(this,S)}},b.prototype.updateImage=function(S,P){var F=this.style.getImage(S);if(!F)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var N=P instanceof hg||La&&P instanceof La?o.browser.getImageData(P):P,V=N.width,J=N.height,se=N.data;return V===void 0||J===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):V!==F.data.width||J!==F.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(F.data.replace(se,!(P instanceof hg||La&&P instanceof La)),void this.style.updateImage(S,F))},b.prototype.hasImage=function(S){return S?!!this.style.getImage(S):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},b.prototype.removeImage=function(S){this.style.removeImage(S)},b.prototype.loadImage=function(S,P){o.getImage(this._requestManager.transformRequest(S,o.ResourceType.Image),P)},b.prototype.listImages=function(){return this.style.listImages()},b.prototype.addLayer=function(S,P){return this._lazyInitEmptyStyle(),this.style.addLayer(S,P),this._update(!0)},b.prototype.moveLayer=function(S,P){return this.style.moveLayer(S,P),this._update(!0)},b.prototype.removeLayer=function(S){return this.style.removeLayer(S),this._update(!0)},b.prototype.getLayer=function(S){return this.style.getLayer(S)},b.prototype.setLayerZoomRange=function(S,P,F){return this.style.setLayerZoomRange(S,P,F),this._update(!0)},b.prototype.setFilter=function(S,P,F){return F===void 0&&(F={}),this.style.setFilter(S,P,F),this._update(!0)},b.prototype.getFilter=function(S){return this.style.getFilter(S)},b.prototype.setPaintProperty=function(S,P,F,N){return N===void 0&&(N={}),this.style.setPaintProperty(S,P,F,N),this._update(!0)},b.prototype.getPaintProperty=function(S,P){return this.style.getPaintProperty(S,P)},b.prototype.setLayoutProperty=function(S,P,F,N){return N===void 0&&(N={}),this.style.setLayoutProperty(S,P,F,N),this._update(!0)},b.prototype.getLayoutProperty=function(S,P){return this.style.getLayoutProperty(S,P)},b.prototype.setLight=function(S,P){return P===void 0&&(P={}),this._lazyInitEmptyStyle(),this.style.setLight(S,P),this._update(!0)},b.prototype.getLight=function(){return this.style.getLight()},b.prototype.setFeatureState=function(S,P){return this.style.setFeatureState(S,P),this._update()},b.prototype.removeFeatureState=function(S,P){return this.style.removeFeatureState(S,P),this._update()},b.prototype.getFeatureState=function(S){return this.style.getFeatureState(S)},b.prototype.getContainer=function(){return this._container},b.prototype.getCanvasContainer=function(){return this._canvasContainer},b.prototype.getCanvas=function(){return this._canvas},b.prototype._containerDimensions=function(){var S=0,P=0;return this._container&&(S=this._container.clientWidth||400,P=this._container.clientHeight||300),[S,P]},b.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},b.prototype._setupContainer=function(){var S=this._container;S.classList.add("mapboxgl-map"),(this._missingCSSCanary=u.create("div","mapboxgl-canary",S)).style.visibility="hidden",this._detectMissingCSS();var P=this._canvasContainer=u.create("div","mapboxgl-canvas-container",S);this._interactive&&P.classList.add("mapboxgl-interactive"),this._canvas=u.create("canvas","mapboxgl-canvas",P),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var F=this._containerDimensions();this._resizeCanvas(F[0],F[1]);var N=this._controlContainer=u.create("div","mapboxgl-control-container",S),V=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(J){V[J]=u.create("div","mapboxgl-ctrl-"+J,N)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},b.prototype._resizeCanvas=function(S,P){var F=o.browser.devicePixelRatio||1;this._canvas.width=F*S,this._canvas.height=F*P,this._canvas.style.width=S+"px",this._canvas.style.height=P+"px"},b.prototype._setupPainter=function(){var S=o.extend({},s.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),P=this._canvas.getContext("webgl",S)||this._canvas.getContext("experimental-webgl",S);P?(this.painter=new Jr(P,this.transform),o.webpSupported.testSupport(P)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},b.prototype._contextLost=function(S){S.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:S}))},b.prototype._contextRestored=function(S){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:S}))},b.prototype._onMapScroll=function(S){if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},b.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},b.prototype._update=function(S){return this.style?(this._styleDirty=this._styleDirty||S,this._sourcesDirty=!0,this.triggerRepaint(),this):this},b.prototype._requestRenderFrame=function(S){return this._update(),this._renderTaskQueue.add(S)},b.prototype._cancelRenderFrame=function(S){this._renderTaskQueue.remove(S)},b.prototype._render=function(S){var P,F=this,N=0,V=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(P=V.createQueryEXT(),V.beginQueryEXT(V.TIME_ELAPSED_EXT,P),N=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(S),!this._removed){var J=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var se=this.transform.zoom,de=o.browser.now();this.style.zoomHistory.update(se,de);var xe=new o.EvaluationParameters(se,{now:de,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ee=xe.crossFadingFactor();Ee===1&&Ee===this._crossFadingFactor||(J=!0,this._crossFadingFactor=Ee),this.style.update(xe)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||J)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ue=o.browser.now()-N;V.endQueryEXT(V.TIME_ELAPSED_EXT,P),setTimeout(function(){var Oe=V.getQueryObjectEXT(P,V.QUERY_RESULT_EXT)/1e6;V.deleteQueryEXT(P),F.fire(new o.Event("gpu-timing-frame",{cpuTime:Ue,gpuTime:Oe}))},50)}if(this.listens("gpu-timing-layer")){var Be=this.painter.collectGpuTimers();setTimeout(function(){var Oe=F.painter.queryGpuTimers(Be);F.fire(new o.Event("gpu-timing-layer",{layerTimes:Oe}))},50)}var Ke=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ke||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||Ke||(this._fullyLoaded=!0),this}},b.prototype.remove=function(){this._hash&&this._hash.remove();for(var S=0,P=this._controls;S<P.length;S+=1)P[S].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var F=this.painter.context.gl.getExtension("WEBGL_lose_context");F&&F.loseContext(),Ef(this._canvasContainer),Ef(this._controlContainer),Ef(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},b.prototype.triggerRepaint=function(){var S=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(P){S._frame=null,S._render(P)}))},b.prototype._onWindowOnline=function(){this._update()},b.prototype._onWindowResize=function(S){this._trackResize&&this.resize({originalEvent:S})._update()},_.showTileBoundaries.get=function(){return!!this._showTileBoundaries},_.showTileBoundaries.set=function(S){this._showTileBoundaries!==S&&(this._showTileBoundaries=S,this._update())},_.showPadding.get=function(){return!!this._showPadding},_.showPadding.set=function(S){this._showPadding!==S&&(this._showPadding=S,this._update())},_.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},_.showCollisionBoxes.set=function(S){this._showCollisionBoxes!==S&&(this._showCollisionBoxes=S,S?this.style._generateCollisionBoxes():this._update())},_.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},_.showOverdrawInspector.set=function(S){this._showOverdrawInspector!==S&&(this._showOverdrawInspector=S,this._update())},_.repaint.get=function(){return!!this._repaint},_.repaint.set=function(S){this._repaint!==S&&(this._repaint=S,this.triggerRepaint())},_.vertices.get=function(){return!!this._vertices},_.vertices.set=function(S){this._vertices=S,this._update()},b.prototype._setCacheLimits=function(S,P){o.setCacheLimits(S,P)},_.version.get=function(){return o.version},Object.defineProperties(b.prototype,_),b}(Xf);function Ef(y){y.parentNode&&y.parentNode.removeChild(y)}var be={showCompass:!0,showZoom:!0,visualizePitch:!1},Fu=function(y){var b=this;this.options=o.extend({},be,y),this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(_){return _.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(_){return b._map.zoomIn({},{originalEvent:_})}),u.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(_){return b._map.zoomOut({},{originalEvent:_})}),u.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(_){b.options.visualizePitch?b._map.resetNorthPitch({},{originalEvent:_}):b._map.resetNorth({},{originalEvent:_})}),this._compassIcon=u.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Fu.prototype._updateZoomButtons=function(){var y=this._map.getZoom(),b=y===this._map.getMaxZoom(),_=y===this._map.getMinZoom();this._zoomInButton.disabled=b,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",b.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())},Fu.prototype._rotateCompassArrow=function(){var y=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=y},Fu.prototype.onAdd=function(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Eu(this._map,this._compass,this.options.visualizePitch)),this._container},Fu.prototype.onRemove=function(){u.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Fu.prototype._createButton=function(y,b){var _=u.create("button",y,this._container);return _.type="button",_.addEventListener("click",b),_},Fu.prototype._setButtonTitle=function(y,b){var _=this._map._getUIString("NavigationControl."+b);y.title=_,y.setAttribute("aria-label",_)};var Eu=function(y,b,_){_===void 0&&(_=!1),this._clickTolerance=10,this.element=b,this.mouseRotate=new Cs({clickTolerance:y.dragRotate._mouseRotate._clickTolerance}),this.map=y,_&&(this.mousePitch=new Oh({clickTolerance:y.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener(b,"mousedown",this.mousedown),u.addEventListener(b,"touchstart",this.touchstart,{passive:!1}),u.addEventListener(b,"touchmove",this.touchmove),u.addEventListener(b,"touchend",this.touchend),u.addEventListener(b,"touchcancel",this.reset)};function Su(y,b,_){if(y=new o.LngLat(y.lng,y.lat),b){var S=new o.LngLat(y.lng-360,y.lat),P=new o.LngLat(y.lng+360,y.lat),F=_.locationPoint(y).distSqr(b);_.locationPoint(S).distSqr(b)<F?y=S:_.locationPoint(P).distSqr(b)<F&&(y=P)}for(;Math.abs(y.lng-_.center.lng)>180;){var N=_.locationPoint(y);if(N.x>=0&&N.y>=0&&N.x<=_.width&&N.y<=_.height)break;y.lng>_.center.lng?y.lng-=360:y.lng+=360}return y}Eu.prototype.down=function(y,b){this.mouseRotate.mousedown(y,b),this.mousePitch&&this.mousePitch.mousedown(y,b),u.disableDrag()},Eu.prototype.move=function(y,b){var _=this.map,S=this.mouseRotate.mousemoveWindow(y,b);if(S&&S.bearingDelta&&_.setBearing(_.getBearing()+S.bearingDelta),this.mousePitch){var P=this.mousePitch.mousemoveWindow(y,b);P&&P.pitchDelta&&_.setPitch(_.getPitch()+P.pitchDelta)}},Eu.prototype.off=function(){var y=this.element;u.removeEventListener(y,"mousedown",this.mousedown),u.removeEventListener(y,"touchstart",this.touchstart,{passive:!1}),u.removeEventListener(y,"touchmove",this.touchmove),u.removeEventListener(y,"touchend",this.touchend),u.removeEventListener(y,"touchcancel",this.reset),this.offTemp()},Eu.prototype.offTemp=function(){u.enableDrag(),u.removeEventListener(o.window,"mousemove",this.mousemove),u.removeEventListener(o.window,"mouseup",this.mouseup)},Eu.prototype.mousedown=function(y){this.down(o.extend({},y,{ctrlKey:!0,preventDefault:function(){return y.preventDefault()}}),u.mousePos(this.element,y)),u.addEventListener(o.window,"mousemove",this.mousemove),u.addEventListener(o.window,"mouseup",this.mouseup)},Eu.prototype.mousemove=function(y){this.move(y,u.mousePos(this.element,y))},Eu.prototype.mouseup=function(y){this.mouseRotate.mouseupWindow(y),this.mousePitch&&this.mousePitch.mouseupWindow(y),this.offTemp()},Eu.prototype.touchstart=function(y){y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=u.touchPos(this.element,y.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return y.preventDefault()}},this._startPos))},Eu.prototype.touchmove=function(y){y.targetTouches.length!==1?this.reset():(this._lastPos=u.touchPos(this.element,y.targetTouches)[0],this.move({preventDefault:function(){return y.preventDefault()}},this._lastPos))},Eu.prototype.touchend=function(y){y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Eu.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var zi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xv(y,b,_){var S=y.classList;for(var P in zi)S.remove("mapboxgl-"+_+"-anchor-"+P);S.add("mapboxgl-"+_+"-anchor-"+b)}var Ip,bv=function(y){function b(_,S){if(y.call(this),(_ instanceof o.window.HTMLElement||S)&&(_=o.extend({element:_},S)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=_&&_.anchor||"center",this._color=_&&_.color||"#3FB1CE",this._scale=_&&_.scale||1,this._draggable=_&&_.draggable||!1,this._clickTolerance=_&&_.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=_&&_.rotation||0,this._rotationAlignment=_&&_.rotationAlignment||"auto",this._pitchAlignment=_&&_.pitchAlignment&&_.pitchAlignment!=="auto"?_.pitchAlignment:this._rotationAlignment,_&&_.element)this._element=_.element,this._offset=o.Point.convert(_&&_.offset||[0,0]);else{this._defaultMarker=!0,this._element=u.create("div"),this._element.setAttribute("aria-label","Map marker");var P=u.createNS("http://www.w3.org/2000/svg","svg");P.setAttributeNS(null,"display","block"),P.setAttributeNS(null,"height","41px"),P.setAttributeNS(null,"width","27px"),P.setAttributeNS(null,"viewBox","0 0 27 41");var F=u.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"stroke","none"),F.setAttributeNS(null,"stroke-width","1"),F.setAttributeNS(null,"fill","none"),F.setAttributeNS(null,"fill-rule","evenodd");var N=u.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill-rule","nonzero");var V=u.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(3.0, 29.0)"),V.setAttributeNS(null,"fill","#000000");for(var J=0,se=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];J<se.length;J+=1){var de=se[J],xe=u.createNS("http://www.w3.org/2000/svg","ellipse");xe.setAttributeNS(null,"opacity","0.04"),xe.setAttributeNS(null,"cx","10.5"),xe.setAttributeNS(null,"cy","5.80029008"),xe.setAttributeNS(null,"rx",de.rx),xe.setAttributeNS(null,"ry",de.ry),V.appendChild(xe)}var Ee=u.createNS("http://www.w3.org/2000/svg","g");Ee.setAttributeNS(null,"fill",this._color);var Ue=u.createNS("http://www.w3.org/2000/svg","path");Ue.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ee.appendChild(Ue);var Be=u.createNS("http://www.w3.org/2000/svg","g");Be.setAttributeNS(null,"opacity","0.25"),Be.setAttributeNS(null,"fill","#000000");var Ke=u.createNS("http://www.w3.org/2000/svg","path");Ke.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Be.appendChild(Ke);var Oe=u.createNS("http://www.w3.org/2000/svg","g");Oe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Oe.setAttributeNS(null,"fill","#FFFFFF");var Qe=u.createNS("http://www.w3.org/2000/svg","g");Qe.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ft=u.createNS("http://www.w3.org/2000/svg","circle");ft.setAttributeNS(null,"fill","#000000"),ft.setAttributeNS(null,"opacity","0.25"),ft.setAttributeNS(null,"cx","5.5"),ft.setAttributeNS(null,"cy","5.5"),ft.setAttributeNS(null,"r","5.4999962");var xt=u.createNS("http://www.w3.org/2000/svg","circle");xt.setAttributeNS(null,"fill","#FFFFFF"),xt.setAttributeNS(null,"cx","5.5"),xt.setAttributeNS(null,"cy","5.5"),xt.setAttributeNS(null,"r","5.4999962"),Qe.appendChild(ft),Qe.appendChild(xt),N.appendChild(V),N.appendChild(Ee),N.appendChild(Be),N.appendChild(Oe),N.appendChild(Qe),P.appendChild(N),P.setAttributeNS(null,"height",41*this._scale+"px"),P.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(P),this._offset=o.Point.convert(_&&_.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ut){Ut.preventDefault()}),this._element.addEventListener("mousedown",function(Ut){Ut.preventDefault()}),xv(this._element,this._anchor,"marker"),this._popup=null}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.addTo=function(_){return this.remove(),this._map=_,_.getCanvasContainer().appendChild(this._element),_.on("move",this._update),_.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},b.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),u.remove(this._element),this._popup&&this._popup.remove(),this},b.prototype.getLngLat=function(){return this._lngLat},b.prototype.setLngLat=function(_){return this._lngLat=o.LngLat.convert(_),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},b.prototype.getElement=function(){return this._element},b.prototype.setPopup=function(_){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),_){if(!("offset"in _.options)){var S=Math.sqrt(Math.pow(13.5,2)/2);_.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(24.6+S)],"bottom-right":[-S,-1*(24.6+S)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=_,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},b.prototype._onKeyPress=function(_){var S=_.code,P=_.charCode||_.keyCode;S!=="Space"&&S!=="Enter"&&P!==32&&P!==13||this.togglePopup()},b.prototype._onMapClick=function(_){var S=_.originalEvent.target,P=this._element;this._popup&&(S===P||P.contains(S))&&this.togglePopup()},b.prototype.getPopup=function(){return this._popup},b.prototype.togglePopup=function(){var _=this._popup;return _?(_.isOpen()?_.remove():_.addTo(this._map),this):this},b.prototype._update=function(_){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Su(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var S="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?S="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(S="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var P="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?P="rotateX(0deg)":this._pitchAlignment==="map"&&(P="rotateX("+this._map.getPitch()+"deg)"),_&&_.type!=="moveend"||(this._pos=this._pos.round()),u.setTransform(this._element,zi[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+P+" "+S)}},b.prototype.getOffset=function(){return this._offset},b.prototype.setOffset=function(_){return this._offset=o.Point.convert(_),this._update(),this},b.prototype._onMove=function(_){if(!this._isDragging){var S=this._clickTolerance||this._map._clickTolerance;this._isDragging=_.point.dist(this._pointerdownPos)>=S}this._isDragging&&(this._pos=_.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},b.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},b.prototype._addDragHandler=function(_){this._element.contains(_.originalEvent.target)&&(_.preventDefault(),this._positionDelta=_.point.sub(this._pos).add(this._offset),this._pointerdownPos=_.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},b.prototype.setDraggable=function(_){return this._draggable=!!_,this._map&&(_?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},b.prototype.isDraggable=function(){return this._draggable},b.prototype.setRotation=function(_){return this._rotation=_||0,this._update(),this},b.prototype.getRotation=function(){return this._rotation},b.prototype.setRotationAlignment=function(_){return this._rotationAlignment=_||"auto",this._update(),this},b.prototype.getRotationAlignment=function(){return this._rotationAlignment},b.prototype.setPitchAlignment=function(_){return this._pitchAlignment=_&&_!=="auto"?_:this._rotationAlignment,this._update(),this},b.prototype.getPitchAlignment=function(){return this._pitchAlignment},b}(o.Evented),Yf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},pd=0,kp=!1,wm=function(y){function b(_){y.call(this),this.options=o.extend({},Yf,_),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.onAdd=function(_){var S;return this._map=_,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),S=this._setupUI,Ip!==void 0?S(Ip):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(P){S(Ip=P.state!=="denied")}):S(Ip=!!o.window.navigator.geolocation),this._container},b.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),u.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,pd=0,kp=!1},b.prototype._isOutOfMapMaxBounds=function(_){var S=this._map.getMaxBounds(),P=_.coords;return S&&(P.longitude<S.getWest()||P.longitude>S.getEast()||P.latitude<S.getSouth()||P.latitude>S.getNorth())},b.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},b.prototype._onSuccess=function(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",_)),this._finish()}},b.prototype._updateCamera=function(_){var S=new o.LngLat(_.coords.longitude,_.coords.latitude),P=_.coords.accuracy,F=this._map.getBearing(),N=o.extend({bearing:F},this.options.fitBoundsOptions);this._map.fitBounds(S.toBounds(P),N,{geolocateSource:!0})},b.prototype._updateMarker=function(_){if(_){var S=new o.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(S).addTo(this._map),this._userLocationDotMarker.setLngLat(S).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},b.prototype._updateCircleRadius=function(){var _=this._map._container.clientHeight/2,S=this._map.unproject([0,_]),P=this._map.unproject([1,_]),F=S.distanceTo(P),N=Math.ceil(2*this._accuracy/F);this._circleElement.style.width=N+"px",this._circleElement.style.height=N+"px"},b.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},b.prototype._onError=function(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var S=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=S,this._geolocateButton.setAttribute("aria-label",S),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&kp)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",_)),this._finish()}},b.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},b.prototype._setupUI=function(_){var S=this;if(this._container.addEventListener("contextmenu",function(N){return N.preventDefault()}),this._geolocateButton=u.create("button","mapboxgl-ctrl-geolocate",this._container),u.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",_===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var P=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=P,this._geolocateButton.setAttribute("aria-label",P)}else{var F=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=F,this._geolocateButton.setAttribute("aria-label",F)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=u.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new bv(this._dotElement),this._circleElement=u.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bv({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(N){N.geolocateSource||S._watchState!=="ACTIVE_LOCK"||N.originalEvent&&N.originalEvent.type==="resize"||(S._watchState="BACKGROUND",S._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),S._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),S.fire(new o.Event("trackuserlocationend")))})},b.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":pd--,kp=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++pd>1?(_={maximumAge:6e5,timeout:0},kp=!0):(_=this.options.positionOptions,kp=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},b.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},b}(o.Evented),Bh={maxWidth:100,unit:"metric"},Nh=function(y){this.options=o.extend({},Bh,y),o.bindAll(["_onMove","setUnit"],this)};function Zl(y,b,_){var S=_&&_.maxWidth||100,P=y._container.clientHeight/2,F=y.unproject([0,P]),N=y.unproject([S,P]),V=F.distanceTo(N);if(_&&_.unit==="imperial"){var J=3.2808*V;J>5280?Zf(b,S,J/5280,y._getUIString("ScaleControl.Miles")):Zf(b,S,J,y._getUIString("ScaleControl.Feet"))}else _&&_.unit==="nautical"?Zf(b,S,V/1852,y._getUIString("ScaleControl.NauticalMiles")):V>=1e3?Zf(b,S,V/1e3,y._getUIString("ScaleControl.Kilometers")):Zf(b,S,V,y._getUIString("ScaleControl.Meters"))}function Zf(y,b,_,S){var P,F,N,V=(P=_,(F=Math.pow(10,(""+Math.floor(P)).length-1))*(N=(N=P/F)>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(J){var se=Math.pow(10,Math.ceil(-Math.log(J)/Math.LN10));return Math.round(J*se)/se}(N)));y.style.width=b*(V/_)+"px",y.innerHTML=V+"&nbsp;"+S}Nh.prototype.getDefaultPosition=function(){return"bottom-left"},Nh.prototype._onMove=function(){Zl(this._map,this._container,this.options)},Nh.prototype.onAdd=function(y){return this._map=y,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Nh.prototype.onRemove=function(){u.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Nh.prototype.setUnit=function(y){this.options.unit=y,Zl(this._map,this._container,this.options)};var hc=function(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof o.window.HTMLElement?this._container=y.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};hc.prototype.onAdd=function(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},hc.prototype.onRemove=function(){u.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},hc.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},hc.prototype._setupUI=function(){var y=this._fullscreenButton=u.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);u.create("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden",!0),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},hc.prototype._updateTitle=function(){var y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y},hc.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},hc.prototype._isFullscreen=function(){return this._fullscreen},hc.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},hc.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Cm={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Pp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),dd=function(y){function b(_){y.call(this),this.options=o.extend(Object.create(Cm),_),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.addTo=function(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},b.prototype.isOpen=function(){return!!this._map},b.prototype.remove=function(){return this._content&&u.remove(this._content),this._container&&(u.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},b.prototype.getLngLat=function(){return this._lngLat},b.prototype.setLngLat=function(_){return this._lngLat=o.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},b.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},b.prototype.getElement=function(){return this._container},b.prototype.setText=function(_){return this.setDOMContent(o.window.document.createTextNode(_))},b.prototype.setHTML=function(_){var S,P=o.window.document.createDocumentFragment(),F=o.window.document.createElement("body");for(F.innerHTML=_;S=F.firstChild;)P.appendChild(S);return this.setDOMContent(P)},b.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},b.prototype.setMaxWidth=function(_){return this.options.maxWidth=_,this._update(),this},b.prototype.setDOMContent=function(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=u.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this},b.prototype.addClassName=function(_){this._container&&this._container.classList.add(_)},b.prototype.removeClassName=function(_){this._container&&this._container.classList.remove(_)},b.prototype.setOffset=function(_){return this.options.offset=_,this._update(),this},b.prototype.toggleClassName=function(_){if(this._container)return this._container.classList.toggle(_)},b.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=u.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},b.prototype._onMouseUp=function(_){this._update(_.point)},b.prototype._onMouseMove=function(_){this._update(_.point)},b.prototype._onDrag=function(_){this._update(_.point)},b.prototype._update=function(_){var S=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=u.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=u.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(xe){return S._container.classList.add(xe)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Su(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||_)){var P=this._pos=this._trackPointer&&_?_:this._map.project(this._lngLat),F=this.options.anchor,N=function xe(Ee){if(Ee){if(typeof Ee=="number"){var Ue=Math.round(Math.sqrt(.5*Math.pow(Ee,2)));return{center:new o.Point(0,0),top:new o.Point(0,Ee),"top-left":new o.Point(Ue,Ue),"top-right":new o.Point(-Ue,Ue),bottom:new o.Point(0,-Ee),"bottom-left":new o.Point(Ue,-Ue),"bottom-right":new o.Point(-Ue,-Ue),left:new o.Point(Ee,0),right:new o.Point(-Ee,0)}}if(Ee instanceof o.Point||Array.isArray(Ee)){var Be=o.Point.convert(Ee);return{center:Be,top:Be,"top-left":Be,"top-right":Be,bottom:Be,"bottom-left":Be,"bottom-right":Be,left:Be,right:Be}}return{center:o.Point.convert(Ee.center||[0,0]),top:o.Point.convert(Ee.top||[0,0]),"top-left":o.Point.convert(Ee["top-left"]||[0,0]),"top-right":o.Point.convert(Ee["top-right"]||[0,0]),bottom:o.Point.convert(Ee.bottom||[0,0]),"bottom-left":o.Point.convert(Ee["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(Ee["bottom-right"]||[0,0]),left:o.Point.convert(Ee.left||[0,0]),right:o.Point.convert(Ee.right||[0,0])}}return xe(new o.Point(0,0))}(this.options.offset);if(!F){var V,J=this._container.offsetWidth,se=this._container.offsetHeight;V=P.y+N.bottom.y<se?["top"]:P.y>this._map.transform.height-se?["bottom"]:[],P.x<J/2?V.push("left"):P.x>this._map.transform.width-J/2&&V.push("right"),F=V.length===0?"bottom":V.join("-")}var de=P.add(N[F]).round();u.setTransform(this._container,zi[F]+" translate("+de.x+"px,"+de.y+"px)"),xv(this._container,F,"popup")}},b.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var _=this._container.querySelector(Pp);_&&_.focus()}},b.prototype._onClose=function(){this.remove()},b}(o.Evented),pc={version:o.version,supported:s,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:Il,NavigationControl:Fu,GeolocateControl:wm,AttributionControl:Ys,ScaleControl:Nh,FullscreenControl:hc,Popup:dd,Marker:bv,Style:ea,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Ht().acquire($t)},clearPrewarmedResources:function(){var y=Rr;y&&(y.isPreloaded()&&y.numActive()===1?(y.release($t),Rr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(y){o.config.ACCESS_TOKEN=y},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(y){o.config.API_URL=y},get workerCount(){return pr.workerCount},set workerCount(y){pr.workerCount=y},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){o.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage:function(y){o.clearTileCache(y)},workerUrl:""};return pc}),i})})(f6);var MC=f6.exports,dje=function(){function e(){st(this,e)}return ot(e,[{key:"syncWithMapCamera",value:function(t){var n=t.center,i=t.zoom,a=t.pitch,o=t.bearing,s=t.viewportHeight,u=t.viewportWidth;this.viewport=new i6({width:u,height:s,longitude:n&&n[0],latitude:n&&n[1],zoom:i,pitch:a,bearing:o})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,n){return this.viewport.projectFlat(t,n)}}]),e}(),vje=["id","attributionControl","style","token","rotation","mapInstance"],WH,XH;function gje(e){var r=mje();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function mje(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yje(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var a=r.body||r.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):r.documentElement.appendChild(i)}var o=r.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(r.createTextNode(e)),i.appendChild(o),o}}yje(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`);window.mapboxgl=MC;var _je=0,YH="pk.eyJ1IjoiMTg5Njk5NDg2MTkiLCJhIjoiY2s5OXVzdHlzMDVneDNscDVjdzVmeXl0dyJ9.81SQ5qaJS0xExYLbDZAGpQ",xje=(WH=Ri(),WH(XH=function(e){er(t,e);var r=gje(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"version",ko.MAPBOX),n}return ot(t,[{key:"getType",value:function(){return"mapbox"}},{key:"lngLatToCoord",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},o=this.lngLatToMercator(i,0),s=o.x,u=o.y;return[s-a.x,u-a.y]}},{key:"lngLatToMercator",value:function(i,a){var o=window.mapboxgl.MercatorCoordinate.fromLngLat(i,a),s=o.x,u=s===void 0?0:s,l=o.y,f=l===void 0?0:l,h=o.z,p=h===void 0?0:h;return{x:u,y:f,z:p}}},{key:"getModelMatrix",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},l=window.mapboxgl.MercatorCoordinate.fromLngLat(i,a),f=l.meterInMercatorCoordinateUnits(),h=ts();return ih(h,h,Io(l.x-u.x,l.y-u.y,l.z||0-u.z)),op(h,h,Io(f*s[0],-f*s[1],f*s[2])),m_(h,h,o[0]),g1(h,h,o[1]),y_(h,h,o[2]),h}},{key:"init",value:function(){var n=Hi(Xr.mark(function a(){var o,s,u,l,f,h,p,v,m,x,E,A,L;return Xr.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:o=this.config,s=o.id,u=s===void 0?"map":s,l=o.attributionControl,f=l===void 0?!1:l,h=o.style,p=h===void 0?"light":h,v=o.token,m=v===void 0?YH:v,x=o.rotation,E=x===void 0?0:x,A=o.mapInstance,L=oc(o,vje),this.viewport=new dje,!A&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),m===YH&&p!=="blank"&&!window.mapboxgl.accessToken&&!A&&console.warn(this.configService.getSceneWarninfo("MapToken")),!A&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=m),A?(this.map=A,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(u),this.map=new window.mapboxgl.Map(Et({container:this.$mapContainer,style:this.getMapStyle(p),attributionControl:f,bearing:E},L))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return R.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"destroy",value:function(){var i,a;(i=this.$mapContainer)===null||i===void 0||(a=i.parentNode)===null||a===void 0||a.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];(a=this.eventEmitter).emit.apply(a,[i].concat(s))}},{key:"once",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];(a=this.eventEmitter).once.apply(a,[i].concat(s))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(i,a){var o=new MC.LngLat(i[0],i[1]),s=new MC.LngLat(a[0],a[1]),u=o.distanceTo(s),l=MC.MercatorCoordinate.fromLngLat({lng:i[0],lat:i[1]}),f=MC.MercatorCoordinate.fromLngLat({lng:a[0],lat:a[1]}),h=l.x,p=l.y,v=f.x,m=f.y,x=Math.sqrt(Math.pow(h-v,2)+Math.pow(p-m,2))*4194304*2;return x/u}},{key:"exportMap",value:function(i){var a=this.map.getCanvas(),o=i==="jpg"?a==null?void 0:a.toDataURL("image/jpeg"):a==null?void 0:a.toDataURL("image/png");return o}},{key:"creatMapContainer",value:function(i){var a=i;typeof i=="string"&&(a=document.getElementById(i));var o=document.createElement("div");return o.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,o.id="l7_mapbox_div"+_je++,a.appendChild(o),o}}]),t}(Tk))||XH);function bje(e){var r=wje();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function wje(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cje(e,r){var t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(t||n)&&(r||(r=document),!!r)){var i=r.head||r.getElementsByTagName("head")[0];if(!i){i=r.createElement("head");var a=r.body||r.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):r.documentElement.appendChild(i)}var o=r.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(r.createTextNode(e)),i.appendChild(o),o}}Cje(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var Eje=function(e){er(t,e);var r=bje(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getServiceConstructor",value:function(){return xje}}]),t}(K2),Sje=Object.freeze(Object.defineProperty({__proto__:null,get Version(){return ko},GaodeMap:P$e,GaodeMapV2:V$e,Mapbox:Eje,Map:pje,Earth:ije,Viewport:gL,BaseMapWrapper:K2,BaseMapService:Tk},Symbol.toStringTag,{value:"Module"}));function Aje(e,r){var t=[r[0]-e[0],r[1]-e[1]],n=FB(t),i=[e[0]+n[0]*1e-4,e[1]+n[1]*1e-4];return i}function Tje(e,r,t){if(e.length>0&&r.version===ko["GAODE2.x"]){var n=t.coordCenter;typeof e[0].coordinates[0]=="number"?e.filter(function(i){return!i.originCoordinates}).map(function(i){i.version=ko["GAODE2.x"],i.originCoordinates=Kt.exports.cloneDeep(i.coordinates),i.coordinates=r.lngLatToCoordByLayer(i.coordinates,n)}):e.filter(function(i){return!i.originCoordinates}).map(function(i){i.version=ko["GAODE2.x"],i.originCoordinates=Kt.exports.cloneDeep(i.coordinates),i.coordinates=r.lngLatToCoordsByLayer(i.coordinates,n)})}}function Mje(e,r){e.length>0&&r.version===ko.SIMPLE&&e.map(function(t){t.simpleCoordinate||(t.coordinates=Lje(t.coordinates,r),t.simpleCoordinate=!0)})}function Lje(e,r){if(typeof e[0]=="number")return r.simpleMapCoord.unproject(e);if(e[0]&&e[0][0]instanceof Array){var t=[];return e.map(function(i){var a=[];i.map(function(o){a.push(r.simpleMapCoord.unproject(o))}),t.push(a)}),t}else{var n=[];return e.map(function(i){n.push(r.simpleMapCoord.unproject(i))}),n}}function Ije(e,r,t){var n;if(!e.scale)return[];var i=(e==null||(n=e.scale)===null||n===void 0?void 0:n.scalers)||[],a=[];i.forEach(function(s){var u,l=s.field;(r.hasOwnProperty(l)||((u=e.scale)===null||u===void 0?void 0:u.type)==="variable")&&a.push(r[l])});var o=e.mapping?e.mapping(a):[];return e.name==="color"&&!DB(o[0])?[t]:o}function kje(e,r,t,n,i,a){var o=a==null?void 0:a.getLayerConfig(),s=o.arrow,u=s===void 0?{enable:!1}:s,l=r.map(function(f){var h={id:f._id,coordinates:f.coordinates};if(e.filter(function(m){return m.scale!==void 0}).forEach(function(m){var x=Ije(m,f,i);m.needRemapping=!1,m.name==="color"&&(x=x.map(function(E){return Sa(E)})),h[m.name]=Array.isArray(x)&&x.length===1?x[0]:x,m.name==="shape"&&(h.shape=t.getIconFontKey(h[m.name]))}),h.shape==="line"&&u.enable){var p=h.coordinates,v=Aje(p[0],p[1]);h.coordinates.splice(1,0,v,v)}return h});return Tje(l,n,a),Mje(l,n),l}function Pje(e,r,t,n,i,a){var o=new q2(i,a),s=e.getBottomColor(),u=n.getLayerStyleAttributes()||[],l=o.data.dataArray,f=l,h=kje(u,f,r,t,s,e);return o.destroy(),h}function xie(e){return e.map(function(r){return typeof r=="string"&&(r=[r,{}]),r})}function bie(e,r,t,n){var i=e.multiPassRenderer,a=e.getLayerConfig(),o=a.enableTAA;return o?i.add(n("taa")):i.add(n("render")),xie(r).forEach(function(s){var u=tn(s,2),l=u[0],f=u[1];i.add(t(l),f)}),i.add(t("copy")),i}var Rje=[["circle","cylinder"],["square","cylinder"],["triangle","cylinder"],["pentagon","cylinder"],["hexagon","cylinder"],["octogon","cylinder"],["hexagram","cylinder"],["rhombus","cylinder"],["vesica","cylinder"]];function Oje(e,r,t){if(typeof r=="string"&&typeof t=="string"&&r!==t){if(e.type==="PointLayer"){e.dataState.dataSourceNeedUpdate=!0;return}Rje.map(function(n){if(n.includes(r)&&n.includes(t)){e.dataState.dataSourceNeedUpdate=!0;return}})}}var Fje=["passes"],Dje=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber","workerEnabled","workerOptions"],ZH,MO,qH;function Bje(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Nje(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Nje(e,r){if(!!e){if(typeof e=="string")return KH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return KH(e,r)}}function KH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function zje(e){var r=$je();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function $je(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var QH=0,$f=(ZH=Ck(Mt.IGlobalConfigService),MO=function(e){er(t,e);var r=zje(t);function t(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return st(this,t),n=r.call(this),X(He(n),"id","".concat(QH++)),X(He(n),"name","".concat(QH)),X(He(n),"visible",!0),X(He(n),"zIndex",0),X(He(n),"inited",!1),X(He(n),"layerModelNeedUpdate",!1),X(He(n),"pickedFeatureID",null),X(He(n),"selectedFeatureID",null),X(He(n),"styleNeedUpdate",!1),X(He(n),"forceRender",!1),X(He(n),"clusterZoom",0),X(He(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),X(He(n),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),X(He(n),"hooks",{init:new sO,afterInit:new sO,beforeRender:new sO,beforeRenderData:new BNe,afterRender:new Bg,beforePickingEncode:new Bg,afterPickingEncode:new Bg,beforeHighlight:new Bg(["pickedColor"]),afterHighlight:new Bg,beforeSelect:new Bg(["pickedColor"]),afterSelect:new Bg,beforeDestroy:new Bg,afterDestroy:new Bg}),X(He(n),"models",[]),X(He(n),"modelLoaded",!1),X(He(n),"layerChildren",[]),X(He(n),"masks",[]),X(He(n),"isVector",!1),ua(He(n),"configService",qH,He(n)),X(He(n),"animateOptions",{enable:!1}),X(He(n),"currentPickId",null),X(He(n),"pendingStyleAttributes",[]),X(He(n),"scaleOptions",{}),X(He(n),"animateStatus",!1),X(He(n),"bottomColor","rgba(0, 0, 0, 0)"),X(He(n),"isDestroyed",!1),X(He(n),"encodeDataLength",0),X(He(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0;var a=n.getLayerConfig();a&&a.autoFit&&n.fitBounds(a.fitBoundsOptions),n.reRender()}),n.name=i.name||n.id,n.zIndex=i.zIndex||0,n.rawConfig=i,n}return ot(t,[{key:"addMaskLayer",value:function(i){this.masks.push(i)}},{key:"removeMaskLayer",value:function(i){var a=this.masks.indexOf(i);a>-1&&this.masks.splice(a,1),i.destroy()}},{key:"getAttribute",value:function(i){return this.styleAttributeService.getLayerStyleAttribute(i)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(i){var a=this;if(Object.keys(i).map(function(s){s in a.rawConfig&&(a.rawConfig[s]=i[s])}),!this.inited)this.needUpdateConfig=Et(Et({},this.needUpdateConfig),i);else{var o=this.container.get(Mt.SceneID);s$e(i,this),this.configService.setLayerConfig(o,this.id,Et(Et(Et({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),i)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(i,a){this.container=i,this.sceneContainer=a}},{key:"getContainer",value:function(){return this.container}},{key:"setBottomColor",value:function(i){this.bottomColor=i}},{key:"getBottomColor",value:function(){return this.bottomColor}},{key:"addPlugin",value:function(i){return this.plugins.push(i),this}},{key:"init",value:function(){var i=this,a=this.container.get(Mt.SceneID);this.configService.setLayerConfig(a,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Mt.IIconService),this.fontService=this.container.get(Mt.IFontService),this.rendererService=this.container.get(Mt.IRendererService),this.layerService=this.container.get(Mt.ILayerService),this.interactionService=this.container.get(Mt.IInteractionService),this.pickingService=this.container.get(Mt.IPickingService),this.mapService=this.container.get(Mt.IMapService);var o=this.getLayerConfig(),s=o.enableMultiPassRenderer,u=o.passes;s&&u!==null&&u!==void 0&&u.length&&u.length>0&&this.mapService.on("mapAfterFrameChange",function(){i.renderLayers()}),this.cameraService=this.container.get(Mt.ICameraService),this.coordinateService=this.container.get(Mt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Mt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Mt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Mt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Mt.IStyleAttributeService),this.multiPassRenderer=this.container.get(Mt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(p){var v=p.attributeName,m=p.attributeField,x=p.attributeValues,E=p.updateOptions;i.styleAttributeService.updateStyleAttribute(v,{scale:Et({field:m},i.splitValuesAndCallbackInAttribute(x,i.getLayerConfig()[v]))},E)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Mt.ILayerPlugin);var l=Bje(this.plugins),f;try{for(l.s();!(f=l.n()).done;){var h=f.value;h.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(p){l.e(p)}finally{l.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"updateModelData",value:function(i){i.attributes&&i.elements?this.models.map(function(a){a.updateAttributesAndElements(i.attributes,i.elements)}):console.warn("data error")}},{key:"createModelData",value:function(i,a){var o;if((o=this.layerModel)!==null&&o!==void 0&&o.createModelData)return this.layerModel.createModelData(a);var s=this.calculateEncodeData(i,a),u=this.triangulation;return s&&u?this.styleAttributeService.createAttributesAndIndices(s,u):{attributes:void 0,elements:void 0}}},{key:"calculateEncodeData",value:function(i,a){return this.inited?Pje(this,this.fontService,this.mapService,this.styleAttributeService,i,a):(console.warn("layer not inited!"),null)}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(Et(Et({},this.getDefaultConfig()),this.rawConfig));var i=this.getLayerConfig(),a=i.animateOption;a!=null&&a.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(i,a,o){return this.updateStyleAttribute("color",i,a,o),this}},{key:"texture",value:function(i,a,o){return this.updateStyleAttribute("texture",i,a,o),this}},{key:"rotate",value:function(i,a,o){return this.updateStyleAttribute("rotate",i,a,o),this}},{key:"size",value:function(i,a,o){return this.updateStyleAttribute("size",i,a,o),this}},{key:"filter",value:function(i,a,o){return this.updateStyleAttribute("filter",i,a,o),this}},{key:"shape",value:function(i,a,o){var s,u,l,f=(s=this.styleAttributeService)===null||s===void 0||(u=s.getLayerStyleAttribute("shape"))===null||u===void 0||(l=u.scale)===null||l===void 0?void 0:l.field,h=i;return this.shapeOption={field:i,values:a},this.updateStyleAttribute("shape",i,a,o),this.tileLayer||Oje(this,f,h),this}},{key:"label",value:function(i,a,o){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:i,attributeValues:a,updateOptions:o}),this}},{key:"animate",value:function(i){var a={};return Kt.exports.isObject(i)?(a.enable=!0,a=Et(Et({},a),i)):a.enable=i,this.updateLayerConfig({animateOption:a}),this}},{key:"source",value:function(i,a){return(i==null?void 0:i.type)==="source"?(this.setSource(i),this):(this.sourceOption={data:i,options:a},this.clusterZoom=0,this)}},{key:"setData",value:function(i,a){var o=this;return this.inited?this.layerSource.setData(i,a):this.on("inited",function(){var s=o.getSource();s?o.layerSource.setData(i,a):(o.source(new q2(i,a)),o.sourceEvent())}),this}},{key:"style",value:function(i){var a=this,o=this.getLayerConfig(),s=i.passes,u=oc(i,Fje);return s&&xie(s).forEach(function(l){var f=a.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(l[0]);f&&f.updateOptions(l[1])}),this.rawConfig=Et(Et({},this.rawConfig),u),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),o&&o.mask===!0&&i.mask===!1&&(this.clearModels(),this.layerModel.buildModels(function(l){a.models=l})),this}},{key:"scale",value:function(i,a){return Kt.exports.isObject(i)?this.scaleOptions=Et(Et({},this.scaleOptions),i):this.scaleOptions[i]=a,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.tileLayer?(this.tileLayer.render(),this):this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(),this)}},{key:"renderMultiPass",value:function(){var n=Hi(Xr.mark(function a(){return Xr.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){s.next=2;break}return s.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){s.next=7;break}return s.next=5,this.multiPassRenderer.render();case 5:s.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return s.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"active",value:function(i){var a={};return a.enableHighlight=Kt.exports.isObject(i)?!0:i,Kt.exports.isObject(i)?(a.enableHighlight=!0,i.color&&(a.highlightColor=i.color),i.mix&&(a.activeMix=i.mix)):a.enableHighlight=!!i,this.updateLayerConfig(a),this}},{key:"setActive",value:function(i,a){var o=this;if(Kt.exports.isObject(i)){var s=i.x,u=s===void 0?0:s,l=i.y,f=l===void 0?0:l;this.updateLayerConfig({highlightColor:Kt.exports.isObject(a)?a.color:this.getLayerConfig().highlightColor,activeMix:Kt.exports.isObject(a)?a.mix:this.getLayerConfig().activeMix}),this.pick({x:u,y:f})}else this.updateLayerConfig({pickedFeatureID:i,highlightColor:Kt.exports.isObject(a)?a.color:this.getLayerConfig().highlightColor,activeMix:Kt.exports.isObject(a)?a.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(Sy(i)).then(function(){setTimeout(function(){o.reRender()},1)})}},{key:"select",value:function(i){var a={};return a.enableSelect=Kt.exports.isObject(i)?!0:i,Kt.exports.isObject(i)?(a.enableSelect=!0,i.color&&(a.selectColor=i.color),i.mix&&(a.selectMix=i.mix)):a.enableSelect=!!i,this.updateLayerConfig(a),this}},{key:"setSelect",value:function(i,a){var o=this;if(Kt.exports.isObject(i)){var s=i.x,u=s===void 0?0:s,l=i.y,f=l===void 0?0:l;this.updateLayerConfig({selectColor:Kt.exports.isObject(a)?a.color:this.getLayerConfig().selectColor,selectMix:Kt.exports.isObject(a)?a.mix:this.getLayerConfig().selectMix}),this.pick({x:u,y:f})}else this.updateLayerConfig({pickedFeatureID:i,selectColor:Kt.exports.isObject(a)?a.color:this.getLayerConfig().selectColor,selectMix:Kt.exports.isObject(a)?a.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(Sy(i)).then(function(){setTimeout(function(){o.reRender()},1)})}},{key:"setBlend",value:function(i){return this.updateLayerConfig({blend:i}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(i){return this.zIndex=i,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(i){this.currentPickId=i}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(i){this.selectedFeatureID=i}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var i=this.mapService.getZoom(),a=this.getLayerConfig(),o=a.visible,s=a.minZoom,u=s===void 0?-1/0:s,l=a.maxZoom,f=l===void 0?1/0:l;return!!o&&i>=u&&i<=f}},{key:"setMultiPass",value:function(i,a){if(this.updateLayerConfig({enableMultiPassRenderer:i}),a&&this.updateLayerConfig({passes:a}),i){var o=this.getLayerConfig(),s=o.passes,u=s===void 0?[]:s;this.multiPassRenderer=bie(this,u,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var l=this.rendererService.getViewportSize(),f=l.width,h=l.height;this.multiPassRenderer.resize(f,h)}return this}},{key:"setMinZoom",value:function(i){return this.updateLayerConfig({minZoom:i}),this}},{key:"getMinZoom",value:function(){var i=this.getLayerConfig(),a=i.minZoom;return a}},{key:"getMaxZoom",value:function(){var i=this.getLayerConfig(),a=i.maxZoom;return a}},{key:"get",value:function(i){var a=this.getLayerConfig();return a[i]}},{key:"setMaxZoom",value:function(i){return this.updateLayerConfig({maxZoom:i}),this}},{key:"setAutoFit",value:function(i){return this.updateLayerConfig({autoFit:i}),this}},{key:"fitBounds",value:function(i){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var a=this.getSource(),o=a.extent,s=o.some(function(u){return Math.abs(u)===1/0});return s?this:(this.mapService.fitBounds([[o[0],o[1]],[o[2],o[3]]],i),this)}},{key:"destroy",value:function(){var i,a,o,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isDestroyed||(this.layerChildren.map(function(u){return u.destroy(!1)}),this.layerChildren=[],this.masks.map(function(u){return u.destroy(!1)}),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(i=this.multiPassRenderer)===null||i===void 0||i.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(a=this.layerModel)===null||a===void 0||a.clearModels(s),(o=this.tileLayer)===null||o===void 0||o.destroy(),this.models=[],this.layerService.cleanRemove(this,s),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var i;this.models.forEach(function(a){return a.destroy()}),(i=this.layerModel)===null||i===void 0||i.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(i){return i.needRescale||i.needRemapping||i.needRegenerateVertices}).length}},{key:"setSource",value:function(i){var a=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=i,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var o=this.mapService.getZoom();this.layerSource.updateClusterData(o)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(){if(a.coordCenter===void 0){var s,u=a.layerSource.center;a.coordCenter=u,!((s=a.mapService)===null||s===void 0)&&s.setCoordCenter&&a.mapService.setCoordCenter(u)}a.sourceEvent()})}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(i){this.encodedData=i,this.encodeDataLength=i.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(i){return this.styleAttributeService.getLayerAttributeScale(i)}},{key:"getLegend",value:function(i){var a,o,s,u=this.styleAttributeService.getLayerStyleAttribute(i),l=(u==null||(a=u.scale)===null||a===void 0?void 0:a.scalers)||[];return{type:(o=l[0].option)===null||o===void 0?void 0:o.type,field:u==null||(s=u.scale)===null||s===void 0?void 0:s.field,items:this.getLegendItems(i)}}},{key:"getLegendItems",value:function(i){var a=this.styleAttributeService.getLayerAttributeScale(i);if(!a)return[];if(a.invertExtent){var o=a.range().map(function(l){return X({value:a.invertExtent(l)},i,l)});return o}else if(a.ticks){var s=a.ticks().map(function(l){return X({value:l},i,a(l))});return s}else if(a!=null&&a.domain){var u=a.domain().filter(function(l){return!Kt.exports.isUndefined(l)}).map(function(l){return X({value:l},i,a(l))});return u}return[]}},{key:"pick",value:function(i){var a=i.x,o=i.y;this.interactionService.triggerHover({x:a,y:o})}},{key:"boxSelect",value:function(i,a){this.pickingService.boxPickLayer(this,i,a)}},{key:"buildLayerModel",value:function(i){var a=this,o=i.moduleName,s=i.vertexShader,u=i.fragmentShader,l=i.triangulation,f=i.segmentNumber,h=i.workerEnabled,p=h===void 0?!1:h,v=i.workerOptions,m=oc(i,Dje);this.shaderModuleService.registerModule(o,{vs:s,fs:u});var x=this.shaderModuleService.getModule(o),E=x.vs,A=x.fs,L=x.uniforms,k=this.rendererService.createModel;return new Promise(function(R,D){setTimeout(function(){if(v&&v.modelType in jB&&p)a.styleAttributeService.createAttributesAndIndicesAscy(a.encodedData,f,v).then(function(Q){var te=Q.attributes,ie=Q.elements,ve=k(Et({attributes:te,uniforms:L,fs:A,vs:E,elements:ie,blend:TD[Fd.normal]},m));R(ve)}).catch(function(Q){return D(Q)});else{var $=a.styleAttributeService.createAttributesAndIndices(a.encodedData,l,f),j=$.attributes,H=$.elements,ee=$.count,U=Et({attributes:j,uniforms:L,fs:A,vs:E,elements:H,blend:TD[Fd.normal]},m);ee&&(U.count=ee);var W=k(U);R(W)}})})}},{key:"createAttributes",value:function(i){var a=i.triangulation,o=this.styleAttributeService.createAttributes(this.encodedData,a),s=o.attributes;return s}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(i){if(this.rawConfig.usage==="basemap")return!1;var a=this.getLayerConfig(),o=a.enableHighlight,s=o===void 0?!0:o,u=a.enableSelect,l=u===void 0?!0:u,f=this.eventNames().indexOf(i)!==-1||this.eventNames().indexOf("un"+i)!==-1;return(i==="click"||i==="dblclick")&&l&&(f=!0),i==="mousemove"&&(s||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(f=!0),this.isVisible()&&f}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderMulPass",value:function(){var n=Hi(Xr.mark(function a(o){return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,o.render();case 2:case"end":return u.stop()}},a)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"renderModels",value:function(i){var a=this;return this.encodeDataLength<=0&&!this.forceRender?this:(this.layerModelNeedUpdate&&this.layerModel&&this.layerModel.buildModels(function(o){a.models=o,a.hooks.beforeRender.call(),a.layerModelNeedUpdate=!1}),this.models.forEach(function(o){o.draw({uniforms:a.layerModel.getUninforms()},i)}),this)}},{key:"updateStyleAttribute",value:function(i,a,o,s){this.inited?this.styleAttributeService.updateStyleAttribute(i,{scale:Et({field:a},this.splitValuesAndCallbackInAttribute(o,this.getLayerConfig()[a]))},s):this.pendingStyleAttributes.push({attributeName:i,attributeField:a,attributeValues:o,updateOptions:s})}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(i){console.warn("empty fn")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"dispatchModelLoad",value:function(i){var a=this;this.models.forEach(function(o){return o.destroy()}),this.models=[],this.models=i,this.emit("modelLoaded",null),this.modelLoaded=!0,setTimeout(function(){a.layerService.renderLayers()},32)}},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(i,a){return{values:Kt.exports.isFunction(i)?void 0:i||a,callback:Kt.exports.isFunction(i)?i:void 0}}}]),t}(zf.exports.EventEmitter),qH=ia(MO.prototype,"configService",[ZH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MO),JH,LO,ej;function Uje(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Vje(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Vje(e,r){if(!!e){if(typeof e=="string")return tj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tj(e,r)}}function tj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var qi=(JH=Ck(Mt.IGlobalConfigService),LO=function(){function e(r){st(this,e),ua(this,"configService",ej,this),this.layer=r,this.rendererService=r.getContainer().get(Mt.IRendererService),this.pickingService=r.getContainer().get(Mt.IPickingService),this.shaderModuleService=r.getContainer().get(Mt.IShaderModuleService),this.styleAttributeService=r.getContainer().get(Mt.IStyleAttributeService),this.mapService=r.getContainer().get(Mt.IMapService),this.iconService=r.getContainer().get(Mt.IIconService),this.fontService=r.getContainer().get(Mt.IFontService),this.cameraService=r.getContainer().get(Mt.ICameraService),this.layerService=r.getContainer().get(Mt.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var t=this.rendererService.createTexture2D;this.createTexture2D=t,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:K.NEAREST,min:K.NEAREST,width:1,height:1}))}return ot(e,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertiesExist.hasOpacity,this.stylePropertiesExist.hasStrokeOpacity,this.stylePropertiesExist.hasStrokeWidth,this.stylePropertiesExist.hasStroke,this.stylePropertiesExist.hasOffsets,this.stylePropertiesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(t){var n=!1;return Kt.exports.isEqual(t.thetaOffset,this.cacheStyleProperties.thetaOffset)||(n=!0,this.cacheStyleProperties.thetaOffset=t.thetaOffset),Kt.exports.isEqual(t.opacity,this.cacheStyleProperties.opacity)||(n=!0,this.cacheStyleProperties.opacity=t.opacity),Kt.exports.isEqual(t.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(n=!0,this.cacheStyleProperties.strokeOpacity=t.strokeOpacity),Kt.exports.isEqual(t.strokeWidth,this.cacheStyleProperties.strokeWidth)||(n=!0,this.cacheStyleProperties.strokeWidth=t.strokeWidth),Kt.exports.isEqual(t.stroke,this.cacheStyleProperties.stroke)||(n=!0,this.cacheStyleProperties.stroke=t.stroke),Kt.exports.isEqual(t.offsets,this.cacheStyleProperties.offsets)||(n=!0,this.cacheStyleProperties.offsets=t.offsets),this.dataTexture===void 0&&(n=!0),n}},{key:"judgeStyleAttributes",value:function(t){this.clearLastCalRes(),t.opacity!==void 0&&!Kt.exports.isNumber(t.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertiesExist.hasOpacity=1,this.cellLength+=1),t.strokeOpacity!==void 0&&!Kt.exports.isNumber(t.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertiesExist.hasStrokeOpacity=1,this.cellLength+=1),t.strokeWidth!==void 0&&!Kt.exports.isNumber(t.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertiesExist.hasStrokeWidth=1,this.cellLength+=1),t.stroke!==void 0&&!this.isStaticColor(t.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertiesExist.hasStroke=1,this.cellLength+=4),t.offsets!==void 0&&!this.isOffsetStatic(t.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertiesExist.hasOffsets=1,this.cellLength+=2),t.thetaOffset!==void 0&&!Kt.exports.isNumber(t.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertiesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(t){return Kt.exports.isString(t)?!!q0(t):!1}},{key:"getStrokeColor",value:function(t){if(this.isStaticColor(t)){var n=Sa(t);return n[0]=n[0]?n[0]:0,n[1]=n[1]?n[1]:0,n[2]=n[2]?n[2]:0,n[3]=n[3]?n[3]:0,n}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(t){return!!(Array.isArray(t)&&t.length===2&&Kt.exports.isNumber(t[0])&&Kt.exports.isNumber(t[1]))}},{key:"patchMod",value:function(t,n){for(var i=0;i<n;i++)t.push(-1)}},{key:"patchData",value:function(t,n,i){var a=Uje(i),o;try{for(a.s();!(o=a.n()).done;){var s=o.value,u=s.attr,l=s.count,f=n[u];f!==void 0?u==="stroke"?t.push.apply(t,Pr(Sa(f))):u==="offsets"?this.isOffsetStatic(f)?t.push(-f[0],f[1]):t.push(0,0):t.push(Kt.exports.isNumber(f)?f:1):this.patchMod(t,l)}}catch(h){a.e(h)}finally{a.f()}}},{key:"calDataFrame",value:function(t,n,i){for(var a=n.length,o=Math.ceil(a*t/this.DATA_TEXTURE_WIDTH),s=o*this.DATA_TEXTURE_WIDTH,u=[],l=0;l<a;l++){var f=n[l];this.patchData(u,f,i)}for(var h=u.length;h<s;h++)u.push(-1);return{data:u,width:this.DATA_TEXTURE_WIDTH,height:o}}},{key:"getBlend",value:function(){var t=this.layer.getLayerConfig(),n=t.blend,i=n===void 0?"normal":n;return TD[Fd[i]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(t){throw new Error("Method not implemented.")}},{key:"initModels",value:function(t){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){var t=this.layer.getLayerConfig(),n=t.animateOption;n.enable&&this.layer.setAnimateStartTime()}}]),e}(),ej=ia(LO.prototype,"configService",[JH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LO),OD;(function(e){e[e.solid=0]="solid",e[e.dash=1]="dash"})(OD||(OD={}));var u1;(function(e){e.VERTICAL="vertical",e.HORIZONTAL="horizontal"})(u1||(u1={}));var _L;(function(e){e.NORMAL="normal",e.REPLACE="replace"})(_L||(_L={}));var k0;(function(e){e.ALWAYS="always",e.DRAGEND="dragend"})(k0||(k0={}));function Gje(e){var r=Hje();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Hje(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jje=function(e){er(t,e);var r=Gje(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateMode",k0.ALWAYS),X(He(n),"renderUpdate",function(){var s=n.layer.getLayerConfig(),u=s.zIndex,l=u===void 0?10:u,f=s.update,h=f===void 0?k0.ALWAYS:f,p=s.animateOption,v=p===void 0?{enable:!1,duration:20}:p;+n.canvas.style.zIndex===l&&(n.canvas.style.zIndex=l+""),n.updateMode!==h&&(n.updateMode=h,n.unBindListener(),n.bindListener()),n.updateMode===k0.ALWAYS&&v.enable&&n.renderCanvas()}),X(He(n),"unBindListener",function(){n.mapService.off("mapchange",n.renderCanvas),n.mapService.off("zoomstart",n.clearCanvas),n.mapService.off("zoomend",n.renderCanvas),n.mapService.off("movestart",n.clearCanvas),n.mapService.off("moveend",n.renderCanvas)}),X(He(n),"bindListener",function(){n.updateMode===k0.ALWAYS?n.mapService.on("mapchange",n.renderCanvas):(n.mapService.on("zoomstart",n.clearCanvas),n.mapService.on("zoomend",n.renderCanvas),n.mapService.on("movestart",n.clearCanvas),n.mapService.on("moveend",n.renderCanvas))}),X(He(n),"clearCanvas",function(){if(n.ctx){var s=n.rendererService.getViewportSize(),u=s.width,l=s.height;n.ctx.clearRect(0,0,u,l)}}),X(He(n),"renderCanvas",function(){var s=n.rendererService.getViewportSize(),u=s.width,l=s.height;if(n.prevSize[0]!==u||n.prevSize[1]!==l){n.prevSize=[u,l];var f=n.mapService.getSize(),h=tn(f,2),p=h[0],v=h[1];n.canvas.width=u,n.canvas.height=l,n.canvas.style.width=p+"px",n.canvas.style.height=v+"px"}var m=n.layer.getLayerConfig(),x=m.drawingOnCanvas;n.ctx&&x({canvas:n.canvas,ctx:n.ctx,mapService:n.mapService,size:[u,l]})}),n}return ot(t,[{key:"clearModels",value:function(){if(this.canvas){var i;(i=this.mapService.getContainer())===null||i===void 0||i.removeChild(this.canvas),this.canvas=null}this.unBindListener()}},{key:"initModels",value:function(){var i=this.layer.getLayerConfig(),a=i.update,o=a===void 0?k0.ALWAYS:a;return this.updateMode=o,this.initCanvas(),this.renderCanvas(),this.bindListener(),this.mapService.getContainer(),[]}},{key:"initCanvas",value:function(){var i,a=this.layer.getLayerConfig(),o=a.zIndex,s=this.mapService.getSize(),u=tn(s,2),l=u[0],f=u[1],h=this.rendererService.getViewportSize(),p=h.width,v=h.height;this.prevSize=[p,v];var m=document.createElement("canvas");this.canvas=m,m.width=p,m.height=v,m.style.pointerEvents="none",m.style.width=l+"px",m.style.height=f+"px",m.style.position="absolute",m.style.top="0",m.style.left="0",m.style.zIndex=o+"",(i=this.mapService.getContainer())===null||i===void 0||i.appendChild(m);var x=m.getContext("2d");this.ctx=x}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){}}]),t}(qi),Wje={canvas:jje},Xje=Wje;function Yje(e){var r=Zje();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Zje(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qje=function(e){er(t,e);var r=Yje(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","CanvasLayer"),X(He(n),"forceRender",!0),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new Xje[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"hide",value:function(){var i;return this.layerModel.clearCanvas&&((i=this.layerModel)===null||i===void 0||i.clearCanvas()),this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"renderModels",value:function(){var i,a=this;return this!==null&&this!==void 0&&(i=this.layerModel)!==null&&i!==void 0&&i.renderUpdate&&this.layerModel.renderUpdate(),this.models.forEach(function(o){o.draw({uniforms:a.layerModel.getUninforms()},!1)}),this}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={canvas:{}};return a[i]}},{key:"getModelType",value:function(){return"canvas"}}]),t}($f),LS=100,wie=36,Kje=40;function rj(e){return e/180*Math.acos(-1)}function Cie(e){var r=rj(e[0])+Math.PI/2,t=rj(e[1]),n=LS+Math.random()*.4,i=n*Math.cos(t)*Math.cos(r),a=n*Math.cos(t)*Math.sin(r),o=n*Math.sin(t);return[a,o,i]}function Eie(e,r){var t=ts(),n=ts(),i=Io(0,1,0),a=Io(0,0,0);r=r||{},e=typeof e!="undefined"?e:1;for(var o=typeof r.segments!="undefined"?r.segments:32,s=2+o,u=2*s,l=[],f=[],h=[],p=[],v=[],m=[],x=0;x<=s;x++){for(var E=x/s,A=E*Math.PI,L=0;L<=u;L++){var k=L/u,R=k*Math.PI*2;IM(n),y_(n,n,-A),IM(t),g1(t,t,R),Ix(a,i,n),Ix(a,a,t),D3(a,a,-e),h.push(a.slice()),p.push.apply(p,Pr(a.slice())),F0(a,a),v.push.apply(v,Pr(a.slice())),m.push([k,1-E]),p.push(k,1-E)}if(x>0)for(var D=h.length,$=D-2*(u+1);$+u+2<D;$++)l.push([$,$+1,$+u+1]),f.push($,$+1,$+u+1),l.push([$+u+1,$+1,$+u+2]),f.push($+u+1,$+1,$+u+2)}return{cells:l,positions:h,uvs:m,positionsArr:p,indicesArr:f,normalArr:v}}var LT=Ba();Ba();var Nl=Ba(),d0=Ba(),Sb=Ba();function IO(e,r,t,n,i){Xo(e,t,n),Ud(e,e),r=l2(-e[1],e[0]);var a=l2(-t[1],t[0]);return[i/cy(r,a),r]}function v0(e,r){return Uq(e,-r[1],r[0])}function Ab(e,r,t){return Xp(e,r,t),Ud(e,e),e}function kO(e,r){return e[0]===r[0]&&e[1]===r[1]}var Qje=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};st(this,e),X(this,"lastFlip",-1),X(this,"miter",l2(0,0)),X(this,"started",!1),X(this,"dash",!1),X(this,"totalDistance",0),X(this,"currentIndex",0),this.join=r.join||"miter",this.cap=r.cap||"butt",this.miterLimit=r.miterLimit||10,this.thickness=r.thickness||1,this.dash=r.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return ot(e,[{key:"simpleExtrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,a=n.startIndex,o=1;o<i;o++){var s=t[o-1],u=t[o],l=o<t.length-1?t[o+1]:null,f=this.simpleSegment(n,a,s,u,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=i.startIndex,s=1;s<a;s++){var u,l,f,h=t[s-1];h.push((u=n[s-1][2])!==null&&u!==void 0?u:0);var p=n[s-1],v=t[s];v.push((l=n[s][2])!==null&&l!==void 0?l:0);var m=n[s],x=s<t.length-1?[].concat(Pr(t[s+1]),[(f=n[s+1][2])!==null&&f!==void 0?f:0]):null,E=s<n.length-1?n[s+1]:null,A=this.simpleSegment(i,o,h,v,x,p,m,E);o+=A}if(this.dash)for(var L=0;L<i.positions.length/6;L++)i.positions[L*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude_gaode2",value:function(t,n){var i=this.complex;if(t.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=t.length,o=i.startIndex,s=1;s<a;s++){var u,l,f,h=t[s-1];h.push((u=n[s-1][2])!==null&&u!==void 0?u:0);var p=n[s-1],v=t[s];v.push((l=n[s][2])!==null&&l!==void 0?l:0);var m=n[s],x=s<t.length-1?[].concat(Pr(t[s+1]),[(f=n[s+1][2])!==null&&f!==void 0?f:0]):null,E=s<n.length-1?n[s+1]:null,A=this.segment_gaode2(i,o,h,v,x,p,m,E);o+=A}if(this.dash)for(var L=0;L<i.positions.length/6;L++)i.positions[L*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"extrude",value:function(t){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var i=t.length,a=n.startIndex,o=1;o<i;o++){var s=t[o-1],u=t[o],l=o<t.length-1?t[o+1]:null,f=this.segment(n,a,s,u,l);a+=f}if(this.dash)for(var h=0;h<n.positions.length/6;h++)n.positions[h*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleSegment",value:function(t,n,i,a,o){var s=0,u=t.indices,l=t.positions,f=t.normals,h=nc([a[0],a[1]]),p=nc([i[0],i[1]]);Ab(Nl,h,p);var v=0;if(this.dash&&(v=this.lineSegmentDistance(h,p),this.totalDistance+=v),this.normal||(this.normal=Ba(),v0(this.normal,Nl)),this.started||(this.started=!0,this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-v)),u.push(n+0,n+1,n+2),!o)v0(this.normal,Nl),this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance),u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),s+=2;else{var m=nc([o[0],o[1]]);kO(h,m)&&Xo(m,h,Ud(m,V0(m,h,p))),Ab(d0,m,h);var x=IO(Sb,Ba(),Nl,d0,this.thickness),E=tn(x,2),A=E[0],L=E[1],k=cy(Sb,this.normal)<0?-1:1;this.extrusions(l,f,a,L,A,this.totalDistance),u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),k=-1,Vg(this.normal,L),s+=2,this.lastFlip=k}return s}},{key:"segment_gaode2",value:function(t,n,i,a,o,s,u,l){var f=0,h=t.indices,p=t.positions,v=t.normals,m=this.cap==="square",x=this.join==="bevel",E=nc([u[0],u[1]]),A=nc([s[0],s[1]]);Ab(Nl,a,i);var L=0;if(this.dash&&(L=this.lineSegmentDistance(E,A),this.totalDistance+=L),this.normal||(this.normal=Ba(),v0(this.normal,Nl)),!this.started)if(this.started=!0,m){var k=Ba(),R=Ba();Xo(k,this.normal,Nl),Xo(R,this.normal,Nl),v.push(R[0],R[1],0),v.push(k[0],k[1],0),p.push(i[0],i[1],i[2]|0,this.totalDistance-L,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),p.push(i[0],i[1],i[2]|0,this.totalDistance-L,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(p,v,i,this.normal,this.thickness,this.totalDistance-L);if(h.push(n+0,n+1,n+2),o){kO(a,o)&&Xo(o,a,Ud(o,V0(o,a,i))),Ab(d0,o,a);var j=IO(Sb,Ba(),Nl,d0,this.thickness),H=tn(j,2),ee=H[0],U=H[1],W=cy(Sb,this.normal)<0?-1:1,Q=x;if(!Q&&this.join==="miter"){var te=ee;te>this.miterLimit&&(Q=!0)}Q?(v.push(this.normal[0],this.normal[1],0),v.push(U[0],U[1],0),p.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*W,a[2]|0),this.complex.indexes.push(this.currentIndex),p.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*W,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,h.push.apply(h,Pr(this.lastFlip!==-W?[n,n+2,n+3]:[n+2,n+1,n+3])),h.push(n+2,n+3,n+4),v0(LT,d0),Vg(this.normal,LT),v.push(this.normal[0],this.normal[1],0),p.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*W,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f+=3):(this.extrusions(p,v,a,U,ee,this.totalDistance),h.push.apply(h,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),W=-1,Vg(this.normal,U),f+=2),this.lastFlip=W}else{if(v0(this.normal,Nl),m){var D=Ba(),$=Ba();Xp($,Nl,this.normal),Xo(D,Nl,this.normal),v.push($[0],$[1],0),v.push(D[0],D[1],0),p.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),p.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(p,v,a,this.normal,this.thickness,this.totalDistance);h.push.apply(h,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),f+=2}return f}},{key:"segment",value:function(t,n,i,a,o){var s=0,u=t.indices,l=t.positions,f=t.normals,h=this.cap==="square",p=this.join==="bevel",v=nc([a[0],a[1]]),m=nc([i[0],i[1]]);Ab(Nl,v,m);var x=0;if(this.dash&&(x=this.lineSegmentDistance(v,m),this.totalDistance+=x),this.normal||(this.normal=Ba(),v0(this.normal,Nl)),!this.started)if(this.started=!0,h){var E=Ba(),A=Ba();Xo(E,this.normal,Nl),Xo(A,this.normal,Nl),f.push(A[0],A[1],0),f.push(E[0],E[1],0),l.push(i[0],i[1],i[2]|0,this.totalDistance-x,-this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),l.push(i[0],i[1],i[2]|0,this.totalDistance-x,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,i,this.normal,this.thickness,this.totalDistance-x);if(u.push(n+0,n+1,n+2),o){var R=nc([o[0],o[1]]);kO(v,R)&&Xo(R,v,Ud(R,V0(R,v,m))),Ab(d0,R,v);var D=IO(Sb,Ba(),Nl,d0,this.thickness),$=tn(D,2),j=$[0],H=$[1],ee=cy(Sb,this.normal)<0?-1:1,U=p;if(!U&&this.join==="miter"){var W=j;W>this.miterLimit&&(U=!0)}U?(f.push(this.normal[0],this.normal[1],0),f.push(H[0],H[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ee,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*ee,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u.push.apply(u,Pr(this.lastFlip!==-ee?[n,n+2,n+3]:[n+2,n+1,n+3])),u.push(n+2,n+3,n+4),v0(LT,d0),Vg(this.normal,LT),f.push(this.normal[0],this.normal[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*ee,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(l,f,a,H,j,this.totalDistance),u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),ee=-1,Vg(this.normal,H),s+=2),this.lastFlip=ee}else{if(v0(this.normal,Nl),h){var L=Ba(),k=Ba();Xp(k,Nl,this.normal),Xo(L,Nl,this.normal),f.push(k[0],k[1],0),f.push(L[0],L[1],0),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),l.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,f,a,this.normal,this.thickness,this.totalDistance);u.push.apply(u,Pr(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),s+=2}return s}},{key:"extrusions",value:function(t,n,i,a,o,s){n.push(a[0],a[1],0),n.push(a[0],a[1],0),t.push(i[0],i[1],i[2]|0,s,-o,i[2]|0),this.complex.indexes.push(this.currentIndex),t.push(i[0],i[1],i[2]|0,s,o,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,n){var i=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(i*i+a*a)}}]),e}();function Jje(e){var r=e[0][0],t=e[0][e[0].length-1];r[0]===t[0]&&r[1]===t[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var n=e[0].length,i=jd.flatten(e),a=i.vertices,o=i.dimensions,s=[],u=[],l=0;l<a.length/o;l++)o===2?s.push(a[l*2],a[l*2+1],1):s.push(a[l*3],a[l*3+1],1);var f=jd(i.vertices,i.holes,i.dimensions);u.push.apply(u,Pr(f));for(var h=function(m){var x=i.vertices.slice(m*o,(m+1)*o),E=i.vertices.slice((m+1)*o,(m+2)*o);E.length===0&&(E=i.vertices.slice(0,o));var A=s.length/3;s.push(x[0],x[1],1,E[0],E[1],1,x[0],x[1],0,E[0],E[1],0),u.push.apply(u,Pr([0,2,1,2,3,1].map(function(L){return L+A})))},p=0;p<n;p++)h(p);return{positions:s,index:u}}function eWe(e){var r=jd.flatten(e),t=jd(r.vertices,r.holes,r.dimensions);return{positions:r.vertices,index:t}}function Sie(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=e[0][0],n=e[0][e[0].length-1];t[0]===n[0]&&t[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,a=jd.flatten(e),o=a.vertices,s=a.dimensions,u=[],l=[],f=[],h=0;h<o.length/s;h++)s===2?u.push(o[h*2],o[h*2+1],1,-1,-1):u.push(o[h*3],o[h*3+1],1,-1,-1),f.push(0,0,1);var p=jd(a.vertices,a.holes,a.dimensions);l.push.apply(l,Pr(p));for(var v=function(E){var A=a.vertices.slice(E*s,(E+1)*s),L=a.vertices.slice((E+1)*s,(E+2)*s);L.length===0&&(L=a.vertices.slice(0,s));var k=u.length/5;u.push(A[0],A[1],1,0,0,L[0],L[1],1,.1,0,A[0],A[1],0,0,.8,L[0],L[1],0,.1,.8);var R=tWe([L[0],L[1],1],[A[0],A[1],0],[A[0],A[1],1],r);f.push.apply(f,Pr(R).concat(Pr(R),Pr(R),Pr(R))),l.push.apply(l,Pr([1,2,0,3,2,1].map(function(D){return D+k})))},m=0;m<i;m++)v(m);return{positions:u,index:l,normals:f}}function tWe(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=O0(),a=O0(),o=O0();n&&(e=uM(e),r=uM(r),t=uM(t));var s=Io.apply(Yb,Pr(e)),u=Io.apply(Yb,Pr(r)),l=Io.apply(Yb,Pr(t));UF(i,l,u),UF(a,s,u),kM(o,i,a);var f=O0();return F0(f,o),f}var Md,Tx;(function(e){e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn"})(Tx||(Tx={}));var Mx;(function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon"})(Mx||(Mx={}));function IS(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=Math.PI*2/e,n=[],i=0;i<e;i++)n.push(t*i+r*Math.PI/12);var a=n.map(function(o){var s=Math.sin(o+Math.PI/4),u=Math.cos(o+Math.PI/4);return[s,u,0]});return a}function nj(){return IS(30)}function ij(){return IS(4)}function aj(){return IS(3)}function oj(){return IS(6,1)}function sj(){return IS(5)}var n2=(Md={},X(Md,Mx.CIRCLE,nj),X(Md,Mx.HEXAGON,oj),X(Md,Mx.TRIANGLE,aj),X(Md,Mx.SQUARE,ij),X(Md,Mx.PENTAGON,sj),X(Md,Tx.CYLINDER,nj),X(Md,Tx.HEXAGONCOLUMN,oj),X(Md,Tx.TRIANGLECOLUMN,aj),X(Md,Tx.SQUARECOLUMN,ij),X(Md,Tx.PENTAGONCOLUMN,sj),Md),IT={};function Yx(e){var r=Yp(e.coordinates);return{vertices:[].concat(Pr(r),Pr(r),Pr(r),Pr(r)),indices:[0,1,2,2,3,0],size:r.length}}function uj(e){var r=Yp(e.coordinates),t=Cie(r);return{vertices:[].concat(Pr(t),Pr(t),Pr(t),Pr(t)),indices:[0,1,2,2,3,0],size:t.length}}function h6(e){var r=e.shape,t=lWe(r,!1),n=t.positions,i=t.index,a=t.normals;return{vertices:n,indices:i,normals:a,size:5}}function rWe(e){var r=Yp(e.coordinates);return{vertices:Pr(r),indices:[0],size:r.length}}function l1(e){var r=e.coordinates,t=e.originCoordinates,n=e.version,i=new Qje({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=r;Array.isArray(a[0][0])||(a=[r]);var o=t;Array.isArray(o[0][0])||(o=[t]);for(var s=0;s<a.length;s++){var u=a[s],l=o[s];i.extrude_gaode2(u,l)}}else{var f=r;f[0]&&!Array.isArray(f[0][0])&&(f=[r]),f.forEach(function(p){i.extrude(p)})}var h=i.complex;return{vertices:h.positions,indices:h.indices,normals:h.normals,indexes:h.indexes,size:6}}function nWe(e){var r=e.coordinates,t=[];if(!Array.isArray(r[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var n=aWe(r),i=n.results,a=n.totalDistance;return i.map(function(o){t.push(o[0],o[1],o[2],o[3],0,a)}),{vertices:t,indices:[],normals:[],size:6,count:i.length}}function iWe(e){var r=e.coordinates,t=[];if(!Array.isArray(r[0]))return{vertices:[],indices:[],size:4,count:0};var n=oWe(r),i=n.results;return i.map(function(a){t.push(a[0],a[1],a[2],a[3])}),{vertices:t,indices:[],size:4,count:i.length}}function lj(e,r){var t=r[0]-e[0],n=r[1]-e[1];return Math.sqrt(t*t+n*n)}function i2(e,r){return e.length<3&&e.push(0),r!==void 0&&e.push(r),e}function aWe(e){var r=0;if(e.length<2)return{results:e,totalDistance:0};var t=[],n=i2(e[0],r);t.push(n);for(var i=1;i<e.length-1;i++){var a=lj(e[i-1],e[i]);r+=a;var o=i2(e[i],r);t.push(o),t.push(o)}var s=lj(e[e.length-2],e[e.length-1]);return r+=s,t.push(i2(e[e.length-1],r)),{results:t,totalDistance:r}}function oWe(e){if(e.length<2)return{results:e};var r=[],t=i2(e[0]);r.push(t);for(var n=1;n<e.length-1;n++){var i=i2(e[n]);r.push(i),r.push(i)}return r.push(i2(e[e.length-1])),{results:r}}function XE(e){var r=e.coordinates,t=jd.flatten(r),n=t.vertices,i=t.dimensions,a=t.holes;return{indices:jd(n,a,i),vertices:n,size:i}}function sWe(e){var r=e.coordinates,t=jd.flatten(r),n=t.vertices,i=t.dimensions,a=t.holes;return{indices:jd(n,a,i),vertices:uWe(n),size:i+4}}function uWe(e){for(var r=[],t=Yre(e),n=t.center,i=t.radius,a=0;a<e.length;a+=2){var o=e[a],s=e[a+1];r.push.apply(r,[o,s,0].concat(Pr(n),[i]))}return r}function Aie(e){var r=e.coordinates,t=Sie(r,!0),n=t.positions,i=t.index,a=t.normals;return{vertices:n,indices:i,normals:a,size:5}}function Tie(e){var r=e.shape,t=cWe(r),n=t.positions,i=t.index;return{vertices:n,indices:i,size:3}}function A1(e){var r=e.coordinates,t=[].concat(Pr(r[0]),[0,0,1,r[1][0],r[0][1],0,1,1],Pr(r[1]),[0,1,0],Pr(r[0]),[0,0,1],Pr(r[1]),[0,1,0,r[0][0],r[1][1],0,0,0]),n=[0,1,2,3,4,5];return{vertices:t,indices:n,size:5}}function Mk(e,r){for(var t=r||30,n=e.coordinates,i=[],a=[],o=function(l){i.push(l,1,l,n[0][0],n[0][1],n[1][0],n[1][1],l,-1,l,n[0][0],n[0][1],n[1][0],n[1][1]),l!==t-1&&a.push.apply(a,Pr([0,1,2,1,3,2].map(function(f){return l*2+f})))},s=0;s<t;s++)o(s);return{vertices:i,indices:a,size:7}}function cj(e){var r=e.coordinates;r.length===2&&r.push(0);var t=kT(-1,1),n=kT(1,1),i=kT(-1,-1),a=kT(1,-1),o=[].concat(Pr(r),Pr(t),Pr(r),Pr(i),Pr(r),Pr(a),Pr(r),Pr(n)),s=[0,1,2,3,0,2];return{vertices:o,indices:s,size:5}}function lWe(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(IT&&IT[e])return IT[e];var t=n2[e]?n2[e]():n2.cylinder(),n=Sie([t],r);return IT[e]=n,n}function cWe(e){var r=["cylinder","triangleColumn","hexagonColumn","squareColumn"],t=n2[e]?n2[e]():n2.circle(),n=r.indexOf(e)===-1?eWe([t]):Jje([t]);return n}function kT(e,r){var t=(e+1)/2,n=(r+1)/2;return[t,n]}function Mie(){var e=Eie(LS,{segments:wie}),r=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:r,indices:t,size:5,normals:n}}function fWe(){var e=Eie(LS+Kje,{segments:wie}),r=e.positionsArr,t=e.indicesArr,n=e.normalArr;return{vertices:r,indices:t,size:5,normals:n}}function hWe(e){var r=pWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function pWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dWe=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

uniform float u_circleSweep;
uniform float u_cityMinSize;
uniform vec3 u_circleSweepColor;
uniform float u_circleSweepSpeed;

varying float v_worldDis;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }


  if(u_circleSweep > 0.0 && v_worldDis < u_cityMinSize) {
    float r = fract(((v_worldDis/u_cityMinSize) - u_time * u_circleSweepSpeed) * 2.0);
    gl_FragColor.rgb += r * r * u_circleSweepColor;
  }
   
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,vWe=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;
uniform mat4 u_Mvp;

uniform float u_circleSweep;
uniform vec2 u_cityCenter;

varying float v_worldDis;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"


void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

   v_texCoord = a_Uv;

  if(u_circleSweep > 0.0) {
     vec2 lnglatscale = vec2(0.0);
    if(u_CoordinateSystem != COORDINATE_SYSTEM_P20_2) {
      lnglatscale = (a_Position.xy - u_cityCenter) * vec2(0.0, 0.135);
    }
    v_worldDis = length(a_Position.xy + lnglatscale - u_cityCenter);
  }
 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,gWe=function(e){er(t,e);var r=hWe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.baseColor,u=s===void 0?"rgb(16,16,16)":s,l=i.brightColor,f=l===void 0?"rgb(255,176,38)":l,h=i.windowColor,p=h===void 0?"rgb(30,60,89)":h,v=i.time,m=v===void 0?0:v,x=i.sweep,E=x===void 0?{enable:!1,sweepRadius:1,sweepColor:"rgb(255, 255, 255)",sweepSpeed:.4,sweepCenter:this.cityCenter}:x;return{u_cityCenter:E.sweepCenter||this.cityCenter,u_cityMinSize:this.cityMinSize*E.sweepRadius,u_circleSweep:E.enable?1:0,u_circleSweepColor:Sa(E.sweepColor).slice(0,3),u_circleSweepSpeed:E.sweepSpeed,u_opacity:o,u_baseColor:Sa(u),u_brightColor:Sa(f),u_windowColor:Sa(p),u_time:this.layer.getLayerAnimateTime()||m}}},{key:"calCityGeo",value:function(){var i=tn(this.layer.getSource().extent,4),a=i[0],o=i[1],s=i[2],u=i[3];if(this.mapService.version==="GAODE2.x"){this.cityCenter=this.mapService.lngLatToCoord([(s+a)/2,(u+o)/2]);var l=this.mapService.lngLatToCoord([s,u]),f=this.mapService.lngLatToCoord([a,o]);this.cityMinSize=Math.sqrt(Math.pow(l[0]-f[0],2)+Math.pow(l[1]-f[1],2))/4}else{var h=s-a,p=u-o;this.cityCenter=[(s+a)/2,(u+o)/2],this.cityMinSize=Math.sqrt(Math.pow(h,2)+Math.pow(p,2))/4}}},{key:"initModels",value:function(i){this.calCityGeo(),this.startModelAnimate(),this.buildModels(i)}},{key:"buildModels",value:function(i){this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:vWe,fragmentShader:dWe,triangulation:Aie,depth:{enable:!0},cull:{enable:!0,face:K.BACK}}).then(function(a){i([a])}).catch(function(a){console.warn(a),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?10:o;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function mWe(e){var r=yWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function yWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _We=function(e){er(t,e);var r=mWe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","CityBuildingLayer"),n}return ot(t,[{key:"buildModels",value:function(){var i=this;this.layerModel=new gWe(this),this.layerModel.initModels(function(a){i.dispatchModelLoad(a)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"setLight",value:function(i){this.updateLayerConfig({time:i})}},{key:"getModelType",value:function(){return"citybuilding"}}]),t}($f);function xWe(e){var r=bWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function bWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wWe=`
uniform sampler2D u_texture;
uniform float u_opacity;

varying vec3 v_Color;
varying vec2 v_uv;

#pragma include "picking"
void main() {
  gl_FragColor = texture2D(u_texture, vec2(v_uv.x, 1.0 - v_uv.y));
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,CWe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform float u_raisingHeight: 0.0;
uniform mat4 u_Mvp;
uniform float u_opacity;
uniform vec2 u_size: [1.0, 1.0];
uniform mat2 u_RotateMatrix;

attribute vec3 a_Extrude;
attribute vec3 a_Position;
attribute vec2 a_Uv;
attribute vec3 a_Color;

varying vec3 v_Color;
varying vec2 v_uv;

#pragma include "projection"
#pragma include "picking"
void main() {
   vec3 extrude = a_Extrude;
   v_Color = a_Color;
   v_uv = a_Uv;

   float raiseHeight = u_raisingHeight;
   if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raiseHeight = u_raisingHeight * mapboxZoomScale;
   }

   // \u8BA1\u7B97\u7ECF\u7EAC\u5EA6\u70B9\u4F4D\u5750\u6807
   vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

   // \u8BA1\u7B97\u7ED5 z \u8F74\u65CB\u8F6C\u540E\u7684\u504F\u79FB
   vec2 offsetXY = project_pixel(u_RotateMatrix * vec2(extrude.x * u_size.x, 0.0));
   // \u7ED5 z \u8F74\u65CB\u8F6C
   float x = project_pos.x + offsetXY.x;
   float y = project_pos.y + offsetXY.y;
   // z \u8F74\u4E0D\u53C2\u4E0E\u65CB\u8F6C
   float z = project_pixel(extrude.y * u_size.y + raiseHeight);


   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      // gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
      gl_Position = u_Mvp * (vec4(x, y, z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(x , y, z , 1.0));
   }

   setPickingColor(a_PickingColor);
}
`,EWe=function(e){er(t,e);var r=xWe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"radian",0),X(He(n),"planeGeometryTriangulation",function(){var s=n.layer.getLayerConfig(),u=s.center,l=u===void 0?[120,30]:u;return{size:4,indices:[0,1,2,2,3,0],vertices:[].concat(Pr(l),[1,1],Pr(l),[0,1],Pr(l),[0,0],Pr(l),[1,0])}}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.width,s=o===void 0?1:o,u=i.height,l=u===void 0?1:u,f=i.raisingHeight,h=f===void 0?0:f,p=1;return(this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(p=-1),this.radian=p*Math.PI*(this.mapService.getRotation()%360)/180,{u_raisingHeight:Number(h),u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_opacity:a||1,u_texture:this.texture,u_size:[s,l]}}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"initModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=a.drawCanvas,h=this.rendererService.createTexture2D;this.texture=h({height:0,width:0}),f&&this.updateTexture(f),this.layer.buildLayerModel({moduleName:"geometryBillboard",vertexShader:CWe,fragmentShader:wWe,triangulation:this.planeGeometryTriangulation,primitive:K.TRIANGLES,depth:{enable:!0},blend:this.getBlend(),stencil:Ya(s,l)}).then(function(p){i([p])}).catch(function(p){console.warn(p),i([])})}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"updateTexture",value:function(i){var a=this.rendererService.createTexture2D,o=this.layer.getLayerConfig(),s=o.canvasWidth,u=s===void 0?1:s,l=o.canvasHeight,f=l===void 0?1:l,h=document.createElement("canvas");h.width=u,h.height=f;var p=h.getContext("2d");p&&(i(h),this.texture=a({data:h,width:h.width,height:h.height,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE}),this.layerService.reRender())}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u){var l=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],f=u%4*3;return[l[f],l[f+1],l[f+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[2],s[3]]}}})}}]),t}(qi);function SWe(e){var r=AWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function AWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TWe=`
uniform sampler2D u_texture;
uniform float u_mapFlag;
uniform float u_opacity;

varying vec3 v_Color;
varying vec2 v_uv;
varying float v_clip;

#pragma include "picking"
void main() {
  // gl_FragColor = vec4(v_Color, u_opacity);
  if(u_mapFlag > 0.0) {
    gl_FragColor = texture2D(u_texture, vec2(v_uv.x, 1.0 - v_uv.y));
    gl_FragColor.a *= u_opacity;
  } else {
    // gl_FragColor = vec4(v_uv, 0.0, u_opacity);
    gl_FragColor = vec4(v_Color, u_opacity);
  }
  gl_FragColor.a *= v_clip;
  gl_FragColor = filterColor(gl_FragColor);
}
`,MWe=`precision highp float;
uniform mat4 u_ModelMatrix;

uniform mat4 u_Mvp;
uniform float u_opacity;
uniform float u_terrainClipHeight;

attribute vec3 a_Position;
attribute vec2 a_Uv;
attribute vec3 a_Color;

varying vec3 v_Color;
varying vec2 v_uv;
varying float v_clip;

#pragma include "projection"
#pragma include "picking"
void main() {
   v_Color = a_Color;
   v_uv = a_Uv;
  
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   v_clip = 1.0;
   if(a_Position.z < u_terrainClipHeight) {
      v_clip = 0.0;
   }
  
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));

   // float x = 1.0;
   // float y = 0.0;
   // float z = 0.0;
   // mat3 translateMatrix = mat3(
   //    1.0, 0.0, 0.0 
   //    0.0, 1.0, 0.0
   //    -project_pos.x,    -project_pos.y,  1.0
   // );
   //  mat4 translateMatrix = mat4(
   //    1.0, 0.0, 0.0, 0.0 ,
   //    0.0, 1.0, 0.0, 0.0,
   //    0.0, 0.0, 1.0, 0.0,
   //    1.0, 0.0, 0.0, 1.0
   // );

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));
   }

   setPickingColor(a_PickingColor);
}
`,LWe=function(e){er(t,e);var r=SWe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"terrainImageLoaded",!1),X(He(n),"planeGeometryTriangulation",function(){var s,u=n.layer.getLayerConfig(),l=u.width,f=l===void 0?1:l,h=u.height,p=h===void 0?1:h,v=u.widthSegments,m=v===void 0?1:v,x=u.heightSegments,E=x===void 0?1:x,A=u.center,L=A===void 0?[120,30]:A,k=u.terrainTexture,R=(s=n).initPlane.apply(s,[f,p,m,E].concat(Pr(L))),D=R.indices,$=R.positions;return k&&n.loadTerrainTexture($,D),{vertices:$,indices:D,size:5}}),n}return ot(t,[{key:"initPlane",value:function(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:120,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,f=i/2,h=a/2,p=Math.floor(o),v=Math.floor(s),m=p+1,x=v+1,E=i/p,A=a/v,L=[],k=[],R=0;R<x;R++)for(var D=R*A-h,$=0;$<m;$++){var j=$*E-f;if(this.mapService.version===ko["GAODE2.x"]){var H=this.mapService.lngLatToCoord([j+u,-D+l]),ee=tn(H,2),U=ee[0],W=ee[1];k.push(U,W,0)}else k.push(j+u,-D+l,0);k.push($/p),k.push(1-R/v)}for(var Q=0;Q<v;Q++)for(var te=0;te<p;te++){var ie=te+m*Q,ve=te+m*(Q+1),me=te+1+m*(Q+1),Re=te+1+m*Q;L.push(ie,ve,Re),L.push(ve,me,Re)}return{indices:L,positions:k}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.mapTexture,s=i.terrainClipHeight,u=s===void 0?0:s,l=i.terrainTexture;if(this.mapTexture!==o){var f;this.mapTexture=o,(f=this.texture)===null||f===void 0||f.destroy(),this.updateTexture(o)}return{u_opacity:a||1,u_mapFlag:o?1:0,u_terrainClipHeight:l?u:-1,u_texture:this.texture}}},{key:"clearModels",value:function(){var i;this.terrainImage=null,(i=this.texture)===null||i===void 0||i.destroy()}},{key:"initModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=a.mapTexture;this.mapTexture=f;var h=this.rendererService.createTexture2D;this.texture=h({height:0,width:0}),this.updateTexture(f),this.layer.buildLayerModel({moduleName:"geometryPlane",vertexShader:MWe,fragmentShader:TWe,triangulation:this.planeGeometryTriangulation,primitive:K.TRIANGLES,depth:{enable:!0},stencil:Ya(s,l),blend:this.getBlend(),cull:{enable:!0,face:K.BACK}}).then(function(p){i([p])}).catch(function(p){console.warn(p),i([])})}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"createModelData",value:function(i){if(i){var a=this.layer.getLayerConfig(),o=a.widthSegments,s=a.heightSegments,u=a.width,l=a.height,f=i,h=f.widthSegments,p=f.heightSegments,v=f.width,m=f.height;this.layer.style({widthSegments:h!==void 0?h:o,heightSegments:p!==void 0?p:s,width:v!==void 0?v:u,height:m!==void 0?m:l})}var x=this.layer.getEncodedData(),E=this.styleAttributeService.createAttributesAndIndices(x,this.planeGeometryTriangulation);return E}},{key:"updateTexture",value:function(i){var a=this,o=this.rendererService.createTexture2D;if(i){var s=new Image;s.crossOrigin="anonymous",s.onload=function(){a.texture=o({data:s,width:s.width,height:s.height,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE}),a.layerService.reRender()},s.src=i}else this.texture=o({width:0,height:0})}},{key:"getImageData",value:function(i){var a=document.createElement("canvas"),o=a.getContext("2d"),s=i.width,u=i.height;a.width=s,a.height=u,o.drawImage(i,0,0,s,u);var l=o.getImageData(0,0,s,u);return l}},{key:"translateVertex",value:function(i,a,o,s,u,l){for(var f=o.width,h=o.height,p=this.getImageData(o).data,v=Math.floor(s),m=Math.floor(u),x=v+1,E=m+1,A=f/v,L=h/m,k=0;k<E;k++)for(var R=Math.floor(k*L),D=R*f,$=0;$<x;$++){var j=Math.floor($*A),H=(D+j)*4,ee=p[H],U=p[H+1],W=p[H+2],Q=(k*x+$)*5+2;i[Q]=l(ee,U,W)}var te=this.layer.getEncodedData(),ie=this.styleAttributeService.createAttributesAndIndices(te,function(){return{vertices:i,indices:a,size:5}});this.layer.updateModelData(ie),this.layerService.throttleRenderLayers()}},{key:"loadTerrainTexture",value:function(i,a){var o=this,s=this.layer.getLayerConfig(),u=s.widthSegments,l=u===void 0?1:u,f=s.heightSegments,h=f===void 0?1:f,p=s.terrainTexture,v=s.rgb2height,m=v===void 0?function(E,A,L){return E+A+L}:v;if(this.terrainImage)this.terrainImageLoaded?this.translateVertex(i,a,this.terrainImage,l,h,m):this.terrainImage.onload=function(){o.translateVertex(i,a,o.terrainImage,l,h,m)};else{var x=new Image;this.terrainImage=x,x.crossOrigin="anonymous",x.onload=function(){o.terrainImageLoaded=!0,setTimeout(function(){return o.layer.emit("terrainImageLoaded",null)}),o.translateVertex(i,a,x,l,h,m)},x.src=p}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function IWe(e){var r=kWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function kWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PWe=`
uniform sampler2D u_texture;
uniform float u_mapFlag;
uniform float u_opacity;

varying vec3 v_Color;
varying float v_d;

void main() {

  if(v_d < 0.0) {
    discard;
  }

  if(u_mapFlag > 0.0) {
    gl_FragColor = texture2D(u_texture, gl_PointCoord);
    gl_FragColor.a *= u_opacity;
  } else {
    gl_FragColor = vec4(v_Color, u_opacity);
  }
}
`,RWe=`precision highp float;

attribute vec3 a_Position;
attribute vec3 a_Color;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity;
uniform float u_Scale;
varying vec3 v_Color;
varying float v_d;

#pragma include "projection"
void main() {
   v_Color = a_Color;
  
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   v_d = a_Position.z;

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));
   }

   gl_PointSize = pow((u_Zoom - 1.0), 2.0) * u_Scale;
}
`,Lx;(function(e){e.UP="up",e.DOWN="down"})(Lx||(Lx={}));var OWe=function(e){er(t,e);var r=IWe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"planeGeometryUpdateTriangulation",function(){for(var s=n.layer.getLayerConfig(),u=s.spriteBottom,l=u===void 0?-1e5:u,f=n.spriteUpdate,h=l,p=n.spriteTop,v=0;v<n.positions.length;v+=5)n.spriteAnimate===Lx.UP?(n.positions[v+2]+=f,n.positions[v+2]>p&&(n.positions[v+2]=h)):(n.positions[v+2]-=f,n.positions[v+2]<h&&(n.positions[v+2]=p));return{vertices:n.positions,indices:n.indices,size:5}}),X(He(n),"updateModel",function(){var s=n.layer.createAttributes({triangulation:n.planeGeometryUpdateTriangulation});n.layer.models.map(function(u){u.updateAttributes(s)}),n.layerService.throttleRenderLayers(),n.timer=requestAnimationFrame(n.updateModel)}),X(He(n),"planeGeometryTriangulation",function(){var s,u=n.layer.getLayerConfig(),l=u.center,f=l===void 0?[120,30]:l,h=u.spriteCount,p=h===void 0?100:h,v=u.spriteRadius,m=v===void 0?10:v,x=(s=n).initSprite.apply(s,[m,p].concat(Pr(f))),E=x.indices,A=x.positions;return n.positions=A,n.indices=E,{vertices:A,indices:E,size:5}}),n}return ot(t,[{key:"initSprite",value:function(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:120,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:30,u=[],l=[],f=this.mapService,h=this.spriteAnimate===Lx.UP?-this.spriteTop:this.spriteTop,p=0;p<a;p++){var v=Math.random()*h;l.push.apply(l,Pr(x(v)))}for(var m=0;m<a;m++)u.push(m);function x(E){var A=i*Math.random(),L=i*Math.random(),k=-i/2+A,R=-i/2+L;if(f.version===ko["GAODE2.x"]){var D=f.lngLatToCoord([k+o,-R+s]),$=tn(D,2),j=$[0],H=$[1];return[j,H,E,0,0]}else return[k+o,-R+s,E,0,0]}return{indices:u,positions:l}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.mapTexture,s=i.spriteScale,u=s===void 0?1:s;if(this.mapTexture!==o){var l;this.mapTexture=o,(l=this.texture)===null||l===void 0||l.destroy(),this.updateTexture(o)}return{u_opacity:a||1,u_mapFlag:o?1:0,u_texture:this.texture,u_Scale:u}}},{key:"clearModels",value:function(){var i;cancelAnimationFrame(this.timer),(i=this.texture)===null||i===void 0||i.destroy()}},{key:"initModels",value:function(i){var a=this,o=this.layer.getLayerConfig(),s=o.mapTexture,u=o.spriteTop,l=u===void 0?5e6:u,f=o.spriteUpdate,h=f===void 0?1e4:f,p=o.spriteAnimate,v=p===void 0?Lx.DOWN:p;this.mapTexture=s,this.spriteTop=l,this.spriteUpdate=h,v==="up"?this.spriteAnimate=Lx.UP:this.spriteAnimate=Lx.DOWN;var m=this.rendererService.createTexture2D;this.texture=m({height:0,width:0}),this.updateTexture(s),setTimeout(function(){a.updateModel()},100),this.layer.buildLayerModel({moduleName:"geometrySprite",vertexShader:RWe,fragmentShader:PWe,triangulation:this.planeGeometryTriangulation,primitive:K.POINTS,depth:{enable:!1},blend:this.getBlend()}).then(function(x){i([x])}).catch(function(x){console.warn(x),i([])})}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"updateTexture",value:function(i){var a=this,o=this.rendererService.createTexture2D;if(i){var s=new Image;s.crossOrigin="anonymous",s.onload=function(){a.texture=o({data:s,width:s.width,height:s.height,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE}),a.layerService.reRender()},s.src=i}else this.texture=o({width:0,height:0})}},{key:"registerBuiltinAttributes",value:function(){return""}}]),t}(qi),FWe={plane:LWe,sprite:OWe,billboard:EWe},DWe=FWe;function BWe(e){var r=NWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function NWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var zWe=function(e){er(t,e);var r=BWe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","GeometryLayer"),X(He(n),"defaultSourceConfig",{data:[{x:0,y:0}],options:{parser:{type:"json",x:"x",y:"y"}}}),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new DWe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={plane:{},sprite:{},billboard:{}};return a[i]}},{key:"getModelType",value:function(){var i,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=a==null||(i=a.scale)===null||i===void 0?void 0:i.field;return o==="plane"?"plane":o==="sprite"?"sprite":o==="billboard"?"billboard":"plane"}}]),t}($f);function $We(e){var r=UWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function UWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var VWe=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
uniform mat4 u_Mvp;\r
varying vec4 v_color;\r
\r
uniform vec2 u_SceneCenterMKT;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  // gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\r
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807\r
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));\r
    gl_Position = u_Mvp * (project_pos);\r
  } else {\r
     vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
    gl_Position = project_common_position_to_clipspace(project_pos);\r
  }\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,GWe=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,HWe=function(e){er(t,e);var r=$We(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.coverage,s=i.angle;return{u_opacity:a||1,u_coverage:o||.9,u_angle:s||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"heatmapGrid",vertexShader:VWe,fragmentShader:GWe,triangulation:Tie,primitive:K.TRIANGLES,depth:{enable:!1},stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a){var o=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[o[0],o[1],0]}}})}}]),t}(qi);function jWe(e){var r=WWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function WWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var XWe=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"


void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
  // vec2 lnglat = (a_Pos.xy + offset); 
  // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  // gl_Position = project_common_position_to_clipspace(project_pos);
  // float lightWeight = calc_lighting(project_pos);
  // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 lnglat = (a_Pos.xy + offset); 
    // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));

    // float lightWeight = calc_lighting(project_pos);
    // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    // gl_Position = u_Mvp * vec4(lnglat , a_Position.z * a_Size, 1.0);
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u7ECF\u7EAC\u5EA6
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807
    vec4 project_pos = project_position(vec4(customLnglat, a_Position.z * a_Size, 1.0));

    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    gl_Position = u_Mvp * vec4(customLnglat , a_Position.z * a_Size, 1.0);
  } else {
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
    vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
    
    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
    
    gl_Position = project_common_position_to_clipspace(project_pos);
  }



  setPickingColor(a_PickingColor);
}
`,YWe=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ZWe=function(e){er(t,e);var r=jWe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.coverage,s=i.angle;return{u_opacity:a||1,u_coverage:o||1,u_angle:s||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"heatmapGrid3d",vertexShader:XWe,fragmentShader:YWe,triangulation:h6,primitive:K.TRIANGLES,depth:{enable:!0},blend:this.getBlend(),stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a){var o=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[o[0],o[1],0]}}})}}]),t}(qi);function qWe(e,r){for(var t=[],n=[],i=[],a=e+1,o=r+1,s=e/2,u=r/2,l=0;l<o;l++)for(var f=l-u,h=0;h<a;h++){var p=h-s;n.push(p/s,-f/u,0),i.push(h/e),i.push(1-l/r)}for(var v=0;v<r;v++)for(var m=0;m<e;m++){var x=m+a*v,E=m+a*(v+1),A=m+1+a*(v+1),L=m+1+a*v;t.push(x,E,L),t.push(E,A,L)}return{vertices:n,indices:t,uvs:i}}var fj,hj;function KWe(e){var r=QWe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function QWe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var JWe=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,eXe=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;


vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9
	vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0.0, 1.0, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);
 
}
`,tXe=`uniform sampler2D u_texture;        // \u70ED\u529B\u5F3A\u5EA6\u56FE
uniform sampler2D u_colorTexture;   // \u6839\u636E\u5F3A\u5EA6\u5206\u5E03\u7684\u8272\u5E26
uniform float u_opacity;
varying vec2 v_texCoord;

uniform vec2 u_ViewportSize;

float getBlurIndusty() {
    float vW = 2.0/u_ViewportSize.x;
    float vH = 2.0/u_ViewportSize.y;
    vec2 vUv = v_texCoord;
    float i11 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i12 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i13 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y + 1.0 * vH) ).r;

    float i21 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y) ).r;
    float i22 = texture2D( u_texture, vec2( vUv.x , vUv.y) ).r;
    float i23 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y) ).r;

    float i31 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y-1.0*vH) ).r;
    float i32 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y-1.0*vH) ).r;
    float i33 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y-1.0*vH) ).r;

    return(
        i11 + 
        i12 + 
        i13 + 
        i21 + 
        i21 + 
        i22 + 
        i23 + 
        i31 + 
        i32 + 
        i33
        )/9.0;
}


void main(){
    // float intensity = texture2D(u_texture, v_texCoord).r;
    float intensity = getBlurIndusty();
    vec4 color = texture2D(u_colorTexture, vec2(intensity, 0.0));

    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,rXe=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;

void main() {
  v_texCoord = a_Uv;

  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,nXe=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,iXe=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
        gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
        gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
}
`,pj=(fj=Ri(),fj(hj=function(e){er(t,e);var r=KWe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"render",value:function(){var i=this,a=this.rendererService,o=a.clear,s=a.useFramebuffer;s(this.heatmapFramerBuffer,function(){o({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i.heatmapFramerBuffer}),i.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v,m,x,E;return Xr.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return u=this.rendererService,l=u.createFramebuffer,f=u.getViewportSize,h=u.createTexture2D,p=this.styleAttributeService.getLayerStyleAttribute("shape"),v=(p==null||(s=p.scale)===null||s===void 0?void 0:s.field)||"heatmap",this.shapeType=v,L.next=6,this.buildHeatMapIntensity();case 6:this.intensityModel=L.sent,this.colorModel=v==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap(),m=f(),x=m.width,E=m.height,this.heatmapFramerBuffer=l({color:h({width:Math.floor(x/4),height:Math.floor(E/4),wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE,min:K.LINEAR,mag:K.LINEAR}),depth:!1}),this.updateColorTexture(),o([this.intensityModel,this.colorModel]);case 12:case"end":return L.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:Ar.Attribute,descriptor:{name:"a_Dir",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?1:o;return[s]}}})}},{key:"buildHeatMapIntensity",value:function(){var n=Hi(Xr.mark(function a(){var o;return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.layer.triangulation=cj,u.next=3,this.layer.buildLayerModel({moduleName:"heatmapIntensity",vertexShader:iXe,fragmentShader:nXe,triangulation:cj,depth:{enable:!1},cull:{enable:!0,face:Z2(this.mapService.version)},blend:{enable:!0,func:{srcRGB:K.ONE,srcAlpha:1,dstRGB:K.ONE,dstAlpha:1}}});case 3:return o=u.sent,u.abrupt("return",o);case 5:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"buildHeatmapColor",value:function(){var i=this.layer.getLayerConfig(),a=i.mask,o=a===void 0?!1:a,s=i.maskInside,u=s===void 0?!0:s;this.shaderModuleService.registerModule("heatmapColor",{vs:rXe,fs:tXe});var l=this.shaderModuleService.getModule("heatmapColor"),f=l.vs,h=l.fs,p=l.uniforms,v=this.rendererService,m=v.createAttribute,x=v.createElements,E=v.createBuffer,A=v.createModel;return A({vs:f,fs:h,attributes:{a_Position:m({buffer:E({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:K.FLOAT}),size:3}),a_Uv:m({buffer:E({data:[0,1,1,1,0,0,1,0],type:K.FLOAT}),size:2})},uniforms:Et({},p),depth:{enable:!1},blend:this.getBlend(),elements:x({data:[0,2,1,2,3,1],type:K.UNSIGNED_INT,count:6}),stencil:Ya(o,u)})}},{key:"drawIntensityMode",value:function(){var i,a=this.layer.getLayerConfig(),o=a.opacity,s=a.intensity,u=s===void 0?10:s,l=a.radius,f=l===void 0?5:l;(i=this.intensityModel)===null||i===void 0||i.draw({uniforms:{u_opacity:o||1,u_radius:f,u_intensity:u}})}},{key:"drawColorMode",value:function(){var i,a=this.layer.getLayerConfig(),o=a.opacity;(i=this.colorModel)===null||i===void 0||i.draw({uniforms:{u_opacity:o||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var i,a=this.layer.getLayerConfig(),o=a.opacity,s=ts();s2(s,this.cameraService.getViewProjectionMatrixUncentered()),(i=this.colorModel)===null||i===void 0||i.draw({uniforms:{u_opacity:o||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Pr(s)}})}},{key:"build3dHeatMap",value:function(){var i=this.layer.getLayerConfig(),a=i.mask,o=a===void 0?!1:a,s=i.maskInside,u=s===void 0?!0:s,l=this.rendererService.getViewportSize,f=l(),h=f.width,p=f.height,v=qWe(h/4,p/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:eXe,fs:JWe});var m=this.shaderModuleService.getModule("heatmap3dColor"),x=m.vs,E=m.fs,A=m.uniforms,L=this.rendererService,k=L.createAttribute,R=L.createElements,D=L.createBuffer,$=L.createModel;return $({vs:x,fs:E,attributes:{a_Position:k({buffer:D({data:v.vertices,type:K.FLOAT}),size:3}),a_Uv:k({buffer:D({data:v.uvs,type:K.FLOAT}),size:2})},primitive:K.TRIANGLES,uniforms:Et({},A),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:K.SRC_ALPHA,srcAlpha:1,dstRGB:K.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:R({data:v.indices,type:K.UNSIGNED_INT,count:v.indices.length}),stencil:Ya(o,u)})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var i=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var a=this.layer.getLayerConfig(),o=a.rampColors,s=Ay(o);this.colorTexture=i({data:new Uint8Array(s.data),width:s.width,height:s.height,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE,min:K.NEAREST,mag:K.NEAREST,flipY:!1})}}]),t}(qi))||hj);function aXe(e){var r=oXe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function oXe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var sXe=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,uXe=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
 
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy, 0., 1.0));
    // gl_Position = u_Mvp * (vec4(a_Pos.xy + offset, 0., 1.0));
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT;
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));
    gl_Position = u_Mvp * vec4(project_pos.xy, 0.0, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,lXe=function(e){er(t,e);var r=aXe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.coverage,s=i.angle;return{u_opacity:a||1,u_coverage:o||.9,u_angle:s||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"heatmapHexagon",vertexShader:uXe,fragmentShader:sXe,triangulation:Tie,depth:{enable:!1},primitive:K.TRIANGLES,blend:this.getBlend(),stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a){var o=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[o[0],o[1],0]}}})}}]),t}(qi),cXe={heatmap:pj,heatmap3d:pj,grid:HWe,grid3d:ZWe,hexagon:lXe},fXe=cXe;function hXe(e){var r=pXe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function pXe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dXe=function(e){er(t,e);var r=hXe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","HeatMapLayer"),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new fXe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"renderModels",value:function(){var i=this,a=this.getModelType();return a==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.layerModel.buildModels(function(o){return i.models=o}),this.layerModelNeedUpdate=!1),this.models.forEach(function(o){return o.draw({uniforms:i.layerModel.getUninforms()})}),this)}},{key:"updateModelData",value:function(i){i.attributes&&i.elements?this.models[0].updateAttributesAndElements(i.attributes,i.elements):console.warn("data error")}},{key:"getModelType",value:function(){var i,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=this.getLayerConfig(),s=o.shape3d,u=this.getSource(),l=u.data.type,f=(a==null||(i=a.scale)===null||i===void 0?void 0:i.field)||"heatmap";return f==="heatmap"||f==="heatmap3d"?"heatmap":l==="hexagon"?(s==null?void 0:s.indexOf(f))===-1?"hexagon":"grid3d":l==="grid"?(s==null?void 0:s.indexOf(f))===-1?"grid":"grid3d":"heatmap"}}]),t}($f);function vXe(e){var r=gXe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function gXe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mXe=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;

uniform float u_pixelConstant;
uniform float u_pixelConstantR;
uniform float u_pixelConstantG;
uniform float u_pixelConstantB;
uniform float u_pixelConstantRGB;

void main() {
  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y));

  float r = baseColor.r;
  float g = baseColor.g;
  float b = baseColor.b;

  float value = u_pixelConstant + ((r * u_pixelConstantR + g * u_pixelConstantG + b * u_pixelConstantB) * u_pixelConstantRGB);
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
    gl_FragColor = vec4(0, 0, 0, 0);
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,yXe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,_Xe=function(e){er(t,e);var r=vXe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=i.clampLow,s=o===void 0?!0:o,u=i.clampHigh,l=u===void 0?!0:u,f=i.noDataValue,h=f===void 0?-9999999:f,p=i.domain,v=p===void 0?[0,1]:p,m=i.rampColors,x=i.pixelConstant,E=x===void 0?0:x,A=i.pixelConstantR,L=A===void 0?256*256:A,k=i.pixelConstantG,R=k===void 0?256:k,D=i.pixelConstantB,$=D===void 0?1:D,j=i.pixelConstantRGB,H=j===void 0?.1:j;return Kt.exports.isEqual(this.rampColors,m)||(this.updateColorTexture(),this.rampColors=m),{u_opacity:a||1,u_texture:this.texture,u_pixelConstant:E,u_pixelConstantR:L,u_pixelConstantG:R,u_pixelConstantB:$,u_pixelConstantRGB:H,u_domain:v,u_clampLow:s,u_clampHigh:typeof l!="undefined"?l:s,u_noDataValue:h,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(i){var a=this,o=this.layer.getLayerConfig(),s=o.mask,u=s===void 0?!1:s,l=o.maskInside,f=l===void 0?!0:l,h=o.rampColorsData,p=o.rampColors,v=this.layer.getSource(),m=this.rendererService.createTexture2D;this.texture=m({height:0,width:0}),v.data.images.then(function(E){a.texture=m({data:E[0],width:E[0].width,height:E[0].height}),a.layerService.reRender()});var x=h||Ay(p);this.colorTexture=m({data:x.data,width:x.width,height:x.height,flipY:!1}),this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:yXe,fragmentShader:mXe,triangulation:A1,primitive:K.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(u,f)}).then(function(E){i([E])}).catch(function(E){console.warn(E),i([])})}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}},{key:"updateColorTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.layer.getLayerConfig(),o=a.rampColors,s=Ay(o);this.colorTexture=i({data:s.data,width:s.width,height:s.height,flipY:!1})}}]),t}(qi);function xXe(e){var r=bXe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function bXe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wXe=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,CXe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,EXe=function(e){er(t,e);var r=xXe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity;return{u_opacity:a||1,u_texture:this.texture}}},{key:"initModels",value:function(i){var a=this,o=this.layer.getLayerConfig(),s=o.mask,u=s===void 0?!1:s,l=o.maskInside,f=l===void 0?!0:l,h=this.layer.getSource(),p=this.rendererService.createTexture2D;if(this.texture=p({height:0,width:0}),ns){var v=this.layerService.sceneService.getSceneConfig().canvas,m=v.createImage();m.crossOrigin="anonymous",m.src=h.data.originData,m.onload=function(){a.texture=p({data:m,width:m.width,height:m.height}),a.layerService.reRender()}}else h.data.images.then(function(x){a.texture=p({data:x[0],width:x[0].width,height:x[0].height,mag:K.LINEAR,min:K.LINEAR}),a.layerService.reRender()});this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:CXe,fragmentShader:wXe,triangulation:A1,primitive:K.TRIANGLES,blend:{enable:!0},depth:{enable:!1},stencil:Ya(u,f)}).then(function(x){i([x])}).catch(function(x){console.warn(x),i([])})}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function SXe(e){var r=AXe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function AXe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TXe=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;

uniform float u_pixelConstant;
uniform float u_pixelConstantR;
uniform float u_pixelConstantG;
uniform float u_pixelConstantB;
uniform float u_pixelConstantRGB;

void main() {
  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y));

  float r = baseColor.r;
  float g = baseColor.g;
  float b = baseColor.b;

  float value = u_pixelConstant + ((r * u_pixelConstantR + g * u_pixelConstantG + b * u_pixelConstantB) * u_pixelConstantRGB);
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
    gl_FragColor = vec4(0, 0, 0, 0);
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,MXe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,LXe=function(e){er(t,e);var r=SXe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.rendererService.createTexture2D,a=this.layer.getLayerConfig(),o=a.opacity,s=a.clampLow,u=s===void 0?!0:s,l=a.clampHigh,f=l===void 0?!0:l,h=a.noDataValue,p=h===void 0?-9999999:h,v=a.domain,m=v===void 0?[0,1]:v,x=a.colorTexture,E=x===void 0?i({height:0,width:0}):x,A=a.pixelConstant,L=A===void 0?0:A,k=a.pixelConstantR,R=k===void 0?256*256:k,D=a.pixelConstantG,$=D===void 0?256:D,j=a.pixelConstantB,H=j===void 0?1:j,ee=a.pixelConstantRGB,U=ee===void 0?.1:ee;return{u_opacity:o||1,u_texture:this.texture,u_pixelConstant:L,u_pixelConstantR:R,u_pixelConstantG:$,u_pixelConstantB:H,u_pixelConstantRGB:U,u_domain:m,u_clampLow:u,u_clampHigh:typeof f!="undefined"?f:u,u_noDataValue:p,u_colorTexture:E}}},{key:"initModels",value:function(i){var a=this,o=this.layer.getLayerConfig(),s=o.mask,u=s===void 0?!1:s,l=o.maskInside,f=l===void 0?!0:l,h=this.layer.getSource(),p=this.rendererService.createTexture2D;this.texture=p({height:0,width:0}),h.data.images.then(function(v){a.texture=p({data:v[0],width:v[0].width,height:v[0].height}),a.layerService.reRender()}),this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:MXe,fragmentShader:TXe,triangulation:A1,primitive:K.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(u,f)}).then(function(v){i([v])}).catch(function(v){console.warn(v),i([])})}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi),IXe={image:EXe,dataImage:_Xe,tileDataImage:LXe},kXe=IXe;function PXe(e){var r=RXe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function RXe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lie=function(e){er(t,e);var r=PXe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","ImageLayer"),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new kXe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={image:{},dataImage:{},tileDataImage:{}};return a[i]}},{key:"getModelType",value:function(){var i,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=a==null||(i=a.scale)===null||i===void 0?void 0:i.field;return o==="dataImage"?"dataImage":o==="image"?"image":o==="tileDataImage"?"tileDataImage":"image"}}]),t}($f);function OXe(e,r,t){var n=t.createTexture2D,i=Ay(e),a=n({data:i.data,width:i.width,height:i.height,flipY:!1});return r.map(function(o){o.updateLayerConfig({colorTexture:a})}),a}function FD(e,r,t){e.map(function(n){r==="mask"?n.style({mask:t}):n.updateLayerConfig(X({},r,t))})}function xM(e,r,t,n){if(Array.isArray(n)){e[t].apply(e,Pr(n));return}if(typeof n=="string"){e[t](n);return}var i=FXe(e,r.type,t);if(!n)return e[t](i),e;var a=BXe(n,t);a.length===0?e[t](i):e[t].apply(e,Pr(a))}function FXe(e,r,t){switch(t){case"size":return 1;case"color":return"#fff";case"shape":return DXe(r,e);default:return""}}function DXe(e,r){var t,n=r.getAttribute("shape");if(n&&(t=n.scale)!==null&&t!==void 0&&t.field){var i;return((i=n.scale)===null||i===void 0?void 0:i.values)==="text"?[n.scale.field,n.scale.values]:n.scale.field}switch(e){case"PolygonLayer":return"fill";case"LineLayer":return"tileline";case"PointLayer":return"circle";case"RasterLayer":return"image";default:return""}}function BXe(e,r){if(r==="shape")return typeof e=="string"?[e]:e!=null&&e.field?[e==null?void 0:e.field]:[];var t=e,n=t.field,i=t.values,a=t.callback;return n&&i&&Array.isArray(i)?[n,i]:n&&a?[n,a]:n?[n]:[]}function NXe(e,r){var t=r.tileLayer.scaleField,n=Object.keys(t);n.map(function(i){e.scale(i,t[i])})}var Iie=["mvt","geojsonvt","testTile"];function zXe(e){var r=e.getSource();return Iie.includes(r.parser.type)}function Lk(e){return Iie.indexOf(e)>=0}function kie(e,r){r.map(function(t){var n=vL(e.sceneContainer);t.setContainer(n,e.sceneContainer),t.init()})}function Pie(e,r){var t,n=r.getAttribute("shape");if(n&&(t=n.scale)!==null&&t!==void 0&&t.field){var i;return((i=n.scale)===null||i===void 0?void 0:i.values)==="text"?[n.scale.field,n.scale.values]:n.scale.field}switch(e){case"PolygonLayer":return"fill";case"LineLayer":return"tileline";case"PointLayer":return"circle";case"RasterLayer":return"image";default:return""}}function Rie(e,r){switch(e){case"PolygonLayer":return!0;case"LineLayer":return!0;case"PointLayer":return!1;case"RasterLayer":return r;default:return r}}function p6(e){return e.layerIDList.length===e.loadedLayers}function $Xe(e){var r=e.children;return r.filter(function(t){return p6(t)}).length===r.length}function UXe(e){var r=e.parent;return r?p6(r):!0}function VXe(e,r){var t=window.setInterval(function(){var n=p6(e),i=$Xe(e),a=UXe(e);n&&i&&a&&(r(),window.clearInterval(t))},36)}function GXe(e,r){e.isVisible?r():VXe(e,function(){r()})}function HXe(e){var r=!0;return e.map(function(t){t.type!=="PointLayer"&&(r=!1)}),r}function jXe(e,r,t){if(r.length!==0){if(HXe(r)){FD(r,"visible",e.isVisible),t.reRender();return}GXe(e,function(){FD(r,"visible",e.isVisible),t.reRender()})}}function WXe(e,r,t,n){var i,a,o,s,u=(e==null||(i=e.bboxPolygon)===null||i===void 0?void 0:i.bbox)||[0,0,10,-10],l=tn(u,4),f=l[0],h=f===void 0?0:f,p=l[1],v=p===void 0?0:p,m=l[2],x=m===void 0?10:m,E=l[3],A=E===void 0?-10:E,L=r.lngLatToContainer([h,v]),k=r.lngLatToContainer([x,A]),R=k.x-L.x,D=L.y-k.y,$=[(t-L.x)/R,(n-k.y)/D],j=(e==null||(a=e.data)===null||a===void 0?void 0:a.width)||1,H=(e==null||(o=e.data)===null||o===void 0?void 0:o.height)||1,ee=Math.floor($[0]*j),U=Math.floor($[1]*H),W=Math.max(0,U-1)*j+ee,Q=e==null||(s=e.data)===null||s===void 0?void 0:s.data[W];return Q}function XXe(e){var r=YXe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function YXe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ZXe=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,qXe=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;


#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

void main() {
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // if(u_coord > 0.0) { // \u4F7F\u7528\u7ECF\u7EAC\u5EA6\u5750\u6807
      if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
  // } else { // \u4F7F\u7528\u504F\u79FB\u5750\u6807
  //   vec2 pointPos = a_Position.xy;
  //   vec4 tileWorld = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   tileWorld.xy += pointOffset;

  //   tileWorld.xy += offset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     tileWorld.w *= u_PixelsPerMeter.z;
  //   }
  //   gl_Position = u_ViewProjectionMatrix * tileWorld + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}
`,KXe=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,QXe=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_size;

#pragma include "projection"

void main() {

  vec3 size = a_Miter * u_size * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
}
`,DD=function(e){er(t,e);var r=XXe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.usage,u=i.color,l=u===void 0?"#fff":u,f=i.size,h=f===void 0?1:f;return{u_opacity:Number(o),u_color:s==="basemap"?Sa(l):[0,0,0,0],u_size:s==="basemap"?h:1}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v,m;return Xr.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:s=this.layer.getLayerConfig(),u=s.mask,l=u===void 0?!1:u,f=s.maskInside,h=f===void 0?!0:f,p=s.depth,v=p===void 0?!1:p,m=s.usage,this.layer.triangulation=l1,this.layer.buildLayerModel({moduleName:"lineTile_"+m,vertexShader:m==="basemap"?QXe:qXe,fragmentShader:m==="basemap"?KXe:ZXe,triangulation:l1,blend:this.getBlend(),depth:{enable:v},stencil:Ya(l,h),pick:m!=="basemap"}).then(function(A){o([A])}).catch(function(A){console.warn(A),o([])});case 3:case"end":return E.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),a=i.usage;a!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(s){var u=s.size,l=u===void 0?1:u;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(s,u,l,f,h){return h}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(s,u,l){return[l[4]]}}})}}]),t}(qi);function JXe(e){var r=eYe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function eYe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tYe=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,rYe=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

varying vec4 v_color;

void main() {
  v_color = a_Color; 

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, 0.0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
  }
}
`,nYe=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,iYe=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, 0.0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
  }
}`,aYe=function(e){er(t,e);var r=JXe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.usage,u=i.color,l=u===void 0?"#fff":u;return{u_opacity:Kt.exports.isNumber(o)?o:1,u_color:s==="basemap"?Sa(l):[0,0,0,0]}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"clearModels",value:function(){}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=a.usage;this.layer.buildLayerModel({moduleName:"lineTileSimpleNormal_"+f,vertexShader:f==="basemap"?iYe:rYe,fragmentShader:f==="basemap"?nYe:tYe,triangulation:iWe,primitive:K.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(s,l),pick:!1}).then(function(h){i([h])}).catch(function(h){console.warn(h),i([])})}},{key:"registerBuiltinAttributes",value:function(){}}]),t}(qi);function oYe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=sYe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function sYe(e,r){if(!!e){if(typeof e=="string")return dj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return dj(e,r)}}function dj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var uYe=function(){function e(r,t,n){st(this,e),X(this,"boxCells",[]);var i=this.boxCells;this.xCellCount=Math.ceil(r/n),this.yCellCount=Math.ceil(t/n);for(var a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=r,this.height=t,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/t,this.boxUid=0}return ot(e,[{key:"insert",value:function(t,n,i,a,o){this.forEachCell(n,i,a,o,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(o)}},{key:"query",value:function(t,n,i,a,o){return this.queryHitTest(t,n,i,a,!1,o)}},{key:"hitTest",value:function(t,n,i,a,o){return this.queryHitTest(t,n,i,a,!0,o)}},{key:"insertBoxCell",value:function(t,n,i,a,o,s){this.boxCells[o].push(s)}},{key:"queryHitTest",value:function(t,n,i,a,o,s){if(i<0||t>this.width||a<0||n>this.height)return o?!1:[];var u=[];if(t<=0&&n<=0&&this.width<=i&&this.height<=a){if(o)return!0;for(var l=0;l<this.boxKeys.length;l++)u.push({key:this.boxKeys[l],x1:this.bboxes[l*4],y1:this.bboxes[l*4+1],x2:this.bboxes[l*4+2],y2:this.bboxes[l*4+3]});return s?u.filter(s):u}var f={hitTest:o,seenUids:{box:{},circle:{}}};return this.forEachCell(t,n,i,a,this.queryCell,u,f,s),o?u.length>0:u}},{key:"queryCell",value:function(t,n,i,a,o,s,u,l){var f=u.seenUids,h=this.boxCells[o];if(h!==null){var p=this.bboxes,v=oYe(h),m;try{for(v.s();!(m=v.n()).done;){var x=m.value;if(!f.box[x]){f.box[x]=!0;var E=x*4;if(t<=p[E+2]&&n<=p[E+3]&&i>=p[E+0]&&a>=p[E+1]&&(!l||l(this.boxKeys[x]))){if(u.hitTest)return s.push(!0),!0;s.push({key:this.boxKeys[x],x1:p[E],y1:p[E+1],x2:p[E+2],y2:p[E+3]})}}}}catch(A){v.e(A)}finally{v.f()}}return!1}},{key:"forEachCell",value:function(t,n,i,a,o,s,u,l){for(var f=this.convertToXCellCoord(t),h=this.convertToYCellCoord(n),p=this.convertToXCellCoord(i),v=this.convertToYCellCoord(a),m=f;m<=p;m++)for(var x=h;x<=v;x++){var E=this.xCellCount*x+m;if(o.call(this,t,n,i,a,E,s,u,l))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),e}(),lYe=uYe,Oie=function(){function e(r,t){st(this,e),X(this,"viewportPadding",100),this.width=r,this.height=t,this.viewportPadding=Math.max(r,t),this.grid=new lYe(r+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=r+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=r+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding}return ot(e,[{key:"placeCollisionBox",value:function(t){var n=t.x1+t.anchorPointX+this.viewportPadding,i=t.y1+t.anchorPointY+this.viewportPadding,a=t.x2+t.anchorPointX+this.viewportPadding,o=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(n,i,a,o)||this.grid.hitTest(n,i,a,o)?{box:[]}:{box:[n,i,a,o]}}},{key:"insertCollisionBox",value:function(t,n){var i={featureIndex:n};this.grid.insert(i,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,n,i){var a=$q(n,i,0,1),o=zq(),s=Eq.apply(aye,Pr(t));return kx(o,a,s),{x:(o[0]/o[3]+1)/2*this.width+this.viewportPadding,y:(-o[1]/o[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,n,i,a){return i>=0&&t<this.gridRightBoundary&&a>=0&&n<this.gridBottomBoundary}}]),e}();function Fie(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=cYe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function cYe(e,r){if(!!e){if(typeof e=="string")return vj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return vj(e,r)}}function vj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Die(e){var r=.5,t=.5;switch(e){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0;break;default:r=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break;default:t=.5}return{horizontalAlign:r,verticalAlign:t}}function Bie(e,r,t,n,i){if(!!i){var a=e[n],o=a.glyph;if(o)for(var s=r[o].advance*a.scale,u=(e[n].x+s)*i,l=t;l<=n;l++)e[l].x-=u}}function Nie(e,r,t,n,i,a,o){var s=(r-t)*i,u=(-n*o+.5)*a,l=Fie(e),f;try{for(l.s();!(f=l.n()).done;){var h=f.value;h.x+=s,h.y+=u}}catch(p){l.e(p)}finally{l.f()}}function fYe(e,r,t,n,i,a,o){var s=-8,u=0,l=s,f=0,h=e.positionedGlyphs,p=a==="right"?1:a==="left"?0:.5,v=h.length;t.forEach(function(L){if(L.split("").forEach(function(R){var D=r[R],$=0;D&&(h.push({glyph:R,x:u,y:l+$,vertical:!1,scale:1,metrics:D}),u+=D.advance+o)}),h.length!==v){var k=u-o;f=Math.max(k,f),Bie(h,r,v,h.length-1,p)}u=0,l-=n+5});var m=Die(i),x=m.horizontalAlign,E=m.verticalAlign;Nie(h,p,x,E,f,n,t.length);var A=l-s;e.top+=-E*A,e.bottom=e.top-A,e.left+=-x*f,e.right=e.left+f}function hYe(e,r,t,n,i,a,o){var s=-8,u=0,l=s,f=0,h=e.positionedGlyphs,p=a==="right"?1:a==="left"?0:.5,v=h.length;t.forEach(function(L){var k=r[L],R=0;if(k&&(h.push({glyph:L,x:k.advance/2,y:l+R,vertical:!1,scale:1,metrics:k}),u+=k.advance+o),h.length!==v){var D=u-o;f=Math.max(D,f),Bie(h,r,v,h.length-1,p)}u=0,l-=n+5});var m=Die(i),x=m.horizontalAlign,E=m.verticalAlign;Nie(h,p,x,E,f,n,t.length);var A=l-s;e.top+=-E*A,e.bottom=e.top-A,e.left+=-x*f,e.right=e.left+f}function zie(e,r,t,n,i,a){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],s=arguments.length>7?arguments[7]:void 0,u=e.split(`
`),l=[],f={positionedGlyphs:l,top:o[1],bottom:o[1],left:o[0],right:o[0],lineCount:u.length,text:e};return s?hYe(f,r,u,t,n,i,a):fYe(f,r,u,t,n,i,a),l.length?f:!1}function $ie(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],t=arguments.length>2?arguments[2]:void 0,n=e.positionedGlyphs,i=n===void 0?[]:n,a=[],o=Fie(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=u.metrics,f=4,h=l.advance*u.scale/2,p=t?[u.x+h,u.y]:[0,0],v=t?[0,0]:[u.x+h+r[0],u.y+r[1]],m=(0-f)*u.scale-h+v[0],x=(0-f)*u.scale+v[1],E=m+l.width*u.scale,A=x+l.height*u.scale,L={x:m,y:x},k={x:E,y:x},R={x:m,y:A},D={x:E,y:A};a.push({tl:L,tr:k,bl:R,br:D,tex:l,glyphOffset:p})}}catch($){o.e($)}finally{o.f()}return a}function pYe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=dYe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function dYe(e,r){if(!!e){if(typeof e=="string")return gj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gj(e,r)}}function gj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function vYe(e){var r=gYe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function gYe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mj=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,yj=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,_j=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;

uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;
uniform vec4 u_color;

void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(u_color.rgb, u_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
}
`,xj=`#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_size;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "projection"

void main() {
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = u_size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;

}
`;function bj(e){var r=this,t=e.id,n=[],i=[];if(!r.glyphInfoMap||!r.glyphInfoMap[t])return{vertices:[],indices:[],size:7};var a=r.glyphInfoMap[t].centroid,o=a.length===2?[a[0],a[1],0]:a;return r.glyphInfoMap[t].glyphQuads.forEach(function(s,u){n.push.apply(n,Pr(o).concat([s.tex.x,s.tex.y+s.tex.height,s.tl.x,s.tl.y],Pr(o),[s.tex.x+s.tex.width,s.tex.y+s.tex.height,s.tr.x,s.tr.y],Pr(o),[s.tex.x+s.tex.width,s.tex.y,s.br.x,s.br.y],Pr(o),[s.tex.x,s.tex.y,s.bl.x,s.bl.y])),i.push(0+u*4,1+u*4,2+u*4,2+u*4,3+u*4,0+u*4)}),{vertices:n,indices:i,size:7}}var Uie=function(e){er(t,e);var r=vYe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"glyphInfoMap",{}),X(He(n),"currentZoom",-1),X(He(n),"textureHeight",0),X(He(n),"textCount",0),X(He(n),"preTextStyle",{}),X(He(n),"buildModels",function(){var s=Hi(Xr.mark(function u(l){var f,h;return Xr.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:n.mapping(),f=n.layer.getLayerConfig(),h=f.usage,n.layer.buildLayerModel({moduleName:"pointTileText_"+h,vertexShader:h==="basemap"?xj:yj,fragmentShader:h==="basemap"?_j:mj,triangulation:bj.bind(He(n)),depth:{enable:!1},blend:n.getBlend(),pick:h!=="basemap"}).then(function(m){l([m])}).catch(function(m){console.warn(m),l([])});case 3:case"end":return v.stop()}},u)}));return function(u){return s.apply(this,arguments)}}()),X(He(n),"mapping",function(){n.initGlyph(),n.updateTexture(),n.filterGlyphs(),n.reBuildModel()}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.stroke,u=s===void 0?"#fff":s,l=i.strokeWidth,f=l===void 0?0:l,h=i.textAnchor,p=h===void 0?"center":h,v=i.textAllowOverlap,m=v===void 0?!1:v,x=i.halo,E=x===void 0?.5:x,A=i.gamma,L=A===void 0?2:A,k=i.usage,R=i.color,D=R===void 0?"#fff":R,$=i.size,j=$===void 0?1:$,H=this.fontService,ee=H.canvas,U=H.mapping;return Object.keys(U).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(U).length),this.preTextStyle={textAnchor:p,textAllowOverlap:m},{u_opacity:Kt.exports.isNumber(o)?o:1,u_stroke_width:Kt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(u),u_sdf_map:this.texture,u_halo_blur:E,u_gamma_scale:L,u_sdf_map_size:[ee.width,ee.height],u_color:k==="basemap"?Sa(D):[0,0,0,0],u_size:k==="basemap"?j:1}}},{key:"initModels",value:function(i){this.extent=this.textExtent();var a=this.layer.getLayerConfig(),o=a.textAnchor,s=o===void 0?"center":o,u=a.textAllowOverlap,l=u===void 0?!0:u;this.preTextStyle={textAnchor:s,textAllowOverlap:l},this.buildModels(i)}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),a=i.usage;this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Ar.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(s,u,l){return[l[5],l[6]]}}}),a!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(s){var u=s.size,l=u===void 0?12:u;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Ar.Attribute,descriptor:{name:"a_tex",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(s,u,l){return[l[3],l[4]]}}})}},{key:"textExtent",value:function(){var i=this.mapService.getBounds();return i1(i,.5)}},{key:"initTextFont",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,o=a===void 0?"400":a,s=i.fontFamily,u=s===void 0?"sans-serif":s,l=this.layer.getEncodedData(),f=[];l.forEach(function(h){var p=h.shape,v=p===void 0?"":p;v=v.toString();var m=pYe(v),x;try{for(m.s();!(x=m.n()).done;){var E=x.value;f.indexOf(E)===-1&&f.push(E)}}catch(A){m.e(A)}finally{m.f()}}),this.fontService.setFontOptions({characterSet:f,fontWeight:o,fontFamily:u,iconfont:!1})}},{key:"generateGlyphLayout",value:function(){var i=this,a=this.fontService.mapping,o=this.layer.getLayerConfig(),s=o.spacing,u=s===void 0?2:s,l=o.textAnchor,f=l===void 0?"center":l,h=this.layer.getEncodedData();this.glyphInfo=h.map(function(p){var v=p.shape,m=v===void 0?"":v,x=p.id,E=p.size,A=E===void 0?1:E,L=p.textOffset,k=L===void 0?[0,0]:L,R=zie(m.toString(),a,A,f,"left",u,k,!1),D=$ie(R,k,!1);return p.shaping=R,p.glyphQuads=D,p.centroid=Yp(p.coordinates),p.originCentroid=p.version==="GAODE2.x"?Yp(p.originCoordinates):p.originCentroid=p.centroid,i.glyphInfoMap[x]={shaping:R,glyphQuads:D,centroid:Yp(p.coordinates)},p})}},{key:"filterGlyphs",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.padding,s=o===void 0?[4,4]:o,u=a.textAllowOverlap,l=u===void 0?!1:u;if(!l){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var f=this.rendererService.getViewportSize(),h=f.width,p=f.height,v=new Oie(h,p),m=this.glyphInfo.filter(function(x){var E=x.shaping,A=x.id,L=A===void 0?0:A,k=x.version==="GAODE2.x"?x.originCentroid:x.centroid,R=x.size,D=R/24,$=i.mapService.lngLatToContainer(k),j=v.placeCollisionBox({x1:E.left*D-s[0],x2:E.right*D+s[0],y1:E.top*D-s[1],y2:E.bottom*D+s[1],anchorPointX:$.x,anchorPointY:$.y}),H=j.box;return H&&H.length?(v.insertCollisionBox(H,L),!0):!1});m.forEach(function(x){i.glyphInfoMap[x.id]=x})}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.fontService.canvas;this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=i({data:a,mag:K.LINEAR,min:K.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.usage;this.filterGlyphs(),this.layer.buildLayerModel({moduleName:"pointTileText_"+o,vertexShader:o==="basemap"?xj:yj,fragmentShader:o==="basemap"?_j:mj,triangulation:bj.bind(this),depth:{enable:!1},blend:this.getBlend(),pick:o!=="basemap"}).then(function(s){i.layer.models=[s],i.layerService.throttleRenderLayers()}).catch(function(s){console.warn(s),i.layer.models=[]})}}]),t}(qi);function mYe(e){var r=yYe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function yYe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _Ye=`uniform float u_additive;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));


  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,xYe=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping

  v_color = a_Color;
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, 0.0);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width));
  offset = project_pixel(offset);

  v_data = vec4(extrude.x, extrude.y, antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
  }

// if(u_coord > 0.0) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
// } else {

  // vec2 pointPos = a_Position.xy;
  // vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  // vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
  
  // world.xy += offset;
  // world.xy += pointOffset;

  // if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //   // Needs to be divided with project_uCommonUnitsPerMeter
  //   world.w *= u_PixelsPerMeter.z;
  // }

  // gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
// }

 
  setPickingColor(a_PickingColor);


}
`,bM=function(e){er(t,e);var r=mYe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.strokeOpacity,u=s===void 0?1:s,l=i.strokeWidth,f=l===void 0?0:l,h=i.stroke,p=h===void 0?"rgba(0,0,0,0)":h,v=i.blend;return{u_additive:v==="additive"?1:0,u_opacity:Number(o),u_stroke_opacity:Number(u),u_stroke_width:Number(f),u_stroke_color:this.getStrokeColor(p)}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Yx)}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.workerEnabled,s=o===void 0?!1:o,u=a.usage;this.layer.triangulation=Yx,this.layer.buildLayerModel({moduleName:"pointTile_"+u,vertexShader:xYe,fragmentShader:_Ye,triangulation:Yx,depth:{enable:!1},cull:{enable:!0,face:Z2(this.mapService.version)},blend:this.getBlend(),workerEnabled:s,workerOptions:{modelType:"pointTile"},pick:u!=="basemap"}).then(function(l){i([l])}).catch(function(l){console.warn(l),i([])})}},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(o,s,u,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?5:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ar.Attribute,descriptor:{name:"a_Shape",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.shape,u=s===void 0?2:s,l=i.layer.getLayerConfig().shape2d,f=l.indexOf(u);return[f]}}})}}]),t}(qi);function bYe(e){var r=wYe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function wYe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var CYe=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,EYe=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  // if(u_coord > 0.0) {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
    }
  // } else {
  //   vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset = a_Position.xy *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   world.xy += pointOffset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     world.w *= u_PixelsPerMeter.z;
  //   }

  //   gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}

`,SYe=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,AYe=`attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}`,Vie=function(e){er(t,e);var r=bYe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.usage,u=i.color,l=u===void 0?"#fff":u;return{u_opacity:o,u_color:s==="basemap"?Sa(l):[0,0,0,0]}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=a.usage;this.layer.triangulation=XE,this.layer.buildLayerModel({moduleName:"polygonTile_"+f,vertexShader:f==="basemap"?AYe:EYe,fragmentShader:f==="basemap"?SYe:CYe,triangulation:XE,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(s,l),pick:f!=="basemap"}).then(function(h){i([h])}).catch(function(h){console.warn(h),i([])})}},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){}}]),t}(qi);function TYe(e){var r=MYe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function MYe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var LYe=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,IYe=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,Gie=function(e){er(t,e);var r=TYe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?0:a,s=i.color,u=s===void 0?"#000":s;return{u_opacity:Kt.exports.isNumber(o)?o:0,u_color:Sa(u)}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(){var n=Hi(Xr.mark(function a(o){return Xr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:this.layer.buildLayerModel({moduleName:"mask",vertexShader:IYe,fragmentShader:LYe,triangulation:XE,depth:{enable:!1},blend:this.getBlend(),stencil:{enable:!0,mask:255,func:{cmp:K.ALWAYS,ref:1,mask:255},opFront:{fail:K.REPLACE,zfail:K.REPLACE,zpass:K.REPLACE}},pick:!1}).then(function(l){o([l])}).catch(function(l){console.warn(l),o([])});case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),t}(qi);function kYe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=PYe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function PYe(e,r){if(!!e){if(typeof e=="string")return wj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return wj(e,r)}}function wj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function RYe(e){var r=OYe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function OYe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var xL=function(e){er(t,e);var r=RYe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"needListen",!0),X(He(n),"isVector",!0),X(He(n),"isTileLayer",!0),X(He(n),"type",n.layerType||"vectorLayer"),X(He(n),"pickedID",null),X(He(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0,n.reRender()}),n}return ot(t,[{key:"init",value:function(){var i=this,a=this.container.get(Mt.SceneID);this.configService.setLayerConfig(a,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.type==="PointLayer"&&(this.iconService=this.container.get(Mt.IIconService),this.fontService=this.container.get(Mt.IFontService)),this.rendererService=this.container.get(Mt.IRendererService),this.layerService=this.container.get(Mt.ILayerService),this.mapService=this.container.get(Mt.IMapService),this.cameraService=this.container.get(Mt.ICameraService),this.coordinateService=this.container.get(Mt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Mt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Mt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Mt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Mt.IStyleAttributeService),this.pendingStyleAttributes.forEach(function(l){var f=l.attributeName,h=l.attributeField,p=l.attributeValues,v=l.updateOptions;i.styleAttributeService.updateStyleAttribute(f,{scale:Et({field:h},i.splitValuesAndCallbackInAttribute(p,i.getLayerConfig()[f]))},v)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Mt.ILayerPlugin);var o=kYe(this.plugins),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;u.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(l){o.e(l)}finally{o.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this}},{key:"renderModels",value:function(i){var a=this;return this.models.forEach(function(o){o.draw({uniforms:a.layerModel.getUninforms()},i)}),this}},{key:"getPickID",value:function(){return this.pickedID}},{key:"setPickID",value:function(){return this.pickedID}},{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new a(this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getModelType",value:function(){switch(this.layerType){case"PolygonLayer":return Vie;case"LineLayer":return this.getLineModel();case"PointLayer":return this.getPointModel();case"MaskLayer":return Gie;default:return bM}}},{key:"getLineModel",value:function(){var i,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=a==null||(i=a.scale)===null||i===void 0?void 0:i.field;switch(o){case"tileline":case"line":return DD;case"simple":return aYe;default:return DD}}},{key:"getPointModel",value:function(){var i=this.getEncodedData(),a=this.getLayerConfig(),o=a.shape2d,s=i.find(function(l){return l.hasOwnProperty("shape")});if(s){var u=s.shape;return(o==null?void 0:o.indexOf(u))!==-1?bM:Uie}else return bM}},{key:"getDefaultConfig",value:function(){return{}}}]),t}($f);/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function FYe(e,r){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=r.call(e,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}var l_=function(){function e(r,t){this.next=null,this.key=r,this.data=t,this.left=null,this.right=null}return e}();function DYe(e,r){return e>r?1:e<r?-1:0}function P0(e,r,t){for(var n=new l_(null,null),i=n,a=n;;){var o=t(e,r.key);if(o<0){if(r.left===null)break;if(t(e,r.left.key)<0){var s=r.left;if(r.left=s.right,s.right=r,r=s,r.left===null)break}a.left=r,a=r,r=r.left}else if(o>0){if(r.right===null)break;if(t(e,r.right.key)>0){var s=r.right;if(r.right=s.left,s.left=r,r=s,r.right===null)break}i.right=r,i=r,r=r.right}else break}return i.right=r.left,a.left=r.right,r.left=n.right,r.right=n.left,r}function PO(e,r,t,n){var i=new l_(e,r);if(t===null)return i.left=i.right=null,i;t=P0(e,t,n);var a=n(e,t.key);return a<0?(i.left=t.left,i.right=t,t.left=null):a>=0&&(i.right=t.right,i.left=t,t.right=null),i}function Cj(e,r,t){var n=null,i=null;if(r){r=P0(e,r,t);var a=t(r.key,e);a===0?(n=r.left,i=r.right):a<0?(i=r.right,r.right=null,n=r):(n=r.left,r.left=null,i=r)}return{left:n,right:i}}function BYe(e,r,t){return r===null?e:(e===null||(r=P0(e.key,r,t),r.left=e),r)}function BD(e,r,t,n,i){if(e){n(""+r+(t?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+i(e)+`
`);var a=r+(t?"    ":"\u2502   ");e.left&&BD(e.left,a,!1,n,i),e.right&&BD(e.right,a,!0,n,i)}}var d6=function(){function e(r){r===void 0&&(r=DYe),this._root=null,this._size=0,this._comparator=r}return e.prototype.insert=function(r,t){return this._size++,this._root=PO(r,t,this._root,this._comparator)},e.prototype.add=function(r,t){var n=new l_(r,t);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,a=P0(r,this._root,i),o=i(r,a.key);return o===0?this._root=a:(o<0?(n.left=a.left,n.right=a,a.left=null):o>0&&(n.right=a.right,n.left=a,a.right=null),this._size++,this._root=n),this._root},e.prototype.remove=function(r){this._root=this._remove(r,this._root,this._comparator)},e.prototype._remove=function(r,t,n){var i;if(t===null)return null;t=P0(r,t,n);var a=n(r,t.key);return a===0?(t.left===null?i=t.right:(i=P0(r,t.left,n),i.right=t.right),this._size--,i):t},e.prototype.pop=function(){var r=this._root;if(r){for(;r.left;)r=r.left;return this._root=P0(r.key,this._root,this._comparator),this._root=this._remove(r.key,this._root,this._comparator),{key:r.key,data:r.data}}return null},e.prototype.findStatic=function(r){for(var t=this._root,n=this._comparator;t;){var i=n(r,t.key);if(i===0)return t;i<0?t=t.left:t=t.right}return null},e.prototype.find=function(r){return this._root&&(this._root=P0(r,this._root,this._comparator),this._comparator(r,this._root.key)!==0)?null:this._root},e.prototype.contains=function(r){for(var t=this._root,n=this._comparator;t;){var i=n(r,t.key);if(i===0)return!0;i<0?t=t.left:t=t.right}return!1},e.prototype.forEach=function(r,t){for(var n=this._root,i=[],a=!1;!a;)n!==null?(i.push(n),n=n.left):i.length!==0?(n=i.pop(),r.call(t,n),n=n.right):a=!0;return this},e.prototype.range=function(r,t,n,i){for(var a=[],o=this._comparator,s=this._root,u;a.length!==0||s;)if(s)a.push(s),s=s.left;else{if(s=a.pop(),u=o(s.key,t),u>0)break;if(o(s.key,r)>=0&&n.call(i,s))return this;s=s.right}return this},e.prototype.keys=function(){var r=[];return this.forEach(function(t){var n=t.key;return r.push(n)}),r},e.prototype.values=function(){var r=[];return this.forEach(function(t){var n=t.data;return r.push(n)}),r},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(r){if(r===void 0&&(r=this._root),r)for(;r.left;)r=r.left;return r},e.prototype.maxNode=function(r){if(r===void 0&&(r=this._root),r)for(;r.right;)r=r.right;return r},e.prototype.at=function(r){for(var t=this._root,n=!1,i=0,a=[];!n;)if(t)a.push(t),t=t.left;else if(a.length>0){if(t=a.pop(),i===r)return t;i++,t=t.right}else n=!0;return null},e.prototype.next=function(r){var t=this._root,n=null;if(r.right){for(n=r.right;n.left;)n=n.left;return n}for(var i=this._comparator;t;){var a=i(r.key,t.key);if(a===0)break;a<0?(n=t,t=t.left):t=t.right}return n},e.prototype.prev=function(r){var t=this._root,n=null;if(r.left!==null){for(n=r.left;n.right;)n=n.right;return n}for(var i=this._comparator;t;){var a=i(r.key,t.key);if(a===0)break;a<0?t=t.left:(n=t,t=t.right)}return n},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return zYe(this._root)},e.prototype.load=function(r,t,n){t===void 0&&(t=[]),n===void 0&&(n=!1);var i=r.length,a=this._comparator;if(n&&$D(r,t,0,i-1,a),this._root===null)this._root=ND(r,t,0,i),this._size=i;else{var o=$Ye(this.toList(),NYe(r,t),a);i=this._size+i,this._root=zD({head:o},0,i)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(r){r===void 0&&(r=function(n){return String(n.key)});var t=[];return BD(this._root,"",!0,function(n){return t.push(n)},r),t.join("")},e.prototype.update=function(r,t,n){var i=this._comparator,a=Cj(r,this._root,i),o=a.left,s=a.right;i(r,t)<0?s=PO(t,n,s,i):o=PO(t,n,o,i),this._root=BYe(o,s,i)},e.prototype.split=function(r){return Cj(r,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var r;return FYe(this,function(t){switch(t.label){case 0:r=this.minNode(),t.label=1;case 1:return r?[4,r]:[3,3];case 2:return t.sent(),r=this.next(r),[3,1];case 3:return[2]}})},e}();function ND(e,r,t,n){var i=n-t;if(i>0){var a=t+Math.floor(i/2),o=e[a],s=r[a],u=new l_(o,s);return u.left=ND(e,r,t,a),u.right=ND(e,r,a+1,n),u}return null}function NYe(e,r){for(var t=new l_(null,null),n=t,i=0;i<e.length;i++)n=n.next=new l_(e[i],r[i]);return n.next=null,t.next}function zYe(e){for(var r=e,t=[],n=!1,i=new l_(null,null),a=i;!n;)r?(t.push(r),r=r.left):t.length>0?(r=a=a.next=t.pop(),r=r.right):n=!0;return a.next=null,i.next}function zD(e,r,t){var n=t-r;if(n>0){var i=r+Math.floor(n/2),a=zD(e,r,i),o=e.head;return o.left=a,e.head=e.head.next,o.right=zD(e,i+1,t),o}return null}function $Ye(e,r,t){for(var n=new l_(null,null),i=n,a=e,o=r;a!==null&&o!==null;)t(a.key,o.key)<0?(i.next=a,a=a.next):(i.next=o,o=o.next),i=i.next;return a!==null?i.next=a:o!==null&&(i.next=o),n.next}function $D(e,r,t,n,i){if(!(t>=n)){for(var a=e[t+n>>1],o=t-1,s=n+1;;){do o++;while(i(e[o],a)<0);do s--;while(i(e[s],a)>0);if(o>=s)break;var u=e[o];e[o]=e[s],e[s]=u,u=r[o],r[o]=r[s],r[s]=u}$D(e,r,t,s,i),$D(e,r,s+1,n,i)}}function Jd(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ej(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lh(e,r,t){return r&&Ej(e.prototype,r),t&&Ej(e,t),e}var Jw=function(r,t){return r.ll.x<=t.x&&t.x<=r.ur.x&&r.ll.y<=t.y&&t.y<=r.ur.y},UD=function(r,t){if(t.ur.x<r.ll.x||r.ur.x<t.ll.x||t.ur.y<r.ll.y||r.ur.y<t.ll.y)return null;var n=r.ll.x<t.ll.x?t.ll.x:r.ll.x,i=r.ur.x<t.ur.x?r.ur.x:t.ur.x,a=r.ll.y<t.ll.y?t.ll.y:r.ll.y,o=r.ur.y<t.ur.y?r.ur.y:t.ur.y;return{ll:{x:n,y:a},ur:{x:i,y:o}}},$0=Number.EPSILON;$0===void 0&&($0=Math.pow(2,-52));var UYe=$0*$0,VD=function(r,t){if(-$0<r&&r<$0&&-$0<t&&t<$0)return 0;var n=r-t;return n*n<UYe*r*t?0:r<t?-1:1},VYe=function(){function e(){Jd(this,e),this.reset()}return lh(e,[{key:"reset",value:function(){this.xRounder=new Sj,this.yRounder=new Sj}},{key:"round",value:function(t,n){return{x:this.xRounder.round(t),y:this.yRounder.round(n)}}}]),e}(),Sj=function(){function e(){Jd(this,e),this.tree=new d6,this.round(0)}return lh(e,[{key:"round",value:function(t){var n=this.tree.add(t),i=this.tree.prev(n);if(i!==null&&VD(n.key,i.key)===0)return this.tree.remove(t),i.key;var a=this.tree.next(n);return a!==null&&VD(n.key,a.key)===0?(this.tree.remove(t),a.key):t}}]),e}(),YE=new VYe,ZC=function(r,t){return r.x*t.y-r.y*t.x},Hie=function(r,t){return r.x*t.x+r.y*t.y},Aj=function(r,t,n){var i={x:t.x-r.x,y:t.y-r.y},a={x:n.x-r.x,y:n.y-r.y},o=ZC(i,a);return VD(o,0)},bL=function(r){return Math.sqrt(Hie(r,r))},GYe=function(r,t,n){var i={x:t.x-r.x,y:t.y-r.y},a={x:n.x-r.x,y:n.y-r.y};return ZC(a,i)/bL(a)/bL(i)},HYe=function(r,t,n){var i={x:t.x-r.x,y:t.y-r.y},a={x:n.x-r.x,y:n.y-r.y};return Hie(a,i)/bL(a)/bL(i)},Tj=function(r,t,n){return t.y===0?null:{x:r.x+t.x/t.y*(n-r.y),y:n}},Mj=function(r,t,n){return t.x===0?null:{x:n,y:r.y+t.y/t.x*(n-r.x)}},jYe=function(r,t,n,i){if(t.x===0)return Mj(n,i,r.x);if(i.x===0)return Mj(r,t,n.x);if(t.y===0)return Tj(n,i,r.y);if(i.y===0)return Tj(r,t,n.y);var a=ZC(t,i);if(a==0)return null;var o={x:n.x-r.x,y:n.y-r.y},s=ZC(o,t)/a,u=ZC(o,i)/a,l=r.x+u*t.x,f=n.x+s*i.x,h=r.y+u*t.y,p=n.y+s*i.y,v=(l+f)/2,m=(h+p)/2;return{x:v,y:m}},zg=function(){lh(e,null,[{key:"compare",value:function(t,n){var i=e.comparePoints(t.point,n.point);return i!==0?i:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:wL.compare(t.segment,n.segment))}},{key:"comparePoints",value:function(t,n){return t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0}}]);function e(r,t){Jd(this,e),r.events===void 0?r.events=[this]:r.events.push(this),this.point=r,this.isLeft=t}return lh(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var n=t.point.events,i=0,a=n.length;i<a;i++){var o=n[i];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,n=0;n<t;n++){var i=this.point.events[n];if(i.segment.consumedBy===void 0)for(var a=n+1;a<t;a++){var o=this.point.events[a];o.consumedBy===void 0&&i.otherSE.point.events===o.otherSE.point.events&&i.segment.consume(o.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],n=0,i=this.point.events.length;n<i;n++){var a=this.point.events[n];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&t.push(a)}return t}},{key:"getLeftmostComparator",value:function(t){var n=this,i=new Map,a=function(s){var u=s.otherSE;i.set(s,{sine:GYe(n.point,t.point,u.point),cosine:HYe(n.point,t.point,u.point)})};return function(o,s){i.has(o)||a(o),i.has(s)||a(s);var u=i.get(o),l=u.sine,f=u.cosine,h=i.get(s),p=h.sine,v=h.cosine;return l>=0&&p>=0?f<v?1:f>v?-1:0:l<0&&p<0?f<v?-1:f>v?1:0:p<l?-1:p>l?1:0}}}]),e}(),WYe=0,wL=function(){lh(e,null,[{key:"compare",value:function(t,n){var i=t.leftSE.point.x,a=n.leftSE.point.x,o=t.rightSE.point.x,s=n.rightSE.point.x;if(s<i)return 1;if(o<a)return-1;var u=t.leftSE.point.y,l=n.leftSE.point.y,f=t.rightSE.point.y,h=n.rightSE.point.y;if(i<a){if(l<u&&l<f)return 1;if(l>u&&l>f)return-1;var p=t.comparePoint(n.leftSE.point);if(p<0)return 1;if(p>0)return-1;var v=n.comparePoint(t.rightSE.point);return v!==0?v:-1}if(i>a){if(u<l&&u<h)return-1;if(u>l&&u>h)return 1;var m=n.comparePoint(t.leftSE.point);if(m!==0)return m;var x=t.comparePoint(n.rightSE.point);return x<0?1:x>0?-1:1}if(u<l)return-1;if(u>l)return 1;if(o<s){var E=n.comparePoint(t.rightSE.point);if(E!==0)return E}if(o>s){var A=t.comparePoint(n.rightSE.point);if(A<0)return 1;if(A>0)return-1}if(o!==s){var L=f-u,k=o-i,R=h-l,D=s-a;if(L>k&&R<D)return 1;if(L<k&&R>D)return-1}return o>s?1:o<s||f<h?-1:f>h?1:t.id<n.id?-1:t.id>n.id?1:0}}]);function e(r,t,n,i){Jd(this,e),this.id=++WYe,this.leftSE=r,r.segment=this,r.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=r,this.rings=n,this.windings=i}return lh(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<n?t:n},ur:{x:this.rightSE.point.x,y:t>n?t:n}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var n=this.leftSE.point,i=this.rightSE.point,a=this.vector();if(n.x===i.x)return t.x===n.x?0:t.x<n.x?1:-1;var o=(t.y-n.y)/a.y,s=n.x+o*a.x;if(t.x===s)return 0;var u=(t.x-n.x)/a.x,l=n.y+u*a.y;return t.y===l?0:t.y<l?-1:1}},{key:"getIntersection",value:function(t){var n=this.bbox(),i=t.bbox(),a=UD(n,i);if(a===null)return null;var o=this.leftSE.point,s=this.rightSE.point,u=t.leftSE.point,l=t.rightSE.point,f=Jw(n,u)&&this.comparePoint(u)===0,h=Jw(i,o)&&t.comparePoint(o)===0,p=Jw(n,l)&&this.comparePoint(l)===0,v=Jw(i,s)&&t.comparePoint(s)===0;if(h&&f)return v&&!p?s:!v&&p?l:null;if(h)return p&&o.x===l.x&&o.y===l.y?null:o;if(f)return v&&s.x===u.x&&s.y===u.y?null:u;if(v&&p)return null;if(v)return s;if(p)return l;var m=jYe(o,this.vector(),u,t.vector());return m===null||!Jw(a,m)?null:YE.round(m.x,m.y)}},{key:"split",value:function(t){var n=[],i=t.events!==void 0,a=new zg(t,!0),o=new zg(t,!1),s=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(a);var u=new e(a,s,this.rings.slice(),this.windings.slice());return zg.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),zg.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(a.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var n=0,i=this.windings.length;n<i;n++)this.windings[n]*=-1}},{key:"consume",value:function(t){for(var n=this,i=t;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var a=e.compare(n,i);if(a!==0){if(a>0){var o=n;n=i,i=o}if(n.prev===i){var s=n;n=i,i=s}for(var u=0,l=i.rings.length;u<l;u++){var f=i.rings[u],h=i.windings[u],p=n.rings.indexOf(f);p===-1?(n.rings.push(f),n.windings.push(h)):n.windings[p]+=h}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var n=this._afterState.rings,i=this._afterState.windings,a=this._afterState.multiPolys,o=0,s=this.rings.length;o<s;o++){var u=this.rings[o],l=this.windings[o],f=n.indexOf(u);f===-1?(n.push(u),i.push(l)):i[f]+=l}for(var h=[],p=[],v=0,m=n.length;v<m;v++)if(i[v]!==0){var x=n[v],E=x.poly;if(p.indexOf(E)===-1)if(x.isExterior)h.push(E);else{p.indexOf(E)===-1&&p.push(E);var A=h.indexOf(x.poly);A!==-1&&h.splice(A,1)}}for(var L=0,k=h.length;L<k;L++){var R=h[L].multiPoly;a.indexOf(R)===-1&&a.push(R)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(jv.type){case"union":{var i=t.length===0,a=n.length===0;this._isInResult=i!==a;break}case"intersection":{var o,s;t.length<n.length?(o=t.length,s=n.length):(o=n.length,s=t.length),this._isInResult=s===jv.numMultiPolys&&o<s;break}case"xor":{var u=Math.abs(t.length-n.length);this._isInResult=u%2===1;break}case"difference":{var l=function(h){return h.length===1&&h[0].isSubject};this._isInResult=l(t)!==l(n);break}default:throw new Error("Unrecognized operation type found ".concat(jv.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,n,i){var a,o,s,u=zg.comparePoints(t,n);if(u<0)a=t,o=n,s=1;else if(u>0)a=n,o=t,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));var l=new zg(a,!0),f=new zg(o,!1);return new e(l,f,[i],[s])}}]),e}(),Lj=function(){function e(r,t,n){if(Jd(this,e),!Array.isArray(r)||r.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=n,this.segments=[],typeof r[0][0]!="number"||typeof r[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=YE.round(r[0][0],r[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var a=i,o=1,s=r.length;o<s;o++){if(typeof r[o][0]!="number"||typeof r[o][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=YE.round(r[o][0],r[o][1]);u.x===a.x&&u.y===a.y||(this.segments.push(wL.fromRing(a,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),a=u)}(i.x!==a.x||i.y!==a.y)&&this.segments.push(wL.fromRing(a,i,this))}return lh(e,[{key:"getSweepEvents",value:function(){for(var t=[],n=0,i=this.segments.length;n<i;n++){var a=this.segments[n];t.push(a.leftSE),t.push(a.rightSE)}return t}}]),e}(),XYe=function(){function e(r,t){if(Jd(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Lj(r[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,i=r.length;n<i;n++){var a=new Lj(r[n],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=t}return lh(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),n=0,i=this.interiorRings.length;n<i;n++)for(var a=this.interiorRings[n].getSweepEvents(),o=0,s=a.length;o<s;o++)t.push(a[o]);return t}}]),e}(),Ij=function(){function e(r,t){if(Jd(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof r[0][0][0]=="number"&&(r=[r])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,i=r.length;n<i;n++){var a=new XYe(r[n],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=t}return lh(e,[{key:"getSweepEvents",value:function(){for(var t=[],n=0,i=this.polys.length;n<i;n++)for(var a=this.polys[n].getSweepEvents(),o=0,s=a.length;o<s;o++)t.push(a[o]);return t}}]),e}(),YYe=function(){lh(e,null,[{key:"factory",value:function(t){for(var n=[],i=0,a=t.length;i<a;i++){var o=t[i];if(!(!o.isInResult()||o.ringOut)){for(var s=null,u=o.leftSE,l=o.rightSE,f=[u],h=u.point,p=[];s=u,u=l,f.push(u),u.point!==h;)for(;;){var v=u.getAvailableLinkedEvents();if(v.length===0){var m=f[0].point,x=f[f.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(m.x,",")+" ".concat(m.y,"]. Last matching segment found ends at")+" [".concat(x.x,", ").concat(x.y,"]."))}if(v.length===1){l=v[0].otherSE;break}for(var E=null,A=0,L=p.length;A<L;A++)if(p[A].point===u.point){E=A;break}if(E!==null){var k=p.splice(E)[0],R=f.splice(k.index);R.unshift(R[0].otherSE),n.push(new e(R.reverse()));continue}p.push({index:f.length,point:u.point});var D=u.getLeftmostComparator(s);l=v.sort(D)[0].otherSE;break}n.push(new e(f))}}return n}}]);function e(r){Jd(this,e),this.events=r;for(var t=0,n=r.length;t<n;t++)r[t].segment.ringOut=this;this.poly=null}return lh(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,n=[t],i=1,a=this.events.length-1;i<a;i++){var o=this.events[i].point,s=this.events[i+1].point;Aj(o,t,s)!==0&&(n.push(o),t=o)}if(n.length===1)return null;var u=n[0],l=n[1];Aj(u,t,l)===0&&n.shift(),n.push(n[0]);for(var f=this.isExteriorRing()?1:-1,h=this.isExteriorRing()?0:n.length-1,p=this.isExteriorRing()?n.length:-1,v=[],m=h;m!=p;m+=f)v.push([n[m].x,n[m].y]);return v}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],n=1,i=this.events.length;n<i;n++){var a=this.events[n];zg.compare(t,a)>0&&(t=a)}for(var o=t.segment.prevInResult(),s=o?o.prevInResult():null;;){if(!o)return null;if(!s)return o.ringOut;if(s.ringOut!==o.ringOut)return s.ringOut.enclosingRing()!==o.ringOut?o.ringOut:o.ringOut.enclosingRing();o=s.prevInResult(),s=o?o.prevInResult():null}}}]),e}(),kj=function(){function e(r){Jd(this,e),this.exteriorRing=r,r.poly=this,this.interiorRings=[]}return lh(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(var n=0,i=this.interiorRings.length;n<i;n++){var a=this.interiorRings[n].getGeom();a!==null&&t.push(a)}return t}}]),e}(),ZYe=function(){function e(r){Jd(this,e),this.rings=r,this.polys=this._composePolys(r)}return lh(e,[{key:"getGeom",value:function(){for(var t=[],n=0,i=this.polys.length;n<i;n++){var a=this.polys[n].getGeom();a!==null&&t.push(a)}return t}},{key:"_composePolys",value:function(t){for(var n=[],i=0,a=t.length;i<a;i++){var o=t[i];if(!o.poly)if(o.isExteriorRing())n.push(new kj(o));else{var s=o.enclosingRing();s.poly||n.push(new kj(s)),s.poly.addInterior(o)}}return n}}]),e}(),qYe=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wL.compare;Jd(this,e),this.queue=r,this.tree=new d6(t),this.segments=[]}return lh(e,[{key:"process",value:function(t){var n=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(n),i;var a=t.isLeft?this.tree.insert(n):this.tree.find(n);if(!a)throw new Error("Unable to find segment #".concat(n.id," ")+"[".concat(n.leftSE.point.x,", ").concat(n.leftSE.point.y,"] -> ")+"[".concat(n.rightSE.point.x,", ").concat(n.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var o=a,s=a,u=void 0,l=void 0;u===void 0;)o=this.tree.prev(o),o===null?u=null:o.key.consumedBy===void 0&&(u=o.key);for(;l===void 0;)s=this.tree.next(s),s===null?l=null:s.key.consumedBy===void 0&&(l=s.key);if(t.isLeft){var f=null;if(u){var h=u.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(f=h),!u.isAnEndpoint(h)))for(var p=this._splitSafely(u,h),v=0,m=p.length;v<m;v++)i.push(p[v])}var x=null;if(l){var E=l.getIntersection(n);if(E!==null&&(n.isAnEndpoint(E)||(x=E),!l.isAnEndpoint(E)))for(var A=this._splitSafely(l,E),L=0,k=A.length;L<k;L++)i.push(A[L])}if(f!==null||x!==null){var R=null;if(f===null)R=x;else if(x===null)R=f;else{var D=zg.comparePoints(f,x);R=D<=0?f:x}this.queue.remove(n.rightSE),i.push(n.rightSE);for(var $=n.split(R),j=0,H=$.length;j<H;j++)i.push($[j])}i.length>0?(this.tree.remove(n),i.push(t)):(this.segments.push(n),n.prev=u)}else{if(u&&l){var ee=u.getIntersection(l);if(ee!==null){if(!u.isAnEndpoint(ee))for(var U=this._splitSafely(u,ee),W=0,Q=U.length;W<Q;W++)i.push(U[W]);if(!l.isAnEndpoint(ee))for(var te=this._splitSafely(l,ee),ie=0,ve=te.length;ie<ve;ie++)i.push(te[ie])}}this.tree.remove(n)}return i}},{key:"_splitSafely",value:function(t,n){this.tree.remove(t);var i=t.rightSE;this.queue.remove(i);var a=t.split(n);return a.push(i),t.consumedBy===void 0&&this.tree.insert(t),a}}]),e}(),Pj=typeof process!="undefined"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,KYe=typeof process!="undefined"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,QYe=function(){function e(){Jd(this,e)}return lh(e,[{key:"run",value:function(t,n,i){jv.type=t,YE.reset();for(var a=[new Ij(n,!0)],o=0,s=i.length;o<s;o++)a.push(new Ij(i[o],!1));if(jv.numMultiPolys=a.length,jv.type==="difference")for(var u=a[0],l=1;l<a.length;)UD(a[l].bbox,u.bbox)!==null?l++:a.splice(l,1);if(jv.type==="intersection"){for(var f=0,h=a.length;f<h;f++)for(var p=a[f],v=f+1,m=a.length;v<m;v++)if(UD(p.bbox,a[v].bbox)===null)return[]}for(var x=new d6(zg.compare),E=0,A=a.length;E<A;E++)for(var L=a[E].getSweepEvents(),k=0,R=L.length;k<R;k++)if(x.insert(L[k]),x.size>Pj)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var D=new qYe(x),$=x.size,j=x.pop();j;){var H=j.key;if(x.size===$){var ee=H.segment;throw new Error("Unable to pop() ".concat(H.isLeft?"left":"right"," SweepEvent ")+"[".concat(H.point.x,", ").concat(H.point.y,"] from segment #").concat(ee.id," ")+"[".concat(ee.leftSE.point.x,", ").concat(ee.leftSE.point.y,"] -> ")+"[".concat(ee.rightSE.point.x,", ").concat(ee.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(x.size>Pj)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(D.segments.length>KYe)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var U=D.process(H),W=0,Q=U.length;W<Q;W++){var te=U[W];te.consumedBy===void 0&&x.insert(te)}$=x.size,j=x.pop()}YE.reset();var ie=YYe.factory(D.segments),ve=new ZYe(ie);return ve.getGeom()}}]),e}(),jv=new QYe,JYe=function(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return jv.run("union",r,n)},eZe=function(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return jv.run("intersection",r,n)},tZe=function(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return jv.run("xor",r,n)},rZe=function(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return jv.run("difference",r,n)},nZe={union:JYe,intersection:eZe,xor:tZe,difference:rZe};function iZe(e,r,t){t===void 0&&(t={});var n=HE(e),i=HE(r),a=nZe.union(n.coordinates,i.coordinates);return a.length===0?null:a.length===1?OB(a[0],t.properties):eBe(a,t.properties)}function aZe(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return jie(e);case"FeatureCollection":return oZe(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return v6(e);default:throw new Error("unknown GeoJSON type")}}function jie(e){var r={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:r[t]=e[t]}}),r.properties=Wie(e.properties),r.geometry=v6(e.geometry),r}function Wie(e){var r={};return e&&Object.keys(e).forEach(function(t){var n=e[t];typeof n=="object"?n===null?r[t]=null:Array.isArray(n)?r[t]=n.map(function(i){return i}):r[t]=Wie(n):r[t]=n}),r}function oZe(e){var r={type:"FeatureCollection"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:r[t]=e[t]}}),r.features=e.features.map(function(t){return jie(t)}),r}function v6(e){var r={type:e.type};return e.bbox&&(r.bbox=e.bbox),e.type==="GeometryCollection"?(r.geometries=e.geometries.map(function(t){return v6(t)}),r):(r.coordinates=Xie(e.coordinates),r)}function Xie(e){var r=e;return typeof r[0]!="object"?r.slice():r.map(function(t){return Xie(t)})}function sZe(e,r){r===void 0&&(r={});var t=HE(e);switch(!r.properties&&e.type==="Feature"&&(r.properties=e.properties),t.type){case"Polygon":return uZe(t,r);case"MultiPolygon":return lZe(t,r);default:throw new Error("invalid poly")}}function uZe(e,r){r===void 0&&(r={});var t=HE(e),n=t.coordinates,i=r.properties?r.properties:e.type==="Feature"?e.properties:{};return Yie(n,i)}function lZe(e,r){r===void 0&&(r={});var t=HE(e),n=t.coordinates,i=r.properties?r.properties:e.type==="Feature"?e.properties:{},a=[];return n.forEach(function(o){a.push(Yie(o,i))}),Q4e(a)}function Yie(e,r){return e.length>1?J4e(e,r):K4e(e[0],r)}var Rj={features:[],featureId:null,vectorTileLayer:null,source:null},T1=function(){function e(r){st(this,e),X(this,"outSideEventTimer",null),X(this,"eventCache",{click:0,mousemove:0,mouseup:0,mousedown:0,contextmenu:0}),this.parentLayer=r.parent,this.mapService=r.mapService,this.rendererService=r.rendererService;var t=this.parentLayer.getSource();this.zoomOffset=t.parser.zoomOffset||0,this.tilesetManager=t.tileset}return ot(e,[{key:"createTile",value:function(t,n){return{layers:[],layerIDList:[]}}},{key:"getFeatureData",value:function(t,n){var i=n.sourceLayer,a=n.featureId,o=n.transforms,s=o===void 0?[]:o,u=n.layerType,l=n.shape;if(!i)return Rj;var f=t.data.layers[i],h=f==null?void 0:f.features;if(Array.isArray(h)&&h.length>0){var p=[];u==="LineLayer"&&l==="simple"?h.map(function(m){var x=aZe(m);if(x.geometry.type==="MultiPolygon"){var E,A=sZe(x).features;(E=p).push.apply(E,Pr(A))}else x.geometry.type==="Polygon"&&(x.geometry.type="MultiLineString"),p.push(x)}):p=h;var v=new q2({type:"FeatureCollection",features:p},{parser:{type:"geojson",featureId:a,cancelExtent:!0},transforms:s});return{features:p,featureId:a,vectorTileLayer:f,source:v}}else return Rj}},{key:"createLayer",value:function(t){var n=t.L7Layer,i=t.tile,a=t.initOptions,o=t.vectorTileLayer,s=t.source,u=t.needListen,l=u===void 0?!0:u,f=a.mask,h=a.color,p=a.layerType,v=a.size,m=a.shape,x=a.usage,E=a.basemapColor,A=a.basemapSize,L=n||xL,k=new L(Et({visible:i.isVisible,tileOrigin:o==null?void 0:o.l7TileOrigin,coord:o==null?void 0:o.l7TileCoord,needListen:l},this.getLayerInitOption(a)));if(p&&(k.type=p),k.isTileLayer=!0,k.isVector&&x!=="basemap"&&(this.emitEvent([k]),k.select(!0)),k.source(s),xM(k,this.parentLayer,"shape",m),x!=="basemap"?(NXe(k,this.parentLayer),xM(k,this.parentLayer,"color",h),xM(k,this.parentLayer,"size",v)):k.style({color:E,size:A}),f&&k.isVector){var R=new xL({layerType:"MaskLayer"}).source({type:"FeatureCollection",features:[i.bboxPolygon]},{parser:{type:"geojson",cancelExtent:!0}});kie(this.parentLayer,[R]),k.addMaskLayer(R)}return this.layers=[k],k}},{key:"updateStyle",value:function(t){return""}},{key:"getTile",value:function(t,n){var i=this.mapService.getZoom();return this.tilesetManager.getTileByLngLat(t,n,i)}},{key:"bindVectorEvent",value:function(t){var n=this;t.on("click",function(i){n.eventCache.click=1,n.getFeatureAndEmitEvent("subLayerClick",i)}),t.on("mousemove",function(i){n.eventCache.mousemove=1,n.getFeatureAndEmitEvent("subLayerMouseMove",i)}),t.on("mouseenter",function(i){n.getFeatureAndEmitEvent("subLayerMouseEnter",i)})}},{key:"readRasterTile",value:function(t,n){var i=t.lngLat,a=i.lng,o=i.lat,s=this.getTile(a,o);if(!!s){var u=WXe(s,this.mapService,t.x,t.y);t.value=u,this.parentLayer.emit(n,t)}}},{key:"bindRasterEvent",value:function(t){var n=this;t.on("click",function(i){n.eventCache.click=1,n.readRasterTile(i,"subLayerClick")}),t.on("mousemove",function(i){n.eventCache.mousemove=1,n.readRasterTile(i,"subLayerMouseMove")}),t.on("mouseenter",function(i){n.readRasterTile(i,"subLayerMouseMove")})}},{key:"bindCommonEvent",value:function(t){var n=this;t.on("mouseup",function(i){n.eventCache.mouseup=1,n.getFeatureAndEmitEvent("subLayerMouseUp",i)}),t.on("mouseout",function(i){n.getFeatureAndEmitEvent("subLayerMouseOut",i)}),t.on("mousedown",function(i){n.eventCache.mousedown=1,n.getFeatureAndEmitEvent("subLayerMouseDown",i)}),t.on("contextmenu",function(i){n.eventCache.contextmenu=1,n.getFeatureAndEmitEvent("subLayerContextmenu",i)}),t.on("unclick",function(i){return n.handleOutsideEvent("click","subLayerUnClick",t,i)}),t.on("unmouseup",function(i){return n.handleOutsideEvent("mouseup","subLayerUnMouseUp",t,i)}),t.on("unmousedown",function(i){return n.handleOutsideEvent("mousedown","subLayerUnMouseDown",t,i)}),t.on("uncontextmenu",function(i){return n.handleOutsideEvent("contextmenu","subLayerUnContextmenu",t,i)})}},{key:"emitEvent",value:function(t){var n=this;t.map(function(i){i.once("modelLoaded",function(){n.bindVectorEvent(i),n.bindCommonEvent(i)})})}},{key:"emitRasterEvent",value:function(t){var n=this;t.map(function(i){i.once("modelLoaded",function(){n.bindRasterEvent(i),n.bindCommonEvent(i)})})}},{key:"getCombineFeature",value:function(t){var n=null,i=t[0];return t.map(function(a){var o=OB(a.coordinates);n===null&&(n=o),n=iZe(n,o)}),i&&(n.properties=Et({},i)),n}},{key:"getFeatureAndEmitEvent",value:function(t,n){var i=n.featureId,a=this.getAllFeatures(i);try{n.feature=this.getCombineFeature(a)}catch{console.warn("Combine Featuer Err! Return First Feature!"),n.feature=a[0]}this.parentLayer.emit(t,n)}},{key:"getAllFeatures",value:function(t){var n=this.parentLayer.tileLayer.children,i=[];return n.map(function(a){var o=a.getSource();o.data.dataArray.map(function(s){s._id===t&&i.push(s)})}),i}},{key:"getLayerInitOption",value:function(t){var n=Et({},t);return delete n.color,delete n.shape,delete n.size,delete n.coords,delete n.sourceLayer,delete n.coords,n}},{key:"handleOutsideEvent",value:function(t,n,i,a){var o=this;this.outSideEventTimer&&(clearTimeout(this.outSideEventTimer),this.outSideEventTimer=null),this.outSideEventTimer=setTimeout(function(){o.eventCache[t]>0?o.eventCache[t]=0:o.getFeatureAndEmitEvent(n,a)},64)}}]),e}();function cZe(e){var r=fZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function fZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hZe=function(e){er(t,e);var r=cZe(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.parentLayer=n.parent,i}return ot(t,[{key:"createTile",value:function(i,a){var o=this.getFeatureData(i,a),s=o.features,u=o.vectorTileLayer,l=o.source;if(s.length===0)return{layers:[],layerIDList:[]};var f=this.createLayer({tile:i,initOptions:a,vectorTileLayer:u,source:l});return{layers:[f],layerIDList:[f.id]}}}]),t}(T1);function pZe(e){var r=dZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function dZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vZe=function(e){er(t,e);var r=pZe(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.parentLayer=n.parent,i}return ot(t,[{key:"createTile",value:function(i,a){var o=this.getFeatureData(i,a),s=o.features,u=o.vectorTileLayer,l=o.source;if(s.length===0)return{layers:[],layerIDList:[]};var f=this.createLayer({tile:i,initOptions:a,vectorTileLayer:u,source:l,needListen:!1});return{layers:[f],layerIDList:[f.id]}}}]),t}(T1);function gZe(e){var r=mZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function mZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var yZe=function(e){er(t,e);var r=gZe(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.parentLayer=n.parent,i}return ot(t,[{key:"createTile",value:function(i,a){var o=this.getFeatureData(i,a),s=o.features,u=o.vectorTileLayer,l=o.source;if(s.length===0)return{layers:[],layerIDList:[]};var f=this.createLayer({tile:i,initOptions:a,vectorTileLayer:u,source:l});return{layers:[f],layerIDList:[f.id]}}}]),t}(T1);function _Ze(e){var r=xZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function xZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bZe=function(e){er(t,e);var r=_Ze(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.parentLayer=n.parent,i}return ot(t,[{key:"createTile",value:function(i,a){var o=this.getFeatureData(i,a),s=o.features,u=o.vectorTileLayer,l=o.source;if(s.length===0)return{layers:[],layerIDList:[]};var f=this.createLayer({tile:i,initOptions:a,vectorTileLayer:u,source:l,needListen:!1});return{layers:[f],layerIDList:[f.id]}}}]),t}(T1);function wZe(e){var r=CZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function CZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Oj=function(e){er(t,e);var r=wZe(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.parentLayer=n.parent,i}return ot(t,[{key:"createTile",value:function(i,a){var o=new q2(i.data,{parser:{type:"image",extent:i.bounds}}),s=this.createLayer({L7Layer:Lie,tile:i,initOptions:a,source:o});return{layers:[s],layerIDList:[s.id]}}}]),t}(T1);function EZe(e){var r=SZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function SZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var AZe=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;



// float getBlurIndusty() {
//   vec2 u_ViewportSize = vec2(1024);

//     float vW = 2.0/u_ViewportSize.x;
//     float vH = 2.0/u_ViewportSize.y;
//     vec2 vUv = v_texCoord;
//     float i11 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y + 1.0 * vH) ).r;
//     float i12 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y + 1.0 * vH) ).r;
//     float i13 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y + 1.0 * vH) ).r;

//     float i21 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y) ).r;
//     float i22 = texture2D( u_texture, vec2( vUv.x , vUv.y) ).r;
//     float i23 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y) ).r;

//     float i31 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y-1.0*vH) ).r;
//     float i32 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y-1.0*vH) ).r;
//     float i33 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y-1.0*vH) ).r;

//     return(
//         i11 + 
//         i12 + 
//         i13 + 
//         i21 + 
//         i21 + 
//         i22 + 
//         i23 + 
//         i31 + 
//         i32 + 
//         i33
//         )/9.0;
// }

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;

  // float value = getBlurIndusty();


  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,TZe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,MZe=function(e){er(t,e);var r=EZe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.rendererService.createTexture2D,a=this.layer.getLayerConfig(),o=a.colorTexture,s=o===void 0?i({data:[],width:0,height:0,flipY:!1}):o,u=a.opacity,l=u===void 0?1:u,f=a.clampLow,h=f===void 0?!0:f,p=a.clampHigh,v=p===void 0?!0:p,m=a.noDataValue,x=m===void 0?-9999999:m,E=a.domain,A=E===void 0?[0,1]:E;return{u_opacity:l||1,u_texture:this.texture,u_domain:A,u_clampLow:h,u_clampHigh:typeof v!="undefined"?v:h,u_noDataValue:x,u_colorTexture:s}}},{key:"initModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=this.layer.getSource(),h=this.rendererService.createTexture2D,p=f.data.dataArray[0];this.texture=h({data:p.data,width:p.width,height:p.height,format:K.LUMINANCE,type:K.FLOAT}),this.layer.buildLayerModel({moduleName:"rasterTileImageData",vertexShader:TZe,fragmentShader:AZe,triangulation:A1,depth:{enable:!1},stencil:Ya(s,l)}).then(function(v){i([v])}).catch(function(v){console.warn(v),i([])})}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function LZe(e){var r=IZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function IZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var kZe=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_channelRMax: 256.;
uniform float u_channelGMax: 256.;
uniform float u_channelBMax: 256.;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  gl_FragColor = vec4(rgb.r/u_channelRMax, rgb.g/u_channelGMax, rgb.b/u_channelBMax, u_opacity);
}`,PZe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Zie=function(e){er(t,e);var r=LZe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"channelRMax",256),X(He(n),"channelGMax",256),X(He(n),"channelBMax",256),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.channelRMax,u=i.channelGMax,l=i.channelBMax;return{u_opacity:o||1,u_texture:this.texture,u_channelRMax:s!==void 0?s:this.channelRMax,u_channelGMax:u!==void 0?u:this.channelGMax,u_channelBMax:l!==void 0?l:this.channelBMax}}},{key:"getRasterData",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v;return Xr.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!Array.isArray(o.data)){x.next=4;break}return x.abrupt("return",{data:o.data,width:o.width,height:o.height});case 4:return x.next=6,o.data;case 6:return s=x.sent,u=s.rasterData,l=s.width,f=s.height,h=s.channelR,p=s.channelG,v=s.channelB,this.channelRMax=h,this.channelGMax=p,this.channelBMax=v,x.abrupt("return",{data:Array.from(u),width:l,height:f});case 17:case"end":return x.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"initModels",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v,m,x,E,A,L;return Xr.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return s=this.layer.getLayerConfig(),u=s.mask,l=u===void 0?!1:u,f=s.maskInside,h=f===void 0?!0:f,p=this.layer.getSource(),v=this.rendererService.createTexture2D,m=p.data.dataArray[0],R.next=6,this.getRasterData(m);case 6:x=R.sent,E=x.data,A=x.width,L=x.height,this.texture=v({data:E,width:A,height:L,format:K.RGB,type:K.FLOAT}),this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:PZe,fragmentShader:kZe,triangulation:A1,primitive:K.TRIANGLES,depth:{enable:!1},stencil:Ya(l,h)}).then(function(D){o([D])}).catch(function(D){console.warn(D),o([])});case 12:case"end":return R.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function RZe(e){var r=OZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function OZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var FZe=function(e){er(t,e);var r=RZe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type",n.layerType),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new a(this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getModelType",value:function(){return this.layerSource.parser.type==="rasterRgb"?Zie:MZe}},{key:"getDefaultConfig",value:function(){return{}}}]),t}($f);function DZe(e){var r=BZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function BZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var NZe=function(e){er(t,e);var r=DZe(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.parentLayer=n.parent,i}return ot(t,[{key:"createTile",value:function(i,a){var o,s,u,l=a.colorTexture,f=a.opacity,h=a.domain,p=a.clampHigh,v=a.clampLow,m=a.mask,x=i.data;if(!x.data)return console.warn("raster data not exist!"),{layers:[],layerIDList:[]};var E=(o=this.parentLayer)===null||o===void 0||(s=o.getSource())===null||s===void 0||(u=s.parser)===null||u===void 0?void 0:u.dataType,A=new FZe({visible:i.isVisible,mask:m}).source(x.data,{parser:{type:E==="rgb"?"rasterRgb":"raster",width:x.width,height:x.height,extent:i.bboxPolygon.bbox}}).style({colorTexture:l,opacity:f,domain:h,clampHigh:p,clampLow:v});return this.emitRasterEvent([A]),{layers:[A],layerIDList:[A.id]}}}]),t}(T1);function zZe(e){var r=$Ze();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function $Ze(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var UZe=function(e){er(t,e);var r=zZe(t);function t(n){var i;return st(this,t),i=r.call(this,n),i.parentLayer=n.parent,i}return ot(t,[{key:"createTile",value:function(i,a){var o=a.sourceLayer;if(!o)return{layers:[],layerIDList:[]};var s=i.data.layers[o],u=s==null?void 0:s.features;if(u.length===0)return{layers:[],layerIDList:[]};var l=u[0].properties,f=new xL({layerType:"PointLayer",usage:"basemap",needListen:!1}).source([l],{parser:{type:"json",x:"textLng",y:"textLat",cancelExtent:!0}}).shape("key","text").style({size:20,color:"#000",stroke:"#fff",strokeWidth:2}),h=new xL({layerType:"LineLayer",usage:"basemap",needListen:!1}).source({type:"FeatureCollection",features:u},{parser:{type:"geojson",cancelExtent:!0}}).shape("simple").style({color:"#000"});return{layers:[h,f],layerIDList:[h.id,f.id]}}}]),t}(T1);function VZe(e,r){switch(e){case"PolygonLayer":return yZe;case"LineLayer":return hZe;case"PointLayer":return vZe;case"MaskLayer":return bZe;case"TileDebugLayer":return UZe;case"RasterLayer":return Hne.includes(r.dataType)?NZe:Oj;default:return console.warn("Current Tile Not Exist!"),Oj}}var qie=function(){function e(){st(this,e),X(this,"tileCache",new Map)}return ot(e,[{key:"hasTile",value:function(t){return!!this.tileCache.has(t.key)}},{key:"addTile",value:function(t){var n;if(this.hasTile(t))return{layers:[],layerIDList:[]};this.tileCache.set(t.key,t);var i=this.tileFactory.createTile(t,this.initOptions);return kie(this.parent,i.layers),(n=t.layerIDList).push.apply(n,Pr(i.layerIDList)),this.addChildren(i.layers),i.layers.map(function(a){a.once("modelLoaded",function(){t.layerLoad()})}),i}},{key:"removeTile",value:function(t){this.tileCache.delete(t.key),this.removeChildren(t.layerIDList,!1)}},{key:"addChild",value:function(t){this.children.push(t)}},{key:"addChildren",value:function(t){var n;(n=this.children).push.apply(n,Pr(t))}},{key:"removeChildren",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=[],a=[];this.children.filter(function(o){t.includes(o.id)?i.push(o):a.push(o)}),i.map(function(o){return o.destroy(n)}),this.children=a}},{key:"removeChild",value:function(t){var n=this.children.indexOf(t);n>-1&&this.children.splice(n,1),t.destroy()}},{key:"getChildren",value:function(t){return this.children.filter(function(n){return t.includes(n.id)})}},{key:"getChild",value:function(t){return this.children.filter(function(n){return n.id===t})[0]}},{key:"clearChild",value:function(){this.children.forEach(function(t){t.destroy()}),this.children.slice(0,this.children.length)}},{key:"hasChild",value:function(t){return this.children.includes(t)}},{key:"initTileFactory",value:function(){var t=this.parent.getSource(),n=VZe(this.parent.type,t.parser);this.tileFactory=new n({parent:this.parent,mapService:this.mapService,rendererService:this.rendererService})}},{key:"getSourceLayer",value:function(t,n){return t==="geojsonvt"?"geojsonvt":t==="testTile"?"testTile":n}},{key:"destroy",value:function(){}}]),e}();function GZe(e){var r=HZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function HZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jZe=function(e){er(t,e);var r=GZe(t);function t(){var n;return st(this,t),n=r.call(this),X(He(n),"checkConfigList",[]),n.cacheConfig=new Map,n}return ot(t,[{key:"setConfig",value:function(i,a){this.checkConfigList.includes(i)||this.checkConfigList.push(i),this.cacheConfig.set(i,a)}},{key:"removeConfig",value:function(i){var a=this.checkConfigList.indexOf(i);a>-1&&(this.cacheConfig.delete(i),this.checkConfigList.splice(a,1))}},{key:"checkConfig",value:function(i){var a=this;if(!!i.inited){var o=i.getLayerConfig(),s=[];this.checkConfigList.map(function(u){var l=a.cacheConfig.get(u),f;if(["color","size","shape"].includes(u)){var h;f=(h=i.getAttribute(u))===null||h===void 0?void 0:h.scale}else{if(!(u in o))return;f=o[u]}Kt.exports.isEqual(l,f)||(s.push(u),a.setConfig(u,f))}),s.length>0&&(console.warn("tile config cache update!",s),this.emit("updateConfig",s))}}},{key:"getAttributeScale",value:function(i,a){var o=i.getAttribute(a),s={field:void 0,values:void 0,callback:void 0};if(o&&o.scale){var u=o.scale,l=u.field,f=u.values,h=u.callback;s.field=l,s.values=f,s.callback=h}return s}}]),t}(_B);function WZe(e){var r=XZe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function XZe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var YZe=function(e){er(t,e);var r=WZe(t);function t(n,i,a,o,s){var u;return st(this,t),u=r.call(this),X(He(u),"isLastPicked",!1),u.parent=n,u.rendererService=i,u.pickingService=a,u.children=o,u.tileRenderService=s,u}return ot(t,[{key:"pick",value:function(i,a){var o=this;this.tileRenderService.renderMask(this.parent);var s=i.filter(function(u){return o.parent.needPick(a.type)&&u.inited&&u.isVisible()}).some(function(u){u.hooks.beforePickingEncode.call(),u.masks.length>0&&(o.rendererService.clear({stencil:0,depth:1,framebuffer:null}),u.masks.map(function(f){f.hooks.beforeRender.call(),f.render(),f.hooks.afterRender.call()})),u.renderModels(!0),u.hooks.afterPickingEncode.call();var l=o.pickingService.pickFromPickingFBO(u,a);return l&&o.parent.type!=="RasterLayer"&&(o.emit("pick",{type:a.type,pickedColors:o.pickingService.pickedColors,layer:u}),o.pickingService.pickedTileLayers=[o.parent]),l});return this.parent.type!=="RasterLayer"&&!s&&this.isLastPicked&&a.type!=="click"&&(this.pickingService.pickedTileLayers=[],this.emit("unpick",{}),this.beforeHighlight([0,0,0])),this.isLastPicked=s,s}},{key:"clearPick",value:function(){this.children.filter(function(i){return i.inited&&i.isVisible()}).map(function(i){i.hooks.beforeSelect.call([0,0,0])}),this.pickingService.pickedTileLayers=[]}},{key:"beforeHighlight",value:function(i){this.children.filter(function(a){return a.inited&&a.isVisible()}).map(function(a){a.hooks.beforeHighlight.call(i)})}},{key:"beforeSelect",value:function(i){this.children.filter(function(a){return a.inited&&a.isVisible()}).map(function(a){a.hooks.beforeSelect.call(i)})}},{key:"destroy",value:function(){this.removeAllListeners()}}]),t}(zf.exports.EventEmitter),ZZe=function(){function e(r){st(this,e),this.rendererService=r}return ot(e,[{key:"render",value:function(t){var n=this;t.filter(function(i){return i.inited}).filter(function(i){return i.isVisible()}).map(function(i){i.hooks.beforeRenderData.call(),i.hooks.beforeRender.call(),i.masks.length>0&&(n.rendererService.clear({stencil:0,depth:1,framebuffer:null}),i.masks.map(function(a){a.hooks.beforeRenderData.call(),a.hooks.beforeRender.call(),a.render(),a.hooks.afterRender.call()})),i.render(),i.hooks.afterRender.call()})}},{key:"renderMask",value:function(t){t.inited&&t.isVisible()&&t.masks.length>0&&(t.hooks.beforeRender.call(),this.rendererService.clear({stencil:0,depth:1,framebuffer:null}),t.masks.map(function(n){n.hooks.beforeRender.call(),n.render(),n.hooks.afterRender.call()}),t.hooks.afterRender.call())}}]),e}(),Fj=["size","color","shape"],Ik=["opacity","zIndex"],qZe=["mask","rampColors","domain","clampHigh","clampLow","pixelConstant","pixelConstantR","pixelConstantG","pixelConstantB","pixelConstantRGB"].concat(Ik),KZe=["stroke","strokeWidth","strokeOpacity","color","shape","size"].concat(Ik),QZe=["stroke","strokeWidth","strokeOpacity","color","shape","size"].concat(Ik),JZe=["color","shape"].concat(Ik),eqe={PointLayer:KZe,LineLayer:QZe,PolygonLayer:JZe,RasterLayer:qZe,MaskLayer:[],TileDebugLayer:[]};function tqe(e){var r=rqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function rqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nqe=function(e){er(t,e);var r=tqe(t);function t(n,i,a,o,s){var u;return st(this,t),u=r.call(this),u.parent=n,u.children=n.layerChildren,u.mapService=i,u.rendererService=a,u.transforms=s,u.tileRenderService=new ZZe(a),u.tilePickService=new YZe(n,a,o,u.children,u.tileRenderService),u.tileStyleService=new jZe,u.setSubLayerInitOption(),u.setConfigListener(),u.initTileFactory(),u}return ot(t,[{key:"render",value:function(){this.tileStyleService.checkConfig(this.parent),this.tileRenderService.render(this.children)}},{key:"pickLayers",value:function(i){return this.tilePickService.pick(this.children,i)}},{key:"setSubLayerInitOption",value:function(){var i,a=this.parent.getLayerConfig(),o=a.zIndex,s=o===void 0?0:o,u=a.opacity,l=u===void 0?1:u,f=a.mask,h=f===void 0?!1:f,p=a.stroke,v=p===void 0?"#fff":p,m=a.strokeWidth,x=m===void 0?0:m,E=a.strokeOpacity,A=E===void 0?1:E,L=a.clampLow,k=L===void 0?!0:L,R=a.clampHigh,D=R===void 0?!0:R,$=a.domain,j=$===void 0?[0,1]:$,H=a.rampColors,ee=H===void 0?{colors:["rgb(166,97,26)","rgb(223,194,125)","rgb(245,245,245)","rgb(128,205,193)","rgb(1,133,113)"],positions:[0,.25,.5,.75,1]}:H,U=a.featureId,W=U===void 0?"id":U,Q=a.workerEnabled,te=Q===void 0?!1:Q,ie=a.sourceLayer,ve=a.pixelConstant,me=ve===void 0?0:ve,Re=a.pixelConstantR,We=Re===void 0?256*256:Re,je=a.pixelConstantG,lt=je===void 0?256:je,dt=a.pixelConstantB,ct=dt===void 0?1:dt,Tt=a.pixelConstantRGB,It=Tt===void 0?.1:Tt,Lt=this.tileStyleService.getAttributeScale(this.parent,"color"),rn=this.tileStyleService.getAttributeScale(this.parent,"size"),wn=this.parent.getSource(),zn=(wn==null||(i=wn.data)===null||i===void 0?void 0:i.tilesetOptions)||{},Zt=zn.coords,nn=wn.getParserType(),mn=Pie(this.parent.type,this.parent);if(this.initOptions={layerType:this.parent.type,transforms:this.transforms,shape:mn,zIndex:s,opacity:l,sourceLayer:this.getSourceLayer(nn,ie),coords:Zt,featureId:W,color:Lt,size:rn,mask:Rie(this.parent.type,h),stroke:v,strokeWidth:x,strokeOpacity:A,clampLow:k,clampHigh:D,domain:j,rampColors:ee,workerEnabled:te,pixelConstant:me,pixelConstantR:We,pixelConstantG:lt,pixelConstantB:ct,pixelConstantRGB:It},ee){var zt=this.rendererService.createTexture2D,Vr=Ay(ee),On=zt({data:Vr.data,width:Vr.width,height:Vr.height,flipY:!1});this.initOptions.colorTexture=On}}},{key:"getInitOptionValue",value:function(i){var a,o,s;switch(i){case"color":return(a=this.parent.getAttribute("color"))===null||a===void 0?void 0:a.scale;case"shape":return(o=this.parent.getAttribute("shape"))===null||o===void 0?void 0:o.scale;case"size":return(s=this.parent.getAttribute("size"))===null||s===void 0?void 0:s.scale;default:return this.initOptions[i]}}},{key:"setInitOptionValue",value:function(i,a){this.initOptions[i]=a}},{key:"setConfigListener",value:function(){var i=this,a=eqe[this.parent.type]||[];a.map(function(o){i.tileStyleService.setConfig(o,i.getInitOptionValue(o))}),this.tileStyleService.on("updateConfig",function(o){o.map(function(s){return i.updateStyle(s)})})}},{key:"updateAttribute",value:function(i){var a=this;if(Fj.includes(i)){var o,s=(o=this.parent.getAttribute(i))===null||o===void 0?void 0:o.scale;if(!s)return;this.children.map(function(u){return xM(u,a.parent,i,s)})}}},{key:"updateStyle",value:function(i){var a=null;if(Fj.includes(i))this.updateAttribute(i);else{var o=this.parent.getLayerConfig();if(!(i in o))return;var s=o[i];switch(a=s,i){case"rampColors":var u=OXe(s,this.children,this.rendererService);this.initOptions.colorTexture=u;break;default:FD(this.children,i,s)}}this.setInitOptionValue(i,a)}},{key:"destroy",value:function(){this.tilePickService.destroy()}}]),t}(qie),Kie=function(){function e(){st(this,e),X(this,"initedTileset",!1),X(this,"viewchange",Kt.exports.debounce(this.mapchange,200))}return ot(e,[{key:"children",get:function(){return this.tileLayerManager.children}},{key:"mapchange",value:function(){var t,n=this.getCurrentView(),i=n.latLonBounds,a=n.zoom;if(this.mapService.version==="GAODE1.x"){var o=this.parent.getLayerConfig(),s=o.visible;a<3&&s?(this.parent.updateLayerConfig({visible:!1}),this.layerService.reRender()):a>=3&&!s&&(this.parent.updateLayerConfig({visible:!0}),this.layerService.reRender())}this.lastViewStates&&this.lastViewStates.zoom===a&&this.lastViewStates.latLonBounds.toString()===i.toString()||(this.lastViewStates={zoom:a,latLonBounds:i},(t=this.tilesetManager)===null||t===void 0||t.throttleUpdate(a,i))}},{key:"getCurrentView",value:function(){var t=this.mapService.getBounds(),n=[t[0][0],t[0][1],t[1][0],t[1][1]],i=this.mapService.getZoom();return{latLonBounds:n,zoom:i}}},{key:"initTileSetManager",value:function(){var t,n=this.parent.getSource();this.tilesetManager=n.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var i=this.getCurrentView(),a=i.latLonBounds,o=i.zoom;(t=this.tilesetManager)===null||t===void 0||t.update(o,a)}},{key:"bindTilesetEvent",value:function(){var t=this;!this.tilesetManager||(this.tilesetManager.on("tile-loaded",function(n){}),this.tilesetManager.on("tile-unload",function(n){t.tileUnLoad(n)}),this.tilesetManager.on("tile-error",function(n,i){t.tileError(n)}),this.tilesetManager.on("tile-update",function(){t.tileUpdate()}),this.mapService.on("zoomend",function(){return t.viewchange()}),this.mapService.on("moveend",function(){return t.viewchange()}))}},{key:"render",value:function(){this.tileLayerManager.render()}},{key:"tileLoaded",value:function(t){}},{key:"tileError",value:function(t){console.warn("error:",t)}},{key:"destroy",value:function(){var t;(t=this.tilesetManager)===null||t===void 0||t.destroy(),this.tileLayerManager.destroy()}},{key:"tileUnLoad",value:function(t){this.tileLayerManager.removeTile(t)}},{key:"tileUpdate",value:function(){var t=this;!this.tilesetManager||(this.tilesetManager.tiles.filter(function(n){return n.isLoaded}).map(function(n){if(!!t.isTileReady(n))if(t.tileLayerManager.hasTile(n)){if(!n.isVisibleChange)return;var o=t.tileLayerManager.getChildren(n.layerIDList);jXe(n,o,t.layerService),t.setPickState(o)}else{var i=t.tileLayerManager.addTile(n),a=i.layers;t.setPickState(a)}}),this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles))}},{key:"isTileReady",value:function(t){var n;if((n=t.data)!==null&&n!==void 0&&n.layers&&this.sourceLayer){var i=t.data.layers[this.sourceLayer],a=i==null?void 0:i.features;if(!(Array.isArray(a)&&a.length>0))return!1}return!0}},{key:"setPickState",value:function(t){}}]),e}();function iqe(e){e.filter(function(r){return r.inited&&r.isVisible()}).filter(function(r){return r.getCurrentSelectedId()!==null}).map(function(r){qC(r,new Uint8Array([0,0,0,0])),r.setCurrentSelectedId(null)})}function aqe(e,r,t){var n=dy(r),i;return e.map(function(a){a.getCurrentSelectedId()===null||n!==a.getCurrentSelectedId()?(qC(a,r),a.setCurrentSelectedId(n),i=r):(qC(a,new Uint8Array([0,0,0,0])),a.setCurrentSelectedId(null),i=null)}),t.filter(function(a){return a.inited&&!a.isVector&&a.isVisible()&&a.needPick("click")}).filter(function(a){return a.getCurrentSelectedId()!==null}).map(function(a){qC(a,new Uint8Array([0,0,0,0])),a.setCurrentSelectedId(null)}),i}function oqe(e,r){var t=dy(r);e.filter(function(n){return n.inited&&n.isVisible()&&n.isVector}).filter(function(n){return n.getPickID()!==t}).map(function(n){n.setPickID(t),n.hooks.beforeHighlight.call(r)})}function sqe(e,r){r.select&&e.map(function(t){qC(t,r.select)}),r.active&&e.filter(function(t){return t.inited&&t.isVisible()}).map(function(t){t.hooks.beforeHighlight.call(r.active)})}function qC(e,r){var t=tn(r,3),n=t[0],i=t[1],a=t[2];e.hooks.beforeSelect.call([n,i,a])}function uqe(e){var r=lqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function lqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cqe=function(e){er(t,e);var r=uqe(t);function t(n){var i,a,o=n.parent,s=n.rendererService,u=n.mapService,l=n.layerService,f=n.pickingService,h=n.transforms;st(this,t),a=r.call(this),X(He(a),"pickColors",{select:null,active:null});var p=o.getSource(),v=(p==null||(i=p.data)===null||i===void 0?void 0:i.tilesetOptions)||{},m=v.sourceLayer;return a.sourceLayer=m,a.parent=o,a.mapService=u,a.layerService=l,a.tileLayerManager=new nqe(o,u,s,f,h),a.initTileSetManager(),a.bindSubLayerEvent(),a.bindSubLayerPick(),a.scaleField=a.parent.getScaleOptions(),a}return ot(t,[{key:"children",get:function(){return this.tileLayerManager.children}},{key:"clearPick",value:function(i){i==="mousemove"&&this.tileLayerManager.tilePickService.clearPick()}},{key:"clearPickState",value:function(){iqe(this.children)}},{key:"pickLayers",value:function(i){return this.tileLayerManager.pickLayers(i)}},{key:"setPickState",value:function(i){sqe(i,this.pickColors)}},{key:"bindSubLayerPick",value:function(){var i=this;this.tileLayerManager.tilePickService.on("pick",function(a){var o=tn(a.pickedColors,3),s=o[0],u=o[1],l=o[2];if(a.type==="click"){var f=i.children.filter(function(v){return v.inited&&v.isVisible()&&v.isVector}).filter(function(v){return v!==a.layer}),h=i.layerService.getRenderList(),p=aqe(f,[s,u,l],h);i.pickColors.select=p}else oqe(i.children,[s,u,l]),i.pickColors.active=[s,u,l]}),this.tileLayerManager.tilePickService.on("unpick",function(){i.pickColors.active=null})}},{key:"bindSubLayerEvent",value:function(){var i=this;this.parent.on("subLayerClick",function(a){i.parent.emit("click",Et({},a))}),this.parent.on("subLayerMouseMove",function(a){return i.parent.emit("mousemove",Et({},a))}),this.parent.on("subLayerMouseUp",function(a){return i.parent.emit("mouseup",Et({},a))}),this.parent.on("subLayerMouseEnter",function(a){return i.parent.emit("mouseenter",Et({},a))}),this.parent.on("subLayerMouseOut",function(a){return i.parent.emit("mouseout",Et({},a))}),this.parent.on("subLayerMouseDown",function(a){return i.parent.emit("mousedown",Et({},a))}),this.parent.on("subLayerContextmenu",function(a){return i.parent.emit("contextmenu",Et({},a))}),this.parent.on("subLayerUnClick",function(a){return i.parent.emit("unclick",Et({},a))}),this.parent.on("subLayerUnMouseMove",function(a){return i.parent.emit("unmousemove",Et({},a))}),this.parent.on("subLayerUnMouseUp",function(a){return i.parent.emit("unmouseup",Et({},a))}),this.parent.on("subLayerUnMouseDown",function(a){return i.parent.emit("unmousedown",Et({},a))}),this.parent.on("subLayerUnContextmenu",function(a){return i.parent.emit("uncontextmenu",Et({},a))})}}]),t}(Kie);function fqe(e){var r=hqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function hqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pqe=function(e){er(t,e);var r=fqe(t);function t(n,i,a){var o;return st(this,t),o=r.call(this),o.parent=n,o.children=n.layerChildren,o.mapService=i,o.rendererService=a,o.setSubLayerInitOption(),o.initTileFactory(),o}return ot(t,[{key:"render",value:function(){var i=this;this.children.filter(function(a){return a.inited}).filter(function(a){return a.isVisible()}).map(function(a){a.hooks.beforeRenderData.call(),a.hooks.beforeRender.call(),a.masks.length>0&&(i.rendererService.clear({stencil:0,depth:1,framebuffer:null}),a.masks.map(function(o){o.hooks.beforeRenderData.call(),o.hooks.beforeRender.call(),o.render(),o.hooks.afterRender.call()})),a.render(),a.hooks.afterRender.call()})}},{key:"setSubLayerInitOption",value:function(){var i,a,o=this.parent.getLayerConfig(),s=o.zIndex,u=s===void 0?0:s,l=o.opacity,f=l===void 0?1:l,h=o.mask,p=h===void 0?!1:h,v=o.stroke,m=v===void 0?"#fff":v,x=o.strokeWidth,E=x===void 0?0:x,A=o.strokeOpacity,L=A===void 0?1:A,k=o.workerEnabled,R=k===void 0?!1:k,D=o.sourceLayer,$=this.parent.getSource(),j=$.getParserType(),H=this.parent.getAttribute("color"),ee=(H==null||(i=H.scale)===null||i===void 0?void 0:i.field)||"#fff",U=this.parent.getAttribute("size"),W=(U==null||(a=U.scale)===null||a===void 0?void 0:a.field)||1,Q=Pie(this.parent.type,this.parent);this.initOptions={usage:"basemap",layerType:this.parent.type,shape:Q,zIndex:u,opacity:f,sourceLayer:this.getSourceLayer(j,D),basemapColor:ee,basemapSize:W,mask:Rie(this.parent.type,p),stroke:m,strokeWidth:E,strokeOpacity:L,workerEnabled:R}}}]),t}(qie);function dqe(e){var r=vqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function vqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gqe=function(e){er(t,e);var r=dqe(t);function t(n){var i,a,o=n.parent,s=n.rendererService,u=n.mapService,l=n.layerService;st(this,t),a=r.call(this);var f=o.getSource(),h=(f==null||(i=f.data)===null||i===void 0?void 0:i.tilesetOptions)||{},p=h.sourceLayer;return a.sourceLayer=p,a.parent=o,a.mapService=u,a.layerService=l,a.tileLayerManager=new pqe(o,u,s),a.initTileSetManager(),a}return ot(t)}(Kie);function mqe(e){var r=yqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function yqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var J2=function(e){er(t,e);var r=mqe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){return{}}},{key:"getTileLayer",value:function(i){switch(i){case"basemap":return gqe;default:return cqe}}},{key:"initModels",value:function(){var i=this.layer.getSource(),a=this.layer.getLayerConfig(),o=a.usage;if(i!=null&&i.data.isTile&&!this.layer.tileLayer){var s=this.getTileLayer(o);this.layer.tileLayer=new s({parent:this.layer,rendererService:this.rendererService,mapService:this.mapService,layerService:this.layerService,pickingService:this.pickingService,transforms:i.transforms})}return this.buildModels()}},{key:"clearModels",value:function(){}},{key:"buildModels",value:function(){return[]}},{key:"registerBuiltinAttributes",value:function(){}}]),t}(qi);function _qe(e){var r=xqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function xqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bqe=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,wqe=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,Cqe=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,Eqe=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  float arcThetaOffset = styleMappingMat[0][1];
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, arcThetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, arcThetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Sqe=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,Aqe=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Tqe={solid:0,dash:1},Mqe=function(e){er(t,e);var r=_qe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.NEAREST,min:K.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,p=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,x=i.forward,E=x===void 0?!0:x,A=i.lineTexture,L=A===void 0?!1:A,k=i.iconStep,R=k===void 0?100:k,D=i.segmentNumber,$=D===void 0?30:D,j=i.thetaOffset,H=j===void 0?.314:j;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,thetaOffset:H})){this.judgeStyleAttributes({opacity:o,thetaOffset:H});var ee=this.layer.getEncodedData(),U=this.calDataFrame(this.cellLength,ee,this.cellProperties),W=U.data,Q=U.width,te=U.height;this.rowCount=te,this.dataTexture=this.cellLength>0&&W.length>0?this.createTexture2D({flipY:!0,data:W,format:K.LUMINANCE,type:K.FLOAT,width:Q,height:te}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}m.length===2&&m.push(0,0);var ie=0,ve=[0,0,0,0],me=[0,0,0,0];return s&&u&&(ve=Sa(s),me=Sa(u),ie=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:Kt.exports.isNumber(H)?H:0,u_opacity:Kt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:$,u_line_type:Tqe[p||"solid"],u_dash_array:m,u_blur:.9,u_lineDir:E?1:-1,u_texture:this.texture,u_line_texture:L?1:0,u_icon_step:R,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:ie,u_sourceColor:ve,u_targetColor:me}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor,s=i.lineType;return s==="dash"?{frag:bqe,vert:wqe,type:"Dash"}:a&&o?{frag:Sqe,vert:Aqe,type:"Linear"}:{frag:Cqe,vert:Eqe,type:""}}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.segmentNumber,s=o===void 0?30:o,u=a.mask,l=u===void 0?!1:u,f=a.maskInside,h=f===void 0?!0:f,p=this.getShaders(),v=p.frag,m=p.vert,x=p.type;this.layer.buildLayerModel({moduleName:"lineArc2d"+x,vertexShader:m,fragmentShader:v,triangulation:Mk,depth:{enable:!1},blend:this.getBlend(),segmentNumber:s,stencil:Ya(l,h)}).then(function(E){i([E])}).catch(function(E){console.warn(E),i([])})}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?1:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:4,update:function(o,s,u){return[u[3],u[4],u[5],u[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.texture,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),t}(qi);function Lqe(e){var r=Iqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Iqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var kqe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Pqe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Rqe=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Oqe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Fqe={solid:0,dash:1},Dqe=function(e){er(t,e);var r=Lqe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.NEAREST,min:K.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,p=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,x=i.lineTexture,E=x===void 0?!1:x,A=i.iconStep,L=A===void 0?100:A,k=i.segmentNumber,R=k===void 0?30:k,D=i.globalArcHeight,$=D===void 0?10:D;m.length===2&&m.push(0,0);var j=0,H=[0,0,0,0],ee=[0,0,0,0];if(s&&u&&(H=Sa(s),ee=Sa(u),j=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var U=this.layer.getEncodedData(),W=this.calDataFrame(this.cellLength,U,this.cellProperties),Q=W.data,te=W.width,ie=W.height;this.rowCount=ie,this.dataTexture=this.cellLength>0&&Q.length>0?this.createTexture2D({flipY:!0,data:Q,format:K.LUMINANCE,type:K.FLOAT,width:te,height:ie}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:LS,u_global_height:$,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:R,u_line_type:Fqe[p]||0,u_dash_array:m,u_texture:this.texture,u_line_texture:E?1:0,u_icon_step:L,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:j,u_sourceColor:H,u_targetColor:ee}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor;return a&&o?{frag:Rqe,vert:Oqe,type:"Linear"}:{frag:kqe,vert:Pqe,type:""}}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.segmentNumber,s=o===void 0?30:o,u=a.mask,l=u===void 0?!1:u,f=a.maskInside,h=f===void 0?!0:f,p=this.getShaders(),v=p.frag,m=p.vert,x=p.type;this.layer.buildLayerModel({moduleName:"lineArc3d"+x,vertexShader:m,fragmentShader:v,triangulation:Mk,blend:this.getBlend(),segmentNumber:s,stencil:Ya(l,h)}).then(function(E){i([E])}).catch(function(E){console.warn(E),i([])})}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?1:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:4,update:function(o,s,u){return[u[3],u[4],u[5],u[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.texture,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),t}(qi);function Bqe(e){var r=Nqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Nqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var zqe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,$qe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Uqe=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Vqe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Gqe={solid:0,dash:1},Hqe=function(e){er(t,e);var r=Bqe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.NEAREST,min:K.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,p=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,x=i.lineTexture,E=x===void 0?!1:x,A=i.iconStep,L=A===void 0?100:A,k=i.segmentNumber,R=k===void 0?30:k,D=i.globalArcHeight,$=D===void 0?10:D;m.length===2&&m.push(0,0);var j=0,H=[0,0,0,0],ee=[0,0,0,0];if(s&&u&&(H=Sa(s),ee=Sa(u),j=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var U=this.layer.getEncodedData(),W=this.calDataFrame(this.cellLength,U,this.cellProperties),Q=W.data,te=W.width,ie=W.height;this.rowCount=ie,this.dataTexture=this.cellLength>0&&Q.length>0?this.createTexture2D({flipY:!0,data:Q,format:K.LUMINANCE,type:K.FLOAT,width:te,height:ie}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_globel:1,u_globel_radius:LS,u_global_height:$,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:R,u_line_type:Gqe[p]||0,u_dash_array:m,u_texture:this.texture,u_line_texture:E?1:0,u_icon_step:L,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:j,u_sourceColor:H,u_targetColor:ee}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor;return a&&o?{frag:Uqe,vert:Vqe,type:"Linear"}:{frag:zqe,vert:$qe,type:""}}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.segmentNumber,s=o===void 0?30:o,u=a.mask,l=u===void 0?!1:u,f=a.maskInside,h=f===void 0?!0:f,p=this.getShaders(),v=p.frag,m=p.vert,x=p.type;this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+x,vertexShader:m,fragmentShader:v,triangulation:Mk,depth:{enable:!0},blend:this.getBlend(),segmentNumber:s,stencil:Ya(l,h)}).then(function(E){i([E])}).catch(function(E){console.warn(E),i([])})}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?1:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:4,update:function(o,s,u){return[u[3],u[4],u[5],u[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.texture,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),t}(qi);function jqe(e){var r=Wqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Wqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Xqe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,Yqe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,Zqe={solid:0,dash:1},qqe=function(e){er(t,e);var r=jqe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.NEAREST,min:K.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,p=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5]:v,x=i.lineTexture,E=x===void 0?!1:x,A=i.iconStep,L=A===void 0?100:A,k=i.segmentNumber,R=k===void 0?30:k;m.length===2&&m.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var D=0,$=[0,0,0,0],j=[0,0,0,0];if(s&&u&&($=Sa(s),j=Sa(u),D=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var H=this.layer.getEncodedData(),ee=this.calDataFrame(this.cellLength,H,this.cellProperties),U=ee.data,W=ee.width,Q=ee.height;this.rowCount=Q,this.dataTexture=this.cellLength>0&&U.length>0?this.createTexture2D({flipY:!0,data:U,format:K.LUMINANCE,type:K.FLOAT,width:W,height:Q}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,segmentNumber:R,u_line_type:Zqe[p]||0,u_dash_array:m,u_texture:this.texture,u_line_texture:E?1:0,u_icon_step:L,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:D,u_sourceColor:$,u_targetColor:j}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:Yqe,fragmentShader:Xqe,triangulation:Mk,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?1:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Ar.Attribute,descriptor:{name:"a_Instance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:4,update:function(o,s,u){return[u[3],u[4],u[5],u[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.texture,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),t}(qi);function Kqe(e){var r=Qqe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function Qqe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Jqe=`#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
uniform float u_CoordinateSystem;
varying vec4 v_color;
uniform float u_arrow: 0.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

varying mat4 styleMappingMat;
void main() {
  float distanceAndIndex = styleMappingMat[0][3];
  float miter = styleMappingMat[0][2];

  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B


  if(u_arrow > 0.0 && distanceAndIndex < 2.0) { // arrow
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) { 
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z < 0.0) { // amap
        discard;
      }
    } else { // amap2 mapbox map
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z > 0.0) { 
        discard;
      }
    }
  } else { // line body
    if(miter < 0.0) {
      discard;
    }
  }


  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,eKe=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute vec4 a_dirPoints;
attribute vec3 a_DistanceAndIndex;

uniform vec4 u_lineDir;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - a_Miter - a_DistanceAndIndex
    0.0, 0.0, 0.0, 0.0, // originX - originY - vectorX - vectorY
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );
  styleMappingMat[0][3] = a_DistanceAndIndex.y;
  styleMappingMat[0][2] = a_Miter;

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97


  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  // styleMappingMat[1].rg = a_Position.xy + offset;

  vec2 copyOffset = vec2(offset.x, offset.y);

  float lineDistance = a_DistanceAndIndex.x;
  float total_Distance = a_DistanceAndIndex.z;
  float currentLinePointRatio = lineDistance / total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z); // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }
  
  if(u_arrow > 0.0 && a_DistanceAndIndex.y < 2.0) {
    vec2 startPoint = a_dirPoints.rg;
    vec2 endPoint = a_dirPoints.ba;
    vec4 t1 = project_position(vec4(startPoint, 0, 1.0));
    vec4 t2 = project_position(vec4(endPoint, 0, 1.0));
    // TODO\uFF1A \u540E\u7EED\u4F18\u5316\u53EF\u4EE5\u628A\u4F4D\u7F6E\u8BA1\u7B97\u653E\u5728 cpu \u4E2D\u5B8C\u6210
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      vec2 p1 = (u_Mvp * vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = (u_Mvp * vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    } else {
      vec2 p1 = project_common_position_to_clipspace(vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = project_common_position_to_clipspace(vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    }
  }

  setPickingColor(a_PickingColor);
}
`,tKe=function(e){er(t,e);var r=Kqe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.arrow,f=l===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:l,h=0,p=[0,0,0,0],v=[0,0,0,0];if(s&&u&&(p=Sa(s),v=Sa(u),h=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var m=this.layer.getEncodedData(),x=this.calDataFrame(this.cellLength,m,this.cellProperties),E=x.data,A=x.width,L=x.height;this.rowCount=L,this.dataTexture=this.cellLength>0&&E.length>0?this.createTexture2D({flipY:!0,data:E,format:K.LUMINANCE,type:K.FLOAT,width:A,height:L}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_linearColor:h,u_sourceColor:p,u_targetColor:v,u_arrow:Number(f.enable),u_arrowHeight:f.arrowHeight||3,u_arrowWidth:f.arrowWidth||2,u_tailWidth:f.tailWidth===void 0?1:f.tailWidth}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"buildModels",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v,m,x,E;return Xr.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:s=this.layer.getLayerConfig(),u=s.mask,l=u===void 0?!1:u,f=s.maskInside,h=f===void 0?!0:f,p=s.depth,v=p===void 0?!1:p,m=this.getShaders(),x=m.frag,E=m.vert,this.layer.triangulation=l1,this.layer.buildLayerModel({moduleName:"lineHalf",vertexShader:E,fragmentShader:x,triangulation:l1,depth:{enable:v},blend:this.getBlend(),stencil:Ya(l,h)}).then(function(k){o([k])}).catch(function(k){console.warn(k),o([])});case 4:case"end":return L.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(){return{frag:Jqe,vert:eKe,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ar.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l,f){return f===void 0?[s[3],10,s[5]]:[s[3],f,s[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"dirPoints",type:Ar.Attribute,descriptor:{name:"a_dirPoints",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:4,update:function(a){var o=a.coordinates[0]||[0,0],s=a.coordinates[3]||[0,0];return[o[0],o[1],s[0],s[1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a,o,s){return[s[4]]}}})}}]),t}(qi);function rKe(e){var r=nKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function nKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var iKe=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,aKe=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,oKe=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;

uniform vec3 u_blur;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = styleMappingMat[3][3];
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,Dj=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,sKe=`varying vec4 v_color;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3][0]; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,uKe={solid:0,dash:1},Qie=function(e){er(t,e);var r=rKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.NEAREST,min:K.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.lineType,p=h===void 0?"solid":h,v=i.dashArray,m=v===void 0?[10,5,0,0]:v,x=i.lineTexture,E=x===void 0?!1:x,A=i.iconStep,L=A===void 0?100:A,k=i.vertexHeightScale,R=k===void 0?20:k,D=i.borderWidth,$=D===void 0?0:D,j=i.borderColor,H=j===void 0?"#ccc":j,ee=i.raisingHeight,U=ee===void 0?0:ee,W=i.heightfixed,Q=W===void 0?!1:W,te=i.linearDir,ie=te===void 0?u1.VERTICAL:te,ve=i.blur,me=ve===void 0?[1,1,1]:ve,Re=i.arrow,We=Re===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:Re;m.length===2&&m.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var je=0,lt=[0,0,0,0],dt=[0,0,0,0];if(s&&u&&(lt=Sa(s),dt=Sa(u),je=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var ct=this.layer.getEncodedData(),Tt=this.calDataFrame(this.cellLength,ct,this.cellProperties),It=Tt.data,Lt=Tt.width,rn=Tt.height;this.rowCount=rn,this.dataTexture=this.cellLength>0&&It.length>0?this.createTexture2D({flipY:!0,data:It,format:K.LUMINANCE,type:K.FLOAT,width:Lt,height:rn}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_textureBlend:f===_L.NORMAL?0:1,u_line_type:uKe[p],u_dash_array:m,u_blur:me,u_texture:this.texture,u_line_texture:E?1:0,u_icon_step:L,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:$,u_borderColor:Sa(H),u_linearDir:ie===u1.VERTICAL?1:0,u_linearColor:je,u_sourceColor:lt,u_targetColor:dt,u_heightfixed:Number(Q),u_vertexScale:R,u_raisingHeight:Number(U),u_arrow:Number(We.enable),u_arrowHeight:We.arrowHeight||3,u_arrowWidth:We.arrowWidth||2,u_tailWidth:We.tailWidth===void 0?1:We.tailWidth}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=a.depth,h=f===void 0?!1:f,p=a.workerEnabled,v=p===void 0?!1:p,m=a.enablePicking,x=this.getShaders(),E=x.frag,A=x.vert,L=x.type;this.layer.triangulation=cL,this.layer.buildLayerModel({moduleName:"line"+L,vertexShader:A,fragmentShader:E,triangulation:cL,depth:{enable:h},blend:this.getBlend(),stencil:Ya(s,l),workerEnabled:v,workerOptions:{modelType:"line"+L,enablePicking:m,iconMap:this.iconService.getIconMap()}}).then(function(k){i([k])}).catch(function(k){console.warn(k),i([])})}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor,s=i.lineType;return s==="dash"?{frag:iKe,vert:aKe,type:"Dash"}:a&&o?{frag:sKe,vert:Dj,type:"Linear"}:{frag:oKe,vert:Dj,type:""}}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ar.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o,s,u,l,f,h){return h===void 0?[u[3],10]:[u[3],h]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o,s,u){return[u[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=o.size,u=s===void 0?1:s;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(o,s,u,l,f){return f}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o,s,u){return[u[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.texture,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),t}(qi);function lKe(e){var r=cKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function cKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fKe=`uniform float u_opacity : 1.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;

#pragma include "picking"

varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  gl_FragColor = texture2D(u_texture, vec2(linearRadio, 0.5));

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,hKe=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

uniform float u_opacity: 1.0;

#pragma include "projection"
#pragma include "picking"

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,pKe=function(e){er(t,e);var r=lKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;n.colorTexture&&n.colorTexture.destroy();var u=n.layer.getLayerConfig(),l=u.rampColors,f=Ay(l);n.colorTexture=s({data:new Uint8Array(f.data),width:f.width,height:f.height,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE,min:K.NEAREST,mag:K.NEAREST,flipY:!1})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.vertexHeightScale,u=s===void 0?20:s,l=i.raisingHeight,f=l===void 0?0:l,h=i.heightfixed,p=h===void 0?!1:h,v=i.linearDir,m=v===void 0?u1.VERTICAL:v;if(this.rendererService.getDirty()&&this.colorTexture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var x=this.layer.getEncodedData(),E=this.calDataFrame(this.cellLength,x,this.cellProperties),A=E.data,L=E.width,k=E.height;this.rowCount=k,this.dataTexture=this.cellLength>0&&A.length>0?this.createTexture2D({flipY:!0,data:A,format:K.LUMINANCE,type:K.FLOAT,width:L,height:k}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_linearDir:m===u1.VERTICAL?1:0,u_opacity:Kt.exports.isNumber(o)?o:1,u_texture:this.colorTexture,u_heightfixed:Number(p),u_vertexScale:u,u_raisingHeight:Number(f)}}},{key:"initModels",value:function(i){this.updateTexture(),this.buildModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.colorTexture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy()}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=a.depth,h=f===void 0?!1:f;this.layer.triangulation=l1,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:hKe,fragmentShader:fKe,triangulation:l1,depth:{enable:h},blend:this.getBlend(),stencil:Ya(s,l)}).then(function(p){i([p])}).catch(function(p){console.warn(p),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Ar.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s,u,l,f){return f===void 0?[s[3],10]:[s[3],f]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a,o,s){return[s[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a,o,s){return[s[4]]}}})}}]),t}(qi);function dKe(e){var r=vKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function vKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gKe=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,mKe=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];

  // styleMappingMat[3][0] \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = mix(u_sourceColor, u_targetColor, styleMappingMat[3][0]);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,Bj=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  v_color = a_Color; 
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,yKe=function(e){er(t,e);var r=dKe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.vertexHeightScale,f=l===void 0?20:l,h=0,p=[0,0,0,0],v=[0,0,0,0];if(s&&u&&(p=Sa(s),v=Sa(u),h=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var m=this.layer.getEncodedData(),x=this.calDataFrame(this.cellLength,m,this.cellProperties),E=x.data,A=x.width,L=x.height;this.rowCount=L,this.dataTexture=this.cellLength>0&&E.length>0?this.createTexture2D({flipY:!0,data:E,format:K.LUMINANCE,type:K.FLOAT,width:A,height:L}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_linearColor:h,u_sourceColor:p,u_targetColor:v,u_vertexScale:f}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.sourceColor,o=i.targetColor;return a&&o?{frag:mKe,vert:Bj,type:"lineSimpleLinear"}:{frag:gKe,vert:Bj,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=this.getShaders(),h=f.frag,p=f.vert,v=f.type;this.layer.buildLayerModel({moduleName:v,vertexShader:p,fragmentShader:h,triangulation:nWe,primitive:K.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(s,l),pick:!1}).then(function(m){i([m])}).catch(function(m){console.warn(m),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:Ar.Attribute,descriptor:{name:"a_Distance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a,o,s){return[s[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a,o,s){return[s[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}})}}]),t}(qi);function _Ke(e){var r=xKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function xKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bKe=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,wKe=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,CKe=function(e){er(t,e);var r=_Ke(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.NEAREST,min:K.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.sourceColor,u=i.targetColor,l=i.textureBlend,f=l===void 0?"normal":l,h=i.heightfixed,p=h===void 0?!1:h,v=i.lineTexture,m=v===void 0?!1:v,x=i.iconStep,E=x===void 0?100:x,A=i.iconStepCount,L=A===void 0?1:A;this.rendererService.getDirty()&&this.texture.bind();var k=0,R=[0,0,0,0],D=[0,0,0,0];return s&&u&&(R=Sa(s),D=Sa(u),k=1),{u_heightfixed:Number(p),u_opacity:Kt.exports.isNumber(o)?o:1,u_textureBlend:f==="normal"?0:1,u_texture:this.texture,u_line_texture:m?1:0,u_iconStepCount:L,u_icon_step:E,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:k,u_sourceColor:R,u_targetColor:D}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels(i)}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(i){this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:wKe,fragmentShader:bKe,triangulation:l1,depth:{enable:!1},blend:this.getBlend()}).then(function(a){i([a])}).catch(function(a){console.warn(a),i([])})}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Ar.Attribute,descriptor:{name:"a_Distance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o,s,u){return[u[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Ar.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o,s,u){return[u[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=o.size,u=s===void 0?1:s;return Array.isArray(u)?[u[0],u[1]]:[u,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(o,s,u,l,f){return f}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Ar.Attribute,descriptor:{name:"a_Miter",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o,s,u){return[u[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.texture,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),t}(qi),EKe={arc:Mqe,arc3d:Dqe,greatcircle:qqe,wall:CKe,line:Qie,halfLine:tKe,simple:yKe,linearline:pKe,vectorline:J2,tileLine:DD,earthArc3d:Hqe},SKe=EKe;function AKe(e){var r=TKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function TKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var MKe=function(e){er(t,e);var r=AKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","LineLayer"),X(He(n),"arrowInsertCount",0),X(He(n),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new SKe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},vectorline:{},tileLine:{},halfLine:{},earthArc3d:{}};return a[i]}},{key:"getModelType",value:function(){var i;if(this.layerType)return this.layerType;var a=this.layerSource.getParserType();if(Lk(a))return"vectorline";var o=this.styleAttributeService.getLayerStyleAttribute("shape"),s=o==null||(i=o.scale)===null||i===void 0?void 0:i.field;return s||"line"}}]),t}($f);function LKe(e){var r=IKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function IKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var kKe=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,PKe=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,RKe=function(e){er(t,e);var r=LKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"raiseCount",0),X(He(n),"raiseRepeat",0),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,s=i.opacity,u=s===void 0?1:s,l=i.sourceColor,f=i.targetColor,h=i.pickLight,p=h===void 0?!1:h,v=i.heightfixed,m=v===void 0?!1:v,x=i.opacityLinear,E=x===void 0?{enable:!1,dir:"up"}:x,A=i.lightEnable,L=A===void 0?!0:A;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:u})){this.judgeStyleAttributes({opacity:u});var k=this.layer.getEncodedData(),R=this.calDataFrame(this.cellLength,k,this.cellProperties),D=R.data,$=R.width,j=R.height;this.rowCount=j,this.dataTexture=this.cellLength>0&&D.length>0?this.createTexture2D({flipY:!0,data:D,format:K.LUMINANCE,type:K.FLOAT,width:$,height:j}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}var H=0,ee=[0,0,0,0],U=[0,0,0,0];if(l&&f&&(ee=Sa(l),U=Sa(f),H=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){var W=o.speed,Q=W===void 0?.01:W;this.raiseCount+=Q,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(p),u_heightfixed:Number(m),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(u)?u:1,u_linearColor:H,u_sourceColor:ee,u_targetColor:U,u_opacitylinear:Number(E.enable),u_opacitylinear_dir:E.dir==="up"?1:0,u_lightEnable:Number(L)}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.animateOption.repeat,s=o===void 0?1:o;this.raiseRepeat=s,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:PKe,fragmentShader:kKe,triangulation:h6,depth:{enable:!0},cull:{enable:!0,face:Z2(this.mapService.version)},blend:this.getBlend()}).then(function(u){i([u])}).catch(function(u){console.warn(u),i([])})}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a){var o=a.size;if(o){var s=[];return Array.isArray(o)&&(s=o.length===2?[o[0],o[0],o[1]]:o),Array.isArray(o)||(s=[o,o,o]),s}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a){var o=Yp(a.coordinates);return Cie([o[0],o[1]])}}})}}]),t}(qi);function OKe(e){var r=FKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function FKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var DKe=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,BKe=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);

  setPickingColor(a_PickingColor);
}
`,NKe=function(e){er(t,e);var r=OKe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.strokeOpacity,u=s===void 0?1:s,l=i.strokeWidth,f=l===void 0?0:l,h=i.stroke,p=h===void 0?"rgba(0,0,0,0)":h,v=i.offsets,m=v===void 0?[0,0]:v,x=i.blend,E=i.blur,A=E===void 0?0:E;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,strokeOpacity:u,strokeWidth:f,stroke:p,offsets:m})){this.judgeStyleAttributes({opacity:o,strokeOpacity:u,strokeWidth:f,stroke:p,offsets:m});var L=this.layer.getEncodedData(),k=this.calDataFrame(this.cellLength,L,this.cellProperties),R=k.data,D=k.width,$=k.height;this.rowCount=$,this.dataTexture=this.cellLength>0&&R.length>0?this.createTexture2D({flipY:!0,data:R,format:K.LUMINANCE,type:K.FLOAT,width:D,height:$}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_blur:A,u_additive:x==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_stroke_opacity:Kt.exports.isNumber(u)?u:1,u_stroke_width:Kt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(p),u_offsets:this.isOffsetStatic(m)?m:[0,0]}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){this.layer.triangulation=uj,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:BKe,fragmentShader:DKe,triangulation:uj,depth:{enable:!0},blend:this.getBlend()}).then(function(a){i([a])}).catch(function(a){console.warn(a),i([])})}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(o,s,u,l){var f=tn(u,3),h=f[0],p=f[1],v=f[2],m=Io(0,0,1),x=Io(h,0,v),E=h>=0?$F(m,x):Math.PI*2-$F(m,x),A=Math.PI*2-Math.asin(p/100),L=ts();g1(L,L,E),m_(L,L,A);var k=Io(1,1,0);Ix(k,k,L),F0(k,k);var R=Io(-1,1,0);Ix(R,R,L),F0(R,R);var D=Io(-1,-1,0);Ix(D,D,L),F0(D,D);var $=Io(1,-1,0);Ix($,$,L),F0($,$);var j=[].concat(Pr(k),Pr(R),Pr(D),Pr($)),H=l%4*3;return[j[H],j[H+1],j[H+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?5:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ar.Attribute,descriptor:{name:"a_Shape",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.shape,u=s===void 0?2:s,l=i.layer.getLayerConfig().shape2d,f=l.indexOf(u);return[f]}}})}}]),t}(qi);function zKe(e){var r=$Ke();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function $Ke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var UKe=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,VKe=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }

  setPickingColor(a_PickingColor);
}
`,Jie=function(e){er(t,e);var r=zKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"raiseCount",0),X(He(n),"raiseRepeat",0),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,s=i.opacity,u=s===void 0?1:s,l=i.sourceColor,f=i.targetColor,h=i.pickLight,p=h===void 0?!1:h,v=i.heightfixed,m=v===void 0?!1:v,x=i.opacityLinear,E=x===void 0?{enable:!1,dir:"up"}:x,A=i.lightEnable,L=A===void 0?!0:A;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:u})){this.judgeStyleAttributes({opacity:u});var k=this.layer.getEncodedData(),R=this.calDataFrame(this.cellLength,k,this.cellProperties),D=R.data,$=R.width,j=R.height;this.rowCount=j,this.dataTexture=this.cellLength>0&&D.length>0?this.createTexture2D({flipY:!0,data:D,format:K.LUMINANCE,type:K.FLOAT,width:$,height:j}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}var H=0,ee=[0,0,0,0],U=[0,0,0,0];if(l&&f&&(ee=Sa(l),U=Sa(f),H=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){var W=o.speed,Q=W===void 0?.01:W;this.raiseCount+=Q,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(p),u_heightfixed:Number(m),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(u)?u:1,u_linearColor:H,u_sourceColor:ee,u_targetColor:U,u_opacitylinear:Number(E.enable),u_opacitylinear_dir:E.dir==="up"?1:0,u_lightEnable:Number(L)}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h;return Xr.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:s=this.layer.getLayerConfig(),u=s.depth,l=u===void 0?!0:u,f=s.animateOption.repeat,h=f===void 0?1:f,this.raiseRepeat=h,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:VKe,fragmentShader:UKe,triangulation:h6,blend:this.getBlend(),cull:{enable:!0,face:Z2(this.mapService.version)},depth:{enable:l}}).then(function(m){o([m])}).catch(function(m){console.warn(m),o([])});case 3:case"end":return v.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a){var o=a.size;if(o){var s=[];return Array.isArray(o)&&(s=o.length===2?[o[0],o[0],o[1]]:o),Array.isArray(o)||(s=[o,o,o]),s}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Ar.Attribute,descriptor:{name:"a_Pos",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a){var o=Yp(a.coordinates);return[o[0],o[1],0]}}})}}]),t}(qi);function GKe(e){var r=HKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function HKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nj=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

 gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,jKe=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,RO=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_meter2coord;
uniform float u_meteryScale;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size) * u_meter2coord;
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    if(newSize * pow(2.0, u_Zoom) < 48.0) {
      antialiasblur = max(antialiasblur, -0.05);
    } else if(newSize * pow(2.0, u_Zoom) < 128.0) {
      antialiasblur = max(antialiasblur, -0.6/pow(u_Zoom, 2.0));
    } else {
      antialiasblur = max(antialiasblur, -0.8/pow(u_Zoom, 2.0));
    }
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.x += offset.x / u_meteryScale;
      aPosition.y += offset.y;
      offset = vec2(0.0);
    }
  }

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_raisingHeight;

  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }
 

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,eae=function(e){er(t,e);var r=GKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"meter2coord",1),X(He(n),"meterYScale",1),X(He(n),"isMeter",!1),X(He(n),"unit","l7size"),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.strokeOpacity,u=s===void 0?1:s,l=i.strokeWidth,f=l===void 0?0:l,h=i.stroke,p=h===void 0?"rgba(0,0,0,0)":h,v=i.offsets,m=v===void 0?[0,0]:v,x=i.blend,E=i.blur,A=E===void 0?0:E,L=i.raisingHeight,k=L===void 0?0:L,R=i.heightfixed,D=R===void 0?!1:R,$=i.unit,j=$===void 0?"l7size":$;if(this.updateUnit(j),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,strokeOpacity:u,strokeWidth:f,stroke:p,offsets:m})){this.judgeStyleAttributes({opacity:o,strokeOpacity:u,strokeWidth:f,stroke:p,offsets:m});var H=this.layer.getEncodedData(),ee=this.calDataFrame(this.cellLength,H,this.cellProperties),U=ee.data,W=ee.width,Q=ee.height;this.rowCount=Q,this.dataTexture=this.cellLength>0&&U.length>0?this.createTexture2D({flipY:!0,data:U,format:K.LUMINANCE,type:K.FLOAT,width:W,height:Q}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(k),u_heightfixed:Number(D),u_meter2coord:this.meter2coord,u_meteryScale:this.meterYScale,u_isMeter:Number(this.isMeter),u_blur:A,u_additive:x==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_stroke_opacity:Kt.exports.isNumber(u)?u:1,u_stroke_width:Kt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(p),u_offsets:this.isOffsetStatic(m)?m:[0,0]}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),WC)}},{key:"initModels",value:function(i){this.updateUnit("l7size"),this.buildModels(i)}},{key:"calMeter2Coord",value:function(){var i=tn(this.layer.getSource().extent,4),a=i[0],o=i[1],s=i[2],u=i[3],l=[(a+s)/2,(o+u)/2],f=this.mapService.version,h=Hn==null?void 0:Hn.mapboxgl;if(f===ko.MAPBOX&&h!==null&&h!==void 0&&h.MercatorCoordinate){var p=h.MercatorCoordinate.fromLngLat({lng:l[0],lat:l[1]},0),v=p.meterInMercatorCoordinateUnits(),m=new h.MercatorCoordinate(p.x-v,p.y,p.z),x=m.toLngLat(),E=new h.MercatorCoordinate(p.x,p.y-v,p.z),A=E.toLngLat();this.meter2coord=l[0]-x.lng,this.meterYScale=(A.lat-l[1])/this.meter2coord;return}var L=this.mapService.meterToCoord(l,[a,o]),k=this.mapService.meterToCoord(l,[s===a?s+.1:s,u===o?o+.1:u]);this.meter2coord=(L+k)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v,m,x,E,A,L,k,R,D;return Xr.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:s=this.layer.getLayerConfig(),u=s.mask,l=u===void 0?!1:u,f=s.maskInside,h=f===void 0?!0:f,p=s.animateOption,v=p===void 0?{enable:!1}:p,m=s.workerEnabled,x=m===void 0?!1:m,E=s.enablePicking,A=s.shape2d,L=this.getShaders(v),k=L.frag,R=L.vert,D=L.type,this.layer.triangulation=WC,this.layer.buildLayerModel({moduleName:D,vertexShader:R,fragmentShader:k,triangulation:WC,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(l,h),workerEnabled:x,workerOptions:{modelType:D,enablePicking:E,shape2d:A}}).then(function(H){o([H])}).catch(function(H){console.warn(H),o([])});case 4:case"end":return j.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getShaders",value:function(i){if(i.enable)switch(i.type){case"wave":return{frag:Nj,vert:RO,type:"pointWave"};default:return{frag:Nj,vert:RO,type:"pointWave"}}else return{frag:jKe,vert:RO,type:"pointFill"}}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(o,s,u,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?5:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Ar.Attribute,descriptor:{name:"a_Shape",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.shape,u=s===void 0?2:s,l=i.indexOf(u);return[l]}}})}},{key:"updateUnit",value:function(i){var a=this.mapService.version;this.unit!==i&&(this.unit!=="meter"&&i==="meter"&&a!==ko.L7MAP&&a!==ko.GLOBEL?(this.isMeter=!0,this.calMeter2Coord()):this.unit==="meter"&&i!=="meter"&&(this.isMeter=!1,this.meter2coord=1),this.unit=i)}}]),t}(qi);function WKe(e){var r=XKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function XKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var YKe=`uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  float opacity = styleMappingMat[0][0];

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ZKe=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform float u_isMeter;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
uniform float u_opacity : 1;
uniform vec2 u_offsets;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;

  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,qKe=function(e){er(t,e);var r=WKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"meter2coord",1),X(He(n),"isMeter",!1),X(He(n),"radian",0),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layerService.throttleRenderLayers();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.LINEAR,min:K.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.offsets,u=s===void 0?[0,0]:s,l=i.rotation,f=i.raisingHeight,h=f===void 0?0:f,p=i.heightfixed,v=p===void 0?!1:p;this.rendererService.getDirty()&&this.texture.bind();var m=1;if((this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(m=-1),this.radian=l!==void 0?m*Math.PI*l/180:m*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,offsets:u})){this.judgeStyleAttributes({opacity:o,offsets:u});var x=this.layer.getEncodedData(),E=this.calDataFrame(this.cellLength,x,this.cellProperties),A=E.data,L=E.width,k=E.height;this.rowCount=k,this.dataTexture=this.cellLength>0&&A.length>0?this.createTexture2D({flipY:!0,data:A,format:K.LUMINANCE,type:K.FLOAT,width:L,height:k}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(h),u_heightfixed:Number(v),u_isMeter:Number(this.isMeter),u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:Kt.exports.isNumber(o)?o:1,u_offsets:this.isOffsetStatic(u)?u:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Yx)}},{key:"initModels",value:function(i){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture);var a=this.layer.getLayerConfig(),o=a.unit,s=o===void 0?"l7size":o,u=this.mapService.version;s==="meter"&&u!==ko.L7MAP&&u!==ko.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),this.buildModels(i)}},{key:"calMeter2Coord",value:function(){var i=tn(this.layer.getSource().extent,4),a=i[0],o=i[1],s=i[2],u=i[3],l=[(a+s)/2,(o+u)/2],f=this.mapService.version;if(f===ko.MAPBOX&&window.mapboxgl.MercatorCoordinate){var h=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:l[0],lat:l[1]},0),p=1,v=p*h.meterInMercatorCoordinateUnits(),m=new window.mapboxgl.MercatorCoordinate(h.x-v,h.y,h.z),x=m.toLngLat();this.meter2coord=l[0]-x.lng;return}var E=this.mapService.meterToCoord(l,[a,o]),A=this.mapService.meterToCoord(l,[s===a?s+.1:s,u===o?o+.1:u]);this.meter2coord=(E+A)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:ZKe,fragmentShader:YKe,triangulation:Yx,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(s,l),cull:{enable:!0,face:Z2(this.mapService.version)}}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"clearModels",value:function(){var i,a;this.iconService.off("imageUpdate",this.updateTexture),(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Ar.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.rotate,u=s===void 0?0:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.shape,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(o,s,u,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?5:s;return Array.isArray(u)?[u[0]*i.meter2coord]:[u*i.meter2coord]}}})}}]),t}(qi);function KKe(e){var r=QKe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function QKe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var JKe=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,eQe=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;

uniform float u_opacity : 1;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(textrueOffsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,tae=function(e){er(t,e);var r=KKe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"updateTexture",function(){var s=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layerService.throttleRenderLayers();return}n.texture=s({data:n.iconService.getCanvas(),mag:K.LINEAR,min:K.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.offsets,u=s===void 0?[0,0]:s,l=i.raisingHeight,f=l===void 0?0:l,h=i.heightfixed,p=h===void 0?!1:h;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,offsets:u})){this.judgeStyleAttributes({opacity:o,offsets:u});var v=this.layer.getEncodedData(),m=this.calDataFrame(this.cellLength,v,this.cellProperties),x=m.data,E=m.width,A=m.height;this.rowCount=A,this.dataTexture=this.cellLength>0&&x.length>0?this.createTexture2D({flipY:!0,data:x,format:K.LUMINANCE,type:K.FLOAT,width:E,height:A}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(f),u_heightfixed:Number(p),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:Kt.exports.isNumber(o)?o:1,u_offsets:this.isOffsetStatic(u)?u:[0,0]}}},{key:"initModels",value:function(i){this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:eQe,fragmentShader:JKe,triangulation:rWe,depth:{enable:!1},primitive:K.POINTS,blend:this.getBlend(),stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?5:s;return Array.isArray(u)?[u[0]]:[u]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(o){var s=i.iconService.getIconMap(),u=o.shape,l=s[u]||{x:0,y:0},f=l.x,h=l.y;return[f,h]}}})}}]),t}(qi);function tQe(e){var r=rQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function rQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nQe=`uniform float u_opacity : 1;
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
}
`,iQe=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`;function zj(e){var r=e.coordinates;return{vertices:Pr(r),indices:[0],size:r.length}}var rae=function(e){er(t,e);var r=tQe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a;return{u_opacity:Kt.exports.isNumber(o)?o:1}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.triangulation=zj,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:iQe,fragmentShader:nQe,triangulation:zj,depth:{enable:!1},primitive:K.POINTS,blend:this.getBlend(),stencil:Ya(s,l),pick:!1}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0]]:[s]}}})}}]),t}(qi);function aQe(e){var r=oQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function oQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var sQe=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,uQe=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,lQe=function(e){er(t,e);var r=aQe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"meter2coord",1),X(He(n),"isMeter",!1),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.blend,u=i.speed,l=u===void 0?1:u;return{u_isMeter:Number(this.isMeter),u_speed:l,u_additive:s==="additive"?1:0,u_opacity:Kt.exports.isNumber(o)?o:1}}},{key:"getAnimateUniforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Yx)}},{key:"initModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.unit,s=o===void 0?"l7size":o,u=this.mapService.version;s==="meter"&&u!==ko.L7MAP&&u!==ko.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),this.buildModels(i)}},{key:"calMeter2Coord",value:function(){var i=tn(this.layer.getSource().extent,4),a=i[0],o=i[1],s=i[2],u=i[3],l=[(a+s)/2,(o+u)/2],f=this.mapService.version;if(f===ko.MAPBOX&&window.mapboxgl.MercatorCoordinate){var h=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:l[0],lat:l[1]},0),p=1,v=p*h.meterInMercatorCoordinateUnits(),m=new window.mapboxgl.MercatorCoordinate(h.x-v,h.y,h.z),x=m.toLngLat();this.meter2coord=l[0]-x.lng;return}var E=this.mapService.meterToCoord(l,[a,o]),A=this.mapService.meterToCoord(l,[s===a?s+.1:s,u===o?o+.1:u]);this.meter2coord=(E+A)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:uQe,fragmentShader:sQe,triangulation:Yx,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var i=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Ar.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(o,s,u,l){var f=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],h=l%4*3;return[f[h],f[h+1],f[h+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(o){var s=o.size,u=s===void 0?5:s;return Array.isArray(u)?[u[0]*i.meter2coord]:[u*i.meter2coord]}}})}}]),t}(qi);function cQe(e){var r=fQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function fQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hQe=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,pQe=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  vec2 offset = project_pixel(textrueOffsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function $j(e){var r=e.coordinates;return{vertices:Pr(r),indices:[0],size:r.length}}var dQe=function(e){er(t,e);var r=cQe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.offsets,u=s===void 0?[0,0]:s,l=i.blend,f=i.strokeOpacity,h=f===void 0?1:f,p=i.strokeWidth,v=p===void 0?0:p,m=i.stroke,x=m===void 0?"#fff":m;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,offsets:u})){this.judgeStyleAttributes({opacity:o,offsets:u});var E=this.layer.getEncodedData(),A=this.calDataFrame(this.cellLength,E,this.cellProperties),L=A.data,k=A.width,R=A.height;this.rowCount=R,this.dataTexture=this.cellLength>0&&L.length>0?this.createTexture2D({flipY:!0,data:L,format:K.LUMINANCE,type:K.FLOAT,width:k,height:R}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_additive:l==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Kt.exports.isNumber(o)?o:1,u_offsets:this.isOffsetStatic(u)?u:[0,0],u_stroke_opacity:Kt.exports.isNumber(h)?h:1,u_stroke_width:Kt.exports.isNumber(v)?v:1,u_stroke_color:this.getStrokeColor(x)}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.triangulation=$j,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:pQe,fragmentShader:hQe,triangulation:$j,depth:{enable:!1},primitive:K.POINTS,blend:this.getBlend(),stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0]]:[s]}}})}}]),t}(qi);function vQe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=gQe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function gQe(e,r){if(!!e){if(typeof e=="string")return Uj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Uj(e,r)}}function Uj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function mQe(e){var r=yQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function yQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Vj=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Gj=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Hj(e){var r=this,t=e.id,n=[],i=[];if(!r.glyphInfoMap||!r.glyphInfoMap[t])return{vertices:[],indices:[],size:7};var a=r.glyphInfoMap[t].centroid,o=a.length===2?[a[0],a[1],0]:a;return r.glyphInfoMap[t].glyphQuads.forEach(function(s,u){n.push.apply(n,Pr(o).concat([s.tex.x,s.tex.y+s.tex.height,s.tl.x,s.tl.y],Pr(o),[s.tex.x+s.tex.width,s.tex.y+s.tex.height,s.tr.x,s.tr.y],Pr(o),[s.tex.x+s.tex.width,s.tex.y,s.br.x,s.br.y],Pr(o),[s.tex.x,s.tex.y,s.bl.x,s.bl.y])),i.push(0+u*4,1+u*4,2+u*4,2+u*4,3+u*4,0+u*4)}),{vertices:n,indices:i,size:7}}var nae=function(e){er(t,e);var r=mQe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"glyphInfoMap",{}),X(He(n),"currentZoom",-1),X(He(n),"textureHeight",0),X(He(n),"textCount",0),X(He(n),"preTextStyle",{}),X(He(n),"buildModels",function(){var s=Hi(Xr.mark(function u(l){var f,h,p,v,m;return Xr.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:f=n.layer.getLayerConfig(),h=f.mask,p=h===void 0?!1:h,v=f.maskInside,m=v===void 0?!0:v,n.mapping(),n.layer.buildLayerModel({moduleName:"pointText",vertexShader:Gj,fragmentShader:Vj,triangulation:Hj.bind(He(n)),depth:{enable:!1},blend:n.getBlend(),stencil:Ya(p,m)}).then(function(A){l([A])}).catch(function(A){console.warn(A),l([])});case 3:case"end":return E.stop()}},u)}));return function(u){return s.apply(this,arguments)}}()),X(He(n),"mapping",function(){n.initGlyph(),n.updateTexture(),n.filterGlyphs(),n.reBuildModel()}),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.stroke,u=s===void 0?"#fff":s,l=i.strokeWidth,f=l===void 0?0:l,h=i.textAnchor,p=h===void 0?"center":h,v=i.textAllowOverlap,m=v===void 0?!1:v,x=i.halo,E=x===void 0?.5:x,A=i.gamma,L=A===void 0?2:A,k=i.raisingHeight,R=k===void 0?0:k,D=this.fontService,$=D.canvas,j=D.mapping;if(Object.keys(j).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(j).length),this.preTextStyle={textAnchor:p,textAllowOverlap:m},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o,strokeWidth:f,stroke:u})){this.judgeStyleAttributes({opacity:o,strokeWidth:f,stroke:u});var H=this.layer.getEncodedData(),ee=this.calDataFrame(this.cellLength,H,this.cellProperties),U=ee.data,W=ee.width,Q=ee.height;this.rowCount=Q,this.dataTexture=this.cellLength>0&&U.length>0?this.createTexture2D({flipY:!0,data:U,format:K.LUMINANCE,type:K.FLOAT,width:W,height:Q}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(R),u_opacity:Kt.exports.isNumber(o)?o:1,u_stroke_width:Kt.exports.isNumber(f)?f:1,u_stroke_color:this.getStrokeColor(u),u_sdf_map:this.texture,u_halo_blur:E,u_gamma_scale:L,u_sdf_map_size:[$.width,$.height]}}},{key:"initModels",value:function(i){this.layer.on("remapping",this.mapping),this.extent=this.textExtent();var a=this.layer.getLayerConfig(),o=a.textAnchor,s=o===void 0?"center":o,u=a.textAllowOverlap,l=u===void 0?!0:u;this.preTextStyle={textAnchor:s,textAllowOverlap:l},this.buildModels(i)}},{key:"needUpdate",value:function(){var i=this.layer.getLayerConfig(),a=i.textAllowOverlap,o=a===void 0?!1:a,s=this.mapService.getZoom(),u=this.mapService.getBounds(),l=mk(this.extent,u);return!o&&(Math.abs(this.currentZoom-s)>1||!l)||o!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Ar.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.rotate,s=o===void 0?0:o;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Ar.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[5],s[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?12:o;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Ar.Attribute,descriptor:{name:"a_tex",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}},{key:"textExtent",value:function(){var i=this.mapService.getBounds();return i1(i,.5)}},{key:"initTextFont",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,o=a===void 0?"400":a,s=i.fontFamily,u=s===void 0?"sans-serif":s,l=this.layer.getEncodedData(),f=[];l.forEach(function(h){var p=h.shape,v=p===void 0?"":p;v=v.toString();var m=vQe(v),x;try{for(m.s();!(x=m.n()).done;){var E=x.value;f.indexOf(E)===-1&&f.push(E)}}catch(A){m.e(A)}finally{m.f()}}),this.fontService.setFontOptions({characterSet:f,fontWeight:o,fontFamily:u,iconfont:!1})}},{key:"initIconFontTex",value:function(){var i=this.layer.getLayerConfig(),a=i.fontWeight,o=a===void 0?"400":a,s=i.fontFamily,u=s===void 0?"sans-serif":s,l=this.layer.getEncodedData(),f=[];l.forEach(function(h){var p=h.shape,v=p===void 0?"":p;v="".concat(v),f.indexOf(v)===-1&&f.push(v)}),this.fontService.setFontOptions({characterSet:f,fontWeight:o,fontFamily:u,iconfont:!0})}},{key:"generateGlyphLayout",value:function(i){var a=this,o=this.fontService.mapping,s=this.layer.getLayerConfig(),u=s.spacing,l=u===void 0?2:u,f=s.textAnchor,h=f===void 0?"center":f,p=this.layer.getEncodedData();this.glyphInfo=p.map(function(v){var m=v.shape,x=m===void 0?"":m,E=v.id,A=v.size,L=A===void 0?1:A,k=v.textOffset,R=k===void 0?[0,0]:k,D=zie(x.toString(),o,L,h,"left",l,R,i),$=$ie(D,R,!1);return v.shaping=D,v.glyphQuads=$,v.centroid=Yp(v.coordinates),v.originCentroid=v.version==="GAODE2.x"?Yp(v.originCoordinates):v.originCentroid=v.centroid,a.glyphInfoMap[E]={shaping:D,glyphQuads:$,centroid:Yp(v.coordinates)},v})}},{key:"filterGlyphs",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.padding,s=o===void 0?[4,4]:o,u=a.textAllowOverlap,l=u===void 0?!1:u;if(!l){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var f=this.rendererService.getViewportSize(),h=f.width,p=f.height,v=new Oie(h,p),m=this.glyphInfo.filter(function(x){var E=x.shaping,A=x.id,L=A===void 0?0:A,k=x.version==="GAODE2.x"?x.originCentroid:x.centroid,R=x.size,D=R/24,$=i.mapService.lngLatToContainer(k),j=v.placeCollisionBox({x1:E.left*D-s[0],x2:E.right*D+s[0],y1:E.top*D-s[1],y2:E.bottom*D+s[1],anchorPointX:$.x,anchorPointY:$.y}),H=j.box;return H&&H.length?(v.insertCollisionBox(H,L),!0):!1});m.forEach(function(x){i.glyphInfoMap[x.id]=x})}}},{key:"initGlyph",value:function(){var i=this.layer.getLayerConfig(),a=i.iconfont,o=a===void 0?!1:a;o?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(o)}},{key:"updateTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.fontService.canvas;this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=i({data:a,mag:K.LINEAR,min:K.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.filterGlyphs(),this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Gj,fragmentShader:Vj,triangulation:Hj.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Ya(s,l)}).then(function(f){i.layer.models=[f],i.layerService.throttleRenderLayers()}).catch(function(f){console.warn(f),i.layer.models=[]})}}]),t}(qi),_Qe={fillImage:qKe,fill:eae,radar:lQe,image:tae,normal:rae,simplePoint:dQe,extrude:Jie,text:nae,vectorPoint:J2,tile:bM,tileText:Uie,earthFill:NKe,earthExtrude:RKe},xQe=_Qe;function bQe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=wQe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function wQe(e,r){if(!!e){if(typeof e=="string")return jj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return jj(e,r)}}function jj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function CQe(e){var r=EQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function EQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var SQe=function(e){er(t,e);var r=CQe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","PointLayer"),X(He(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new xQe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var i=this.shapeOption,a=i.field,o=i.values,s=this.getLayerConfig(),u=s.shape2d,l=this.iconService.getIconMap();if(a&&(u==null?void 0:u.indexOf(a))!==-1)return"fill";if(o&&o instanceof Array){var f=bQe(o),h;try{for(f.s();!(h=f.n()).done;){var p=h.value;if(typeof p=="string"&&l.hasOwnProperty(p))return"image"}}catch(v){f.e(v)}finally{f.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},vectorPoint:{},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return a[i]}},{key:"getModelType",value:function(){var i=this.layerSource.getParserType();if(Lk(i))return"vectorPoint";var a=this.getEncodedData(),o=this.getLayerConfig(),s=o.shape2d,u=o.shape3d,l=this.iconService.getIconMap(),f=a.find(function(p){return p.hasOwnProperty("shape")});if(f){var h=f.shape;return h==="dot"?"normal":h==="simple"?"simplePoint":h==="radar"?"radar":this.layerType==="fillImage"?"fillImage":(s==null?void 0:s.indexOf(h))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(u==null?void 0:u.indexOf(h))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":l.hasOwnProperty(h)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),t}($f);function AQe(e){var r=TQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function TQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var MQe=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];  
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  if(isSide < 1.0) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }

  } else {
     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,LQe=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,IQe=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float lightWeight = styleMappingMat[3][1];
  float topU = styleMappingMat[2][2];
  float topV = styleMappingMat[2][3];

  float sidey = styleMappingMat[3][0];
  if(isSide < 1.0) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,kQe=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_Color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[2][2] = a_uvs[0];
  styleMappingMat[2][3] = 1.0 - a_uvs[1];
  styleMappingMat[3][0] = a_uvs[2];


  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,PQe=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  if(isSide < 1.0) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,RQe=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,OQe=function(e){er(t,e);var r=AQe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.heightfixed,u=s===void 0?!1:s,l=i.raisingHeight,f=l===void 0?0:l,h=i.topsurface,p=h===void 0?!0:h,v=i.sidesurface,m=v===void 0?!0:v,x=i.sourceColor,E=i.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:o})){this.judgeStyleAttributes({opacity:o});var A=this.layer.getEncodedData(),L=this.calDataFrame(this.cellLength,A,this.cellProperties),k=L.data,R=L.width,D=L.height;this.rowCount=D,this.dataTexture=this.cellLength>0&&k.length>0?this.createTexture2D({flipY:!0,data:k,format:K.LUMINANCE,type:K.FLOAT,width:R,height:D}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}var $=0,j=[1,1,1,1],H=[1,1,1,1];return x&&E&&(j=Sa(x),H=Sa(E),$=1),{u_topsurface:Number(p),u_sidesurface:Number(m),u_heightfixed:Number(u),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(f),u_opacity:Kt.exports.isNumber(o)?o:1,u_linearColor:$,u_sourceColor:j,u_targetColor:H,u_texture:this.texture}}},{key:"initModels",value:function(i){this.loadTexture(),this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u,f=this.getShaders(),h=f.frag,p=f.vert,v=f.type;this.layer.buildLayerModel({moduleName:v,vertexShader:p,fragmentShader:h,triangulation:Aie,stencil:Ya(s,l)}).then(function(m){i([m])}).catch(function(m){console.warn(m),i([])})}},{key:"getShaders",value:function(){var i=this.layer.getLayerConfig(),a=i.pickLight,o=i.mapTexture;return o?{frag:IQe,vert:kQe,type:"polygonExtrudeTexture"}:a?{frag:PQe,vert:RQe,type:"polygonExtrudePickLight"}:{frag:MQe,vert:LQe,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var i,a;(i=this.dataTexture)===null||i===void 0||i.destroy(),(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=tn(i,4),o=a[0],s=a[1],u=a[2],l=a[3],f=u-o,h=l-s;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Ar.Attribute,descriptor:{name:"a_uvs",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(v,m,x){var E=x[0],A=x[1];return[(E-o)/f,(A-s)/h,x[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(v,m,x,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(v){var m=v.size,x=m===void 0?10:m;return Array.isArray(x)?[x[0]]:[x]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.mapTexture,s=this.rendererService.createTexture2D;if(this.texture=s({height:0,width:0}),o){var u=new Image;u.crossOrigin="",u.src=o,u.onload=function(){i.texture=s({data:u,width:u.width,height:u.height,wrapS:K.CLAMP_TO_EDGE,wrapT:K.CLAMP_TO_EDGE,min:K.LINEAR,mag:K.LINEAR}),i.layerService.reRender()}}}}]),t}(qi);function FQe(e){var r=DQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function DQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var BQe=`uniform float u_opacity: 1.0;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,NQe=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,zQe=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,$Qe=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,UQe=function(e){er(t,e);var r=FQe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.raisingHeight,o=a===void 0?0:a,s=i.opacity,u=s===void 0?1:s,l=i.opacityLinear,f=l===void 0?{enable:!1,dir:"in"}:l;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:u})){this.judgeStyleAttributes({opacity:u});var h=this.layer.getEncodedData(),p=this.calDataFrame(this.cellLength,h,this.cellProperties),v=p.data,m=p.width,x=p.height;this.rowCount=x,this.dataTexture=this.cellLength>0&&v.length>0?this.createTexture2D({flipY:!0,data:v,format:K.LUMINANCE,type:K.FLOAT,width:m,height:x}):this.createTexture2D({flipY:!0,data:[1],format:K.LUMINANCE,type:K.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(o),u_opacity:Kt.exports.isNumber(u)?u:1,u_opacitylinear:Number(f.enable),u_dir:f.dir==="in"?1:0}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.getModelParams(),o=a.frag,s=a.vert,u=a.triangulation,l=a.type,f=this.layer.getLayerConfig(),h=f.mask,p=h===void 0?!1:h,v=f.maskInside,m=v===void 0?!0:v,x=f.workerEnabled,E=x===void 0?!1:x,A=f.enablePicking;this.layer.triangulation=u,this.layer.buildLayerModel({moduleName:l,vertexShader:s,fragmentShader:o,triangulation:u,primitive:K.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Ya(p,m),workerEnabled:E,workerOptions:{modelType:l,enablePicking:A}}).then(function(L){i([L])}).catch(function(L){console.warn(L),i([])})}},{key:"clearModels",value:function(){var i;(i=this.dataTexture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getLayerConfig(),a=i.opacityLinear,o=a===void 0?{enable:!1,dir:"in"}:a;o.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Ar.Attribute,descriptor:{name:"a_linear",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(u,l,f){return[f[3],f[4],f[5]]}}})}},{key:"getModelParams",value:function(){var i=this.layer.getLayerConfig(),a=i.opacityLinear,o=a===void 0?{enable:!1}:a;return o.enable?{frag:NQe,vert:zQe,type:"polygonLinear",triangulation:sWe}:{frag:BQe,vert:$Qe,type:"polygonFill",triangulation:HB}}}]),t}(qi);function VQe(e){var r=GQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function GQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var HQe=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,jQe=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,WQe=function(e){er(t,e);var r=VQe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.watercolor,u=s===void 0?"#6D99A8":s,l=i.watercolor2,f=l===void 0?"#0F121C":l;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:Sa(u),u_watercolor2:Sa(f),u_opacity:Kt.exports.isNumber(o)?o:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.loadTexture(),this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:jQe,fragmentShader:HQe,triangulation:XE,primitive:K.TRIANGLES,depth:{enable:!1},stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"clearModels",value:function(){var i,a,o;(i=this.texture1)===null||i===void 0||i.destroy(),(a=this.texture2)===null||a===void 0||a.destroy(),(o=this.texture3)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=tn(i,4),o=a[0],s=a[1],u=a[2],l=a[3],f=u-o,h=l-s;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Ar.Attribute,descriptor:{name:"a_uv",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(v,m,x,E){var A=v.version===ko["GAODE2.x"]?v.originCoordinates[0][E]:x,L=tn(A,2),k=L[0],R=L[1];return[(k-o)/f,(R-s)/h]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.rendererService.createTexture2D,o={height:0,width:0};this.texture1=a(o),this.texture2=a(o),this.texture3=a(o),s(function(l){i.texture1=u(l[0]),i.texture2=u(l[1]),i.texture3=u(l[2]),i.layerService.reRender()});function s(l){var f=0,h=[],p=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];p.map(function(v){var m=new Image;m.crossOrigin="",m.src=v,h.push(m),m.onload=function(){f++,f===3&&l(h)}})}function u(l){return a({data:l,width:l.width,height:l.height,wrapS:K.MIRRORED_REPEAT,wrapT:K.MIRRORED_REPEAT,min:K.LINEAR,mag:K.LINEAR})}}}]),t}(qi);function XQe(e){var r=YQe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function YQe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ZQe=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,qQe=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,KQe=function(e){er(t,e);var r=XQe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.speed,u=s===void 0?.5:s;return{u_texture:this.texture,u_speed:u,u_opacity:Kt.exports.isNumber(o)?o:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(i){this.loadTexture(),this.buildModels(i)}},{key:"buildModels",value:function(i){var a=this.layer.getLayerConfig(),o=a.mask,s=o===void 0?!1:o,u=a.maskInside,l=u===void 0?!0:u;this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:qQe,fragmentShader:ZQe,triangulation:XE,primitive:K.TRIANGLES,depth:{enable:!1},stencil:Ya(s,l)}).then(function(f){i([f])}).catch(function(f){console.warn(f),i([])})}},{key:"clearModels",value:function(){var i;(i=this.texture)===null||i===void 0||i.destroy()}},{key:"registerBuiltinAttributes",value:function(){var i=this.layer.getSource().extent,a=tn(i,4),o=a[0],s=a[1],u=a[2],l=a[3],f=u-o,h=l-s;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Ar.Attribute,descriptor:{name:"a_uv",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(v,m,x,E){var A=v.version===ko["GAODE2.x"]?v.originCoordinates[0][E]:x,L=tn(A,2),k=L[0],R=L[1];return[(k-o)/f,(R-s)/h]}}})}},{key:"loadTexture",value:function(){var i=this,a=this.layer.getLayerConfig(),o=a.waterTexture,s=this.rendererService.createTexture2D;this.texture=s({height:0,width:0});var u=new Image;u.crossOrigin="",o?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),u.src=o):u.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",u.onload=function(){i.texture=s({data:u,width:u.width,height:u.height,wrapS:K.MIRRORED_REPEAT,wrapT:K.MIRRORED_REPEAT,min:K.LINEAR,mag:K.LINEAR}),i.layerService.reRender()}}}]),t}(qi),QQe={fill:UQe,line:Qie,extrude:OQe,text:nae,point_fill:eae,point_image:tae,point_normal:rae,point_extrude:Jie,water:KQe,ocean:WQe,vectorpolygon:J2,tile:Vie},JQe=QQe;function eJe(e){var r=tJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function tJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rJe=function(e){er(t,e);var r=eJe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","PolygonLayer"),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new JQe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getModelType",value:function(){var i,a=this.layerSource.getParserType();if(Lk(a))return"vectorpolygon";var o=this.styleAttributeService.getLayerStyleAttribute("shape"),s=o==null||(i=o.scale)===null||i===void 0?void 0:i.field;return s==="fill"?"fill":s==="extrude"?"extrude":s==="water"?"water":s==="ocean"?"ocean":s==="line"?"line":s==="tile"?"tile":this.getPointModelType()}},{key:"getPointModelType",value:function(){var i=this.getEncodedData(),a=this.getLayerConfig(),o=a.shape2d,s=a.shape3d,u=this.iconService.getIconMap(),l=i.find(function(h){return h.hasOwnProperty("shape")});if(l){var f=l.shape;return f==="dot"?"point_normal":(o==null?void 0:o.indexOf(f))!==-1?"point_fill":(s==null?void 0:s.indexOf(f))!==-1?"point_extrude":u.hasOwnProperty(f)?"point_image":"text"}else return"fill"}}]),t}($f);function nJe(e){var r=iJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function iJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var aJe=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;



// float getBlurIndusty() {
//   vec2 u_ViewportSize = vec2(1024);

//     float vW = 2.0/u_ViewportSize.x;
//     float vH = 2.0/u_ViewportSize.y;
//     vec2 vUv = v_texCoord;
//     float i11 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y + 1.0 * vH) ).r;
//     float i12 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y + 1.0 * vH) ).r;
//     float i13 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y + 1.0 * vH) ).r;

//     float i21 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y) ).r;
//     float i22 = texture2D( u_texture, vec2( vUv.x , vUv.y) ).r;
//     float i23 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y) ).r;

//     float i31 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y-1.0*vH) ).r;
//     float i32 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y-1.0*vH) ).r;
//     float i33 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y-1.0*vH) ).r;

//     return(
//         i11 + 
//         i12 + 
//         i13 + 
//         i21 + 
//         i21 + 
//         i22 + 
//         i23 + 
//         i31 + 
//         i32 + 
//         i33
//         )/9.0;
// }

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;

  // float value = getBlurIndusty();


  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,oJe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Wj=function(e){er(t,e);var r=nJe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a,s=i.clampLow,u=s===void 0?!0:s,l=i.clampHigh,f=l===void 0?!0:l,h=i.noDataValue,p=h===void 0?-9999999:h,v=i.domain,m=v===void 0?[0,1]:v,x=i.rampColors;return Kt.exports.isEqual(this.rampColors,x)||(this.updateColorTexture(),this.rampColors=x),{u_opacity:o||1,u_texture:this.texture,u_domain:m,u_clampLow:u,u_clampHigh:typeof f!="undefined"?f:u,u_noDataValue:p,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f;return Xr.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!Array.isArray(o.data)){p.next=4;break}return p.abrupt("return",{data:o.data,width:o.width,height:o.height});case 4:return p.next=6,o.data;case 6:return s=p.sent,u=s.rasterData,l=s.width,f=s.height,p.abrupt("return",{data:Array.from(u),width:l,height:f});case 11:case"end":return p.stop()}},a)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"initModels",value:function(){var n=Hi(Xr.mark(function a(o){var s,u,l,f,h,p,v,m,x,E,A,L,k,R,D;return Xr.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s=this.layer.getLayerConfig(),u=s.mask,l=u===void 0?!1:u,f=s.maskInside,h=f===void 0?!0:f,p=s.rampColorsData,v=s.rampColors,m=this.layer.getSource(),x=this.rendererService.createTexture2D,E=m.data.dataArray[0],j.next=6,this.getRasterData(E);case 6:A=j.sent,L=A.data,k=A.width,R=A.height,this.texture=x({data:L,width:k,height:R,format:K.LUMINANCE,type:K.FLOAT}),D=p||Ay(v),this.colorTexture=x({data:D.data,width:D.width,height:D.height,flipY:!1}),this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:oJe,fragmentShader:aJe,triangulation:A1,primitive:K.TRIANGLES,depth:{enable:!1},stencil:Ya(l,h)}).then(function(H){o([H])}).catch(function(H){console.warn(H),o([])});case 14:case"end":return j.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}},{key:"updateColorTexture",value:function(){var i=this.rendererService.createTexture2D,a=this.layer.getLayerConfig(),o=a.rampColors,s=Ay(o);this.colorTexture=i({data:s.data,width:s.width,height:s.height,flipY:!1})}}]),t}(qi),sJe={raster:Wj,rasterRgb:Zie,raster3d:Wj,rasterTile:J2},uJe=sJe;function lJe(e){var r=cJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function cJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fJe=function(e){er(t,e);var r=lJe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","RasterLayer"),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new uJe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={raster:{},rasterRgb:{},raster3d:{},rasterTile:{}};return a[i]}},{key:"getModelType",value:function(){var i=this.layerSource.getParserType();switch(i){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rasterTile":return"rasterTile";default:return"raster"}}}]),t}($f);function hJe(e){var r=pJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function pJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dJe=`
uniform float u_opacity;
uniform vec3 u_CameraPosition;

varying vec3 vVertexNormal;
varying float v_offset;
varying vec4 v_Color;
void main() {
    
    
    // float intensity = pow(0.5 + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);
    float intensity = pow(v_offset + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);
    // \u53BB\u9664\u80CC\u9762
    if(intensity > 1.0) intensity = 0.0;

    gl_FragColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);
}
`,vJe=`
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
attribute vec4 a_Color;
uniform vec3 u_CameraPosition;
varying float v_CamreaDistance;

uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_ViewMatrix;

varying vec3 vVertexNormal;
varying vec4 v_Color;
varying float v_offset;

void main() {
    float EARTH_RADIUS = 100.0;
    
    v_Color = a_Color;

    v_offset = min(((length(u_CameraPosition) - EARTH_RADIUS)/600.0) * 0.5 + 0.4, 1.0);
    vVertexNormal = a_Normal;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,gJe=function(e){er(t,e);var r=hJe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a;return{u_opacity:Kt.exports.isNumber(o)?o:1}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(i){this.layer.zIndex=-997,this.layer.buildLayerModel({moduleName:"earthAtmoSphere",vertexShader:vJe,fragmentShader:dJe,triangulation:Mie,depth:{enable:!1},blend:this.getBlend()}).then(function(a){i([a])}).catch(function(a){console.warn(a),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function mJe(e){var r=yJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function yJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _Je=`
uniform sampler2D u_texture;

varying vec2 v_texCoord;
varying float v_lightWeight;


void main() {

    vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
    color.xyz = color.xyz * v_lightWeight;
    gl_FragColor = color;
}
`,xJe=`// attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
varying vec2 v_texCoord;

// attribute vec2 a_Extrude;
// attribute float a_Size;
// attribute float a_Shape;

uniform vec3 u_CameraPosition;
uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform float u_ambientRatio : 0.5;
uniform float u_diffuseRatio : 0.3;
uniform float u_specularRatio : 0.2;
uniform vec3 u_sunLight: [1.0, -10.5, 12.0];



float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;

    // cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(u_sunLight);

    vec3 halfDir = normalize(viewDir+lightDir);
    // lambert
    float lambert = dot(worldNormal, lightDir);
    // specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
    //sum to light weight
    float lightWeight = u_ambientRatio + u_diffuseRatio * lambert + u_specularRatio * specular;

    return lightWeight;
}

varying float v_lightWeight;
void main() {

    v_texCoord = a_Uv;

    float lightWeight = calc_lighting(vec4(a_Position, 1.0));
    v_lightWeight = lightWeight;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,bJe=function(e){er(t,e);var r=mJe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"earthTime",3.4),X(He(n),"sunX",1e3),X(He(n),"sunY",1e3),X(He(n),"sunZ",1e3),X(He(n),"sunRadius",Math.sqrt(n.sunX*n.sunX+n.sunY*n.sunY+n.sunZ*n.sunZ)),n}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.animateOption,o=i.globalOptions;return a!=null&&a.enable&&(this.mapService.rotateY({reg:.002}),this.earthTime+=.02,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY)),{u_ambientRatio:(o==null?void 0:o.ambientRatio)||.6,u_diffuseRatio:(o==null?void 0:o.diffuseRatio)||.4,u_specularRatio:(o==null?void 0:o.specularRatio)||.1,u_sunLight:[this.sunX,this.sunY,this.sunZ],u_texture:this.texture}}},{key:"setEarthTime",value:function(i){this.earthTime=i,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY),this.layerService.throttleRenderLayers()}},{key:"initModels",value:function(i){var a=this,o=this.layer.getLayerConfig(),s=o.globalOptions;(s==null?void 0:s.earthTime)!==void 0&&this.setEarthTime(s.earthTime);var u=this.layer.getSource(),l=this.rendererService.createTexture2D;this.texture=l({height:0,width:0}),u.data.images.then(function(f){a.texture=l({data:f[0],width:f[0].width,height:f[0].height}),a.layerService.reRender()}),this.buildModels(i)}},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(i){this.layer.zIndex=-998,this.layer.buildLayerModel({moduleName:"earthBase",vertexShader:xJe,fragmentShader:_Je,triangulation:Mie,depth:{enable:!0},blend:this.getBlend()}).then(function(a){i([a])}).catch(function(a){console.warn(a),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function wJe(e){var r=CJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function CJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var EJe=`
uniform float u_opacity;
uniform vec3 u_CameraPosition;
varying vec3 vVertexNormal;

varying vec4 v_Color;
void main() {


    float intensity =  - dot(normalize(vVertexNormal), normalize(u_CameraPosition));
    // \u53BB\u9664\u80CC\u9762
    if(intensity > 1.0) intensity = 0.0;

    gl_FragColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);
}
`,SJe=`
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
attribute vec4 a_Color;
uniform vec3 u_CameraPosition;
uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_ViewMatrix;

varying vec3 vVertexNormal;
varying vec4 v_Color;

void main() {
    v_Color = a_Color;

    vVertexNormal = a_Normal;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,AJe=function(e){er(t,e);var r=wJe(t);function t(){return st(this,t),r.apply(this,arguments)}return ot(t,[{key:"getUninforms",value:function(){var i=this.layer.getLayerConfig(),a=i.opacity,o=a===void 0?1:a;return{u_opacity:Kt.exports.isNumber(o)?o:1}}},{key:"initModels",value:function(i){this.buildModels(i)}},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(i){this.layer.zIndex=-999,this.layer.buildLayerModel({moduleName:"earthBloom",vertexShader:SJe,fragmentShader:EJe,triangulation:fWe,depth:{enable:!1},blend:this.getBlend()}).then(function(a){i([a])}).catch(function(a){console.warn(a),i([])})}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Ar.Attribute,descriptor:{name:"a_Size",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(a){var o=a.size,s=o===void 0?1:o;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Ar.Attribute,descriptor:{name:"a_Normal",buffer:{usage:K.STATIC_DRAW,data:[],type:K.FLOAT},size:3,update:function(a,o,s,u,l){return l}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}}]),t}(qi);function TJe(e){var r=MJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function MJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var LJe={base:bJe,atomSphere:gJe,bloomSphere:AJe},IJe=["base","atomSphere","bloomSphere"],kJe=function(e){er(t,e);var r=TJe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","EarthLayer"),X(He(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new LJe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"setEarthTime",value:function(i){this.layerModel&&this.layerModel.setEarthTime?this.layerModel.setEarthTime(i):console.warn("\u8BF7\u5728 scene loaded \u4E4B\u540E\u6267\u884C\u8BE5\u65B9\u6CD5\uFF01")}},{key:"getModelType",value:function(){var i,a=this.styleAttributeService.getLayerStyleAttribute("shape"),o=(a==null||(i=a.scale)===null||i===void 0?void 0:i.field)||"base";return IJe.indexOf(o)<0&&(o="base"),o}}]),t}($f),PJe={fill:Gie,vectorMask:J2},RJe=PJe;function OJe(e,r){var t=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=FJe(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function FJe(e,r){if(!!e){if(typeof e=="string")return Xj(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Xj(e,r)}}function Xj(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function DJe(e){var r=BJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function BJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var iae=function(e){er(t,e);var r=DJe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","MaskLayer"),n}return ot(t,[{key:"init",value:function(){var i=this,a=this.container.get(Mt.SceneID);this.configService.setLayerConfig(a,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.rendererService=this.container.get(Mt.IRendererService),this.layerService=this.container.get(Mt.ILayerService),this.mapService=this.container.get(Mt.IMapService),this.cameraService=this.container.get(Mt.ICameraService),this.coordinateService=this.container.get(Mt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Mt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Mt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Mt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Mt.IStyleAttributeService),this.pendingStyleAttributes.forEach(function(l){var f=l.attributeName,h=l.attributeField,p=l.attributeValues,v=l.updateOptions;i.styleAttributeService.updateStyleAttribute(f,{scale:Et({field:h},i.splitValuesAndCallbackInAttribute(p,i.getLayerConfig()[f]))},v)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Mt.ILayerPlugin);var o=OJe(this.plugins),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;u.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(l){o.e(l)}finally{o.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this}},{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new RJe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"getModelType",value:function(){var i=this.layerSource.getParserType();return Lk(i)?"vectorMask":"fill"}}]),t}($f);function OO(e,r,t){var n=Yj(e,e.VERTEX_SHADER,r),i=Yj(e,e.FRAGMENT_SHADER,t);if(!n||!i)return null;var a=e.createProgram();if(!a)return null;e.attachShader(a,n),e.attachShader(a,i),e.linkProgram(a);var o=e.getProgramParameter(a,e.LINK_STATUS);if(!o){var s=e.getProgramInfoLog(a);return console.warn("Failed to link program: "+s),e.deleteProgram(a),e.deleteShader(i),e.deleteShader(n),null}for(var u=e.getProgramParameter(a,e.ACTIVE_ATTRIBUTES),l=0;l<u;l++){var f=e.getActiveAttrib(a,l);a[f.name]=e.getAttribLocation(a,f.name)}for(var h=e.getProgramParameter(a,e.ACTIVE_UNIFORMS),p=0;p<h;p++){var v=e.getActiveUniform(a,p);a[v.name]=e.getUniformLocation(a,v.name)}return a.vertexShader=n,a.fragmentShader=i,a}function Yj(e,r,t){var n=e.createShader(r);if(n==null)return console.warn("unable to create shader"),null;e.shaderSource(n,t),e.compileShader(n);var i=e.getShaderParameter(n,e.COMPILE_STATUS);if(!i){var a=e.getShaderInfoLog(n);return console.warn("Failed to compile shader: "+a),e.deleteShader(n),null}return n}function Pg(e,r,t,n,i){var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,i,0,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),a}function NJe(e,r,t){var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),n}function PT(e,r,t){e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,r)}function FO(e,r){var t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),t}var zJe=`
 precision mediump float;

 attribute float a_index;

 uniform sampler2D u_particles;
 uniform float u_particles_res;

 varying vec2 v_particle_pos;

 void main() {
     vec4 color = texture2D(u_particles, vec2(
         fract(a_index / u_particles_res),
         floor(a_index / u_particles_res) / u_particles_res)
     );

     // decode current particle position from the pixel's RGBA value
     v_particle_pos = vec2( color.r / 255.0 + color.b, color.g / 255.0 + color.a);

     gl_PointSize = 1.0;
     gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, 1.0 - 2.0 * v_particle_pos.y, 0, 1);
 }`,$Je=`
 precision mediump float;

 uniform sampler2D u_wind;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform sampler2D u_color_ramp;

 varying vec2 v_particle_pos;

 void main() {
     vec2 velocity = mix(u_wind_min, u_wind_max, texture2D(u_wind, v_particle_pos).rg);
     float speed_t = length(velocity) / length(u_wind_max);

     // color ramp is encoded in a 16x16 texture
     vec2 ramp_pos = vec2( fract(16.0 * speed_t), floor(16.0 * speed_t) / 16.0);

     gl_FragColor = texture2D(u_color_ramp, ramp_pos);
 }`,UJe=`
 precision mediump float;

 attribute vec2 a_pos;

 varying vec2 v_tex_pos;

 void main() {
     v_tex_pos = a_pos;
     gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);
     // framebuffer \u59CB\u7EC8\u7528\u94FA\u6EE1\u5C4F\u5E55\u7684 texture
 }`,VJe=`
 precision highp float;

 uniform sampler2D u_particles;
 uniform sampler2D u_wind;
 uniform vec2 u_wind_res;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform float u_rand_seed;
 uniform float u_speed_factor;
 uniform float u_drop_rate;
 uniform float u_drop_rate_bump;

 varying vec2 v_tex_pos;

 // pseudo-random generator
 const vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);
 float rand(const vec2 co) {
 float t = dot(rand_constants.xy, co);
     return fract(sin(t) * (rand_constants.z + t));
 }

 // wind speed lookup; use manual bilinear filtering based on 4 adjacent pixels for smooth interpolation
 vec2 lookup_wind(const vec2 uv) {
     // return texture2D(u_wind, uv).rg; // lower-res hardware filtering
     vec2 px = 1.0 / u_wind_res;
     vec2 vc = (floor(uv * u_wind_res)) * px;
     vec2 f = fract(uv * u_wind_res);
     vec2 tl = texture2D(u_wind, vc).rg;
     vec2 tr = texture2D(u_wind, vc + vec2(px.x, 0)).rg;
     vec2 bl = texture2D(u_wind, vc + vec2(0, px.y)).rg;
     vec2 br = texture2D(u_wind, vc + px).rg;
     return mix(mix(tl, tr, f.x), mix(bl, br, f.x), f.y);
 }

 void main() {
     vec4 color = texture2D(u_particles, v_tex_pos);
     vec2 pos = vec2(
         color.r / 255.0 + color.b,
         color.g / 255.0 + color.a); // decode particle position from pixel RGBA
     vec2 velocity = mix(u_wind_min, u_wind_max, lookup_wind(pos));
     float speed_t = length(velocity) / length(u_wind_max);

     // take EPSG:4236 distortion into account for calculating where the particle moved
     float distortion = cos(radians(pos.y * 180.0 - 90.0));
     vec2 offset = vec2(velocity.x / distortion, -velocity.y) * 0.0001 * u_speed_factor;

     // update particle position, wrapping around the date line
     pos = fract(1.0 + pos + offset);

     // a random seed to use for the particle drop
     vec2 seed = (pos + v_tex_pos) * u_rand_seed;

     // drop rate is a chance a particle will restart at random position, to avoid degeneration
     float drop_rate = u_drop_rate + speed_t * u_drop_rate_bump;
     float drop = step(1.0 - drop_rate, rand(seed));

     vec2 random_pos = vec2(
         rand(seed + 1.3),
         rand(seed + 2.1));
         pos = mix(pos, random_pos, drop);

     // encode the new particle position back into RGBA
     gl_FragColor = vec4(
         fract(pos * 255.0),
         floor(pos * 255.0) / 255.0);
 }`,GJe=`
     precision mediump float;

     attribute vec2 a_pos;

     varying vec2 v_tex_pos;

     void main() {
         v_tex_pos = a_pos;
         gl_Position = vec4(1.0 - 2.0 * a_pos, 0.0, 1.0);
         gl_PointSize = 100.0;
 }`,HJe=`
 precision mediump float;

 uniform sampler2D u_screen;
 uniform float u_opacity;
 varying vec2 v_tex_pos;

 void main() {
     vec4 color = texture2D(u_screen, 1.0 - v_tex_pos);

     // a hack to guarantee opacity fade out even with a value close to 1.0
     gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);
 }`;function Zj(e){var r=document.createElement("canvas"),t=r.getContext("2d");r.width=256,r.height=1;for(var n=t.createLinearGradient(0,0,256,0),i=0,a=Object.keys(e);i<a.length;i++){var o=a[i];n.addColorStop(+o,e[+o])}return t.fillStyle=n,t.fillRect(0,0,256,1),r=null,new Uint8Array(t.getImageData(0,0,256,1).data)}function qj(e,r,t,n){e.bindBuffer(e.ARRAY_BUFFER,r),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n,e.FLOAT,!1,0,0)}function RT(e,r,t){e.bindFramebuffer(e.FRAMEBUFFER,r),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}var jJe=function(){function e(r){st(this,e),X(this,"width",512),X(this,"height",512),X(this,"numParticles",65536),this.gl=r.glContext,this.width=r.imageWidth,this.height=r.imageHeight,this.fadeOpacity=r.fadeOpacity,this.speedFactor=r.speedFactor,this.dropRate=r.dropRate,this.dropRateBump=r.dropRateBump,this.rampColors=r.rampColors,this.init()}return ot(e,[{key:"init",value:function(){var t=this.gl;this.fadeOpacity=.996,this.speedFactor=.25,this.dropRate=.003,this.dropRateBump=.01,this.drawProgram=OO(t,zJe,$Je),this.fullScreenProgram=OO(t,GJe,HJe),this.updateProgram=OO(t,UJe,VJe),this.quadBuffer=FO(t,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),this.framebuffer=t.createFramebuffer(),this.colorRampTexture=Pg(this.gl,this.gl.LINEAR,Zj(this.rampColors),16,16);var n=new Uint8Array(this.width*this.height*4);this.backgroundTexture=Pg(t,t.NEAREST,n,this.width,this.height),this.screenTexture=Pg(t,t.NEAREST,n,this.width,this.height);var i=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=i*i;for(var a=new Uint8Array(this.numParticlesSize*4),o=0;o<a.length;o++)a[o]=Math.floor(Math.random()*256);this.particleStateTexture0=Pg(t,t.NEAREST,a,i,i),this.particleStateTexture1=Pg(t,t.NEAREST,a,i,i);for(var s=new Float32Array(this.numParticlesSize),u=0;u<this.numParticlesSize;u++)s[u]=u;this.particleIndexBuffer=FO(t,s)}},{key:"setWind",value:function(t){this.windData=t,this.windTexture=NJe(this.gl,this.gl.LINEAR,t.image)}},{key:"updateParticelNum",value:function(t){var n=this.gl;if(t!==this.numParticles){this.numParticles=t;var i=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=i*i;for(var a=new Uint8Array(this.numParticlesSize*4),o=0;o<a.length;o++)a[o]=Math.floor(Math.random()*256);this.particleStateTexture0=Pg(n,n.NEAREST,a,i,i),this.particleStateTexture1=Pg(n,n.NEAREST,a,i,i);for(var s=new Float32Array(this.numParticlesSize),u=0;u<this.numParticlesSize;u++)s[u]=u;this.particleIndexBuffer=FO(n,s)}}},{key:"updateWindDir",value:function(t,n,i,a){this.windData.uMin=t,this.windData.uMax=n,this.windData.vMin=i,this.windData.vMax=a}},{key:"updateColorRampTexture",value:function(t){if(this.isColorChanged(t)){this.rampColors=t;var n=this.gl;n.deleteTexture(this.colorRampTexture),this.colorRampTexture=Pg(n,n.LINEAR,Zj(t),16,16)}}},{key:"isColorChanged",value:function(t){for(var n=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i],s=Number(o);if(!this.rampColors[s]||this.rampColors[s]&&this.rampColors[s]!==t[s])return!0}return!1}},{key:"reSize",value:function(t,n){if(t!==this.width||n!==this.height){var i=this.gl;i.deleteTexture(this.backgroundTexture),i.deleteTexture(this.screenTexture),this.width=t,this.height=n;var a=new Uint8Array(t*n*4);this.backgroundTexture=Pg(i,i.NEAREST,a,t,n),this.screenTexture=Pg(i,i.NEAREST,a,t,n)}}},{key:"draw",value:function(){var t;if((t=this.windData)!==null&&t!==void 0&&t.image){var n=this.gl;return PT(n,this.windTexture,0),PT(n,this.particleStateTexture0,1),this.drawScreen(),this.updateParticles(),{d:this.pixels,w:this.width,h:this.height}}else return{d:new Uint8Array([0,0,0,0]),w:1,h:1}}},{key:"drawScreen",value:function(){var t=this.gl;RT(t,this.framebuffer,this.screenTexture),t.viewport(0,0,this.width,this.height),t.disable(t.BLEND),this.drawFullTexture(this.backgroundTexture,this.fadeOpacity),this.drawParticles(),this.pixels=new Uint8Array(4*this.width*this.height),t.readPixels(0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.pixels),RT(t,null,null),t.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);var n=this.backgroundTexture;this.backgroundTexture=this.screenTexture,this.screenTexture=n}},{key:"drawFullTexture",value:function(t,n){var i=this.gl,a=this.fullScreenProgram;i.useProgram(a),i.bindBuffer(i.ARRAY_BUFFER,this.quadBuffer),i.vertexAttribPointer(a.a_pos,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(a.a_pos),i.bindBuffer(i.ARRAY_BUFFER,null),PT(i,t,2),i.uniform1i(a.u_screen,2),i.uniform1f(a.u_opacity,n),i.drawArrays(i.TRIANGLES,0,6)}},{key:"drawParticles",value:function(){var t=this.gl,n=this.drawProgram;t.useProgram(n),qj(t,this.particleIndexBuffer,n.a_index,1),PT(t,this.colorRampTexture,2),t.uniform1i(n.u_wind,0),t.uniform1i(n.u_particles,1),t.uniform1i(n.u_color_ramp,2),t.uniform1f(n.u_particles_res,this.particleStateResolution),t.uniform2f(n.u_wind_min,this.windData.uMin,this.windData.vMin),t.uniform2f(n.u_wind_max,this.windData.uMax,this.windData.vMax),t.drawArrays(t.POINTS,0,this.numParticlesSize)}},{key:"updateParticles",value:function(){var t=this.gl;RT(t,this.framebuffer,this.particleStateTexture1),t.viewport(0,0,this.particleStateResolution,this.particleStateResolution);var n=this.updateProgram;t.useProgram(n),qj(t,this.quadBuffer,n.a_pos,2),t.uniform1i(n.u_wind,0),t.uniform1i(n.u_particles,1),t.uniform1f(n.u_rand_seed,Math.random()),t.uniform2f(n.u_wind_res,this.windData.image.width*2,this.windData.image.height*2),t.uniform2f(n.u_wind_min,this.windData.uMin,this.windData.vMin),t.uniform2f(n.u_wind_max,this.windData.uMax,this.windData.vMax),t.uniform1f(n.u_speed_factor,this.speedFactor),t.uniform1f(n.u_drop_rate,this.dropRate),t.uniform1f(n.u_drop_rate_bump,this.dropRateBump),t.drawArrays(t.TRIANGLES,0,6);var i=this.particleStateTexture0;this.particleStateTexture0=this.particleStateTexture1,this.particleStateTexture1=i,RT(t,null,null)}},{key:"destroy",value:function(){this.gl.deleteBuffer(this.quadBuffer),this.gl.deleteBuffer(this.particleIndexBuffer),this.gl.deleteFramebuffer(this.framebuffer),this.gl.deleteShader(this.drawProgram.vertexShader),this.gl.deleteShader(this.drawProgram.fragmentShader),this.gl.deleteProgram(this.drawProgram),this.gl.deleteShader(this.fullScreenProgram.vertexShader),this.gl.deleteShader(this.fullScreenProgram.fragmentShader),this.gl.deleteProgram(this.fullScreenProgram),this.gl.deleteShader(this.updateProgram.vertexShader),this.gl.deleteShader(this.updateProgram.fragmentShader),this.gl.deleteProgram(this.updateProgram),this.gl.deleteTexture(this.colorRampTexture),this.gl.deleteTexture(this.backgroundTexture),this.gl.deleteTexture(this.screenTexture),this.gl.deleteTexture(this.particleStateTexture0),this.gl.deleteTexture(this.particleStateTexture1),this.gl.deleteTexture(this.windTexture)}}]),e}();function WJe(e){var r=XJe();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function XJe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var YJe=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,ZJe=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Kj={0:"#3288bd",.1:"#66c2a5",.2:"#abdda4",.3:"#e6f598",.4:"#fee08b",.5:"#fdae61",.6:"#f46d43",1:"#d53e4f"},qJe=function(e){er(t,e);var r=WJe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"sizeScale",.5),X(He(n),"frequency",new qre(7.2)),n}return ot(t,[{key:"render",value:function(){var i=this;this.frequency.run(function(){i.drawWind()}),this.drawColorMode()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(i){var a,o,s,u=this,l=this.layer.getLayerConfig(),f=l.uMin,h=f===void 0?-21.32:f,p=l.uMax,v=p===void 0?26.8:p,m=l.vMin,x=m===void 0?-21.57:m,E=l.vMax,A=E===void 0?21.42:E,L=l.fadeOpacity,k=L===void 0?.996:L,R=l.speedFactor,D=R===void 0?.25:R,$=l.dropRate,j=$===void 0?.003:$,H=l.dropRateBump,ee=H===void 0?.01:H,U=l.rampColors,W=U===void 0?Kj:U,Q=l.sizeScale,te=Q===void 0?.5:Q,ie=l.mask,ve=ie===void 0?!1:ie,me=l.maskInside,Re=me===void 0?!0:me,We=this.rendererService.createTexture2D,je=this.layer.getSource();this.texture=We({height:0,width:0}),this.cacheZoom=Math.floor(this.mapService.getZoom());var lt=this.rendererService.getGLContext();this.imageCoords=(a=je.data)===null||a===void 0?void 0:a.dataArray[0].coordinates,(o=je.data)===null||o===void 0||(s=o.images)===null||s===void 0||s.then(function(dt){var ct;u.sizeScale=te*u.getZoomScale();var Tt=u.getWindSize(),It=Tt.imageWidth,Lt=Tt.imageHeight,rn={glContext:lt,imageWidth:It,imageHeight:Lt,fadeOpacity:k,speedFactor:D,dropRate:j,dropRateBump:ee,rampColors:W};u.wind=new jJe(rn),u.wind.setWind({uMin:h,uMax:v,vMin:x,vMax:A,image:dt[0]}),(ct=u.texture)===null||ct===void 0||ct.destroy(),u.texture=We({width:It,height:Lt}),u.layerService.reRender()}),this.layer.buildLayerModel({moduleName:"wind",vertexShader:ZJe,fragmentShader:YJe,triangulation:A1,primitive:K.TRIANGLES,depth:{enable:!1},stencil:Ya(ve,Re),blend:this.getBlend()}).then(function(dt){u.colorModel=dt,i([dt])}).catch(function(dt){console.warn(dt),i([])})}},{key:"getWindSize",value:function(){var i=this.mapService.lngLatToPixel(this.imageCoords[0]),a=this.mapService.lngLatToPixel(this.imageCoords[1]),o=Math.min(Math.floor((a.x-i.x)*this.sizeScale),2048),s=Math.min(Math.floor((i.y-a.y)*this.sizeScale),2048);return{imageWidth:o,imageHeight:s}}},{key:"buildModels",value:function(i){this.initModels(i)}},{key:"clearModels",value:function(){var i,a;(i=this.texture)===null||i===void 0||i.destroy(),(a=this.wind)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Ar.Attribute,descriptor:{name:"a_Uv",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:2,update:function(a,o,s){return[s[3],s[4]]}}})}},{key:"getZoomScale",value:function(){return Math.min((this.cacheZoom+4)/30*2,2)}},{key:"drawWind",value:function(){if(this.wind){var i=this.layer.getLayerConfig(),a=i.uMin,o=a===void 0?-21.32:a,s=i.uMax,u=s===void 0?26.8:s,l=i.vMin,f=l===void 0?-21.57:l,h=i.vMax,p=h===void 0?21.42:h,v=i.numParticles,m=v===void 0?65535:v,x=i.fadeOpacity,E=x===void 0?.996:x,A=i.speedFactor,L=A===void 0?.25:A,k=i.dropRate,R=k===void 0?.003:k,D=i.dropRateBump,$=D===void 0?.01:D,j=i.rampColors,H=j===void 0?Kj:j,ee=i.sizeScale,U=ee===void 0?.5:ee,W=m,Q=Math.floor(this.mapService.getZoom());if(typeof U=="number"&&U!==this.sizeScale||Q!==this.cacheZoom){var te=this.getZoomScale();this.sizeScale=U,W*=te;var ie=this.getWindSize(),ve=ie.imageWidth,me=ie.imageHeight;this.wind.reSize(ve,me),this.cacheZoom=Q}this.wind.updateWindDir(o,u,f,p),this.wind.updateParticelNum(W),this.wind.updateColorRampTexture(H),this.wind.fadeOpacity=E,this.wind.speedFactor=L,this.wind.dropRate=R,this.wind.dropRateBump=$;var Re=this.wind.draw(),We=Re.d,je=Re.w,lt=Re.h;this.rendererService.setBaseState(),this.texture.update({data:We,width:je,height:lt})}}},{key:"drawColorMode",value:function(){var i,a=this.layer.getLayerConfig(),o=a.opacity;this.layer.masks.map(function(s){s.hooks.beforeRenderData.call(),s.hooks.beforeRender.call(),s.render(),s.hooks.afterRender.call()}),(i=this.colorModel)===null||i===void 0||i.draw({uniforms:{u_opacity:o||1,u_texture:this.texture}})}}]),t}(qi),KJe={wind:qJe},QJe=KJe;function JJe(e){var r=eet();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function eet(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tet=function(e){er(t,e);var r=JJe(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","WindLayer"),n}return ot(t,[{key:"buildModels",value:function(){var i=this,a=this.getModelType();this.layerModel=new QJe[a](this),this.layerModel.initModels(function(o){i.dispatchModelLoad(o)})}},{key:"rebuildModels",value:function(){var i=this;this.layerModel.buildModels(function(a){i.dispatchModelLoad(a)})}},{key:"renderModels",value:function(){return this.layerModel&&this.layerModel.render(),this}},{key:"getDefaultConfig",value:function(){var i=this.getModelType(),a={wind:{}};return a[i]}},{key:"getModelType",value:function(){return"wind"}}]),t}($f);function ret(e){var r=net();return function(){var n=ze(e),i;if(r){var a=ze(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nr(this,i)}}function net(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var iet=function(e){er(t,e);var r=ret(t);function t(){var n;st(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r.call.apply(r,[this].concat(a)),X(He(n),"type","TileDebugLayer"),X(He(n),"defaultSourceConfig",{data:[],options:{parser:{type:"testTile",cancelExtent:!0}}}),n}return ot(t,[{key:"buildModels",value:function(){var i=this;this.layerModel=new J2(this),this.layerModel.initModels(function(a){i.dispatchModelLoad(a)})}}]),t}($f),Qj,Jj,eW,tW,OT,rW,nW,aet=(Qj=Ri(),Jj=ba(Mt.IMapService),eW=ba(Mt.IFontService),Qj(tW=(OT=function(){function e(){st(this,e),ua(this,"mapService",rW,this),ua(this,"fontService",nW,this)}return ot(e,[{key:"apply",value:function(t,n){var i=this,a=n.styleAttributeService;t.hooks.init.tap("DataMappingPlugin",function(){var o=t.getSource();o.inited?i.generateMaping(t,{styleAttributeService:a}):o.once("update",function(){i.generateMaping(t,{styleAttributeService:a})})}),t.hooks.beforeRenderData.tap("DataMappingPlugin",function(){t.dataState.dataMappingNeedUpdate=!1;var o=t.getSource();return o.inited?i.generateMaping(t,{styleAttributeService:a}):o.once("update",function(){i.generateMaping(t,{styleAttributeService:a})}),!0}),t.hooks.beforeRender.tap("DataMappingPlugin",function(){var o=t.getLayerConfig(),s=o.usage;if(s!=="basemap"){var u=t.getSource();if(!(t.layerModelNeedUpdate||!u||!u.inited)){var l=t.getBottomColor(),f=a.getLayerStyleAttributes()||[],h=a.getLayerStyleAttribute("filter"),p=u.data.dataArray,v=f.filter(function(A){return A.needRemapping}),m=p;if(h!=null&&h.needRemapping&&h!==null&&h!==void 0&&h.scale&&(m=p.filter(function(A){return i.applyAttributeMapping(h,A,l)[0]})),v.length){if(h!=null&&h.needRemapping){var x=i.mapping(t,f,m,void 0,l);t.setEncodedData(x),h.needRemapping=!1}else{var E=i.mapping(t,v,m,t.getEncodedData(),l);t.setEncodedData(E)}t.emit("remapping",null)}}}})}},{key:"generateMaping",value:function(t,n){var i=this,a=n.styleAttributeService,o=t.getBottomColor(),s=a.getLayerStyleAttributes()||[],u=a.getLayerStyleAttribute("filter"),l=t.getSource().data.dataArray,f=l;u!=null&&u.scale&&(f=l.filter(function(p){return i.applyAttributeMapping(u,p,o)[0]}));var h=this.mapping(t,s,f,void 0,o);t.setEncodedData(h),t.emit("dataUpdate",null)}},{key:"mapping",value:function(t,n,i,a,o){var s=this,u=t.getLayerConfig(),l=u.arrow,f=l===void 0?{enable:!1}:l,h=u.usage;if(h==="basemap")return this.mapLayerMapping(t,n,i,a);var p=n.filter(function(m){return m.scale!==void 0}),v=i.map(function(m,x){var E=a?a[x]:{},A=Et({id:m._id,coordinates:m.coordinates},E);if(p.forEach(function(R){var D=s.applyAttributeMapping(R,m,o);R.needRemapping=!1,R.name==="color"&&(D=D.map(function($){return Sa($)})),A[R.name]=Array.isArray(D)&&D.length===1?D[0]:D,R.name==="shape"&&(A.shape=s.fontService.getIconFontKey(A[R.name]))}),f.enable&&(A.shape==="line"||A.shape==="halfLine")){var L=A.coordinates;if(t.arrowInsertCount<t.encodeDataLength){var k=s.getArrowPoints(L[0],L[1]);A.coordinates.splice(1,0,k,k),t.arrowInsertCount++}}return A});return this.adjustData2Amap2Coordinates(v,t),this.adjustData2SimpleCoordinates(v),v}},{key:"mapLayerMapping",value:function(t,n,i,a){var o=this,s=n.filter(function(l){return l.scale!==void 0}),u=i.map(function(l,f){var h=a?a[f]:{},p=Et({id:l._id,coordinates:l.coordinates},h);return s.forEach(function(v){var m;if(v.name==="shape"&&((m=t.shapeOption)===null||m===void 0?void 0:m.field)==="simple")p[v.name]="simple",v.needRemapping=!1;else{var x=o.applyMapLayerAttributeMapping(v,l);v.needRemapping=!1,p[v.name]=Array.isArray(x)&&x.length===1?x[0]:x,v.name==="shape"&&(p.shape=o.fontService.getIconFontKey(p[v.name]))}}),p.size===void 0&&(p.size=1),p});return this.adjustData2Amap2Coordinates(u,t),u}},{key:"adjustData2Amap2Coordinates",value:function(t,n){var i=this;if(t.length>0&&this.mapService.version===ko["GAODE2.x"]){var a=n.coordCenter||n.getSource().center;typeof t[0].coordinates[0]=="number"?t.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=ko["GAODE2.x"],o.originCoordinates=Kt.exports.cloneDeep(o.coordinates),o.coordinates=i.mapService.lngLatToCoordByLayer(o.coordinates,a)}):t.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=ko["GAODE2.x"],o.originCoordinates=Kt.exports.cloneDeep(o.coordinates),o.coordinates=i.mapService.lngLatToCoordsByLayer(o.coordinates,a)})}}},{key:"adjustData2SimpleCoordinates",value:function(t){var n=this;t.length>0&&this.mapService.version===ko.SIMPLE&&t.map(function(i){i.simpleCoordinate||(i.coordinates=n.unProjectCoordinates(i.coordinates),i.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(t){var n=this;if(typeof t[0]=="number")return this.mapService.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){var i=[];return t.map(function(o){var s=[];o.map(function(u){s.push(n.mapService.simpleMapCoord.unproject(u))}),i.push(s)}),i}else{var a=[];return t.map(function(o){a.push(n.mapService.simpleMapCoord.unproject(o))}),a}}},{key:"applyAttributeMapping",value:function(t,n,i){var a;if(!t.scale)return[];var o=(t==null||(a=t.scale)===null||a===void 0?void 0:a.scalers)||[],s=[];o.forEach(function(l){var f,h=l.field;(n.hasOwnProperty(h)||((f=t.scale)===null||f===void 0?void 0:f.type)==="variable")&&s.push(n[h])});var u=t.mapping?t.mapping(s):[];return t.name==="color"&&!DB(u[0])?[i]:u}},{key:"applyMapLayerAttributeMapping",value:function(t,n){var i;if(!t.scale)return[];var a=(t==null||(i=t.scale)===null||i===void 0?void 0:i.scalers)||[],o=[];a.forEach(function(u){var l,f=u.field;(n.hasOwnProperty(f)||((l=t.scale)===null||l===void 0?void 0:l.type)==="variable")&&o.push(n[f])});var s=t.mapping?t.mapping(o):[];return s}},{key:"getArrowPoints",value:function(t,n){var i=[n[0]-t[0],n[1]-t[1]],a=FB(i),o=[t[0]+a[0]*1e-4,t[1]+a[1]*1e-4];return o}}]),e}(),rW=ia(OT.prototype,"mapService",[Jj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nW=ia(OT.prototype,"fontService",[eW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OT))||tW),iW,aW,oet=(iW=Ri(),iW(aW=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t){var n=this;this.mapService=t.getContainer().get(Mt.IMapService),t.hooks.init.tap("DataSourcePlugin",function(){var i=t.getSource();if(!i){var a=t.sourceOption||t.defaultSourceConfig,o=a.data,s=a.options;i=new q2(o,s),t.setSource(i)}i.inited?n.updateClusterData(t):i.once("update",function(){n.updateClusterData(t)})}),t.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var i=n.updateClusterData(t),a=t.dataState.dataSourceNeedUpdate;return t.dataState.dataSourceNeedUpdate=!1,i||a})}},{key:"updateClusterData",value:function(t){if(t.isTileLayer||t.tileLayer)return!1;var n=t.getSource(),i=n.cluster,a=n.clusterOptions.zoom,o=a===void 0?0:a,s=this.mapService.getZoom()-1,u=t.dataState.dataSourceNeedUpdate;return i&&u&&n.updateClusterData(Math.floor(s)),i&&Math.abs(t.clusterZoom-s)>=1?(o!==Math.floor(s)&&n.updateClusterData(Math.floor(s)),t.clusterZoom=s,!0):!1}}]),e}())||aW);function g6(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function aae(e){return e.length===1&&(e=set(e)),{left:function(r,t,n,i){for(n==null&&(n=0),i==null&&(i=r.length);n<i;){var a=n+i>>>1;e(r[a],t)<0?n=a+1:i=a}return n},right:function(r,t,n,i){for(n==null&&(n=0),i==null&&(i=r.length);n<i;){var a=n+i>>>1;e(r[a],t)>0?i=a:n=a+1}return n}}}function set(e){return function(r,t){return g6(e(r),t)}}var uet=aae(g6),kk=uet.right;function cet(e){return e===null?NaN:+e}function oW(e,r){var t=e.length,n=-1,i,a,o;if(r==null){for(;++n<t;)if((i=e[n])!=null&&i>=i)for(a=o=i;++n<t;)(i=e[n])!=null&&(a>i&&(a=i),o<i&&(o=i))}else for(;++n<t;)if((i=r(e[n],n,e))!=null&&i>=i)for(a=o=i;++n<t;)(i=r(e[n],n,e))!=null&&(a>i&&(a=i),o<i&&(o=i));return[a,o]}var GD=Math.sqrt(50),HD=Math.sqrt(10),jD=Math.sqrt(2);function oae(e,r,t){var n,i=-1,a,o,s;if(r=+r,e=+e,t=+t,e===r&&t>0)return[e];if((n=r<e)&&(a=e,e=r,r=a),(s=wM(e,r,t))===0||!isFinite(s))return[];if(s>0)for(e=Math.ceil(e/s),r=Math.floor(r/s),o=new Array(a=Math.ceil(r-e+1));++i<a;)o[i]=(e+i)*s;else for(e=Math.floor(e*s),r=Math.ceil(r*s),o=new Array(a=Math.ceil(e-r+1));++i<a;)o[i]=(e-i)/s;return n&&o.reverse(),o}function wM(e,r,t){var n=(r-e)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=GD?10:a>=HD?5:a>=jD?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=GD?10:a>=HD?5:a>=jD?2:1)}function WD(e,r,t){var n=Math.abs(r-e)/Math.max(0,t),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),a=n/i;return a>=GD?i*=10:a>=HD?i*=5:a>=jD&&(i*=2),r<e?-i:i}function fet(e,r,t){if(t==null&&(t=cet),!!(n=e.length)){if((r=+r)<=0||n<2)return+t(e[0],0,e);if(r>=1)return+t(e[n-1],n-1,e);var n,i=(n-1)*r,a=Math.floor(i),o=+t(e[a],a,e),s=+t(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function C_(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function sae(e,r){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(r).domain(e);break}return this}var Pd="$";function CL(){}CL.prototype=EL.prototype={constructor:CL,has:function(e){return Pd+e in this},get:function(e){return this[Pd+e]},set:function(e,r){return this[Pd+e]=r,this},remove:function(e){var r=Pd+e;return r in this&&delete this[r]},clear:function(){for(var e in this)e[0]===Pd&&delete this[e]},keys:function(){var e=[];for(var r in this)r[0]===Pd&&e.push(r.slice(1));return e},values:function(){var e=[];for(var r in this)r[0]===Pd&&e.push(this[r]);return e},entries:function(){var e=[];for(var r in this)r[0]===Pd&&e.push({key:r.slice(1),value:this[r]});return e},size:function(){var e=0;for(var r in this)r[0]===Pd&&++e;return e},empty:function(){for(var e in this)if(e[0]===Pd)return!1;return!0},each:function(e){for(var r in this)r[0]===Pd&&e(this[r],r.slice(1),this)}};function EL(e,r){var t=new CL;if(e instanceof CL)e.each(function(s,u){t.set(u,s)});else if(Array.isArray(e)){var n=-1,i=e.length,a;if(r==null)for(;++n<i;)t.set(n,e[n]);else for(;++n<i;)t.set(r(a=e[n],n,e),a)}else if(e)for(var o in e)t.set(o,e[o]);return t}function sW(){}var fx=EL.prototype;sW.prototype={constructor:sW,has:fx.has,add:function(e){return e+="",this[Pd+e]=e,this},remove:fx.remove,clear:fx.clear,values:fx.keys,size:fx.size,empty:fx.empty,each:fx.each};var uae=Array.prototype,SL=uae.map,c1=uae.slice,uW={name:"implicit"};function AL(){var e=EL(),r=[],t=[],n=uW;function i(a){var o=a+"",s=e.get(o);if(!s){if(n!==uW)return n;e.set(o,s=r.push(a))}return t[(s-1)%t.length]}return i.domain=function(a){if(!arguments.length)return r.slice();r=[],e=EL();for(var o=-1,s=a.length,u,l;++o<s;)e.has(l=(u=a[o])+"")||e.set(l,r.push(u));return i},i.range=function(a){return arguments.length?(t=c1.call(a),i):t.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return AL(r,t).unknown(n)},C_.apply(i,arguments),i}function het(e){return function(){return e}}function XD(e){return+e}var lW=[0,1];function Df(e){return e}function YD(e,r){return(r-=e=+e)?function(t){return(t-e)/r}:het(isNaN(r)?NaN:.5)}function cW(e){var r=e[0],t=e[e.length-1],n;return r>t&&(n=r,r=t,t=n),function(i){return Math.max(r,Math.min(t,i))}}function pet(e,r,t){var n=e[0],i=e[1],a=r[0],o=r[1];return i<n?(n=YD(i,n),a=t(o,a)):(n=YD(n,i),a=t(a,o)),function(s){return a(n(s))}}function det(e,r,t){var n=Math.min(e.length,r.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++o<n;)i[o]=YD(e[o],e[o+1]),a[o]=t(r[o],r[o+1]);return function(s){var u=kk(e,s,1,n)-1;return a[u](i[u](s))}}function Pk(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function m6(){var e=lW,r=lW,t=sE,n,i,a,o=Df,s,u,l;function f(){return s=Math.min(e.length,r.length)>2?det:pet,u=l=null,h}function h(p){return isNaN(p=+p)?a:(u||(u=s(e.map(n),r,t)))(n(o(p)))}return h.invert=function(p){return o(i((l||(l=s(r,e.map(n),DM)))(p)))},h.domain=function(p){return arguments.length?(e=SL.call(p,XD),o===Df||(o=cW(e)),f()):e.slice()},h.range=function(p){return arguments.length?(r=c1.call(p),f()):r.slice()},h.rangeRound=function(p){return r=c1.call(p),t=A0e,f()},h.clamp=function(p){return arguments.length?(o=p?cW(e):Df,h):o!==Df},h.interpolate=function(p){return arguments.length?(t=p,f()):t},h.unknown=function(p){return arguments.length?(a=p,h):a},function(p,v){return n=p,i=v,f()}}function lae(e,r){return m6()(e,r)}function vet(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function TL(e,r){if((t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var t,n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}function A2(e){return e=TL(Math.abs(e)),e?e[1]:NaN}function get(e,r){return function(t,n){for(var i=t.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>n&&(s=Math.max(1,n-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>n));)s=e[o=(o+1)%e.length];return a.reverse().join(r)}}function met(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}}var yet=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ML(e){if(!(r=yet.exec(e)))throw new Error("invalid format: "+e);var r;return new y6({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}ML.prototype=y6.prototype;function y6(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}y6.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _et(e){e:for(var r=e.length,t=1,n=-1,i;t<r;++t)switch(e[t]){case".":n=i=t;break;case"0":n===0&&(n=t),i=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var cae;function xet(e,r){var t=TL(e,r);if(!t)return e+"";var n=t[0],i=t[1],a=i-(cae=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+TL(e,Math.max(0,r+a-1))[0]}function fW(e,r){var t=TL(e,r);if(!t)return e+"";var n=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var hW={"%":function(e,r){return(e*100).toFixed(r)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:vet,e:function(e,r){return e.toExponential(r)},f:function(e,r){return e.toFixed(r)},g:function(e,r){return e.toPrecision(r)},o:function(e){return Math.round(e).toString(8)},p:function(e,r){return fW(e*100,r)},r:fW,s:xet,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function pW(e){return e}var dW=Array.prototype.map,vW=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function bet(e){var r=e.grouping===void 0||e.thousands===void 0?pW:get(dW.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?pW:met(dW.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"-":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(h){h=ML(h);var p=h.fill,v=h.align,m=h.sign,x=h.symbol,E=h.zero,A=h.width,L=h.comma,k=h.precision,R=h.trim,D=h.type;D==="n"?(L=!0,D="g"):hW[D]||(k===void 0&&(k=12),R=!0,D="g"),(E||p==="0"&&v==="=")&&(E=!0,p="0",v="=");var $=x==="$"?t:x==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",j=x==="$"?n:/[%p]/.test(D)?o:"",H=hW[D],ee=/[defgprs%]/.test(D);k=k===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function U(W){var Q=$,te=j,ie,ve,me;if(D==="c")te=H(W)+te,W="";else{W=+W;var Re=W<0||1/W<0;if(W=isNaN(W)?u:H(Math.abs(W),k),R&&(W=_et(W)),Re&&+W==0&&m!=="+"&&(Re=!1),Q=(Re?m==="("?m:s:m==="-"||m==="("?"":m)+Q,te=(D==="s"?vW[8+cae/3]:"")+te+(Re&&m==="("?")":""),ee){for(ie=-1,ve=W.length;++ie<ve;)if(me=W.charCodeAt(ie),48>me||me>57){te=(me===46?i+W.slice(ie+1):W.slice(ie))+te,W=W.slice(0,ie);break}}}L&&!E&&(W=r(W,1/0));var We=Q.length+W.length+te.length,je=We<A?new Array(A-We+1).join(p):"";switch(L&&E&&(W=r(je+W,je.length?A-te.length:1/0),je=""),v){case"<":W=Q+W+te+je;break;case"=":W=Q+je+W+te;break;case"^":W=je.slice(0,We=je.length>>1)+Q+W+te+je.slice(We);break;default:W=je+Q+W+te;break}return a(W)}return U.toString=function(){return h+""},U}function f(h,p){var v=l((h=ML(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(A2(p)/3)))*3,x=Math.pow(10,-m),E=vW[8+m/3];return function(A){return v(x*A)+E}}return{format:l,formatPrefix:f}}var FT,_6,fae;wet({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function wet(e){return FT=bet(e),_6=FT.format,fae=FT.formatPrefix,FT}function Cet(e){return Math.max(0,-A2(Math.abs(e)))}function Eet(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(A2(r)/3)))*3-A2(Math.abs(e)))}function Aet(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,A2(r)-A2(e))+1}function Tet(e,r,t,n){var i=WD(e,r,t),a;switch(n=ML(n==null?",f":n),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(a=Eet(i,o))&&(n.precision=a),fae(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=Aet(i,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=Cet(i))&&(n.precision=a-(n.type==="%")*2);break}}return _6(n)}function ew(e){var r=e.domain;return e.ticks=function(t){var n=r();return oae(n[0],n[n.length-1],t==null?10:t)},e.tickFormat=function(t,n){var i=r();return Tet(i[0],i[i.length-1],t==null?10:t,n)},e.nice=function(t){t==null&&(t=10);var n=r(),i=0,a=n.length-1,o=n[i],s=n[a],u;return s<o&&(u=o,o=s,s=u,u=i,i=a,a=u),u=wM(o,s,t),u>0?(o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u,u=wM(o,s,t)):u<0&&(o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u,u=wM(o,s,t)),u>0?(n[i]=Math.floor(o/u)*u,n[a]=Math.ceil(s/u)*u,r(n)):u<0&&(n[i]=Math.ceil(o*u)/u,n[a]=Math.floor(s*u)/u,r(n)),e},e}function hae(){var e=lae(Df,Df);return e.copy=function(){return Pk(e,hae())},C_.apply(e,arguments),ew(e)}function pae(e){var r;function t(n){return isNaN(n=+n)?r:n}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=SL.call(n,XD),t):e.slice()},t.unknown=function(n){return arguments.length?(r=n,t):r},t.copy=function(){return pae(e).unknown(r)},e=arguments.length?SL.call(e,XD):[0,1],ew(t)}function dae(e,r){e=e.slice();var t=0,n=e.length-1,i=e[t],a=e[n],o;return a<i&&(o=t,t=n,n=o,o=i,i=a,a=o),e[t]=r.floor(i),e[n]=r.ceil(a),e}function gW(e){return Math.log(e)}function mW(e){return Math.exp(e)}function Met(e){return-Math.log(-e)}function Let(e){return-Math.exp(-e)}function Iet(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ket(e){return e===10?Iet:e===Math.E?Math.exp:function(r){return Math.pow(e,r)}}function Pet(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(r){return Math.log(r)/e})}function yW(e){return function(r){return-e(-r)}}function Ret(e){var r=e(gW,mW),t=r.domain,n=10,i,a;function o(){return i=Pet(n),a=ket(n),t()[0]<0?(i=yW(i),a=yW(a),e(Met,Let)):e(gW,mW),r}return r.base=function(s){return arguments.length?(n=+s,o()):n},r.domain=function(s){return arguments.length?(t(s),o()):t()},r.ticks=function(s){var u=t(),l=u[0],f=u[u.length-1],h;(h=f<l)&&(p=l,l=f,f=p);var p=i(l),v=i(f),m,x,E,A=s==null?10:+s,L=[];if(!(n%1)&&v-p<A){if(p=Math.round(p)-1,v=Math.round(v)+1,l>0){for(;p<v;++p)for(x=1,m=a(p);x<n;++x)if(E=m*x,!(E<l)){if(E>f)break;L.push(E)}}else for(;p<v;++p)for(x=n-1,m=a(p);x>=1;--x)if(E=m*x,!(E<l)){if(E>f)break;L.push(E)}}else L=oae(p,v,Math.min(v-p,A)).map(a);return h?L.reverse():L},r.tickFormat=function(s,u){if(u==null&&(u=n===10?".0e":","),typeof u!="function"&&(u=_6(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,n*s/r.ticks().length);return function(f){var h=f/a(Math.round(i(f)));return h*n<n-.5&&(h*=n),h<=l?u(f):""}},r.nice=function(){return t(dae(t(),{floor:function(s){return a(Math.floor(i(s)))},ceil:function(s){return a(Math.ceil(i(s)))}}))},r}function vae(){var e=Ret(m6()).domain([1,10]);return e.copy=function(){return Pk(e,vae()).base(e.base())},C_.apply(e,arguments),e}function _W(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function Oet(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Fet(e){return e<0?-e*e:e*e}function Det(e){var r=e(Df,Df),t=1;function n(){return t===1?e(Df,Df):t===.5?e(Oet,Fet):e(_W(t),_W(1/t))}return r.exponent=function(i){return arguments.length?(t=+i,n()):t},ew(r)}function gae(){var e=Det(m6());return e.copy=function(){return Pk(e,gae()).exponent(e.exponent())},C_.apply(e,arguments),e}function mae(){var e=[],r=[],t=[],n;function i(){var o=0,s=Math.max(1,r.length);for(t=new Array(s-1);++o<s;)t[o-1]=fet(e,o/s);return a}function a(o){return isNaN(o=+o)?n:r[kk(t,o)]}return a.invertExtent=function(o){var s=r.indexOf(o);return s<0?[NaN,NaN]:[s>0?t[s-1]:e[0],s<t.length?t[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(var s=0,u=o.length,l;s<u;++s)l=o[s],l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(g6),i()},a.range=function(o){return arguments.length?(r=c1.call(o),i()):r.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return t.slice()},a.copy=function(){return mae().domain(e).range(r).unknown(n)},C_.apply(a,arguments)}function yae(){var e=0,r=1,t=1,n=[.5],i=[0,1],a;function o(u){return u<=u?i[kk(n,u,0,t)]:a}function s(){var u=-1;for(n=new Array(t);++u<t;)n[u]=((u+1)*r-(u-t)*e)/(t+1);return o}return o.domain=function(u){return arguments.length?(e=+u[0],r=+u[1],s()):[e,r]},o.range=function(u){return arguments.length?(t=(i=c1.call(u)).length-1,s()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,n[0]]:l>=t?[n[t-1],r]:[n[l-1],n[l]]},o.unknown=function(u){return arguments.length&&(a=u),o},o.thresholds=function(){return n.slice()},o.copy=function(){return yae().domain([e,r]).range(i).unknown(a)},C_.apply(ew(o),arguments)}function _ae(){var e=[.5],r=[0,1],t,n=1;function i(a){return a<=a?r[kk(e,a,0,n)]:t}return i.domain=function(a){return arguments.length?(e=c1.call(a),n=Math.min(e.length,r.length-1),i):e.slice()},i.range=function(a){return arguments.length?(r=c1.call(a),n=Math.min(e.length,r.length-1),i):r.slice()},i.invertExtent=function(a){var o=r.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(t=a,i):t},i.copy=function(){return _ae().domain(e).range(r).unknown(t)},C_.apply(i,arguments)}var DO=new Date,BO=new Date;function hh(e,r,t,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),r(a,1),e(a),a},i.round=function(a){var o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=function(a,o){return r(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,s){var u=[],l;if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return u;do u.push(l=new Date(+a)),r(a,s),e(a);while(l<a&&a<o);return u},i.filter=function(a){return hh(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,s){if(o>=o)if(s<0)for(;++s<=0;)for(;r(o,-1),!a(o););else for(;--s>=0;)for(;r(o,1),!a(o););})},t&&(i.count=function(a,o){return DO.setTime(+a),BO.setTime(+o),e(DO),e(BO),Math.floor(t(DO,BO))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?function(o){return n(o)%a===0}:function(o){return i.count(0,o)%a===0}):i}),i}var LL=hh(function(){},function(e,r){e.setTime(+e+r)},function(e,r){return r-e});LL.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?hh(function(r){r.setTime(Math.floor(r/e)*e)},function(r,t){r.setTime(+r+t*e)},function(r,t){return(t-r)/e}):LL};var Bet=LL;LL.range;var IL=1e3,ZE=6e4,xW=36e5,xae=864e5,bae=6048e5,wae=hh(function(e){e.setTime(e-e.getMilliseconds())},function(e,r){e.setTime(+e+r*IL)},function(e,r){return(r-e)/IL},function(e){return e.getUTCSeconds()}),Net=wae;wae.range;var Cae=hh(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*IL)},function(e,r){e.setTime(+e+r*ZE)},function(e,r){return(r-e)/ZE},function(e){return e.getMinutes()}),zet=Cae;Cae.range;var Eae=hh(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*IL-e.getMinutes()*ZE)},function(e,r){e.setTime(+e+r*xW)},function(e,r){return(r-e)/xW},function(e){return e.getHours()}),$et=Eae;Eae.range;var Sae=hh(function(e){e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*ZE)/xae},function(e){return e.getDate()-1}),x6=Sae;Sae.range;function M1(e){return hh(function(r){r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},function(r,t){r.setDate(r.getDate()+t*7)},function(r,t){return(t-r-(t.getTimezoneOffset()-r.getTimezoneOffset())*ZE)/bae})}var b6=M1(0),kL=M1(1),Uet=M1(2),Vet=M1(3),T2=M1(4),Get=M1(5),Het=M1(6);b6.range;kL.range;Uet.range;Vet.range;T2.range;Get.range;Het.range;var Aae=hh(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,r){e.setMonth(e.getMonth()+r)},function(e,r){return r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),jet=Aae;Aae.range;var w6=hh(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r)},function(e,r){return r.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});w6.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:hh(function(r){r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},function(r,t){r.setFullYear(r.getFullYear()+t*e)})};var M2=w6;w6.range;var Tae=hh(function(e){e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r)},function(e,r){return(r-e)/xae},function(e){return e.getUTCDate()-1}),Mae=Tae;Tae.range;function L1(e){return hh(function(r){r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},function(r,t){r.setUTCDate(r.getUTCDate()+t*7)},function(r,t){return(t-r)/bae})}var Lae=L1(0),PL=L1(1),Wet=L1(2),Xet=L1(3),L2=L1(4),Yet=L1(5),Zet=L1(6);Lae.range;PL.range;Wet.range;Xet.range;L2.range;Yet.range;Zet.range;var C6=hh(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r)},function(e,r){return r.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});C6.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:hh(function(r){r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},function(r,t){r.setUTCFullYear(r.getUTCFullYear()+t*e)})};var qE=C6;C6.range;function NO(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zO(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function eC(e,r,t){return{y:e,m:r,d:t,H:0,M:0,S:0,L:0}}function qet(e){var r=e.dateTime,t=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,l=tC(i),f=rC(i),h=tC(a),p=rC(a),v=tC(o),m=rC(o),x=tC(s),E=rC(s),A=tC(u),L=rC(u),k={a:Re,A:We,b:je,B:lt,c:null,d:AW,e:AW,f:_tt,g:Ltt,G:ktt,H:gtt,I:mtt,j:ytt,L:Iae,m:xtt,M:btt,p:dt,q:ct,Q:LW,s:IW,S:wtt,u:Ctt,U:Ett,V:Stt,w:Att,W:Ttt,x:null,X:null,y:Mtt,Y:Itt,Z:Ptt,"%":MW},R={a:Tt,A:It,b:Lt,B:rn,c:null,d:TW,e:TW,f:Dtt,g:Wtt,G:Ytt,H:Rtt,I:Ott,j:Ftt,L:Pae,m:Btt,M:Ntt,p:wn,q:zn,Q:LW,s:IW,S:ztt,u:$tt,U:Utt,V:Vtt,w:Gtt,W:Htt,x:null,X:null,y:jtt,Y:Xtt,Z:Ztt,"%":MW},D={a:U,A:W,b:Q,B:te,c:ie,d:EW,e:EW,f:htt,g:CW,G:wW,H:SW,I:SW,j:utt,L:ftt,m:stt,M:ltt,p:ee,q:ott,Q:dtt,s:vtt,S:ctt,u:ttt,U:rtt,V:ntt,w:ett,W:itt,x:ve,X:me,y:CW,Y:wW,Z:att,"%":ptt};k.x=$(t,k),k.X=$(n,k),k.c=$(r,k),R.x=$(t,R),R.X=$(n,R),R.c=$(r,R);function $(Zt,nn){return function(mn){var zt=[],Vr=-1,On=0,Si=Zt.length,Fn,Ai,Ua;for(mn instanceof Date||(mn=new Date(+mn));++Vr<Si;)Zt.charCodeAt(Vr)===37&&(zt.push(Zt.slice(On,Vr)),(Ai=bW[Fn=Zt.charAt(++Vr)])!=null?Fn=Zt.charAt(++Vr):Ai=Fn==="e"?" ":"0",(Ua=nn[Fn])&&(Fn=Ua(mn,Ai)),zt.push(Fn),On=Vr+1);return zt.push(Zt.slice(On,Vr)),zt.join("")}}function j(Zt,nn){return function(mn){var zt=eC(1900,void 0,1),Vr=H(zt,Zt,mn+="",0),On,Si;if(Vr!=mn.length)return null;if("Q"in zt)return new Date(zt.Q);if("s"in zt)return new Date(zt.s*1e3+("L"in zt?zt.L:0));if(nn&&!("Z"in zt)&&(zt.Z=0),"p"in zt&&(zt.H=zt.H%12+zt.p*12),zt.m===void 0&&(zt.m="q"in zt?zt.q:0),"V"in zt){if(zt.V<1||zt.V>53)return null;"w"in zt||(zt.w=1),"Z"in zt?(On=zO(eC(zt.y,0,1)),Si=On.getUTCDay(),On=Si>4||Si===0?PL.ceil(On):PL(On),On=Mae.offset(On,(zt.V-1)*7),zt.y=On.getUTCFullYear(),zt.m=On.getUTCMonth(),zt.d=On.getUTCDate()+(zt.w+6)%7):(On=NO(eC(zt.y,0,1)),Si=On.getDay(),On=Si>4||Si===0?kL.ceil(On):kL(On),On=x6.offset(On,(zt.V-1)*7),zt.y=On.getFullYear(),zt.m=On.getMonth(),zt.d=On.getDate()+(zt.w+6)%7)}else("W"in zt||"U"in zt)&&("w"in zt||(zt.w="u"in zt?zt.u%7:"W"in zt?1:0),Si="Z"in zt?zO(eC(zt.y,0,1)).getUTCDay():NO(eC(zt.y,0,1)).getDay(),zt.m=0,zt.d="W"in zt?(zt.w+6)%7+zt.W*7-(Si+5)%7:zt.w+zt.U*7-(Si+6)%7);return"Z"in zt?(zt.H+=zt.Z/100|0,zt.M+=zt.Z%100,zO(zt)):NO(zt)}}function H(Zt,nn,mn,zt){for(var Vr=0,On=nn.length,Si=mn.length,Fn,Ai;Vr<On;){if(zt>=Si)return-1;if(Fn=nn.charCodeAt(Vr++),Fn===37){if(Fn=nn.charAt(Vr++),Ai=D[Fn in bW?nn.charAt(Vr++):Fn],!Ai||(zt=Ai(Zt,mn,zt))<0)return-1}else if(Fn!=mn.charCodeAt(zt++))return-1}return zt}function ee(Zt,nn,mn){var zt=l.exec(nn.slice(mn));return zt?(Zt.p=f[zt[0].toLowerCase()],mn+zt[0].length):-1}function U(Zt,nn,mn){var zt=v.exec(nn.slice(mn));return zt?(Zt.w=m[zt[0].toLowerCase()],mn+zt[0].length):-1}function W(Zt,nn,mn){var zt=h.exec(nn.slice(mn));return zt?(Zt.w=p[zt[0].toLowerCase()],mn+zt[0].length):-1}function Q(Zt,nn,mn){var zt=A.exec(nn.slice(mn));return zt?(Zt.m=L[zt[0].toLowerCase()],mn+zt[0].length):-1}function te(Zt,nn,mn){var zt=x.exec(nn.slice(mn));return zt?(Zt.m=E[zt[0].toLowerCase()],mn+zt[0].length):-1}function ie(Zt,nn,mn){return H(Zt,r,nn,mn)}function ve(Zt,nn,mn){return H(Zt,t,nn,mn)}function me(Zt,nn,mn){return H(Zt,n,nn,mn)}function Re(Zt){return o[Zt.getDay()]}function We(Zt){return a[Zt.getDay()]}function je(Zt){return u[Zt.getMonth()]}function lt(Zt){return s[Zt.getMonth()]}function dt(Zt){return i[+(Zt.getHours()>=12)]}function ct(Zt){return 1+~~(Zt.getMonth()/3)}function Tt(Zt){return o[Zt.getUTCDay()]}function It(Zt){return a[Zt.getUTCDay()]}function Lt(Zt){return u[Zt.getUTCMonth()]}function rn(Zt){return s[Zt.getUTCMonth()]}function wn(Zt){return i[+(Zt.getUTCHours()>=12)]}function zn(Zt){return 1+~~(Zt.getUTCMonth()/3)}return{format:function(Zt){var nn=$(Zt+="",k);return nn.toString=function(){return Zt},nn},parse:function(Zt){var nn=j(Zt+="",!1);return nn.toString=function(){return Zt},nn},utcFormat:function(Zt){var nn=$(Zt+="",R);return nn.toString=function(){return Zt},nn},utcParse:function(Zt){var nn=j(Zt+="",!0);return nn.toString=function(){return Zt},nn}}}var bW={"-":"",_:" ",0:"0"},Rc=/^\s*\d+/,Ket=/^%/,Qet=/[\\^$*+?|[\]().{}]/g;function Yo(e,r,t){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<t?new Array(t-a+1).join(r)+i:i)}function Jet(e){return e.replace(Qet,"\\$&")}function tC(e){return new RegExp("^(?:"+e.map(Jet).join("|")+")","i")}function rC(e){for(var r={},t=-1,n=e.length;++t<n;)r[e[t].toLowerCase()]=t;return r}function ett(e,r,t){var n=Rc.exec(r.slice(t,t+1));return n?(e.w=+n[0],t+n[0].length):-1}function ttt(e,r,t){var n=Rc.exec(r.slice(t,t+1));return n?(e.u=+n[0],t+n[0].length):-1}function rtt(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.U=+n[0],t+n[0].length):-1}function ntt(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.V=+n[0],t+n[0].length):-1}function itt(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.W=+n[0],t+n[0].length):-1}function wW(e,r,t){var n=Rc.exec(r.slice(t,t+4));return n?(e.y=+n[0],t+n[0].length):-1}function CW(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function att(e,r,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(t,t+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function ott(e,r,t){var n=Rc.exec(r.slice(t,t+1));return n?(e.q=n[0]*3-3,t+n[0].length):-1}function stt(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.m=n[0]-1,t+n[0].length):-1}function EW(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.d=+n[0],t+n[0].length):-1}function utt(e,r,t){var n=Rc.exec(r.slice(t,t+3));return n?(e.m=0,e.d=+n[0],t+n[0].length):-1}function SW(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.H=+n[0],t+n[0].length):-1}function ltt(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.M=+n[0],t+n[0].length):-1}function ctt(e,r,t){var n=Rc.exec(r.slice(t,t+2));return n?(e.S=+n[0],t+n[0].length):-1}function ftt(e,r,t){var n=Rc.exec(r.slice(t,t+3));return n?(e.L=+n[0],t+n[0].length):-1}function htt(e,r,t){var n=Rc.exec(r.slice(t,t+6));return n?(e.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function ptt(e,r,t){var n=Ket.exec(r.slice(t,t+1));return n?t+n[0].length:-1}function dtt(e,r,t){var n=Rc.exec(r.slice(t));return n?(e.Q=+n[0],t+n[0].length):-1}function vtt(e,r,t){var n=Rc.exec(r.slice(t));return n?(e.s=+n[0],t+n[0].length):-1}function AW(e,r){return Yo(e.getDate(),r,2)}function gtt(e,r){return Yo(e.getHours(),r,2)}function mtt(e,r){return Yo(e.getHours()%12||12,r,2)}function ytt(e,r){return Yo(1+x6.count(M2(e),e),r,3)}function Iae(e,r){return Yo(e.getMilliseconds(),r,3)}function _tt(e,r){return Iae(e,r)+"000"}function xtt(e,r){return Yo(e.getMonth()+1,r,2)}function btt(e,r){return Yo(e.getMinutes(),r,2)}function wtt(e,r){return Yo(e.getSeconds(),r,2)}function Ctt(e){var r=e.getDay();return r===0?7:r}function Ett(e,r){return Yo(b6.count(M2(e)-1,e),r,2)}function kae(e){var r=e.getDay();return r>=4||r===0?T2(e):T2.ceil(e)}function Stt(e,r){return e=kae(e),Yo(T2.count(M2(e),e)+(M2(e).getDay()===4),r,2)}function Att(e){return e.getDay()}function Ttt(e,r){return Yo(kL.count(M2(e)-1,e),r,2)}function Mtt(e,r){return Yo(e.getFullYear()%100,r,2)}function Ltt(e,r){return e=kae(e),Yo(e.getFullYear()%100,r,2)}function Itt(e,r){return Yo(e.getFullYear()%1e4,r,4)}function ktt(e,r){var t=e.getDay();return e=t>=4||t===0?T2(e):T2.ceil(e),Yo(e.getFullYear()%1e4,r,4)}function Ptt(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+Yo(r/60|0,"0",2)+Yo(r%60,"0",2)}function TW(e,r){return Yo(e.getUTCDate(),r,2)}function Rtt(e,r){return Yo(e.getUTCHours(),r,2)}function Ott(e,r){return Yo(e.getUTCHours()%12||12,r,2)}function Ftt(e,r){return Yo(1+Mae.count(qE(e),e),r,3)}function Pae(e,r){return Yo(e.getUTCMilliseconds(),r,3)}function Dtt(e,r){return Pae(e,r)+"000"}function Btt(e,r){return Yo(e.getUTCMonth()+1,r,2)}function Ntt(e,r){return Yo(e.getUTCMinutes(),r,2)}function ztt(e,r){return Yo(e.getUTCSeconds(),r,2)}function $tt(e){var r=e.getUTCDay();return r===0?7:r}function Utt(e,r){return Yo(Lae.count(qE(e)-1,e),r,2)}function Rae(e){var r=e.getUTCDay();return r>=4||r===0?L2(e):L2.ceil(e)}function Vtt(e,r){return e=Rae(e),Yo(L2.count(qE(e),e)+(qE(e).getUTCDay()===4),r,2)}function Gtt(e){return e.getUTCDay()}function Htt(e,r){return Yo(PL.count(qE(e)-1,e),r,2)}function jtt(e,r){return Yo(e.getUTCFullYear()%100,r,2)}function Wtt(e,r){return e=Rae(e),Yo(e.getUTCFullYear()%100,r,2)}function Xtt(e,r){return Yo(e.getUTCFullYear()%1e4,r,4)}function Ytt(e,r){var t=e.getUTCDay();return e=t>=4||t===0?L2(e):L2.ceil(e),Yo(e.getUTCFullYear()%1e4,r,4)}function Ztt(){return"+0000"}function MW(){return"%"}function LW(e){return+e}function IW(e){return Math.floor(+e/1e3)}var Tb,Oae;qtt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function qtt(e){return Tb=qet(e),Oae=Tb.format,Tb.parse,Tb.utcFormat,Tb.utcParse,Tb}var LC=1e3,IC=LC*60,kC=IC*60,KE=kC*24,Ktt=KE*7,kW=KE*30,$O=KE*365;function Qtt(e){return new Date(e)}function Jtt(e){return e instanceof Date?+e:+new Date(+e)}function Fae(e,r,t,n,i,a,o,s,u){var l=lae(Df,Df),f=l.invert,h=l.domain,p=u(".%L"),v=u(":%S"),m=u("%I:%M"),x=u("%I %p"),E=u("%a %d"),A=u("%b %d"),L=u("%B"),k=u("%Y"),R=[[o,1,LC],[o,5,5*LC],[o,15,15*LC],[o,30,30*LC],[a,1,IC],[a,5,5*IC],[a,15,15*IC],[a,30,30*IC],[i,1,kC],[i,3,3*kC],[i,6,6*kC],[i,12,12*kC],[n,1,KE],[n,2,2*KE],[t,1,Ktt],[r,1,kW],[r,3,3*kW],[e,1,$O]];function D(j){return(o(j)<j?p:a(j)<j?v:i(j)<j?m:n(j)<j?x:r(j)<j?t(j)<j?E:A:e(j)<j?L:k)(j)}function $(j,H,ee,U){if(j==null&&(j=10),typeof j=="number"){var W=Math.abs(ee-H)/j,Q=aae(function(te){return te[2]}).right(R,W);Q===R.length?(U=WD(H/$O,ee/$O,j),j=e):Q?(Q=R[W/R[Q-1][2]<R[Q][2]/W?Q-1:Q],U=Q[1],j=Q[0]):(U=Math.max(WD(H,ee,j),1),j=s)}return U==null?j:j.every(U)}return l.invert=function(j){return new Date(f(j))},l.domain=function(j){return arguments.length?h(SL.call(j,Jtt)):h().map(Qtt)},l.ticks=function(j,H){var ee=h(),U=ee[0],W=ee[ee.length-1],Q=W<U,te;return Q&&(te=U,U=W,W=te),te=$(j,U,W,H),te=te?te.range(U,W+1):[],Q?te.reverse():te},l.tickFormat=function(j,H){return H==null?D:u(H)},l.nice=function(j,H){var ee=h();return(j=$(j,ee[0],ee[ee.length-1],H))?h(dae(ee,j)):l},l.copy=function(){return Pk(l,Fae(e,r,t,n,i,a,o,s,u))},l}function ert(){return C_.apply(Fae(M2,jet,b6,x6,$et,zet,Net,Bet,Oae).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function trt(){var e=0,r=1,t,n,i,a,o=Df,s=!1,u;function l(f){return isNaN(f=+f)?u:o(i===0?.5:(f=(a(f)-t)*i,s?Math.max(0,Math.min(1,f)):f))}return l.domain=function(f){return arguments.length?(t=a(e=+f[0]),n=a(r=+f[1]),i=t===n?0:1/(n-t),l):[e,r]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(o=f,l):o},l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return a=f,t=f(e),n=f(r),i=t===n?0:1/(n-t),l}}function Dae(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Bae(){var e=ew(trt()(Df));return e.copy=function(){return Dae(e,Bae())},sae.apply(e,arguments)}function rrt(){var e=0,r=.5,t=1,n,i,a,o,s,u=Df,l,f=!1,h;function p(v){return isNaN(v=+v)?h:(v=.5+((v=+l(v))-i)*(v<i?o:s),u(f?Math.max(0,Math.min(1,v)):v))}return p.domain=function(v){return arguments.length?(n=l(e=+v[0]),i=l(r=+v[1]),a=l(t=+v[2]),o=n===i?0:.5/(i-n),s=i===a?0:.5/(a-i),p):[e,r,t]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(u=v,p):u},p.unknown=function(v){return arguments.length?(h=v,p):h},function(v){return l=v,n=v(e),i=v(r),a=v(t),o=n===i?0:.5/(i-n),s=i===a?0:.5/(a-i),p}}function Nae(){var e=ew(rrt()(Df));return e.copy=function(){return Dae(e,Nae())},sae.apply(e,arguments)}var Gp,PW,RW,nrt=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,irt=(Gp={},X(Gp,Lo.LINEAR,hae),X(Gp,Lo.POWER,gae),X(Gp,Lo.LOG,vae),X(Gp,Lo.IDENTITY,pae),X(Gp,Lo.SEQUENTIAL,Bae),X(Gp,Lo.TIME,ert),X(Gp,Lo.QUANTILE,mae),X(Gp,Lo.QUANTIZE,yae),X(Gp,Lo.THRESHOLD,_ae),X(Gp,Lo.CAT,AL),X(Gp,Lo.DIVERGING,Nae),Gp),art=(PW=Ri(),PW(RW=function(){function e(){st(this,e),X(this,"scaleOptions",{})}return ot(e,[{key:"getSourceData",value:function(t,n){var i=t.getSource();i.inited?n(i.data):i.once("update",function(){n(i.data)})}},{key:"apply",value:function(t,n){var i=this,a=n.styleAttributeService;t.hooks.init.tap("FeatureScalePlugin",function(){i.scaleOptions=t.getScaleOptions();var o=a.getLayerStyleAttributes();i.getSourceData(t,function(s){var u=s.dataArray;Array.isArray(u)&&u.length===0||i.caculateScalesForAttributes(o||[],u)})}),t.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){i.scaleOptions=t.getScaleOptions();var o=a.getLayerStyleAttributes();return i.getSourceData(t,function(s){var u=s.dataArray;Array.isArray(u)&&u.length===0||(i.caculateScalesForAttributes(o||[],u),t.layerModelNeedUpdate=!0)}),!0}),t.hooks.beforeRender.tap("FeatureScalePlugin",function(){var o=t.getLayerConfig(),s=o.usage;if(!(t.layerModelNeedUpdate||s==="basemap")){i.scaleOptions=t.getScaleOptions();var u=a.getLayerStyleAttributes();u&&i.getSourceData(t,function(l){var f=l.dataArray;if(f.length!==0){var h=u.filter(function(p){return p.needRescale});h.length&&i.caculateScalesForAttributes(h,f)}})}})}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,n){var i=this;t.forEach(function(a){if(a.scale){var o=a.scale;o.names=i.parseFields(a.scale.field||[]);var s=[];o.names.forEach(function(u){var l;s.push(i.createScale(u,a.name,(l=a.scale)===null||l===void 0?void 0:l.values,n))}),s.some(function(u){return u.type===Qm.VARIABLE})?(o.type=Qm.VARIABLE,s.forEach(function(u){var l;if(!o.callback&&o.values!=="text")switch((l=u.option)===null||l===void 0?void 0:l.type){case Lo.LOG:case Lo.LINEAR:case Lo.POWER:if(o.values&&o.values.length>2){var f=u.scale.ticks(o.values.length);u.scale.domain(f)}o.values?u.scale.range(o.values):u.scale.range(u.option.domain);break;case Lo.QUANTILE:case Lo.QUANTIZE:case Lo.THRESHOLD:u.scale.range(o.values);break;case Lo.CAT:o.values?u.scale.range(o.values):u.scale.range(u.option.domain);break;case Lo.DIVERGING:case Lo.SEQUENTIAL:u.scale.interpolator(_0e(o.values));break}if(o.values==="text"){var h;u.scale.range((h=u.option)===null||h===void 0?void 0:h.domain)}})):(o.type=Qm.CONSTANT,o.defaultValues=s.map(function(u,l){return u.scale(o.names[l])})),o.scalers=s.map(function(u){return{field:u.field,func:u.scale,option:u.option}}),a.needRescale=!1}})}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:Kt.exports.isString(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,n,i,a){var o,s,u=this.scaleOptions[n]&&((o=this.scaleOptions[n])===null||o===void 0?void 0:o.field)===t?this.scaleOptions[n]:this.scaleOptions[t],l={field:t,scale:void 0,type:Qm.VARIABLE,option:u};if(!a||!a.length)return u&&u.type?l.scale=this.createDefaultScale(u):(l.scale=AL([t]),l.type=Qm.CONSTANT),l;var f=(s=a.find(function(v){return!Kt.exports.isNil(v[t])}))===null||s===void 0?void 0:s[t];if(this.isNumber(t)||Kt.exports.isNil(f)&&!u)l.scale=AL([t]),l.type=Qm.CONSTANT;else{var h=u&&u.type||this.getDefaultType(f);i==="text"&&(h=Lo.CAT);var p=this.createScaleConfig(h,t,u,a);l.scale=this.createDefaultScale(p),l.option=p}return l}},{key:"getDefaultType",value:function(t){var n=Lo.LINEAR;return typeof t=="string"&&(n=nrt.test(t)?Lo.TIME:Lo.CAT),n}},{key:"createScaleConfig",value:function(t,n,i,a){var o={type:t},s=(a==null?void 0:a.map(function(f){return f[n]}))||[];if(i!=null&&i.domain)o.domain=i==null?void 0:i.domain;else if(t!==Lo.CAT&&t!==Lo.QUANTILE&&t!==Lo.DIVERGING)o.domain=oW(s);else if(t===Lo.CAT)o.domain=Kt.exports.uniq(s);else if(t===Lo.QUANTILE)o.domain=s;else if(t===Lo.DIVERGING){var u=oW(s),l=(i==null?void 0:i.neutral)!==void 0?i==null?void 0:i.neutral:(u[0]+u[1])/2;o.domain=[u[0],l,u[1]]}return Et(Et({},o),i)}},{key:"createDefaultScale",value:function(t){var n=t.type,i=t.domain,a=t.unknown,o=t.clamp,s=t.nice,u=irt[n]();return i&&u.domain&&u.domain(i),a&&u.unknown(a),o!==void 0&&u.clamp&&u.clamp(o),s!==void 0&&u.nice&&u.nice(s),u}}]),e}())||RW),OW,FW,ort=(OW=Ri(),OW(FW=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var n=t.animateStatus;n&&t.models.forEach(function(i){i.addUniforms(Et({},t.layerModel.getAnimateUniforms()))})})}}]),e}())||FW),DW,BW,srt=(DW=Ri(),DW(BW=function(){function e(){st(this,e)}return ot(e,[{key:"initLayerModel",value:function(t){t.prepareBuildModel(),t.buildModels(),t.styleNeedUpdate=!1}},{key:"prepareLayerModel",value:function(t){var n;t.prepareBuildModel(),(n=t.layerModel)===null||n===void 0||n.clearModels(),t.buildModels(),t.layerModelNeedUpdate=!1}},{key:"apply",value:function(t){var n=this;t.hooks.init.tap("LayerModelPlugin",function(){t.inited=!0,t.modelLoaded=!1;var i=t.getSource();i.inited&&n.initLayerModel(t)}),t.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var i=t.getSource();return t.modelLoaded=!1,i.inited?n.prepareLayerModel(t):i.once("update",function(){n.prepareLayerModel(t)}),!1})}}]),e}())||BW),NW,zW,urt=(NW=Ri(),NW(zW=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",function(){t.updateLayerConfig({});var n=t.getLayerConfig(),i=n.autoFit,a=n.fitBoundsOptions;i&&setTimeout(function(){t.fitBounds(a)},100)})}}]),e}())||zW),$W,UW,lrt=["type"],VW={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},crt={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},frt={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},hrt={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function prt(e){var r={u_DirectionalLights:new Array(3).fill(Et({},frt)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Et({},hrt)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[crt]),e.forEach(function(t){var n=t.type,i=n===void 0?"directional":n,a=oc(t,lrt),o=VW[i].lights,s=VW[i].num,u=r[s];r[o][u]=Et(Et({},r[o][u]),a),r[s]++}),r}var drt=($W=Ri(),$W(UW=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",function(){var n=t.getLayerConfig(),i=n.enableLighting;i&&t.models.forEach(function(a){return a.addUniforms(Et({},prt()))})})}}]),e}())||UW),GW,HW,vrt=(GW=Ri(),GW(HW=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t,n){var i=this,a=n.rendererService,o=n.postProcessingPassFactory,s=n.normalPassFactory;t.hooks.init.tap("MultiPassRendererPlugin",function(){var u=t.getLayerConfig(),l=u.enableMultiPassRenderer,f=u.passes,h=f===void 0?[]:f;i.enabled=!!l&&t.getLayerConfig().enableMultiPassRenderer!==!1,i.enabled&&(t.multiPassRenderer=bie(t,h,o,s),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(i.enabled){var u=a.getViewportSize(),l=u.width,f=u.height;t.multiPassRenderer.resize(l,f)}})}}]),e}())||HW),jW,WW,DT={NONE:0,ENCODE:1,HIGHLIGHT:2},grt=(jW=Ri(),jW(WW=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t,n){var i=n.styleAttributeService;t.hooks.init.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),o=a.enablePicking;i.registerStyleAttribute({name:"pickingColor",type:Ar.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:K.FLOAT},size:3,update:function(u){var l=u.id;return o?Sy(l):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),o=a.enablePicking;o&&t.isVisible()&&t.models.forEach(function(s){return s.addUniforms({u_PickingStage:DT.ENCODE})})}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var a=t.getLayerConfig(),o=a.enablePicking;o&&t.isVisible()&&t.models.forEach(function(s){return s.addUniforms({u_PickingStage:DT.HIGHLIGHT})})}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",function(a){var o=t.getLayerConfig(),s=o.highlightColor,u=o.activeMix,l=u===void 0?0:u,f=typeof s=="string"?Sa(s):s||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:dy(new Uint8Array(a))}),t.models.forEach(function(h){return h.addUniforms({u_PickingStage:DT.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:f.map(function(p){return p*255}),u_activeMix:l})})}),t.hooks.beforeSelect.tap("PixelPickingPlugin",function(a){var o=t.getLayerConfig(),s=o.selectColor,u=o.selectMix,l=u===void 0?0:u,f=typeof s=="string"?Sa(s):s||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:dy(new Uint8Array(a))}),t.models.forEach(function(h){return h.addUniforms({u_PickingStage:DT.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:f.map(function(p){return p*255}),u_activeMix:l,u_CurrentSelectedId:a,u_SelectColor:f.map(function(p){return p*255}),u_EnableSelect:1})})})}}]),e}())||WW),XW,YW,mrt=(XW=Ri(),XW(YW=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t,n){var i=this,a=n.styleAttributeService;t.hooks.init.tap("RegisterStyleAttributePlugin",function(){zXe(t)||i.registerBuiltinAttributes(a,t)})}},{key:"registerBuiltinAttributes",value:function(t,n){if(n.type==="MaskLayer"){this.registerPositionAttribute(t);return}var i=n.getLayerConfig(),a=i.usage;if(a==="basemap"){this.registerPositionAttribute(t);return}if(n.isTileLayer){this.registerPositionAttribute(t),this.registerColorAttribute(t);return}this.registerPositionAttribute(t),this.registerFilterAttribute(t),this.registerColorAttribute(t),this.registerVertexIdAttribute(t)}},{key:"registerPositionAttribute",value:function(t){t.registerStyleAttribute({name:"position",type:Ar.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:K.FLOAT},size:3,update:function(i,a,o){return o.length===2?[o[0],o[1],0]:[o[0],o[1],o[2]]}}})}},{key:"registerFilterAttribute",value:function(t){t.registerStyleAttribute({name:"filter",type:Ar.Attribute,descriptor:{name:"filter",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(i){var a=i.filter;return a?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(t){t.registerStyleAttribute({name:"color",type:Ar.Attribute,descriptor:{name:"a_Color",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:4,update:function(i){var a=i.color;return!a||!a.length?[1,1,1,1]:a}}})}},{key:"registerVertexIdAttribute",value:function(t){t.registerStyleAttribute({name:"vertexId",type:Ar.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:K.DYNAMIC_DRAW,data:[],type:K.FLOAT},size:1,update:function(i,a){return[a]}}})}}]),e}())||YW),ZW,qW,KW,QW,JW,eX,Mb,tX,rX,nX,iX,yrt=(ZW=Ri(),qW=ba(Mt.ICameraService),KW=ba(Mt.ICoordinateSystemService),QW=ba(Mt.IRendererService),JW=ba(Mt.IMapService),ZW(eX=(Mb=function(){function e(){st(this,e),ua(this,"cameraService",tX,this),ua(this,"coordinateSystemService",rX,this),ua(this,"rendererService",nX,this),ua(this,"mapService",iX,this)}return ot(e,[{key:"apply",value:function(t){var n=this,i=this.mapService.version,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o=[0,0];t.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var s=t.getLayerConfig().tileOrigin;n.coordinateSystemService.refresh(s),i==="GAODE2.x"&&(n.setLayerCenter(t),a=n.mapService.map.customCoords.getMVPMatrix(),o=n.mapService.getCustomCoordCenter());var u=n.rendererService.getViewportSize(),l=u.width,f=u.height;t.models.forEach(function(h){var p;h.addUniforms((p={},X(p,C0.ProjectionMatrix,n.cameraService.getProjectionMatrix()),X(p,C0.ViewMatrix,n.cameraService.getViewMatrix()),X(p,C0.ViewProjectionMatrix,n.cameraService.getViewProjectionMatrix()),X(p,C0.Zoom,n.cameraService.getZoom()),X(p,C0.ZoomScale,n.cameraService.getZoomScale()),X(p,C0.FocalDistance,n.cameraService.getFocalDistance()),X(p,C0.CameraPosition,n.cameraService.getCameraPosition()),X(p,w0.CoordinateSystem,n.coordinateSystemService.getCoordinateSystem()),X(p,w0.ViewportCenter,n.coordinateSystemService.getViewportCenter()),X(p,w0.ViewportCenterProjection,n.coordinateSystemService.getViewportCenterProjection()),X(p,w0.PixelsPerDegree,n.coordinateSystemService.getPixelsPerDegree()),X(p,w0.PixelsPerDegree2,n.coordinateSystemService.getPixelsPerDegree2()),X(p,w0.PixelsPerMeter,n.coordinateSystemService.getPixelsPerMeter()),X(p,w0.Mvp,a),X(p,"u_SceneCenterMKT",o),X(p,"u_ViewportSize",[l,f]),X(p,"u_ModelMatrix",n.cameraService.getModelMatrix()),X(p,"u_DevicePixelRatio",Hn.devicePixelRatio),X(p,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),X(p,"u_shaderPick",Number(t.getShaderPickStat())),p))})})}},{key:"setLayerCenter",value:function(t){t.coordCenter===void 0&&(t.coordCenter=t.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(t.coordCenter)}}]),e}(),tX=ia(Mb.prototype,"cameraService",[qW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rX=ia(Mb.prototype,"coordinateSystemService",[KW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nX=ia(Mb.prototype,"rendererService",[QW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iX=ia(Mb.prototype,"mapService",[JW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mb))||eX),aX,oX,_rt=(aX=Ri(),aX(oX=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",function(){t.layerModel&&t.layerModel.needUpdate()})}}]),e}())||oX),sX,uX,xrt=(sX=Ri(),sX(uX=function(){function e(){st(this,e)}return ot(e,[{key:"apply",value:function(t,n){var i=this,a=n.styleAttributeService;t.hooks.init.tap("UpdateStyleAttributePlugin",function(){i.initStyleAttribute(t,{styleAttributeService:a})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){var o=t.getLayerConfig(),s=o.usage;t.layerModelNeedUpdate||t.tileLayer||s==="basemap"||t.modelLoaded&&i.updateStyleAttribute(t,{styleAttributeService:a})})}},{key:"updateStyleAttribute",value:function(t,n){var i=n.styleAttributeService,a=i.getLayerStyleAttributes()||[],o=i.getLayerStyleAttribute("filter");if(o&&o.needRegenerateVertices){t.layerModelNeedUpdate=!0,a.forEach(function(s){return s.needRegenerateVertices=!1});return}a.filter(function(s){return s.needRegenerateVertices}).forEach(function(s){i.updateAttributeByFeatureRange(s.name,t.getEncodedData(),s.featureRange.startIndex,s.featureRange.endIndex,t),s.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(t,n){var i=n.styleAttributeService,a=i.getLayerStyleAttributes()||[];a.filter(function(o){return o.needRegenerateVertices}).forEach(function(o){i.updateAttributeByFeatureRange(o.name,t.getEncodedData(),o.featureRange.startIndex,o.featureRange.endIndex),o.needRegenerateVertices=!1})}}]),e}())||uX);Pc.bind(Mt.ILayerPlugin).to(oet).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(mrt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(art).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(aet).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(urt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(xrt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(_rt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(vrt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(yrt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(ort).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(drt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(grt).inRequestScope();Pc.bind(Mt.ILayerPlugin).to(srt).inRequestScope();var brt=Object.freeze(Object.defineProperty({__proto__:null,BaseLayer:$f,BaseModel:qi,PointLayer:SQe,PolygonLayer:rJe,LineLayer:MKe,CityBuildingLayer:_We,GeometryLayer:zWe,CanvasLayer:qje,ImageLayer:Lie,RasterLayer:fJe,HeatmapLayer:dXe,EarthLayer:kJe,WindLayer:tet,MaskLayer:iae,TileDebugLayer:iet,get lineStyleType(){return OD},get LinearDir(){return u1},get TextureBlend(){return _L},get CanvasUpdateType(){return k0}},Symbol.toStringTag,{value:"Module"})),zae={exports:{}},UO={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},VO="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",wrt={5:VO,"5module":VO+" export import",6:VO+" const class extends export import super"},Crt=/^in(stanceof)?$/,E6="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",$ae="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",Ert=new RegExp("["+E6+"]"),Srt=new RegExp("["+E6+$ae+"]");E6=$ae=null;var Uae=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],Art=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function ZD(e,r){for(var t=65536,n=0;n<r.length;n+=2){if(t+=r[n],t>e)return!1;if(t+=r[n+1],t>=e)return!0}}function c_(e,r){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&Ert.test(String.fromCharCode(e)):r===!1?!1:ZD(e,Uae)}function I2(e,r){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&Srt.test(String.fromCharCode(e)):r===!1?!1:ZD(e,Uae)||ZD(e,Art)}var Ho=function(r,t){t===void 0&&(t={}),this.label=r,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function Ld(e,r){return new Ho(e,{beforeExpr:!0,binop:r})}var Id={beforeExpr:!0},Hp={startsExpr:!0},S6={};function _o(e,r){return r===void 0&&(r={}),r.keyword=e,S6[e]=new Ho(e,r)}var Le={num:new Ho("num",Hp),regexp:new Ho("regexp",Hp),string:new Ho("string",Hp),name:new Ho("name",Hp),eof:new Ho("eof"),bracketL:new Ho("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Ho("]"),braceL:new Ho("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Ho("}"),parenL:new Ho("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Ho(")"),comma:new Ho(",",Id),semi:new Ho(";",Id),colon:new Ho(":",Id),dot:new Ho("."),question:new Ho("?",Id),questionDot:new Ho("?."),arrow:new Ho("=>",Id),template:new Ho("template"),invalidTemplate:new Ho("invalidTemplate"),ellipsis:new Ho("...",Id),backQuote:new Ho("`",Hp),dollarBraceL:new Ho("${",{beforeExpr:!0,startsExpr:!0}),eq:new Ho("=",{beforeExpr:!0,isAssign:!0}),assign:new Ho("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Ho("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Ho("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Ld("||",1),logicalAND:Ld("&&",2),bitwiseOR:Ld("|",3),bitwiseXOR:Ld("^",4),bitwiseAND:Ld("&",5),equality:Ld("==/!=/===/!==",6),relational:Ld("</>/<=/>=",7),bitShift:Ld("<</>>/>>>",8),plusMin:new Ho("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Ld("%",10),star:Ld("*",10),slash:Ld("/",10),starstar:new Ho("**",{beforeExpr:!0}),coalesce:Ld("??",1),_break:_o("break"),_case:_o("case",Id),_catch:_o("catch"),_continue:_o("continue"),_debugger:_o("debugger"),_default:_o("default",Id),_do:_o("do",{isLoop:!0,beforeExpr:!0}),_else:_o("else",Id),_finally:_o("finally"),_for:_o("for",{isLoop:!0}),_function:_o("function",Hp),_if:_o("if"),_return:_o("return",Id),_switch:_o("switch"),_throw:_o("throw",Id),_try:_o("try"),_var:_o("var"),_const:_o("const"),_while:_o("while",{isLoop:!0}),_with:_o("with"),_new:_o("new",{beforeExpr:!0,startsExpr:!0}),_this:_o("this",Hp),_super:_o("super",Hp),_class:_o("class",Hp),_extends:_o("extends",Id),_export:_o("export"),_import:_o("import",Hp),_null:_o("null",Hp),_true:_o("true",Hp),_false:_o("false",Hp),_in:_o("in",{beforeExpr:!0,binop:7}),_instanceof:_o("instanceof",{beforeExpr:!0,binop:7}),_typeof:_o("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:_o("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:_o("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},ev=/\r\n?|\n|\u2028|\u2029/,QE=new RegExp(ev.source,"g");function kS(e,r){return e===10||e===13||!r&&(e===8232||e===8233)}var Vae=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Dd=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Gae=Object.prototype,Trt=Gae.hasOwnProperty,Mrt=Gae.toString;function Rk(e,r){return Trt.call(e,r)}var lX=Array.isArray||function(e){return Mrt.call(e)==="[object Array]"};function Bx(e){return new RegExp("^(?:"+e.replace(/ /g,"|")+")$")}var JE=function(r,t){this.line=r,this.column=t};JE.prototype.offset=function(r){return new JE(this.line,this.column+r)};var Ok=function(r,t,n){this.start=t,this.end=n,r.sourceFile!==null&&(this.source=r.sourceFile)};function Hae(e,r){for(var t=1,n=0;;){QE.lastIndex=n;var i=QE.exec(e);if(i&&i.index<r)++t,n=i.index+i[0].length;else return new JE(t,r-n)}}var qD={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Lrt(e){var r={};for(var t in qD)r[t]=e&&Rk(e,t)?e[t]:qD[t];if(r.ecmaVersion>=2015&&(r.ecmaVersion-=2009),r.allowReserved==null&&(r.allowReserved=r.ecmaVersion<5),lX(r.onToken)){var n=r.onToken;r.onToken=function(i){return n.push(i)}}return lX(r.onComment)&&(r.onComment=Irt(r,r.onComment)),r}function Irt(e,r){return function(t,n,i,a,o,s){var u={type:t?"Block":"Line",value:n,start:i,end:a};e.locations&&(u.loc=new Ok(this,o,s)),e.ranges&&(u.range=[i,a]),r.push(u)}}var eS=1,PS=2,A6=eS|PS,jae=4,Wae=8,Xae=16,Yae=32,Zae=64,qae=128;function T6(e,r){return PS|(e?jae:0)|(r?Wae:0)}var cX=0,M6=1,gy=2,Kae=3,Qae=4,Jae=5,$l=function(r,t,n){this.options=r=Lrt(r),this.sourceFile=r.sourceFile,this.keywords=Bx(wrt[r.ecmaVersion>=6?6:r.sourceType==="module"?"5module":5]);var i="";if(r.allowReserved!==!0){for(var a=r.ecmaVersion;!(i=UO[a]);a--);r.sourceType==="module"&&(i+=" await")}this.reservedWords=Bx(i);var o=(i?i+" ":"")+UO.strict;this.reservedWordsStrict=Bx(o),this.reservedWordsStrictBind=Bx(o+" "+UO.strictBind),this.input=String(t),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf(`
`,n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(ev).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Le.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=r.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&r.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(eS),this.regexpState=null},I1={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};$l.prototype.parse=function(){var r=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(r)};I1.inFunction.get=function(){return(this.currentVarScope().flags&PS)>0};I1.inGenerator.get=function(){return(this.currentVarScope().flags&Wae)>0};I1.inAsync.get=function(){return(this.currentVarScope().flags&jae)>0};I1.allowSuper.get=function(){return(this.currentThisScope().flags&Zae)>0};I1.allowDirectSuper.get=function(){return(this.currentThisScope().flags&qae)>0};I1.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};$l.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&PS)>0};$l.extend=function(){for(var r=[],t=arguments.length;t--;)r[t]=arguments[t];for(var n=this,i=0;i<r.length;i++)n=r[i](n);return n};$l.parse=function(r,t){return new this(t,r).parse()};$l.parseExpressionAt=function(r,t,n){var i=new this(n,r,t);return i.nextToken(),i.parseExpression()};$l.tokenizer=function(r,t){return new this(t,r)};Object.defineProperties($l.prototype,I1);var ph=$l.prototype,krt=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;ph.strictDirective=function(e){for(;;){Dd.lastIndex=e,e+=Dd.exec(this.input)[0].length;var r=krt.exec(this.input.slice(e));if(!r)return!1;if((r[1]||r[2])==="use strict"){Dd.lastIndex=e+r[0].length;var t=Dd.exec(this.input),n=t.index+t[0].length,i=this.input.charAt(n);return i===";"||i==="}"||ev.test(t[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||i==="!"&&this.input.charAt(n+1)==="=")}e+=r[0].length,Dd.lastIndex=e,e+=Dd.exec(this.input)[0].length,this.input[e]===";"&&e++}};ph.eat=function(e){return this.type===e?(this.next(),!0):!1};ph.isContextual=function(e){return this.type===Le.name&&this.value===e&&!this.containsEsc};ph.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};ph.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};ph.canInsertSemicolon=function(){return this.type===Le.eof||this.type===Le.braceR||ev.test(this.input.slice(this.lastTokEnd,this.start))};ph.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};ph.semicolon=function(){!this.eat(Le.semi)&&!this.insertSemicolon()&&this.unexpected()};ph.afterTrailingComma=function(e,r){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),r||this.next(),!0};ph.expect=function(e){this.eat(e)||this.unexpected()};ph.unexpected=function(e){this.raise(e!=null?e:this.start,"Unexpected token")};function Fk(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}ph.checkPatternErrors=function(e,r){if(!!e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var t=r?e.parenthesizedAssign:e.parenthesizedBind;t>-1&&this.raiseRecoverable(t,"Parenthesized pattern")}};ph.checkExpressionErrors=function(e,r){if(!e)return!1;var t=e.shorthandAssign,n=e.doubleProto;if(!r)return t>=0||n>=0;t>=0&&this.raise(t,"Shorthand property assignments are valid only in destructuring patterns"),n>=0&&this.raiseRecoverable(n,"Redefinition of __proto__ property")};ph.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};ph.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var Aa=$l.prototype;Aa.parseTopLevel=function(e){var r={};for(e.body||(e.body=[]);this.type!==Le.eof;){var t=this.parseStatement(null,!0,r);e.body.push(t)}if(this.inModule)for(var n=0,i=Object.keys(this.undefinedExports);n<i.length;n+=1){var a=i[n];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var L6={kind:"loop"},Prt={kind:"switch"};Aa.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Dd.lastIndex=this.pos;var r=Dd.exec(this.input),t=this.pos+r[0].length,n=this.input.charCodeAt(t);if(n===91)return!0;if(e)return!1;if(n===123)return!0;if(c_(n,!0)){for(var i=t+1;I2(this.input.charCodeAt(i),!0);)++i;var a=this.input.slice(t,i);if(!Crt.test(a))return!0}return!1};Aa.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Dd.lastIndex=this.pos;var e=Dd.exec(this.input),r=this.pos+e[0].length;return!ev.test(this.input.slice(this.pos,r))&&this.input.slice(r,r+8)==="function"&&(r+8===this.input.length||!I2(this.input.charAt(r+8)))};Aa.parseStatement=function(e,r,t){var n=this.type,i=this.startNode(),a;switch(this.isLet(e)&&(n=Le._var,a="let"),n){case Le._break:case Le._continue:return this.parseBreakContinueStatement(i,n.keyword);case Le._debugger:return this.parseDebuggerStatement(i);case Le._do:return this.parseDoStatement(i);case Le._for:return this.parseForStatement(i);case Le._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(i,!1,!e);case Le._class:return e&&this.unexpected(),this.parseClass(i,!0);case Le._if:return this.parseIfStatement(i);case Le._return:return this.parseReturnStatement(i);case Le._switch:return this.parseSwitchStatement(i);case Le._throw:return this.parseThrowStatement(i);case Le._try:return this.parseTryStatement(i);case Le._const:case Le._var:return a=a||this.value,e&&a!=="var"&&this.unexpected(),this.parseVarStatement(i,a);case Le._while:return this.parseWhileStatement(i);case Le._with:return this.parseWithStatement(i);case Le.braceL:return this.parseBlock(!0,i);case Le.semi:return this.parseEmptyStatement(i);case Le._export:case Le._import:if(this.options.ecmaVersion>10&&n===Le._import){Dd.lastIndex=this.pos;var o=Dd.exec(this.input),s=this.pos+o[0].length,u=this.input.charCodeAt(s);if(u===40||u===46)return this.parseExpressionStatement(i,this.parseExpression())}return this.options.allowImportExportEverywhere||(r||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),n===Le._import?this.parseImport(i):this.parseExport(i,t);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(i,!0,!e);var l=this.value,f=this.parseExpression();return n===Le.name&&f.type==="Identifier"&&this.eat(Le.colon)?this.parseLabeledStatement(i,l,f,e):this.parseExpressionStatement(i,f)}};Aa.parseBreakContinueStatement=function(e,r){var t=r==="break";this.next(),this.eat(Le.semi)||this.insertSemicolon()?e.label=null:this.type!==Le.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var n=0;n<this.labels.length;++n){var i=this.labels[n];if((e.label==null||i.name===e.label.name)&&(i.kind!=null&&(t||i.kind==="loop")||e.label&&t))break}return n===this.labels.length&&this.raise(e.start,"Unsyntactic "+r),this.finishNode(e,t?"BreakStatement":"ContinueStatement")};Aa.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};Aa.parseDoStatement=function(e){return this.next(),this.labels.push(L6),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(Le._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Le.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};Aa.parseForStatement=function(e){this.next();var r=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(L6),this.enterScope(0),this.expect(Le.parenL),this.type===Le.semi)return r>-1&&this.unexpected(r),this.parseFor(e,null);var t=this.isLet();if(this.type===Le._var||this.type===Le._const||t){var n=this.startNode(),i=t?"let":this.value;return this.next(),this.parseVar(n,!0,i),this.finishNode(n,"VariableDeclaration"),(this.type===Le._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&n.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===Le._in?r>-1&&this.unexpected(r):e.await=r>-1),this.parseForIn(e,n)):(r>-1&&this.unexpected(r),this.parseFor(e,n))}var a=new Fk,o=this.parseExpression(!0,a);return this.type===Le._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===Le._in?r>-1&&this.unexpected(r):e.await=r>-1),this.toAssignable(o,!1,a),this.checkLVal(o),this.parseForIn(e,o)):(this.checkExpressionErrors(a,!0),r>-1&&this.unexpected(r),this.parseFor(e,o))};Aa.parseFunctionStatement=function(e,r,t){return this.next(),this.parseFunction(e,KC|(t?0:KD),!1,r)};Aa.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(Le._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};Aa.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Le.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};Aa.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(Le.braceL),this.labels.push(Prt),this.enterScope(0);for(var r,t=!1;this.type!==Le.braceR;)if(this.type===Le._case||this.type===Le._default){var n=this.type===Le._case;r&&this.finishNode(r,"SwitchCase"),e.cases.push(r=this.startNode()),r.consequent=[],this.next(),n?r.test=this.parseExpression():(t&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),t=!0,r.test=null),this.expect(Le.colon)}else r||this.unexpected(),r.consequent.push(this.parseStatement(null));return this.exitScope(),r&&this.finishNode(r,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};Aa.parseThrowStatement=function(e){return this.next(),ev.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var Rrt=[];Aa.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===Le._catch){var r=this.startNode();if(this.next(),this.eat(Le.parenL)){r.param=this.parseBindingAtom();var t=r.param.type==="Identifier";this.enterScope(t?Yae:0),this.checkLVal(r.param,t?Qae:gy),this.expect(Le.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),r.param=null,this.enterScope(0);r.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(r,"CatchClause")}return e.finalizer=this.eat(Le._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};Aa.parseVarStatement=function(e,r){return this.next(),this.parseVar(e,!1,r),this.semicolon(),this.finishNode(e,"VariableDeclaration")};Aa.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(L6),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};Aa.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};Aa.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};Aa.parseLabeledStatement=function(e,r,t,n){for(var i=0,a=this.labels;i<a.length;i+=1){var o=a[i];o.name===r&&this.raise(t.start,"Label '"+r+"' is already declared")}for(var s=this.type.isLoop?"loop":this.type===Le._switch?"switch":null,u=this.labels.length-1;u>=0;u--){var l=this.labels[u];if(l.statementStart===e.start)l.statementStart=this.start,l.kind=s;else break}return this.labels.push({name:r,kind:s,statementStart:this.start}),e.body=this.parseStatement(n?n.indexOf("label")===-1?n+"label":n:"label"),this.labels.pop(),e.label=t,this.finishNode(e,"LabeledStatement")};Aa.parseExpressionStatement=function(e,r){return e.expression=r,this.semicolon(),this.finishNode(e,"ExpressionStatement")};Aa.parseBlock=function(e,r,t){for(e===void 0&&(e=!0),r===void 0&&(r=this.startNode()),r.body=[],this.expect(Le.braceL),e&&this.enterScope(0);this.type!==Le.braceR;){var n=this.parseStatement(null);r.body.push(n)}return t&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(r,"BlockStatement")};Aa.parseFor=function(e,r){return e.init=r,this.expect(Le.semi),e.test=this.type===Le.semi?null:this.parseExpression(),this.expect(Le.semi),e.update=this.type===Le.parenR?null:this.parseExpression(),this.expect(Le.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};Aa.parseForIn=function(e,r){var t=this.type===Le._in;return this.next(),r.type==="VariableDeclaration"&&r.declarations[0].init!=null&&(!t||this.options.ecmaVersion<8||this.strict||r.kind!=="var"||r.declarations[0].id.type!=="Identifier")?this.raise(r.start,(t?"for-in":"for-of")+" loop variable declaration may not have an initializer"):r.type==="AssignmentPattern"&&this.raise(r.start,"Invalid left-hand side in for-loop"),e.left=r,e.right=t?this.parseExpression():this.parseMaybeAssign(),this.expect(Le.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,t?"ForInStatement":"ForOfStatement")};Aa.parseVar=function(e,r,t){for(e.declarations=[],e.kind=t;;){var n=this.startNode();if(this.parseVarId(n,t),this.eat(Le.eq)?n.init=this.parseMaybeAssign(r):t==="const"&&!(this.type===Le._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():n.id.type!=="Identifier"&&!(r&&(this.type===Le._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):n.init=null,e.declarations.push(this.finishNode(n,"VariableDeclarator")),!this.eat(Le.comma))break}return e};Aa.parseVarId=function(e,r){e.id=this.parseBindingAtom(),this.checkLVal(e.id,r==="var"?M6:gy,!1)};var KC=1,KD=2,eoe=4;Aa.parseFunction=function(e,r,t,n){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!n)&&(this.type===Le.star&&r&KD&&this.unexpected(),e.generator=this.eat(Le.star)),this.options.ecmaVersion>=8&&(e.async=!!n),r&KC&&(e.id=r&eoe&&this.type!==Le.name?null:this.parseIdent(),e.id&&!(r&KD)&&this.checkLVal(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?M6:gy:Kae));var i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(T6(e.async,e.generator)),r&KC||(e.id=this.type===Le.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,t,!1),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(e,r&KC?"FunctionDeclaration":"FunctionExpression")};Aa.parseFunctionParams=function(e){this.expect(Le.parenL),e.params=this.parseBindingList(Le.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Aa.parseClass=function(e,r){this.next();var t=this.strict;this.strict=!0,this.parseClassId(e,r),this.parseClassSuper(e);var n=this.startNode(),i=!1;for(n.body=[],this.expect(Le.braceL);this.type!==Le.braceR;){var a=this.parseClassElement(e.superClass!==null);a&&(n.body.push(a),a.type==="MethodDefinition"&&a.kind==="constructor"&&(i&&this.raise(a.start,"Duplicate constructor in the same class"),i=!0))}return this.strict=t,this.next(),e.body=this.finishNode(n,"ClassBody"),this.finishNode(e,r?"ClassDeclaration":"ClassExpression")};Aa.parseClassElement=function(e){var r=this;if(this.eat(Le.semi))return null;var t=this.startNode(),n=function(u,l){l===void 0&&(l=!1);var f=r.start,h=r.startLoc;return r.eatContextual(u)?r.type!==Le.parenL&&(!l||!r.canInsertSemicolon())?!0:(t.key&&r.unexpected(),t.computed=!1,t.key=r.startNodeAt(f,h),t.key.name=u,r.finishNode(t.key,"Identifier"),!1):!1};t.kind="method",t.static=n("static");var i=this.eat(Le.star),a=!1;i||(this.options.ecmaVersion>=8&&n("async",!0)?(a=!0,i=this.options.ecmaVersion>=9&&this.eat(Le.star)):n("get")?t.kind="get":n("set")&&(t.kind="set")),t.key||this.parsePropertyName(t);var o=t.key,s=!1;return!t.computed&&!t.static&&(o.type==="Identifier"&&o.name==="constructor"||o.type==="Literal"&&o.value==="constructor")?(t.kind!=="method"&&this.raise(o.start,"Constructor can't have get/set modifier"),i&&this.raise(o.start,"Constructor can't be a generator"),a&&this.raise(o.start,"Constructor can't be an async method"),t.kind="constructor",s=e):t.static&&o.type==="Identifier"&&o.name==="prototype"&&this.raise(o.start,"Classes may not have a static property named prototype"),this.parseClassMethod(t,i,a,s),t.kind==="get"&&t.value.params.length!==0&&this.raiseRecoverable(t.value.start,"getter should have no params"),t.kind==="set"&&t.value.params.length!==1&&this.raiseRecoverable(t.value.start,"setter should have exactly one param"),t.kind==="set"&&t.value.params[0].type==="RestElement"&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params"),t};Aa.parseClassMethod=function(e,r,t,n){return e.value=this.parseMethod(r,t,n),this.finishNode(e,"MethodDefinition")};Aa.parseClassId=function(e,r){this.type===Le.name?(e.id=this.parseIdent(),r&&this.checkLVal(e.id,gy,!1)):(r===!0&&this.unexpected(),e.id=null)};Aa.parseClassSuper=function(e){e.superClass=this.eat(Le._extends)?this.parseExprSubscripts():null};Aa.parseExport=function(e,r){if(this.next(),this.eat(Le.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseIdent(!0),this.checkExport(r,e.exported.name,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==Le.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(Le._default)){this.checkExport(r,"default",this.lastTokStart);var t;if(this.type===Le._function||(t=this.isAsyncFunction())){var n=this.startNode();this.next(),t&&this.next(),e.declaration=this.parseFunction(n,KC|eoe,!1,t)}else if(this.type===Le._class){var i=this.startNode();e.declaration=this.parseClass(i,"nullableID")}else e.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(e,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())e.declaration=this.parseStatement(null),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(r,e.declaration.declarations):this.checkExport(r,e.declaration.id.name,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(r),this.eatContextual("from"))this.type!==Le.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var a=0,o=e.specifiers;a<o.length;a+=1){var s=o[a];this.checkUnreserved(s.local),this.checkLocalExport(s.local)}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};Aa.checkExport=function(e,r,t){!e||(Rk(e,r)&&this.raiseRecoverable(t,"Duplicate export '"+r+"'"),e[r]=!0)};Aa.checkPatternExport=function(e,r){var t=r.type;if(t==="Identifier")this.checkExport(e,r.name,r.start);else if(t==="ObjectPattern")for(var n=0,i=r.properties;n<i.length;n+=1){var a=i[n];this.checkPatternExport(e,a)}else if(t==="ArrayPattern")for(var o=0,s=r.elements;o<s.length;o+=1){var u=s[o];u&&this.checkPatternExport(e,u)}else t==="Property"?this.checkPatternExport(e,r.value):t==="AssignmentPattern"?this.checkPatternExport(e,r.left):t==="RestElement"?this.checkPatternExport(e,r.argument):t==="ParenthesizedExpression"&&this.checkPatternExport(e,r.expression)};Aa.checkVariableExport=function(e,r){if(!!e)for(var t=0,n=r;t<n.length;t+=1){var i=n[t];this.checkPatternExport(e,i.id)}};Aa.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Aa.parseExportSpecifiers=function(e){var r=[],t=!0;for(this.expect(Le.braceL);!this.eat(Le.braceR);){if(t)t=!1;else if(this.expect(Le.comma),this.afterTrailingComma(Le.braceR))break;var n=this.startNode();n.local=this.parseIdent(!0),n.exported=this.eatContextual("as")?this.parseIdent(!0):n.local,this.checkExport(e,n.exported.name,n.exported.start),r.push(this.finishNode(n,"ExportSpecifier"))}return r};Aa.parseImport=function(e){return this.next(),this.type===Le.string?(e.specifiers=Rrt,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===Le.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};Aa.parseImportSpecifiers=function(){var e=[],r=!0;if(this.type===Le.name){var t=this.startNode();if(t.local=this.parseIdent(),this.checkLVal(t.local,gy),e.push(this.finishNode(t,"ImportDefaultSpecifier")),!this.eat(Le.comma))return e}if(this.type===Le.star){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLVal(n.local,gy),e.push(this.finishNode(n,"ImportNamespaceSpecifier")),e}for(this.expect(Le.braceL);!this.eat(Le.braceR);){if(r)r=!1;else if(this.expect(Le.comma),this.afterTrailingComma(Le.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,gy),e.push(this.finishNode(i,"ImportSpecifier"))}return e};Aa.adaptDirectivePrologue=function(e){for(var r=0;r<e.length&&this.isDirectiveCandidate(e[r]);++r)e[r].directive=e[r].expression.raw.slice(1,-1)};Aa.isDirectiveCandidate=function(e){return e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var ky=$l.prototype;ky.toAssignable=function(e,r,t){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",t&&this.checkPatternErrors(t,!0);for(var n=0,i=e.properties;n<i.length;n+=1){var a=i[n];this.toAssignable(a,r),a.type==="RestElement"&&(a.argument.type==="ArrayPattern"||a.argument.type==="ObjectPattern")&&this.raise(a.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,r);break;case"ArrayExpression":e.type="ArrayPattern",t&&this.checkPatternErrors(t,!0),this.toAssignableList(e.elements,r);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,r),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,r);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(e.expression,r,t);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!r)break;default:this.raise(e.start,"Assigning to rvalue")}else t&&this.checkPatternErrors(t,!0);return e};ky.toAssignableList=function(e,r){for(var t=e.length,n=0;n<t;n++){var i=e[n];i&&this.toAssignable(i,r)}if(t){var a=e[t-1];this.options.ecmaVersion===6&&r&&a&&a.type==="RestElement"&&a.argument.type!=="Identifier"&&this.unexpected(a.argument.start)}return e};ky.parseSpread=function(e){var r=this.startNode();return this.next(),r.argument=this.parseMaybeAssign(!1,e),this.finishNode(r,"SpreadElement")};ky.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==Le.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};ky.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Le.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(Le.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case Le.braceL:return this.parseObj(!0)}return this.parseIdent()};ky.parseBindingList=function(e,r,t){for(var n=[],i=!0;!this.eat(e);)if(i?i=!1:this.expect(Le.comma),r&&this.type===Le.comma)n.push(null);else{if(t&&this.afterTrailingComma(e))break;if(this.type===Le.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),n.push(a),this.type===Le.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else{var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),n.push(o)}}return n};ky.parseBindingListItem=function(e){return e};ky.parseMaybeDefault=function(e,r,t){if(t=t||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Le.eq))return t;var n=this.startNodeAt(e,r);return n.left=t,n.right=this.parseMaybeAssign(),this.finishNode(n,"AssignmentPattern")};ky.checkLVal=function(e,r,t){switch(r===void 0&&(r=cX),e.type){case"Identifier":r===gy&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(r?"Binding ":"Assigning to ")+e.name+" in strict mode"),t&&(Rk(t,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),t[e.name]=!0),r!==cX&&r!==Jae&&this.declareName(e.name,r,e.start);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":r&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ObjectPattern":for(var n=0,i=e.properties;n<i.length;n+=1){var a=i[n];this.checkLVal(a,r,t)}break;case"Property":this.checkLVal(e.value,r,t);break;case"ArrayPattern":for(var o=0,s=e.elements;o<s.length;o+=1){var u=s[o];u&&this.checkLVal(u,r,t)}break;case"AssignmentPattern":this.checkLVal(e.left,r,t);break;case"RestElement":this.checkLVal(e.argument,r,t);break;case"ParenthesizedExpression":this.checkLVal(e.expression,r,t);break;default:this.raise(e.start,(r?"Binding":"Assigning to")+" rvalue")}};var za=$l.prototype;za.checkPropClash=function(e,r,t){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var n=e.key,i;switch(n.type){case"Identifier":i=n.name;break;case"Literal":i=String(n.value);break;default:return}var a=e.kind;if(this.options.ecmaVersion>=6){i==="__proto__"&&a==="init"&&(r.proto&&(t?t.doubleProto<0&&(t.doubleProto=n.start):this.raiseRecoverable(n.start,"Redefinition of __proto__ property")),r.proto=!0);return}i="$"+i;var o=r[i];if(o){var s;a==="init"?s=this.strict&&o.init||o.get||o.set:s=o.init||o[a],s&&this.raiseRecoverable(n.start,"Redefinition of property")}else o=r[i]={init:!1,get:!1,set:!1};o[a]=!0}};za.parseExpression=function(e,r){var t=this.start,n=this.startLoc,i=this.parseMaybeAssign(e,r);if(this.type===Le.comma){var a=this.startNodeAt(t,n);for(a.expressions=[i];this.eat(Le.comma);)a.expressions.push(this.parseMaybeAssign(e,r));return this.finishNode(a,"SequenceExpression")}return i};za.parseMaybeAssign=function(e,r,t){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var n=!1,i=-1,a=-1;r?(i=r.parenthesizedAssign,a=r.trailingComma,r.parenthesizedAssign=r.trailingComma=-1):(r=new Fk,n=!0);var o=this.start,s=this.startLoc;(this.type===Le.parenL||this.type===Le.name)&&(this.potentialArrowAt=this.start);var u=this.parseMaybeConditional(e,r);if(t&&(u=t.call(this,u,o,s)),this.type.isAssign){var l=this.startNodeAt(o,s);return l.operator=this.value,l.left=this.type===Le.eq?this.toAssignable(u,!1,r):u,n||(r.parenthesizedAssign=r.trailingComma=r.doubleProto=-1),r.shorthandAssign>=l.left.start&&(r.shorthandAssign=-1),this.checkLVal(u),this.next(),l.right=this.parseMaybeAssign(e),this.finishNode(l,"AssignmentExpression")}else n&&this.checkExpressionErrors(r,!0);return i>-1&&(r.parenthesizedAssign=i),a>-1&&(r.trailingComma=a),u};za.parseMaybeConditional=function(e,r){var t=this.start,n=this.startLoc,i=this.parseExprOps(e,r);if(this.checkExpressionErrors(r))return i;if(this.eat(Le.question)){var a=this.startNodeAt(t,n);return a.test=i,a.consequent=this.parseMaybeAssign(),this.expect(Le.colon),a.alternate=this.parseMaybeAssign(e),this.finishNode(a,"ConditionalExpression")}return i};za.parseExprOps=function(e,r){var t=this.start,n=this.startLoc,i=this.parseMaybeUnary(r,!1);return this.checkExpressionErrors(r)||i.start===t&&i.type==="ArrowFunctionExpression"?i:this.parseExprOp(i,t,n,-1,e)};za.parseExprOp=function(e,r,t,n,i){var a=this.type.binop;if(a!=null&&(!i||this.type!==Le._in)&&a>n){var o=this.type===Le.logicalOR||this.type===Le.logicalAND,s=this.type===Le.coalesce;s&&(a=Le.logicalAND.binop);var u=this.value;this.next();var l=this.start,f=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1),l,f,a,i),p=this.buildBinary(r,t,e,h,u,o||s);return(o&&this.type===Le.coalesce||s&&(this.type===Le.logicalOR||this.type===Le.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(p,r,t,n,i)}return e};za.buildBinary=function(e,r,t,n,i,a){var o=this.startNodeAt(e,r);return o.left=t,o.operator=i,o.right=n,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")};za.parseMaybeUnary=function(e,r){var t=this.start,n=this.startLoc,i;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))i=this.parseAwait(),r=!0;else if(this.type.prefix){var a=this.startNode(),o=this.type===Le.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),o?this.checkLVal(a.argument):this.strict&&a.operator==="delete"&&a.argument.type==="Identifier"?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):r=!0,i=this.finishNode(a,o?"UpdateExpression":"UnaryExpression")}else{if(i=this.parseExprSubscripts(e),this.checkExpressionErrors(e))return i;for(;this.type.postfix&&!this.canInsertSemicolon();){var s=this.startNodeAt(t,n);s.operator=this.value,s.prefix=!1,s.argument=i,this.checkLVal(i),this.next(),i=this.finishNode(s,"UpdateExpression")}}return!r&&this.eat(Le.starstar)?this.buildBinary(t,n,i,this.parseMaybeUnary(null,!1),"**",!1):i};za.parseExprSubscripts=function(e){var r=this.start,t=this.startLoc,n=this.parseExprAtom(e);if(n.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return n;var i=this.parseSubscripts(n,r,t);return e&&i.type==="MemberExpression"&&(e.parenthesizedAssign>=i.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=i.start&&(e.parenthesizedBind=-1)),i};za.parseSubscripts=function(e,r,t,n){for(var i=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,a=!1;;){var o=this.parseSubscript(e,r,t,n,i,a);if(o.optional&&(a=!0),o===e||o.type==="ArrowFunctionExpression"){if(a){var s=this.startNodeAt(r,t);s.expression=o,o=this.finishNode(s,"ChainExpression")}return o}e=o}};za.parseSubscript=function(e,r,t,n,i,a){var o=this.options.ecmaVersion>=11,s=o&&this.eat(Le.questionDot);n&&s&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(Le.bracketL);if(u||s&&this.type!==Le.parenL&&this.type!==Le.backQuote||this.eat(Le.dot)){var l=this.startNodeAt(r,t);l.object=e,l.property=u?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),l.computed=!!u,u&&this.expect(Le.bracketR),o&&(l.optional=s),e=this.finishNode(l,"MemberExpression")}else if(!n&&this.eat(Le.parenL)){var f=new Fk,h=this.yieldPos,p=this.awaitPos,v=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var m=this.parseExprList(Le.parenR,this.options.ecmaVersion>=8,!1,f);if(i&&!s&&!this.canInsertSemicolon()&&this.eat(Le.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=h,this.awaitPos=p,this.awaitIdentPos=v,this.parseArrowExpression(this.startNodeAt(r,t),m,!0);this.checkExpressionErrors(f,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=v||this.awaitIdentPos;var x=this.startNodeAt(r,t);x.callee=e,x.arguments=m,o&&(x.optional=s),e=this.finishNode(x,"CallExpression")}else if(this.type===Le.backQuote){(s||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var E=this.startNodeAt(r,t);E.tag=e,E.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(E,"TaggedTemplateExpression")}return e};za.parseExprAtom=function(e){this.type===Le.slash&&this.readRegexp();var r,t=this.potentialArrowAt===this.start;switch(this.type){case Le._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),r=this.startNode(),this.next(),this.type===Le.parenL&&!this.allowDirectSuper&&this.raise(r.start,"super() call outside constructor of a subclass"),this.type!==Le.dot&&this.type!==Le.bracketL&&this.type!==Le.parenL&&this.unexpected(),this.finishNode(r,"Super");case Le._this:return r=this.startNode(),this.next(),this.finishNode(r,"ThisExpression");case Le.name:var n=this.start,i=this.startLoc,a=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&o.name==="async"&&!this.canInsertSemicolon()&&this.eat(Le._function))return this.parseFunction(this.startNodeAt(n,i),0,!1,!0);if(t&&!this.canInsertSemicolon()){if(this.eat(Le.arrow))return this.parseArrowExpression(this.startNodeAt(n,i),[o],!1);if(this.options.ecmaVersion>=8&&o.name==="async"&&this.type===Le.name&&!a)return o=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Le.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(n,i),[o],!0)}return o;case Le.regexp:var s=this.value;return r=this.parseLiteral(s.value),r.regex={pattern:s.pattern,flags:s.flags},r;case Le.num:case Le.string:return this.parseLiteral(this.value);case Le._null:case Le._true:case Le._false:return r=this.startNode(),r.value=this.type===Le._null?null:this.type===Le._true,r.raw=this.type.keyword,this.next(),this.finishNode(r,"Literal");case Le.parenL:var u=this.start,l=this.parseParenAndDistinguishExpression(t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(l)&&(e.parenthesizedAssign=u),e.parenthesizedBind<0&&(e.parenthesizedBind=u)),l;case Le.bracketL:return r=this.startNode(),this.next(),r.elements=this.parseExprList(Le.bracketR,!0,!0,e),this.finishNode(r,"ArrayExpression");case Le.braceL:return this.parseObj(!1,e);case Le._function:return r=this.startNode(),this.next(),this.parseFunction(r,0);case Le._class:return this.parseClass(this.startNode(),!1);case Le._new:return this.parseNew();case Le.backQuote:return this.parseTemplate();case Le._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}};za.parseExprImport=function(){var e=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var r=this.parseIdent(!0);switch(this.type){case Le.parenL:return this.parseDynamicImport(e);case Le.dot:return e.meta=r,this.parseImportMeta(e);default:this.unexpected()}};za.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(Le.parenR)){var r=this.start;this.eat(Le.comma)&&this.eat(Le.parenR)?this.raiseRecoverable(r,"Trailing comma is not allowed in import()"):this.unexpected(r)}return this.finishNode(e,"ImportExpression")};za.parseImportMeta=function(e){this.next();var r=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),r&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};za.parseLiteral=function(e){var r=this.startNode();return r.value=e,r.raw=this.input.slice(this.start,this.end),r.raw.charCodeAt(r.raw.length-1)===110&&(r.bigint=r.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(r,"Literal")};za.parseParenExpression=function(){this.expect(Le.parenL);var e=this.parseExpression();return this.expect(Le.parenR),e};za.parseParenAndDistinguishExpression=function(e){var r=this.start,t=this.startLoc,n,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a=this.start,o=this.startLoc,s=[],u=!0,l=!1,f=new Fk,h=this.yieldPos,p=this.awaitPos,v;for(this.yieldPos=0,this.awaitPos=0;this.type!==Le.parenR;)if(u?u=!1:this.expect(Le.comma),i&&this.afterTrailingComma(Le.parenR,!0)){l=!0;break}else if(this.type===Le.ellipsis){v=this.start,s.push(this.parseParenItem(this.parseRestBinding())),this.type===Le.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else s.push(this.parseMaybeAssign(!1,f,this.parseParenItem));var m=this.start,x=this.startLoc;if(this.expect(Le.parenR),e&&!this.canInsertSemicolon()&&this.eat(Le.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=h,this.awaitPos=p,this.parseParenArrowList(r,t,s);(!s.length||l)&&this.unexpected(this.lastTokStart),v&&this.unexpected(v),this.checkExpressionErrors(f,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=p||this.awaitPos,s.length>1?(n=this.startNodeAt(a,o),n.expressions=s,this.finishNodeAt(n,"SequenceExpression",m,x)):n=s[0]}else n=this.parseParenExpression();if(this.options.preserveParens){var E=this.startNodeAt(r,t);return E.expression=n,this.finishNode(E,"ParenthesizedExpression")}else return n};za.parseParenItem=function(e){return e};za.parseParenArrowList=function(e,r,t){return this.parseArrowExpression(this.startNodeAt(e,r),t)};var Ort=[];za.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode(),r=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(Le.dot)){e.meta=r;var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),t&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(e.start,"'new.target' can only be used in functions"),this.finishNode(e,"MetaProperty")}var n=this.start,i=this.startLoc,a=this.type===Le._import;return e.callee=this.parseSubscripts(this.parseExprAtom(),n,i,!0),a&&e.callee.type==="ImportExpression"&&this.raise(n,"Cannot use new with import()"),this.eat(Le.parenL)?e.arguments=this.parseExprList(Le.parenR,this.options.ecmaVersion>=8,!1):e.arguments=Ort,this.finishNode(e,"NewExpression")};za.parseTemplateElement=function(e){var r=e.isTagged,t=this.startNode();return this.type===Le.invalidTemplate?(r||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),t.value={raw:this.value,cooked:null}):t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),t.tail=this.type===Le.backQuote,this.finishNode(t,"TemplateElement")};za.parseTemplate=function(e){e===void 0&&(e={});var r=e.isTagged;r===void 0&&(r=!1);var t=this.startNode();this.next(),t.expressions=[];var n=this.parseTemplateElement({isTagged:r});for(t.quasis=[n];!n.tail;)this.type===Le.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Le.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(Le.braceR),t.quasis.push(n=this.parseTemplateElement({isTagged:r}));return this.next(),this.finishNode(t,"TemplateLiteral")};za.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===Le.name||this.type===Le.num||this.type===Le.string||this.type===Le.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Le.star)&&!ev.test(this.input.slice(this.lastTokEnd,this.start))};za.parseObj=function(e,r){var t=this.startNode(),n=!0,i={};for(t.properties=[],this.next();!this.eat(Le.braceR);){if(n)n=!1;else if(this.expect(Le.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Le.braceR))break;var a=this.parseProperty(e,r);e||this.checkPropClash(a,i,r),t.properties.push(a)}return this.finishNode(t,e?"ObjectPattern":"ObjectExpression")};za.parseProperty=function(e,r){var t=this.startNode(),n,i,a,o;if(this.options.ecmaVersion>=9&&this.eat(Le.ellipsis))return e?(t.argument=this.parseIdent(!1),this.type===Le.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(t,"RestElement")):(this.type===Le.parenL&&r&&(r.parenthesizedAssign<0&&(r.parenthesizedAssign=this.start),r.parenthesizedBind<0&&(r.parenthesizedBind=this.start)),t.argument=this.parseMaybeAssign(!1,r),this.type===Le.comma&&r&&r.trailingComma<0&&(r.trailingComma=this.start),this.finishNode(t,"SpreadElement"));this.options.ecmaVersion>=6&&(t.method=!1,t.shorthand=!1,(e||r)&&(a=this.start,o=this.startLoc),e||(n=this.eat(Le.star)));var s=this.containsEsc;return this.parsePropertyName(t),!e&&!s&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(t)?(i=!0,n=this.options.ecmaVersion>=9&&this.eat(Le.star),this.parsePropertyName(t,r)):i=!1,this.parsePropertyValue(t,e,n,i,a,o,r,s),this.finishNode(t,"Property")};za.parsePropertyValue=function(e,r,t,n,i,a,o,s){if((t||n)&&this.type===Le.colon&&this.unexpected(),this.eat(Le.colon))e.value=r?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init";else if(this.options.ecmaVersion>=6&&this.type===Le.parenL)r&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(t,n);else if(!r&&!s&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==Le.comma&&this.type!==Le.braceR&&this.type!==Le.eq){(t||n)&&this.unexpected(),e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var u=e.kind==="get"?0:1;if(e.value.params.length!==u){var l=e.value.start;e.kind==="get"?this.raiseRecoverable(l,"getter should have no params"):this.raiseRecoverable(l,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((t||n)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=i),e.kind="init",r?e.value=this.parseMaybeDefault(i,a,e.key):this.type===Le.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(i,a,e.key)):e.value=e.key,e.shorthand=!0):this.unexpected()};za.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(Le.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(Le.bracketR),e.key;e.computed=!1}return e.key=this.type===Le.num||this.type===Le.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};za.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};za.parseMethod=function(e,r,t){var n=this.startNode(),i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(n),this.options.ecmaVersion>=6&&(n.generator=e),this.options.ecmaVersion>=8&&(n.async=!!r),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(T6(r,n.generator)|Zae|(t?qae:0)),this.expect(Le.parenL),n.params=this.parseBindingList(Le.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(n,!1,!0),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(n,"FunctionExpression")};za.parseArrowExpression=function(e,r,t){var n=this.yieldPos,i=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(T6(t,!1)|Xae),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(r,!0),this.parseFunctionBody(e,!0,!1),this.yieldPos=n,this.awaitPos=i,this.awaitIdentPos=a,this.finishNode(e,"ArrowFunctionExpression")};za.parseFunctionBody=function(e,r,t){var n=r&&this.type!==Le.braceL,i=this.strict,a=!1;if(n)e.body=this.parseMaybeAssign(),e.expression=!0,this.checkParams(e,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!i||o)&&(a=this.strictDirective(this.end),a&&o&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var s=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(e,!i&&!a&&!r&&!t&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLVal(e.id,Jae),e.body=this.parseBlock(!1,void 0,a&&!i),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=s}this.exitScope()};za.isSimpleParamList=function(e){for(var r=0,t=e;r<t.length;r+=1){var n=t[r];if(n.type!=="Identifier")return!1}return!0};za.checkParams=function(e,r){for(var t={},n=0,i=e.params;n<i.length;n+=1){var a=i[n];this.checkLVal(a,M6,r?null:t)}};za.parseExprList=function(e,r,t,n){for(var i=[],a=!0;!this.eat(e);){if(a)a=!1;else if(this.expect(Le.comma),r&&this.afterTrailingComma(e))break;var o=void 0;t&&this.type===Le.comma?o=null:this.type===Le.ellipsis?(o=this.parseSpread(n),n&&this.type===Le.comma&&n.trailingComma<0&&(n.trailingComma=this.start)):o=this.parseMaybeAssign(!1,n),i.push(o)}return i};za.checkUnreserved=function(e){var r=e.start,t=e.end,n=e.name;if(this.inGenerator&&n==="yield"&&this.raiseRecoverable(r,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&n==="await"&&this.raiseRecoverable(r,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(n)&&this.raise(r,"Unexpected keyword '"+n+"'"),!(this.options.ecmaVersion<6&&this.input.slice(r,t).indexOf("\\")!==-1)){var i=this.strict?this.reservedWordsStrict:this.reservedWords;i.test(n)&&(!this.inAsync&&n==="await"&&this.raiseRecoverable(r,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(r,"The keyword '"+n+"' is reserved"))}};za.parseIdent=function(e,r){var t=this.startNode();return this.type===Le.name?t.name=this.value:this.type.keyword?(t.name=this.type.keyword,(t.name==="class"||t.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};za.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var r=this.startNode();return this.next(),this.type===Le.semi||this.canInsertSemicolon()||this.type!==Le.star&&!this.type.startsExpr?(r.delegate=!1,r.argument=null):(r.delegate=this.eat(Le.star),r.argument=this.parseMaybeAssign(e)),this.finishNode(r,"YieldExpression")};za.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!1),this.finishNode(e,"AwaitExpression")};var RL=$l.prototype;RL.raise=function(e,r){var t=Hae(this.input,e);r+=" ("+t.line+":"+t.column+")";var n=new SyntaxError(r);throw n.pos=e,n.loc=t,n.raisedAt=this.pos,n};RL.raiseRecoverable=RL.raise;RL.curPosition=function(){if(this.options.locations)return new JE(this.curLine,this.pos-this.lineStart)};var E_=$l.prototype,Frt=function(r){this.flags=r,this.var=[],this.lexical=[],this.functions=[]};E_.enterScope=function(e){this.scopeStack.push(new Frt(e))};E_.exitScope=function(){this.scopeStack.pop()};E_.treatFunctionsAsVarInScope=function(e){return e.flags&PS||!this.inModule&&e.flags&eS};E_.declareName=function(e,r,t){var n=!1;if(r===gy){var i=this.currentScope();n=i.lexical.indexOf(e)>-1||i.functions.indexOf(e)>-1||i.var.indexOf(e)>-1,i.lexical.push(e),this.inModule&&i.flags&eS&&delete this.undefinedExports[e]}else if(r===Qae){var a=this.currentScope();a.lexical.push(e)}else if(r===Kae){var o=this.currentScope();this.treatFunctionsAsVar?n=o.lexical.indexOf(e)>-1:n=o.lexical.indexOf(e)>-1||o.var.indexOf(e)>-1,o.functions.push(e)}else for(var s=this.scopeStack.length-1;s>=0;--s){var u=this.scopeStack[s];if(u.lexical.indexOf(e)>-1&&!(u.flags&Yae&&u.lexical[0]===e)||!this.treatFunctionsAsVarInScope(u)&&u.functions.indexOf(e)>-1){n=!0;break}if(u.var.push(e),this.inModule&&u.flags&eS&&delete this.undefinedExports[e],u.flags&A6)break}n&&this.raiseRecoverable(t,"Identifier '"+e+"' has already been declared")};E_.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};E_.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};E_.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var r=this.scopeStack[e];if(r.flags&A6)return r}};E_.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var r=this.scopeStack[e];if(r.flags&A6&&!(r.flags&Xae))return r}};var I6=function(r,t,n){this.type="",this.start=t,this.end=0,r.options.locations&&(this.loc=new Ok(r,n)),r.options.directSourceFile&&(this.sourceFile=r.options.directSourceFile),r.options.ranges&&(this.range=[t,0])},Dk=$l.prototype;Dk.startNode=function(){return new I6(this,this.start,this.startLoc)};Dk.startNodeAt=function(e,r){return new I6(this,e,r)};function toe(e,r,t,n){return e.type=r,e.end=t,this.options.locations&&(e.loc.end=n),this.options.ranges&&(e.range[1]=t),e}Dk.finishNode=function(e,r){return toe.call(this,e,r,this.lastTokEnd,this.lastTokEndLoc)};Dk.finishNodeAt=function(e,r,t,n){return toe.call(this,e,r,t,n)};var $v=function(r,t,n,i,a){this.token=r,this.isExpr=!!t,this.preserveSpace=!!n,this.override=i,this.generator=!!a},_l={b_stat:new $v("{",!1),b_expr:new $v("{",!0),b_tmpl:new $v("${",!1),p_stat:new $v("(",!1),p_expr:new $v("(",!0),q_tmpl:new $v("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new $v("function",!1),f_expr:new $v("function",!0),f_expr_gen:new $v("function",!0,!1,null,!0),f_gen:new $v("function",!1,!1,null,!0)},Bk=$l.prototype;Bk.initialContext=function(){return[_l.b_stat]};Bk.braceIsBlock=function(e){var r=this.curContext();return r===_l.f_expr||r===_l.f_stat?!0:e===Le.colon&&(r===_l.b_stat||r===_l.b_expr)?!r.isExpr:e===Le._return||e===Le.name&&this.exprAllowed?ev.test(this.input.slice(this.lastTokEnd,this.start)):e===Le._else||e===Le.semi||e===Le.eof||e===Le.parenR||e===Le.arrow?!0:e===Le.braceL?r===_l.b_stat:e===Le._var||e===Le._const||e===Le.name?!1:!this.exprAllowed};Bk.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var r=this.context[e];if(r.token==="function")return r.generator}return!1};Bk.updateContext=function(e){var r,t=this.type;t.keyword&&e===Le.dot?this.exprAllowed=!1:(r=t.updateContext)?r.call(this,e):this.exprAllowed=t.beforeExpr};Le.parenR.updateContext=Le.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===_l.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};Le.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?_l.b_stat:_l.b_expr),this.exprAllowed=!0};Le.dollarBraceL.updateContext=function(){this.context.push(_l.b_tmpl),this.exprAllowed=!0};Le.parenL.updateContext=function(e){var r=e===Le._if||e===Le._for||e===Le._with||e===Le._while;this.context.push(r?_l.p_stat:_l.p_expr),this.exprAllowed=!0};Le.incDec.updateContext=function(){};Le._function.updateContext=Le._class.updateContext=function(e){e.beforeExpr&&e!==Le.semi&&e!==Le._else&&!(e===Le._return&&ev.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===Le.colon||e===Le.braceL)&&this.curContext()===_l.b_stat)?this.context.push(_l.f_expr):this.context.push(_l.f_stat),this.exprAllowed=!1};Le.backQuote.updateContext=function(){this.curContext()===_l.q_tmpl?this.context.pop():this.context.push(_l.q_tmpl),this.exprAllowed=!1};Le.star.updateContext=function(e){if(e===Le._function){var r=this.context.length-1;this.context[r]===_l.f_expr?this.context[r]=_l.f_expr_gen:this.context[r]=_l.f_gen}this.exprAllowed=!0};Le.name.updateContext=function(e){var r=!1;this.options.ecmaVersion>=6&&e!==Le.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(r=!0),this.exprAllowed=r};var roe="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",noe=roe+" Extended_Pictographic",Drt=noe,Brt={9:roe,10:noe,11:Drt},fX="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ioe="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",aoe=ioe+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Nrt=aoe+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",zrt={9:ioe,10:aoe,11:Nrt},ooe={};function k6(e){var r=ooe[e]={binary:Bx(Brt[e]+" "+fX),nonBinary:{General_Category:Bx(fX),Script:Bx(zrt[e])}};r.nonBinary.Script_Extensions=r.nonBinary.Script,r.nonBinary.gc=r.nonBinary.General_Category,r.nonBinary.sc=r.nonBinary.Script,r.nonBinary.scx=r.nonBinary.Script_Extensions}k6(9);k6(10);k6(11);var Di=$l.prototype,Py=function(r){this.parser=r,this.validFlags="gim"+(r.options.ecmaVersion>=6?"uy":"")+(r.options.ecmaVersion>=9?"s":""),this.unicodeProperties=ooe[r.options.ecmaVersion>=11?11:r.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Py.prototype.reset=function(r,t,n){var i=n.indexOf("u")!==-1;this.start=r|0,this.source=t+"",this.flags=n,this.switchU=i&&this.parser.options.ecmaVersion>=6,this.switchN=i&&this.parser.options.ecmaVersion>=9};Py.prototype.raise=function(r){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+r)};Py.prototype.at=function(r,t){t===void 0&&(t=!1);var n=this.source,i=n.length;if(r>=i)return-1;var a=n.charCodeAt(r);if(!(t||this.switchU)||a<=55295||a>=57344||r+1>=i)return a;var o=n.charCodeAt(r+1);return o>=56320&&o<=57343?(a<<10)+o-56613888:a};Py.prototype.nextIndex=function(r,t){t===void 0&&(t=!1);var n=this.source,i=n.length;if(r>=i)return i;var a=n.charCodeAt(r),o;return!(t||this.switchU)||a<=55295||a>=57344||r+1>=i||(o=n.charCodeAt(r+1))<56320||o>57343?r+1:r+2};Py.prototype.current=function(r){return r===void 0&&(r=!1),this.at(this.pos,r)};Py.prototype.lookahead=function(r){return r===void 0&&(r=!1),this.at(this.nextIndex(this.pos,r),r)};Py.prototype.advance=function(r){r===void 0&&(r=!1),this.pos=this.nextIndex(this.pos,r)};Py.prototype.eat=function(r,t){return t===void 0&&(t=!1),this.current(t)===r?(this.advance(t),!0):!1};function OL(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}Di.validateRegExpFlags=function(e){for(var r=e.validFlags,t=e.flags,n=0;n<t.length;n++){var i=t.charAt(n);r.indexOf(i)===-1&&this.raise(e.start,"Invalid regular expression flag"),t.indexOf(i,n+1)>-1&&this.raise(e.start,"Duplicate regular expression flag")}};Di.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&e.groupNames.length>0&&(e.switchN=!0,this.regexp_pattern(e))};Di.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames.length=0,e.backReferenceNames.length=0,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var r=0,t=e.backReferenceNames;r<t.length;r+=1){var n=t[r];e.groupNames.indexOf(n)===-1&&e.raise("Invalid named capture referenced")}};Di.regexp_disjunction=function(e){for(this.regexp_alternative(e);e.eat(124);)this.regexp_alternative(e);this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};Di.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};Di.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};Di.regexp_eatAssertion=function(e){var r=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=r}if(e.eat(40)&&e.eat(63)){var t=!1;if(this.options.ecmaVersion>=9&&(t=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!t,!0}return e.pos=r,!1};Di.regexp_eatQuantifier=function(e,r){return r===void 0&&(r=!1),this.regexp_eatQuantifierPrefix(e,r)?(e.eat(63),!0):!1};Di.regexp_eatQuantifierPrefix=function(e,r){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,r)};Di.regexp_eatBracedQuantifier=function(e,r){var t=e.pos;if(e.eat(123)){var n=0,i=-1;if(this.regexp_eatDecimalDigits(e)&&(n=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue),e.eat(125)))return i!==-1&&i<n&&!r&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!r&&e.raise("Incomplete quantifier"),e.pos=t}return!1};Di.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};Di.regexp_eatReverseSolidusAtomEscape=function(e){var r=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=r}return!1};Di.regexp_eatUncapturingGroup=function(e){var r=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=r}return!1};Di.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};Di.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};Di.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};Di.regexp_eatSyntaxCharacter=function(e){var r=e.current();return soe(r)?(e.lastIntValue=r,e.advance(),!0):!1};function soe(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}Di.regexp_eatPatternCharacters=function(e){for(var r=e.pos,t=0;(t=e.current())!==-1&&!soe(t);)e.advance();return e.pos!==r};Di.regexp_eatExtendedPatternCharacter=function(e){var r=e.current();return r!==-1&&r!==36&&!(r>=40&&r<=43)&&r!==46&&r!==63&&r!==91&&r!==94&&r!==124?(e.advance(),!0):!1};Di.regexp_groupSpecifier=function(e){if(e.eat(63)){if(this.regexp_eatGroupName(e)){e.groupNames.indexOf(e.lastStringValue)!==-1&&e.raise("Duplicate capture group name"),e.groupNames.push(e.lastStringValue);return}e.raise("Invalid group")}};Di.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};Di.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=OL(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=OL(e.lastIntValue);return!0}return!1};Di.regexp_eatRegExpIdentifierStart=function(e){var r=e.pos,t=this.options.ecmaVersion>=11,n=e.current(t);return e.advance(t),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,t)&&(n=e.lastIntValue),$rt(n)?(e.lastIntValue=n,!0):(e.pos=r,!1)};function $rt(e){return c_(e,!0)||e===36||e===95}Di.regexp_eatRegExpIdentifierPart=function(e){var r=e.pos,t=this.options.ecmaVersion>=11,n=e.current(t);return e.advance(t),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,t)&&(n=e.lastIntValue),Urt(n)?(e.lastIntValue=n,!0):(e.pos=r,!1)};function Urt(e){return I2(e,!0)||e===36||e===95||e===8204||e===8205}Di.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};Di.regexp_eatBackReference=function(e){var r=e.pos;if(this.regexp_eatDecimalEscape(e)){var t=e.lastIntValue;if(e.switchU)return t>e.maxBackReference&&(e.maxBackReference=t),!0;if(t<=e.numCapturingParens)return!0;e.pos=r}return!1};Di.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};Di.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};Di.regexp_eatCControlLetter=function(e){var r=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=r}return!1};Di.regexp_eatZero=function(e){return e.current()===48&&!Nk(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};Di.regexp_eatControlEscape=function(e){var r=e.current();return r===116?(e.lastIntValue=9,e.advance(),!0):r===110?(e.lastIntValue=10,e.advance(),!0):r===118?(e.lastIntValue=11,e.advance(),!0):r===102?(e.lastIntValue=12,e.advance(),!0):r===114?(e.lastIntValue=13,e.advance(),!0):!1};Di.regexp_eatControlLetter=function(e){var r=e.current();return uoe(r)?(e.lastIntValue=r%32,e.advance(),!0):!1};function uoe(e){return e>=65&&e<=90||e>=97&&e<=122}Di.regexp_eatRegExpUnicodeEscapeSequence=function(e,r){r===void 0&&(r=!1);var t=e.pos,n=r||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var i=e.lastIntValue;if(n&&i>=55296&&i<=56319){var a=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var o=e.lastIntValue;if(o>=56320&&o<=57343)return e.lastIntValue=(i-55296)*1024+(o-56320)+65536,!0}e.pos=a,e.lastIntValue=i}return!0}if(n&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&Vrt(e.lastIntValue))return!0;n&&e.raise("Invalid unicode escape"),e.pos=t}return!1};function Vrt(e){return e>=0&&e<=1114111}Di.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var r=e.current();return r!==99&&(!e.switchN||r!==107)?(e.lastIntValue=r,e.advance(),!0):!1};Di.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var r=e.current();if(r>=49&&r<=57){do e.lastIntValue=10*e.lastIntValue+(r-48),e.advance();while((r=e.current())>=48&&r<=57);return!0}return!1};Di.regexp_eatCharacterClassEscape=function(e){var r=e.current();if(Grt(r))return e.lastIntValue=-1,e.advance(),!0;if(e.switchU&&this.options.ecmaVersion>=9&&(r===80||r===112)){if(e.lastIntValue=-1,e.advance(),e.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(e)&&e.eat(125))return!0;e.raise("Invalid property name")}return!1};function Grt(e){return e===100||e===68||e===115||e===83||e===119||e===87}Di.regexp_eatUnicodePropertyValueExpression=function(e){var r=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var t=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var n=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,t,n),!0}}if(e.pos=r,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,i),!0}return!1};Di.regexp_validateUnicodePropertyNameAndValue=function(e,r,t){Rk(e.unicodeProperties.nonBinary,r)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[r].test(t)||e.raise("Invalid property value")};Di.regexp_validateUnicodePropertyNameOrValue=function(e,r){e.unicodeProperties.binary.test(r)||e.raise("Invalid property name")};Di.regexp_eatUnicodePropertyName=function(e){var r=0;for(e.lastStringValue="";loe(r=e.current());)e.lastStringValue+=OL(r),e.advance();return e.lastStringValue!==""};function loe(e){return uoe(e)||e===95}Di.regexp_eatUnicodePropertyValue=function(e){var r=0;for(e.lastStringValue="";Hrt(r=e.current());)e.lastStringValue+=OL(r),e.advance();return e.lastStringValue!==""};function Hrt(e){return loe(e)||Nk(e)}Di.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};Di.regexp_eatCharacterClass=function(e){if(e.eat(91)){if(e.eat(94),this.regexp_classRanges(e),e.eat(93))return!0;e.raise("Unterminated character class")}return!1};Di.regexp_classRanges=function(e){for(;this.regexp_eatClassAtom(e);){var r=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var t=e.lastIntValue;e.switchU&&(r===-1||t===-1)&&e.raise("Invalid character class"),r!==-1&&t!==-1&&r>t&&e.raise("Range out of order in character class")}}};Di.regexp_eatClassAtom=function(e){var r=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var t=e.current();(t===99||hoe(t))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=r}var n=e.current();return n!==93?(e.lastIntValue=n,e.advance(),!0):!1};Di.regexp_eatClassEscape=function(e){var r=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=r}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};Di.regexp_eatClassControlLetter=function(e){var r=e.current();return Nk(r)||r===95?(e.lastIntValue=r%32,e.advance(),!0):!1};Di.regexp_eatHexEscapeSequence=function(e){var r=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=r}return!1};Di.regexp_eatDecimalDigits=function(e){var r=e.pos,t=0;for(e.lastIntValue=0;Nk(t=e.current());)e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();return e.pos!==r};function Nk(e){return e>=48&&e<=57}Di.regexp_eatHexDigits=function(e){var r=e.pos,t=0;for(e.lastIntValue=0;coe(t=e.current());)e.lastIntValue=16*e.lastIntValue+foe(t),e.advance();return e.pos!==r};function coe(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function foe(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}Di.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var r=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;r<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=r*64+t*8+e.lastIntValue:e.lastIntValue=r*8+t}else e.lastIntValue=r;return!0}return!1};Di.regexp_eatOctalDigit=function(e){var r=e.current();return hoe(r)?(e.lastIntValue=r-48,e.advance(),!0):(e.lastIntValue=0,!1)};function hoe(e){return e>=48&&e<=55}Di.regexp_eatFixedHexDigits=function(e,r){var t=e.pos;e.lastIntValue=0;for(var n=0;n<r;++n){var i=e.current();if(!coe(i))return e.pos=t,!1;e.lastIntValue=16*e.lastIntValue+foe(i),e.advance()}return!0};var P6=function(r){this.type=r.type,this.value=r.value,this.start=r.start,this.end=r.end,r.options.locations&&(this.loc=new Ok(r,r.startLoc,r.endLoc)),r.options.ranges&&(this.range=[r.start,r.end])},co=$l.prototype;co.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new P6(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};co.getToken=function(){return this.next(),new P6(this)};typeof Symbol!="undefined"&&(co[Symbol.iterator]=function(){var e=this;return{next:function(){var r=e.getToken();return{done:r.type===Le.eof,value:r}}}});co.curContext=function(){return this.context[this.context.length-1]};co.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(Le.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};co.readToken=function(e){return c_(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};co.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=57344)return e;var r=this.input.charCodeAt(this.pos+1);return(e<<10)+r-56613888};co.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),r=this.pos,t=this.input.indexOf("*/",this.pos+=2);if(t===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=t+2,this.options.locations){QE.lastIndex=r;for(var n;(n=QE.exec(this.input))&&n.index<this.pos;)++this.curLine,this.lineStart=n.index+n[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(r+2,t),r,this.pos,e,this.curPosition())};co.skipLineComment=function(e){for(var r=this.pos,t=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!kS(n);)n=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(r+e,this.pos),r,this.pos,t,this.curPosition())};co.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&Vae.test(String.fromCharCode(e)))++this.pos;else break e}}};co.finishToken=function(e,r){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var t=this.type;this.type=e,this.value=r,this.updateContext(t)};co.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var r=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&r===46?(this.pos+=3,this.finishToken(Le.ellipsis)):(++this.pos,this.finishToken(Le.dot))};co.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(Le.assign,2):this.finishOp(Le.slash,1)};co.readToken_mult_modulo_exp=function(e){var r=this.input.charCodeAt(this.pos+1),t=1,n=e===42?Le.star:Le.modulo;return this.options.ecmaVersion>=7&&e===42&&r===42&&(++t,n=Le.starstar,r=this.input.charCodeAt(this.pos+2)),r===61?this.finishOp(Le.assign,t+1):this.finishOp(n,t)};co.readToken_pipe_amp=function(e){var r=this.input.charCodeAt(this.pos+1);if(r===e){if(this.options.ecmaVersion>=12){var t=this.input.charCodeAt(this.pos+2);if(t===61)return this.finishOp(Le.assign,3)}return this.finishOp(e===124?Le.logicalOR:Le.logicalAND,2)}return r===61?this.finishOp(Le.assign,2):this.finishOp(e===124?Le.bitwiseOR:Le.bitwiseAND,1)};co.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(Le.assign,2):this.finishOp(Le.bitwiseXOR,1)};co.readToken_plus_min=function(e){var r=this.input.charCodeAt(this.pos+1);return r===e?r===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||ev.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(Le.incDec,2):r===61?this.finishOp(Le.assign,2):this.finishOp(Le.plusMin,1)};co.readToken_lt_gt=function(e){var r=this.input.charCodeAt(this.pos+1),t=1;return r===e?(t=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+t)===61?this.finishOp(Le.assign,t+1):this.finishOp(Le.bitShift,t)):r===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(r===61&&(t=2),this.finishOp(Le.relational,t))};co.readToken_eq_excl=function(e){var r=this.input.charCodeAt(this.pos+1);return r===61?this.finishOp(Le.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&r===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Le.arrow)):this.finishOp(e===61?Le.eq:Le.prefix,1)};co.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var r=this.input.charCodeAt(this.pos+1);if(r===46){var t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(Le.questionDot,2)}if(r===63){if(e>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(Le.assign,3)}return this.finishOp(Le.coalesce,2)}}return this.finishOp(Le.question,1)};co.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Le.parenL);case 41:return++this.pos,this.finishToken(Le.parenR);case 59:return++this.pos,this.finishToken(Le.semi);case 44:return++this.pos,this.finishToken(Le.comma);case 91:return++this.pos,this.finishToken(Le.bracketL);case 93:return++this.pos,this.finishToken(Le.bracketR);case 123:return++this.pos,this.finishToken(Le.braceL);case 125:return++this.pos,this.finishToken(Le.braceR);case 58:return++this.pos,this.finishToken(Le.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Le.backQuote);case 48:var r=this.input.charCodeAt(this.pos+1);if(r===120||r===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(r===111||r===79)return this.readRadixNumber(8);if(r===98||r===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(Le.prefix,1)}this.raise(this.pos,"Unexpected character '"+R6(e)+"'")};co.finishOp=function(e,r){var t=this.input.slice(this.pos,this.pos+r);return this.pos+=r,this.finishToken(e,t)};co.readRegexp=function(){for(var e,r,t=this.pos;;){this.pos>=this.input.length&&this.raise(t,"Unterminated regular expression");var n=this.input.charAt(this.pos);if(ev.test(n)&&this.raise(t,"Unterminated regular expression"),e)e=!1;else{if(n==="[")r=!0;else if(n==="]"&&r)r=!1;else if(n==="/"&&!r)break;e=n==="\\"}++this.pos}var i=this.input.slice(t,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var s=this.regexpState||(this.regexpState=new Py(this));s.reset(t,i,o),this.validateRegExpFlags(s),this.validateRegExpPattern(s);var u=null;try{u=new RegExp(i,o)}catch{}return this.finishToken(Le.regexp,{pattern:i,flags:o,value:u})};co.readInt=function(e,r,t){for(var n=this.options.ecmaVersion>=12&&r===void 0,i=t&&this.input.charCodeAt(this.pos)===48,a=this.pos,o=0,s=0,u=0,l=r==null?1/0:r;u<l;++u,++this.pos){var f=this.input.charCodeAt(this.pos),h=void 0;if(n&&f===95){i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),s===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),u===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),s=f;continue}if(f>=97?h=f-97+10:f>=65?h=f-65+10:f>=48&&f<=57?h=f-48:h=1/0,h>=e)break;s=f,o=o*e+h}return n&&s===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||r!=null&&this.pos-a!==r?null:o};function jrt(e,r){return r?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function poe(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}co.readRadixNumber=function(e){var r=this.pos;this.pos+=2;var t=this.readInt(e);return t==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(t=poe(this.input.slice(r,this.pos)),++this.pos):c_(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Le.num,t)};co.readNumber=function(e){var r=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(r,"Invalid number");var t=this.pos-r>=2&&this.input.charCodeAt(r)===48;t&&this.strict&&this.raise(r,"Invalid number");var n=this.input.charCodeAt(this.pos);if(!t&&!e&&this.options.ecmaVersion>=11&&n===110){var i=poe(this.input.slice(r,this.pos));return++this.pos,c_(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Le.num,i)}t&&/[89]/.test(this.input.slice(r,this.pos))&&(t=!1),n===46&&!t&&(++this.pos,this.readInt(10),n=this.input.charCodeAt(this.pos)),(n===69||n===101)&&!t&&(n=this.input.charCodeAt(++this.pos),(n===43||n===45)&&++this.pos,this.readInt(10)===null&&this.raise(r,"Invalid number")),c_(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=jrt(this.input.slice(r,this.pos),t);return this.finishToken(Le.num,a)};co.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),r;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;r=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,r>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else r=this.readHexChar(4);return r};function R6(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}co.readString=function(e){for(var r="",t=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===e)break;n===92?(r+=this.input.slice(t,this.pos),r+=this.readEscapedChar(!1),t=this.pos):(kS(n,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return r+=this.input.slice(t,this.pos++),this.finishToken(Le.string,r)};var doe={};co.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===doe)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};co.invalidStringToken=function(e,r){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw doe;this.raise(e,r)};co.readTmplToken=function(){for(var e="",r=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var t=this.input.charCodeAt(this.pos);if(t===96||t===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===Le.template||this.type===Le.invalidTemplate)?t===36?(this.pos+=2,this.finishToken(Le.dollarBraceL)):(++this.pos,this.finishToken(Le.backQuote)):(e+=this.input.slice(r,this.pos),this.finishToken(Le.template,e));if(t===92)e+=this.input.slice(r,this.pos),e+=this.readEscapedChar(!0),r=this.pos;else if(kS(t)){switch(e+=this.input.slice(r,this.pos),++this.pos,t){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(t);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),r=this.pos}else++this.pos}};co.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(Le.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")};co.readEscapedChar=function(e){var r=this.input.charCodeAt(++this.pos);switch(++this.pos,r){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return R6(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(e){var t=this.pos-1;return this.invalidStringToken(t,"Invalid escape sequence in template string"),null}default:if(r>=48&&r<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(n,8);return i>255&&(n=n.slice(0,-1),i=parseInt(n,8)),this.pos+=n.length-1,r=this.input.charCodeAt(this.pos),(n!=="0"||r===56||r===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-n.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return kS(r)?"":String.fromCharCode(r)}};co.readHexChar=function(e){var r=this.pos,t=this.readInt(16,e);return t===null&&this.invalidStringToken(r,"Bad character escape sequence"),t};co.readWord1=function(){this.containsEsc=!1;for(var e="",r=!0,t=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(I2(i,n))this.pos+=i<=65535?1:2;else if(i===92){this.containsEsc=!0,e+=this.input.slice(t,this.pos);var a=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(r?c_:I2)(o,n)||this.invalidStringToken(a,"Invalid Unicode escape"),e+=R6(o),t=this.pos}else break;r=!1}return e+this.input.slice(t,this.pos)};co.readWord=function(){var e=this.readWord1(),r=Le.name;return this.keywords.test(e)&&(r=S6[e]),this.finishToken(r,e)};var Wrt="7.4.1";$l.acorn={Parser:$l,version:Wrt,defaultOptions:qD,Position:JE,SourceLocation:Ok,getLineInfo:Hae,Node:I6,TokenType:Ho,tokTypes:Le,keywordTypes:S6,TokContext:$v,tokContexts:_l,isIdentifierChar:I2,isIdentifierStart:c_,Token:P6,isNewLine:kS,lineBreak:ev,lineBreakG:QE,nonASCIIwhitespace:Vae};function Xrt(e,r){return $l.parse(e,r)}function k1(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r}function k2(e){var r=typeof Map=="function"?new Map:void 0;return k2=function(n){if(n===null||!Zrt(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r!="undefined"){if(r.has(n))return r.get(n);r.set(n,i)}function i(){return CM(n,arguments,QD(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),FL(i,n)},k2(e)}function Yrt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function CM(e,r,t){return Yrt()?CM=Reflect.construct:CM=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&FL(l,o.prototype),l},CM.apply(null,arguments)}function Zrt(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function FL(e,r){return FL=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},FL(e,r)}function QD(e){return QD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},QD(e)}var qrt=function(e){k1(r,e);function r(){return e.apply(this,arguments)||this}return r}(k2(Error)),Krt=function(e){k1(r,e);function r(){return e.apply(this,arguments)||this}return r}(k2(SyntaxError)),JD=function(e){k1(r,e);function r(){return e.apply(this,arguments)||this}return r}(k2(ReferenceError)),Qrt=function(e){k1(r,e);function r(){return e.apply(this,arguments)||this}return r}(k2(TypeError)),e3=function(e){k1(r,e);function r(){return e.apply(this,arguments)||this}return r}(qrt),Jrt=function(e){k1(r,e);function r(){return e.apply(this,arguments)||this}return r}(Krt),Uv=function(e){k1(r,e);function r(){return e.apply(this,arguments)||this}return r}(JD),Rf={UnknownError:[3001,"%0",e3],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",e3],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Uv],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Uv],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Uv],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Uv],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Uv],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Uv],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Uv],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Uv],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Uv],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Uv],FunctionUndefinedReferenceError:[2001,"%0 is not a function",JD],VariableUndefinedReferenceError:[2002,"%0 is not defined",JD],IsNotConstructor:[2003,"%0 is not a constructor",Qrt]};function ent(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function EM(e,r,t){return ent()?EM=Reflect.construct:EM=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&t3(l,o.prototype),l},EM.apply(null,arguments)}function t3(e,r){return t3=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},t3(e,r)}var tnt="0.0.3";function hX(e,r){Object.defineProperty(e,"name",{value:r,writable:!1,enumerable:!1,configurable:!0})}var rnt=Object.prototype.hasOwnProperty,hx=Symbol("Break"),px=Symbol("Continue"),pX=Symbol("DefaultCase"),Cc=Symbol("EmptyStatementReturn"),dX=Symbol("WithScopeName"),vX=Symbol("SuperScopeName"),gX=Symbol("RootScopeName"),mX=Symbol("GlobalScopeName");function GO(e){return typeof e=="function"}var M0=function(){function e(t){this.interpreter=t}var r=e.prototype;return r.generator=function(){var n=this.interpreter;function i(){return this.getCurrentScope()}function a(){return this.getGlobalScope()}function o(){return this.getCurrentContext()}return{getOptions:n.getOptions.bind(n),getCurrentScope:i.bind(n),getGlobalScope:a.bind(n),getCurrentContext:o.bind(n),getExecStartTime:n.getExecStartTime.bind(n)}},e}();function O6(e,r,t){if(t===void 0&&(t=!0),!(e instanceof M0))throw new Error("Illegal call");if(typeof r!="string")return r;if(!!r){var n=e.generator(),i=n.getOptions(),a={timeout:i.timeout,_initEnv:function(){t||this.setCurrentContext(n.getCurrentContext()),this.execStartTime=n.getExecStartTime(),this.execEndTime=this.execStartTime}},o=t?n.getGlobalScope():n.getCurrentScope(),s=new tg(o,a);return s.evaluate(r)}}Object.defineProperty(O6,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function F6(e){if(!(e instanceof M0))throw new Error("Illegal call");for(var r=e.generator(),t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a=n.pop(),o=new tg(r.getGlobalScope(),r.getOptions()),s=`
		    (function anonymous(`+n.join(",")+`){
		        `+a+`
		    });
		    `;return o.evaluate(s)}Object.defineProperty(F6,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var Rg=function(r){this.value=r},dx=function(r){this.value=r},g0=function(r){this.value=r},zb=function(r,t,n){t===void 0&&(t=null),this.name=n,this.parent=t,this.data=r,this.labelStack=[]};function BT(){}function nnt(e,r){return e===void 0&&(e=null),new zb(Object.create(null),e,r)}function int(e){return Object.create(e)}var om={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:O6,Function:F6};typeof JSON!="undefined"&&(om.JSON=JSON);typeof Promise!="undefined"&&(om.Promise=Promise);typeof Set!="undefined"&&(om.Set=Set);typeof Map!="undefined"&&(om.Map=Map);typeof Symbol!="undefined"&&(om.Symbol=Symbol);typeof Proxy!="undefined"&&(om.Proxy=Proxy);typeof WeakMap!="undefined"&&(om.WeakMap=WeakMap);typeof WeakSet!="undefined"&&(om.WeakSet=WeakSet);typeof Reflect!="undefined"&&(om.Reflect=Reflect);var tg=function(){function e(t,n){t===void 0&&(t=e.global),n===void 0&&(n={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:n.ecmaVersion||e.ecmaVersion,timeout:n.timeout||0,rootContext:n.rootContext,globalContextInFunction:n.globalContextInFunction===void 0?e.globalContextInFunction:n.globalContextInFunction,_initEnv:n._initEnv},this.context=t||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var r=e.prototype;return r.initEnvironment=function(n){var i;if(n instanceof zb)i=n;else{var a=null,o=this.createSuperScope(n);this.options.rootContext&&(a=new zb(int(this.options.rootContext),o,gX)),i=new zb(n,a||o,mX)}this.globalScope=i,this.currentScope=this.globalScope,this.globalContext=i.data,this.currentContext=i.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var s=this.options._initEnv;s&&s.call(this)},r.getExecStartTime=function(){return this.execStartTime},r.getExecutionTime=function(){return this.execEndTime-this.execStartTime},r.setExecTimeout=function(n){n===void 0&&(n=0),this.options.timeout=n},r.getOptions=function(){return this.options},r.getGlobalScope=function(){return this.globalScope},r.getCurrentScope=function(){return this.currentScope},r.getCurrentContext=function(){return this.currentContext},r.isInterruptThrow=function(n){return n instanceof e3||n instanceof Uv||n instanceof Jrt},r.createSuperScope=function(n){var i=Object.assign({},om),a=Object.keys(i);return a.forEach(function(o){o in n&&delete i[o]}),new zb(i,null,vX)},r.setCurrentContext=function(n){this.currentContext=n},r.setCurrentScope=function(n){this.currentScope=n},r.evaluate=function(n){n===void 0&&(n="");var i;if(!!n)return i=Xrt(n,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||e.ecmaVersion}),this.evaluateNode(i,n)},r.appendCode=function(n){return this.evaluate(n)},r.evaluateNode=function(n,i){var a=this;i===void 0&&(i=""),this.value=void 0,this.source=i,this.sourceList.push(i),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var o=this.getCurrentScope(),s=this.getCurrentContext(),u=o.labelStack.concat([]),l=this.callStack.concat([]),f=function(){a.setCurrentScope(o),a.setCurrentContext(s),o.labelStack=u,a.callStack=l};try{var h=this.createClosure(n);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),h()}catch(p){throw p}finally{f(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},r.createErrorMessage=function(n,i,a){var o=n[1].replace("%0",String(i));return a!==null&&(o+=this.getNodePosition(a||this.lastExecNode)),o},r.createError=function(n,i){return new i(n)},r.createThrowError=function(n,i){return this.createError(n,i)},r.createInternalThrowError=function(n,i,a){return this.createError(this.createErrorMessage(n,i,a),n[2])},r.checkTimeout=function(){if(!this.isRunning)return!1;var n=this.options.timeout||0,i=Date.now();return i-this.execStartTime>n},r.getNodePosition=function(n){if(n){var i="";return n.loc?" ["+n.loc.start.line+":"+n.loc.start.column+"]"+i:""}return""},r.createClosure=function(n){var i=this,a;switch(n.type){case"BinaryExpression":a=this.binaryExpressionHandler(n);break;case"LogicalExpression":a=this.logicalExpressionHandler(n);break;case"UnaryExpression":a=this.unaryExpressionHandler(n);break;case"UpdateExpression":a=this.updateExpressionHandler(n);break;case"ObjectExpression":a=this.objectExpressionHandler(n);break;case"ArrayExpression":a=this.arrayExpressionHandler(n);break;case"CallExpression":a=this.callExpressionHandler(n);break;case"NewExpression":a=this.newExpressionHandler(n);break;case"MemberExpression":a=this.memberExpressionHandler(n);break;case"ThisExpression":a=this.thisExpressionHandler(n);break;case"SequenceExpression":a=this.sequenceExpressionHandler(n);break;case"Literal":a=this.literalHandler(n);break;case"Identifier":a=this.identifierHandler(n);break;case"AssignmentExpression":a=this.assignmentExpressionHandler(n);break;case"FunctionDeclaration":a=this.functionDeclarationHandler(n);break;case"VariableDeclaration":a=this.variableDeclarationHandler(n);break;case"BlockStatement":case"Program":a=this.programHandler(n);break;case"ExpressionStatement":a=this.expressionStatementHandler(n);break;case"EmptyStatement":a=this.emptyStatementHandler(n);break;case"ReturnStatement":a=this.returnStatementHandler(n);break;case"FunctionExpression":a=this.functionExpressionHandler(n);break;case"IfStatement":a=this.ifStatementHandler(n);break;case"ConditionalExpression":a=this.conditionalExpressionHandler(n);break;case"ForStatement":a=this.forStatementHandler(n);break;case"WhileStatement":a=this.whileStatementHandler(n);break;case"DoWhileStatement":a=this.doWhileStatementHandler(n);break;case"ForInStatement":a=this.forInStatementHandler(n);break;case"WithStatement":a=this.withStatementHandler(n);break;case"ThrowStatement":a=this.throwStatementHandler(n);break;case"TryStatement":a=this.tryStatementHandler(n);break;case"ContinueStatement":a=this.continueStatementHandler(n);break;case"BreakStatement":a=this.breakStatementHandler(n);break;case"SwitchStatement":a=this.switchStatementHandler(n);break;case"LabeledStatement":a=this.labeledStatementHandler(n);break;case"DebuggerStatement":a=this.debuggerStatementHandler(n);break;default:throw this.createInternalThrowError(Rf.NodeTypeSyntaxError,n.type,n)}return function(){var o=i.options.timeout;if(o&&o>0&&i.checkTimeout())throw i.createInternalThrowError(Rf.ExecutionTimeOutError,o,null);return i.lastExecNode=n,a.apply(void 0,arguments)}},r.binaryExpressionHandler=function(n){var i=this,a=this.createClosure(n.left),o=this.createClosure(n.right);return function(){var s=a(),u=o();switch(n.operator){case"==":return s==u;case"!=":return s!=u;case"===":return s===u;case"!==":return s!==u;case"<":return s<u;case"<=":return s<=u;case">":return s>u;case">=":return s>=u;case"<<":return s<<u;case">>":return s>>u;case">>>":return s>>>u;case"+":return s+u;case"-":return s-u;case"*":return s*u;case"**":return Math.pow(s,u);case"/":return s/u;case"%":return s%u;case"|":return s|u;case"^":return s^u;case"&":return s&u;case"in":return s in u;case"instanceof":return s instanceof u;default:throw i.createInternalThrowError(Rf.BinaryOperatorSyntaxError,n.operator,n)}}},r.logicalExpressionHandler=function(n){var i=this,a=this.createClosure(n.left),o=this.createClosure(n.right);return function(){switch(n.operator){case"||":return a()||o();case"&&":return a()&&o();default:throw i.createInternalThrowError(Rf.LogicalOperatorSyntaxError,n.operator,n)}}},r.unaryExpressionHandler=function(n){var i=this;switch(n.operator){case"delete":var a=this.createObjectGetter(n.argument),o=this.createNameGetter(n.argument);return function(){var f=a(),h=o();return delete f[h]};default:var s;if(n.operator==="typeof"&&n.argument.type==="Identifier"){var u=this.createObjectGetter(n.argument),l=this.createNameGetter(n.argument);s=function(){return u()[l()]}}else s=this.createClosure(n.argument);return function(){var f=s();switch(n.operator){case"-":return-f;case"+":return+f;case"!":return!f;case"~":return~f;case"void":return;case"typeof":return typeof f;default:throw i.createInternalThrowError(Rf.UnaryOperatorSyntaxError,n.operator,n)}}}},r.updateExpressionHandler=function(n){var i=this,a=this.createObjectGetter(n.argument),o=this.createNameGetter(n.argument);return function(){var s=a(),u=o();switch(i.assertVariable(s,u,n),n.operator){case"++":return n.prefix?++s[u]:s[u]++;case"--":return n.prefix?--s[u]:s[u]--;default:throw i.createInternalThrowError(Rf.UpdateOperatorSyntaxError,n.operator,n)}}},r.objectExpressionHandler=function(n){var i=this,a=[];function o(u){return u.type==="Identifier"?u.name:u.type==="Literal"?u.value:this.throwError(Rf.ObjectStructureSyntaxError,u.type,u)}var s=Object.create(null);return n.properties.forEach(function(u){var l=u.kind,f=o(u.key);(!s[f]||l==="init")&&(s[f]={}),s[f][l]=i.createClosure(u.value),a.push({key:f,property:u})}),function(){for(var u={},l=a.length,f=0;f<l;f++){var h=a[f],p=h.key,v=s[p],m=v.init?v.init():void 0,x=v.get?v.get():function(){},E=v.set?v.set():function(R){};if("set"in v||"get"in v){var A={configurable:!0,enumerable:!0,get:x,set:E};Object.defineProperty(u,p,A)}else{var L=h.property,k=L.kind;L.key.type==="Identifier"&&L.value.type==="FunctionExpression"&&k==="init"&&!L.value.id&&hX(m,L.key.name),u[p]=m}}return u}},r.arrayExpressionHandler=function(n){var i=this,a=n.elements.map(function(o){return o&&i.createClosure(o)});return function(){for(var o=a.length,s=Array(o),u=0;u<o;u++){var l=a[u];l&&(s[u]=l())}return s}},r.safeObjectGet=function(n,i,a){return n[i]},r.createCallFunctionGetter=function(n){var i=this;switch(n.type){case"MemberExpression":var a=this.createClosure(n.object),o=this.createMemberKeyGetter(n),s=this.source;return function(){var l=a(),f=o(),h=i.safeObjectGet(l,f,n);if(!h||!GO(h)){var p=s.slice(n.start,n.end);throw i.createInternalThrowError(Rf.FunctionUndefinedReferenceError,p,n)}return h.__IS_EVAL_FUNC?function(v){return h(new M0(i),v,!0)}:h.__IS_FUNCTION_FUNC?function(){for(var v=arguments.length,m=new Array(v),x=0;x<v;x++)m[x]=arguments[x];return h.apply(void 0,[new M0(i)].concat(m))}:h.bind(l)};default:var u=this.createClosure(n);return function(){var l="";n.type==="Identifier"&&(l=n.name);var f=u();if(!f||!GO(f))throw i.createInternalThrowError(Rf.FunctionUndefinedReferenceError,l,n);if(n.type==="Identifier"&&f.__IS_EVAL_FUNC&&l==="eval")return function(v){var m=i.getScopeFromName(l,i.getCurrentScope()),x=m.name===vX||m.name===mX||m.name===gX;return f(new M0(i),v,!x)};if(f.__IS_EVAL_FUNC)return function(v){return f(new M0(i),v,!0)};if(f.__IS_FUNCTION_FUNC)return function(){for(var v=arguments.length,m=new Array(v),x=0;x<v;x++)m[x]=arguments[x];return f.apply(void 0,[new M0(i)].concat(m))};var h=i.options.globalContextInFunction;if(n.type==="Identifier"){var p=i.getIdentifierScope(n);p.name===dX&&(h=p.data)}return f.bind(h)}}},r.callExpressionHandler=function(n){var i=this,a=this.createCallFunctionGetter(n.callee),o=n.arguments.map(function(s){return i.createClosure(s)});return function(){return a().apply(void 0,o.map(function(s){return s()}))}},r.functionExpressionHandler=function(n){var i=this,a=this,o=this.source,s=this.collectDeclVars,u=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var l=n.id?n.id.name:"",f=n.params.length,h=n.params.map(function(x){return i.createParamNameGetter(x)}),p=this.createClosure(n.body),v=this.collectDeclVars,m=this.collectDeclFuncs;return this.collectDeclVars=s,this.collectDeclFuncs=u,function(){var x=a.getCurrentScope(),E=function A(){for(var L=arguments.length,k=new Array(L),R=0;R<L;R++)k[R]=arguments[R];a.callStack.push(""+l);var D=a.getCurrentScope(),$=nnt(x,"FunctionScope("+l+")");a.setCurrentScope($),a.addDeclarationsToScope(v,m,$),l&&($.data[l]=A),$.data.arguments=arguments,h.forEach(function(ee,U){$.data[ee()]=k[U]});var j=a.getCurrentContext();a.setCurrentContext(this);var H=p();if(a.setCurrentContext(j),a.setCurrentScope(D),a.callStack.pop(),H instanceof Rg)return H.value};return hX(E,l),Object.defineProperty(E,"length",{value:f,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(E,"toString",{value:function(){return o.slice(n.start,n.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(E,"valueOf",{value:function(){return o.slice(n.start,n.end)},writable:!0,configurable:!0,enumerable:!1}),E}},r.newExpressionHandler=function(n){var i=this,a=this.source,o=this.createClosure(n.callee),s=n.arguments.map(function(u){return i.createClosure(u)});return function(){var u=o();if(!GO(u)||u.__IS_EVAL_FUNC){var l=n.callee,f=a.slice(l.start,l.end);throw i.createInternalThrowError(Rf.IsNotConstructor,f,n)}return u.__IS_FUNCTION_FUNC?u.apply(void 0,[new M0(i)].concat(s.map(function(h){return h()}))):EM(u,s.map(function(h){return h()}))}},r.memberExpressionHandler=function(n){var i=this.createClosure(n.object),a=this.createMemberKeyGetter(n);return function(){var o=i(),s=a();return o[s]}},r.thisExpressionHandler=function(n){var i=this;return function(){return i.getCurrentContext()}},r.sequenceExpressionHandler=function(n){var i=this,a=n.expressions.map(function(o){return i.createClosure(o)});return function(){for(var o,s=a.length,u=0;u<s;u++){var l=a[u];o=l()}return o}},r.literalHandler=function(n){return function(){return n.regex?new RegExp(n.regex.pattern,n.regex.flags):n.value}},r.identifierHandler=function(n){var i=this;return function(){var a=i.getCurrentScope(),o=i.getScopeDataFromName(n.name,a);return i.assertVariable(o,n.name,n),o[n.name]}},r.getIdentifierScope=function(n){var i=this.getCurrentScope(),a=this.getScopeFromName(n.name,i);return a},r.assignmentExpressionHandler=function(n){var i=this;n.left.type==="Identifier"&&n.right.type==="FunctionExpression"&&!n.right.id&&(n.right.id={type:"Identifier",name:n.left.name});var a=this.createObjectGetter(n.left),o=this.createNameGetter(n.left),s=this.createClosure(n.right);return function(){var u=a(),l=o(),f=s();switch(n.operator!=="="&&i.assertVariable(u,l,n),n.operator){case"=":return u[l]=f;case"+=":return u[l]+=f;case"-=":return u[l]-=f;case"*=":return u[l]*=f;case"**=":return u[l]=Math.pow(u[l],f);case"/=":return u[l]/=f;case"%=":return u[l]%=f;case"<<=":return u[l]<<=f;case">>=":return u[l]>>=f;case">>>=":return u[l]>>>=f;case"&=":return u[l]&=f;case"^=":return u[l]^=f;case"|=":return u[l]|=f;default:throw i.createInternalThrowError(Rf.AssignmentExpressionSyntaxError,n.type,n)}}},r.functionDeclarationHandler=function(n){if(n.id){var i=this.functionExpressionHandler(n);Object.defineProperty(i,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(n.id.name,i)}return function(){return Cc}},r.getVariableName=function(n){if(n.type==="Identifier")return n.name;throw this.createInternalThrowError(Rf.VariableTypeSyntaxError,n.type,n)},r.variableDeclarationHandler=function(n){for(var i=this,a,o=[],s=0;s<n.declarations.length;s++){var u=n.declarations[s];this.varDeclaration(this.getVariableName(u.id)),u.init&&o.push({type:"AssignmentExpression",operator:"=",left:u.id,right:u.init})}return o.length&&(a=this.createClosure({type:"BlockStatement",body:o})),function(){if(a){var l=i.isVarDeclMode;i.isVarDeclMode=!0,a(),i.isVarDeclMode=l}return Cc}},r.assertVariable=function(n,i,a){if(n===this.globalScope.data&&!(i in n))throw this.createInternalThrowError(Rf.VariableUndefinedReferenceError,i,a)},r.programHandler=function(n){var i=this,a=n.body.map(function(o){return i.createClosure(o)});return function(){for(var o=Cc,s=0;s<a.length;s++){var u=a[s],l=i.setValue(u());if(l!==Cc&&(o=l,o instanceof Rg||o instanceof dx||o instanceof g0||o===hx||o===px))break}return o}},r.expressionStatementHandler=function(n){return this.createClosure(n.expression)},r.emptyStatementHandler=function(n){return function(){return Cc}},r.returnStatementHandler=function(n){var i=n.argument?this.createClosure(n.argument):BT;return function(){return new Rg(i())}},r.ifStatementHandler=function(n){var i=this.createClosure(n.test),a=this.createClosure(n.consequent),o=n.alternate?this.createClosure(n.alternate):function(){return Cc};return function(){return i()?a():o()}},r.conditionalExpressionHandler=function(n){return this.ifStatementHandler(n)},r.forStatementHandler=function(n){var i=this,a=BT,o=n.test?this.createClosure(n.test):function(){return!0},s=BT,u=this.createClosure(n.body);return n.type==="ForStatement"&&(a=n.init?this.createClosure(n.init):a,s=n.update?this.createClosure(n.update):BT),function(l){var f,h=Cc,p=n.type==="DoWhileStatement";for(l&&l.type==="LabeledStatement"&&(f=l.label.name),a();p||o();s()){p=!1;var v=i.setValue(u());if(!(v===Cc||v===px)){if(v===hx)break;if(h=v,h instanceof g0&&h.value===f){h=Cc;continue}if(h instanceof Rg||h instanceof dx||h instanceof g0)break}}return h}},r.whileStatementHandler=function(n){return this.forStatementHandler(n)},r.doWhileStatementHandler=function(n){return this.forStatementHandler(n)},r.forInStatementHandler=function(n){var i=this,a=n.left,o=this.createClosure(n.right),s=this.createClosure(n.body);return n.left.type==="VariableDeclaration"&&(this.createClosure(n.left)(),a=n.left.declarations[0].id),function(u){var l,f=Cc,h;u&&u.type==="LabeledStatement"&&(l=u.label.name);var p=o();for(h in p){i.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:a,right:{type:"Literal",value:h}})();var v=i.setValue(s());if(!(v===Cc||v===px)){if(v===hx)break;if(f=v,f instanceof g0&&f.value===l){f=Cc;continue}if(f instanceof Rg||f instanceof dx||f instanceof g0)break}}return f}},r.withStatementHandler=function(n){var i=this,a=this.createClosure(n.object),o=this.createClosure(n.body);return function(){var s=a(),u=i.getCurrentScope(),l=new zb(s,u,dX);i.setCurrentScope(l);var f=i.setValue(o());return i.setCurrentScope(u),f}},r.throwStatementHandler=function(n){var i=this,a=this.createClosure(n.argument);return function(){throw i.setValue(void 0),a()}},r.tryStatementHandler=function(n){var i=this,a=this.createClosure(n.block),o=n.handler?this.catchClauseHandler(n.handler):null,s=n.finalizer?this.createClosure(n.finalizer):null;return function(){var u=i.getCurrentScope(),l=i.getCurrentContext(),f=u.labelStack.concat([]),h=i.callStack.concat([]),p=Cc,v,m,x=function(){i.setCurrentScope(u),i.setCurrentContext(l),u.labelStack=f,i.callStack=h};try{p=i.setValue(a()),p instanceof Rg&&(v=p)}catch(E){if(x(),i.isInterruptThrow(E))throw E;if(o)try{p=i.setValue(o(E)),p instanceof Rg&&(v=p)}catch(A){if(x(),i.isInterruptThrow(A))throw A;m=A}}if(s)try{p=s(),p instanceof Rg&&(v=p)}catch(E){if(x(),i.isInterruptThrow(E))throw E;m=E}if(m)throw m;return v||p}},r.catchClauseHandler=function(n){var i=this,a=this.createParamNameGetter(n.param),o=this.createClosure(n.body);return function(s){var u,l=i.getCurrentScope(),f=l.data,h=a(),p=rnt.call(f,h),v=f[h];return f[h]=s,u=o(),p?f[h]=v:delete f[h],u}},r.continueStatementHandler=function(n){return function(){return n.label?new g0(n.label.name):px}},r.breakStatementHandler=function(n){return function(){return n.label?new dx(n.label.name):hx}},r.switchStatementHandler=function(n){var i=this,a=this.createClosure(n.discriminant),o=n.cases.map(function(s){return i.switchCaseHandler(s)});return function(){for(var s=a(),u=!1,l,f,h,p=0;p<o.length;p++){var v=o[p](),m=v.testClosure();if(m===pX){h=v;continue}if(u||m===s){if(u=!0,f=i.setValue(v.bodyClosure()),f===Cc)continue;if(f===hx||(l=f,l instanceof Rg||l instanceof dx||l instanceof g0||l===px))break}}if(!u&&h){f=i.setValue(h.bodyClosure());var x=f===Cc||f===hx||f===px;x||(l=f)}return l}},r.switchCaseHandler=function(n){var i=n.test?this.createClosure(n.test):function(){return pX},a=this.createClosure({type:"BlockStatement",body:n.consequent});return function(){return{testClosure:i,bodyClosure:a}}},r.labeledStatementHandler=function(n){var i=this,a=n.label.name,o=this.createClosure(n.body);return function(){var s,u=i.getCurrentScope();return u.labelStack.push(a),s=o(n),s instanceof dx&&s.value===a&&(s=Cc),u.labelStack.pop(),s}},r.debuggerStatementHandler=function(n){return function(){debugger;return Cc}},r.createParamNameGetter=function(n){if(n.type==="Identifier")return function(){return n.name};throw this.createInternalThrowError(Rf.ParamTypeSyntaxError,n.type,n)},r.createObjectKeyGetter=function(n){var i;return n.type==="Identifier"?i=function(){return n.name}:i=this.createClosure(n),function(){return i()}},r.createMemberKeyGetter=function(n){return n.computed?this.createClosure(n.property):this.createObjectKeyGetter(n.property)},r.createObjectGetter=function(n){var i=this;switch(n.type){case"Identifier":return function(){return i.getScopeDataFromName(n.name,i.getCurrentScope())};case"MemberExpression":return this.createClosure(n.object);default:throw this.createInternalThrowError(Rf.AssignmentTypeSyntaxError,n.type,n)}},r.createNameGetter=function(n){switch(n.type){case"Identifier":return function(){return n.name};case"MemberExpression":return this.createMemberKeyGetter(n);default:throw this.createInternalThrowError(Rf.AssignmentTypeSyntaxError,n.type,n)}},r.varDeclaration=function(n){var i=this.collectDeclVars;i[n]=void 0},r.funcDeclaration=function(n,i){var a=this.collectDeclFuncs;a[n]=i},r.addDeclarationsToScope=function(n,i,a){var o=a.data;for(var s in i){var u=i[s];o[s]=u&&u()}for(var l in n)l in o||(o[l]=void 0)},r.getScopeValue=function(n,i){var a=this.getScopeFromName(n,i);return a.data[n]},r.getScopeDataFromName=function(n,i){return this.getScopeFromName(n,i).data},r.getScopeFromName=function(n,i){var a=i;do if(n in a.data)return a;while(a=a.parent);return this.globalScope},r.setValue=function(n){var i=this.callStack.length;return this.isVarDeclMode||i||n===Cc||n===hx||n===px||n instanceof dx||n instanceof g0||(this.value=n instanceof Rg?n.value:n),n},r.getValue=function(){return this.value},e}();tg.version=tnt;tg.eval=O6;tg.Function=F6;tg.ecmaVersion=5;tg.globalContextInFunction=void 0;tg.global=Object.create(null);function ant(e){return e===void 0&&(e=Object.create(null)),e}function voe(e,r,t){r===void 0&&(r=[]),t===void 0&&(t={});var n=t.parsingContext,i=t.timeout===void 0?0:t.timeout,a=`
    (function anonymous(`+r.join(",")+`){
         `+e+`
    });
    `,o=new tg(n,{ecmaVersion:t.ecmaVersion,timeout:i,rootContext:t.rootContext,globalContextInFunction:t.globalContextInFunction});return o.evaluate(a)}function tS(e,r,t){var n=new tg(r,t);return n.evaluate(e)}var ont=tS,snt=function(){function e(t){this._code=t}var r=e.prototype;return r.runInContext=function(n){return tS(this._code,n)},r.runInNewContext=function(n){return tS(this._code,n)},e}(),unt=Object.freeze(Object.defineProperty({__proto__:null,createContext:ant,compileFunction:voe,runInContext:tS,runInNewContext:ont,Script:snt},Symbol.toStringTag,{value:"Module"})),yX=function(e,r,t){return tS(e,r,t)};function lnt(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r.pop();return voe(n||"",r)}var cnt=Object.freeze(Object.defineProperty({__proto__:null,Interpreter:tg,vm:unt,evaluate:yX,Function:lnt,default:yX},Symbol.toStringTag,{value:"Module"})),fnt=ed(cnt);(function(e,r){(function(t,n){e.exports=n(fnt)})(jp,function(t){var n=function(Z){return Z instanceof Uint8Array||Z instanceof Uint16Array||Z instanceof Uint32Array||Z instanceof Int8Array||Z instanceof Int16Array||Z instanceof Int32Array||Z instanceof Float32Array||Z instanceof Float64Array||Z instanceof Uint8ClampedArray},i=function(Z,Se){for(var Ve=Object.keys(Se),Rt=0;Rt<Ve.length;++Rt)Z[Ve[Rt]]=Se[Ve[Rt]];return Z},a=`
`;function o(Z){return typeof atob!="undefined"?atob(Z):"base64:"+Z}function s(Z){var Se=new Error("(regl) "+Z);throw console.error(Se),Se}function u(Z,Se){Z||s(Se)}function l(Z){return Z?": "+Z:""}function f(Z,Se,Ve){Z in Se||s("unknown parameter ("+Z+")"+l(Ve)+". possible values: "+Object.keys(Se).join())}function h(Z,Se){n(Z)||s("invalid parameter type"+l(Se)+". must be a typed array")}function p(Z,Se){switch(Se){case"number":return typeof Z=="number";case"object":return typeof Z=="object";case"string":return typeof Z=="string";case"boolean":return typeof Z=="boolean";case"function":return typeof Z=="function";case"undefined":return typeof Z=="undefined";case"symbol":return typeof Z=="symbol"}}function v(Z,Se,Ve){p(Z,Se)||s("invalid parameter type"+l(Ve)+". expected "+Se+", got "+typeof Z)}function m(Z,Se){Z>=0&&(Z|0)===Z||s("invalid parameter type, ("+Z+")"+l(Se)+". must be a nonnegative integer")}function x(Z,Se,Ve){Se.indexOf(Z)<0&&s("invalid value"+l(Ve)+". must be one of: "+Se)}var E=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function A(Z){Object.keys(Z).forEach(function(Se){E.indexOf(Se)<0&&s('invalid regl constructor argument "'+Se+'". must be one of '+E)})}function L(Z,Se){for(Z=Z+"";Z.length<Se;)Z=" "+Z;return Z}function k(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function R(Z,Se){this.number=Z,this.line=Se,this.errors=[]}function D(Z,Se,Ve){this.file=Z,this.line=Se,this.message=Ve}function $(){var Z=new Error,Se=(Z.stack||Z).toString(),Ve=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Se);if(Ve)return Ve[1];var Rt=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Se);return Rt?Rt[1]:"unknown"}function j(){var Z=new Error,Se=(Z.stack||Z).toString(),Ve=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Se);if(Ve)return Ve[1];var Rt=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Se);return Rt?Rt[1]:"unknown"}function H(Z,Se){var Ve=Z.split(`
`),Rt=1,tr=0,kt={unknown:new k,0:new k};kt.unknown.name=kt[0].name=Se||$(),kt.unknown.lines.push(new R(0,""));for(var Yt=0;Yt<Ve.length;++Yt){var sr=Ve[Yt],mr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(sr);if(mr)switch(mr[1]){case"line":var Cr=/(\d+)(\s+\d+)?/.exec(mr[2]);Cr&&(Rt=Cr[1]|0,Cr[2]&&(tr=Cr[2]|0,tr in kt||(kt[tr]=new k)));break;case"define":var wr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(mr[2]);wr&&(kt[tr].name=wr[1]?o(wr[2]):wr[2]);break}kt[tr].lines.push(new R(Rt++,sr))}return Object.keys(kt).forEach(function(dr){var xr=kt[dr];xr.lines.forEach(function(vr){xr.index[vr.number]=vr})}),kt}function ee(Z){var Se=[];return Z.split(`
`).forEach(function(Ve){if(!(Ve.length<5)){var Rt=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Ve);Rt?Se.push(new D(Rt[1]|0,Rt[2]|0,Rt[3].trim())):Ve.length>0&&Se.push(new D("unknown",0,Ve))}}),Se}function U(Z,Se){Se.forEach(function(Ve){var Rt=Z[Ve.file];if(Rt){var tr=Rt.index[Ve.line];if(tr){tr.errors.push(Ve),Rt.hasErrors=!0;return}}Z.unknown.hasErrors=!0,Z.unknown.lines[0].errors.push(Ve)})}function W(Z,Se,Ve,Rt,tr){if(!Z.getShaderParameter(Se,Z.COMPILE_STATUS)){var kt=Z.getShaderInfoLog(Se),Yt=Rt===Z.FRAGMENT_SHADER?"fragment":"vertex";We(Ve,"string",Yt+" shader source must be a string",tr);var sr=H(Ve,tr),mr=ee(kt);U(sr,mr),Object.keys(sr).forEach(function(Cr){var wr=sr[Cr];if(!wr.hasErrors)return;var dr=[""],xr=[""];function vr(Er,_t){dr.push(Er),xr.push(_t||"")}vr("file number "+Cr+": "+wr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),wr.lines.forEach(function(Er){if(Er.errors.length>0){vr(L(Er.number,4)+"|  ","background-color:yellow; font-weight:bold"),vr(Er.line+a,"color:red; background-color:yellow; font-weight:bold");var _t=0;Er.errors.forEach(function(Gt){var _r=Gt.message,Zr=/^\s*'(.*)'\s*:\s*(.*)$/.exec(_r);if(Zr){var or=Zr[1];switch(_r=Zr[2],or){case"assign":or="=";break}_t=Math.max(Er.line.indexOf(or,_t),0)}else _t=0;vr(L("| ",6)),vr(L("^^^",_t+3)+a,"font-weight:bold"),vr(L("| ",6)),vr(_r+a,"font-weight:bold")}),vr(L("| ",6)+a)}else vr(L(Er.number,4)+"|  "),vr(Er.line+a,"color:red")}),typeof document!="undefined"&&!window.chrome?(xr[0]=dr.join("%c"),console.log.apply(console,xr)):console.log(dr.join(""))}),u.raise("Error compiling "+Yt+" shader, "+sr[0].name)}}function Q(Z,Se,Ve,Rt,tr){if(!Z.getProgramParameter(Se,Z.LINK_STATUS)){var kt=Z.getProgramInfoLog(Se),Yt=H(Ve,tr),sr=H(Rt,tr),mr='Error linking program with vertex shader, "'+sr[0].name+'", and fragment shader "'+Yt[0].name+'"';typeof document!="undefined"?console.log("%c"+mr+a+"%c"+kt,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(mr+a+kt),u.raise(mr)}}function te(Z){Z._commandRef=$()}function ie(Z,Se,Ve,Rt){te(Z);function tr(mr){return mr?Rt.id(mr):0}Z._fragId=tr(Z.static.frag),Z._vertId=tr(Z.static.vert);function kt(mr,Cr){Object.keys(Cr).forEach(function(wr){mr[Rt.id(wr)]=!0})}var Yt=Z._uniformSet={};kt(Yt,Se.static),kt(Yt,Se.dynamic);var sr=Z._attributeSet={};kt(sr,Ve.static),kt(sr,Ve.dynamic),Z._hasCount="count"in Z.static||"count"in Z.dynamic||"elements"in Z.static||"elements"in Z.dynamic}function ve(Z,Se){var Ve=j();s(Z+" in command "+(Se||$())+(Ve==="unknown"?"":" called from "+Ve))}function me(Z,Se,Ve){Z||ve(Se,Ve||$())}function Re(Z,Se,Ve,Rt){Z in Se||ve("unknown parameter ("+Z+")"+l(Ve)+". possible values: "+Object.keys(Se).join(),Rt||$())}function We(Z,Se,Ve,Rt){p(Z,Se)||ve("invalid parameter type"+l(Ve)+". expected "+Se+", got "+typeof Z,Rt||$())}function je(Z){Z()}function lt(Z,Se,Ve){Z.texture?x(Z.texture._texture.internalformat,Se,"unsupported texture format for attachment"):x(Z.renderbuffer._renderbuffer.format,Ve,"unsupported renderbuffer format for attachment")}var dt=33071,ct=9728,Tt=9984,It=9985,Lt=9986,rn=9987,wn=5120,zn=5121,Zt=5122,nn=5123,mn=5124,zt=5125,Vr=5126,On=32819,Si=32820,Fn=33635,Ai=34042,Ua=36193,va={};va[wn]=va[zn]=1,va[Zt]=va[nn]=va[Ua]=va[Fn]=va[On]=va[Si]=2,va[mn]=va[zt]=va[Vr]=va[Ai]=4;function Va(Z,Se){return Z===Si||Z===On||Z===Fn?2:Z===Ai?4:va[Z]*Se}function to(Z){return!(Z&Z-1)&&!!Z}function Os(Z,Se,Ve){var Rt,tr=Se.width,kt=Se.height,Yt=Se.channels;u(tr>0&&tr<=Ve.maxTextureSize&&kt>0&&kt<=Ve.maxTextureSize,"invalid texture shape"),(Z.wrapS!==dt||Z.wrapT!==dt)&&u(to(tr)&&to(kt),"incompatible wrap mode for texture, both width and height must be power of 2"),Se.mipmask===1?tr!==1&&kt!==1&&u(Z.minFilter!==Tt&&Z.minFilter!==Lt&&Z.minFilter!==It&&Z.minFilter!==rn,"min filter requires mipmap"):(u(to(tr)&&to(kt),"texture must be a square power of 2 to support mipmapping"),u(Se.mipmask===(tr<<1)-1,"missing or incomplete mipmap data")),Se.type===Vr&&(Ve.extensions.indexOf("oes_texture_float_linear")<0&&u(Z.minFilter===ct&&Z.magFilter===ct,"filter not supported, must enable oes_texture_float_linear"),u(!Z.genMipmaps,"mipmap generation not supported with float textures"));var sr=Se.images;for(Rt=0;Rt<16;++Rt)if(sr[Rt]){var mr=tr>>Rt,Cr=kt>>Rt;u(Se.mipmask&1<<Rt,"missing mipmap data");var wr=sr[Rt];if(u(wr.width===mr&&wr.height===Cr,"invalid shape for mip images"),u(wr.format===Se.format&&wr.internalformat===Se.internalformat&&wr.type===Se.type,"incompatible type for mip image"),!wr.compressed)if(wr.data){var dr=Math.ceil(Va(wr.type,Yt)*mr/wr.unpackAlignment)*wr.unpackAlignment;u(wr.data.byteLength===dr*Cr,"invalid data for image, buffer size is inconsistent with image format")}else wr.element||wr.copy}else Z.genMipmaps||u((Se.mipmask&1<<Rt)===0,"extra mipmap data");Se.compressed&&u(!Z.genMipmaps,"mipmap generation for compressed images not supported")}function Ro(Z,Se,Ve,Rt){var tr=Z.width,kt=Z.height,Yt=Z.channels;u(tr>0&&tr<=Rt.maxTextureSize&&kt>0&&kt<=Rt.maxTextureSize,"invalid texture shape"),u(tr===kt,"cube map must be square"),u(Se.wrapS===dt&&Se.wrapT===dt,"wrap mode not supported by cube map");for(var sr=0;sr<Ve.length;++sr){var mr=Ve[sr];u(mr.width===tr&&mr.height===kt,"inconsistent cube map face shape"),Se.genMipmaps&&(u(!mr.compressed,"can not generate mipmap for compressed textures"),u(mr.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Cr=mr.images,wr=0;wr<16;++wr){var dr=Cr[wr];if(dr){var xr=tr>>wr,vr=kt>>wr;u(mr.mipmask&1<<wr,"missing mipmap data"),u(dr.width===xr&&dr.height===vr,"invalid shape for mip images"),u(dr.format===Z.format&&dr.internalformat===Z.internalformat&&dr.type===Z.type,"incompatible type for mip image"),dr.compressed||(dr.data?u(dr.data.byteLength===xr*vr*Math.max(Va(dr.type,Yt),dr.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):dr.element||dr.copy)}}}}var ne=i(u,{optional:je,raise:s,commandRaise:ve,command:me,parameter:f,commandParameter:Re,constructor:A,type:v,commandType:We,isTypedArray:h,nni:m,oneOf:x,shaderError:W,linkError:Q,callSite:j,saveCommandRef:te,saveDrawInfo:ie,framebufferFormat:lt,guessCommand:$,texture2D:Os,textureCube:Ro}),Qt=0,gr=0,hn=5,$n=6;function Ta(Z,Se){this.id=Qt++,this.type=Z,this.data=Se}function Qn(Z){return Z.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ci(Z){if(Z.length===0)return[];var Se=Z.charAt(0),Ve=Z.charAt(Z.length-1);if(Z.length>1&&Se===Ve&&(Se==='"'||Se==="'"))return['"'+Qn(Z.substr(1,Z.length-2))+'"'];var Rt=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Z);if(Rt)return ci(Z.substr(0,Rt.index)).concat(ci(Rt[1])).concat(ci(Z.substr(Rt.index+Rt[0].length)));var tr=Z.split(".");if(tr.length===1)return['"'+Qn(Z)+'"'];for(var kt=[],Yt=0;Yt<tr.length;++Yt)kt=kt.concat(ci(tr[Yt]));return kt}function Wn(Z){return"["+ci(Z).join("][")+"]"}function Ti(Z,Se){return new Ta(Z,Wn(Se+""))}function Li(Z){return typeof Z=="function"&&!Z._reglType||Z instanceof Ta}function Oo(Z,Se){if(typeof Z=="function")return new Ta(gr,Z);if(typeof Z=="number"||typeof Z=="boolean")return new Ta(hn,Z);if(Array.isArray(Z))return new Ta($n,Z.map(function(Ve,Rt){return Oo(Ve,Se+"["+Rt+"]")}));if(Z instanceof Ta)return Z;ne(!1,"invalid option type in uniform "+Se)}var Fo={DynamicVariable:Ta,define:Ti,isDynamic:Li,unbox:Oo,accessor:Wn},xl={next:typeof requestAnimationFrame=="function"?function(Z){return requestAnimationFrame(Z)}:function(Z){return setTimeout(Z,16)},cancel:typeof cancelAnimationFrame=="function"?function(Z){return cancelAnimationFrame(Z)}:clearTimeout},Fc=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,gf=Fc?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Gl(){var Z={"":0},Se=[""];return{id:function(Ve){var Rt=Z[Ve];return Rt||(Rt=Z[Ve]=Se.length,Se.push(Ve),Rt)},str:function(Ve){return Se[Ve]}}}function iu(Z,Se,Ve){var Rt=document.createElement("canvas");i(Rt.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),Z.appendChild(Rt),Z===document.body&&(Rt.style.position="absolute",i(Z.style,{margin:0,padding:0}));function tr(){var sr=window.innerWidth,mr=window.innerHeight;if(Z!==document.body){var Cr=Rt.getBoundingClientRect();sr=Cr.right-Cr.left,mr=Cr.bottom-Cr.top}Rt.width=Ve*sr,Rt.height=Ve*mr}var kt;Z!==document.body&&typeof ResizeObserver=="function"?(kt=new ResizeObserver(function(){setTimeout(tr)}),kt.observe(Z)):window.addEventListener("resize",tr,!1);function Yt(){kt?kt.disconnect():window.removeEventListener("resize",tr),Z.removeChild(Rt)}return tr(),{canvas:Rt,onDestroy:Yt}}function bl(Z,Se){function Ve(Rt){try{return Z.getContext(Rt,Se)}catch{return null}}return Ve("webgl")||Ve("experimental-webgl")||Ve("webgl-experimental")}function Dc(Z){return typeof Z.nodeName=="string"&&typeof Z.appendChild=="function"&&typeof Z.getBoundingClientRect=="function"}function mf(Z){return typeof Z.drawArrays=="function"||typeof Z.drawElements=="function"}function fo(Z){return typeof Z=="string"?Z.split():(ne(Array.isArray(Z),"invalid extension array"),Z)}function ae(Z){return typeof Z=="string"?(ne(typeof document!="undefined","not supported outside of DOM"),document.querySelector(Z)):Z}function ue(Z){var Se=Z||{},Ve,Rt,tr,kt,Yt={},sr=[],mr=[],Cr=typeof window=="undefined"?1:window.devicePixelRatio,wr=!1,dr=function(Er){Er&&ne.raise(Er)},xr=function(){};if(typeof Se=="string"?(ne(typeof document!="undefined","selector queries only supported in DOM environments"),Ve=document.querySelector(Se),ne(Ve,"invalid query string for element")):typeof Se=="object"?Dc(Se)?Ve=Se:mf(Se)?(kt=Se,tr=kt.canvas):(ne.constructor(Se),"gl"in Se?kt=Se.gl:"canvas"in Se?tr=ae(Se.canvas):"container"in Se&&(Rt=ae(Se.container)),"attributes"in Se&&(Yt=Se.attributes,ne.type(Yt,"object","invalid context attributes")),"extensions"in Se&&(sr=fo(Se.extensions)),"optionalExtensions"in Se&&(mr=fo(Se.optionalExtensions)),"onDone"in Se&&(ne.type(Se.onDone,"function","invalid or missing onDone callback"),dr=Se.onDone),"profile"in Se&&(wr=!!Se.profile),"pixelRatio"in Se&&(Cr=+Se.pixelRatio,ne(Cr>0,"invalid pixel ratio"))):ne.raise("invalid arguments to regl"),Ve&&(Ve.nodeName.toLowerCase()==="canvas"?tr=Ve:Rt=Ve),!kt){if(!tr){ne(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var vr=iu(Rt||document.body,dr,Cr);if(!vr)return null;tr=vr.canvas,xr=vr.onDestroy}Yt.premultipliedAlpha===void 0&&(Yt.premultipliedAlpha=!0),kt=bl(tr,Yt)}return kt?{gl:kt,canvas:tr,container:Rt,extensions:sr,optionalExtensions:mr,pixelRatio:Cr,profile:wr,onDone:dr,onDestroy:xr}:(xr(),dr("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function fe(Z,Se){var Ve={};function Rt(sr){ne.type(sr,"string","extension name must be string");var mr=sr.toLowerCase(),Cr;try{Cr=Ve[mr]=tr(sr)}catch{}return!!Cr}function tr(sr){return Z.getExtension(sr)?Z.getExtension(sr):Z.getExtension(sr.toLowerCase())?Z.getExtension(sr.toLowerCase()):null}for(var kt=0;kt<Se.extensions.length;++kt){var Yt=Se.extensions[kt];if(!Rt(Yt))return Se.onDestroy(),Se.onDone('"'+Yt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Se.optionalExtensions.forEach(Rt),{extensions:Ve,restore:function(){Object.keys(Ve).forEach(function(sr){if(Ve[sr]&&!Rt(sr))throw new Error("(regl): error restoring extension "+sr)})}}}function Ce(Z,Se){for(var Ve=Array(Z),Rt=0;Rt<Z;++Rt)Ve[Rt]=Se(Rt);return Ve}var Ne=5120,it=5121,pt=5122,_e=5123,Ge=5124,wt=5125,cr=5126;function fr(Z){for(var Se=16;Se<=1<<28;Se*=16)if(Z<=Se)return Se;return 0}function $t(Z){var Se,Ve;return Se=(Z>65535)<<4,Z>>>=Se,Ve=(Z>255)<<3,Z>>>=Ve,Se|=Ve,Ve=(Z>15)<<2,Z>>>=Ve,Se|=Ve,Ve=(Z>3)<<1,Z>>>=Ve,Se|=Ve,Se|Z>>1}function pr(){var Z=Ce(8,function(){return[]});function Se(kt){var Yt=fr(kt),sr=Z[$t(Yt)>>2];return sr.length>0?sr.pop():new ArrayBuffer(Yt)}function Ve(kt){Z[$t(kt.byteLength)>>2].push(kt)}function Rt(kt,Yt){var sr=null;switch(kt){case Ne:sr=new Int8Array(Se(Yt),0,Yt);break;case it:sr=new Uint8Array(Se(Yt),0,Yt);break;case pt:sr=new Int16Array(Se(2*Yt),0,Yt);break;case _e:sr=new Uint16Array(Se(2*Yt),0,Yt);break;case Ge:sr=new Int32Array(Se(4*Yt),0,Yt);break;case wt:sr=new Uint32Array(Se(4*Yt),0,Yt);break;case cr:sr=new Float32Array(Se(4*Yt),0,Yt);break;default:return null}return sr.length!==Yt?sr.subarray(0,Yt):sr}function tr(kt){Ve(kt.buffer)}return{alloc:Se,free:Ve,allocType:Rt,freeType:tr}}var Rr=pr();Rr.zero=pr();var cn=3408,Ht=3410,an=3411,Br=3412,$r=3413,Ln=3414,Tr=3415,Sn=33901,pi=33902,oi=3379,Pi=3386,Oi=34921,Gs=36347,Qi=36348,Ki=35661,oa=35660,bi=34930,Ni=36349,Fs=34076,Xu=34024,ho=7936,au=7937,bp=7938,Bc=35724,ya=34047,yf=36063,Ds=34852,po=3553,_u=34067,Za=34069,Pu=33984,bo=6408,yh=5126,Yu=5121,_h=36160,wl=36053,ws=36064,Ru=16384,he=function(Z,Se){var Ve=1;Se.ext_texture_filter_anisotropic&&(Ve=Z.getParameter(ya));var Rt=1,tr=1;Se.webgl_draw_buffers&&(Rt=Z.getParameter(Ds),tr=Z.getParameter(yf));var kt=!!Se.oes_texture_float;if(kt){var Yt=Z.createTexture();Z.bindTexture(po,Yt),Z.texImage2D(po,0,bo,1,1,0,bo,yh,null);var sr=Z.createFramebuffer();if(Z.bindFramebuffer(_h,sr),Z.framebufferTexture2D(_h,ws,po,Yt,0),Z.bindTexture(po,null),Z.checkFramebufferStatus(_h)!==wl)kt=!1;else{Z.viewport(0,0,1,1),Z.clearColor(1,0,0,1),Z.clear(Ru);var mr=Rr.allocType(yh,4);Z.readPixels(0,0,1,1,bo,yh,mr),Z.getError()?kt=!1:(Z.deleteFramebuffer(sr),Z.deleteTexture(Yt),kt=mr[0]===1),Rr.freeType(mr)}}var Cr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),wr=!0;if(!Cr){var dr=Z.createTexture(),xr=Rr.allocType(Yu,36);Z.activeTexture(Pu),Z.bindTexture(_u,dr),Z.texImage2D(Za,0,bo,3,3,0,bo,Yu,xr),Rr.freeType(xr),Z.bindTexture(_u,null),Z.deleteTexture(dr),wr=!Z.getError()}return{colorBits:[Z.getParameter(Ht),Z.getParameter(an),Z.getParameter(Br),Z.getParameter($r)],depthBits:Z.getParameter(Ln),stencilBits:Z.getParameter(Tr),subpixelBits:Z.getParameter(cn),extensions:Object.keys(Se).filter(function(vr){return!!Se[vr]}),maxAnisotropic:Ve,maxDrawbuffers:Rt,maxColorAttachments:tr,pointSizeDims:Z.getParameter(Sn),lineWidthDims:Z.getParameter(pi),maxViewportDims:Z.getParameter(Pi),maxCombinedTextureUnits:Z.getParameter(Ki),maxCubeMapSize:Z.getParameter(Fs),maxRenderbufferSize:Z.getParameter(Xu),maxTextureUnits:Z.getParameter(bi),maxTextureSize:Z.getParameter(oi),maxAttributes:Z.getParameter(Oi),maxVertexUniforms:Z.getParameter(Gs),maxVertexTextureUnits:Z.getParameter(oa),maxVaryingVectors:Z.getParameter(Qi),maxFragmentUniforms:Z.getParameter(Ni),glsl:Z.getParameter(Bc),renderer:Z.getParameter(au),vendor:Z.getParameter(ho),version:Z.getParameter(bp),readFloat:kt,npotTextureCube:wr}};function Te(Z){return!!Z&&typeof Z=="object"&&Array.isArray(Z.shape)&&Array.isArray(Z.stride)&&typeof Z.offset=="number"&&Z.shape.length===Z.stride.length&&(Array.isArray(Z.data)||n(Z.data))}var et=function(Z){return Object.keys(Z).map(function(Se){return Z[Se]})},jt={shape:xu,flatten:Hs};function Or(Z,Se,Ve){for(var Rt=0;Rt<Se;++Rt)Ve[Rt]=Z[Rt]}function Bn(Z,Se,Ve,Rt){for(var tr=0,kt=0;kt<Se;++kt)for(var Yt=Z[kt],sr=0;sr<Ve;++sr)Rt[tr++]=Yt[sr]}function Ji(Z,Se,Ve,Rt,tr,kt){for(var Yt=kt,sr=0;sr<Se;++sr)for(var mr=Z[sr],Cr=0;Cr<Ve;++Cr)for(var wr=mr[Cr],dr=0;dr<Rt;++dr)tr[Yt++]=wr[dr]}function Bs(Z,Se,Ve,Rt,tr){for(var kt=1,Yt=Ve+1;Yt<Se.length;++Yt)kt*=Se[Yt];var sr=Se[Ve];if(Se.length-Ve===4){var mr=Se[Ve+1],Cr=Se[Ve+2],wr=Se[Ve+3];for(Yt=0;Yt<sr;++Yt)Ji(Z[Yt],mr,Cr,wr,Rt,tr),tr+=kt}else for(Yt=0;Yt<sr;++Yt)Bs(Z[Yt],Se,Ve+1,Rt,tr),tr+=kt}function Hs(Z,Se,Ve,Rt){var tr=1;if(Se.length)for(var kt=0;kt<Se.length;++kt)tr*=Se[kt];else tr=0;var Yt=Rt||Rr.allocType(Ve,tr);switch(Se.length){case 0:break;case 1:Or(Z,Se[0],Yt);break;case 2:Bn(Z,Se[0],Se[1],Yt);break;case 3:Ji(Z,Se[0],Se[1],Se[2],Yt,0);break;default:Bs(Z,Se,0,Yt,0)}return Yt}function xu(Z){for(var Se=[],Ve=Z;Ve.length;Ve=Ve[0])Se.push(Ve.length);return Se}var js={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},dm=5120,nv=5122,zy=5124,ng=5121,Cl=5123,xh=5125,bh=5126,wp=5126,El={int8:dm,int16:nv,int32:zy,uint8:ng,uint16:Cl,uint32:xh,float:bh,float32:wp},wh=35048,wo=35040,ea={dynamic:wh,stream:wo,static:35044},us=jt.flatten,Cp=jt.shape,vm=35044,P_=35040,gm=5121,iv=5126,Nc=[];Nc[5120]=1,Nc[5122]=2,Nc[5124]=4,Nc[5121]=1,Nc[5123]=2,Nc[5125]=4,Nc[5126]=4;function sd(Z){return js[Object.prototype.toString.call(Z)]|0}function Ws(Z,Se){for(var Ve=0;Ve<Se.length;++Ve)Z[Ve]=Se[Ve]}function av(Z,Se,Ve,Rt,tr,kt,Yt){for(var sr=0,mr=0;mr<Ve;++mr)for(var Cr=0;Cr<Rt;++Cr)Z[sr++]=Se[tr*mr+kt*Cr+Yt]}function Ch(Z,Se,Ve,Rt){var tr=0,kt={};function Yt(_t){this.id=tr++,this.buffer=Z.createBuffer(),this.type=_t,this.usage=vm,this.byteLength=0,this.dimension=1,this.dtype=gm,this.persistentData=null,Ve.profile&&(this.stats={size:0})}Yt.prototype.bind=function(){Z.bindBuffer(this.type,this.buffer)},Yt.prototype.destroy=function(){xr(this)};var sr=[];function mr(_t,Gt){var _r=sr.pop();return _r||(_r=new Yt(_t)),_r.bind(),dr(_r,Gt,P_,0,1,!1),_r}function Cr(_t){sr.push(_t)}function wr(_t,Gt,_r){_t.byteLength=Gt.byteLength,Z.bufferData(_t.type,Gt,_r)}function dr(_t,Gt,_r,Zr,or,Fr){var Hr;if(_t.usage=_r,Array.isArray(Gt)){if(_t.dtype=Zr||iv,Gt.length>0){var xn;if(Array.isArray(Gt[0])){Hr=Cp(Gt);for(var Jt=1,qt=1;qt<Hr.length;++qt)Jt*=Hr[qt];_t.dimension=Jt,xn=us(Gt,Hr,_t.dtype),wr(_t,xn,_r),Fr?_t.persistentData=xn:Rr.freeType(xn)}else if(typeof Gt[0]=="number"){_t.dimension=or;var jr=Rr.allocType(_t.dtype,Gt.length);Ws(jr,Gt),wr(_t,jr,_r),Fr?_t.persistentData=jr:Rr.freeType(jr)}else n(Gt[0])?(_t.dimension=Gt[0].length,_t.dtype=Zr||sd(Gt[0])||iv,xn=us(Gt,[Gt.length,Gt[0].length],_t.dtype),wr(_t,xn,_r),Fr?_t.persistentData=xn:Rr.freeType(xn)):ne.raise("invalid buffer data")}}else if(n(Gt))_t.dtype=Zr||sd(Gt),_t.dimension=or,wr(_t,Gt,_r),Fr&&(_t.persistentData=new Uint8Array(new Uint8Array(Gt.buffer)));else if(Te(Gt)){Hr=Gt.shape;var Ur=Gt.stride,br=Gt.offset,qr=0,Qr=0,li=0,ii=0;Hr.length===1?(qr=Hr[0],Qr=1,li=Ur[0],ii=0):Hr.length===2?(qr=Hr[0],Qr=Hr[1],li=Ur[0],ii=Ur[1]):ne.raise("invalid shape"),_t.dtype=Zr||sd(Gt.data)||iv,_t.dimension=Qr;var sn=Rr.allocType(_t.dtype,qr*Qr);av(sn,Gt.data,qr,Qr,li,ii,br),wr(_t,sn,_r),Fr?_t.persistentData=sn:Rr.freeType(sn)}else Gt instanceof ArrayBuffer?(_t.dtype=gm,_t.dimension=or,wr(_t,Gt,_r),Fr&&(_t.persistentData=new Uint8Array(new Uint8Array(Gt)))):ne.raise("invalid buffer data")}function xr(_t){Se.bufferCount--,Rt(_t);var Gt=_t.buffer;ne(Gt,"buffer must not be deleted already"),Z.deleteBuffer(Gt),_t.buffer=null,delete kt[_t.id]}function vr(_t,Gt,_r,Zr){Se.bufferCount++;var or=new Yt(Gt);kt[or.id]=or;function Fr(Jt){var qt=vm,jr=null,Ur=0,br=0,qr=1;return Array.isArray(Jt)||n(Jt)||Te(Jt)||Jt instanceof ArrayBuffer?jr=Jt:typeof Jt=="number"?Ur=Jt|0:Jt&&(ne.type(Jt,"object","buffer arguments must be an object, a number or an array"),"data"in Jt&&(ne(jr===null||Array.isArray(jr)||n(jr)||Te(jr),"invalid data for buffer"),jr=Jt.data),"usage"in Jt&&(ne.parameter(Jt.usage,ea,"invalid buffer usage"),qt=ea[Jt.usage]),"type"in Jt&&(ne.parameter(Jt.type,El,"invalid buffer type"),br=El[Jt.type]),"dimension"in Jt&&(ne.type(Jt.dimension,"number","invalid dimension"),qr=Jt.dimension|0),"length"in Jt&&(ne.nni(Ur,"buffer length must be a nonnegative integer"),Ur=Jt.length|0)),or.bind(),jr?dr(or,jr,qt,br,qr,Zr):(Ur&&Z.bufferData(or.type,Ur,qt),or.dtype=br||gm,or.usage=qt,or.dimension=qr,or.byteLength=Ur),Ve.profile&&(or.stats.size=or.byteLength*Nc[or.dtype]),Fr}function Hr(Jt,qt){ne(qt+Jt.byteLength<=or.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Jt.byteLength+" starting from offset "+qt+" to a buffer of size "+or.byteLength),Z.bufferSubData(or.type,qt,Jt)}function xn(Jt,qt){var jr=(qt||0)|0,Ur;if(or.bind(),n(Jt)||Jt instanceof ArrayBuffer)Hr(Jt,jr);else if(Array.isArray(Jt)){if(Jt.length>0)if(typeof Jt[0]=="number"){var br=Rr.allocType(or.dtype,Jt.length);Ws(br,Jt),Hr(br,jr),Rr.freeType(br)}else if(Array.isArray(Jt[0])||n(Jt[0])){Ur=Cp(Jt);var qr=us(Jt,Ur,or.dtype);Hr(qr,jr),Rr.freeType(qr)}else ne.raise("invalid buffer data")}else if(Te(Jt)){Ur=Jt.shape;var Qr=Jt.stride,li=0,ii=0,sn=0,ln=0;Ur.length===1?(li=Ur[0],ii=1,sn=Qr[0],ln=0):Ur.length===2?(li=Ur[0],ii=Ur[1],sn=Qr[0],ln=Qr[1]):ne.raise("invalid shape");var Xn=Array.isArray(Jt.data)?or.dtype:sd(Jt.data),fi=Rr.allocType(Xn,li*ii);av(fi,Jt.data,li,ii,sn,ln,Jt.offset),Hr(fi,jr),Rr.freeType(fi)}else ne.raise("invalid data for buffer subdata");return Fr}return _r||Fr(_t),Fr._reglType="buffer",Fr._buffer=or,Fr.subdata=xn,Ve.profile&&(Fr.stats=or.stats),Fr.destroy=function(){xr(or)},Fr}function Er(){et(kt).forEach(function(_t){_t.buffer=Z.createBuffer(),Z.bindBuffer(_t.type,_t.buffer),Z.bufferData(_t.type,_t.persistentData||_t.byteLength,_t.usage)})}return Ve.profile&&(Se.getTotalBufferSize=function(){var _t=0;return Object.keys(kt).forEach(function(Gt){_t+=kt[Gt].stats.size}),_t}),{create:vr,createStream:mr,destroyStream:Cr,clear:function(){et(kt).forEach(xr),sr.forEach(xr)},getBuffer:function(_t){return _t&&_t._buffer instanceof Yt?_t._buffer:null},restore:Er,_initBuffer:dr}}var $y=0,Ep=0,Zu=1,mm=1,ou=4,ig=4,qu={points:$y,point:Ep,lines:Zu,line:mm,triangles:ou,triangle:ig,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Vf=0,Eh=1,hs=4,Sh=5120,ps=5121,Ah=5122,Sl=5123,_f=5124,zc=5125,Ma=34963,ls=35040,$c=35044;function ag(Z,Se,Ve,Rt){var tr={},kt=0,Yt={uint8:ps,uint16:Sl};Se.oes_element_index_uint&&(Yt.uint32=zc);function sr(Er){this.id=kt++,tr[this.id]=this,this.buffer=Er,this.primType=hs,this.vertCount=0,this.type=0}sr.prototype.bind=function(){this.buffer.bind()};var mr=[];function Cr(Er){var _t=mr.pop();return _t||(_t=new sr(Ve.create(null,Ma,!0,!1)._buffer)),dr(_t,Er,ls,-1,-1,0,0),_t}function wr(Er){mr.push(Er)}function dr(Er,_t,Gt,_r,Zr,or,Fr){Er.buffer.bind();var Hr;if(_t){var xn=Fr;!Fr&&(!n(_t)||Te(_t)&&!n(_t.data))&&(xn=Se.oes_element_index_uint?zc:Sl),Ve._initBuffer(Er.buffer,_t,Gt,xn,3)}else Z.bufferData(Ma,or,Gt),Er.buffer.dtype=Hr||ps,Er.buffer.usage=Gt,Er.buffer.dimension=3,Er.buffer.byteLength=or;if(Hr=Fr,!Fr){switch(Er.buffer.dtype){case ps:case Sh:Hr=ps;break;case Sl:case Ah:Hr=Sl;break;case zc:case _f:Hr=zc;break;default:ne.raise("unsupported type for element array")}Er.buffer.dtype=Hr}Er.type=Hr,ne(Hr!==zc||!!Se.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Jt=Zr;Jt<0&&(Jt=Er.buffer.byteLength,Hr===Sl?Jt>>=1:Hr===zc&&(Jt>>=2)),Er.vertCount=Jt;var qt=_r;if(_r<0){qt=hs;var jr=Er.buffer.dimension;jr===1&&(qt=Vf),jr===2&&(qt=Eh),jr===3&&(qt=hs)}Er.primType=qt}function xr(Er){Rt.elementsCount--,ne(Er.buffer!==null,"must not double destroy elements"),delete tr[Er.id],Er.buffer.destroy(),Er.buffer=null}function vr(Er,_t){var Gt=Ve.create(null,Ma,!0),_r=new sr(Gt._buffer);Rt.elementsCount++;function Zr(or){if(!or)Gt(),_r.primType=hs,_r.vertCount=0,_r.type=ps;else if(typeof or=="number")Gt(or),_r.primType=hs,_r.vertCount=or|0,_r.type=ps;else{var Fr=null,Hr=$c,xn=-1,Jt=-1,qt=0,jr=0;Array.isArray(or)||n(or)||Te(or)?Fr=or:(ne.type(or,"object","invalid arguments for elements"),"data"in or&&(Fr=or.data,ne(Array.isArray(Fr)||n(Fr)||Te(Fr),"invalid data for element buffer")),"usage"in or&&(ne.parameter(or.usage,ea,"invalid element buffer usage"),Hr=ea[or.usage]),"primitive"in or&&(ne.parameter(or.primitive,qu,"invalid element buffer primitive"),xn=qu[or.primitive]),"count"in or&&(ne(typeof or.count=="number"&&or.count>=0,"invalid vertex count for elements"),Jt=or.count|0),"type"in or&&(ne.parameter(or.type,Yt,"invalid buffer type"),jr=Yt[or.type]),"length"in or?qt=or.length|0:(qt=Jt,jr===Sl||jr===Ah?qt*=2:(jr===zc||jr===_f)&&(qt*=4))),dr(_r,Fr,Hr,xn,Jt,qt,jr)}return Zr}return Zr(Er),Zr._reglType="elements",Zr._elements=_r,Zr.subdata=function(or,Fr){return Gt.subdata(or,Fr),Zr},Zr.destroy=function(){xr(_r)},Zr}return{create:vr,createStream:Cr,destroyStream:wr,getElements:function(Er){return typeof Er=="function"&&Er._elements instanceof sr?Er._elements:null},clear:function(){et(tr).forEach(xr)}}}var ym=new Float32Array(1),og=new Uint32Array(ym.buffer),Uy=5123;function Th(Z){for(var Se=Rr.allocType(Uy,Z.length),Ve=0;Ve<Z.length;++Ve)if(isNaN(Z[Ve]))Se[Ve]=65535;else if(Z[Ve]===1/0)Se[Ve]=31744;else if(Z[Ve]===-1/0)Se[Ve]=64512;else{ym[0]=Z[Ve];var Rt=og[0],tr=Rt>>>31<<15,kt=(Rt<<1>>>24)-127,Yt=Rt>>13&(1<<10)-1;if(kt<-24)Se[Ve]=tr;else if(kt<-14){var sr=-14-kt;Se[Ve]=tr+(Yt+(1<<10)>>sr)}else kt>15?Se[Ve]=tr+31744:Se[Ve]=tr+(kt+15<<10)+Yt}return Se}function ro(Z){return Array.isArray(Z)||n(Z)}var Gf=function(Z){return!(Z&Z-1)&&!!Z},ov=34467,Ku=3553,sv=34067,Uc=34069,Hf=6408,Vc=6406,lc=6407,Sp=6409,Mh=6410,Ga=32854,Lh=32855,Vy=36194,Ap=32819,Al=32820,_m=33635,ud=34042,Tp=6402,xf=34041,Mp=35904,ld=35906,bf=36193,Ih=33776,sg=33777,Hl=33778,jl=33779,xm=35986,uv=35987,ug=34798,fl=35840,jf=35841,lv=35842,lg=35843,cv=36196,Gc=5121,Qu=5123,cd=5125,fd=5126,Gy=10242,cg=10243,bm=10497,fv=33071,kh=33648,bt=10240,lr=10241,Xt=9728,Jr=9729,Ii=9984,ga=9985,To=9986,Un=9987,qa=33170,Ju=4352,el=4353,Wf=4354,hv=34046,hd=3317,fg=37440,Ph=37441,Fa=37443,wf=37444,Do=33984,Rh=[Ii,To,ga,Un],pv=[0,Sp,Mh,lc,Hf],Da={};Da[Sp]=Da[Vc]=Da[Tp]=1,Da[xf]=Da[Mh]=2,Da[lc]=Da[Mp]=3,Da[Hf]=Da[ld]=4;function dn(Z){return"[object "+Z+"]"}var bu=dn("HTMLCanvasElement"),cc=dn("OffscreenCanvas"),Cf=dn("CanvasRenderingContext2D"),Wl=dn("ImageBitmap"),wu=dn("HTMLImageElement"),dv=dn("HTMLVideoElement"),Yr=Object.keys(js).concat([bu,cc,Cf,Wl,wu,dv]),Hc=[];Hc[Gc]=1,Hc[fd]=4,Hc[bf]=2,Hc[Qu]=2,Hc[cd]=4;var Cs=[];Cs[Ga]=2,Cs[Lh]=2,Cs[Vy]=2,Cs[xf]=4,Cs[Ih]=.5,Cs[sg]=.5,Cs[Hl]=1,Cs[jl]=1,Cs[xm]=.5,Cs[uv]=1,Cs[ug]=1,Cs[fl]=.5,Cs[jf]=.25,Cs[lv]=.5,Cs[lg]=.25,Cs[cv]=.5;function Oh(Z){return Array.isArray(Z)&&(Z.length===0||typeof Z[0]=="number")}function su(Z){if(!Array.isArray(Z))return!1;var Se=Z.length;return!(Se===0||!ro(Z[0]))}function ds(Z){return Object.prototype.toString.call(Z)}function vv(Z){return ds(Z)===bu}function gv(Z){return ds(Z)===cc}function Tl(Z){return ds(Z)===Cf}function fc(Z){return ds(Z)===Wl}function mv(Z){return ds(Z)===wu}function Lp(Z){return ds(Z)===dv}function yv(Z){var Se=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Se&&Z&&Z.getContext)}function _v(Z){var Se=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Se&&Z&&"src"in Z&&"crossOrigin"in Z)}function Xl(Z){if(!Z)return!1;if(yv(Z)||_v(Z))return!0;var Se=ds(Z);return Yr.indexOf(Se)>=0?!0:Oh(Z)||su(Z)||Te(Z)}function Ml(Z){return js[Object.prototype.toString.call(Z)]|0}function ti(Z,Se){var Ve=Se.length;switch(Z.type){case Gc:case Qu:case cd:case fd:var Rt=Rr.allocType(Z.type,Ve);Rt.set(Se),Z.data=Rt;break;case bf:Z.data=Th(Se);break;default:ne.raise("unsupported texture type, must specify a typed array")}}function Bo(Z,Se){return Rr.allocType(Z.type===bf?fd:Z.type,Se)}function Yl(Z,Se){Z.type===bf?(Z.data=Th(Se),Rr.freeType(Se)):Z.data=Se}function Cu(Z,Se,Ve,Rt,tr,kt){for(var Yt=Z.width,sr=Z.height,mr=Z.channels,Cr=Yt*sr*mr,wr=Bo(Z,Cr),dr=0,xr=0;xr<sr;++xr)for(var vr=0;vr<Yt;++vr)for(var Er=0;Er<mr;++Er)wr[dr++]=Se[Ve*vr+Rt*xr+tr*Er+kt];Yl(Z,wr)}function jc(Z,Se,Ve,Rt,tr,kt){var Yt;if(typeof Cs[Z]!="undefined"?Yt=Cs[Z]:Yt=Da[Z]*Hc[Se],kt&&(Yt*=6),tr){for(var sr=0,mr=Ve;mr>=1;)sr+=Yt*mr*mr,mr/=2;return sr}else return Yt*Ve*Rt}function Fh(Z,Se,Ve,Rt,tr,kt,Yt){var sr={"don't care":Ju,"dont care":Ju,nice:Wf,fast:el},mr={repeat:bm,clamp:fv,mirror:kh},Cr={nearest:Xt,linear:Jr},wr=i({mipmap:Un,"nearest mipmap nearest":Ii,"linear mipmap nearest":ga,"nearest mipmap linear":To,"linear mipmap linear":Un},Cr),dr={none:0,browser:wf},xr={uint8:Gc,rgba4:Ap,rgb565:_m,"rgb5 a1":Al},vr={alpha:Vc,luminance:Sp,"luminance alpha":Mh,rgb:lc,rgba:Hf,rgba4:Ga,"rgb5 a1":Lh,rgb565:Vy},Er={};Se.ext_srgb&&(vr.srgb=Mp,vr.srgba=ld),Se.oes_texture_float&&(xr.float32=xr.float=fd),Se.oes_texture_half_float&&(xr.float16=xr["half float"]=bf),Se.webgl_depth_texture&&(i(vr,{depth:Tp,"depth stencil":xf}),i(xr,{uint16:Qu,uint32:cd,"depth stencil":ud})),Se.webgl_compressed_texture_s3tc&&i(Er,{"rgb s3tc dxt1":Ih,"rgba s3tc dxt1":sg,"rgba s3tc dxt3":Hl,"rgba s3tc dxt5":jl}),Se.webgl_compressed_texture_atc&&i(Er,{"rgb atc":xm,"rgba atc explicit alpha":uv,"rgba atc interpolated alpha":ug}),Se.webgl_compressed_texture_pvrtc&&i(Er,{"rgb pvrtc 4bppv1":fl,"rgb pvrtc 2bppv1":jf,"rgba pvrtc 4bppv1":lv,"rgba pvrtc 2bppv1":lg}),Se.webgl_compressed_texture_etc1&&(Er["rgb etc1"]=cv);var _t=Array.prototype.slice.call(Z.getParameter(ov)||new Uint32Array(0));Object.keys(Er).forEach(function(Fe){var Ft=Er[Fe];_t.indexOf(Ft)>=0&&(vr[Fe]=Ft)});var Gt=Object.keys(vr);Ve.textureFormats=Gt;var _r=[];Object.keys(vr).forEach(function(Fe){var Ft=vr[Fe];_r[Ft]=Fe});var Zr=[];Object.keys(xr).forEach(function(Fe){var Ft=xr[Fe];Zr[Ft]=Fe});var or=[];Object.keys(Cr).forEach(function(Fe){var Ft=Cr[Fe];or[Ft]=Fe});var Fr=[];Object.keys(wr).forEach(function(Fe){var Ft=wr[Fe];Fr[Ft]=Fe});var Hr=[];Object.keys(mr).forEach(function(Fe){var Ft=mr[Fe];Hr[Ft]=Fe});var xn=Gt.reduce(function(Fe,Ft){var Ct=vr[Ft];return Ct===Sp||Ct===Vc||Ct===Sp||Ct===Mh||Ct===Tp||Ct===xf||Se.ext_srgb&&(Ct===Mp||Ct===ld)?Fe[Ct]=Ct:Ct===Lh||Ft.indexOf("rgba")>=0?Fe[Ct]=Hf:Fe[Ct]=lc,Fe},{});function Jt(){this.internalformat=Hf,this.format=Hf,this.type=Gc,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=wf,this.width=0,this.height=0,this.channels=0}function qt(Fe,Ft){Fe.internalformat=Ft.internalformat,Fe.format=Ft.format,Fe.type=Ft.type,Fe.compressed=Ft.compressed,Fe.premultiplyAlpha=Ft.premultiplyAlpha,Fe.flipY=Ft.flipY,Fe.unpackAlignment=Ft.unpackAlignment,Fe.colorSpace=Ft.colorSpace,Fe.width=Ft.width,Fe.height=Ft.height,Fe.channels=Ft.channels}function jr(Fe,Ft){if(!(typeof Ft!="object"||!Ft)){if("premultiplyAlpha"in Ft&&(ne.type(Ft.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Fe.premultiplyAlpha=Ft.premultiplyAlpha),"flipY"in Ft&&(ne.type(Ft.flipY,"boolean","invalid texture flip"),Fe.flipY=Ft.flipY),"alignment"in Ft&&(ne.oneOf(Ft.alignment,[1,2,4,8],"invalid texture unpack alignment"),Fe.unpackAlignment=Ft.alignment),"colorSpace"in Ft&&(ne.parameter(Ft.colorSpace,dr,"invalid colorSpace"),Fe.colorSpace=dr[Ft.colorSpace]),"type"in Ft){var Ct=Ft.type;ne(Se.oes_texture_float||!(Ct==="float"||Ct==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),ne(Se.oes_texture_half_float||!(Ct==="half float"||Ct==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),ne(Se.webgl_depth_texture||!(Ct==="uint16"||Ct==="uint32"||Ct==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(Ct,xr,"invalid texture type"),Fe.type=xr[Ct]}var vn=Fe.width,Wi=Fe.height,ke=Fe.channels,ge=!1;"shape"in Ft?(ne(Array.isArray(Ft.shape)&&Ft.shape.length>=2,"shape must be an array"),vn=Ft.shape[0],Wi=Ft.shape[1],Ft.shape.length===3&&(ke=Ft.shape[2],ne(ke>0&&ke<=4,"invalid number of channels"),ge=!0),ne(vn>=0&&vn<=Ve.maxTextureSize,"invalid width"),ne(Wi>=0&&Wi<=Ve.maxTextureSize,"invalid height")):("radius"in Ft&&(vn=Wi=Ft.radius,ne(vn>=0&&vn<=Ve.maxTextureSize,"invalid radius")),"width"in Ft&&(vn=Ft.width,ne(vn>=0&&vn<=Ve.maxTextureSize,"invalid width")),"height"in Ft&&(Wi=Ft.height,ne(Wi>=0&&Wi<=Ve.maxTextureSize,"invalid height")),"channels"in Ft&&(ke=Ft.channels,ne(ke>0&&ke<=4,"invalid number of channels"),ge=!0)),Fe.width=vn|0,Fe.height=Wi|0,Fe.channels=ke|0;var Ye=!1;if("format"in Ft){var yt=Ft.format;ne(Se.webgl_depth_texture||!(yt==="depth"||yt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(yt,vr,"invalid texture format");var Ot=Fe.internalformat=vr[yt];Fe.format=xn[Ot],yt in xr&&("type"in Ft||(Fe.type=xr[yt])),yt in Er&&(Fe.compressed=!0),Ye=!0}!ge&&Ye?Fe.channels=Da[Fe.format]:ge&&!Ye?Fe.channels!==pv[Fe.format]&&(Fe.format=Fe.internalformat=pv[Fe.channels]):Ye&&ge&&ne(Fe.channels===Da[Fe.format],"number of channels inconsistent with specified format")}}function Ur(Fe){Z.pixelStorei(fg,Fe.flipY),Z.pixelStorei(Ph,Fe.premultiplyAlpha),Z.pixelStorei(Fa,Fe.colorSpace),Z.pixelStorei(hd,Fe.unpackAlignment)}function br(){Jt.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function qr(Fe,Ft){var Ct=null;if(Xl(Ft)?Ct=Ft:Ft&&(ne.type(Ft,"object","invalid pixel data type"),jr(Fe,Ft),"x"in Ft&&(Fe.xOffset=Ft.x|0),"y"in Ft&&(Fe.yOffset=Ft.y|0),Xl(Ft.data)&&(Ct=Ft.data)),ne(!Fe.compressed||Ct instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Ft.copy){ne(!Ct,"can not specify copy and data field for the same texture");var vn=tr.viewportWidth,Wi=tr.viewportHeight;Fe.width=Fe.width||vn-Fe.xOffset,Fe.height=Fe.height||Wi-Fe.yOffset,Fe.needsCopy=!0,ne(Fe.xOffset>=0&&Fe.xOffset<vn&&Fe.yOffset>=0&&Fe.yOffset<Wi&&Fe.width>0&&Fe.width<=vn&&Fe.height>0&&Fe.height<=Wi,"copy texture read out of bounds")}else if(!Ct)Fe.width=Fe.width||1,Fe.height=Fe.height||1,Fe.channels=Fe.channels||4;else if(n(Ct))Fe.channels=Fe.channels||4,Fe.data=Ct,!("type"in Ft)&&Fe.type===Gc&&(Fe.type=Ml(Ct));else if(Oh(Ct))Fe.channels=Fe.channels||4,ti(Fe,Ct),Fe.alignment=1,Fe.needsFree=!0;else if(Te(Ct)){var ke=Ct.data;!Array.isArray(ke)&&Fe.type===Gc&&(Fe.type=Ml(ke));var ge=Ct.shape,Ye=Ct.stride,yt,Ot,at,Je,ht,ye;ge.length===3?(at=ge[2],ye=Ye[2]):(ne(ge.length===2,"invalid ndarray pixel data, must be 2 or 3D"),at=1,ye=1),yt=ge[0],Ot=ge[1],Je=Ye[0],ht=Ye[1],Fe.alignment=1,Fe.width=yt,Fe.height=Ot,Fe.channels=at,Fe.format=Fe.internalformat=pv[at],Fe.needsFree=!0,Cu(Fe,ke,Je,ht,ye,Ct.offset)}else if(yv(Ct)||vv(Ct)||gv(Ct)||Tl(Ct))yv(Ct)||vv(Ct)||gv(Ct)?Fe.element=Ct:Fe.element=Ct.canvas,Fe.width=Fe.element.width,Fe.height=Fe.element.height,Fe.channels=4;else if(fc(Ct))Fe.element=Ct,Fe.width=Ct.width,Fe.height=Ct.height,Fe.channels=4;else if(mv(Ct))Fe.element=Ct,Fe.width=Ct.naturalWidth,Fe.height=Ct.naturalHeight,Fe.channels=4;else if(_v(Ct))Fe.element=Ct,Fe.width=Ct.width,Fe.height=Ct.height,Fe.channels=4;else if(Lp(Ct))Fe.element=Ct,Fe.width=Ct.videoWidth,Fe.height=Ct.videoHeight,Fe.channels=4;else if(su(Ct)){var qe=Fe.width||Ct[0].length,Pe=Fe.height||Ct.length,vt=Fe.channels;ro(Ct[0][0])?vt=vt||Ct[0][0].length:vt=vt||1;for(var St=jt.shape(Ct),ur=1,Nr=0;Nr<St.length;++Nr)ur*=St[Nr];var zr=Bo(Fe,ur);jt.flatten(Ct,St,"",zr),Yl(Fe,zr),Fe.alignment=1,Fe.width=qe,Fe.height=Pe,Fe.channels=vt,Fe.format=Fe.internalformat=pv[vt],Fe.needsFree=!0}Fe.type===fd?ne(Ve.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Fe.type===bf&&ne(Ve.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Qr(Fe,Ft,Ct){var vn=Fe.element,Wi=Fe.data,ke=Fe.internalformat,ge=Fe.format,Ye=Fe.type,yt=Fe.width,Ot=Fe.height;Ur(Fe),vn?Z.texImage2D(Ft,Ct,ge,ge,Ye,vn):Fe.compressed?Z.compressedTexImage2D(Ft,Ct,ke,yt,Ot,0,Wi):Fe.needsCopy?(Rt(),Z.copyTexImage2D(Ft,Ct,ge,Fe.xOffset,Fe.yOffset,yt,Ot,0)):Z.texImage2D(Ft,Ct,ge,yt,Ot,0,ge,Ye,Wi||null)}function li(Fe,Ft,Ct,vn,Wi){var ke=Fe.element,ge=Fe.data,Ye=Fe.internalformat,yt=Fe.format,Ot=Fe.type,at=Fe.width,Je=Fe.height;Ur(Fe),ke?Z.texSubImage2D(Ft,Wi,Ct,vn,yt,Ot,ke):Fe.compressed?Z.compressedTexSubImage2D(Ft,Wi,Ct,vn,Ye,at,Je,ge):Fe.needsCopy?(Rt(),Z.copyTexSubImage2D(Ft,Wi,Ct,vn,Fe.xOffset,Fe.yOffset,at,Je)):Z.texSubImage2D(Ft,Wi,Ct,vn,at,Je,yt,Ot,ge)}var ii=[];function sn(){return ii.pop()||new br}function ln(Fe){Fe.needsFree&&Rr.freeType(Fe.data),br.call(Fe),ii.push(Fe)}function Xn(){Jt.call(this),this.genMipmaps=!1,this.mipmapHint=Ju,this.mipmask=0,this.images=Array(16)}function fi(Fe,Ft,Ct){var vn=Fe.images[0]=sn();Fe.mipmask=1,vn.width=Fe.width=Ft,vn.height=Fe.height=Ct,vn.channels=Fe.channels=4}function _i(Fe,Ft){var Ct=null;if(Xl(Ft))Ct=Fe.images[0]=sn(),qt(Ct,Fe),qr(Ct,Ft),Fe.mipmask=1;else if(jr(Fe,Ft),Array.isArray(Ft.mipmap))for(var vn=Ft.mipmap,Wi=0;Wi<vn.length;++Wi)Ct=Fe.images[Wi]=sn(),qt(Ct,Fe),Ct.width>>=Wi,Ct.height>>=Wi,qr(Ct,vn[Wi]),Fe.mipmask|=1<<Wi;else Ct=Fe.images[0]=sn(),qt(Ct,Fe),qr(Ct,Ft),Fe.mipmask=1;qt(Fe,Fe.images[0]),Fe.compressed&&(Fe.internalformat===Ih||Fe.internalformat===sg||Fe.internalformat===Hl||Fe.internalformat===jl)&&ne(Fe.width%4===0&&Fe.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Ka(Fe,Ft){for(var Ct=Fe.images,vn=0;vn<Ct.length;++vn){if(!Ct[vn])return;Qr(Ct[vn],Ft,vn)}}var gs=[];function Vi(){var Fe=gs.pop()||new Xn;Jt.call(Fe),Fe.mipmask=0;for(var Ft=0;Ft<16;++Ft)Fe.images[Ft]=null;return Fe}function Au(Fe){for(var Ft=Fe.images,Ct=0;Ct<Ft.length;++Ct)Ft[Ct]&&ln(Ft[Ct]),Ft[Ct]=null;gs.push(Fe)}function Co(){this.minFilter=Xt,this.magFilter=Xt,this.wrapS=fv,this.wrapT=fv,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ju}function qs(Fe,Ft){if("min"in Ft){var Ct=Ft.min;ne.parameter(Ct,wr),Fe.minFilter=wr[Ct],Rh.indexOf(Fe.minFilter)>=0&&!("faces"in Ft)&&(Fe.genMipmaps=!0)}if("mag"in Ft){var vn=Ft.mag;ne.parameter(vn,Cr),Fe.magFilter=Cr[vn]}var Wi=Fe.wrapS,ke=Fe.wrapT;if("wrap"in Ft){var ge=Ft.wrap;typeof ge=="string"?(ne.parameter(ge,mr),Wi=ke=mr[ge]):Array.isArray(ge)&&(ne.parameter(ge[0],mr),ne.parameter(ge[1],mr),Wi=mr[ge[0]],ke=mr[ge[1]])}else{if("wrapS"in Ft){var Ye=Ft.wrapS;ne.parameter(Ye,mr),Wi=mr[Ye]}if("wrapT"in Ft){var yt=Ft.wrapT;ne.parameter(yt,mr),ke=mr[yt]}}if(Fe.wrapS=Wi,Fe.wrapT=ke,"anisotropic"in Ft){var Ot=Ft.anisotropic;ne(typeof Ot=="number"&&Ot>=1&&Ot<=Ve.maxAnisotropic,"aniso samples must be between 1 and "),Fe.anisotropic=Ft.anisotropic}if("mipmap"in Ft){var at=!1;switch(typeof Ft.mipmap){case"string":ne.parameter(Ft.mipmap,sr,"invalid mipmap hint"),Fe.mipmapHint=sr[Ft.mipmap],Fe.genMipmaps=!0,at=!0;break;case"boolean":at=Fe.genMipmaps=Ft.mipmap;break;case"object":ne(Array.isArray(Ft.mipmap),"invalid mipmap type"),Fe.genMipmaps=!1,at=!0;break;default:ne.raise("invalid mipmap type")}at&&!("min"in Ft)&&(Fe.minFilter=Ii)}}function zs(Fe,Ft){Z.texParameteri(Ft,lr,Fe.minFilter),Z.texParameteri(Ft,bt,Fe.magFilter),Z.texParameteri(Ft,Gy,Fe.wrapS),Z.texParameteri(Ft,cg,Fe.wrapT),Se.ext_texture_filter_anisotropic&&Z.texParameteri(Ft,hv,Fe.anisotropic),Fe.genMipmaps&&(Z.hint(qa,Fe.mipmapHint),Z.generateMipmap(Ft))}var Tu=0,Mu={},Nu=Ve.maxTextureUnits,cs=Array(Nu).map(function(){return null});function ki(Fe){Jt.call(this),this.mipmask=0,this.internalformat=Hf,this.id=Tu++,this.refCount=1,this.target=Fe,this.texture=Z.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Co,Yt.profile&&(this.stats={size:0})}function Ks(Fe){Z.activeTexture(Do),Z.bindTexture(Fe.target,Fe.texture)}function Ea(){var Fe=cs[0];Fe?Z.bindTexture(Fe.target,Fe.texture):Z.bindTexture(Ku,null)}function Ts(Fe){var Ft=Fe.texture;ne(Ft,"must not double destroy texture");var Ct=Fe.unit,vn=Fe.target;Ct>=0&&(Z.activeTexture(Do+Ct),Z.bindTexture(vn,null),cs[Ct]=null),Z.deleteTexture(Ft),Fe.texture=null,Fe.params=null,Fe.pixels=null,Fe.refCount=0,delete Mu[Fe.id],kt.textureCount--}i(ki.prototype,{bind:function(){var Fe=this;Fe.bindCount+=1;var Ft=Fe.unit;if(Ft<0){for(var Ct=0;Ct<Nu;++Ct){var vn=cs[Ct];if(vn){if(vn.bindCount>0)continue;vn.unit=-1}cs[Ct]=Fe,Ft=Ct;break}Ft>=Nu&&ne.raise("insufficient number of texture units"),Yt.profile&&kt.maxTextureUnits<Ft+1&&(kt.maxTextureUnits=Ft+1),Fe.unit=Ft,Z.activeTexture(Do+Ft),Z.bindTexture(Fe.target,Fe.texture)}return Ft},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Ts(this)}});function Kn(Fe,Ft){var Ct=new ki(Ku);Mu[Ct.id]=Ct,kt.textureCount++;function vn(ge,Ye){var yt=Ct.texInfo;Co.call(yt);var Ot=Vi();return typeof ge=="number"?typeof Ye=="number"?fi(Ot,ge|0,Ye|0):fi(Ot,ge|0,ge|0):ge?(ne.type(ge,"object","invalid arguments to regl.texture"),qs(yt,ge),_i(Ot,ge)):fi(Ot,1,1),yt.genMipmaps&&(Ot.mipmask=(Ot.width<<1)-1),Ct.mipmask=Ot.mipmask,qt(Ct,Ot),ne.texture2D(yt,Ot,Ve),Ct.internalformat=Ot.internalformat,vn.width=Ot.width,vn.height=Ot.height,Ks(Ct),Ka(Ot,Ku),zs(yt,Ku),Ea(),Au(Ot),Yt.profile&&(Ct.stats.size=jc(Ct.internalformat,Ct.type,Ot.width,Ot.height,yt.genMipmaps,!1)),vn.format=_r[Ct.internalformat],vn.type=Zr[Ct.type],vn.mag=or[yt.magFilter],vn.min=Fr[yt.minFilter],vn.wrapS=Hr[yt.wrapS],vn.wrapT=Hr[yt.wrapT],vn}function Wi(ge,Ye,yt,Ot){ne(!!ge,"must specify image data");var at=Ye|0,Je=yt|0,ht=Ot|0,ye=sn();return qt(ye,Ct),ye.width=0,ye.height=0,qr(ye,ge),ye.width=ye.width||(Ct.width>>ht)-at,ye.height=ye.height||(Ct.height>>ht)-Je,ne(Ct.type===ye.type&&Ct.format===ye.format&&Ct.internalformat===ye.internalformat,"incompatible format for texture.subimage"),ne(at>=0&&Je>=0&&at+ye.width<=Ct.width&&Je+ye.height<=Ct.height,"texture.subimage write out of bounds"),ne(Ct.mipmask&1<<ht,"missing mipmap data"),ne(ye.data||ye.element||ye.needsCopy,"missing image data"),Ks(Ct),li(ye,Ku,at,Je,ht),Ea(),ln(ye),vn}function ke(ge,Ye){var yt=ge|0,Ot=Ye|0||yt;if(yt===Ct.width&&Ot===Ct.height)return vn;vn.width=Ct.width=yt,vn.height=Ct.height=Ot,Ks(Ct);for(var at=0;Ct.mipmask>>at;++at){var Je=yt>>at,ht=Ot>>at;if(!Je||!ht)break;Z.texImage2D(Ku,at,Ct.format,Je,ht,0,Ct.format,Ct.type,null)}return Ea(),Yt.profile&&(Ct.stats.size=jc(Ct.internalformat,Ct.type,yt,Ot,!1,!1)),vn}return vn(Fe,Ft),vn.subimage=Wi,vn.resize=ke,vn._reglType="texture2d",vn._texture=Ct,Yt.profile&&(vn.stats=Ct.stats),vn.destroy=function(){Ct.decRef()},vn}function Gi(Fe,Ft,Ct,vn,Wi,ke){var ge=new ki(sv);Mu[ge.id]=ge,kt.cubeCount++;var Ye=new Array(6);function yt(Je,ht,ye,qe,Pe,vt){var St,ur=ge.texInfo;for(Co.call(ur),St=0;St<6;++St)Ye[St]=Vi();if(typeof Je=="number"||!Je){var Nr=Je|0||1;for(St=0;St<6;++St)fi(Ye[St],Nr,Nr)}else if(typeof Je=="object")if(ht)_i(Ye[0],Je),_i(Ye[1],ht),_i(Ye[2],ye),_i(Ye[3],qe),_i(Ye[4],Pe),_i(Ye[5],vt);else if(qs(ur,Je),jr(ge,Je),"faces"in Je){var zr=Je.faces;for(ne(Array.isArray(zr)&&zr.length===6,"cube faces must be a length 6 array"),St=0;St<6;++St)ne(typeof zr[St]=="object"&&!!zr[St],"invalid input for cube map face"),qt(Ye[St],ge),_i(Ye[St],zr[St])}else for(St=0;St<6;++St)_i(Ye[St],Je);else ne.raise("invalid arguments to cube map");for(qt(ge,Ye[0]),ne.optional(function(){Ve.npotTextureCube||ne(Gf(ge.width)&&Gf(ge.height),"your browser does not support non power or two texture dimensions")}),ur.genMipmaps?ge.mipmask=(Ye[0].width<<1)-1:ge.mipmask=Ye[0].mipmask,ne.textureCube(ge,ur,Ye,Ve),ge.internalformat=Ye[0].internalformat,yt.width=Ye[0].width,yt.height=Ye[0].height,Ks(ge),St=0;St<6;++St)Ka(Ye[St],Uc+St);for(zs(ur,sv),Ea(),Yt.profile&&(ge.stats.size=jc(ge.internalformat,ge.type,yt.width,yt.height,ur.genMipmaps,!0)),yt.format=_r[ge.internalformat],yt.type=Zr[ge.type],yt.mag=or[ur.magFilter],yt.min=Fr[ur.minFilter],yt.wrapS=Hr[ur.wrapS],yt.wrapT=Hr[ur.wrapT],St=0;St<6;++St)Au(Ye[St]);return yt}function Ot(Je,ht,ye,qe,Pe){ne(!!ht,"must specify image data"),ne(typeof Je=="number"&&Je===(Je|0)&&Je>=0&&Je<6,"invalid face");var vt=ye|0,St=qe|0,ur=Pe|0,Nr=sn();return qt(Nr,ge),Nr.width=0,Nr.height=0,qr(Nr,ht),Nr.width=Nr.width||(ge.width>>ur)-vt,Nr.height=Nr.height||(ge.height>>ur)-St,ne(ge.type===Nr.type&&ge.format===Nr.format&&ge.internalformat===Nr.internalformat,"incompatible format for texture.subimage"),ne(vt>=0&&St>=0&&vt+Nr.width<=ge.width&&St+Nr.height<=ge.height,"texture.subimage write out of bounds"),ne(ge.mipmask&1<<ur,"missing mipmap data"),ne(Nr.data||Nr.element||Nr.needsCopy,"missing image data"),Ks(ge),li(Nr,Uc+Je,vt,St,ur),Ea(),ln(Nr),yt}function at(Je){var ht=Je|0;if(ht!==ge.width){yt.width=ge.width=ht,yt.height=ge.height=ht,Ks(ge);for(var ye=0;ye<6;++ye)for(var qe=0;ge.mipmask>>qe;++qe)Z.texImage2D(Uc+ye,qe,ge.format,ht>>qe,ht>>qe,0,ge.format,ge.type,null);return Ea(),Yt.profile&&(ge.stats.size=jc(ge.internalformat,ge.type,yt.width,yt.height,!1,!0)),yt}}return yt(Fe,Ft,Ct,vn,Wi,ke),yt.subimage=Ot,yt.resize=at,yt._reglType="textureCube",yt._texture=ge,Yt.profile&&(yt.stats=ge.stats),yt.destroy=function(){ge.decRef()},yt}function io(){for(var Fe=0;Fe<Nu;++Fe)Z.activeTexture(Do+Fe),Z.bindTexture(Ku,null),cs[Fe]=null;et(Mu).forEach(Ts),kt.cubeCount=0,kt.textureCount=0}Yt.profile&&(kt.getTotalTextureSize=function(){var Fe=0;return Object.keys(Mu).forEach(function(Ft){Fe+=Mu[Ft].stats.size}),Fe});function Qs(){for(var Fe=0;Fe<Nu;++Fe){var Ft=cs[Fe];Ft&&(Ft.bindCount=0,Ft.unit=-1,cs[Fe]=null)}et(Mu).forEach(function(Ct){Ct.texture=Z.createTexture(),Z.bindTexture(Ct.target,Ct.texture);for(var vn=0;vn<32;++vn)if((Ct.mipmask&1<<vn)!==0)if(Ct.target===Ku)Z.texImage2D(Ku,vn,Ct.internalformat,Ct.width>>vn,Ct.height>>vn,0,Ct.internalformat,Ct.type,null);else for(var Wi=0;Wi<6;++Wi)Z.texImage2D(Uc+Wi,vn,Ct.internalformat,Ct.width>>vn,Ct.height>>vn,0,Ct.internalformat,Ct.type,null);zs(Ct.texInfo,Ct.target)})}function _c(){for(var Fe=0;Fe<Nu;++Fe){var Ft=cs[Fe];Ft&&(Ft.bindCount=0,Ft.unit=-1,cs[Fe]=null),Z.activeTexture(Do+Fe),Z.bindTexture(Ku,null),Z.bindTexture(sv,null)}}return{create2D:Kn,createCube:Gi,clear:io,getTexture:function(Fe){return null},restore:Qs,refresh:_c}}var Xs=36161,vs=32854,Dh=32855,Pn=36194,_n=33189,Xf=36168,Ys=34041,Ou=35907,uu=34836,Wc=34842,hg=34843,Ll=[];Ll[vs]=2,Ll[Dh]=2,Ll[Pn]=2,Ll[_n]=2,Ll[Xf]=1,Ll[Ys]=4,Ll[Ou]=4,Ll[uu]=16,Ll[Wc]=8,Ll[hg]=6;function La(Z,Se,Ve){return Ll[Z]*Se*Ve}var Es=function(Z,Se,Ve,Rt,tr){var kt={rgba4:vs,rgb565:Pn,"rgb5 a1":Dh,depth:_n,stencil:Xf,"depth stencil":Ys};Se.ext_srgb&&(kt.srgba=Ou),Se.ext_color_buffer_half_float&&(kt.rgba16f=Wc,kt.rgb16f=hg),Se.webgl_color_buffer_float&&(kt.rgba32f=uu);var Yt=[];Object.keys(kt).forEach(function(vr){var Er=kt[vr];Yt[Er]=vr});var sr=0,mr={};function Cr(vr){this.id=sr++,this.refCount=1,this.renderbuffer=vr,this.format=vs,this.width=0,this.height=0,tr.profile&&(this.stats={size:0})}Cr.prototype.decRef=function(){--this.refCount<=0&&wr(this)};function wr(vr){var Er=vr.renderbuffer;ne(Er,"must not double destroy renderbuffer"),Z.bindRenderbuffer(Xs,null),Z.deleteRenderbuffer(Er),vr.renderbuffer=null,vr.refCount=0,delete mr[vr.id],Rt.renderbufferCount--}function dr(vr,Er){var _t=new Cr(Z.createRenderbuffer());mr[_t.id]=_t,Rt.renderbufferCount++;function Gt(Zr,or){var Fr=0,Hr=0,xn=vs;if(typeof Zr=="object"&&Zr){var Jt=Zr;if("shape"in Jt){var qt=Jt.shape;ne(Array.isArray(qt)&&qt.length>=2,"invalid renderbuffer shape"),Fr=qt[0]|0,Hr=qt[1]|0}else"radius"in Jt&&(Fr=Hr=Jt.radius|0),"width"in Jt&&(Fr=Jt.width|0),"height"in Jt&&(Hr=Jt.height|0);"format"in Jt&&(ne.parameter(Jt.format,kt,"invalid renderbuffer format"),xn=kt[Jt.format])}else typeof Zr=="number"?(Fr=Zr|0,typeof or=="number"?Hr=or|0:Hr=Fr):Zr?ne.raise("invalid arguments to renderbuffer constructor"):Fr=Hr=1;if(ne(Fr>0&&Hr>0&&Fr<=Ve.maxRenderbufferSize&&Hr<=Ve.maxRenderbufferSize,"invalid renderbuffer size"),!(Fr===_t.width&&Hr===_t.height&&xn===_t.format))return Gt.width=_t.width=Fr,Gt.height=_t.height=Hr,_t.format=xn,Z.bindRenderbuffer(Xs,_t.renderbuffer),Z.renderbufferStorage(Xs,xn,Fr,Hr),ne(Z.getError()===0,"invalid render buffer format"),tr.profile&&(_t.stats.size=La(_t.format,_t.width,_t.height)),Gt.format=Yt[_t.format],Gt}function _r(Zr,or){var Fr=Zr|0,Hr=or|0||Fr;return Fr===_t.width&&Hr===_t.height||(ne(Fr>0&&Hr>0&&Fr<=Ve.maxRenderbufferSize&&Hr<=Ve.maxRenderbufferSize,"invalid renderbuffer size"),Gt.width=_t.width=Fr,Gt.height=_t.height=Hr,Z.bindRenderbuffer(Xs,_t.renderbuffer),Z.renderbufferStorage(Xs,_t.format,Fr,Hr),ne(Z.getError()===0,"invalid render buffer format"),tr.profile&&(_t.stats.size=La(_t.format,_t.width,_t.height))),Gt}return Gt(vr,Er),Gt.resize=_r,Gt._reglType="renderbuffer",Gt._renderbuffer=_t,tr.profile&&(Gt.stats=_t.stats),Gt.destroy=function(){_t.decRef()},Gt}tr.profile&&(Rt.getTotalRenderbufferSize=function(){var vr=0;return Object.keys(mr).forEach(function(Er){vr+=mr[Er].stats.size}),vr});function xr(){et(mr).forEach(function(vr){vr.renderbuffer=Z.createRenderbuffer(),Z.bindRenderbuffer(Xs,vr.renderbuffer),Z.renderbufferStorage(Xs,vr.format,vr.width,vr.height)}),Z.bindRenderbuffer(Xs,null)}return{create:dr,clear:function(){et(mr).forEach(wr)},restore:xr}},Il=36160,Ef=36161,be=3553,Fu=34069,Eu=36064,Su=36096,zi=36128,xv=33306,Ip=36053,bv=36054,Yf=36055,pd=36057,kp=36061,wm=36193,Bh=5121,Nh=5126,Zl=6407,Zf=6408,hc=6402,Cm=[Zl,Zf],Pp=[];Pp[Zf]=4,Pp[Zl]=3;var dd=[];dd[Bh]=1,dd[Nh]=4,dd[wm]=2;var pc=32854,y=32855,b=36194,_=33189,S=36168,P=34041,F=35907,N=34836,V=34842,J=34843,se=[pc,y,b,F,V,J,N],de={};de[Ip]="complete",de[bv]="incomplete attachment",de[pd]="incomplete dimensions",de[Yf]="incomplete, missing attachment",de[kp]="unsupported";function xe(Z,Se,Ve,Rt,tr,kt){var Yt={cur:null,next:null,dirty:!1,setFBO:null},sr=["rgba"],mr=["rgba4","rgb565","rgb5 a1"];Se.ext_srgb&&mr.push("srgba"),Se.ext_color_buffer_half_float&&mr.push("rgba16f","rgb16f"),Se.webgl_color_buffer_float&&mr.push("rgba32f");var Cr=["uint8"];Se.oes_texture_half_float&&Cr.push("half float","float16"),Se.oes_texture_float&&Cr.push("float","float32");function wr(br,qr,Qr){this.target=br,this.texture=qr,this.renderbuffer=Qr;var li=0,ii=0;qr?(li=qr.width,ii=qr.height):Qr&&(li=Qr.width,ii=Qr.height),this.width=li,this.height=ii}function dr(br){br&&(br.texture&&br.texture._texture.decRef(),br.renderbuffer&&br.renderbuffer._renderbuffer.decRef())}function xr(br,qr,Qr){if(!!br)if(br.texture){var li=br.texture._texture,ii=Math.max(1,li.width),sn=Math.max(1,li.height);ne(ii===qr&&sn===Qr,"inconsistent width/height for supplied texture"),li.refCount+=1}else{var ln=br.renderbuffer._renderbuffer;ne(ln.width===qr&&ln.height===Qr,"inconsistent width/height for renderbuffer"),ln.refCount+=1}}function vr(br,qr){qr&&(qr.texture?Z.framebufferTexture2D(Il,br,qr.target,qr.texture._texture.texture,0):Z.framebufferRenderbuffer(Il,br,Ef,qr.renderbuffer._renderbuffer.renderbuffer))}function Er(br){var qr=be,Qr=null,li=null,ii=br;typeof br=="object"&&(ii=br.data,"target"in br&&(qr=br.target|0)),ne.type(ii,"function","invalid attachment data");var sn=ii._reglType;return sn==="texture2d"?(Qr=ii,ne(qr===be)):sn==="textureCube"?(Qr=ii,ne(qr>=Fu&&qr<Fu+6,"invalid cube map target")):sn==="renderbuffer"?(li=ii,qr=Ef):ne.raise("invalid regl object for attachment"),new wr(qr,Qr,li)}function _t(br,qr,Qr,li,ii){if(Qr){var sn=Rt.create2D({width:br,height:qr,format:li,type:ii});return sn._texture.refCount=0,new wr(be,sn,null)}else{var ln=tr.create({width:br,height:qr,format:li});return ln._renderbuffer.refCount=0,new wr(Ef,null,ln)}}function Gt(br){return br&&(br.texture||br.renderbuffer)}function _r(br,qr,Qr){br&&(br.texture?br.texture.resize(qr,Qr):br.renderbuffer&&br.renderbuffer.resize(qr,Qr),br.width=qr,br.height=Qr)}var Zr=0,or={};function Fr(){this.id=Zr++,or[this.id]=this,this.framebuffer=Z.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Hr(br){br.colorAttachments.forEach(dr),dr(br.depthAttachment),dr(br.stencilAttachment),dr(br.depthStencilAttachment)}function xn(br){var qr=br.framebuffer;ne(qr,"must not double destroy framebuffer"),Z.deleteFramebuffer(qr),br.framebuffer=null,kt.framebufferCount--,delete or[br.id]}function Jt(br){var qr;Z.bindFramebuffer(Il,br.framebuffer);var Qr=br.colorAttachments;for(qr=0;qr<Qr.length;++qr)vr(Eu+qr,Qr[qr]);for(qr=Qr.length;qr<Ve.maxColorAttachments;++qr)Z.framebufferTexture2D(Il,Eu+qr,be,null,0);Z.framebufferTexture2D(Il,xv,be,null,0),Z.framebufferTexture2D(Il,Su,be,null,0),Z.framebufferTexture2D(Il,zi,be,null,0),vr(Su,br.depthAttachment),vr(zi,br.stencilAttachment),vr(xv,br.depthStencilAttachment);var li=Z.checkFramebufferStatus(Il);!Z.isContextLost()&&li!==Ip&&ne.raise("framebuffer configuration not supported, status = "+de[li]),Z.bindFramebuffer(Il,Yt.next?Yt.next.framebuffer:null),Yt.cur=Yt.next,Z.getError()}function qt(br,qr){var Qr=new Fr;kt.framebufferCount++;function li(sn,ln){var Xn;ne(Yt.next!==Qr,"can not update framebuffer which is currently in use");var fi=0,_i=0,Ka=!0,gs=!0,Vi=null,Au=!0,Co="rgba",qs="uint8",zs=1,Tu=null,Mu=null,Nu=null,cs=!1;if(typeof sn=="number")fi=sn|0,_i=ln|0||fi;else if(!sn)fi=_i=1;else{ne.type(sn,"object","invalid arguments for framebuffer");var ki=sn;if("shape"in ki){var Ks=ki.shape;ne(Array.isArray(Ks)&&Ks.length>=2,"invalid shape for framebuffer"),fi=Ks[0],_i=Ks[1]}else"radius"in ki&&(fi=_i=ki.radius),"width"in ki&&(fi=ki.width),"height"in ki&&(_i=ki.height);("color"in ki||"colors"in ki)&&(Vi=ki.color||ki.colors,Array.isArray(Vi)&&ne(Vi.length===1||Se.webgl_draw_buffers,"multiple render targets not supported")),Vi||("colorCount"in ki&&(zs=ki.colorCount|0,ne(zs>0,"invalid color buffer count")),"colorTexture"in ki&&(Au=!!ki.colorTexture,Co="rgba4"),"colorType"in ki&&(qs=ki.colorType,Au?(ne(Se.oes_texture_float||!(qs==="float"||qs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),ne(Se.oes_texture_half_float||!(qs==="half float"||qs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):qs==="half float"||qs==="float16"?(ne(Se.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Co="rgba16f"):(qs==="float"||qs==="float32")&&(ne(Se.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Co="rgba32f"),ne.oneOf(qs,Cr,"invalid color type")),"colorFormat"in ki&&(Co=ki.colorFormat,sr.indexOf(Co)>=0?Au=!0:mr.indexOf(Co)>=0?Au=!1:ne.optional(function(){Au?ne.oneOf(ki.colorFormat,sr,"invalid color format for texture"):ne.oneOf(ki.colorFormat,mr,"invalid color format for renderbuffer")}))),("depthTexture"in ki||"depthStencilTexture"in ki)&&(cs=!!(ki.depthTexture||ki.depthStencilTexture),ne(!cs||Se.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ki&&(typeof ki.depth=="boolean"?Ka=ki.depth:(Tu=ki.depth,gs=!1)),"stencil"in ki&&(typeof ki.stencil=="boolean"?gs=ki.stencil:(Mu=ki.stencil,Ka=!1)),"depthStencil"in ki&&(typeof ki.depthStencil=="boolean"?Ka=gs=ki.depthStencil:(Nu=ki.depthStencil,Ka=!1,gs=!1))}var Ea=null,Ts=null,Kn=null,Gi=null;if(Array.isArray(Vi))Ea=Vi.map(Er);else if(Vi)Ea=[Er(Vi)];else for(Ea=new Array(zs),Xn=0;Xn<zs;++Xn)Ea[Xn]=_t(fi,_i,Au,Co,qs);ne(Se.webgl_draw_buffers||Ea.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),ne(Ea.length<=Ve.maxColorAttachments,"too many color attachments, not supported"),fi=fi||Ea[0].width,_i=_i||Ea[0].height,Tu?Ts=Er(Tu):Ka&&!gs&&(Ts=_t(fi,_i,cs,"depth","uint32")),Mu?Kn=Er(Mu):gs&&!Ka&&(Kn=_t(fi,_i,!1,"stencil","uint8")),Nu?Gi=Er(Nu):!Tu&&!Mu&&gs&&Ka&&(Gi=_t(fi,_i,cs,"depth stencil","depth stencil")),ne(!!Tu+!!Mu+!!Nu<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var io=null;for(Xn=0;Xn<Ea.length;++Xn)if(xr(Ea[Xn],fi,_i),ne(!Ea[Xn]||Ea[Xn].texture&&Cm.indexOf(Ea[Xn].texture._texture.format)>=0||Ea[Xn].renderbuffer&&se.indexOf(Ea[Xn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Xn+" is invalid"),Ea[Xn]&&Ea[Xn].texture){var Qs=Pp[Ea[Xn].texture._texture.format]*dd[Ea[Xn].texture._texture.type];io===null?io=Qs:ne(io===Qs,"all color attachments much have the same number of bits per pixel.")}return xr(Ts,fi,_i),ne(!Ts||Ts.texture&&Ts.texture._texture.format===hc||Ts.renderbuffer&&Ts.renderbuffer._renderbuffer.format===_,"invalid depth attachment for framebuffer object"),xr(Kn,fi,_i),ne(!Kn||Kn.renderbuffer&&Kn.renderbuffer._renderbuffer.format===S,"invalid stencil attachment for framebuffer object"),xr(Gi,fi,_i),ne(!Gi||Gi.texture&&Gi.texture._texture.format===P||Gi.renderbuffer&&Gi.renderbuffer._renderbuffer.format===P,"invalid depth-stencil attachment for framebuffer object"),Hr(Qr),Qr.width=fi,Qr.height=_i,Qr.colorAttachments=Ea,Qr.depthAttachment=Ts,Qr.stencilAttachment=Kn,Qr.depthStencilAttachment=Gi,li.color=Ea.map(Gt),li.depth=Gt(Ts),li.stencil=Gt(Kn),li.depthStencil=Gt(Gi),li.width=Qr.width,li.height=Qr.height,Jt(Qr),li}function ii(sn,ln){ne(Yt.next!==Qr,"can not resize a framebuffer which is currently in use");var Xn=Math.max(sn|0,1),fi=Math.max(ln|0||Xn,1);if(Xn===Qr.width&&fi===Qr.height)return li;for(var _i=Qr.colorAttachments,Ka=0;Ka<_i.length;++Ka)_r(_i[Ka],Xn,fi);return _r(Qr.depthAttachment,Xn,fi),_r(Qr.stencilAttachment,Xn,fi),_r(Qr.depthStencilAttachment,Xn,fi),Qr.width=li.width=Xn,Qr.height=li.height=fi,Jt(Qr),li}return li(br,qr),i(li,{resize:ii,_reglType:"framebuffer",_framebuffer:Qr,destroy:function(){xn(Qr),Hr(Qr)},use:function(sn){Yt.setFBO({framebuffer:li},sn)}})}function jr(br){var qr=Array(6);function Qr(ii){var sn;ne(qr.indexOf(Yt.next)<0,"can not update framebuffer which is currently in use");var ln={color:null},Xn=0,fi=null,_i="rgba",Ka="uint8",gs=1;if(typeof ii=="number")Xn=ii|0;else if(!ii)Xn=1;else{ne.type(ii,"object","invalid arguments for framebuffer");var Vi=ii;if("shape"in Vi){var Au=Vi.shape;ne(Array.isArray(Au)&&Au.length>=2,"invalid shape for framebuffer"),ne(Au[0]===Au[1],"cube framebuffer must be square"),Xn=Au[0]}else"radius"in Vi&&(Xn=Vi.radius|0),"width"in Vi?(Xn=Vi.width|0,"height"in Vi&&ne(Vi.height===Xn,"must be square")):"height"in Vi&&(Xn=Vi.height|0);("color"in Vi||"colors"in Vi)&&(fi=Vi.color||Vi.colors,Array.isArray(fi)&&ne(fi.length===1||Se.webgl_draw_buffers,"multiple render targets not supported")),fi||("colorCount"in Vi&&(gs=Vi.colorCount|0,ne(gs>0,"invalid color buffer count")),"colorType"in Vi&&(ne.oneOf(Vi.colorType,Cr,"invalid color type"),Ka=Vi.colorType),"colorFormat"in Vi&&(_i=Vi.colorFormat,ne.oneOf(Vi.colorFormat,sr,"invalid color format for texture"))),"depth"in Vi&&(ln.depth=Vi.depth),"stencil"in Vi&&(ln.stencil=Vi.stencil),"depthStencil"in Vi&&(ln.depthStencil=Vi.depthStencil)}var Co;if(fi)if(Array.isArray(fi))for(Co=[],sn=0;sn<fi.length;++sn)Co[sn]=fi[sn];else Co=[fi];else{Co=Array(gs);var qs={radius:Xn,format:_i,type:Ka};for(sn=0;sn<gs;++sn)Co[sn]=Rt.createCube(qs)}for(ln.color=Array(Co.length),sn=0;sn<Co.length;++sn){var zs=Co[sn];ne(typeof zs=="function"&&zs._reglType==="textureCube","invalid cube map"),Xn=Xn||zs.width,ne(zs.width===Xn&&zs.height===Xn,"invalid cube map shape"),ln.color[sn]={target:Fu,data:Co[sn]}}for(sn=0;sn<6;++sn){for(var Tu=0;Tu<Co.length;++Tu)ln.color[Tu].target=Fu+sn;sn>0&&(ln.depth=qr[0].depth,ln.stencil=qr[0].stencil,ln.depthStencil=qr[0].depthStencil),qr[sn]?qr[sn](ln):qr[sn]=qt(ln)}return i(Qr,{width:Xn,height:Xn,color:Co})}function li(ii){var sn,ln=ii|0;if(ne(ln>0&&ln<=Ve.maxCubeMapSize,"invalid radius for cube fbo"),ln===Qr.width)return Qr;var Xn=Qr.color;for(sn=0;sn<Xn.length;++sn)Xn[sn].resize(ln);for(sn=0;sn<6;++sn)qr[sn].resize(ln);return Qr.width=Qr.height=ln,Qr}return Qr(br),i(Qr,{faces:qr,resize:li,_reglType:"framebufferCube",destroy:function(){qr.forEach(function(ii){ii.destroy()})}})}function Ur(){Yt.cur=null,Yt.next=null,Yt.dirty=!0,et(or).forEach(function(br){br.framebuffer=Z.createFramebuffer(),Jt(br)})}return i(Yt,{getFramebuffer:function(br){if(typeof br=="function"&&br._reglType==="framebuffer"){var qr=br._framebuffer;if(qr instanceof Fr)return qr}return null},create:qt,createCube:jr,clear:function(){et(or).forEach(xn)},restore:Ur})}var Ee=5126,Ue=34962,Be=34963,Ke=["attributes","elements","offset","count","primitive","instances"];function Oe(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ee,this.offset=0,this.stride=0,this.divisor=0}function Qe(Z,Se,Ve,Rt,tr,kt,Yt){for(var sr=Ve.maxAttributes,mr=new Array(sr),Cr=0;Cr<sr;++Cr)mr[Cr]=new Oe;var wr=0,dr={},xr={Record:Oe,scope:{},state:mr,currentVAO:null,targetVAO:null,restore:Er()?Hr:function(){},createVAO:xn,getVAO:Gt,destroyBuffer:vr,setVAO:Er()?_r:Zr,clear:Er()?or:function(){}};function vr(Jt){for(var qt=0;qt<mr.length;++qt){var jr=mr[qt];jr.buffer===Jt&&(Z.disableVertexAttribArray(qt),jr.buffer=null)}}function Er(){return Se.oes_vertex_array_object}function _t(){return Se.angle_instanced_arrays}function Gt(Jt){return typeof Jt=="function"&&Jt._vao?Jt._vao:null}function _r(Jt){if(Jt!==xr.currentVAO){var qt=Er();Jt?qt.bindVertexArrayOES(Jt.vao):qt.bindVertexArrayOES(null),xr.currentVAO=Jt}}function Zr(Jt){if(Jt!==xr.currentVAO){if(Jt)Jt.bindAttrs();else{for(var qt=_t(),jr=0;jr<mr.length;++jr){var Ur=mr[jr];Ur.buffer?(Z.enableVertexAttribArray(jr),Ur.buffer.bind(),Z.vertexAttribPointer(jr,Ur.size,Ur.type,Ur.normalized,Ur.stride,Ur.offfset),qt&&Ur.divisor&&qt.vertexAttribDivisorANGLE(jr,Ur.divisor)):(Z.disableVertexAttribArray(jr),Z.vertexAttrib4f(jr,Ur.x,Ur.y,Ur.z,Ur.w))}Yt.elements?Z.bindBuffer(Be,Yt.elements.buffer.buffer):Z.bindBuffer(Be,null)}xr.currentVAO=Jt}}function or(){et(dr).forEach(function(Jt){Jt.destroy()})}function Fr(){this.id=++wr,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Jt=Er();Jt?this.vao=Jt.createVertexArrayOES():this.vao=null,dr[this.id]=this,this.buffers=[]}Fr.prototype.bindAttrs=function(){for(var Jt=_t(),qt=this.attributes,jr=0;jr<qt.length;++jr){var Ur=qt[jr];Ur.buffer?(Z.enableVertexAttribArray(jr),Z.bindBuffer(Ue,Ur.buffer.buffer),Z.vertexAttribPointer(jr,Ur.size,Ur.type,Ur.normalized,Ur.stride,Ur.offset),Jt&&Ur.divisor&&Jt.vertexAttribDivisorANGLE(jr,Ur.divisor)):(Z.disableVertexAttribArray(jr),Z.vertexAttrib4f(jr,Ur.x,Ur.y,Ur.z,Ur.w))}for(var br=qt.length;br<sr;++br)Z.disableVertexAttribArray(br);var qr=kt.getElements(this.elements);qr?Z.bindBuffer(Be,qr.buffer.buffer):Z.bindBuffer(Be,null)},Fr.prototype.refresh=function(){var Jt=Er();Jt&&(Jt.bindVertexArrayOES(this.vao),this.bindAttrs(),xr.currentVAO=null,Jt.bindVertexArrayOES(null))},Fr.prototype.destroy=function(){if(this.vao){var Jt=Er();this===xr.currentVAO&&(xr.currentVAO=null,Jt.bindVertexArrayOES(null)),Jt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),dr[this.id]&&(delete dr[this.id],Rt.vaoCount-=1)};function Hr(){var Jt=Er();Jt&&et(dr).forEach(function(qt){qt.refresh()})}function xn(Jt){var qt=new Fr;Rt.vaoCount+=1;function jr(Ur){var br;if(Array.isArray(Ur))br=Ur,qt.elements&&qt.ownsElements&&qt.elements.destroy(),qt.elements=null,qt.ownsElements=!1,qt.offset=0,qt.count=0,qt.instances=-1,qt.primitive=4;else{if(ne(typeof Ur=="object","invalid arguments for create vao"),ne("attributes"in Ur,"must specify attributes for vao"),Ur.elements){var qr=Ur.elements;qt.ownsElements?typeof qr=="function"&&qr._reglType==="elements"?(qt.elements.destroy(),qt.ownsElements=!1):(qt.elements(qr),qt.ownsElements=!1):kt.getElements(Ur.elements)?(qt.elements=Ur.elements,qt.ownsElements=!1):(qt.elements=kt.create(Ur.elements),qt.ownsElements=!0)}else qt.elements=null,qt.ownsElements=!1;br=Ur.attributes,qt.offset=0,qt.count=-1,qt.instances=-1,qt.primitive=4,qt.elements&&(qt.count=qt.elements._elements.vertCount,qt.primitive=qt.elements._elements.primType),"offset"in Ur&&(qt.offset=Ur.offset|0),"count"in Ur&&(qt.count=Ur.count|0),"instances"in Ur&&(qt.instances=Ur.instances|0),"primitive"in Ur&&(ne(Ur.primitive in qu,"bad primitive type: "+Ur.primitive),qt.primitive=qu[Ur.primitive]),ne.optional(function(){for(var Ka=Object.keys(Ur),gs=0;gs<Ka.length;++gs)ne(Ke.indexOf(Ka[gs])>=0,'invalid option for vao: "'+Ka[gs]+'" valid options are '+Ke)}),ne(Array.isArray(br),"attributes must be an array")}ne(br.length<sr,"too many attributes"),ne(br.length>0,"must specify at least one attribute");var Qr={},li=qt.attributes;li.length=br.length;for(var ii=0;ii<br.length;++ii){var sn=br[ii],ln=li[ii]=new Oe,Xn=sn.data||sn;if(Array.isArray(Xn)||n(Xn)||Te(Xn)){var fi;qt.buffers[ii]&&(fi=qt.buffers[ii],n(Xn)&&fi._buffer.byteLength>=Xn.byteLength?fi.subdata(Xn):(fi.destroy(),qt.buffers[ii]=null)),qt.buffers[ii]||(fi=qt.buffers[ii]=tr.create(sn,Ue,!1,!0)),ln.buffer=tr.getBuffer(fi),ln.size=ln.buffer.dimension|0,ln.normalized=!1,ln.type=ln.buffer.dtype,ln.offset=0,ln.stride=0,ln.divisor=0,ln.state=1,Qr[ii]=1}else tr.getBuffer(sn)?(ln.buffer=tr.getBuffer(sn),ln.size=ln.buffer.dimension|0,ln.normalized=!1,ln.type=ln.buffer.dtype,ln.offset=0,ln.stride=0,ln.divisor=0,ln.state=1):tr.getBuffer(sn.buffer)?(ln.buffer=tr.getBuffer(sn.buffer),ln.size=(+sn.size||ln.buffer.dimension)|0,ln.normalized=!!sn.normalized||!1,"type"in sn?(ne.parameter(sn.type,El,"invalid buffer type"),ln.type=El[sn.type]):ln.type=ln.buffer.dtype,ln.offset=(sn.offset||0)|0,ln.stride=(sn.stride||0)|0,ln.divisor=(sn.divisor||0)|0,ln.state=1,ne(ln.size>=1&&ln.size<=4,"size must be between 1 and 4"),ne(ln.offset>=0,"invalid offset"),ne(ln.stride>=0&&ln.stride<=255,"stride must be between 0 and 255"),ne(ln.divisor>=0,"divisor must be positive"),ne(!ln.divisor||!!Se.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in sn?(ne(ii>0,"first attribute must not be a constant"),ln.x=+sn.x||0,ln.y=+sn.y||0,ln.z=+sn.z||0,ln.w=+sn.w||0,ln.state=2):ne(!1,"invalid attribute spec for location "+ii)}for(var _i=0;_i<qt.buffers.length;++_i)!Qr[_i]&&qt.buffers[_i]&&(qt.buffers[_i].destroy(),qt.buffers[_i]=null);return qt.refresh(),jr}return jr.destroy=function(){for(var Ur=0;Ur<qt.buffers.length;++Ur)qt.buffers[Ur]&&qt.buffers[Ur].destroy();qt.buffers.length=0,qt.ownsElements&&(qt.elements.destroy(),qt.elements=null,qt.ownsElements=!1),qt.destroy()},jr._vao=qt,jr._reglType="vao",jr(Jt)}return xr}var ft=35632,xt=35633,Ut=35718,Bt=35721;function Wt(Z,Se,Ve,Rt){var tr={},kt={};function Yt(_t,Gt,_r,Zr){this.name=_t,this.id=Gt,this.location=_r,this.info=Zr}function sr(_t,Gt){for(var _r=0;_r<_t.length;++_r)if(_t[_r].id===Gt.id){_t[_r].location=Gt.location;return}_t.push(Gt)}function mr(_t,Gt,_r){var Zr=_t===ft?tr:kt,or=Zr[Gt];if(!or){var Fr=Se.str(Gt);or=Z.createShader(_t),Z.shaderSource(or,Fr),Z.compileShader(or),ne.shaderError(Z,or,Fr,_t,_r),Zr[Gt]=or}return or}var Cr={},wr=[],dr=0;function xr(_t,Gt){this.id=dr++,this.fragId=_t,this.vertId=Gt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Rt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function vr(_t,Gt,_r){var Zr,or,Fr=mr(ft,_t.fragId),Hr=mr(xt,_t.vertId),xn=_t.program=Z.createProgram();if(Z.attachShader(xn,Fr),Z.attachShader(xn,Hr),_r)for(Zr=0;Zr<_r.length;++Zr){var Jt=_r[Zr];Z.bindAttribLocation(xn,Jt[0],Jt[1])}Z.linkProgram(xn),ne.linkError(Z,xn,Se.str(_t.fragId),Se.str(_t.vertId),Gt);var qt=Z.getProgramParameter(xn,Ut);Rt.profile&&(_t.stats.uniformsCount=qt);var jr=_t.uniforms;for(Zr=0;Zr<qt;++Zr)if(or=Z.getActiveUniform(xn,Zr),or)if(or.size>1)for(var Ur=0;Ur<or.size;++Ur){var br=or.name.replace("[0]","["+Ur+"]");sr(jr,new Yt(br,Se.id(br),Z.getUniformLocation(xn,br),or))}else sr(jr,new Yt(or.name,Se.id(or.name),Z.getUniformLocation(xn,or.name),or));var qr=Z.getProgramParameter(xn,Bt);Rt.profile&&(_t.stats.attributesCount=qr);var Qr=_t.attributes;for(Zr=0;Zr<qr;++Zr)or=Z.getActiveAttrib(xn,Zr),or&&sr(Qr,new Yt(or.name,Se.id(or.name),Z.getAttribLocation(xn,or.name),or))}Rt.profile&&(Ve.getMaxUniformsCount=function(){var _t=0;return wr.forEach(function(Gt){Gt.stats.uniformsCount>_t&&(_t=Gt.stats.uniformsCount)}),_t},Ve.getMaxAttributesCount=function(){var _t=0;return wr.forEach(function(Gt){Gt.stats.attributesCount>_t&&(_t=Gt.stats.attributesCount)}),_t});function Er(){tr={},kt={};for(var _t=0;_t<wr.length;++_t)vr(wr[_t],null,wr[_t].attributes.map(function(Gt){return[Gt.location,Gt.name]}))}return{clear:function(){var _t=Z.deleteShader.bind(Z);et(tr).forEach(_t),tr={},et(kt).forEach(_t),kt={},wr.forEach(function(Gt){Z.deleteProgram(Gt.program)}),wr.length=0,Cr={},Ve.shaderCount=0},program:function(_t,Gt,_r,Zr){ne.command(_t>=0,"missing vertex shader",_r),ne.command(Gt>=0,"missing fragment shader",_r);var or=Cr[Gt];or||(or=Cr[Gt]={});var Fr=or[_t];if(Fr&&(Fr.refCount++,!Zr))return Fr;var Hr=new xr(Gt,_t);return Ve.shaderCount++,vr(Hr,_r,Zr),Fr||(or[_t]=Hr),wr.push(Hr),i(Hr,{destroy:function(){if(Hr.refCount--,Hr.refCount<=0){Z.deleteProgram(Hr.program);var xn=wr.indexOf(Hr);wr.splice(xn,1),Ve.shaderCount--}or[Hr.vertId].refCount<=0&&(Z.deleteShader(kt[Hr.vertId]),delete kt[Hr.vertId],delete Cr[Hr.fragId][Hr.vertId]),Object.keys(Cr[Hr.fragId]).length||(Z.deleteShader(tr[Hr.fragId]),delete tr[Hr.fragId],delete Cr[Hr.fragId])}})},restore:Er,shader:mr,frag:-1,vert:-1}}var hr=6408,yr=5121,Ir=3333,Kr=5126;function An(Z,Se,Ve,Rt,tr,kt,Yt){function sr(wr){var dr;Se.next===null?(ne(tr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),dr=yr):(ne(Se.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),dr=Se.next.colorAttachments[0].texture._texture.type,ne.optional(function(){kt.oes_texture_float?(ne(dr===yr||dr===Kr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),dr===Kr&&ne(Yt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):ne(dr===yr,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var xr=0,vr=0,Er=Rt.framebufferWidth,_t=Rt.framebufferHeight,Gt=null;n(wr)?Gt=wr:wr&&(ne.type(wr,"object","invalid arguments to regl.read()"),xr=wr.x|0,vr=wr.y|0,ne(xr>=0&&xr<Rt.framebufferWidth,"invalid x offset for regl.read"),ne(vr>=0&&vr<Rt.framebufferHeight,"invalid y offset for regl.read"),Er=(wr.width||Rt.framebufferWidth-xr)|0,_t=(wr.height||Rt.framebufferHeight-vr)|0,Gt=wr.data||null),Gt&&(dr===yr?ne(Gt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):dr===Kr&&ne(Gt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),ne(Er>0&&Er+xr<=Rt.framebufferWidth,"invalid width for read pixels"),ne(_t>0&&_t+vr<=Rt.framebufferHeight,"invalid height for read pixels"),Ve();var _r=Er*_t*4;return Gt||(dr===yr?Gt=new Uint8Array(_r):dr===Kr&&(Gt=Gt||new Float32Array(_r))),ne.isTypedArray(Gt,"data buffer for regl.read() must be a typedarray"),ne(Gt.byteLength>=_r,"data buffer for regl.read() too small"),Z.pixelStorei(Ir,4),Z.readPixels(xr,vr,Er,_t,hr,dr,Gt),Gt}function mr(wr){var dr;return Se.setFBO({framebuffer:wr.framebuffer},function(){dr=sr(wr)}),dr}function Cr(wr){return!wr||!("framebuffer"in wr)?sr(wr):mr(wr)}return Cr}function Nn(Z){return Array.prototype.slice.call(Z)}function Dn(Z){return Nn(Z).join("")}function sa(){var Z=0,Se=[],Ve=[];function Rt(dr){for(var xr=0;xr<Ve.length;++xr)if(Ve[xr]===dr)return Se[xr];var vr="g"+Z++;return Se.push(vr),Ve.push(dr),vr}function tr(){var dr=[];function xr(){dr.push.apply(dr,Nn(arguments))}var vr=[];function Er(){var _t="v"+Z++;return vr.push(_t),arguments.length>0&&(dr.push(_t,"="),dr.push.apply(dr,Nn(arguments)),dr.push(";")),_t}return i(xr,{def:Er,toString:function(){return Dn([vr.length>0?"var "+vr.join(",")+";":"",Dn(dr)])}})}function kt(){var dr=tr(),xr=tr(),vr=dr.toString,Er=xr.toString;function _t(Gt,_r){xr(Gt,_r,"=",dr.def(Gt,_r),";")}return i(function(){dr.apply(dr,Nn(arguments))},{def:dr.def,entry:dr,exit:xr,save:_t,set:function(Gt,_r,Zr){_t(Gt,_r),dr(Gt,_r,"=",Zr,";")},toString:function(){return vr()+Er()}})}function Yt(){var dr=Dn(arguments),xr=kt(),vr=kt(),Er=xr.toString,_t=vr.toString;return i(xr,{then:function(){return xr.apply(xr,Nn(arguments)),this},else:function(){return vr.apply(vr,Nn(arguments)),this},toString:function(){var Gt=_t();return Gt&&(Gt="else{"+Gt+"}"),Dn(["if(",dr,"){",Er(),"}",Gt])}})}var sr=tr(),mr={};function Cr(dr,xr){var vr=[];function Er(){var or="a"+vr.length;return vr.push(or),or}xr=xr||0;for(var _t=0;_t<xr;++_t)Er();var Gt=kt(),_r=Gt.toString,Zr=mr[dr]=i(Gt,{arg:Er,toString:function(){return Dn(["function(",vr.join(),"){",_r(),"}"])}});return Zr}function wr(){var dr=['"use strict";',sr,"return {"];Object.keys(mr).forEach(function(_t){dr.push('"',_t,'":',mr[_t].toString(),",")}),dr.push("}");var xr=Dn(dr).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),vr=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Er=vr?t.Function.apply(null,Se.concat(xr)):Function.apply(null,Se.concat(xr));return Er.apply(null,Ve)}return{global:sr,link:Rt,block:tr,proc:Cr,scope:kt,cond:Yt,compile:wr}}var on="xyzw".split(""),qn=5121,di=1,si=2,Jn=0,wi=1,ri=2,Tn=3,Zo=4,No=5,Mo=6,Ss="dither",vo="blend.enable",no="blend.color",Du="blend.equation",Ha="blend.func",Xc="depth.enable",tl="depth.func",dc="depth.range",ql="depth.mask",qf="colorMask",Rp="cull.enable",Kl="cull.face",Kf="frontFace",Op="lineWidth",Yc="polygonOffset.enable",Zc="polygonOffset.offset",qc="sample.alpha",Ns="sample.enable",Ql="sample.coverage",Sf="stencil.enable",zh="stencil.mask",ma="stencil.func",hl="stencil.opFront",Zs="stencil.opBack",Af="scissor.enable",pg="scissor.box",kl="viewport",vd="profile",vc="framebuffer",Fp="vert",Jl="frag",Tf="elements",$h="primitive",gc="count",Bu="offset",Em="instances",dg="vao",Sm="Width",Hy="Height",gd=vc+Sm,vg=vc+Hy,Am=kl+Sm,_a=kl+Hy,Tm="drawingBuffer",R_=Tm+Sm,Kc=Tm+Hy,gg=[Ha,Du,ma,hl,Zs,Ql,kl,pg,Zc],mg=34962,O_=34963,Mf=35632,mw=35633,Mm=3553,F_=34067,U1=2884,jy=3042,Qc=3024,Jc=2960,D_=2929,As=3089,wv=32823,B_=32926,yg=32928,Cv=5126,Uh=35664,Ev=35665,Lf=35666,Sv=5124,ef=35667,Av=35668,Lm=35669,Dp=35670,Wy=35671,_g=35672,Xy=35673,md=35674,yd=35675,ec=35676,xg=35678,bg=35680,Pl=4,mc=1028,_d=1029,Tv=2304,wg=2305,Cg=32775,N_=32776,z_=519,xd=7680,$_=0,If=1,Eg=32774,U_=513,Mv=36160,kf=36064,tf={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},V_=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Bp={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},yc={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Sg={frag:Mf,vert:mw},G_={cw:Tv,ccw:wg};function Im(Z){return Array.isArray(Z)||n(Z)||Te(Z)}function km(Z){return Z.sort(function(Se,Ve){return Se===kl?-1:Ve===kl?1:Se<Ve?-1:1})}function lu(Z,Se,Ve,Rt){this.thisDep=Z,this.contextDep=Se,this.propDep=Ve,this.append=Rt}function Qf(Z){return Z&&!(Z.thisDep||Z.contextDep||Z.propDep)}function Ca(Z){return new lu(!1,!1,!1,Z)}function tc(Z,Se){var Ve=Z.type;if(Ve===Jn){var Rt=Z.data.length;return new lu(!0,Rt>=1,Rt>=2,Se)}else if(Ve===Zo){var tr=Z.data;return new lu(tr.thisDep,tr.contextDep,tr.propDep,Se)}else{if(Ve===No)return new lu(!1,!1,!1,Se);if(Ve===Mo){for(var kt=!1,Yt=!1,sr=!1,mr=0;mr<Z.data.length;++mr){var Cr=Z.data[mr];if(Cr.type===wi)sr=!0;else if(Cr.type===ri)Yt=!0;else if(Cr.type===Tn)kt=!0;else if(Cr.type===Jn){kt=!0;var wr=Cr.data;wr>=1&&(Yt=!0),wr>=2&&(sr=!0)}else Cr.type===Zo&&(kt=kt||Cr.data.thisDep,Yt=Yt||Cr.data.contextDep,sr=sr||Cr.data.propDep)}return new lu(kt,Yt,sr,Se)}else return new lu(Ve===Tn,Ve===ri,Ve===wi,Se)}}var Jf=new lu(!1,!1,!1,function(){});function H_(Z,Se,Ve,Rt,tr,kt,Yt,sr,mr,Cr,wr,dr,xr,vr,Er){var _t=Cr.Record,Gt={add:32774,subtract:32778,"reverse subtract":32779};Ve.ext_blend_minmax&&(Gt.min=Cg,Gt.max=N_);var _r=Ve.angle_instanced_arrays,Zr=Ve.webgl_draw_buffers,or=Ve.oes_vertex_array_object,Fr={dirty:!0,profile:Er.profile},Hr={},xn=[],Jt={},qt={};function jr(ke){return ke.replace(".","_")}function Ur(ke,ge,Ye){var yt=jr(ke);xn.push(ke),Hr[yt]=Fr[yt]=!!Ye,Jt[yt]=ge}function br(ke,ge,Ye){var yt=jr(ke);xn.push(ke),Array.isArray(Ye)?(Fr[yt]=Ye.slice(),Hr[yt]=Ye.slice()):Fr[yt]=Hr[yt]=Ye,qt[yt]=ge}Ur(Ss,Qc),Ur(vo,jy),br(no,"blendColor",[0,0,0,0]),br(Du,"blendEquationSeparate",[Eg,Eg]),br(Ha,"blendFuncSeparate",[If,$_,If,$_]),Ur(Xc,D_,!0),br(tl,"depthFunc",U_),br(dc,"depthRange",[0,1]),br(ql,"depthMask",!0),br(qf,qf,[!0,!0,!0,!0]),Ur(Rp,U1),br(Kl,"cullFace",_d),br(Kf,Kf,wg),br(Op,Op,1),Ur(Yc,wv),br(Zc,"polygonOffset",[0,0]),Ur(qc,B_),Ur(Ns,yg),br(Ql,"sampleCoverage",[1,!1]),Ur(Sf,Jc),br(zh,"stencilMask",-1),br(ma,"stencilFunc",[z_,0,-1]),br(hl,"stencilOpSeparate",[mc,xd,xd,xd]),br(Zs,"stencilOpSeparate",[_d,xd,xd,xd]),Ur(Af,As),br(pg,"scissor",[0,0,Z.drawingBufferWidth,Z.drawingBufferHeight]),br(kl,kl,[0,0,Z.drawingBufferWidth,Z.drawingBufferHeight]);var qr={gl:Z,context:xr,strings:Se,next:Hr,current:Fr,draw:dr,elements:kt,buffer:tr,shader:wr,attributes:Cr.state,vao:Cr,uniforms:mr,framebuffer:sr,extensions:Ve,timer:vr,isBufferArgs:Im},Qr={primTypes:qu,compareFuncs:Bp,blendFuncs:tf,blendEquations:Gt,stencilOps:yc,glTypes:El,orientationType:G_};ne.optional(function(){qr.isArrayLike=ro}),Zr&&(Qr.backBuffer=[_d],Qr.drawBuffer=Ce(Rt.maxDrawbuffers,function(ke){return ke===0?[0]:Ce(ke,function(ge){return kf+ge})}));var li=0;function ii(){var ke=sa(),ge=ke.link,Ye=ke.global;ke.id=li++,ke.batchId="0";var yt=ge(qr),Ot=ke.shared={props:"a0"};Object.keys(qr).forEach(function(qe){Ot[qe]=Ye.def(yt,".",qe)}),ne.optional(function(){ke.CHECK=ge(ne),ke.commandStr=ne.guessCommand(),ke.command=ge(ke.commandStr),ke.assert=function(qe,Pe,vt){qe("if(!(",Pe,"))",this.CHECK,".commandRaise(",ge(vt),",",this.command,");")},Qr.invalidBlendCombinations=V_});var at=ke.next={},Je=ke.current={};Object.keys(qt).forEach(function(qe){Array.isArray(Fr[qe])&&(at[qe]=Ye.def(Ot.next,".",qe),Je[qe]=Ye.def(Ot.current,".",qe))});var ht=ke.constants={};Object.keys(Qr).forEach(function(qe){ht[qe]=Ye.def(JSON.stringify(Qr[qe]))}),ke.invoke=function(qe,Pe){switch(Pe.type){case Jn:var vt=["this",Ot.context,Ot.props,ke.batchId];return qe.def(ge(Pe.data),".call(",vt.slice(0,Math.max(Pe.data.length+1,4)),")");case wi:return qe.def(Ot.props,Pe.data);case ri:return qe.def(Ot.context,Pe.data);case Tn:return qe.def("this",Pe.data);case Zo:return Pe.data.append(ke,qe),Pe.data.ref;case No:return Pe.data.toString();case Mo:return Pe.data.map(function(St){return ke.invoke(qe,St)})}},ke.attribCache={};var ye={};return ke.scopeAttrib=function(qe){var Pe=Se.id(qe);if(Pe in ye)return ye[Pe];var vt=Cr.scope[Pe];vt||(vt=Cr.scope[Pe]=new _t);var St=ye[Pe]=ge(vt);return St},ke}function sn(ke){var ge=ke.static,Ye=ke.dynamic,yt;if(vd in ge){var Ot=!!ge[vd];yt=Ca(function(Je,ht){return Ot}),yt.enable=Ot}else if(vd in Ye){var at=Ye[vd];yt=tc(at,function(Je,ht){return Je.invoke(ht,at)})}return yt}function ln(ke,ge){var Ye=ke.static,yt=ke.dynamic;if(vc in Ye){var Ot=Ye[vc];return Ot?(Ot=sr.getFramebuffer(Ot),ne.command(Ot,"invalid framebuffer object"),Ca(function(Je,ht){var ye=Je.link(Ot),qe=Je.shared;ht.set(qe.framebuffer,".next",ye);var Pe=qe.context;return ht.set(Pe,"."+gd,ye+".width"),ht.set(Pe,"."+vg,ye+".height"),ye})):Ca(function(Je,ht){var ye=Je.shared;ht.set(ye.framebuffer,".next","null");var qe=ye.context;return ht.set(qe,"."+gd,qe+"."+R_),ht.set(qe,"."+vg,qe+"."+Kc),"null"})}else if(vc in yt){var at=yt[vc];return tc(at,function(Je,ht){var ye=Je.invoke(ht,at),qe=Je.shared,Pe=qe.framebuffer,vt=ht.def(Pe,".getFramebuffer(",ye,")");ne.optional(function(){Je.assert(ht,"!"+ye+"||"+vt,"invalid framebuffer object")}),ht.set(Pe,".next",vt);var St=qe.context;return ht.set(St,"."+gd,vt+"?"+vt+".width:"+St+"."+R_),ht.set(St,"."+vg,vt+"?"+vt+".height:"+St+"."+Kc),vt})}else return null}function Xn(ke,ge,Ye){var yt=ke.static,Ot=ke.dynamic;function at(ye){if(ye in yt){var qe=yt[ye];ne.commandType(qe,"object","invalid "+ye,Ye.commandStr);var Pe=!0,vt=qe.x|0,St=qe.y|0,ur,Nr;return"width"in qe?(ur=qe.width|0,ne.command(ur>=0,"invalid "+ye,Ye.commandStr)):Pe=!1,"height"in qe?(Nr=qe.height|0,ne.command(Nr>=0,"invalid "+ye,Ye.commandStr)):Pe=!1,new lu(!Pe&&ge&&ge.thisDep,!Pe&&ge&&ge.contextDep,!Pe&&ge&&ge.propDep,function(Dr,Mn){var pn=Dr.shared.context,bn=ur;"width"in qe||(bn=Mn.def(pn,".",gd,"-",vt));var Cn=Nr;return"height"in qe||(Cn=Mn.def(pn,".",vg,"-",St)),[vt,St,bn,Cn]})}else if(ye in Ot){var zr=Ot[ye],un=tc(zr,function(Dr,Mn){var pn=Dr.invoke(Mn,zr);ne.optional(function(){Dr.assert(Mn,pn+"&&typeof "+pn+'==="object"',"invalid "+ye)});var bn=Dr.shared.context,Cn=Mn.def(pn,".x|0"),En=Mn.def(pn,".y|0"),ni=Mn.def('"width" in ',pn,"?",pn,".width|0:","(",bn,".",gd,"-",Cn,")"),Pa=Mn.def('"height" in ',pn,"?",pn,".height|0:","(",bn,".",vg,"-",En,")");return ne.optional(function(){Dr.assert(Mn,ni+">=0&&"+Pa+">=0","invalid "+ye)}),[Cn,En,ni,Pa]});return ge&&(un.thisDep=un.thisDep||ge.thisDep,un.contextDep=un.contextDep||ge.contextDep,un.propDep=un.propDep||ge.propDep),un}else return ge?new lu(ge.thisDep,ge.contextDep,ge.propDep,function(Dr,Mn){var pn=Dr.shared.context;return[0,0,Mn.def(pn,".",gd),Mn.def(pn,".",vg)]}):null}var Je=at(kl);if(Je){var ht=Je;Je=new lu(Je.thisDep,Je.contextDep,Je.propDep,function(ye,qe){var Pe=ht.append(ye,qe),vt=ye.shared.context;return qe.set(vt,"."+Am,Pe[2]),qe.set(vt,"."+_a,Pe[3]),Pe})}return{viewport:Je,scissor_box:at(pg)}}function fi(ke,ge){var Ye=ke.static,yt=typeof Ye[Jl]=="string"&&typeof Ye[Fp]=="string";if(yt){if(Object.keys(ge.dynamic).length>0)return null;var Ot=ge.static,at=Object.keys(Ot);if(at.length>0&&typeof Ot[at[0]]=="number"){for(var Je=[],ht=0;ht<at.length;++ht)ne(typeof Ot[at[ht]]=="number","must specify all vertex attribute locations when using vaos"),Je.push([Ot[at[ht]]|0,at[ht]]);return Je}}return null}function _i(ke,ge,Ye){var yt=ke.static,Ot=ke.dynamic;function at(Pe){if(Pe in yt){var vt=Se.id(yt[Pe]);ne.optional(function(){wr.shader(Sg[Pe],vt,ne.guessCommand())});var St=Ca(function(){return vt});return St.id=vt,St}else if(Pe in Ot){var ur=Ot[Pe];return tc(ur,function(Nr,zr){var un=Nr.invoke(zr,ur),Dr=zr.def(Nr.shared.strings,".id(",un,")");return ne.optional(function(){zr(Nr.shared.shader,".shader(",Sg[Pe],",",Dr,",",Nr.command,");")}),Dr})}return null}var Je=at(Jl),ht=at(Fp),ye=null,qe;return Qf(Je)&&Qf(ht)?(ye=wr.program(ht.id,Je.id,null,Ye),qe=Ca(function(Pe,vt){return Pe.link(ye)})):qe=new lu(Je&&Je.thisDep||ht&&ht.thisDep,Je&&Je.contextDep||ht&&ht.contextDep,Je&&Je.propDep||ht&&ht.propDep,function(Pe,vt){var St=Pe.shared.shader,ur;Je?ur=Je.append(Pe,vt):ur=vt.def(St,".",Jl);var Nr;ht?Nr=ht.append(Pe,vt):Nr=vt.def(St,".",Fp);var zr=St+".program("+Nr+","+ur;return ne.optional(function(){zr+=","+Pe.command}),vt.def(zr+")")}),{frag:Je,vert:ht,progVar:qe,program:ye}}function Ka(ke,ge){var Ye=ke.static,yt=ke.dynamic,Ot={},at=!1;function Je(){if(dg in Ye){var Mn=Ye[dg];return Mn!==null&&Cr.getVAO(Mn)===null&&(Mn=Cr.createVAO(Mn)),at=!0,Ot.vao=Mn,Ca(function(bn){var Cn=Cr.getVAO(Mn);return Cn?bn.link(Cn):"null"})}else if(dg in yt){at=!0;var pn=yt[dg];return tc(pn,function(bn,Cn){var En=bn.invoke(Cn,pn);return Cn.def(bn.shared.vao+".getVAO("+En+")")})}return null}var ht=Je(),ye=!1;function qe(){if(Tf in Ye){var Mn=Ye[Tf];if(Ot.elements=Mn,Im(Mn)){var pn=Ot.elements=kt.create(Mn,!0);Mn=kt.getElements(pn),ye=!0}else Mn&&(Mn=kt.getElements(Mn),ye=!0,ne.command(Mn,"invalid elements",ge.commandStr));var bn=Ca(function(En,ni){if(Mn){var Pa=En.link(Mn);return En.ELEMENTS=Pa,Pa}return En.ELEMENTS=null,null});return bn.value=Mn,bn}else if(Tf in yt){ye=!0;var Cn=yt[Tf];return tc(Cn,function(En,ni){var Pa=En.shared,cu=Pa.isBufferArgs,xc=Pa.elements,Gh=En.invoke(ni,Cn),go=ni.def("null"),ta=ni.def(cu,"(",Gh,")"),eh=En.cond(ta).then(go,"=",xc,".createStream(",Gh,");").else(go,"=",xc,".getElements(",Gh,");");return ne.optional(function(){En.assert(eh.else,"!"+Gh+"||"+go,"invalid elements")}),ni.entry(eh),ni.exit(En.cond(ta).then(xc,".destroyStream(",go,");")),En.ELEMENTS=go,go})}else if(at)return new lu(ht.thisDep,ht.contextDep,ht.propDep,function(En,ni){return ni.def(En.shared.vao+".currentVAO?"+En.shared.elements+".getElements("+En.shared.vao+".currentVAO.elements):null")});return null}var Pe=qe();function vt(){if($h in Ye){var Mn=Ye[$h];return Ot.primitive=Mn,ne.commandParameter(Mn,qu,"invalid primitve",ge.commandStr),Ca(function(bn,Cn){return qu[Mn]})}else if($h in yt){var pn=yt[$h];return tc(pn,function(bn,Cn){var En=bn.constants.primTypes,ni=bn.invoke(Cn,pn);return ne.optional(function(){bn.assert(Cn,ni+" in "+En,"invalid primitive, must be one of "+Object.keys(qu))}),Cn.def(En,"[",ni,"]")})}else{if(ye)return Qf(Pe)?Pe.value?Ca(function(bn,Cn){return Cn.def(bn.ELEMENTS,".primType")}):Ca(function(){return Pl}):new lu(Pe.thisDep,Pe.contextDep,Pe.propDep,function(bn,Cn){var En=bn.ELEMENTS;return Cn.def(En,"?",En,".primType:",Pl)});if(at)return new lu(ht.thisDep,ht.contextDep,ht.propDep,function(bn,Cn){return Cn.def(bn.shared.vao+".currentVAO?"+bn.shared.vao+".currentVAO.primitive:"+Pl)})}return null}function St(Mn,pn){if(Mn in Ye){var bn=Ye[Mn]|0;return pn?Ot.offset=bn:Ot.instances=bn,ne.command(!pn||bn>=0,"invalid "+Mn,ge.commandStr),Ca(function(En,ni){return pn&&(En.OFFSET=bn),bn})}else if(Mn in yt){var Cn=yt[Mn];return tc(Cn,function(En,ni){var Pa=En.invoke(ni,Cn);return pn&&(En.OFFSET=Pa,ne.optional(function(){En.assert(ni,Pa+">=0","invalid "+Mn)})),Pa})}else if(pn){if(ye)return Ca(function(En,ni){return En.OFFSET=0,0});if(at)return new lu(ht.thisDep,ht.contextDep,ht.propDep,function(En,ni){return ni.def(En.shared.vao+".currentVAO?"+En.shared.vao+".currentVAO.offset:0")})}else if(at)return new lu(ht.thisDep,ht.contextDep,ht.propDep,function(En,ni){return ni.def(En.shared.vao+".currentVAO?"+En.shared.vao+".currentVAO.instances:-1")});return null}var ur=St(Bu,!0);function Nr(){if(gc in Ye){var Mn=Ye[gc]|0;return Ot.count=Mn,ne.command(typeof Mn=="number"&&Mn>=0,"invalid vertex count",ge.commandStr),Ca(function(){return Mn})}else if(gc in yt){var pn=yt[gc];return tc(pn,function(ni,Pa){var cu=ni.invoke(Pa,pn);return ne.optional(function(){ni.assert(Pa,"typeof "+cu+'==="number"&&'+cu+">=0&&"+cu+"===("+cu+"|0)","invalid vertex count")}),cu})}else if(ye)if(Qf(Pe)){if(Pe)return ur?new lu(ur.thisDep,ur.contextDep,ur.propDep,function(ni,Pa){var cu=Pa.def(ni.ELEMENTS,".vertCount-",ni.OFFSET);return ne.optional(function(){ni.assert(Pa,cu+">=0","invalid vertex offset/element buffer too small")}),cu}):Ca(function(ni,Pa){return Pa.def(ni.ELEMENTS,".vertCount")});var bn=Ca(function(){return-1});return ne.optional(function(){bn.MISSING=!0}),bn}else{var Cn=new lu(Pe.thisDep||ur.thisDep,Pe.contextDep||ur.contextDep,Pe.propDep||ur.propDep,function(ni,Pa){var cu=ni.ELEMENTS;return ni.OFFSET?Pa.def(cu,"?",cu,".vertCount-",ni.OFFSET,":-1"):Pa.def(cu,"?",cu,".vertCount:-1")});return ne.optional(function(){Cn.DYNAMIC=!0}),Cn}else if(at){var En=new lu(ht.thisDep,ht.contextDep,ht.propDep,function(ni,Pa){return Pa.def(ni.shared.vao,".currentVAO?",ni.shared.vao,".currentVAO.count:-1")});return En}return null}var zr=vt(),un=Nr(),Dr=St(Em,!1);return{elements:Pe,primitive:zr,count:un,instances:Dr,offset:ur,vao:ht,vaoActive:at,elementsActive:ye,static:Ot}}function gs(ke,ge){var Ye=ke.static,yt=ke.dynamic,Ot={};return xn.forEach(function(at){var Je=jr(at);function ht(ye,qe){if(at in Ye){var Pe=ye(Ye[at]);Ot[Je]=Ca(function(){return Pe})}else if(at in yt){var vt=yt[at];Ot[Je]=tc(vt,function(St,ur){return qe(St,ur,St.invoke(ur,vt))})}}switch(at){case Rp:case vo:case Ss:case Sf:case Xc:case Af:case Yc:case qc:case Ns:case ql:return ht(function(ye){return ne.commandType(ye,"boolean",at,ge.commandStr),ye},function(ye,qe,Pe){return ne.optional(function(){ye.assert(qe,"typeof "+Pe+'==="boolean"',"invalid flag "+at,ye.commandStr)}),Pe});case tl:return ht(function(ye){return ne.commandParameter(ye,Bp,"invalid "+at,ge.commandStr),Bp[ye]},function(ye,qe,Pe){var vt=ye.constants.compareFuncs;return ne.optional(function(){ye.assert(qe,Pe+" in "+vt,"invalid "+at+", must be one of "+Object.keys(Bp))}),qe.def(vt,"[",Pe,"]")});case dc:return ht(function(ye){return ne.command(ro(ye)&&ye.length===2&&typeof ye[0]=="number"&&typeof ye[1]=="number"&&ye[0]<=ye[1],"depth range is 2d array",ge.commandStr),ye},function(ye,qe,Pe){ne.optional(function(){ye.assert(qe,ye.shared.isArrayLike+"("+Pe+")&&"+Pe+".length===2&&typeof "+Pe+'[0]==="number"&&typeof '+Pe+'[1]==="number"&&'+Pe+"[0]<="+Pe+"[1]","depth range must be a 2d array")});var vt=qe.def("+",Pe,"[0]"),St=qe.def("+",Pe,"[1]");return[vt,St]});case Ha:return ht(function(ye){ne.commandType(ye,"object","blend.func",ge.commandStr);var qe="srcRGB"in ye?ye.srcRGB:ye.src,Pe="srcAlpha"in ye?ye.srcAlpha:ye.src,vt="dstRGB"in ye?ye.dstRGB:ye.dst,St="dstAlpha"in ye?ye.dstAlpha:ye.dst;return ne.commandParameter(qe,tf,Je+".srcRGB",ge.commandStr),ne.commandParameter(Pe,tf,Je+".srcAlpha",ge.commandStr),ne.commandParameter(vt,tf,Je+".dstRGB",ge.commandStr),ne.commandParameter(St,tf,Je+".dstAlpha",ge.commandStr),ne.command(V_.indexOf(qe+", "+vt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+qe+", "+vt+")",ge.commandStr),[tf[qe],tf[vt],tf[Pe],tf[St]]},function(ye,qe,Pe){var vt=ye.constants.blendFuncs;ne.optional(function(){ye.assert(qe,Pe+"&&typeof "+Pe+'==="object"',"invalid blend func, must be an object")});function St(pn,bn){var Cn=qe.def('"',pn,bn,'" in ',Pe,"?",Pe,".",pn,bn,":",Pe,".",pn);return ne.optional(function(){ye.assert(qe,Cn+" in "+vt,"invalid "+at+"."+pn+bn+", must be one of "+Object.keys(tf))}),Cn}var ur=St("src","RGB"),Nr=St("dst","RGB");ne.optional(function(){var pn=ye.constants.invalidBlendCombinations;ye.assert(qe,pn+".indexOf("+ur+'+", "+'+Nr+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var zr=qe.def(vt,"[",ur,"]"),un=qe.def(vt,"[",St("src","Alpha"),"]"),Dr=qe.def(vt,"[",Nr,"]"),Mn=qe.def(vt,"[",St("dst","Alpha"),"]");return[zr,Dr,un,Mn]});case Du:return ht(function(ye){if(typeof ye=="string")return ne.commandParameter(ye,Gt,"invalid "+at,ge.commandStr),[Gt[ye],Gt[ye]];if(typeof ye=="object")return ne.commandParameter(ye.rgb,Gt,at+".rgb",ge.commandStr),ne.commandParameter(ye.alpha,Gt,at+".alpha",ge.commandStr),[Gt[ye.rgb],Gt[ye.alpha]];ne.commandRaise("invalid blend.equation",ge.commandStr)},function(ye,qe,Pe){var vt=ye.constants.blendEquations,St=qe.def(),ur=qe.def(),Nr=ye.cond("typeof ",Pe,'==="string"');return ne.optional(function(){function zr(un,Dr,Mn){ye.assert(un,Mn+" in "+vt,"invalid "+Dr+", must be one of "+Object.keys(Gt))}zr(Nr.then,at,Pe),ye.assert(Nr.else,Pe+"&&typeof "+Pe+'==="object"',"invalid "+at),zr(Nr.else,at+".rgb",Pe+".rgb"),zr(Nr.else,at+".alpha",Pe+".alpha")}),Nr.then(St,"=",ur,"=",vt,"[",Pe,"];"),Nr.else(St,"=",vt,"[",Pe,".rgb];",ur,"=",vt,"[",Pe,".alpha];"),qe(Nr),[St,ur]});case no:return ht(function(ye){return ne.command(ro(ye)&&ye.length===4,"blend.color must be a 4d array",ge.commandStr),Ce(4,function(qe){return+ye[qe]})},function(ye,qe,Pe){return ne.optional(function(){ye.assert(qe,ye.shared.isArrayLike+"("+Pe+")&&"+Pe+".length===4","blend.color must be a 4d array")}),Ce(4,function(vt){return qe.def("+",Pe,"[",vt,"]")})});case zh:return ht(function(ye){return ne.commandType(ye,"number",Je,ge.commandStr),ye|0},function(ye,qe,Pe){return ne.optional(function(){ye.assert(qe,"typeof "+Pe+'==="number"',"invalid stencil.mask")}),qe.def(Pe,"|0")});case ma:return ht(function(ye){ne.commandType(ye,"object",Je,ge.commandStr);var qe=ye.cmp||"keep",Pe=ye.ref||0,vt="mask"in ye?ye.mask:-1;return ne.commandParameter(qe,Bp,at+".cmp",ge.commandStr),ne.commandType(Pe,"number",at+".ref",ge.commandStr),ne.commandType(vt,"number",at+".mask",ge.commandStr),[Bp[qe],Pe,vt]},function(ye,qe,Pe){var vt=ye.constants.compareFuncs;ne.optional(function(){function zr(){ye.assert(qe,Array.prototype.join.call(arguments,""),"invalid stencil.func")}zr(Pe+"&&typeof ",Pe,'==="object"'),zr('!("cmp" in ',Pe,")||(",Pe,".cmp in ",vt,")")});var St=qe.def('"cmp" in ',Pe,"?",vt,"[",Pe,".cmp]",":",xd),ur=qe.def(Pe,".ref|0"),Nr=qe.def('"mask" in ',Pe,"?",Pe,".mask|0:-1");return[St,ur,Nr]});case hl:case Zs:return ht(function(ye){ne.commandType(ye,"object",Je,ge.commandStr);var qe=ye.fail||"keep",Pe=ye.zfail||"keep",vt=ye.zpass||"keep";return ne.commandParameter(qe,yc,at+".fail",ge.commandStr),ne.commandParameter(Pe,yc,at+".zfail",ge.commandStr),ne.commandParameter(vt,yc,at+".zpass",ge.commandStr),[at===Zs?_d:mc,yc[qe],yc[Pe],yc[vt]]},function(ye,qe,Pe){var vt=ye.constants.stencilOps;ne.optional(function(){ye.assert(qe,Pe+"&&typeof "+Pe+'==="object"',"invalid "+at)});function St(ur){return ne.optional(function(){ye.assert(qe,'!("'+ur+'" in '+Pe+")||("+Pe+"."+ur+" in "+vt+")","invalid "+at+"."+ur+", must be one of "+Object.keys(yc))}),qe.def('"',ur,'" in ',Pe,"?",vt,"[",Pe,".",ur,"]:",xd)}return[at===Zs?_d:mc,St("fail"),St("zfail"),St("zpass")]});case Zc:return ht(function(ye){ne.commandType(ye,"object",Je,ge.commandStr);var qe=ye.factor|0,Pe=ye.units|0;return ne.commandType(qe,"number",Je+".factor",ge.commandStr),ne.commandType(Pe,"number",Je+".units",ge.commandStr),[qe,Pe]},function(ye,qe,Pe){ne.optional(function(){ye.assert(qe,Pe+"&&typeof "+Pe+'==="object"',"invalid "+at)});var vt=qe.def(Pe,".factor|0"),St=qe.def(Pe,".units|0");return[vt,St]});case Kl:return ht(function(ye){var qe=0;return ye==="front"?qe=mc:ye==="back"&&(qe=_d),ne.command(!!qe,Je,ge.commandStr),qe},function(ye,qe,Pe){return ne.optional(function(){ye.assert(qe,Pe+'==="front"||'+Pe+'==="back"',"invalid cull.face")}),qe.def(Pe,'==="front"?',mc,":",_d)});case Op:return ht(function(ye){return ne.command(typeof ye=="number"&&ye>=Rt.lineWidthDims[0]&&ye<=Rt.lineWidthDims[1],"invalid line width, must be a positive number between "+Rt.lineWidthDims[0]+" and "+Rt.lineWidthDims[1],ge.commandStr),ye},function(ye,qe,Pe){return ne.optional(function(){ye.assert(qe,"typeof "+Pe+'==="number"&&'+Pe+">="+Rt.lineWidthDims[0]+"&&"+Pe+"<="+Rt.lineWidthDims[1],"invalid line width")}),Pe});case Kf:return ht(function(ye){return ne.commandParameter(ye,G_,Je,ge.commandStr),G_[ye]},function(ye,qe,Pe){return ne.optional(function(){ye.assert(qe,Pe+'==="cw"||'+Pe+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),qe.def(Pe+'==="cw"?'+Tv+":"+wg)});case qf:return ht(function(ye){return ne.command(ro(ye)&&ye.length===4,"color.mask must be length 4 array",ge.commandStr),ye.map(function(qe){return!!qe})},function(ye,qe,Pe){return ne.optional(function(){ye.assert(qe,ye.shared.isArrayLike+"("+Pe+")&&"+Pe+".length===4","invalid color.mask")}),Ce(4,function(vt){return"!!"+Pe+"["+vt+"]"})});case Ql:return ht(function(ye){ne.command(typeof ye=="object"&&ye,Je,ge.commandStr);var qe="value"in ye?ye.value:1,Pe=!!ye.invert;return ne.command(typeof qe=="number"&&qe>=0&&qe<=1,"sample.coverage.value must be a number between 0 and 1",ge.commandStr),[qe,Pe]},function(ye,qe,Pe){ne.optional(function(){ye.assert(qe,Pe+"&&typeof "+Pe+'==="object"',"invalid sample.coverage")});var vt=qe.def('"value" in ',Pe,"?+",Pe,".value:1"),St=qe.def("!!",Pe,".invert");return[vt,St]})}}),Ot}function Vi(ke,ge){var Ye=ke.static,yt=ke.dynamic,Ot={};return Object.keys(Ye).forEach(function(at){var Je=Ye[at],ht;if(typeof Je=="number"||typeof Je=="boolean")ht=Ca(function(){return Je});else if(typeof Je=="function"){var ye=Je._reglType;ye==="texture2d"||ye==="textureCube"?ht=Ca(function(qe){return qe.link(Je)}):ye==="framebuffer"||ye==="framebufferCube"?(ne.command(Je.color.length>0,'missing color attachment for framebuffer sent to uniform "'+at+'"',ge.commandStr),ht=Ca(function(qe){return qe.link(Je.color[0])})):ne.commandRaise('invalid data for uniform "'+at+'"',ge.commandStr)}else ro(Je)?ht=Ca(function(qe){var Pe=qe.global.def("[",Ce(Je.length,function(vt){return ne.command(typeof Je[vt]=="number"||typeof Je[vt]=="boolean","invalid uniform "+at,qe.commandStr),Je[vt]}),"]");return Pe}):ne.commandRaise('invalid or missing data for uniform "'+at+'"',ge.commandStr);ht.value=Je,Ot[at]=ht}),Object.keys(yt).forEach(function(at){var Je=yt[at];Ot[at]=tc(Je,function(ht,ye){return ht.invoke(ye,Je)})}),Ot}function Au(ke,ge){var Ye=ke.static,yt=ke.dynamic,Ot={};return Object.keys(Ye).forEach(function(at){var Je=Ye[at],ht=Se.id(at),ye=new _t;if(Im(Je))ye.state=di,ye.buffer=tr.getBuffer(tr.create(Je,mg,!1,!0)),ye.type=0;else{var qe=tr.getBuffer(Je);if(qe)ye.state=di,ye.buffer=qe,ye.type=0;else if(ne.command(typeof Je=="object"&&Je,"invalid data for attribute "+at,ge.commandStr),"constant"in Je){var Pe=Je.constant;ye.buffer="null",ye.state=si,typeof Pe=="number"?ye.x=Pe:(ne.command(ro(Pe)&&Pe.length>0&&Pe.length<=4,"invalid constant for attribute "+at,ge.commandStr),on.forEach(function(Dr,Mn){Mn<Pe.length&&(ye[Dr]=Pe[Mn])}))}else{Im(Je.buffer)?qe=tr.getBuffer(tr.create(Je.buffer,mg,!1,!0)):qe=tr.getBuffer(Je.buffer),ne.command(!!qe,'missing buffer for attribute "'+at+'"',ge.commandStr);var vt=Je.offset|0;ne.command(vt>=0,'invalid offset for attribute "'+at+'"',ge.commandStr);var St=Je.stride|0;ne.command(St>=0&&St<256,'invalid stride for attribute "'+at+'", must be integer betweeen [0, 255]',ge.commandStr);var ur=Je.size|0;ne.command(!("size"in Je)||ur>0&&ur<=4,'invalid size for attribute "'+at+'", must be 1,2,3,4',ge.commandStr);var Nr=!!Je.normalized,zr=0;"type"in Je&&(ne.commandParameter(Je.type,El,"invalid type for attribute "+at,ge.commandStr),zr=El[Je.type]);var un=Je.divisor|0;ne.optional(function(){"divisor"in Je&&(ne.command(un===0||_r,'cannot specify divisor for attribute "'+at+'", instancing not supported',ge.commandStr),ne.command(un>=0,'invalid divisor for attribute "'+at+'"',ge.commandStr));var Dr=ge.commandStr,Mn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Je).forEach(function(pn){ne.command(Mn.indexOf(pn)>=0,'unknown parameter "'+pn+'" for attribute pointer "'+at+'" (valid parameters are '+Mn+")",Dr)})}),ye.buffer=qe,ye.state=di,ye.size=ur,ye.normalized=Nr,ye.type=zr||qe.dtype,ye.offset=vt,ye.stride=St,ye.divisor=un}}Ot[at]=Ca(function(Dr,Mn){var pn=Dr.attribCache;if(ht in pn)return pn[ht];var bn={isStream:!1};return Object.keys(ye).forEach(function(Cn){bn[Cn]=ye[Cn]}),ye.buffer&&(bn.buffer=Dr.link(ye.buffer),bn.type=bn.type||bn.buffer+".dtype"),pn[ht]=bn,bn})}),Object.keys(yt).forEach(function(at){var Je=yt[at];function ht(ye,qe){var Pe=ye.invoke(qe,Je),vt=ye.shared,St=ye.constants,ur=vt.isBufferArgs,Nr=vt.buffer;ne.optional(function(){ye.assert(qe,Pe+"&&(typeof "+Pe+'==="object"||typeof '+Pe+'==="function")&&('+ur+"("+Pe+")||"+Nr+".getBuffer("+Pe+")||"+Nr+".getBuffer("+Pe+".buffer)||"+ur+"("+Pe+'.buffer)||("constant" in '+Pe+"&&(typeof "+Pe+'.constant==="number"||'+vt.isArrayLike+"("+Pe+".constant))))",'invalid dynamic attribute "'+at+'"')});var zr={isStream:qe.def(!1)},un=new _t;un.state=di,Object.keys(un).forEach(function(bn){zr[bn]=qe.def(""+un[bn])});var Dr=zr.buffer,Mn=zr.type;qe("if(",ur,"(",Pe,")){",zr.isStream,"=true;",Dr,"=",Nr,".createStream(",mg,",",Pe,");",Mn,"=",Dr,".dtype;","}else{",Dr,"=",Nr,".getBuffer(",Pe,");","if(",Dr,"){",Mn,"=",Dr,".dtype;",'}else if("constant" in ',Pe,"){",zr.state,"=",si,";","if(typeof "+Pe+'.constant === "number"){',zr[on[0]],"=",Pe,".constant;",on.slice(1).map(function(bn){return zr[bn]}).join("="),"=0;","}else{",on.map(function(bn,Cn){return zr[bn]+"="+Pe+".constant.length>"+Cn+"?"+Pe+".constant["+Cn+"]:0;"}).join(""),"}}else{","if(",ur,"(",Pe,".buffer)){",Dr,"=",Nr,".createStream(",mg,",",Pe,".buffer);","}else{",Dr,"=",Nr,".getBuffer(",Pe,".buffer);","}",Mn,'="type" in ',Pe,"?",St.glTypes,"[",Pe,".type]:",Dr,".dtype;",zr.normalized,"=!!",Pe,".normalized;");function pn(bn){qe(zr[bn],"=",Pe,".",bn,"|0;")}return pn("size"),pn("offset"),pn("stride"),pn("divisor"),qe("}}"),qe.exit("if(",zr.isStream,"){",Nr,".destroyStream(",Dr,");","}"),zr}Ot[at]=tc(Je,ht)}),Ot}function Co(ke){var ge=ke.static,Ye=ke.dynamic,yt={};return Object.keys(ge).forEach(function(Ot){var at=ge[Ot];yt[Ot]=Ca(function(Je,ht){return typeof at=="number"||typeof at=="boolean"?""+at:Je.link(at)})}),Object.keys(Ye).forEach(function(Ot){var at=Ye[Ot];yt[Ot]=tc(at,function(Je,ht){return Je.invoke(ht,at)})}),yt}function qs(ke,ge,Ye,yt,Ot){var at=ke.static,Je=ke.dynamic;ne.optional(function(){var pn=[vc,Fp,Jl,Tf,$h,Bu,gc,Em,vd,dg].concat(xn);function bn(Cn){Object.keys(Cn).forEach(function(En){ne.command(pn.indexOf(En)>=0,'unknown parameter "'+En+'"',Ot.commandStr)})}bn(at),bn(Je)});var ht=fi(ke,ge),ye=ln(ke),qe=Xn(ke,ye,Ot),Pe=Ka(ke,Ot),vt=gs(ke,Ot),St=_i(ke,Ot,ht);function ur(pn){var bn=qe[pn];bn&&(vt[pn]=bn)}ur(kl),ur(jr(pg));var Nr=Object.keys(vt).length>0,zr={framebuffer:ye,draw:Pe,shader:St,state:vt,dirty:Nr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(zr.profile=sn(ke),zr.uniforms=Vi(Ye,Ot),zr.drawVAO=zr.scopeVAO=Pe.vao,!zr.drawVAO&&St.program&&!ht&&Ve.angle_instanced_arrays&&Pe.static.elements){var un=!0,Dr=St.program.attributes.map(function(pn){var bn=ge.static[pn];return un=un&&!!bn,bn});if(un&&Dr.length>0){var Mn=Cr.getVAO(Cr.createVAO({attributes:Dr,elements:Pe.static.elements}));zr.drawVAO=new lu(null,null,null,function(pn,bn){return pn.link(Mn)}),zr.useVAO=!0}}return ht?zr.useVAO=!0:zr.attributes=Au(ge,Ot),zr.context=Co(yt),zr}function zs(ke,ge,Ye){var yt=ke.shared,Ot=yt.context,at=ke.scope();Object.keys(Ye).forEach(function(Je){ge.save(Ot,"."+Je);var ht=Ye[Je],ye=ht.append(ke,ge);Array.isArray(ye)?at(Ot,".",Je,"=[",ye.join(),"];"):at(Ot,".",Je,"=",ye,";")}),ge(at)}function Tu(ke,ge,Ye,yt){var Ot=ke.shared,at=Ot.gl,Je=Ot.framebuffer,ht;Zr&&(ht=ge.def(Ot.extensions,".webgl_draw_buffers"));var ye=ke.constants,qe=ye.drawBuffer,Pe=ye.backBuffer,vt;Ye?vt=Ye.append(ke,ge):vt=ge.def(Je,".next"),yt||ge("if(",vt,"!==",Je,".cur){"),ge("if(",vt,"){",at,".bindFramebuffer(",Mv,",",vt,".framebuffer);"),Zr&&ge(ht,".drawBuffersWEBGL(",qe,"[",vt,".colorAttachments.length]);"),ge("}else{",at,".bindFramebuffer(",Mv,",null);"),Zr&&ge(ht,".drawBuffersWEBGL(",Pe,");"),ge("}",Je,".cur=",vt,";"),yt||ge("}")}function Mu(ke,ge,Ye){var yt=ke.shared,Ot=yt.gl,at=ke.current,Je=ke.next,ht=yt.current,ye=yt.next,qe=ke.cond(ht,".dirty");xn.forEach(function(Pe){var vt=jr(Pe);if(!(vt in Ye.state)){var St,ur;if(vt in Je){St=Je[vt],ur=at[vt];var Nr=Ce(Fr[vt].length,function(un){return qe.def(St,"[",un,"]")});qe(ke.cond(Nr.map(function(un,Dr){return un+"!=="+ur+"["+Dr+"]"}).join("||")).then(Ot,".",qt[vt],"(",Nr,");",Nr.map(function(un,Dr){return ur+"["+Dr+"]="+un}).join(";"),";"))}else{St=qe.def(ye,".",vt);var zr=ke.cond(St,"!==",ht,".",vt);qe(zr),vt in Jt?zr(ke.cond(St).then(Ot,".enable(",Jt[vt],");").else(Ot,".disable(",Jt[vt],");"),ht,".",vt,"=",St,";"):zr(Ot,".",qt[vt],"(",St,");",ht,".",vt,"=",St,";")}}}),Object.keys(Ye.state).length===0&&qe(ht,".dirty=false;"),ge(qe)}function Nu(ke,ge,Ye,yt){var Ot=ke.shared,at=ke.current,Je=Ot.current,ht=Ot.gl;km(Object.keys(Ye)).forEach(function(ye){var qe=Ye[ye];if(!(yt&&!yt(qe))){var Pe=qe.append(ke,ge);if(Jt[ye]){var vt=Jt[ye];Qf(qe)?Pe?ge(ht,".enable(",vt,");"):ge(ht,".disable(",vt,");"):ge(ke.cond(Pe).then(ht,".enable(",vt,");").else(ht,".disable(",vt,");")),ge(Je,".",ye,"=",Pe,";")}else if(ro(Pe)){var St=at[ye];ge(ht,".",qt[ye],"(",Pe,");",Pe.map(function(ur,Nr){return St+"["+Nr+"]="+ur}).join(";"),";")}else ge(ht,".",qt[ye],"(",Pe,");",Je,".",ye,"=",Pe,";")}})}function cs(ke,ge){_r&&(ke.instancing=ge.def(ke.shared.extensions,".angle_instanced_arrays"))}function ki(ke,ge,Ye,yt,Ot){var at=ke.shared,Je=ke.stats,ht=at.current,ye=at.timer,qe=Ye.profile;function Pe(){var pn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return pn||typeof performance=="undefined"?"Date.now()":"performance.now()"}var vt,St;function ur(pn){vt=ge.def(),pn(vt,"=",Pe(),";"),typeof Ot=="string"?pn(Je,".count+=",Ot,";"):pn(Je,".count++;"),vr&&(yt?(St=ge.def(),pn(St,"=",ye,".getNumPendingQueries();")):pn(ye,".beginQuery(",Je,");"))}function Nr(pn){pn(Je,".cpuTime+=",Pe(),"-",vt,";"),vr&&(yt?pn(ye,".pushScopeStats(",St,",",ye,".getNumPendingQueries(),",Je,");"):pn(ye,".endQuery();"))}function zr(pn){var bn=ge.def(ht,".profile");ge(ht,".profile=",pn,";"),ge.exit(ht,".profile=",bn,";")}var un;if(qe){if(Qf(qe)){qe.enable?(ur(ge),Nr(ge.exit),zr("true")):zr("false");return}un=qe.append(ke,ge),zr(un)}else un=ge.def(ht,".profile");var Dr=ke.block();ur(Dr),ge("if(",un,"){",Dr,"}");var Mn=ke.block();Nr(Mn),ge.exit("if(",un,"){",Mn,"}")}function Ks(ke,ge,Ye,yt,Ot){var at=ke.shared;function Je(ye){switch(ye){case Uh:case ef:case Wy:return 2;case Ev:case Av:case _g:return 3;case Lf:case Lm:case Xy:return 4;default:return 1}}function ht(ye,qe,Pe){var vt=at.gl,St=ge.def(ye,".location"),ur=ge.def(at.attributes,"[",St,"]"),Nr=Pe.state,zr=Pe.buffer,un=[Pe.x,Pe.y,Pe.z,Pe.w],Dr=["buffer","normalized","offset","stride"];function Mn(){ge("if(!",ur,".buffer){",vt,".enableVertexAttribArray(",St,");}");var bn=Pe.type,Cn;if(Pe.size?Cn=ge.def(Pe.size,"||",qe):Cn=qe,ge("if(",ur,".type!==",bn,"||",ur,".size!==",Cn,"||",Dr.map(function(ni){return ur+"."+ni+"!=="+Pe[ni]}).join("||"),"){",vt,".bindBuffer(",mg,",",zr,".buffer);",vt,".vertexAttribPointer(",[St,Cn,bn,Pe.normalized,Pe.stride,Pe.offset],");",ur,".type=",bn,";",ur,".size=",Cn,";",Dr.map(function(ni){return ur+"."+ni+"="+Pe[ni]+";"}).join(""),"}"),_r){var En=Pe.divisor;ge("if(",ur,".divisor!==",En,"){",ke.instancing,".vertexAttribDivisorANGLE(",[St,En],");",ur,".divisor=",En,";}")}}function pn(){ge("if(",ur,".buffer){",vt,".disableVertexAttribArray(",St,");",ur,".buffer=null;","}if(",on.map(function(bn,Cn){return ur+"."+bn+"!=="+un[Cn]}).join("||"),"){",vt,".vertexAttrib4f(",St,",",un,");",on.map(function(bn,Cn){return ur+"."+bn+"="+un[Cn]+";"}).join(""),"}")}Nr===di?Mn():Nr===si?pn():(ge("if(",Nr,"===",di,"){"),Mn(),ge("}else{"),pn(),ge("}"))}yt.forEach(function(ye){var qe=ye.name,Pe=Ye.attributes[qe],vt;if(Pe){if(!Ot(Pe))return;vt=Pe.append(ke,ge)}else{if(!Ot(Jf))return;var St=ke.scopeAttrib(qe);ne.optional(function(){ke.assert(ge,St+".state","missing attribute "+qe)}),vt={},Object.keys(new _t).forEach(function(ur){vt[ur]=ge.def(St,".",ur)})}ht(ke.link(ye),Je(ye.info.type),vt)})}function Ea(ke,ge,Ye,yt,Ot,at){for(var Je=ke.shared,ht=Je.gl,ye,qe=0;qe<yt.length;++qe){var Pe=yt[qe],vt=Pe.name,St=Pe.info.type,ur=Ye.uniforms[vt],Nr=ke.link(Pe),zr=Nr+".location",un;if(ur){if(!Ot(ur))continue;if(Qf(ur)){var Dr=ur.value;if(ne.command(Dr!==null&&typeof Dr!="undefined",'missing uniform "'+vt+'"',ke.commandStr),St===xg||St===bg){ne.command(typeof Dr=="function"&&(St===xg&&(Dr._reglType==="texture2d"||Dr._reglType==="framebuffer")||St===bg&&(Dr._reglType==="textureCube"||Dr._reglType==="framebufferCube")),"invalid texture for uniform "+vt,ke.commandStr);var Mn=ke.link(Dr._texture||Dr.color[0]._texture);ge(ht,".uniform1i(",zr,",",Mn+".bind());"),ge.exit(Mn,".unbind();")}else if(St===md||St===yd||St===ec){ne.optional(function(){ne.command(ro(Dr),"invalid matrix for uniform "+vt,ke.commandStr),ne.command(St===md&&Dr.length===4||St===yd&&Dr.length===9||St===ec&&Dr.length===16,"invalid length for matrix uniform "+vt,ke.commandStr)});var pn=ke.global.def("new Float32Array(["+Array.prototype.slice.call(Dr)+"])"),bn=2;St===yd?bn=3:St===ec&&(bn=4),ge(ht,".uniformMatrix",bn,"fv(",zr,",false,",pn,");")}else{switch(St){case Cv:ne.commandType(Dr,"number","uniform "+vt,ke.commandStr),ye="1f";break;case Uh:ne.command(ro(Dr)&&Dr.length===2,"uniform "+vt,ke.commandStr),ye="2f";break;case Ev:ne.command(ro(Dr)&&Dr.length===3,"uniform "+vt,ke.commandStr),ye="3f";break;case Lf:ne.command(ro(Dr)&&Dr.length===4,"uniform "+vt,ke.commandStr),ye="4f";break;case Dp:ne.commandType(Dr,"boolean","uniform "+vt,ke.commandStr),ye="1i";break;case Sv:ne.commandType(Dr,"number","uniform "+vt,ke.commandStr),ye="1i";break;case Wy:ne.command(ro(Dr)&&Dr.length===2,"uniform "+vt,ke.commandStr),ye="2i";break;case ef:ne.command(ro(Dr)&&Dr.length===2,"uniform "+vt,ke.commandStr),ye="2i";break;case _g:ne.command(ro(Dr)&&Dr.length===3,"uniform "+vt,ke.commandStr),ye="3i";break;case Av:ne.command(ro(Dr)&&Dr.length===3,"uniform "+vt,ke.commandStr),ye="3i";break;case Xy:ne.command(ro(Dr)&&Dr.length===4,"uniform "+vt,ke.commandStr),ye="4i";break;case Lm:ne.command(ro(Dr)&&Dr.length===4,"uniform "+vt,ke.commandStr),ye="4i";break}ge(ht,".uniform",ye,"(",zr,",",ro(Dr)?Array.prototype.slice.call(Dr):Dr,");")}continue}else un=ur.append(ke,ge)}else{if(!Ot(Jf))continue;un=ge.def(Je.uniforms,"[",Se.id(vt),"]")}St===xg?(ne(!Array.isArray(un),"must specify a scalar prop for textures"),ge("if(",un,"&&",un,'._reglType==="framebuffer"){',un,"=",un,".color[0];","}")):St===bg&&(ne(!Array.isArray(un),"must specify a scalar prop for cube maps"),ge("if(",un,"&&",un,'._reglType==="framebufferCube"){',un,"=",un,".color[0];","}")),ne.optional(function(){function ta(nf,X_){ke.assert(ge,nf,'bad data or missing for uniform "'+vt+'".  '+X_)}function eh(nf){ne(!Array.isArray(un),"must not specify an array type for uniform"),ta("typeof "+un+'==="'+nf+'"',"invalid type, expected "+nf)}function rf(nf,X_){Array.isArray(un)?ne(un.length===nf,"must have length "+nf):ta(Je.isArrayLike+"("+un+")&&"+un+".length==="+nf,"invalid vector, should have length "+nf,ke.commandStr)}function Pm(nf){ne(!Array.isArray(un),"must not specify a value type"),ta("typeof "+un+'==="function"&&'+un+'._reglType==="texture'+(nf===Mm?"2d":"Cube")+'"',"invalid texture type",ke.commandStr)}switch(St){case Sv:eh("number");break;case ef:rf(2);break;case Av:rf(3);break;case Lm:rf(4);break;case Cv:eh("number");break;case Uh:rf(2);break;case Ev:rf(3);break;case Lf:rf(4);break;case Dp:eh("boolean");break;case Wy:rf(2);break;case _g:rf(3);break;case Xy:rf(4);break;case md:rf(4);break;case yd:rf(9);break;case ec:rf(16);break;case xg:Pm(Mm);break;case bg:Pm(F_);break}});var Cn=1;switch(St){case xg:case bg:var En=ge.def(un,"._texture");ge(ht,".uniform1i(",zr,",",En,".bind());"),ge.exit(En,".unbind();");continue;case Sv:case Dp:ye="1i";break;case ef:case Wy:ye="2i",Cn=2;break;case Av:case _g:ye="3i",Cn=3;break;case Lm:case Xy:ye="4i",Cn=4;break;case Cv:ye="1f";break;case Uh:ye="2f",Cn=2;break;case Ev:ye="3f",Cn=3;break;case Lf:ye="4f",Cn=4;break;case md:ye="Matrix2fv";break;case yd:ye="Matrix3fv";break;case ec:ye="Matrix4fv";break}if(ye.charAt(0)==="M"){ge(ht,".uniform",ye,"(",zr,",");var ni=Math.pow(St-md+2,2),Pa=ke.global.def("new Float32Array(",ni,")");Array.isArray(un)?ge("false,(",Ce(ni,function(ta){return Pa+"["+ta+"]="+un[ta]}),",",Pa,")"):ge("false,(Array.isArray(",un,")||",un," instanceof Float32Array)?",un,":(",Ce(ni,function(ta){return Pa+"["+ta+"]="+un+"["+ta+"]"}),",",Pa,")"),ge(");")}else if(Cn>1){for(var cu=[],xc=[],Gh=0;Gh<Cn;++Gh)Array.isArray(un)?xc.push(un[Gh]):xc.push(ge.def(un+"["+Gh+"]")),at&&cu.push(ge.def());at&&ge("if(!",ke.batchId,"||",cu.map(function(ta,eh){return ta+"!=="+xc[eh]}).join("||"),"){",cu.map(function(ta,eh){return ta+"="+xc[eh]+";"}).join("")),ge(ht,".uniform",ye,"(",zr,",",xc.join(","),");"),at&&ge("}")}else{if(ne(!Array.isArray(un),"uniform value must not be an array"),at){var go=ge.def();ge("if(!",ke.batchId,"||",go,"!==",un,"){",go,"=",un,";")}ge(ht,".uniform",ye,"(",zr,",",un,");"),at&&ge("}")}}}function Ts(ke,ge,Ye,yt){var Ot=ke.shared,at=Ot.gl,Je=Ot.draw,ht=yt.draw;function ye(){var Cn=ht.elements,En,ni=ge;return Cn?((Cn.contextDep&&yt.contextDynamic||Cn.propDep)&&(ni=Ye),En=Cn.append(ke,ni),ht.elementsActive&&ni("if("+En+")"+at+".bindBuffer("+O_+","+En+".buffer.buffer);")):(En=ni.def(),ni(En,"=",Je,".",Tf,";","if(",En,"){",at,".bindBuffer(",O_,",",En,".buffer.buffer);}","else if(",Ot.vao,".currentVAO){",En,"=",ke.shared.elements+".getElements("+Ot.vao,".currentVAO.elements);",or?"":"if("+En+")"+at+".bindBuffer("+O_+","+En+".buffer.buffer);","}")),En}function qe(){var Cn=ht.count,En,ni=ge;return Cn?((Cn.contextDep&&yt.contextDynamic||Cn.propDep)&&(ni=Ye),En=Cn.append(ke,ni),ne.optional(function(){Cn.MISSING&&ke.assert(ge,"false","missing vertex count"),Cn.DYNAMIC&&ke.assert(ni,En+">=0","missing vertex count")})):(En=ni.def(Je,".",gc),ne.optional(function(){ke.assert(ni,En+">=0","missing vertex count")})),En}var Pe=ye();function vt(Cn){var En=ht[Cn];return En?En.contextDep&&yt.contextDynamic||En.propDep?En.append(ke,Ye):En.append(ke,ge):ge.def(Je,".",Cn)}var St=vt($h),ur=vt(Bu),Nr=qe();if(typeof Nr=="number"){if(Nr===0)return}else Ye("if(",Nr,"){"),Ye.exit("}");var zr,un;_r&&(zr=vt(Em),un=ke.instancing);var Dr=Pe+".type",Mn=ht.elements&&Qf(ht.elements)&&!ht.vaoActive;function pn(){function Cn(){Ye(un,".drawElementsInstancedANGLE(",[St,Nr,Dr,ur+"<<(("+Dr+"-"+qn+")>>1)",zr],");")}function En(){Ye(un,".drawArraysInstancedANGLE(",[St,ur,Nr,zr],");")}Pe&&Pe!=="null"?Mn?Cn():(Ye("if(",Pe,"){"),Cn(),Ye("}else{"),En(),Ye("}")):En()}function bn(){function Cn(){Ye(at+".drawElements("+[St,Nr,Dr,ur+"<<(("+Dr+"-"+qn+")>>1)"]+");")}function En(){Ye(at+".drawArrays("+[St,ur,Nr]+");")}Pe&&Pe!=="null"?Mn?Cn():(Ye("if(",Pe,"){"),Cn(),Ye("}else{"),En(),Ye("}")):En()}_r&&(typeof zr!="number"||zr>=0)?typeof zr=="string"?(Ye("if(",zr,">0){"),pn(),Ye("}else if(",zr,"<0){"),bn(),Ye("}")):pn():bn()}function Kn(ke,ge,Ye,yt,Ot){var at=ii(),Je=at.proc("body",Ot);return ne.optional(function(){at.commandStr=ge.commandStr,at.command=at.link(ge.commandStr)}),_r&&(at.instancing=Je.def(at.shared.extensions,".angle_instanced_arrays")),ke(at,Je,Ye,yt),at.compile().body}function Gi(ke,ge,Ye,yt){cs(ke,ge),Ye.useVAO?Ye.drawVAO?ge(ke.shared.vao,".setVAO(",Ye.drawVAO.append(ke,ge),");"):ge(ke.shared.vao,".setVAO(",ke.shared.vao,".targetVAO);"):(ge(ke.shared.vao,".setVAO(null);"),Ks(ke,ge,Ye,yt.attributes,function(){return!0})),Ea(ke,ge,Ye,yt.uniforms,function(){return!0},!1),Ts(ke,ge,ge,Ye)}function io(ke,ge){var Ye=ke.proc("draw",1);cs(ke,Ye),zs(ke,Ye,ge.context),Tu(ke,Ye,ge.framebuffer),Mu(ke,Ye,ge),Nu(ke,Ye,ge.state),ki(ke,Ye,ge,!1,!0);var yt=ge.shader.progVar.append(ke,Ye);if(Ye(ke.shared.gl,".useProgram(",yt,".program);"),ge.shader.program)Gi(ke,Ye,ge,ge.shader.program);else{Ye(ke.shared.vao,".setVAO(null);");var Ot=ke.global.def("{}"),at=Ye.def(yt,".id"),Je=Ye.def(Ot,"[",at,"]");Ye(ke.cond(Je).then(Je,".call(this,a0);").else(Je,"=",Ot,"[",at,"]=",ke.link(function(ht){return Kn(Gi,ke,ge,ht,1)}),"(",yt,");",Je,".call(this,a0);"))}Object.keys(ge.state).length>0&&Ye(ke.shared.current,".dirty=true;"),ke.shared.vao&&Ye(ke.shared.vao,".setVAO(null);")}function Qs(ke,ge,Ye,yt){ke.batchId="a1",cs(ke,ge);function Ot(){return!0}Ks(ke,ge,Ye,yt.attributes,Ot),Ea(ke,ge,Ye,yt.uniforms,Ot,!1),Ts(ke,ge,ge,Ye)}function _c(ke,ge,Ye,yt){cs(ke,ge);var Ot=Ye.contextDep,at=ge.def(),Je="a0",ht="a1",ye=ge.def();ke.shared.props=ye,ke.batchId=at;var qe=ke.scope(),Pe=ke.scope();ge(qe.entry,"for(",at,"=0;",at,"<",ht,";++",at,"){",ye,"=",Je,"[",at,"];",Pe,"}",qe.exit);function vt(Dr){return Dr.contextDep&&Ot||Dr.propDep}function St(Dr){return!vt(Dr)}if(Ye.needsContext&&zs(ke,Pe,Ye.context),Ye.needsFramebuffer&&Tu(ke,Pe,Ye.framebuffer),Nu(ke,Pe,Ye.state,vt),Ye.profile&&vt(Ye.profile)&&ki(ke,Pe,Ye,!1,!0),yt)Ye.useVAO?Ye.drawVAO?vt(Ye.drawVAO)?Pe(ke.shared.vao,".setVAO(",Ye.drawVAO.append(ke,Pe),");"):qe(ke.shared.vao,".setVAO(",Ye.drawVAO.append(ke,qe),");"):qe(ke.shared.vao,".setVAO(",ke.shared.vao,".targetVAO);"):(qe(ke.shared.vao,".setVAO(null);"),Ks(ke,qe,Ye,yt.attributes,St),Ks(ke,Pe,Ye,yt.attributes,vt)),Ea(ke,qe,Ye,yt.uniforms,St,!1),Ea(ke,Pe,Ye,yt.uniforms,vt,!0),Ts(ke,qe,Pe,Ye);else{var ur=ke.global.def("{}"),Nr=Ye.shader.progVar.append(ke,Pe),zr=Pe.def(Nr,".id"),un=Pe.def(ur,"[",zr,"]");Pe(ke.shared.gl,".useProgram(",Nr,".program);","if(!",un,"){",un,"=",ur,"[",zr,"]=",ke.link(function(Dr){return Kn(Qs,ke,Ye,Dr,2)}),"(",Nr,");}",un,".call(this,a0[",at,"],",at,");")}}function Fe(ke,ge){var Ye=ke.proc("batch",2);ke.batchId="0",cs(ke,Ye);var yt=!1,Ot=!0;Object.keys(ge.context).forEach(function(ur){yt=yt||ge.context[ur].propDep}),yt||(zs(ke,Ye,ge.context),Ot=!1);var at=ge.framebuffer,Je=!1;at?(at.propDep?yt=Je=!0:at.contextDep&&yt&&(Je=!0),Je||Tu(ke,Ye,at)):Tu(ke,Ye,null),ge.state.viewport&&ge.state.viewport.propDep&&(yt=!0);function ht(ur){return ur.contextDep&&yt||ur.propDep}Mu(ke,Ye,ge),Nu(ke,Ye,ge.state,function(ur){return!ht(ur)}),(!ge.profile||!ht(ge.profile))&&ki(ke,Ye,ge,!1,"a1"),ge.contextDep=yt,ge.needsContext=Ot,ge.needsFramebuffer=Je;var ye=ge.shader.progVar;if(ye.contextDep&&yt||ye.propDep)_c(ke,Ye,ge,null);else{var qe=ye.append(ke,Ye);if(Ye(ke.shared.gl,".useProgram(",qe,".program);"),ge.shader.program)_c(ke,Ye,ge,ge.shader.program);else{Ye(ke.shared.vao,".setVAO(null);");var Pe=ke.global.def("{}"),vt=Ye.def(qe,".id"),St=Ye.def(Pe,"[",vt,"]");Ye(ke.cond(St).then(St,".call(this,a0,a1);").else(St,"=",Pe,"[",vt,"]=",ke.link(function(ur){return Kn(_c,ke,ge,ur,2)}),"(",qe,");",St,".call(this,a0,a1);"))}}Object.keys(ge.state).length>0&&Ye(ke.shared.current,".dirty=true;"),ke.shared.vao&&Ye(ke.shared.vao,".setVAO(null);")}function Ft(ke,ge){var Ye=ke.proc("scope",3);ke.batchId="a2";var yt=ke.shared,Ot=yt.current;zs(ke,Ye,ge.context),ge.framebuffer&&ge.framebuffer.append(ke,Ye),km(Object.keys(ge.state)).forEach(function(Je){var ht=ge.state[Je],ye=ht.append(ke,Ye);ro(ye)?ye.forEach(function(qe,Pe){Ye.set(ke.next[Je],"["+Pe+"]",qe)}):Ye.set(yt.next,"."+Je,ye)}),ki(ke,Ye,ge,!0,!0),[Tf,Bu,gc,Em,$h].forEach(function(Je){var ht=ge.draw[Je];!ht||Ye.set(yt.draw,"."+Je,""+ht.append(ke,Ye))}),Object.keys(ge.uniforms).forEach(function(Je){var ht=ge.uniforms[Je].append(ke,Ye);Array.isArray(ht)&&(ht="["+ht.join()+"]"),Ye.set(yt.uniforms,"["+Se.id(Je)+"]",ht)}),Object.keys(ge.attributes).forEach(function(Je){var ht=ge.attributes[Je].append(ke,Ye),ye=ke.scopeAttrib(Je);Object.keys(new _t).forEach(function(qe){Ye.set(ye,"."+qe,ht[qe])})}),ge.scopeVAO&&Ye.set(yt.vao,".targetVAO",ge.scopeVAO.append(ke,Ye));function at(Je){var ht=ge.shader[Je];ht&&Ye.set(yt.shader,"."+Je,ht.append(ke,Ye))}at(Fp),at(Jl),Object.keys(ge.state).length>0&&(Ye(Ot,".dirty=true;"),Ye.exit(Ot,".dirty=true;")),Ye("a1(",ke.shared.context,",a0,",ke.batchId,");")}function Ct(ke){if(!(typeof ke!="object"||ro(ke))){for(var ge=Object.keys(ke),Ye=0;Ye<ge.length;++Ye)if(Fo.isDynamic(ke[ge[Ye]]))return!0;return!1}}function vn(ke,ge,Ye){var yt=ge.static[Ye];if(!yt||!Ct(yt))return;var Ot=ke.global,at=Object.keys(yt),Je=!1,ht=!1,ye=!1,qe=ke.global.def("{}");at.forEach(function(vt){var St=yt[vt];if(Fo.isDynamic(St)){typeof St=="function"&&(St=yt[vt]=Fo.unbox(St));var ur=tc(St,null);Je=Je||ur.thisDep,ye=ye||ur.propDep,ht=ht||ur.contextDep}else{switch(Ot(qe,".",vt,"="),typeof St){case"number":Ot(St);break;case"string":Ot('"',St,'"');break;case"object":Array.isArray(St)&&Ot("[",St.join(),"]");break;default:Ot(ke.link(St));break}Ot(";")}});function Pe(vt,St){at.forEach(function(ur){var Nr=yt[ur];if(!!Fo.isDynamic(Nr)){var zr=vt.invoke(St,Nr);St(qe,".",ur,"=",zr,";")}})}ge.dynamic[Ye]=new Fo.DynamicVariable(Zo,{thisDep:Je,contextDep:ht,propDep:ye,ref:qe,append:Pe}),delete ge.static[Ye]}function Wi(ke,ge,Ye,yt,Ot){var at=ii();at.stats=at.link(Ot),Object.keys(ge.static).forEach(function(ht){vn(at,ge,ht)}),gg.forEach(function(ht){vn(at,ke,ht)});var Je=qs(ke,ge,Ye,yt,at);return io(at,Je),Ft(at,Je),Fe(at,Je),i(at.compile(),{destroy:function(){Je.shader.program.destroy()}})}return{next:Hr,current:Fr,procs:function(){var ke=ii(),ge=ke.proc("poll"),Ye=ke.proc("refresh"),yt=ke.block();ge(yt),Ye(yt);var Ot=ke.shared,at=Ot.gl,Je=Ot.next,ht=Ot.current;yt(ht,".dirty=false;"),Tu(ke,ge),Tu(ke,Ye,null,!0);var ye;_r&&(ye=ke.link(_r)),Ve.oes_vertex_array_object&&Ye(ke.link(Ve.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var qe=0;qe<Rt.maxAttributes;++qe){var Pe=Ye.def(Ot.attributes,"[",qe,"]"),vt=ke.cond(Pe,".buffer");vt.then(at,".enableVertexAttribArray(",qe,");",at,".bindBuffer(",mg,",",Pe,".buffer.buffer);",at,".vertexAttribPointer(",qe,",",Pe,".size,",Pe,".type,",Pe,".normalized,",Pe,".stride,",Pe,".offset);").else(at,".disableVertexAttribArray(",qe,");",at,".vertexAttrib4f(",qe,",",Pe,".x,",Pe,".y,",Pe,".z,",Pe,".w);",Pe,".buffer=null;"),Ye(vt),_r&&Ye(ye,".vertexAttribDivisorANGLE(",qe,",",Pe,".divisor);")}return Ye(ke.shared.vao,".currentVAO=null;",ke.shared.vao,".setVAO(",ke.shared.vao,".targetVAO);"),Object.keys(Jt).forEach(function(St){var ur=Jt[St],Nr=yt.def(Je,".",St),zr=ke.block();zr("if(",Nr,"){",at,".enable(",ur,")}else{",at,".disable(",ur,")}",ht,".",St,"=",Nr,";"),Ye(zr),ge("if(",Nr,"!==",ht,".",St,"){",zr,"}")}),Object.keys(qt).forEach(function(St){var ur=qt[St],Nr=Fr[St],zr,un,Dr=ke.block();if(Dr(at,".",ur,"("),ro(Nr)){var Mn=Nr.length;zr=ke.global.def(Je,".",St),un=ke.global.def(ht,".",St),Dr(Ce(Mn,function(pn){return zr+"["+pn+"]"}),");",Ce(Mn,function(pn){return un+"["+pn+"]="+zr+"["+pn+"];"}).join("")),ge("if(",Ce(Mn,function(pn){return zr+"["+pn+"]!=="+un+"["+pn+"]"}).join("||"),"){",Dr,"}")}else zr=yt.def(Je,".",St),un=yt.def(ht,".",St),Dr(zr,");",ht,".",St,"=",zr,";"),ge("if(",zr,"!==",un,"){",Dr,"}");Ye(Dr)}),ke.compile()}(),compile:Wi}}function V1(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var G1=34918,H1=34919,j1=35007,yw=function(Z,Se){if(!Se.ext_disjoint_timer_query)return null;var Ve=[];function Rt(){return Ve.pop()||Se.ext_disjoint_timer_query.createQueryEXT()}function tr(_r){Ve.push(_r)}var kt=[];function Yt(_r){var Zr=Rt();Se.ext_disjoint_timer_query.beginQueryEXT(j1,Zr),kt.push(Zr),vr(kt.length-1,kt.length,_r)}function sr(){Se.ext_disjoint_timer_query.endQueryEXT(j1)}function mr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Cr=[];function wr(){return Cr.pop()||new mr}function dr(_r){Cr.push(_r)}var xr=[];function vr(_r,Zr,or){var Fr=wr();Fr.startQueryIndex=_r,Fr.endQueryIndex=Zr,Fr.sum=0,Fr.stats=or,xr.push(Fr)}var Er=[],_t=[];function Gt(){var _r,Zr,or=kt.length;if(or!==0){_t.length=Math.max(_t.length,or+1),Er.length=Math.max(Er.length,or+1),Er[0]=0,_t[0]=0;var Fr=0;for(_r=0,Zr=0;Zr<kt.length;++Zr){var Hr=kt[Zr];Se.ext_disjoint_timer_query.getQueryObjectEXT(Hr,H1)?(Fr+=Se.ext_disjoint_timer_query.getQueryObjectEXT(Hr,G1),tr(Hr)):kt[_r++]=Hr,Er[Zr+1]=Fr,_t[Zr+1]=_r}for(kt.length=_r,_r=0,Zr=0;Zr<xr.length;++Zr){var xn=xr[Zr],Jt=xn.startQueryIndex,qt=xn.endQueryIndex;xn.sum+=Er[qt]-Er[Jt];var jr=_t[Jt],Ur=_t[qt];Ur===jr?(xn.stats.gpuTime+=xn.sum/1e6,dr(xn)):(xn.startQueryIndex=jr,xn.endQueryIndex=Ur,xr[_r++]=xn)}xr.length=_r}}return{beginQuery:Yt,endQuery:sr,pushScopeStats:vr,update:Gt,getNumPendingQueries:function(){return kt.length},clear:function(){Ve.push.apply(Ve,kt);for(var _r=0;_r<Ve.length;_r++)Se.ext_disjoint_timer_query.deleteQueryEXT(Ve[_r]);kt.length=0,Ve.length=0},restore:function(){kt.length=0,Ve.length=0}}},Vh=16384,j_=256,W_=1024,Lv=34962,Ag="webglcontextlost",bd="webglcontextrestored",yi=1,ja=2,Yy=3;function Rl(Z,Se){for(var Ve=0;Ve<Z.length;++Ve)if(Z[Ve]===Se)return Ve;return-1}function Tg(Z){var Se=ue(Z);if(!Se)return null;var Ve=Se.gl,Rt=Ve.getContextAttributes(),tr=Ve.isContextLost(),kt=fe(Ve,Se);if(!kt)return null;var Yt=Gl(),sr=V1(),mr=kt.extensions,Cr=yw(Ve,mr),wr=gf(),dr=Ve.drawingBufferWidth,xr=Ve.drawingBufferHeight,vr={tick:0,time:0,viewportWidth:dr,viewportHeight:xr,framebufferWidth:dr,framebufferHeight:xr,drawingBufferWidth:dr,drawingBufferHeight:xr,pixelRatio:Se.pixelRatio},Er={},_t={elements:null,primitive:4,count:-1,offset:0,instances:-1},Gt=he(Ve,mr),_r=Ch(Ve,sr,Se,Fr),Zr=ag(Ve,mr,_r,sr),or=Qe(Ve,mr,Gt,sr,_r,Zr,_t);function Fr(Kn){return or.destroyBuffer(Kn)}var Hr=Wt(Ve,Yt,sr,Se),xn=Fh(Ve,mr,Gt,function(){jr.procs.poll()},vr,sr,Se),Jt=Es(Ve,mr,Gt,sr,Se),qt=xe(Ve,mr,Gt,xn,Jt,sr),jr=H_(Ve,Yt,mr,Gt,_r,Zr,xn,qt,Er,or,Hr,_t,vr,Cr,Se),Ur=An(Ve,qt,jr.procs.poll,vr,Rt,mr,Gt),br=jr.next,qr=Ve.canvas,Qr=[],li=[],ii=[],sn=[Se.onDestroy],ln=null;function Xn(){if(Qr.length===0){Cr&&Cr.update(),ln=null;return}ln=xl.next(Xn),cs();for(var Kn=Qr.length-1;Kn>=0;--Kn){var Gi=Qr[Kn];Gi&&Gi(vr,null,0)}Ve.flush(),Cr&&Cr.update()}function fi(){!ln&&Qr.length>0&&(ln=xl.next(Xn))}function _i(){ln&&(xl.cancel(Xn),ln=null)}function Ka(Kn){Kn.preventDefault(),tr=!0,_i(),li.forEach(function(Gi){Gi()})}function gs(Kn){Ve.getError(),tr=!1,kt.restore(),Hr.restore(),_r.restore(),xn.restore(),Jt.restore(),qt.restore(),or.restore(),Cr&&Cr.restore(),jr.procs.refresh(),fi(),ii.forEach(function(Gi){Gi()})}var Vi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!Vi&&qr&&(qr.addEventListener(Ag,Ka,!1),qr.addEventListener(bd,gs,!1));function Au(){Qr.length=0,_i(),!Vi&&qr&&(qr.removeEventListener(Ag,Ka),qr.removeEventListener(bd,gs)),Hr.clear(),qt.clear(),Jt.clear(),or.clear(),xn.clear(),Zr.clear(),_r.clear(),Cr&&Cr.clear(),sn.forEach(function(Kn){Kn()})}function Co(Kn){ne(!!Kn,"invalid args to regl({...})"),ne.type(Kn,"object","invalid args to regl({...})");function Gi(at){var Je=i({},at);delete Je.uniforms,delete Je.attributes,delete Je.context,delete Je.vao,"stencil"in Je&&Je.stencil.op&&(Je.stencil.opBack=Je.stencil.opFront=Je.stencil.op,delete Je.stencil.op);function ht(ye){if(ye in Je){var qe=Je[ye];delete Je[ye],Object.keys(qe).forEach(function(Pe){Je[ye+"."+Pe]=qe[Pe]})}}return ht("blend"),ht("depth"),ht("cull"),ht("stencil"),ht("polygonOffset"),ht("scissor"),ht("sample"),"vao"in at&&(Je.vao=at.vao),Je}function io(at,Je){var ht={},ye={};return Object.keys(at).forEach(function(qe){var Pe=at[qe];if(Fo.isDynamic(Pe)){ye[qe]=Fo.unbox(Pe,qe);return}else if(Je&&Array.isArray(Pe)){for(var vt=0;vt<Pe.length;++vt)if(Fo.isDynamic(Pe[vt])){ye[qe]=Fo.unbox(Pe,qe);return}}ht[qe]=Pe}),{dynamic:ye,static:ht}}var Qs=io(Kn.context||{},!0),_c=io(Kn.uniforms||{},!0),Fe=io(Kn.attributes||{},!1),Ft=io(Gi(Kn),!1),Ct={gpuTime:0,cpuTime:0,count:0},vn=jr.compile(Ft,Fe,_c,Qs,Ct),Wi=vn.draw,ke=vn.batch,ge=vn.scope,Ye=[];function yt(at){for(;Ye.length<at;)Ye.push(null);return Ye}function Ot(at,Je){var ht;if(tr&&ne.raise("context lost"),typeof at=="function")return ge.call(this,null,at,0);if(typeof Je=="function")if(typeof at=="number")for(ht=0;ht<at;++ht)ge.call(this,null,Je,ht);else if(Array.isArray(at))for(ht=0;ht<at.length;++ht)ge.call(this,at[ht],Je,ht);else return ge.call(this,at,Je,0);else if(typeof at=="number"){if(at>0)return ke.call(this,yt(at|0),at|0)}else if(Array.isArray(at)){if(at.length)return ke.call(this,at,at.length)}else return Wi.call(this,at)}return i(Ot,{stats:Ct,destroy:function(){vn.destroy()}})}var qs=qt.setFBO=Co({framebuffer:Fo.define.call(null,yi,"framebuffer")});function zs(Kn,Gi){var io=0;jr.procs.poll();var Qs=Gi.color;Qs&&(Ve.clearColor(+Qs[0]||0,+Qs[1]||0,+Qs[2]||0,+Qs[3]||0),io|=Vh),"depth"in Gi&&(Ve.clearDepth(+Gi.depth),io|=j_),"stencil"in Gi&&(Ve.clearStencil(Gi.stencil|0),io|=W_),ne(!!io,"called regl.clear with no buffer specified"),Ve.clear(io)}function Tu(Kn){if(ne(typeof Kn=="object"&&Kn,"regl.clear() takes an object as input"),"framebuffer"in Kn)if(Kn.framebuffer&&Kn.framebuffer_reglType==="framebufferCube")for(var Gi=0;Gi<6;++Gi)qs(i({framebuffer:Kn.framebuffer.faces[Gi]},Kn),zs);else qs(Kn,zs);else zs(null,Kn)}function Mu(Kn){ne.type(Kn,"function","regl.frame() callback must be a function"),Qr.push(Kn);function Gi(){var io=Rl(Qr,Kn);ne(io>=0,"cannot cancel a frame twice");function Qs(){var _c=Rl(Qr,Qs);Qr[_c]=Qr[Qr.length-1],Qr.length-=1,Qr.length<=0&&_i()}Qr[io]=Qs}return fi(),{cancel:Gi}}function Nu(){var Kn=br.viewport,Gi=br.scissor_box;Kn[0]=Kn[1]=Gi[0]=Gi[1]=0,vr.viewportWidth=vr.framebufferWidth=vr.drawingBufferWidth=Kn[2]=Gi[2]=Ve.drawingBufferWidth,vr.viewportHeight=vr.framebufferHeight=vr.drawingBufferHeight=Kn[3]=Gi[3]=Ve.drawingBufferHeight}function cs(){vr.tick+=1,vr.time=Ks(),Nu(),jr.procs.poll()}function ki(){xn.refresh(),Nu(),jr.procs.refresh(),Cr&&Cr.update()}function Ks(){return(gf()-wr)/1e3}ki();function Ea(Kn,Gi){ne.type(Gi,"function","listener callback must be a function");var io;switch(Kn){case"frame":return Mu(Gi);case"lost":io=li;break;case"restore":io=ii;break;case"destroy":io=sn;break;default:ne.raise("invalid event, must be one of frame,lost,restore,destroy")}return io.push(Gi),{cancel:function(){for(var Qs=0;Qs<io.length;++Qs)if(io[Qs]===Gi){io[Qs]=io[io.length-1],io.pop();return}}}}var Ts=i(Co,{clear:Tu,prop:Fo.define.bind(null,yi),context:Fo.define.bind(null,ja),this:Fo.define.bind(null,Yy),draw:Co({}),buffer:function(Kn){return _r.create(Kn,Lv,!1,!1)},elements:function(Kn){return Zr.create(Kn,!1)},texture:xn.create2D,cube:xn.createCube,renderbuffer:Jt.create,framebuffer:qt.create,framebufferCube:qt.createCube,vao:or.createVAO,attributes:Rt,frame:Mu,on:Ea,limits:Gt,hasExtension:function(Kn){return Gt.extensions.indexOf(Kn.toLowerCase())>=0},read:Ur,destroy:Au,_gl:Ve,_refresh:ki,poll:function(){cs(),Cr&&Cr.update()},now:Ks,stats:sr});return Se.onDone(null,Ts),Ts}return Tg})})(zae);var hnt=zae.exports,pnt=function(){function e(r,t){st(this,e);var n=t.buffer,i=t.offset,a=t.stride,o=t.normalized,s=t.size,u=t.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:i||0,stride:a||0,normalized:o||!1,divisor:u||0},s&&(this.attribute.size=s)}return ot(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),jm,nC,Wm,kd,iC,m0,aC,NT,Og,vx,of,Fg,Dg,zT,dnt=(jm={},X(jm,K.POINTS,"points"),X(jm,K.LINES,"lines"),X(jm,K.LINE_LOOP,"line loop"),X(jm,K.LINE_STRIP,"line strip"),X(jm,K.TRIANGLES,"triangles"),X(jm,K.TRIANGLE_FAN,"triangle fan"),X(jm,K.TRIANGLE_STRIP,"triangle strip"),jm),goe=(nC={},X(nC,K.STATIC_DRAW,"static"),X(nC,K.DYNAMIC_DRAW,"dynamic"),X(nC,K.STREAM_DRAW,"stream"),nC),D6=(Wm={},X(Wm,K.BYTE,"int8"),X(Wm,K.UNSIGNED_INT,"int16"),X(Wm,K.INT,"int32"),X(Wm,K.UNSIGNED_BYTE,"uint8"),X(Wm,K.UNSIGNED_SHORT,"uint16"),X(Wm,K.UNSIGNED_INT,"uint32"),X(Wm,K.FLOAT,"float"),Wm),vnt=(kd={},X(kd,K.ALPHA,"alpha"),X(kd,K.LUMINANCE,"luminance"),X(kd,K.LUMINANCE_ALPHA,"luminance alpha"),X(kd,K.RGB,"rgb"),X(kd,K.RGBA,"rgba"),X(kd,K.RGBA4,"rgba4"),X(kd,K.RGB5_A1,"rgb5 a1"),X(kd,K.RGB565,"rgb565"),X(kd,K.DEPTH_COMPONENT,"depth"),X(kd,K.DEPTH_STENCIL,"depth stencil"),kd),gnt=(iC={},X(iC,K.DONT_CARE,"dont care"),X(iC,K.NICEST,"nice"),X(iC,K.FASTEST,"fast"),iC),_X=(m0={},X(m0,K.NEAREST,"nearest"),X(m0,K.LINEAR,"linear"),X(m0,K.LINEAR_MIPMAP_LINEAR,"mipmap"),X(m0,K.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),X(m0,K.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),X(m0,K.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),m0),xX=(aC={},X(aC,K.REPEAT,"repeat"),X(aC,K.CLAMP_TO_EDGE,"clamp"),X(aC,K.MIRRORED_REPEAT,"mirror"),aC),mnt=(NT={},X(NT,K.NONE,"none"),X(NT,K.BROWSER_DEFAULT_WEBGL,"browser"),NT),ynt=(Og={},X(Og,K.NEVER,"never"),X(Og,K.ALWAYS,"always"),X(Og,K.LESS,"less"),X(Og,K.LEQUAL,"lequal"),X(Og,K.GREATER,"greater"),X(Og,K.GEQUAL,"gequal"),X(Og,K.EQUAL,"equal"),X(Og,K.NOTEQUAL,"notequal"),Og),bX=(vx={},X(vx,K.FUNC_ADD,"add"),X(vx,K.MIN_EXT,"min"),X(vx,K.MAX_EXT,"max"),X(vx,K.FUNC_SUBTRACT,"subtract"),X(vx,K.FUNC_REVERSE_SUBTRACT,"reverse subtract"),vx),$T=(of={},X(of,K.ZERO,"zero"),X(of,K.ONE,"one"),X(of,K.SRC_COLOR,"src color"),X(of,K.ONE_MINUS_SRC_COLOR,"one minus src color"),X(of,K.SRC_ALPHA,"src alpha"),X(of,K.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),X(of,K.DST_COLOR,"dst color"),X(of,K.ONE_MINUS_DST_COLOR,"one minus dst color"),X(of,K.DST_ALPHA,"dst alpha"),X(of,K.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),X(of,K.CONSTANT_COLOR,"constant color"),X(of,K.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),X(of,K.CONSTANT_ALPHA,"constant alpha"),X(of,K.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),X(of,K.SRC_ALPHA_SATURATE,"src alpha saturate"),of),_nt=(Fg={},X(Fg,K.NEVER,"never"),X(Fg,K.ALWAYS,"always"),X(Fg,K.LESS,"less"),X(Fg,K.LEQUAL,"lequal"),X(Fg,K.GREATER,"greater"),X(Fg,K.GEQUAL,"gequal"),X(Fg,K.EQUAL,"equal"),X(Fg,K.NOTEQUAL,"notequal"),Fg),Lb=(Dg={},X(Dg,K.ZERO,"zero"),X(Dg,K.KEEP,"keep"),X(Dg,K.REPLACE,"replace"),X(Dg,K.INVERT,"invert"),X(Dg,K.INCR,"increment"),X(Dg,K.DECR,"decrement"),X(Dg,K.INCR_WRAP,"increment wrap"),X(Dg,K.DECR_WRAP,"decrement wrap"),Dg),xnt=(zT={},X(zT,K.FRONT,"front"),X(zT,K.BACK,"back"),zT),bnt=function(){function e(r,t){st(this,e);var n=t.data,i=t.usage,a=t.type;this.buffer=r.buffer({data:n,usage:goe[i||K.STATIC_DRAW],type:D6[a||K.UNSIGNED_BYTE]})}return ot(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var n=t.data,i=t.offset;this.buffer.subdata(n,i)}}]),e}(),wnt=function(){function e(r,t){st(this,e);var n=t.data,i=t.usage,a=t.type,o=t.count;this.elements=r.elements({data:n,usage:goe[i||K.STATIC_DRAW],type:D6[a||K.UNSIGNED_BYTE],count:o})}return ot(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var n=t.data;this.elements.subdata(n)}},{key:"destroy",value:function(){}}]),e}(),Cnt=function(){function e(r,t){st(this,e);var n=t.width,i=t.height,a=t.color,o=t.colors,s={width:n,height:i};Array.isArray(o)&&(s.colors=o.map(function(u){return u.get()})),a&&typeof a!="boolean"&&(s.color=a.get()),this.framebuffer=r.framebuffer(s)}return ot(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.framebuffer.resize(n,i)}}]),e}(),Ent=function(){function e(r,t){st(this,e),X(this,"destroyed",!1),X(this,"uniforms",{}),this.reGl=r;var n=t.pick,i=n===void 0?!0:n,a=t.vs,o=t.fs,s=t.attributes,u=t.uniforms,l=t.primitive,f=t.count,h=t.elements,p=t.depth,v=t.blend,m=t.stencil,x=t.cull,E=t.instances,A={};this.options=t,u&&(this.uniforms=this.extractUniforms(u),Object.keys(u).forEach(function(D){A[D]=r.prop(D)}));var L={};Object.keys(s).forEach(function(D){L[D]=s[D].get()});var k={attributes:L,frag:o,uniforms:A,vert:a,blend:{},primitive:dnt[l===void 0?K.TRIANGLES:l]};if(E&&(k.instances=E),f?k.count=f:h&&(k.elements=h.get()),this.initDepthDrawParams({depth:p},k),this.initBlendDrawParams({blend:v},k),this.initStencilDrawParams({stencil:m},k),this.initCullDrawParams({cull:x},k),this.drawCommand=r(k),i){var R=Kt.exports.cloneDeep(k);R.blend=Et(Et({},R.blend),{},{enable:!1}),this.drawPickCommand=r(R)}this.drawParams=k}return ot(e,[{key:"updateAttributesAndElements",value:function(t,n){var i={};if(Object.keys(t).forEach(function(o){i[o]=t[o].get()}),this.drawParams.attributes=i,this.drawParams.elements=n.get(),this.drawCommand=this.reGl(this.drawParams),this.options.pick){var a=Kt.exports.cloneDeep(this.drawParams);a.blend=Et(Et({},a.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(a)}}},{key:"updateAttributes",value:function(t){var n={};if(Object.keys(t).forEach(function(a){n[a]=t[a].get()}),this.drawParams.attributes=n,this.drawCommand=this.reGl(this.drawParams),this.options.pick){var i=Kt.exports.cloneDeep(this.drawParams);i.blend=Et(Et({},i.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(i)}}},{key:"addUniforms",value:function(t){this.uniforms=Et(Et({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t,n){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var i=Et(Et({},this.uniforms),this.extractUniforms(t.uniforms||{})),a={};Object.keys(i).forEach(function(o){var s=em(i[o]);s==="boolean"||s==="number"||Array.isArray(i[o])||i[o].BYTES_PER_ELEMENT?a[o]=i[o]:a[o]=i[o].get()}),n?this.drawPickCommand&&this.drawPickCommand(a):this.drawCommand(a)}}},{key:"destroy",value:function(){var t,n;(t=this.drawParams)===null||t===void 0||(n=t.elements)===null||n===void 0||n.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(i){i==null||i.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,n){var i=t.depth;i&&(n.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:ynt[i.func||K.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,n){var i=t.blend;if(i){var a=i.enable,o=i.func,s=i.equation,u=i.color,l=u===void 0?[0,0,0,0]:u;n.blend={enable:!!a,func:{srcRGB:$T[o&&o.srcRGB||K.SRC_ALPHA],srcAlpha:$T[o&&o.srcAlpha||K.SRC_ALPHA],dstRGB:$T[o&&o.dstRGB||K.ONE_MINUS_SRC_ALPHA],dstAlpha:$T[o&&o.dstAlpha||K.ONE_MINUS_SRC_ALPHA]},equation:{rgb:bX[s&&s.rgb||K.FUNC_ADD],alpha:bX[s&&s.alpha||K.FUNC_ADD]},color:l}}}},{key:"initStencilDrawParams",value:function(t,n){var i=t.stencil;if(i){var a=i.enable,o=i.mask,s=o===void 0?-1:o,u=i.func,l=u===void 0?{cmp:K.ALWAYS,ref:0,mask:-1}:u,f=i.opFront,h=f===void 0?{fail:K.KEEP,zfail:K.KEEP,zpass:K.KEEP}:f,p=i.opBack,v=p===void 0?{fail:K.KEEP,zfail:K.KEEP,zpass:K.KEEP}:p;n.stencil={enable:!!a,mask:s,func:Et(Et({},l),{},{cmp:_nt[l.cmp]}),opFront:{fail:Lb[h.fail],zfail:Lb[h.zfail],zpass:Lb[h.zpass]},opBack:{fail:Lb[v.fail],zfail:Lb[v.zfail],zpass:Lb[v.zpass]}}}}},{key:"initCullDrawParams",value:function(t,n){var i=t.cull;if(i){var a=i.enable,o=i.face,s=o===void 0?K.BACK:o;n.cull={enable:!!a,face:xnt[s]}}}},{key:"extractUniforms",value:function(t){var n=this,i={};return Object.keys(t).forEach(function(a){n.extractUniformsRecursively(a,t[a],i,"")}),i}},{key:"extractUniformsRecursively",value:function(t,n,i,a){var o=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||Kt.exports.isTypedArray(n)||n===""||"resize"in n){i["".concat(a&&a+".").concat(t)]=n;return}Kt.exports.isPlainObject(n)&&Object.keys(n).forEach(function(s){o.extractUniformsRecursively(s,n[s],i,"".concat(a&&a+".").concat(t))}),Array.isArray(n)&&n.forEach(function(s,u){Object.keys(s).forEach(function(l){o.extractUniformsRecursively(l,s[l],i,"".concat(a&&a+".").concat(t,"[").concat(u,"]"))})})}}]),e}(),Snt=function(){function e(r,t){st(this,e),X(this,"isDistroy",!1);var n=t.data,i=t.type,a=i===void 0?K.UNSIGNED_BYTE:i,o=t.width,s=t.height,u=t.flipY,l=u===void 0?!1:u,f=t.format,h=f===void 0?K.RGBA:f,p=t.mipmap,v=p===void 0?!1:p,m=t.wrapS,x=m===void 0?K.CLAMP_TO_EDGE:m,E=t.wrapT,A=E===void 0?K.CLAMP_TO_EDGE:E,L=t.aniso,k=L===void 0?0:L,R=t.alignment,D=R===void 0?1:R,$=t.premultiplyAlpha,j=$===void 0?!1:$,H=t.mag,ee=H===void 0?K.NEAREST:H,U=t.min,W=U===void 0?K.NEAREST:U,Q=t.colorSpace,te=Q===void 0?K.BROWSER_DEFAULT_WEBGL:Q,ie=t.x,ve=ie===void 0?0:ie,me=t.y,Re=me===void 0?0:me,We=t.copy,je=We===void 0?!1:We;this.width=o,this.height=s;var lt={width:o,height:s,type:D6[a],format:vnt[h],wrapS:xX[x],wrapT:xX[A],mag:_X[ee],min:_X[W],alignment:D,flipY:l,colorSpace:mnt[te],premultiplyAlpha:j,aniso:k,x:ve,y:Re,copy:je};n&&(lt.data=n),typeof v=="number"?lt.mipmap=gnt[v]:typeof v=="boolean"&&(lt.mipmap=v),this.texture=r.texture(lt)}return ot(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(t)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.texture.resize(n,i),this.width=n,this.height=i}},{key:"destroy",value:function(){if(!this.isDistroy){var t;(t=this.texture)===null||t===void 0||t.destroy()}this.isDistroy=!0}}]),e}(),wX,CX,Ant=(wX=Ri(),wX(CX=function(){function e(){var r=this;st(this,e),X(this,"createModel",function(t){return new Ent(r.gl,t)}),X(this,"createAttribute",function(t){return new pnt(r.gl,t)}),X(this,"createBuffer",function(t){return new bnt(r.gl,t)}),X(this,"createElements",function(t){return new wnt(r.gl,t)}),X(this,"createTexture2D",function(t){return new Snt(r.gl,t)}),X(this,"createFramebuffer",function(t){return new Cnt(r.gl,t)}),X(this,"useFramebuffer",function(t,n){r.gl({framebuffer:t?t.get():null})(n)}),X(this,"clear",function(t){var n,i=t.color,a=t.depth,o=t.stencil,s=t.framebuffer,u=s===void 0?null:s,l={color:i,depth:a,stencil:o};l.framebuffer=u===null?u:u.get(),(n=r.gl)===null||n===void 0||n.clear(l)}),X(this,"viewport",function(t){var n=t.x,i=t.y,a=t.width,o=t.height;r.gl._gl.viewport(n,i,a,o),r.width=a,r.height=o,r.gl._refresh()}),X(this,"readPixels",function(t){var n=t.framebuffer,i=t.x,a=t.y,o=t.width,s=t.height,u={x:i,y:a,width:o,height:s};return n&&(u.framebuffer=n.get()),r.gl.read(u)}),X(this,"getViewportSize",function(){return{width:r.gl._gl.drawingBufferWidth,height:r.gl._gl.drawingBufferHeight}}),X(this,"getContainer",function(){if(ns)return r.canvas;var t;return(t=r.canvas)===null||t===void 0?void 0:t.parentElement}),X(this,"getCanvas",function(){return r.canvas}),X(this,"getGLContext",function(){return r.gl._gl}),X(this,"destroy",function(){var t,n,i;r.canvas=null,(t=r.gl)===null||t===void 0||(n=t._gl)===null||n===void 0||(i=n.getExtension("WEBGL_lose_context"))===null||i===void 0||i.loseContext(),r.gl.destroy(),r.gl=null})}return ot(e,[{key:"init",value:function(){var r=Hi(Xr.mark(function n(i,a,o){var s=this;return Xr.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.canvas=i,!o){l.next=5;break}this.gl=o,l.next=8;break;case 5:return l.next=7,new Promise(function(f,h){hnt({canvas:s.canvas,attributes:{alpha:!0,antialias:a.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:a.preserveDrawingBuffer,stencil:a.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(v,m){(v||!m)&&h(v),f(m)}})});case 7:this.gl=l.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return l.stop()}},n,this)}));function t(n,i,a){return r.apply(this,arguments)}return t}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(t){return!!this.getGLContext().getExtension(t)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||CX),Tnt=function(){function e(r){st(this,e);var t=r.id,n=r.map,i=r.canvas,a=r.hasBaseMap,o=Cne();this.container=o,n.setContainer(o,t,i,a),o.bind(Mt.IRendererService).to(Ant).inSingletonScope(),this.sceneService=o.get(Mt.ISceneService),this.mapService=o.get(Mt.IMapService),this.iconService=o.get(Mt.IIconService),this.fontService=o.get(Mt.IFontService),this.controlService=o.get(Mt.IControlService),this.layerService=o.get(Mt.ILayerService),this.markerService=o.get(Mt.IMarkerService),this.interactionService=o.get(Mt.IInteractionService),this.popupService=o.get(Mt.IPopupService),ns?this.sceneService.initMiniScene(r):(this.initComponent(t),this.sceneService.init(r),this.initControl())}return ot(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(t){return this.sceneService.exportPng(t)}},{key:"exportMap",value:function(t){return this.sceneService.exportPng(t)}},{key:"registerRenderService",value:function(t){var n=this;if(this.sceneService.loaded){var i=new t(this);i.init()}else this.on("loaded",function(){var a=new t(n);a.init()})}},{key:"setBgColor",value:function(t){this.mapService.setBgColor(t)}},{key:"addLayer",value:function(t){var n=this,i=vL(this.container);if(t.setContainer(i,this.container),this.sceneService.addLayer(t),t.inited){var a=this.initMask(t);this.addMask(a,t.id)}else t.on("inited",function(){var o=n.initMask(t);n.addMask(o,t.id)})}},{key:"initMask",value:function(t){var n=t.getLayerConfig(),i=n.mask,a=n.maskfence,o=n.maskColor,s=o===void 0?"#000":o,u=n.maskOpacity,l=u===void 0?0:u;if(!!i){var f=new iae().source(a).shape("fill").style({color:s,opacity:l});return f}}},{key:"addMask",value:function(t,n){if(!!t){var i=this.getLayer(n);if(i){var a=vL(this.container);t.setContainer(a,this.container),i.addMaskLayer(t),this.sceneService.addLayer(t)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(t,n){this.layerService.remove(t,n)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(t){this.layerService.setEnableRender(t)}},{key:"addIconFont",value:function(t,n){this.fontService.addIconFont(t,n)}},{key:"addIconFonts",value:function(t){var n=this;t.forEach(function(i){var a=tn(i,2),o=a[0],s=a[1];n.fontService.addIconFont(o,s)})}},{key:"addFontFace",value:function(t,n){var i=this;this.fontService.once("fontloaded",function(a){i.emit("fontloaded",a)}),this.fontService.addFontFace(t,n)}},{key:"addImage",value:function(t,n){ns?this.iconService.addImageMini(t,n,this.sceneService):this.iconService.addImage(t,n)}},{key:"hasImage",value:function(t){return this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,n){this.fontService.addIconGlyphs(n)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"on",value:function(t,n){TC.indexOf(t)===-1?this.mapService.on(t,n):this.sceneService.on(t,n)}},{key:"once",value:function(t,n){TC.indexOf(t)===-1?this.mapService.once(t,n):this.sceneService.once(t,n)}},{key:"emit",value:function(t,n){TC.indexOf(t)===-1?this.mapService.on(t,n):this.sceneService.emit(t,n)}},{key:"off",value:function(t,n){TC.indexOf(t)===-1?this.mapService.off(t,n):this.sceneService.off(t,n)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(t){return this.mapService.getCenter(t)}},{key:"setCenter",value:function(t,n){return this.mapService.setCenter(t,n)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t,n){this.mapService.panBy(t,n)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,n){var i=this.sceneService.getSceneConfig(),a=i.fitBoundsOptions,o=i.animate;this.mapService.fitBounds(t,n||Et(Et({},a),{},{animate:o}))}},{key:"setZoomAndCenter",value:function(t,n){this.mapService.setZoomAndCenter(t,n)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,n){this.container.bind(Mt.IPostProcessingPass).to(t).whenTargetNamed(n)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(t){this.controlService.init({container:Ere(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),n=t.logoVisible,i=t.logoPosition;n&&this.addControl(new Sne({position:i}))}}]),e}(),Mnt=Object.freeze(Object.defineProperty({__proto__:null,Scene:Tnt},Symbol.toStringTag,{value:"Module"})),Lnt=ed(Mnt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.BlendType=void 0;var r=Ene;Object.defineProperty(e,"BlendType",{enumerable:!0,get:function(){return r.BlendType}})})(Yte);var moe={};Object.defineProperty(moe,"__esModule",{value:!0});var B6={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LayerType=e.LineStyleType=void 0,function(r){r[r.solid=0]="solid",r[r.dash=1]="dash"}(e.LineStyleType||(e.LineStyleType={})),function(r){r.TextLayer="textLayer",r.DotLayer="dotLayer",r.IconLayer="iconLayer",r.DotDensity="dotDensityLayer",r.ColumnLayer="columnLayer",r.HeatmapLayer="heatmapLayer",r.GridLayer="gridLayer",r.HexbinLayer="hexbinLayer",r.LinesLayer="linesLayer",r.PathLayer="pathLayer",r.ArcLayer="arcLayer",r.AreaLayer="areaLayer",r.PrismLayer="prismLayer"}(e.LayerType||(e.LayerType={}))})(B6);var yoe={},_oe=ed(o$e);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.BaseMapType=e.Source=e.MapboxglMap=void 0;var r=mi.exports,t=f6.exports;Object.defineProperty(e,"MapboxglMap",{enumerable:!0,get:function(){return t.Map}});var n=r.__importDefault(_oe);e.Source=n.default,function(i){i.Amap="amap",i.Mapbox="mapbox"}(e.BaseMapType||(e.BaseMapType={}))})(yoe);var xoe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PlotType=void 0,function(r){r.Dot="dot",r.DotDensity="dotDensity",r.Heatmap="heatmap",r.Grid="grid",r.Hexbin="hexbin",r.Path="path",r.Flow="flow",r.Area="area",r.Choropleth="choropleth"}(e.PlotType||(e.PlotType={}))})(xoe);var boe={};Object.defineProperty(boe,"__esModule",{value:!0});var woe={},Int=ed(w6e);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TooltipAnchorType=void 0;var r=Int;Object.defineProperty(e,"TooltipAnchorType",{enumerable:!0,get:function(){return r.anchorType}})})(woe);var Coe={};Object.defineProperty(Coe,"__esModule",{value:!0});var Eoe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PositionType=void 0;var r=Ene;Object.defineProperty(e,"PositionType",{enumerable:!0,get:function(){return r.PositionType}})})(Eoe);var Soe={};Object.defineProperty(Soe,"__esModule",{value:!0});var Aoe={};Object.defineProperty(Aoe,"__esModule",{value:!0});(function(e){Object.defineProperty(e,"__esModule",{value:!0});var r=mi.exports;r.__exportStar(Yte,e),r.__exportStar(moe,e),r.__exportStar(B6,e),r.__exportStar(yoe,e),r.__exportStar(xoe,e),r.__exportStar(boe,e),r.__exportStar(woe,e),r.__exportStar(Coe,e),r.__exportStar(Eoe,e),r.__exportStar(Soe,e),r.__exportStar(Aoe,e)})(w1);var tw={},knt=ed(Sje),N6=ed(tze),zk=ed(Xge),$k={},Pnt="0.0.7",z6={fontFamily:`
  "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`},$6="l7plot-tooltip",U6="l7plot-tooltip__title",V6="l7plot-tooltip__list",Toe="l7plot-tooltip__list-item",Moe="l7plot-tooltip__name",Loe="l7plot-tooltip__value",Rnt='<div class="'.concat($6,`">
  <div class="`).concat(U6,`"></div>
  <ul class="`).concat(V6,`"></ul>
</div>`),EX='<li class="'.concat(Toe,`" data-index={index}>
  <span class="`).concat(Moe,`">{name}</span>
  <span class="`).concat(Loe,`">{value}</span>
</li>`),y0,Ont=(y0={},y0[$6]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:z6.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},y0[U6]={marginBottom:"4px"},y0[V6]={margin:"0px",listStyleType:"none",padding:"0px"},y0[Toe]={listStyleType:"none",marginBottom:"4px",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"},y0[Moe]={},y0[Loe]={marginLeft:"30px"},y0);function Fnt(e,r){return!!e.className.match(new RegExp("(\\s|^)".concat(r,"(\\s|$)")))}function G6(e){for(var r=e.childNodes,t=r.length,n=t-1;n>=0;n--)e.removeChild(r[n])}var H6=function(){function e(r){this.destroyed=!1,this.options=yn({},this.getDefaultOptions(),r),this.container=this.initContainer(),this.initDom(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible(),this.render()}return e.prototype.getDefaultOptions=function(){return{name:"",containerTpl:"<div></div>",visible:!0,capture:!0,domStyles:{}}},e.prototype.getContainer=function(){return this.container},e.prototype.getParentContainer=function(){var r=this.options.parent,t;if(!r)return t;if(ei(r)){var n=document.getElementById(r);if(n)t=n;else throw new Error("No parent id ".concat(r))}else t=r;return t},e.prototype.initContainer=function(){var r=this.createDom(this.options.containerTpl),t=this.getParentContainer();return t&&t.appendChild(r),r},e.prototype.initVisible=function(){this.options.visible?this.show():this.hide()},e.prototype.initCapture=function(){this.setCapture(this.options.capture)},e.prototype.update=function(r){this.options=yn({},this.options,r),this.updateInner(r),this.afterUpdate(r)},e.prototype.updateInner=function(r){r.domStyles&&this.applyStyles()},e.prototype.afterUpdate=function(r){r.capture&&this.setCapture(r.capture)},e.prototype.setCapture=function(r){var t=this.container,n=r?"auto":"none";t.style.pointerEvents=n},e.prototype.applyStyles=function(){var r=this.options.domStyles;if(!!r){var t=this.container;this.applyChildrenStyles(t,r);var n=this.options.className;if(n&&Fnt(t,n)){var i=r[n];es(t,i)}}},e.prototype.applyChildrenStyles=function(r,t){we(t,function(n,i){var a=r.getElementsByClassName(i);we(a,function(o){es(o,n)})})},e.prototype.applyStyle=function(r,t){var n=this.options.domStyles;n&&es(t,n[r])},e.prototype.createDom=function(r){return r===void 0&&(r="<div></div>"),ly(r)},e.prototype.removeDom=function(){var r=this.container;r&&r.parentNode&&r.parentNode.removeChild(r)},e.prototype.destroy=function(){this.removeEvent(),this.removeDom(),this.destroyed=!0},e}(),Dnt=function(e){mi.exports.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultOptions=function(){return yn({},e.prototype.getDefaultOptions.call(this),{id:"l7plot-tooltip",name:"l7plot-tooltip",title:"",showTitle:!0,items:[],containerTpl:Rnt,itemTpl:EX,domStyles:Ont,className:$6})},r.prototype.initContainer=function(){var t=this.options.customContent;if(t){var n=this.getHtmlContentNode(t),i=this.getParentContainer();return i&&i.appendChild(n),n}else return e.prototype.initContainer.call(this)},r.prototype.initDom=function(){this.cacheDoms()},r.prototype.initEvent=function(){},r.prototype.removeEvent=function(){},r.prototype.cacheDoms=function(){var t=this.container,n=t.getElementsByClassName(U6)[0],i=t.getElementsByClassName(V6)[0];this.titleDom=n,this.listDom=i},r.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},r.prototype.show=function(){var t=this.container;!t||this.destroyed||es(t,{visibility:"visible"})},r.prototype.hide=function(){var t=this.container;!t||this.destroyed||es(t,{visibility:"hidden"})},r.prototype.updateInner=function(t){this.options.customContent?this.renderCustomContent(this.options.customContent):(t.title&&this.resetTitle(),t.items&&this.renderItems()),e.prototype.updateInner.call(this,t)},r.prototype.renderCustomContent=function(t){var n=this.container.parentNode,i=this.getHtmlContentNode(t),a=this.container;n&&n.replaceChild(i,a),this.container=i,this.applyStyles()},r.prototype.getHtmlContentNode=function(t){var n,i=t(this.options.title||"",this.options.items);return ei(i)?n=this.createDom(i):n=i,n},r.prototype.resetTitle=function(){var t=this.options.title,n=this.options.showTitle;n&&t?(this.showTitle(),this.setTitle(t)):this.hideTitle()},r.prototype.showTitle=function(){var t=this.titleDom;t&&es(t,{display:"block"})},r.prototype.hideTitle=function(){var t=this.titleDom;t&&es(t,{display:"none"})},r.prototype.setTitle=function(t){var n=this.titleDom;n&&(n.innerHTML=t)},r.prototype.renderItems=function(){var t=this;this.clearItemDoms();var n=this.options.items,i=this.options.itemTpl||EX,a=this.listDom;a&&(n.forEach(function(o){var s=mi.exports.__assign({},o),u=D2(i,s),l=t.createDom(u);a.appendChild(l)}),this.applyChildrenStyles(a,this.options.domStyles))},r.prototype.clearItemDoms=function(){this.listDom&&G6(this.listDom)},r.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},r}(H6),j6="l7plot-legend l7plot-legend__category",W6="l7plot-legend__title",X6="l7plot-legend__category-list",Ioe="l7plot-legend__list-item",koe="l7plot-legend__category-marker",Poe="l7plot-legend__category-value",Bnt='<div class="'.concat(j6,`">
  <div class="`).concat(W6,`"></div>
  <ul class="`).concat(X6,`"></ul>
</div>`),SX='<li class="'.concat(Ioe,`" data-index={index}>
  <span class="`).concat(koe,`" style="background:{color}"></span>
  <span class="`).concat(Poe,`">{value}</span>
</li>`),_0,Nnt=(_0={},_0[j6]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:z6.fontFamily,padding:"10px 10px 6px 10px",lineHeight:1,fontSize:"12px"},_0[W6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},_0[X6]={margin:"0px",listStyleType:"none",padding:"0px"},_0[Ioe]={listStyleType:"none",display:"flex",alignItems:"center",marginBottom:"2px"},_0[koe]={width:"10px",height:"10px"},_0[Poe]={paddingLeft:"8px"},_0),znt=function(e){mi.exports.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultOptions=function(){return yn({},e.prototype.getDefaultOptions.call(this),{id:"l7plot-category-legend",name:"l7plot-category-legend",title:"",items:[],containerTpl:Bnt,itemTpl:SX,domStyles:Nnt,className:j6})},r.prototype.initContainer=function(){var t=this.options.customContent;if(t){var n=this.getHtmlContentNode(t),i=this.getParentContainer();return i&&i.appendChild(n),n}else return e.prototype.initContainer.call(this)},r.prototype.initDom=function(){this.cacheDoms()},r.prototype.initEvent=function(){},r.prototype.removeEvent=function(){},r.prototype.cacheDoms=function(){var t=this.container,n=t.getElementsByClassName(W6)[0],i=t.getElementsByClassName(X6)[0];this.titleDom=n,this.listDom=i},r.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},r.prototype.show=function(){var t=this.container;!t||this.destroyed||es(t,{visibility:"visible"})},r.prototype.hide=function(){var t=this.container;!t||this.destroyed||es(t,{visibility:"hidden"})},r.prototype.updateInner=function(t){this.options.customContent?this.renderCustomContent(this.options.customContent):(t.title&&this.resetTitle(),t.items&&this.renderItems()),e.prototype.updateInner.call(this,t)},r.prototype.renderCustomContent=function(t){var n=this.container.parentNode,i=this.getHtmlContentNode(t),a=this.container;n&&n.replaceChild(i,a),this.container=i,this.applyStyles()},r.prototype.getHtmlContentNode=function(t){var n,i=t(this.options.title||"",this.options.items);return ei(i)?n=this.createDom(i):n=i,n},r.prototype.resetTitle=function(){var t=this.options.title;t?(this.showTitle(),this.setTitle(t)):this.hideTitle()},r.prototype.showTitle=function(){var t=this.titleDom;t&&es(t,{display:"block"})},r.prototype.hideTitle=function(){var t=this.titleDom;t&&es(t,{display:"none"})},r.prototype.setTitle=function(t){var n=this.titleDom;n&&(n.innerHTML=t)},r.prototype.renderItems=function(){var t=this;this.clearItemDoms();var n=this.options.items.length>30?this.options.items.slice(0,30):this.options.items,i=this.options.itemTpl||SX,a=this.listDom;a&&(n.forEach(function(o){var s=o.value==="",u=s?"\u2014":Array.isArray(o.value)?o.value.join(" - "):o.value,l=mi.exports.__assign(mi.exports.__assign({},o),{value:u}),f=D2(i,l),h=t.createDom(f);a.appendChild(h)}),this.applyChildrenStyles(a,this.options.domStyles))},r.prototype.clearItemDoms=function(){this.listDom&&G6(this.listDom)},r.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},r}(H6),Y6="l7plot-legend l7plot-legend__continue",Z6="l7plot-legend__title",Roe="l7plot-legend__ribbon-container",Ooe="l7plot-legend__ribbon",Foe="l7plot-legend__gradient-bar",r3="l7plot-legend__value-range",$nt='<div class="'.concat(Y6,`">
  <div class="`).concat(Z6,`"></div>
  <div class="`).concat(Roe,`"></div>
</div>`),AX='<div class="'.concat(Ooe,`">
  <span class="`).concat(r3,`">{min}</span>
  <div class="`).concat(Foe,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(r3,`">{max}</span>
</div>`),gx,Unt=(gx={},gx[Y6]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:z6.fontFamily,padding:"10px",lineHeight:1,fontSize:"12px"},gx[Z6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},gx[Ooe]={display:"flex",alignItems:"center"},gx[Foe]={width:"140px",height:"14px",margin:"0px 5px"},gx[r3]={padding:"0px"},gx),Vnt=function(e){mi.exports.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.getDefaultOptions=function(){return yn({},e.prototype.getDefaultOptions.call(this),{id:"l7plot-continue-legend",name:"l7plot-continue-legend",title:"",containerTpl:$nt,ribbonTpl:AX,domStyles:Unt,className:Y6})},r.prototype.initContainer=function(){var t=this.options.customContent;if(t){var n=this.getHtmlContentNode(t),i=this.getParentContainer();return i&&i.appendChild(n),n}else return e.prototype.initContainer.call(this)},r.prototype.initDom=function(){this.cacheDoms()},r.prototype.initEvent=function(){},r.prototype.removeEvent=function(){},r.prototype.cacheDoms=function(){var t=this.container,n=t.getElementsByClassName(Z6)[0],i=t.getElementsByClassName(Roe)[0];this.titleDom=n,this.ribbonContainerDom=i},r.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderRibbon())},r.prototype.show=function(){var t=this.container;!t||this.destroyed||es(t,{visibility:"visible"})},r.prototype.hide=function(){var t=this.container;!t||this.destroyed||es(t,{visibility:"hidden"})},r.prototype.updateInner=function(t){this.options.customContent?this.renderCustomContent(this.options.customContent):(t.title&&this.resetTitle(),t.colors&&this.renderRibbon()),e.prototype.updateInner.call(this,t)},r.prototype.renderCustomContent=function(t){var n=this.container.parentNode,i=this.getHtmlContentNode(t),a=this.container;n&&n.replaceChild(i,a),this.container=i,this.applyStyles()},r.prototype.getHtmlContentNode=function(t){var n,i=t(this.options.title||"",this.options.min,this.options.max,this.options.colors);return ei(i)?n=this.createDom(i):n=i,n},r.prototype.resetTitle=function(){var t=this.options.title;t?(this.showTitle(),this.setTitle(t)):this.hideTitle()},r.prototype.showTitle=function(){var t=this.titleDom;t&&es(t,{display:"block"})},r.prototype.hideTitle=function(){var t=this.titleDom;t&&es(t,{display:"none"})},r.prototype.setTitle=function(t){var n=this.titleDom;n&&(n.innerHTML=t)},r.prototype.renderRibbon=function(){this.clearRibbonContainerDoms();var t=this.options,n=t.min,i=t.max,a=t.colors,o=t.ribbonTpl,s=o===void 0?AX:o,u=this.ribbonContainerDom;if(u){var l="linear-gradient(to right, ".concat(a.join(", "),")"),f={min:n,max:i,backgroundImage:l},h=D2(s,f),p=this.createDom(h);u.appendChild(p),this.applyChildrenStyles(u,this.options.domStyles)}},r.prototype.clearRibbonContainerDoms=function(){this.ribbonContainerDom&&G6(this.ribbonContainerDom)},r.prototype.clear=function(){this.setTitle(""),this.clearRibbonContainerDoms()},r}(H6),Gnt=Object.freeze(Object.defineProperty({__proto__:null,version:Pnt,Tooltip:Dnt,CategoryLegend:znt,ContinueLegend:Vnt},Symbol.toStringTag,{value:"Module"})),Doe=ed(Gnt),Hnt=typeof global=="object"&&global&&global.Object===Object&&global,Boe=Hnt,jnt=typeof self=="object"&&self&&self.Object===Object&&self,Wnt=Boe||jnt||Function("return this")(),Oc=Wnt,Xnt=Oc.Symbol,Nf=Xnt,Noe=Object.prototype,Ynt=Noe.hasOwnProperty,Znt=Noe.toString,oC=Nf?Nf.toStringTag:void 0;function qnt(e){var r=Ynt.call(e,oC),t=e[oC];try{e[oC]=void 0;var n=!0}catch{}var i=Znt.call(e);return n&&(r?e[oC]=t:delete e[oC]),i}var Knt=Object.prototype,Qnt=Knt.toString;function Jnt(e){return Qnt.call(e)}var eit="[object Null]",tit="[object Undefined]",TX=Nf?Nf.toStringTag:void 0;function dh(e){return e==null?e===void 0?tit:eit:TX&&TX in Object(e)?qnt(e):Jnt(e)}function ju(e){return e!=null&&typeof e=="object"}var rit="[object Symbol]";function vp(e){return typeof e=="symbol"||ju(e)&&dh(e)==rit}var nit=0/0;function MX(e){return typeof e=="number"?e:vp(e)?nit:+e}function Iu(e,r){for(var t=-1,n=e==null?0:e.length,i=Array(n);++t<n;)i[t]=r(e[t],t,e);return i}var iit=Array.isArray,pa=iit,ait=1/0,LX=Nf?Nf.prototype:void 0,IX=LX?LX.toString:void 0;function qp(e){if(typeof e=="string")return e;if(pa(e))return Iu(e,qp)+"";if(vp(e))return IX?IX.call(e):"";var r=e+"";return r=="0"&&1/e==-ait?"-0":r}function Uk(e,r){return function(t,n){var i;if(t===void 0&&n===void 0)return r;if(t!==void 0&&(i=t),n!==void 0){if(i===void 0)return n;typeof t=="string"||typeof n=="string"?(t=qp(t),n=qp(n)):(t=MX(t),n=MX(n)),i=e(t,n)}return i}}var oit=Uk(function(e,r){return e+r},0),zoe=oit,sit=/\s/;function $oe(e){for(var r=e.length;r--&&sit.test(e.charAt(r)););return r}var uit=/^\s+/;function Uoe(e){return e&&e.slice(0,$oe(e)+1).replace(uit,"")}function yu(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var kX=0/0,lit=/^[-+]0x[0-9a-f]+$/i,cit=/^0b[01]+$/i,fit=/^0o[0-7]+$/i,hit=parseInt;function Zp(e){if(typeof e=="number")return e;if(vp(e))return kX;if(yu(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=yu(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=Uoe(e);var t=cit.test(e);return t||fit.test(e)?hit(e.slice(2),t?2:8):lit.test(e)?kX:+e}var PX=1/0,pit=17976931348623157e292;function Zg(e){if(!e)return e===0?e:0;if(e=Zp(e),e===PX||e===-PX){var r=e<0?-1:1;return r*pit}return e===e?e:0}function wa(e){var r=Zg(e),t=r%1;return r===r?t?r-t:r:0}var dit="Expected a function";function Voe(e,r){if(typeof r!="function")throw new TypeError(dit);return e=wa(e),function(){if(--e<1)return r.apply(this,arguments)}}function Uf(e){return e}var vit="[object AsyncFunction]",git="[object Function]",mit="[object GeneratorFunction]",yit="[object Proxy]";function sm(e){if(!yu(e))return!1;var r=dh(e);return r==git||r==mit||r==vit||r==yit}var _it=Oc["__core-js_shared__"],SM=_it,RX=function(){var e=/[^.]+$/.exec(SM&&SM.keys&&SM.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function xit(e){return!!RX&&RX in e}var bit=Function.prototype,wit=bit.toString;function P1(e){if(e!=null){try{return wit.call(e)}catch{}try{return e+""}catch{}}return""}var Cit=/[\\^$.*+?()[\]{}|]/g,Eit=/^\[object .+?Constructor\]$/,Sit=Function.prototype,Ait=Object.prototype,Tit=Sit.toString,Mit=Ait.hasOwnProperty,Lit=RegExp("^"+Tit.call(Mit).replace(Cit,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Goe(e){if(!yu(e)||xit(e))return!1;var r=sm(e)?Lit:Eit;return r.test(P1(e))}function Iit(e,r){return e==null?void 0:e[r]}function R1(e,r){var t=Iit(e,r);return Goe(t)?t:void 0}var kit=R1(Oc,"WeakMap"),rS=kit,Pit=rS&&new rS,DL=Pit,Rit=DL?function(e,r){return DL.set(e,r),e}:Uf,Hoe=Rit,OX=Object.create,Oit=function(){function e(){}return function(r){if(!yu(r))return{};if(OX)return OX(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),rw=Oit;function nS(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var t=rw(e.prototype),n=e.apply(t,r);return yu(n)?n:t}}var Fit=1;function Dit(e,r,t){var n=r&Fit,i=nS(e);function a(){var o=this&&this!==Oc&&this instanceof a?i:e;return o.apply(n?t:this,arguments)}return a}function Kp(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}var Bit=Math.max;function joe(e,r,t,n){for(var i=-1,a=e.length,o=t.length,s=-1,u=r.length,l=Bit(a-o,0),f=Array(u+l),h=!n;++s<u;)f[s]=r[s];for(;++i<o;)(h||i<a)&&(f[t[i]]=e[i]);for(;l--;)f[s++]=e[i++];return f}var Nit=Math.max;function Woe(e,r,t,n){for(var i=-1,a=e.length,o=-1,s=t.length,u=-1,l=r.length,f=Nit(a-s,0),h=Array(f+l),p=!n;++i<f;)h[i]=e[i];for(var v=i;++u<l;)h[v+u]=r[u];for(;++o<s;)(p||i<a)&&(h[v+t[o]]=e[i++]);return h}function zit(e,r){for(var t=e.length,n=0;t--;)e[t]===r&&++n;return n}function Vk(){}var $it=4294967295;function uo(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=$it,this.__views__=[]}uo.prototype=rw(Vk.prototype);uo.prototype.constructor=uo;function Gk(){}var Uit=DL?function(e){return DL.get(e)}:Gk,q6=Uit,Vit={},a2=Vit,Git=Object.prototype,Hit=Git.hasOwnProperty;function AM(e){for(var r=e.name+"",t=a2[r],n=Hit.call(a2,r)?t.length:0;n--;){var i=t[n],a=i.func;if(a==null||a==e)return i.name}return r}function Wd(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=void 0}Wd.prototype=rw(Vk.prototype);Wd.prototype.constructor=Wd;function fp(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}function Xoe(e){if(e instanceof uo)return e.clone();var r=new Wd(e.__wrapped__,e.__chain__);return r.__actions__=fp(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}var jit=Object.prototype,Wit=jit.hasOwnProperty;function Ae(e){if(ju(e)&&!pa(e)&&!(e instanceof uo)){if(e instanceof Wd)return e;if(Wit.call(e,"__wrapped__"))return Xoe(e)}return new Wd(e)}Ae.prototype=Vk.prototype;Ae.prototype.constructor=Ae;function n3(e){var r=AM(e),t=Ae[r];if(typeof t!="function"||!(r in uo.prototype))return!1;if(e===t)return!0;var n=q6(t);return!!n&&e===n[0]}var Xit=800,Yit=16,Zit=Date.now;function Yoe(e){var r=0,t=0;return function(){var n=Zit(),i=Yit-(n-t);if(t=n,i>0){if(++r>=Xit)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}var qit=Yoe(Hoe),Zoe=qit,Kit=/\{\n\/\* \[wrapped with (.+)\] \*/,Qit=/,? & /;function Jit(e){var r=e.match(Kit);return r?r[1].split(Qit):[]}var eat=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function tat(e,r){var t=r.length;if(!t)return e;var n=t-1;return r[n]=(t>1?"& ":"")+r[n],r=r.join(t>2?", ":" "),e.replace(eat,`{
/* [wrapped with `+r+`] */
`)}function Hk(e){return function(){return e}}var rat=function(){try{var e=R1(Object,"defineProperty");return e({},"",{}),e}catch{}}(),BL=rat,nat=BL?function(e,r){return BL(e,"toString",{configurable:!0,enumerable:!1,value:Hk(r),writable:!0})}:Uf,iat=nat,aat=Yoe(iat),K6=aat;function tv(e,r){for(var t=-1,n=e==null?0:e.length;++t<n&&r(e[t],t,e)!==!1;);return e}function jk(e,r,t,n){for(var i=e.length,a=t+(n?1:-1);n?a--:++a<i;)if(r(e[a],a,e))return a;return-1}function qoe(e){return e!==e}function oat(e,r,t){for(var n=t-1,i=e.length;++n<i;)if(e[n]===r)return n;return-1}function nw(e,r,t){return r===r?oat(e,r,t):jk(e,qoe,t)}function Wk(e,r){var t=e==null?0:e.length;return!!t&&nw(e,r,0)>-1}var sat=1,uat=2,lat=8,cat=16,fat=32,hat=64,pat=128,dat=256,vat=512,gat=[["ary",pat],["bind",sat],["bindKey",uat],["curry",lat],["curryRight",cat],["flip",vat],["partial",fat],["partialRight",hat],["rearg",dat]];function mat(e,r){return tv(gat,function(t){var n="_."+t[0];r&t[1]&&!Wk(e,n)&&e.push(n)}),e.sort()}function Koe(e,r,t){var n=r+"";return K6(e,tat(n,mat(Jit(n),t)))}var yat=1,_at=2,xat=4,bat=8,FX=32,DX=64;function Qoe(e,r,t,n,i,a,o,s,u,l){var f=r&bat,h=f?o:void 0,p=f?void 0:o,v=f?a:void 0,m=f?void 0:a;r|=f?FX:DX,r&=~(f?DX:FX),r&xat||(r&=~(yat|_at));var x=[e,r,i,v,h,m,p,s,u,l],E=t.apply(void 0,x);return n3(e)&&Zoe(E,x),E.placeholder=n,Koe(E,e,r)}function iw(e){var r=e;return r.placeholder}var wat=9007199254740991,Cat=/^(?:0|[1-9]\d*)$/;function Ry(e,r){var t=typeof e;return r=r==null?wat:r,!!r&&(t=="number"||t!="symbol"&&Cat.test(e))&&e>-1&&e%1==0&&e<r}var Eat=Math.min;function Sat(e,r){for(var t=e.length,n=Eat(r.length,t),i=fp(e);n--;){var a=r[n];e[n]=Ry(a,t)?i[a]:void 0}return e}var BX="__lodash_placeholder__";function f_(e,r){for(var t=-1,n=e.length,i=0,a=[];++t<n;){var o=e[t];(o===r||o===BX)&&(e[t]=BX,a[i++]=t)}return a}var Aat=1,Tat=2,Mat=8,Lat=16,Iat=128,kat=512;function Xk(e,r,t,n,i,a,o,s,u,l){var f=r&Iat,h=r&Aat,p=r&Tat,v=r&(Mat|Lat),m=r&kat,x=p?void 0:nS(e);function E(){for(var A=arguments.length,L=Array(A),k=A;k--;)L[k]=arguments[k];if(v)var R=iw(E),D=zit(L,R);if(n&&(L=joe(L,n,i,v)),a&&(L=Woe(L,a,o,v)),A-=D,v&&A<l){var $=f_(L,R);return Qoe(e,r,Xk,E.placeholder,t,L,$,s,u,l-A)}var j=h?t:this,H=p?j[e]:e;return A=L.length,s?L=Sat(L,s):m&&A>1&&L.reverse(),f&&u<A&&(L.length=u),this&&this!==Oc&&this instanceof E&&(H=x||nS(H)),H.apply(j,L)}return E}function Pat(e,r,t){var n=nS(e);function i(){for(var a=arguments.length,o=Array(a),s=a,u=iw(i);s--;)o[s]=arguments[s];var l=a<3&&o[0]!==u&&o[a-1]!==u?[]:f_(o,u);if(a-=l.length,a<t)return Qoe(e,r,Xk,i.placeholder,void 0,o,l,void 0,void 0,t-a);var f=this&&this!==Oc&&this instanceof i?n:e;return Kp(f,this,o)}return i}var Rat=1;function Oat(e,r,t,n){var i=r&Rat,a=nS(e);function o(){for(var s=-1,u=arguments.length,l=-1,f=n.length,h=Array(f+u),p=this&&this!==Oc&&this instanceof o?a:e;++l<f;)h[l]=n[l];for(;u--;)h[l++]=arguments[++s];return Kp(p,i?t:this,h)}return o}var NX="__lodash_placeholder__",HO=1,Fat=2,Dat=4,zX=8,sC=128,$X=256,Bat=Math.min;function Nat(e,r){var t=e[1],n=r[1],i=t|n,a=i<(HO|Fat|sC),o=n==sC&&t==zX||n==sC&&t==$X&&e[7].length<=r[8]||n==(sC|$X)&&r[7].length<=r[8]&&t==zX;if(!(a||o))return e;n&HO&&(e[2]=r[2],i|=t&HO?0:Dat);var s=r[3];if(s){var u=e[3];e[3]=u?joe(u,s,r[4]):s,e[4]=u?f_(e[3],NX):r[4]}return s=r[5],s&&(u=e[5],e[5]=u?Woe(u,s,r[6]):s,e[6]=u?f_(e[5],NX):r[6]),s=r[7],s&&(e[7]=s),n&sC&&(e[8]=e[8]==null?r[8]:Bat(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=i,e}var zat="Expected a function",UX=1,$at=2,jO=8,WO=16,XO=32,VX=64,GX=Math.max;function Oy(e,r,t,n,i,a,o,s){var u=r&$at;if(!u&&typeof e!="function")throw new TypeError(zat);var l=n?n.length:0;if(l||(r&=~(XO|VX),n=i=void 0),o=o===void 0?o:GX(wa(o),0),s=s===void 0?s:wa(s),l-=i?i.length:0,r&VX){var f=n,h=i;n=i=void 0}var p=u?void 0:q6(e),v=[e,r,t,n,i,f,h,a,o,s];if(p&&Nat(v,p),e=v[0],r=v[1],t=v[2],n=v[3],i=v[4],s=v[9]=v[9]===void 0?u?0:e.length:GX(v[9]-l,0),!s&&r&(jO|WO)&&(r&=~(jO|WO)),!r||r==UX)var m=Dit(e,r,t);else r==jO||r==WO?m=Pat(e,r,s):(r==XO||r==(UX|XO))&&!i.length?m=Oat(e,r,t,n):m=Xk.apply(void 0,v);var x=p?Hoe:Zoe;return Koe(x(m,v),e,r)}var Uat=128;function Q6(e,r,t){return r=t?void 0:r,r=e&&r==null?e.length:r,Oy(e,Uat,void 0,void 0,void 0,void 0,r)}function Fy(e,r,t){r=="__proto__"&&BL?BL(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}function rv(e,r){return e===r||e!==e&&r!==r}var Vat=Object.prototype,Gat=Vat.hasOwnProperty;function RS(e,r,t){var n=e[r];(!(Gat.call(e,r)&&rv(n,t))||t===void 0&&!(r in e))&&Fy(e,r,t)}function um(e,r,t,n){var i=!t;t||(t={});for(var a=-1,o=r.length;++a<o;){var s=r[a],u=n?n(t[s],e[s],s,t,e):void 0;u===void 0&&(u=e[s]),i?Fy(t,s,u):RS(t,s,u)}return t}var HX=Math.max;function Joe(e,r,t){return r=HX(r===void 0?e.length-1:r,0),function(){for(var n=arguments,i=-1,a=HX(n.length-r,0),o=Array(a);++i<a;)o[i]=n[r+i];i=-1;for(var s=Array(r+1);++i<r;)s[i]=n[i];return s[r]=t(o),Kp(e,this,s)}}function $a(e,r){return K6(Joe(e,r,Uf),e+"")}var Hat=9007199254740991;function OS(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Hat}function vh(e){return e!=null&&OS(e.length)&&!sm(e)}function ch(e,r,t){if(!yu(t))return!1;var n=typeof r;return(n=="number"?vh(t)&&Ry(r,t.length):n=="string"&&r in t)?rv(t[r],e):!1}function aw(e){return $a(function(r,t){var n=-1,i=t.length,a=i>1?t[i-1]:void 0,o=i>2?t[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,o&&ch(t[0],t[1],o)&&(a=i<3?void 0:a,i=1),r=Object(r);++n<i;){var s=t[n];s&&e(r,s,n,a)}return r})}var jat=Object.prototype;function FS(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||jat;return e===t}function J6(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}var Wat="[object Arguments]";function jX(e){return ju(e)&&dh(e)==Wat}var ese=Object.prototype,Xat=ese.hasOwnProperty,Yat=ese.propertyIsEnumerable,Zat=jX(function(){return arguments}())?jX:function(e){return ju(e)&&Xat.call(e,"callee")&&!Yat.call(e,"callee")},h_=Zat;function Yk(){return!1}var tse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,WX=tse&&typeof module=="object"&&module&&!module.nodeType&&module,qat=WX&&WX.exports===tse,XX=qat?Oc.Buffer:void 0,Kat=XX?XX.isBuffer:void 0,Qat=Kat||Yk,Ly=Qat,Jat="[object Arguments]",eot="[object Array]",tot="[object Boolean]",rot="[object Date]",not="[object Error]",iot="[object Function]",aot="[object Map]",oot="[object Number]",sot="[object Object]",uot="[object RegExp]",lot="[object Set]",cot="[object String]",fot="[object WeakMap]",hot="[object ArrayBuffer]",pot="[object DataView]",dot="[object Float32Array]",vot="[object Float64Array]",got="[object Int8Array]",mot="[object Int16Array]",yot="[object Int32Array]",_ot="[object Uint8Array]",xot="[object Uint8ClampedArray]",bot="[object Uint16Array]",wot="[object Uint32Array]",du={};du[dot]=du[vot]=du[got]=du[mot]=du[yot]=du[_ot]=du[xot]=du[bot]=du[wot]=!0;du[Jat]=du[eot]=du[hot]=du[tot]=du[pot]=du[rot]=du[not]=du[iot]=du[aot]=du[oot]=du[sot]=du[uot]=du[lot]=du[cot]=du[fot]=!1;function Cot(e){return ju(e)&&OS(e.length)&&!!du[dh(e)]}function Qp(e){return function(r){return e(r)}}var rse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,QC=rse&&typeof module=="object"&&module&&!module.nodeType&&module,Eot=QC&&QC.exports===rse,YO=Eot&&Boe.process,Sot=function(){try{var e=QC&&QC.require&&QC.require("util").types;return e||YO&&YO.binding&&YO.binding("util")}catch{}}(),Xd=Sot,YX=Xd&&Xd.isTypedArray,Aot=YX?Qp(YX):Cot,O1=Aot,Tot=Object.prototype,Mot=Tot.hasOwnProperty;function nse(e,r){var t=pa(e),n=!t&&h_(e),i=!t&&!n&&Ly(e),a=!t&&!n&&!i&&O1(e),o=t||n||i||a,s=o?J6(e.length,String):[],u=s.length;for(var l in e)(r||Mot.call(e,l))&&!(o&&(l=="length"||i&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Ry(l,u)))&&s.push(l);return s}function ise(e,r){return function(t){return e(r(t))}}var Lot=ise(Object.keys,Object),Iot=Lot,kot=Object.prototype,Pot=kot.hasOwnProperty;function eN(e){if(!FS(e))return Iot(e);var r=[];for(var t in Object(e))Pot.call(e,t)&&t!="constructor"&&r.push(t);return r}function Vl(e){return vh(e)?nse(e):eN(e)}var Rot=Object.prototype,Oot=Rot.hasOwnProperty,Fot=aw(function(e,r){if(FS(r)||vh(r)){um(r,Vl(r),e);return}for(var t in r)Oot.call(r,t)&&RS(e,t,r[t])}),ase=Fot;function Dot(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}var Bot=Object.prototype,Not=Bot.hasOwnProperty;function zot(e){if(!yu(e))return Dot(e);var r=FS(e),t=[];for(var n in e)n=="constructor"&&(r||!Not.call(e,n))||t.push(n);return t}function gh(e){return vh(e)?nse(e,!0):zot(e)}var $ot=aw(function(e,r){um(r,gh(r),e)}),NL=$ot,Uot=aw(function(e,r,t,n){um(r,gh(r),e,n)}),P2=Uot,Vot=aw(function(e,r,t,n){um(r,Vl(r),e,n)}),ose=Vot,Got=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hot=/^\w*$/;function tN(e,r){if(pa(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||vp(e)?!0:Hot.test(e)||!Got.test(e)||r!=null&&e in Object(r)}var jot=R1(Object,"create"),iS=jot;function Wot(){this.__data__=iS?iS(null):{},this.size=0}function Xot(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var Yot="__lodash_hash_undefined__",Zot=Object.prototype,qot=Zot.hasOwnProperty;function Kot(e){var r=this.__data__;if(iS){var t=r[e];return t===Yot?void 0:t}return qot.call(r,e)?r[e]:void 0}var Qot=Object.prototype,Jot=Qot.hasOwnProperty;function est(e){var r=this.__data__;return iS?r[e]!==void 0:Jot.call(r,e)}var tst="__lodash_hash_undefined__";function rst(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=iS&&r===void 0?tst:r,this}function f1(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}f1.prototype.clear=Wot;f1.prototype.delete=Xot;f1.prototype.get=Kot;f1.prototype.has=est;f1.prototype.set=rst;function nst(){this.__data__=[],this.size=0}function Zk(e,r){for(var t=e.length;t--;)if(rv(e[t][0],r))return t;return-1}var ist=Array.prototype,ast=ist.splice;function ost(e){var r=this.__data__,t=Zk(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():ast.call(r,t,1),--this.size,!0}function sst(e){var r=this.__data__,t=Zk(r,e);return t<0?void 0:r[t][1]}function ust(e){return Zk(this.__data__,e)>-1}function lst(e,r){var t=this.__data__,n=Zk(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}function Dy(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}Dy.prototype.clear=nst;Dy.prototype.delete=ost;Dy.prototype.get=sst;Dy.prototype.has=ust;Dy.prototype.set=lst;var cst=R1(Oc,"Map"),aS=cst;function fst(){this.size=0,this.__data__={hash:new f1,map:new(aS||Dy),string:new f1}}function hst(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function qk(e,r){var t=e.__data__;return hst(r)?t[typeof r=="string"?"string":"hash"]:t.map}function pst(e){var r=qk(this,e).delete(e);return this.size-=r?1:0,r}function dst(e){return qk(this,e).get(e)}function vst(e){return qk(this,e).has(e)}function gst(e,r){var t=qk(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}function By(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}By.prototype.clear=fst;By.prototype.delete=pst;By.prototype.get=dst;By.prototype.has=vst;By.prototype.set=gst;var mst="Expected a function";function DS(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(mst);var t=function(){var n=arguments,i=r?r.apply(this,n):n[0],a=t.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return t.cache=a.set(i,o)||a,o};return t.cache=new(DS.Cache||By),t}DS.Cache=By;var yst=500;function _st(e){var r=DS(e,function(n){return t.size===yst&&t.clear(),n}),t=r.cache;return r}var xst=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bst=/\\(\\)?/g,wst=_st(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(xst,function(t,n,i,a){r.push(i?a.replace(bst,"$1"):n||t)}),r}),sse=wst;function as(e){return e==null?"":qp(e)}function S_(e,r){return pa(e)?e:tN(e,r)?[e]:sse(as(e))}var Cst=1/0;function lm(e){if(typeof e=="string"||vp(e))return e;var r=e+"";return r=="0"&&1/e==-Cst?"-0":r}function F1(e,r){r=S_(r,e);for(var t=0,n=r.length;e!=null&&t<n;)e=e[lm(r[t++])];return t&&t==n?e:void 0}function Kk(e,r,t){var n=e==null?void 0:F1(e,r);return n===void 0?t:n}function rN(e,r){for(var t=-1,n=r.length,i=Array(n),a=e==null;++t<n;)i[t]=a?void 0:Kk(e,r[t]);return i}function A_(e,r){for(var t=-1,n=r.length,i=e.length;++t<n;)e[i+t]=r[t];return e}var ZX=Nf?Nf.isConcatSpreadable:void 0;function Est(e){return pa(e)||h_(e)||!!(ZX&&e&&e[ZX])}function vf(e,r,t,n,i){var a=-1,o=e.length;for(t||(t=Est),i||(i=[]);++a<o;){var s=e[a];r>0&&t(s)?r>1?vf(s,r-1,t,n,i):A_(i,s):n||(i[i.length]=s)}return i}function nN(e){var r=e==null?0:e.length;return r?vf(e,1):[]}function Ny(e){return K6(Joe(e,void 0,nN),e+"")}var Sst=Ny(rN),use=Sst,Ast=ise(Object.getPrototypeOf,Object),Qk=Ast,Tst="[object Object]",Mst=Function.prototype,Lst=Object.prototype,lse=Mst.toString,Ist=Lst.hasOwnProperty,kst=lse.call(Object);function ow(e){if(!ju(e)||dh(e)!=Tst)return!1;var r=Qk(e);if(r===null)return!0;var t=Ist.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&lse.call(t)==kst}var Pst="[object DOMException]",Rst="[object Error]";function Jk(e){if(!ju(e))return!1;var r=dh(e);return r==Rst||r==Pst||typeof e.message=="string"&&typeof e.name=="string"&&!ow(e)}var Ost=$a(function(e,r){try{return Kp(e,void 0,r)}catch(t){return Jk(t)?t:new Error(t)}}),iN=Ost,Fst="Expected a function";function aN(e,r){var t;if(typeof r!="function")throw new TypeError(Fst);return e=wa(e),function(){return--e>0&&(t=r.apply(this,arguments)),e<=1&&(r=void 0),t}}var Dst=1,Bst=32,oN=$a(function(e,r,t){var n=Dst;if(t.length){var i=f_(t,iw(oN));n|=Bst}return Oy(e,n,r,t,i)});oN.placeholder={};var sN=oN,Nst=Ny(function(e,r){return tv(r,function(t){t=lm(t),Fy(e,t,sN(e[t],e))}),e}),cse=Nst,zst=1,$st=2,Ust=32,uN=$a(function(e,r,t){var n=zst|$st;if(t.length){var i=f_(t,iw(uN));n|=Ust}return Oy(r,n,e,t,i)});uN.placeholder={};var fse=uN;function Yd(e,r,t){var n=-1,i=e.length;r<0&&(r=-r>i?0:i+r),t=t>i?i:t,t<0&&(t+=i),i=r>t?0:t-r>>>0,r>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+r];return a}function T_(e,r,t){var n=e.length;return t=t===void 0?n:t,!r&&t>=n?e:Yd(e,r,t)}var Vst="\\ud800-\\udfff",Gst="\\u0300-\\u036f",Hst="\\ufe20-\\ufe2f",jst="\\u20d0-\\u20ff",Wst=Gst+Hst+jst,Xst="\\ufe0e\\ufe0f",Yst="\\u200d",Zst=RegExp("["+Yst+Vst+Wst+Xst+"]");function sw(e){return Zst.test(e)}function qst(e){return e.split("")}var hse="\\ud800-\\udfff",Kst="\\u0300-\\u036f",Qst="\\ufe20-\\ufe2f",Jst="\\u20d0-\\u20ff",eut=Kst+Qst+Jst,tut="\\ufe0e\\ufe0f",rut="["+hse+"]",i3="["+eut+"]",a3="\\ud83c[\\udffb-\\udfff]",nut="(?:"+i3+"|"+a3+")",pse="[^"+hse+"]",dse="(?:\\ud83c[\\udde6-\\uddff]){2}",vse="[\\ud800-\\udbff][\\udc00-\\udfff]",iut="\\u200d",gse=nut+"?",mse="["+tut+"]?",aut="(?:"+iut+"(?:"+[pse,dse,vse].join("|")+")"+mse+gse+")*",out=mse+gse+aut,sut="(?:"+[pse+i3+"?",i3,dse,vse,rut].join("|")+")",uut=RegExp(a3+"(?="+a3+")|"+sut+out,"g");function lut(e){return e.match(uut)||[]}function Qv(e){return sw(e)?lut(e):qst(e)}function yse(e){return function(r){r=as(r);var t=sw(r)?Qv(r):void 0,n=t?t[0]:r.charAt(0),i=t?T_(t,1).join(""):r.slice(1);return n[e]()+i}}var cut=yse("toUpperCase"),eP=cut;function lN(e){return eP(as(e).toLowerCase())}function cN(e,r,t,n){var i=-1,a=e==null?0:e.length;for(n&&a&&(t=e[++i]);++i<a;)t=r(t,e[i],i,e);return t}function fN(e){return function(r){return e==null?void 0:e[r]}}var fut={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},hut=fN(fut),put=hut,dut=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vut="\\u0300-\\u036f",gut="\\ufe20-\\ufe2f",mut="\\u20d0-\\u20ff",yut=vut+gut+mut,_ut="["+yut+"]",xut=RegExp(_ut,"g");function hN(e){return e=as(e),e&&e.replace(dut,put).replace(xut,"")}var but=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function wut(e){return e.match(but)||[]}var Cut=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Eut(e){return Cut.test(e)}var _se="\\ud800-\\udfff",Sut="\\u0300-\\u036f",Aut="\\ufe20-\\ufe2f",Tut="\\u20d0-\\u20ff",Mut=Sut+Aut+Tut,xse="\\u2700-\\u27bf",bse="a-z\\xdf-\\xf6\\xf8-\\xff",Lut="\\xac\\xb1\\xd7\\xf7",Iut="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",kut="\\u2000-\\u206f",Put=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",wse="A-Z\\xc0-\\xd6\\xd8-\\xde",Rut="\\ufe0e\\ufe0f",Cse=Lut+Iut+kut+Put,Ese="['\u2019]",qX="["+Cse+"]",Out="["+Mut+"]",Sse="\\d+",Fut="["+xse+"]",Ase="["+bse+"]",Tse="[^"+_se+Cse+Sse+xse+bse+wse+"]",Dut="\\ud83c[\\udffb-\\udfff]",But="(?:"+Out+"|"+Dut+")",Nut="[^"+_se+"]",Mse="(?:\\ud83c[\\udde6-\\uddff]){2}",Lse="[\\ud800-\\udbff][\\udc00-\\udfff]",$b="["+wse+"]",zut="\\u200d",KX="(?:"+Ase+"|"+Tse+")",$ut="(?:"+$b+"|"+Tse+")",QX="(?:"+Ese+"(?:d|ll|m|re|s|t|ve))?",JX="(?:"+Ese+"(?:D|LL|M|RE|S|T|VE))?",Ise=But+"?",kse="["+Rut+"]?",Uut="(?:"+zut+"(?:"+[Nut,Mse,Lse].join("|")+")"+kse+Ise+")*",Vut="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Gut="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Hut=kse+Ise+Uut,jut="(?:"+[Fut,Mse,Lse].join("|")+")"+Hut,Wut=RegExp([$b+"?"+Ase+"+"+QX+"(?="+[qX,$b,"$"].join("|")+")",$ut+"+"+JX+"(?="+[qX,$b+KX,"$"].join("|")+")",$b+"?"+KX+"+"+QX,$b+"+"+JX,Gut,Vut,Sse,jut].join("|"),"g");function Xut(e){return e.match(Wut)||[]}function pN(e,r,t){return e=as(e),r=t?void 0:r,r===void 0?Eut(e)?Xut(e):wut(e):e.match(r)||[]}var Yut="['\u2019]",Zut=RegExp(Yut,"g");function uw(e){return function(r){return cN(pN(hN(r).replace(Zut,"")),e,"")}}var qut=uw(function(e,r,t){return r=r.toLowerCase(),e+(t?lN(r):r)}),Pse=qut;function Rse(){if(!arguments.length)return[];var e=arguments[0];return pa(e)?e:[e]}var Kut=Oc.isFinite,Qut=Math.min;function dN(e){var r=Math[e];return function(t,n){if(t=Zp(t),n=n==null?0:Qut(wa(n),292),n&&Kut(t)){var i=(as(t)+"e").split("e"),a=r(i[0]+"e"+(+i[1]+n));return i=(as(a)+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return r(t)}}var Jut=dN("ceil"),Ose=Jut;function vN(e){var r=Ae(e);return r.__chain__=!0,r}var elt=Math.ceil,tlt=Math.max;function Fse(e,r,t){(t?ch(e,r,t):r===void 0)?r=1:r=tlt(wa(r),0);var n=e==null?0:e.length;if(!n||r<1)return[];for(var i=0,a=0,o=Array(elt(n/r));i<n;)o[a++]=Yd(e,i,i+=r);return o}function D1(e,r,t){return e===e&&(t!==void 0&&(e=e<=t?e:t),r!==void 0&&(e=e>=r?e:r)),e}function Dse(e,r,t){return t===void 0&&(t=r,r=void 0),t!==void 0&&(t=Zp(t),t=t===t?t:0),r!==void 0&&(r=Zp(r),r=r===r?r:0),D1(Zp(e),r,t)}function rlt(){this.__data__=new Dy,this.size=0}function nlt(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}function ilt(e){return this.__data__.get(e)}function alt(e){return this.__data__.has(e)}var olt=200;function slt(e,r){var t=this.__data__;if(t instanceof Dy){var n=t.__data__;if(!aS||n.length<olt-1)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new By(n)}return t.set(e,r),this.size=t.size,this}function Zv(e){var r=this.__data__=new Dy(e);this.size=r.size}Zv.prototype.clear=rlt;Zv.prototype.delete=nlt;Zv.prototype.get=ilt;Zv.prototype.has=alt;Zv.prototype.set=slt;function Bse(e,r){return e&&um(r,Vl(r),e)}function ult(e,r){return e&&um(r,gh(r),e)}var Nse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,eY=Nse&&typeof module=="object"&&module&&!module.nodeType&&module,llt=eY&&eY.exports===Nse,tY=llt?Oc.Buffer:void 0,rY=tY?tY.allocUnsafe:void 0;function zse(e,r){if(r)return e.slice();var t=e.length,n=rY?rY(t):new e.constructor(t);return e.copy(n),n}function M_(e,r){for(var t=-1,n=e==null?0:e.length,i=0,a=[];++t<n;){var o=e[t];r(o,t,e)&&(a[i++]=o)}return a}function tP(){return[]}var clt=Object.prototype,flt=clt.propertyIsEnumerable,nY=Object.getOwnPropertySymbols,hlt=nY?function(e){return e==null?[]:(e=Object(e),M_(nY(e),function(r){return flt.call(e,r)}))}:tP,gN=hlt;function plt(e,r){return um(e,gN(e),r)}var dlt=Object.getOwnPropertySymbols,vlt=dlt?function(e){for(var r=[];e;)A_(r,gN(e)),e=Qk(e);return r}:tP,$se=vlt;function glt(e,r){return um(e,$se(e),r)}function Use(e,r,t){var n=r(e);return pa(e)?n:A_(n,t(e))}function o3(e){return Use(e,Vl,gN)}function mN(e){return Use(e,gh,$se)}var mlt=R1(Oc,"DataView"),s3=mlt,ylt=R1(Oc,"Promise"),u3=ylt,_lt=R1(Oc,"Set"),o2=_lt,iY="[object Map]",xlt="[object Object]",aY="[object Promise]",oY="[object Set]",sY="[object WeakMap]",uY="[object DataView]",blt=P1(s3),wlt=P1(aS),Clt=P1(u3),Elt=P1(o2),Slt=P1(rS),Sx=dh;(s3&&Sx(new s3(new ArrayBuffer(1)))!=uY||aS&&Sx(new aS)!=iY||u3&&Sx(u3.resolve())!=aY||o2&&Sx(new o2)!=oY||rS&&Sx(new rS)!=sY)&&(Sx=function(e){var r=dh(e),t=r==xlt?e.constructor:void 0,n=t?P1(t):"";if(n)switch(n){case blt:return uY;case wlt:return iY;case Clt:return aY;case Elt:return oY;case Slt:return sY}return r});var Jg=Sx,Alt=Object.prototype,Tlt=Alt.hasOwnProperty;function Mlt(e){var r=e.length,t=new e.constructor(r);return r&&typeof e[0]=="string"&&Tlt.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var Llt=Oc.Uint8Array,zL=Llt;function yN(e){var r=new e.constructor(e.byteLength);return new zL(r).set(new zL(e)),r}function Ilt(e,r){var t=r?yN(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var klt=/\w*$/;function Plt(e){var r=new e.constructor(e.source,klt.exec(e));return r.lastIndex=e.lastIndex,r}var lY=Nf?Nf.prototype:void 0,cY=lY?lY.valueOf:void 0;function Rlt(e){return cY?Object(cY.call(e)):{}}function Vse(e,r){var t=r?yN(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var Olt="[object Boolean]",Flt="[object Date]",Dlt="[object Map]",Blt="[object Number]",Nlt="[object RegExp]",zlt="[object Set]",$lt="[object String]",Ult="[object Symbol]",Vlt="[object ArrayBuffer]",Glt="[object DataView]",Hlt="[object Float32Array]",jlt="[object Float64Array]",Wlt="[object Int8Array]",Xlt="[object Int16Array]",Ylt="[object Int32Array]",Zlt="[object Uint8Array]",qlt="[object Uint8ClampedArray]",Klt="[object Uint16Array]",Qlt="[object Uint32Array]";function Jlt(e,r,t){var n=e.constructor;switch(r){case Vlt:return yN(e);case Olt:case Flt:return new n(+e);case Glt:return Ilt(e,t);case Hlt:case jlt:case Wlt:case Xlt:case Ylt:case Zlt:case qlt:case Klt:case Qlt:return Vse(e,t);case Dlt:return new n;case Blt:case $lt:return new n(e);case Nlt:return Plt(e);case zlt:return new n;case Ult:return Rlt(e)}}function Gse(e){return typeof e.constructor=="function"&&!FS(e)?rw(Qk(e)):{}}var ect="[object Map]";function tct(e){return ju(e)&&Jg(e)==ect}var fY=Xd&&Xd.isMap,rct=fY?Qp(fY):tct,_N=rct,nct="[object Set]";function ict(e){return ju(e)&&Jg(e)==nct}var hY=Xd&&Xd.isSet,act=hY?Qp(hY):ict,xN=act,oct=1,sct=2,uct=4,Hse="[object Arguments]",lct="[object Array]",cct="[object Boolean]",fct="[object Date]",hct="[object Error]",jse="[object Function]",pct="[object GeneratorFunction]",dct="[object Map]",vct="[object Number]",Wse="[object Object]",gct="[object RegExp]",mct="[object Set]",yct="[object String]",_ct="[object Symbol]",xct="[object WeakMap]",bct="[object ArrayBuffer]",wct="[object DataView]",Cct="[object Float32Array]",Ect="[object Float64Array]",Sct="[object Int8Array]",Act="[object Int16Array]",Tct="[object Int32Array]",Mct="[object Uint8Array]",Lct="[object Uint8ClampedArray]",Ict="[object Uint16Array]",kct="[object Uint32Array]",tu={};tu[Hse]=tu[lct]=tu[bct]=tu[wct]=tu[cct]=tu[fct]=tu[Cct]=tu[Ect]=tu[Sct]=tu[Act]=tu[Tct]=tu[dct]=tu[vct]=tu[Wse]=tu[gct]=tu[mct]=tu[yct]=tu[_ct]=tu[Mct]=tu[Lct]=tu[Ict]=tu[kct]=!0;tu[hct]=tu[jse]=tu[xct]=!1;function Vd(e,r,t,n,i,a){var o,s=r&oct,u=r&sct,l=r&uct;if(t&&(o=i?t(e,n,i,a):t(e)),o!==void 0)return o;if(!yu(e))return e;var f=pa(e);if(f){if(o=Mlt(e),!s)return fp(e,o)}else{var h=Jg(e),p=h==jse||h==pct;if(Ly(e))return zse(e,s);if(h==Wse||h==Hse||p&&!i){if(o=u||p?{}:Gse(e),!s)return u?glt(e,ult(o,e)):plt(e,Bse(o,e))}else{if(!tu[h])return i?e:{};o=Jlt(e,h,s)}}a||(a=new Zv);var v=a.get(e);if(v)return v;a.set(e,o),xN(e)?e.forEach(function(E){o.add(Vd(E,r,t,E,e,a))}):_N(e)&&e.forEach(function(E,A){o.set(A,Vd(E,r,t,A,e,a))});var m=l?u?mN:o3:u?gh:Vl,x=f?void 0:m(e);return tv(x||e,function(E,A){x&&(A=E,E=e[A]),RS(o,A,Vd(E,r,t,A,e,a))}),o}var Pct=4;function Xse(e){return Vd(e,Pct)}var Rct=1,Oct=4;function Yse(e){return Vd(e,Rct|Oct)}var Fct=1,Dct=4;function Zse(e,r){return r=typeof r=="function"?r:void 0,Vd(e,Fct|Dct,r)}var Bct=4;function qse(e,r){return r=typeof r=="function"?r:void 0,Vd(e,Bct,r)}function l3(){return new Wd(this.value(),this.__chain__)}function Kse(e){for(var r=-1,t=e==null?0:e.length,n=0,i=[];++r<t;){var a=e[r];a&&(i[n++]=a)}return i}function Qse(){var e=arguments.length;if(!e)return[];for(var r=Array(e-1),t=arguments[0],n=e;n--;)r[n-1]=arguments[n];return A_(pa(t)?fp(t):[t],vf(r,1))}var Nct="__lodash_hash_undefined__";function zct(e){return this.__data__.set(e,Nct),this}function $ct(e){return this.__data__.has(e)}function h1(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new By;++r<t;)this.add(e[r])}h1.prototype.add=h1.prototype.push=zct;h1.prototype.has=$ct;function bN(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}function oS(e,r){return e.has(r)}var Uct=1,Vct=2;function Jse(e,r,t,n,i,a){var o=t&Uct,s=e.length,u=r.length;if(s!=u&&!(o&&u>s))return!1;var l=a.get(e),f=a.get(r);if(l&&f)return l==r&&f==e;var h=-1,p=!0,v=t&Vct?new h1:void 0;for(a.set(e,r),a.set(r,e);++h<s;){var m=e[h],x=r[h];if(n)var E=o?n(x,m,h,r,e,a):n(m,x,h,e,r,a);if(E!==void 0){if(E)continue;p=!1;break}if(v){if(!bN(r,function(A,L){if(!oS(v,L)&&(m===A||i(m,A,t,n,a)))return v.push(L)})){p=!1;break}}else if(!(m===x||i(m,x,t,n,a))){p=!1;break}}return a.delete(e),a.delete(r),p}function wN(e){var r=-1,t=Array(e.size);return e.forEach(function(n,i){t[++r]=[i,n]}),t}function rP(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}var Gct=1,Hct=2,jct="[object Boolean]",Wct="[object Date]",Xct="[object Error]",Yct="[object Map]",Zct="[object Number]",qct="[object RegExp]",Kct="[object Set]",Qct="[object String]",Jct="[object Symbol]",eft="[object ArrayBuffer]",tft="[object DataView]",pY=Nf?Nf.prototype:void 0,ZO=pY?pY.valueOf:void 0;function rft(e,r,t,n,i,a,o){switch(t){case tft:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case eft:return!(e.byteLength!=r.byteLength||!a(new zL(e),new zL(r)));case jct:case Wct:case Zct:return rv(+e,+r);case Xct:return e.name==r.name&&e.message==r.message;case qct:case Qct:return e==r+"";case Yct:var s=wN;case Kct:var u=n&Gct;if(s||(s=rP),e.size!=r.size&&!u)return!1;var l=o.get(e);if(l)return l==r;n|=Hct,o.set(e,r);var f=Jse(s(e),s(r),n,i,a,o);return o.delete(e),f;case Jct:if(ZO)return ZO.call(e)==ZO.call(r)}return!1}var nft=1,ift=Object.prototype,aft=ift.hasOwnProperty;function oft(e,r,t,n,i,a){var o=t&nft,s=o3(e),u=s.length,l=o3(r),f=l.length;if(u!=f&&!o)return!1;for(var h=u;h--;){var p=s[h];if(!(o?p in r:aft.call(r,p)))return!1}var v=a.get(e),m=a.get(r);if(v&&m)return v==r&&m==e;var x=!0;a.set(e,r),a.set(r,e);for(var E=o;++h<u;){p=s[h];var A=e[p],L=r[p];if(n)var k=o?n(L,A,p,r,e,a):n(A,L,p,e,r,a);if(!(k===void 0?A===L||i(A,L,t,n,a):k)){x=!1;break}E||(E=p=="constructor")}if(x&&!E){var R=e.constructor,D=r.constructor;R!=D&&"constructor"in e&&"constructor"in r&&!(typeof R=="function"&&R instanceof R&&typeof D=="function"&&D instanceof D)&&(x=!1)}return a.delete(e),a.delete(r),x}var sft=1,dY="[object Arguments]",vY="[object Array]",UT="[object Object]",uft=Object.prototype,gY=uft.hasOwnProperty;function lft(e,r,t,n,i,a){var o=pa(e),s=pa(r),u=o?vY:Jg(e),l=s?vY:Jg(r);u=u==dY?UT:u,l=l==dY?UT:l;var f=u==UT,h=l==UT,p=u==l;if(p&&Ly(e)){if(!Ly(r))return!1;o=!0,f=!1}if(p&&!f)return a||(a=new Zv),o||O1(e)?Jse(e,r,t,n,i,a):rft(e,r,u,t,n,i,a);if(!(t&sft)){var v=f&&gY.call(e,"__wrapped__"),m=h&&gY.call(r,"__wrapped__");if(v||m){var x=v?e.value():e,E=m?r.value():r;return a||(a=new Zv),i(x,E,t,n,a)}}return p?(a||(a=new Zv),oft(e,r,t,n,i,a)):!1}function BS(e,r,t,n,i){return e===r?!0:e==null||r==null||!ju(e)&&!ju(r)?e!==e&&r!==r:lft(e,r,t,n,BS,i)}var cft=1,fft=2;function CN(e,r,t,n){var i=t.length,a=i,o=!n;if(e==null)return!a;for(e=Object(e);i--;){var s=t[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){s=t[i];var u=s[0],l=e[u],f=s[1];if(o&&s[2]){if(l===void 0&&!(u in e))return!1}else{var h=new Zv;if(n)var p=n(l,f,u,e,r,h);if(!(p===void 0?BS(f,l,cft|fft,n,h):p))return!1}}return!0}function eue(e){return e===e&&!yu(e)}function EN(e){for(var r=Vl(e),t=r.length;t--;){var n=r[t],i=e[n];r[t]=[n,i,eue(i)]}return r}function tue(e,r){return function(t){return t==null?!1:t[e]===r&&(r!==void 0||e in Object(t))}}function rue(e){var r=EN(e);return r.length==1&&r[0][2]?tue(r[0][0],r[0][1]):function(t){return t===e||CN(t,e,r)}}function hft(e,r){return e!=null&&r in Object(e)}function nue(e,r,t){r=S_(r,e);for(var n=-1,i=r.length,a=!1;++n<i;){var o=lm(r[n]);if(!(a=e!=null&&t(e,o)))break;e=e[o]}return a||++n!=i?a:(i=e==null?0:e.length,!!i&&OS(i)&&Ry(o,i)&&(pa(e)||h_(e)))}function nP(e,r){return e!=null&&nue(e,r,hft)}var pft=1,dft=2;function iue(e,r){return tN(e)&&eue(r)?tue(lm(e),r):function(t){var n=Kk(t,e);return n===void 0&&n===r?nP(t,e):BS(r,n,pft|dft)}}function SN(e){return function(r){return r==null?void 0:r[e]}}function vft(e){return function(r){return F1(r,e)}}function AN(e){return tN(e)?SN(lm(e)):vft(e)}function da(e){return typeof e=="function"?e:e==null?Uf:typeof e=="object"?pa(e)?iue(e[0],e[1]):rue(e):AN(e)}var gft="Expected a function";function aue(e){var r=e==null?0:e.length,t=da;return e=r?Iu(e,function(n){if(typeof n[1]!="function")throw new TypeError(gft);return[t(n[0]),n[1]]}):[],$a(function(n){for(var i=-1;++i<r;){var a=e[i];if(Kp(a[0],this,n))return Kp(a[1],this,n)}})}function oue(e,r,t){var n=t.length;if(e==null)return!n;for(e=Object(e);n--;){var i=t[n],a=r[i],o=e[i];if(o===void 0&&!(i in e)||!a(o))return!1}return!0}function mft(e){var r=Vl(e);return function(t){return oue(t,e,r)}}var yft=1;function sue(e){return mft(Vd(e,yft))}function uue(e,r){return r==null||oue(e,r,Vl(r))}function _ft(e,r,t,n){for(var i=-1,a=e==null?0:e.length;++i<a;){var o=e[i];r(n,o,t(o),e)}return n}function lue(e){return function(r,t,n){for(var i=-1,a=Object(r),o=n(r),s=o.length;s--;){var u=o[e?s:++i];if(t(a[u],u,a)===!1)break}return r}}var xft=lue(),TN=xft;function cm(e,r){return e&&TN(e,r,Vl)}function cue(e,r){return function(t,n){if(t==null)return t;if(!vh(t))return e(t,n);for(var i=t.length,a=r?i:-1,o=Object(t);(r?a--:++a<i)&&n(o[a],a,o)!==!1;);return t}}var bft=cue(cm),L_=bft;function wft(e,r,t,n){return L_(e,function(i,a,o){r(n,i,t(i),o)}),n}function iP(e,r){return function(t,n){var i=pa(t)?_ft:wft,a=r?r():{};return i(t,e,da(n),a)}}var Cft=Object.prototype,Eft=Cft.hasOwnProperty,Sft=iP(function(e,r,t){Eft.call(e,t)?++e[t]:Fy(e,t,1)}),fue=Sft;function hue(e,r){var t=rw(e);return r==null?t:Bse(t,r)}var Aft=8;function aP(e,r,t){r=t?void 0:r;var n=Oy(e,Aft,void 0,void 0,void 0,void 0,void 0,r);return n.placeholder=aP.placeholder,n}aP.placeholder={};var Tft=16;function oP(e,r,t){r=t?void 0:r;var n=Oy(e,Tft,void 0,void 0,void 0,void 0,void 0,r);return n.placeholder=oP.placeholder,n}oP.placeholder={};var Mft=function(){return Oc.Date.now()},JC=Mft,Lft="Expected a function",Ift=Math.max,kft=Math.min;function MN(e,r,t){var n,i,a,o,s,u,l=0,f=!1,h=!1,p=!0;if(typeof e!="function")throw new TypeError(Lft);r=Zp(r)||0,yu(t)&&(f=!!t.leading,h="maxWait"in t,a=h?Ift(Zp(t.maxWait)||0,r):a,p="trailing"in t?!!t.trailing:p);function v($){var j=n,H=i;return n=i=void 0,l=$,o=e.apply(H,j),o}function m($){return l=$,s=setTimeout(A,r),f?v($):o}function x($){var j=$-u,H=$-l,ee=r-j;return h?kft(ee,a-H):ee}function E($){var j=$-u,H=$-l;return u===void 0||j>=r||j<0||h&&H>=a}function A(){var $=JC();if(E($))return L($);s=setTimeout(A,x($))}function L($){return s=void 0,p&&n?v($):(n=i=void 0,o)}function k(){s!==void 0&&clearTimeout(s),l=0,n=u=i=s=void 0}function R(){return s===void 0?o:L(JC())}function D(){var $=JC(),j=E($);if(n=arguments,i=this,u=$,j){if(s===void 0)return m(u);if(h)return clearTimeout(s),s=setTimeout(A,r),v(u)}return s===void 0&&(s=setTimeout(A,r)),o}return D.cancel=k,D.flush=R,D}function pue(e,r){return e==null||e!==e?r:e}var due=Object.prototype,Pft=due.hasOwnProperty,Rft=$a(function(e,r){e=Object(e);var t=-1,n=r.length,i=n>2?r[2]:void 0;for(i&&ch(r[0],r[1],i)&&(n=1);++t<n;)for(var a=r[t],o=gh(a),s=-1,u=o.length;++s<u;){var l=o[s],f=e[l];(f===void 0||rv(f,due[l])&&!Pft.call(e,l))&&(e[l]=a[l])}return e}),vue=Rft;function c3(e,r,t){(t!==void 0&&!rv(e[r],t)||t===void 0&&!(r in e))&&Fy(e,r,t)}function ol(e){return ju(e)&&vh(e)}function f3(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}function LN(e){return um(e,gh(e))}function Oft(e,r,t,n,i,a,o){var s=f3(e,t),u=f3(r,t),l=o.get(u);if(l){c3(e,t,l);return}var f=a?a(s,u,t+"",e,r,o):void 0,h=f===void 0;if(h){var p=pa(u),v=!p&&Ly(u),m=!p&&!v&&O1(u);f=u,p||v||m?pa(s)?f=s:ol(s)?f=fp(s):v?(h=!1,f=zse(u,!0)):m?(h=!1,f=Vse(u,!0)):f=[]:ow(u)||h_(u)?(f=s,h_(s)?f=LN(s):(!yu(s)||sm(s))&&(f=Gse(u))):h=!1}h&&(o.set(u,f),i(f,u,n,a,o),o.delete(u)),c3(e,t,f)}function sP(e,r,t,n,i){e!==r&&TN(r,function(a,o){if(i||(i=new Zv),yu(a))Oft(e,r,o,t,sP,n,i);else{var s=n?n(f3(e,o),a,o+"",e,r,i):void 0;s===void 0&&(s=a),c3(e,o,s)}},gh)}function gue(e,r,t,n,i,a){return yu(e)&&yu(r)&&(a.set(r,e),sP(e,r,void 0,gue,a),a.delete(r)),e}var Fft=aw(function(e,r,t,n){sP(e,r,t,n)}),IN=Fft,Dft=$a(function(e){return e.push(void 0,gue),Kp(IN,void 0,e)}),mue=Dft,Bft="Expected a function";function yue(e,r,t){if(typeof e!="function")throw new TypeError(Bft);return setTimeout(function(){e.apply(void 0,t)},r)}var Nft=$a(function(e,r){return yue(e,1,r)}),_ue=Nft,zft=$a(function(e,r,t){return yue(e,Zp(r)||0,t)}),xue=zft;function kN(e,r,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(r,e[n]))return!0;return!1}var $ft=200;function NS(e,r,t,n){var i=-1,a=Wk,o=!0,s=e.length,u=[],l=r.length;if(!s)return u;t&&(r=Iu(r,Qp(t))),n?(a=kN,o=!1):r.length>=$ft&&(a=oS,o=!1,r=new h1(r));e:for(;++i<s;){var f=e[i],h=t==null?f:t(f);if(f=n||f!==0?f:0,o&&h===h){for(var p=l;p--;)if(r[p]===h)continue e;u.push(f)}else a(r,h,n)||u.push(f)}return u}var Uft=$a(function(e,r){return ol(e)?NS(e,vf(r,1,ol,!0)):[]}),bue=Uft;function gp(e){var r=e==null?0:e.length;return r?e[r-1]:void 0}var Vft=$a(function(e,r){var t=gp(r);return ol(t)&&(t=void 0),ol(e)?NS(e,vf(r,1,ol,!0),da(t)):[]}),wue=Vft,Gft=$a(function(e,r){var t=gp(r);return ol(t)&&(t=void 0),ol(e)?NS(e,vf(r,1,ol,!0),void 0,t):[]}),Cue=Gft,Hft=Uk(function(e,r){return e/r},1),Eue=Hft;function Sue(e,r,t){var n=e==null?0:e.length;return n?(r=t||r===void 0?1:wa(r),Yd(e,r<0?0:r,n)):[]}function Aue(e,r,t){var n=e==null?0:e.length;return n?(r=t||r===void 0?1:wa(r),r=n-r,Yd(e,0,r<0?0:r)):[]}function uP(e,r,t,n){for(var i=e.length,a=n?i:-1;(n?a--:++a<i)&&r(e[a],a,e););return t?Yd(e,n?0:a,n?a+1:i):Yd(e,n?a+1:0,n?i:a)}function Tue(e,r){return e&&e.length?uP(e,da(r),!0,!0):[]}function Mue(e,r){return e&&e.length?uP(e,da(r),!0):[]}function fm(e){return typeof e=="function"?e:Uf}function $L(e,r){var t=pa(e)?tv:L_;return t(e,fm(r))}function jft(e,r){for(var t=e==null?0:e.length;t--&&r(e[t],t,e)!==!1;);return e}var Wft=lue(!0),Lue=Wft;function PN(e,r){return e&&Lue(e,r,Vl)}var Xft=cue(PN,!0),Iue=Xft;function UL(e,r){var t=pa(e)?jft:Iue;return t(e,fm(r))}function kue(e,r,t){e=as(e),r=qp(r);var n=e.length;t=t===void 0?n:D1(wa(t),0,n);var i=t;return t-=r.length,t>=0&&e.slice(t,i)==r}function Yft(e,r){return Iu(r,function(t){return[t,e[t]]})}function Zft(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=[n,n]}),t}var qft="[object Map]",Kft="[object Set]";function Pue(e){return function(r){var t=Jg(r);return t==qft?wN(r):t==Kft?Zft(r):Yft(r,e(r))}}var Qft=Pue(Vl),VL=Qft,Jft=Pue(gh),GL=Jft,eht={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tht=fN(eht),rht=tht,Rue=/[&<>"']/g,nht=RegExp(Rue.source);function RN(e){return e=as(e),e&&nht.test(e)?e.replace(Rue,rht):e}var Oue=/[\\^$.*+?()[\]{}|]/g,iht=RegExp(Oue.source);function Fue(e){return e=as(e),e&&iht.test(e)?e.replace(Oue,"\\$&"):e}function Due(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(!r(e[t],t,e))return!1;return!0}function aht(e,r){var t=!0;return L_(e,function(n,i,a){return t=!!r(n,i,a),t}),t}function Bue(e,r,t){var n=pa(e)?Due:aht;return t&&ch(e,r,t)&&(r=void 0),n(e,da(r))}var oht=4294967295;function ON(e){return e?D1(wa(e),0,oht):0}function sht(e,r,t,n){var i=e.length;for(t=wa(t),t<0&&(t=-t>i?0:i+t),n=n===void 0||n>i?i:wa(n),n<0&&(n+=i),n=t>n?0:ON(n);t<n;)e[t++]=r;return e}function Nue(e,r,t,n){var i=e==null?0:e.length;return i?(t&&typeof t!="number"&&ch(e,r,t)&&(t=0,n=i),sht(e,r,t,n)):[]}function zue(e,r){var t=[];return L_(e,function(n,i,a){r(n,i,a)&&t.push(n)}),t}function $ue(e,r){var t=pa(e)?M_:zue;return t(e,da(r))}function Uue(e){return function(r,t,n){var i=Object(r);if(!vh(r)){var a=da(t);r=Vl(r),t=function(s){return a(i[s],s,i)}}var o=e(r,t,n);return o>-1?i[a?r[o]:o]:void 0}}var uht=Math.max;function FN(e,r,t){var n=e==null?0:e.length;if(!n)return-1;var i=t==null?0:wa(t);return i<0&&(i=uht(n+i,0)),jk(e,da(r),i)}var lht=Uue(FN),Vue=lht;function Gue(e,r,t){var n;return t(e,function(i,a,o){if(r(i,a,o))return n=a,!1}),n}function Hue(e,r){return Gue(e,da(r),cm)}var cht=Math.max,fht=Math.min;function DN(e,r,t){var n=e==null?0:e.length;if(!n)return-1;var i=n-1;return t!==void 0&&(i=wa(t),i=t<0?cht(n+i,0):fht(i,n-1)),jk(e,da(r),i,!0)}var hht=Uue(DN),jue=hht;function Wue(e,r){return Gue(e,da(r),PN)}function HL(e){return e&&e.length?e[0]:void 0}function Xue(e,r){var t=-1,n=vh(e)?Array(e.length):[];return L_(e,function(i,a,o){n[++t]=r(i,a,o)}),n}function zS(e,r){var t=pa(e)?Iu:Xue;return t(e,da(r))}function Yue(e,r){return vf(zS(e,r),1)}var pht=1/0;function Zue(e,r){return vf(zS(e,r),pht)}function que(e,r,t){return t=t===void 0?1:wa(t),vf(zS(e,r),t)}var dht=1/0;function Kue(e){var r=e==null?0:e.length;return r?vf(e,dht):[]}function Que(e,r){var t=e==null?0:e.length;return t?(r=r===void 0?1:wa(r),vf(e,r)):[]}var vht=512;function Jue(e){return Oy(e,vht)}var ght=dN("floor"),ele=ght,mht="Expected a function",yht=8,_ht=32,xht=128,bht=256;function tle(e){return Ny(function(r){var t=r.length,n=t,i=Wd.prototype.thru;for(e&&r.reverse();n--;){var a=r[n];if(typeof a!="function")throw new TypeError(mht);if(i&&!o&&AM(a)=="wrapper")var o=new Wd([],!0)}for(n=o?n:t;++n<t;){a=r[n];var s=AM(a),u=s=="wrapper"?q6(a):void 0;u&&n3(u[0])&&u[1]==(xht|yht|_ht|bht)&&!u[4].length&&u[9]==1?o=o[AM(u[0])].apply(o,u[3]):o=a.length==1&&n3(a)?o[s]():o.thru(a)}return function(){var l=arguments,f=l[0];if(o&&l.length==1&&pa(f))return o.plant(f).value();for(var h=0,p=t?r[h].apply(this,l):f;++h<t;)p=r[h].call(this,p);return p}})}var wht=tle(),rle=wht,Cht=tle(!0),nle=Cht;function ile(e,r){return e==null?e:TN(e,fm(r),gh)}function ale(e,r){return e==null?e:Lue(e,fm(r),gh)}function ole(e,r){return e&&cm(e,fm(r))}function sle(e,r){return e&&PN(e,fm(r))}function ule(e){for(var r=-1,t=e==null?0:e.length,n={};++r<t;){var i=e[r];n[i[0]]=i[1]}return n}function lP(e,r){return M_(r,function(t){return sm(e[t])})}function lle(e){return e==null?[]:lP(e,Vl(e))}function cle(e){return e==null?[]:lP(e,gh(e))}var Eht=Object.prototype,Sht=Eht.hasOwnProperty,Aht=iP(function(e,r,t){Sht.call(e,t)?e[t].push(r):Fy(e,t,[r])}),fle=Aht;function BN(e,r){return e>r}function cP(e){return function(r,t){return typeof r=="string"&&typeof t=="string"||(r=Zp(r),t=Zp(t)),e(r,t)}}var Tht=cP(BN),hle=Tht,Mht=cP(function(e,r){return e>=r}),ple=Mht,Lht=Object.prototype,Iht=Lht.hasOwnProperty;function kht(e,r){return e!=null&&Iht.call(e,r)}function dle(e,r){return e!=null&&nue(e,r,kht)}var Pht=Math.max,Rht=Math.min;function Oht(e,r,t){return e>=Rht(r,t)&&e<Pht(r,t)}function vle(e,r,t){return r=Zg(r),t===void 0?(t=r,r=0):t=Zg(t),e=Zp(e),Oht(e,r,t)}var Fht="[object String]";function $S(e){return typeof e=="string"||!pa(e)&&ju(e)&&dh(e)==Fht}function NN(e,r){return Iu(r,function(t){return e[t]})}function B1(e){return e==null?[]:NN(e,Vl(e))}var Dht=Math.max;function gle(e,r,t,n){e=vh(e)?e:B1(e),t=t&&!n?wa(t):0;var i=e.length;return t<0&&(t=Dht(i+t,0)),$S(e)?t<=i&&e.indexOf(r,t)>-1:!!i&&nw(e,r,t)>-1}var Bht=Math.max;function mle(e,r,t){var n=e==null?0:e.length;if(!n)return-1;var i=t==null?0:wa(t);return i<0&&(i=Bht(n+i,0)),nw(e,r,i)}function yle(e){var r=e==null?0:e.length;return r?Yd(e,0,-1):[]}var Nht=Math.min;function zN(e,r,t){for(var n=t?kN:Wk,i=e[0].length,a=e.length,o=a,s=Array(a),u=1/0,l=[];o--;){var f=e[o];o&&r&&(f=Iu(f,Qp(r))),u=Nht(f.length,u),s[o]=!t&&(r||i>=120&&f.length>=120)?new h1(o&&f):void 0}f=e[0];var h=-1,p=s[0];e:for(;++h<i&&l.length<u;){var v=f[h],m=r?r(v):v;if(v=t||v!==0?v:0,!(p?oS(p,m):n(l,m,t))){for(o=a;--o;){var x=s[o];if(!(x?oS(x,m):n(e[o],m,t)))continue e}p&&p.push(m),l.push(v)}}return l}function $N(e){return ol(e)?e:[]}var zht=$a(function(e){var r=Iu(e,$N);return r.length&&r[0]===e[0]?zN(r):[]}),_le=zht,$ht=$a(function(e){var r=gp(e),t=Iu(e,$N);return r===gp(t)?r=void 0:t.pop(),t.length&&t[0]===e[0]?zN(t,da(r)):[]}),xle=$ht,Uht=$a(function(e){var r=gp(e),t=Iu(e,$N);return r=typeof r=="function"?r:void 0,r&&t.pop(),t.length&&t[0]===e[0]?zN(t,void 0,r):[]}),ble=Uht;function Vht(e,r,t,n){return cm(e,function(i,a,o){r(n,t(i),a,o)}),n}function wle(e,r){return function(t,n){return Vht(t,e,r(n),{})}}var Ght=Object.prototype,Hht=Ght.toString,jht=wle(function(e,r,t){r!=null&&typeof r.toString!="function"&&(r=Hht.call(r)),e[r]=t},Hk(Uf)),Cle=jht,Ele=Object.prototype,Wht=Ele.hasOwnProperty,Xht=Ele.toString,Yht=wle(function(e,r,t){r!=null&&typeof r.toString!="function"&&(r=Xht.call(r)),Wht.call(e,r)?e[r].push(t):e[r]=[t]},da),Sle=Yht;function Ale(e,r){return r.length<2?e:F1(e,Yd(r,0,-1))}function US(e,r,t){r=S_(r,e),e=Ale(e,r);var n=e==null?e:e[lm(gp(r))];return n==null?void 0:Kp(n,e,t)}var Zht=$a(US),Tle=Zht,qht=$a(function(e,r,t){var n=-1,i=typeof r=="function",a=vh(e)?Array(e.length):[];return L_(e,function(o){a[++n]=i?Kp(r,o,t):US(o,r,t)}),a}),Mle=qht,Kht="[object ArrayBuffer]";function Qht(e){return ju(e)&&dh(e)==Kht}var mY=Xd&&Xd.isArrayBuffer,Jht=mY?Qp(mY):Qht,Lle=Jht,ept="[object Boolean]";function Ile(e){return e===!0||e===!1||ju(e)&&dh(e)==ept}var tpt="[object Date]";function rpt(e){return ju(e)&&dh(e)==tpt}var yY=Xd&&Xd.isDate,npt=yY?Qp(yY):rpt,kle=npt;function Ple(e){return ju(e)&&e.nodeType===1&&!ow(e)}var ipt="[object Map]",apt="[object Set]",opt=Object.prototype,spt=opt.hasOwnProperty;function Rle(e){if(e==null)return!0;if(vh(e)&&(pa(e)||typeof e=="string"||typeof e.splice=="function"||Ly(e)||O1(e)||h_(e)))return!e.length;var r=Jg(e);if(r==ipt||r==apt)return!e.size;if(FS(e))return!eN(e).length;for(var t in e)if(spt.call(e,t))return!1;return!0}function Ole(e,r){return BS(e,r)}function Fle(e,r,t){t=typeof t=="function"?t:void 0;var n=t?t(e,r):void 0;return n===void 0?BS(e,r,void 0,t):!!n}var upt=Oc.isFinite;function Dle(e){return typeof e=="number"&&upt(e)}function UN(e){return typeof e=="number"&&e==wa(e)}function Ble(e,r){return e===r||CN(e,r,EN(r))}function Nle(e,r,t){return t=typeof t=="function"?t:void 0,CN(e,r,EN(r),t)}var lpt="[object Number]";function VN(e){return typeof e=="number"||ju(e)&&dh(e)==lpt}function zle(e){return VN(e)&&e!=+e}var cpt=SM?sm:Yk,fpt=cpt,hpt="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function $le(e){if(fpt(e))throw new Error(hpt);return Goe(e)}function Ule(e){return e==null}function Vle(e){return e===null}var ppt="[object RegExp]";function dpt(e){return ju(e)&&dh(e)==ppt}var _Y=Xd&&Xd.isRegExp,vpt=_Y?Qp(_Y):dpt,fP=vpt,xY=9007199254740991;function Gle(e){return UN(e)&&e>=-xY&&e<=xY}function Hle(e){return e===void 0}var gpt="[object WeakMap]";function jle(e){return ju(e)&&Jg(e)==gpt}var mpt="[object WeakSet]";function Wle(e){return ju(e)&&dh(e)==mpt}var ypt=1;function Xle(e){return da(typeof e=="function"?e:Vd(e,ypt))}var _pt=Array.prototype,xpt=_pt.join;function Yle(e,r){return e==null?"":xpt.call(e,r)}var bpt=uw(function(e,r,t){return e+(t?"-":"")+r.toLowerCase()}),Zle=bpt,wpt=iP(function(e,r,t){Fy(e,t,r)}),qle=wpt;function Cpt(e,r,t){for(var n=t+1;n--;)if(e[n]===r)return n;return n}var Ept=Math.max,Spt=Math.min;function Kle(e,r,t){var n=e==null?0:e.length;if(!n)return-1;var i=n;return t!==void 0&&(i=wa(t),i=i<0?Ept(n+i,0):Spt(i,n-1)),r===r?Cpt(e,r,i):jk(e,qoe,i,!0)}var Apt=uw(function(e,r,t){return e+(t?" ":"")+r.toLowerCase()}),Qle=Apt,Tpt=yse("toLowerCase"),Jle=Tpt;function GN(e,r){return e<r}var Mpt=cP(GN),ece=Mpt,Lpt=cP(function(e,r){return e<=r}),tce=Lpt;function rce(e,r){var t={};return r=da(r),cm(e,function(n,i,a){Fy(t,r(n,i,a),n)}),t}function nce(e,r){var t={};return r=da(r),cm(e,function(n,i,a){Fy(t,i,r(n,i,a))}),t}var Ipt=1;function ice(e){return rue(Vd(e,Ipt))}var kpt=1;function ace(e,r){return iue(e,Vd(r,kpt))}function hP(e,r,t){for(var n=-1,i=e.length;++n<i;){var a=e[n],o=r(a);if(o!=null&&(s===void 0?o===o&&!vp(o):t(o,s)))var s=o,u=a}return u}function oce(e){return e&&e.length?hP(e,Uf,BN):void 0}function sce(e,r){return e&&e.length?hP(e,da(r),BN):void 0}function HN(e,r){for(var t,n=-1,i=e.length;++n<i;){var a=r(e[n]);a!==void 0&&(t=t===void 0?a:t+a)}return t}var Ppt=0/0;function uce(e,r){var t=e==null?0:e.length;return t?HN(e,r)/t:Ppt}function lce(e){return uce(e,Uf)}function cce(e,r){return uce(e,da(r))}var Rpt=aw(function(e,r,t){sP(e,r,t)}),fce=Rpt,Opt=$a(function(e,r){return function(t){return US(t,e,r)}}),hce=Opt,Fpt=$a(function(e,r){return function(t){return US(e,t,r)}}),pce=Fpt;function dce(e){return e&&e.length?hP(e,Uf,GN):void 0}function vce(e,r){return e&&e.length?hP(e,da(r),GN):void 0}function jN(e,r,t){var n=Vl(r),i=lP(r,n),a=!(yu(t)&&"chain"in t)||!!t.chain,o=sm(e);return tv(i,function(s){var u=r[s];e[s]=u,o&&(e.prototype[s]=function(){var l=this.__chain__;if(a||l){var f=e(this.__wrapped__),h=f.__actions__=fp(this.__actions__);return h.push({func:u,args:arguments,thisArg:e}),f.__chain__=l,f}return u.apply(e,A_([this.value()],arguments))})}),e}var Dpt=Uk(function(e,r){return e*r},1),gce=Dpt,Bpt="Expected a function";function lw(e){if(typeof e!="function")throw new TypeError(Bpt);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Npt(e){for(var r,t=[];!(r=e.next()).done;)t.push(r.value);return t}var zpt="[object Map]",$pt="[object Set]",qO=Nf?Nf.iterator:void 0;function WN(e){if(!e)return[];if(vh(e))return $S(e)?Qv(e):fp(e);if(qO&&e[qO])return Npt(e[qO]());var r=Jg(e),t=r==zpt?wN:r==$pt?rP:B1;return t(e)}function h3(){this.__values__===void 0&&(this.__values__=WN(this.value()));var e=this.__index__>=this.__values__.length,r=e?void 0:this.__values__[this.__index__++];return{done:e,value:r}}function mce(e,r){var t=e.length;if(!!t)return r+=r<0?t:0,Ry(r,t)?e[r]:void 0}function yce(e,r){return e&&e.length?mce(e,wa(r)):void 0}function _ce(e){return e=wa(e),$a(function(r){return mce(r,e)})}function XN(e,r){return r=S_(r,e),e=Ale(e,r),e==null||delete e[lm(gp(r))]}function Upt(e){return ow(e)?void 0:e}var Vpt=1,Gpt=2,Hpt=4,jpt=Ny(function(e,r){var t={};if(e==null)return t;var n=!1;r=Iu(r,function(a){return a=S_(a,e),n||(n=a.length>1),a}),um(e,mN(e),t),n&&(t=Vd(t,Vpt|Gpt|Hpt,Upt));for(var i=r.length;i--;)XN(t,r[i]);return t}),xce=jpt;function VS(e,r,t,n){if(!yu(e))return e;r=S_(r,e);for(var i=-1,a=r.length,o=a-1,s=e;s!=null&&++i<a;){var u=lm(r[i]),l=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return e;if(i!=o){var f=s[u];l=n?n(f,u,s):void 0,l===void 0&&(l=yu(f)?f:Ry(r[i+1])?[]:{})}RS(s,u,l),s=s[u]}return e}function bce(e,r,t){for(var n=-1,i=r.length,a={};++n<i;){var o=r[n],s=F1(e,o);t(s,o)&&VS(a,S_(o,e),s)}return a}function YN(e,r){if(e==null)return{};var t=Iu(mN(e),function(n){return[n]});return r=da(r),bce(e,t,function(n,i){return r(n,i[0])})}function wce(e,r){return YN(e,lw(da(r)))}function Cce(e){return aN(2,e)}function Wpt(e,r){var t=e.length;for(e.sort(r);t--;)e[t]=e[t].value;return e}function Ece(e,r){if(e!==r){var t=e!==void 0,n=e===null,i=e===e,a=vp(e),o=r!==void 0,s=r===null,u=r===r,l=vp(r);if(!s&&!l&&!a&&e>r||a&&o&&u&&!s&&!l||n&&o&&u||!t&&u||!i)return 1;if(!n&&!a&&!l&&e<r||l&&t&&i&&!n&&!a||s&&t&&i||!o&&i||!u)return-1}return 0}function Xpt(e,r,t){for(var n=-1,i=e.criteria,a=r.criteria,o=i.length,s=t.length;++n<o;){var u=Ece(i[n],a[n]);if(u){if(n>=s)return u;var l=t[n];return u*(l=="desc"?-1:1)}}return e.index-r.index}function Sce(e,r,t){r.length?r=Iu(r,function(a){return pa(a)?function(o){return F1(o,a.length===1?a[0]:a)}:a}):r=[Uf];var n=-1;r=Iu(r,Qp(da));var i=Xue(e,function(a,o,s){var u=Iu(r,function(l){return l(a)});return{criteria:u,index:++n,value:a}});return Wpt(i,function(a,o){return Xpt(a,o,t)})}function Ace(e,r,t,n){return e==null?[]:(pa(r)||(r=r==null?[]:[r]),t=n?void 0:t,pa(t)||(t=t==null?[]:[t]),Sce(e,r,t))}function ZN(e){return Ny(function(r){return r=Iu(r,Qp(da)),$a(function(t){var n=this;return e(r,function(i){return Kp(i,n,t)})})})}var Ypt=ZN(Iu),Tce=Ypt,Zpt=$a,qpt=Zpt,Kpt=Math.min,Qpt=qpt(function(e,r){r=r.length==1&&pa(r[0])?Iu(r[0],Qp(da)):Iu(vf(r,1),Qp(da));var t=r.length;return $a(function(n){for(var i=-1,a=Kpt(n.length,t);++i<a;)n[i]=r[i].call(this,n[i]);return Kp(e,this,n)})}),Mce=Qpt,Jpt=ZN(Due),Lce=Jpt,edt=ZN(bN),Ice=edt,tdt=9007199254740991,rdt=Math.floor;function p3(e,r){var t="";if(!e||r<1||r>tdt)return t;do r%2&&(t+=e),r=rdt(r/2),r&&(e+=e);while(r);return t}var ndt=SN("length"),idt=ndt,kce="\\ud800-\\udfff",adt="\\u0300-\\u036f",odt="\\ufe20-\\ufe2f",sdt="\\u20d0-\\u20ff",udt=adt+odt+sdt,ldt="\\ufe0e\\ufe0f",cdt="["+kce+"]",d3="["+udt+"]",v3="\\ud83c[\\udffb-\\udfff]",fdt="(?:"+d3+"|"+v3+")",Pce="[^"+kce+"]",Rce="(?:\\ud83c[\\udde6-\\uddff]){2}",Oce="[\\ud800-\\udbff][\\udc00-\\udfff]",hdt="\\u200d",Fce=fdt+"?",Dce="["+ldt+"]?",pdt="(?:"+hdt+"(?:"+[Pce,Rce,Oce].join("|")+")"+Dce+Fce+")*",ddt=Dce+Fce+pdt,vdt="(?:"+[Pce+d3+"?",d3,Rce,Oce,cdt].join("|")+")",bY=RegExp(v3+"(?="+v3+")|"+vdt+ddt,"g");function gdt(e){for(var r=bY.lastIndex=0;bY.test(e);)++r;return r}function cw(e){return sw(e)?gdt(e):idt(e)}var mdt=Math.ceil;function jL(e,r){r=r===void 0?" ":qp(r);var t=r.length;if(t<2)return t?p3(r,e):r;var n=p3(r,mdt(e/cw(r)));return sw(r)?T_(Qv(n),0,e).join(""):n.slice(0,e)}var ydt=Math.ceil,_dt=Math.floor;function Bce(e,r,t){e=as(e),r=wa(r);var n=r?cw(e):0;if(!r||n>=r)return e;var i=(r-n)/2;return jL(_dt(i),t)+e+jL(ydt(i),t)}function Nce(e,r,t){e=as(e),r=wa(r);var n=r?cw(e):0;return r&&n<r?e+jL(r-n,t):e}function zce(e,r,t){e=as(e),r=wa(r);var n=r?cw(e):0;return r&&n<r?jL(r-n,t)+e:e}var xdt=/^\s+/,bdt=Oc.parseInt;function $ce(e,r,t){return t||r==null?r=0:r&&(r=+r),bdt(as(e).replace(xdt,""),r||0)}var wdt=32,qN=$a(function(e,r){var t=f_(r,iw(qN));return Oy(e,wdt,void 0,r,t)});qN.placeholder={};var KN=qN,Cdt=64,QN=$a(function(e,r){var t=f_(r,iw(QN));return Oy(e,Cdt,void 0,r,t)});QN.placeholder={};var Uce=QN,Edt=iP(function(e,r,t){e[t?0:1].push(r)},function(){return[[],[]]}),Vce=Edt;function Sdt(e,r){return bce(e,r,function(t,n){return nP(e,n)})}var Adt=Ny(function(e,r){return e==null?{}:Sdt(e,r)}),Gce=Adt;function g3(e){for(var r,t=this;t instanceof Vk;){var n=Xoe(t);n.__index__=0,n.__values__=void 0,r?i.__wrapped__=n:r=n;var i=n;t=t.__wrapped__}return i.__wrapped__=e,r}function Hce(e){return function(r){return e==null?void 0:F1(e,r)}}function Tdt(e,r,t,n){for(var i=t-1,a=e.length;++i<a;)if(n(e[i],r))return i;return-1}var Mdt=Array.prototype,wY=Mdt.splice;function JN(e,r,t,n){var i=n?Tdt:nw,a=-1,o=r.length,s=e;for(e===r&&(r=fp(r)),t&&(s=Iu(e,Qp(t)));++a<o;)for(var u=0,l=r[a],f=t?t(l):l;(u=i(s,f,u,n))>-1;)s!==e&&wY.call(s,u,1),wY.call(e,u,1);return e}function e7(e,r){return e&&e.length&&r&&r.length?JN(e,r):e}var Ldt=$a(e7),jce=Ldt;function Wce(e,r,t){return e&&e.length&&r&&r.length?JN(e,r,da(t)):e}function Xce(e,r,t){return e&&e.length&&r&&r.length?JN(e,r,void 0,t):e}var Idt=Array.prototype,kdt=Idt.splice;function Yce(e,r){for(var t=e?r.length:0,n=t-1;t--;){var i=r[t];if(t==n||i!==a){var a=i;Ry(i)?kdt.call(e,i,1):XN(e,i)}}return e}var Pdt=Ny(function(e,r){var t=e==null?0:e.length,n=rN(e,r);return Yce(e,Iu(r,function(i){return Ry(i,t)?+i:i}).sort(Ece)),n}),Zce=Pdt,Rdt=Math.floor,Odt=Math.random;function t7(e,r){return e+Rdt(Odt()*(r-e+1))}var Fdt=parseFloat,Ddt=Math.min,Bdt=Math.random;function qce(e,r,t){if(t&&typeof t!="boolean"&&ch(e,r,t)&&(r=t=void 0),t===void 0&&(typeof r=="boolean"?(t=r,r=void 0):typeof e=="boolean"&&(t=e,e=void 0)),e===void 0&&r===void 0?(e=0,r=1):(e=Zg(e),r===void 0?(r=e,e=0):r=Zg(r)),e>r){var n=e;e=r,r=n}if(t||e%1||r%1){var i=Bdt();return Ddt(e+i*(r-e+Fdt("1e-"+((i+"").length-1))),r)}return t7(e,r)}var Ndt=Math.ceil,zdt=Math.max;function $dt(e,r,t,n){for(var i=-1,a=zdt(Ndt((r-e)/(t||1)),0),o=Array(a);a--;)o[n?a:++i]=e,e+=t;return o}function Kce(e){return function(r,t,n){return n&&typeof n!="number"&&ch(r,t,n)&&(t=n=void 0),r=Zg(r),t===void 0?(t=r,r=0):t=Zg(t),n=n===void 0?r<t?1:-1:Zg(n),$dt(r,t,n,e)}}var Udt=Kce(),Qce=Udt,Vdt=Kce(!0),Jce=Vdt,Gdt=256,Hdt=Ny(function(e,r){return Oy(e,Gdt,void 0,void 0,void 0,r)}),efe=Hdt;function tfe(e,r,t,n,i){return i(e,function(a,o,s){t=n?(n=!1,a):r(t,a,o,s)}),t}function rfe(e,r,t){var n=pa(e)?cN:tfe,i=arguments.length<3;return n(e,da(r),t,i,L_)}function jdt(e,r,t,n){var i=e==null?0:e.length;for(n&&i&&(t=e[--i]);i--;)t=r(t,e[i],i,e);return t}function nfe(e,r,t){var n=pa(e)?jdt:tfe,i=arguments.length<3;return n(e,da(r),t,i,Iue)}function ife(e,r){var t=pa(e)?M_:zue;return t(e,lw(da(r)))}function afe(e,r){var t=[];if(!(e&&e.length))return t;var n=-1,i=[],a=e.length;for(r=da(r);++n<a;){var o=e[n];r(o,n,e)&&(t.push(o),i.push(n))}return Yce(e,i),t}function ofe(e,r,t){return(t?ch(e,r,t):r===void 0)?r=1:r=wa(r),p3(as(e),r)}function sfe(){var e=arguments,r=as(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var Wdt="Expected a function";function ufe(e,r){if(typeof e!="function")throw new TypeError(Wdt);return r=r===void 0?r:wa(r),$a(e,r)}function lfe(e,r,t){r=S_(r,e);var n=-1,i=r.length;for(i||(i=1,e=void 0);++n<i;){var a=e==null?void 0:e[lm(r[n])];a===void 0&&(n=i,a=t),e=sm(a)?a.call(e):a}return e}var Xdt=Array.prototype,Ydt=Xdt.reverse;function WL(e){return e==null?e:Ydt.call(e)}var Zdt=dN("round"),cfe=Zdt;function ffe(e){var r=e.length;return r?e[t7(0,r-1)]:void 0}function qdt(e){return ffe(B1(e))}function hfe(e){var r=pa(e)?ffe:qdt;return r(e)}function pP(e,r){var t=-1,n=e.length,i=n-1;for(r=r===void 0?n:r;++t<r;){var a=t7(t,i),o=e[a];e[a]=e[t],e[t]=o}return e.length=r,e}function Kdt(e,r){return pP(fp(e),D1(r,0,e.length))}function Qdt(e,r){var t=B1(e);return pP(t,D1(r,0,t.length))}function pfe(e,r,t){(t?ch(e,r,t):r===void 0)?r=1:r=wa(r);var n=pa(e)?Kdt:Qdt;return n(e,r)}function dfe(e,r,t){return e==null?e:VS(e,r,t)}function vfe(e,r,t,n){return n=typeof n=="function"?n:void 0,e==null?e:VS(e,r,t,n)}function Jdt(e){return pP(fp(e))}function evt(e){return pP(B1(e))}function gfe(e){var r=pa(e)?Jdt:evt;return r(e)}var tvt="[object Map]",rvt="[object Set]";function mfe(e){if(e==null)return 0;if(vh(e))return $S(e)?cw(e):e.length;var r=Jg(e);return r==tvt||r==rvt?e.size:eN(e).length}function yfe(e,r,t){var n=e==null?0:e.length;return n?(t&&typeof t!="number"&&ch(e,r,t)?(r=0,t=n):(r=r==null?0:wa(r),t=t===void 0?n:wa(t)),Yd(e,r,t)):[]}var nvt=uw(function(e,r,t){return e+(t?"_":"")+r.toLowerCase()}),_fe=nvt;function ivt(e,r){var t;return L_(e,function(n,i,a){return t=r(n,i,a),!t}),!!t}function xfe(e,r,t){var n=pa(e)?bN:ivt;return t&&ch(e,r,t)&&(r=void 0),n(e,da(r))}var avt=$a(function(e,r){if(e==null)return[];var t=r.length;return t>1&&ch(e,r[0],r[1])?r=[]:t>2&&ch(r[0],r[1],r[2])&&(r=[r[0]]),Sce(e,vf(r,1),[])}),bfe=avt,ovt=4294967295,svt=ovt-1,uvt=Math.floor,lvt=Math.min;function r7(e,r,t,n){var i=0,a=e==null?0:e.length;if(a===0)return 0;r=t(r);for(var o=r!==r,s=r===null,u=vp(r),l=r===void 0;i<a;){var f=uvt((i+a)/2),h=t(e[f]),p=h!==void 0,v=h===null,m=h===h,x=vp(h);if(o)var E=n||m;else l?E=m&&(n||p):s?E=m&&p&&(n||!v):u?E=m&&p&&!v&&(n||!x):v||x?E=!1:E=n?h<=r:h<r;E?i=f+1:a=f}return lvt(a,svt)}var cvt=4294967295,fvt=cvt>>>1;function dP(e,r,t){var n=0,i=e==null?n:e.length;if(typeof r=="number"&&r===r&&i<=fvt){for(;n<i;){var a=n+i>>>1,o=e[a];o!==null&&!vp(o)&&(t?o<=r:o<r)?n=a+1:i=a}return i}return r7(e,r,Uf,t)}function wfe(e,r){return dP(e,r)}function Cfe(e,r,t){return r7(e,r,da(t))}function Efe(e,r){var t=e==null?0:e.length;if(t){var n=dP(e,r);if(n<t&&rv(e[n],r))return n}return-1}function Sfe(e,r){return dP(e,r,!0)}function Afe(e,r,t){return r7(e,r,da(t),!0)}function Tfe(e,r){var t=e==null?0:e.length;if(t){var n=dP(e,r,!0)-1;if(rv(e[n],r))return n}return-1}function Mfe(e,r){for(var t=-1,n=e.length,i=0,a=[];++t<n;){var o=e[t],s=r?r(o):o;if(!t||!rv(s,u)){var u=s;a[i++]=o===0?0:o}}return a}function Lfe(e){return e&&e.length?Mfe(e):[]}function Ife(e,r){return e&&e.length?Mfe(e,da(r)):[]}var hvt=4294967295;function kfe(e,r,t){return t&&typeof t!="number"&&ch(e,r,t)&&(r=t=void 0),t=t===void 0?hvt:t>>>0,t?(e=as(e),e&&(typeof r=="string"||r!=null&&!fP(r))&&(r=qp(r),!r&&sw(e))?T_(Qv(e),0,t):e.split(r,t)):[]}var pvt="Expected a function",dvt=Math.max;function Pfe(e,r){if(typeof e!="function")throw new TypeError(pvt);return r=r==null?0:dvt(wa(r),0),$a(function(t){var n=t[r],i=T_(t,0,r);return n&&A_(i,n),Kp(e,this,i)})}var vvt=uw(function(e,r,t){return e+(t?" ":"")+eP(r)}),Rfe=vvt;function Ofe(e,r,t){return e=as(e),t=t==null?0:D1(wa(t),0,e.length),r=qp(r),e.slice(t,t+r.length)==r}function Ffe(){return{}}function Dfe(){return""}function Bfe(){return!0}var gvt=Uk(function(e,r){return e-r},0),Nfe=gvt;function zfe(e){return e&&e.length?HN(e,Uf):0}function $fe(e,r){return e&&e.length?HN(e,da(r)):0}function Ufe(e){var r=e==null?0:e.length;return r?Yd(e,1,r):[]}function Vfe(e,r,t){return e&&e.length?(r=t||r===void 0?1:wa(r),Yd(e,0,r<0?0:r)):[]}function Gfe(e,r,t){var n=e==null?0:e.length;return n?(r=t||r===void 0?1:wa(r),r=n-r,Yd(e,r<0?0:r,n)):[]}function Hfe(e,r){return e&&e.length?uP(e,da(r),!1,!0):[]}function jfe(e,r){return e&&e.length?uP(e,da(r)):[]}function Wfe(e,r){return r(e),e}var Xfe=Object.prototype,mvt=Xfe.hasOwnProperty;function CY(e,r,t,n){return e===void 0||rv(e,Xfe[t])&&!mvt.call(n,t)?r:e}var yvt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function _vt(e){return"\\"+yvt[e]}var xvt=/<%=([\s\S]+?)%>/g,Yfe=xvt,bvt=/<%-([\s\S]+?)%>/g,wvt=bvt,Cvt=/<%([\s\S]+?)%>/g,Evt=Cvt,Svt={escape:wvt,evaluate:Evt,interpolate:Yfe,variable:"",imports:{_:{escape:RN}}},XL=Svt,Avt="Invalid `variable` option passed into `_.template`",Tvt=/\b__p \+= '';/g,Mvt=/\b(__p \+=) '' \+/g,Lvt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ivt=/[()=,{}\[\]\/\s]/,kvt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,VT=/($^)/,Pvt=/['\n\r\u2028\u2029\\]/g,Rvt=Object.prototype,EY=Rvt.hasOwnProperty;function Zfe(e,r,t){var n=XL.imports._.templateSettings||XL;t&&ch(e,r,t)&&(r=void 0),e=as(e),r=P2({},r,n,CY);var i=P2({},r.imports,n.imports,CY),a=Vl(i),o=NN(i,a),s,u,l=0,f=r.interpolate||VT,h="__p += '",p=RegExp((r.escape||VT).source+"|"+f.source+"|"+(f===Yfe?kvt:VT).source+"|"+(r.evaluate||VT).source+"|$","g"),v=EY.call(r,"sourceURL")?"//# sourceURL="+(r.sourceURL+"").replace(/\s/g," ")+`
`:"";e.replace(p,function(E,A,L,k,R,D){return L||(L=k),h+=e.slice(l,D).replace(Pvt,_vt),A&&(s=!0,h+=`' +
__e(`+A+`) +
'`),R&&(u=!0,h+=`';
`+R+`;
__p += '`),L&&(h+=`' +
((__t = (`+L+`)) == null ? '' : __t) +
'`),l=D+E.length,E}),h+=`';
`;var m=EY.call(r,"variable")&&r.variable;if(!m)h=`with (obj) {
`+h+`
}
`;else if(Ivt.test(m))throw new Error(Avt);h=(u?h.replace(Tvt,""):h).replace(Mvt,"$1").replace(Lvt,"$1;"),h="function("+(m||"obj")+`) {
`+(m?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(s?", __e = _.escape":"")+(u?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+h+`return __p
}`;var x=iN(function(){return Function(a,v+"return "+h).apply(void 0,o)});if(x.source=h,Jk(x))throw x;return x}var Ovt="Expected a function";function qfe(e,r,t){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(Ovt);return yu(t)&&(n="leading"in t?!!t.leading:n,i="trailing"in t?!!t.trailing:i),MN(e,r,{leading:n,maxWait:r,trailing:i})}function fw(e,r){return r(e)}var Fvt=9007199254740991,KO=4294967295,Dvt=Math.min;function Kfe(e,r){if(e=wa(e),e<1||e>Fvt)return[];var t=KO,n=Dvt(e,KO);r=fm(r),e-=KO;for(var i=J6(n,r);++t<e;)r(t);return i}function m3(){return this}function Qfe(e,r){var t=e;return t instanceof uo&&(t=t.value()),cN(r,function(n,i){return i.func.apply(i.thisArg,A_([n],i.args))},t)}function Nx(){return Qfe(this.__wrapped__,this.__actions__)}function Jfe(e){return as(e).toLowerCase()}function ehe(e){return pa(e)?Iu(e,lm):vp(e)?[e]:fp(sse(as(e)))}var SY=9007199254740991;function the(e){return e?D1(wa(e),-SY,SY):e===0?e:0}function rhe(e){return as(e).toUpperCase()}function nhe(e,r,t){var n=pa(e),i=n||Ly(e)||O1(e);if(r=da(r),t==null){var a=e&&e.constructor;i?t=n?new a:[]:yu(e)?t=sm(a)?rw(Qk(e)):{}:t={}}return(i?tv:cm)(e,function(o,s,u){return r(t,o,s,u)}),t}function ihe(e,r){for(var t=e.length;t--&&nw(r,e[t],0)>-1;);return t}function ahe(e,r){for(var t=-1,n=e.length;++t<n&&nw(r,e[t],0)>-1;);return t}function ohe(e,r,t){if(e=as(e),e&&(t||r===void 0))return Uoe(e);if(!e||!(r=qp(r)))return e;var n=Qv(e),i=Qv(r),a=ahe(n,i),o=ihe(n,i)+1;return T_(n,a,o).join("")}function she(e,r,t){if(e=as(e),e&&(t||r===void 0))return e.slice(0,$oe(e)+1);if(!e||!(r=qp(r)))return e;var n=Qv(e),i=ihe(n,Qv(r))+1;return T_(n,0,i).join("")}var Bvt=/^\s+/;function uhe(e,r,t){if(e=as(e),e&&(t||r===void 0))return e.replace(Bvt,"");if(!e||!(r=qp(r)))return e;var n=Qv(e),i=ahe(n,Qv(r));return T_(n,i).join("")}var Nvt=30,zvt="...",$vt=/\w*$/;function lhe(e,r){var t=Nvt,n=zvt;if(yu(r)){var i="separator"in r?r.separator:i;t="length"in r?wa(r.length):t,n="omission"in r?qp(r.omission):n}e=as(e);var a=e.length;if(sw(e)){var o=Qv(e);a=o.length}if(t>=a)return e;var s=t-cw(n);if(s<1)return n;var u=o?T_(o,0,s).join(""):e.slice(0,s);if(i===void 0)return u+n;if(o&&(s+=u.length-s),fP(i)){if(e.slice(s).search(i)){var l,f=u;for(i.global||(i=RegExp(i.source,as($vt.exec(i))+"g")),i.lastIndex=0;l=i.exec(f);)var h=l.index;u=u.slice(0,h===void 0?s:h)}}else if(e.indexOf(qp(i),s)!=s){var p=u.lastIndexOf(i);p>-1&&(u=u.slice(0,p))}return u+n}function che(e){return Q6(e,1)}var Uvt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Vvt=fN(Uvt),Gvt=Vvt,fhe=/&(?:amp|lt|gt|quot|#39);/g,Hvt=RegExp(fhe.source);function hhe(e){return e=as(e),e&&Hvt.test(e)?e.replace(fhe,Gvt):e}var jvt=1/0,Wvt=o2&&1/rP(new o2([,-0]))[1]==jvt?function(e){return new o2(e)}:Gk,Xvt=Wvt,Yvt=200;function p_(e,r,t){var n=-1,i=Wk,a=e.length,o=!0,s=[],u=s;if(t)o=!1,i=kN;else if(a>=Yvt){var l=r?null:Xvt(e);if(l)return rP(l);o=!1,i=oS,u=new h1}else u=r?[]:s;e:for(;++n<a;){var f=e[n],h=r?r(f):f;if(f=t||f!==0?f:0,o&&h===h){for(var p=u.length;p--;)if(u[p]===h)continue e;r&&u.push(h),s.push(f)}else i(u,h,t)||(u!==s&&u.push(h),s.push(f))}return s}var Zvt=$a(function(e){return p_(vf(e,1,ol,!0))}),phe=Zvt,qvt=$a(function(e){var r=gp(e);return ol(r)&&(r=void 0),p_(vf(e,1,ol,!0),da(r))}),dhe=qvt,Kvt=$a(function(e){var r=gp(e);return r=typeof r=="function"?r:void 0,p_(vf(e,1,ol,!0),void 0,r)}),vhe=Kvt;function ghe(e){return e&&e.length?p_(e):[]}function mhe(e,r){return e&&e.length?p_(e,da(r)):[]}function yhe(e,r){return r=typeof r=="function"?r:void 0,e&&e.length?p_(e,void 0,r):[]}var Qvt=0;function _he(e){var r=++Qvt;return as(e)+r}function xhe(e,r){return e==null?!0:XN(e,r)}var Jvt=Math.max;function vP(e){if(!(e&&e.length))return[];var r=0;return e=M_(e,function(t){if(ol(t))return r=Jvt(t.length,r),!0}),J6(r,function(t){return Iu(e,SN(t))})}function n7(e,r){if(!(e&&e.length))return[];var t=vP(e);return r==null?t:Iu(t,function(n){return Kp(r,void 0,n)})}function bhe(e,r,t,n){return VS(e,r,t(F1(e,r)),n)}function whe(e,r,t){return e==null?e:bhe(e,r,fm(t))}function Che(e,r,t,n){return n=typeof n=="function"?n:void 0,e==null?e:bhe(e,r,fm(t),n)}var egt=uw(function(e,r,t){return e+(t?" ":"")+r.toUpperCase()}),Ehe=egt;function She(e){return e==null?[]:NN(e,gh(e))}var tgt=$a(function(e,r){return ol(e)?NS(e,r):[]}),Ahe=tgt;function The(e,r){return KN(fm(r),e)}var rgt=Ny(function(e){var r=e.length,t=r?e[0]:0,n=this.__wrapped__,i=function(a){return rN(a,e)};return r>1||this.__actions__.length||!(n instanceof uo)||!Ry(t)?this.thru(i):(n=n.slice(t,+t+(r?1:0)),n.__actions__.push({func:fw,args:[i],thisArg:void 0}),new Wd(n,this.__chain__).thru(function(a){return r&&!a.length&&a.push(void 0),a}))}),Mhe=rgt;function Lhe(){return vN(this)}function Ihe(){var e=this.__wrapped__;if(e instanceof uo){var r=e;return this.__actions__.length&&(r=new uo(this)),r=r.reverse(),r.__actions__.push({func:fw,args:[WL],thisArg:void 0}),new Wd(r,this.__chain__)}return this.thru(WL)}function i7(e,r,t){var n=e.length;if(n<2)return n?p_(e[0]):[];for(var i=-1,a=Array(n);++i<n;)for(var o=e[i],s=-1;++s<n;)s!=i&&(a[i]=NS(a[i]||o,e[s],r,t));return p_(vf(a,1),r,t)}var ngt=$a(function(e){return i7(M_(e,ol))}),khe=ngt,igt=$a(function(e){var r=gp(e);return ol(r)&&(r=void 0),i7(M_(e,ol),da(r))}),Phe=igt,agt=$a(function(e){var r=gp(e);return r=typeof r=="function"?r:void 0,i7(M_(e,ol),void 0,r)}),Rhe=agt,ogt=$a(vP),Ohe=ogt;function Fhe(e,r,t){for(var n=-1,i=e.length,a=r.length,o={};++n<i;){var s=n<a?r[n]:void 0;t(o,e[n],s)}return o}function Dhe(e,r){return Fhe(e||[],r||[],RS)}function Bhe(e,r){return Fhe(e||[],r||[],VS)}var sgt=$a(function(e){var r=e.length,t=r>1?e[r-1]:void 0;return t=typeof t=="function"?(e.pop(),t):void 0,n7(e,t)}),Nhe=sgt,ui={chunk:Fse,compact:Kse,concat:Qse,difference:bue,differenceBy:wue,differenceWith:Cue,drop:Sue,dropRight:Aue,dropRightWhile:Tue,dropWhile:Mue,fill:Nue,findIndex:FN,findLastIndex:DN,first:HL,flatten:nN,flattenDeep:Kue,flattenDepth:Que,fromPairs:ule,head:HL,indexOf:mle,initial:yle,intersection:_le,intersectionBy:xle,intersectionWith:ble,join:Yle,last:gp,lastIndexOf:Kle,nth:yce,pull:jce,pullAll:e7,pullAllBy:Wce,pullAllWith:Xce,pullAt:Zce,remove:afe,reverse:WL,slice:yfe,sortedIndex:wfe,sortedIndexBy:Cfe,sortedIndexOf:Efe,sortedLastIndex:Sfe,sortedLastIndexBy:Afe,sortedLastIndexOf:Tfe,sortedUniq:Lfe,sortedUniqBy:Ife,tail:Ufe,take:Vfe,takeRight:Gfe,takeRightWhile:Hfe,takeWhile:jfe,union:phe,unionBy:dhe,unionWith:vhe,uniq:ghe,uniqBy:mhe,uniqWith:yhe,unzip:vP,unzipWith:n7,without:Ahe,xor:khe,xorBy:Phe,xorWith:Rhe,zip:Ohe,zipObject:Dhe,zipObjectDeep:Bhe,zipWith:Nhe},Rs={countBy:fue,each:$L,eachRight:UL,every:Bue,filter:$ue,find:Vue,findLast:jue,flatMap:Yue,flatMapDeep:Zue,flatMapDepth:que,forEach:$L,forEachRight:UL,groupBy:fle,includes:gle,invokeMap:Mle,keyBy:qle,map:zS,orderBy:Ace,partition:Vce,reduce:rfe,reduceRight:nfe,reject:ife,sample:hfe,sampleSize:pfe,shuffle:gfe,size:mfe,some:xfe,sortBy:bfe},ugt={now:JC},ul={after:Voe,ary:Q6,before:aN,bind:sN,bindKey:fse,curry:aP,curryRight:oP,debounce:MN,defer:_ue,delay:xue,flip:Jue,memoize:DS,negate:lw,once:Cce,overArgs:Mce,partial:KN,partialRight:Uce,rearg:efe,rest:ufe,spread:Pfe,throttle:qfe,unary:che,wrap:The},Bi={castArray:Rse,clone:Xse,cloneDeep:Yse,cloneDeepWith:Zse,cloneWith:qse,conformsTo:uue,eq:rv,gt:hle,gte:ple,isArguments:h_,isArray:pa,isArrayBuffer:Lle,isArrayLike:vh,isArrayLikeObject:ol,isBoolean:Ile,isBuffer:Ly,isDate:kle,isElement:Ple,isEmpty:Rle,isEqual:Ole,isEqualWith:Fle,isError:Jk,isFinite:Dle,isFunction:sm,isInteger:UN,isLength:OS,isMap:_N,isMatch:Ble,isMatchWith:Nle,isNaN:zle,isNative:$le,isNil:Ule,isNull:Vle,isNumber:VN,isObject:yu,isObjectLike:ju,isPlainObject:ow,isRegExp:fP,isSafeInteger:Gle,isSet:xN,isString:$S,isSymbol:vp,isTypedArray:O1,isUndefined:Hle,isWeakMap:jle,isWeakSet:Wle,lt:ece,lte:tce,toArray:WN,toFinite:Zg,toInteger:wa,toLength:ON,toNumber:Zp,toPlainObject:LN,toSafeInteger:the,toString:as},mh={add:zoe,ceil:Ose,divide:Eue,floor:ele,max:oce,maxBy:sce,mean:lce,meanBy:cce,min:dce,minBy:vce,multiply:gce,round:cfe,subtract:Nfe,sum:zfe,sumBy:$fe},a7={clamp:Dse,inRange:vle,random:qce},la={assign:ase,assignIn:NL,assignInWith:P2,assignWith:ose,at:use,create:hue,defaults:vue,defaultsDeep:mue,entries:VL,entriesIn:GL,extend:NL,extendWith:P2,findKey:Hue,findLastKey:Wue,forIn:ile,forInRight:ale,forOwn:ole,forOwnRight:sle,functions:lle,functionsIn:cle,get:Kk,has:dle,hasIn:nP,invert:Cle,invertBy:Sle,invoke:Tle,keys:Vl,keysIn:gh,mapKeys:rce,mapValues:nce,merge:fce,mergeWith:IN,omit:xce,omitBy:wce,pick:Gce,pickBy:YN,result:lfe,set:dfe,setWith:vfe,toPairs:VL,toPairsIn:GL,transform:nhe,unset:xhe,update:whe,updateWith:Che,values:B1,valuesIn:She},hm={at:Mhe,chain:vN,commit:l3,lodash:Ae,next:h3,plant:g3,reverse:Ihe,tap:Wfe,thru:fw,toIterator:m3,toJSON:Nx,value:Nx,valueOf:Nx,wrapperChain:Lhe},ss={camelCase:Pse,capitalize:lN,deburr:hN,endsWith:kue,escape:RN,escapeRegExp:Fue,kebabCase:Zle,lowerCase:Qle,lowerFirst:Jle,pad:Bce,padEnd:Nce,padStart:zce,parseInt:$ce,repeat:ofe,replace:sfe,snakeCase:_fe,split:kfe,startCase:Rfe,startsWith:Ofe,template:Zfe,templateSettings:XL,toLower:Jfe,toUpper:rhe,trim:ohe,trimEnd:she,trimStart:uhe,truncate:lhe,unescape:hhe,upperCase:Ehe,upperFirst:eP,words:pN},fs={attempt:iN,bindAll:cse,cond:aue,conforms:sue,constant:Hk,defaultTo:pue,flow:rle,flowRight:nle,identity:Uf,iteratee:Xle,matches:ice,matchesProperty:ace,method:hce,methodOf:pce,mixin:jN,noop:Gk,nthArg:_ce,over:Tce,overEvery:Lce,overSome:Ice,property:AN,propertyOf:Hce,range:Qce,rangeRight:Jce,stubArray:tP,stubFalse:Yk,stubObject:Ffe,stubString:Dfe,stubTrue:Bfe,times:Kfe,toPath:ehe,uniqueId:_he};function lgt(){var e=new uo(this.__wrapped__);return e.__actions__=fp(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=fp(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=fp(this.__views__),e}function cgt(){if(this.__filtered__){var e=new uo(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}var fgt=Math.max,hgt=Math.min;function pgt(e,r,t){for(var n=-1,i=t.length;++n<i;){var a=t[n],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":r-=o;break;case"take":r=hgt(r,e+o);break;case"takeRight":e=fgt(e,r-o);break}}return{start:e,end:r}}var dgt=1,vgt=2,ggt=Math.min;function mgt(){var e=this.__wrapped__.value(),r=this.__dir__,t=pa(e),n=r<0,i=t?e.length:0,a=pgt(0,i,this.__views__),o=a.start,s=a.end,u=s-o,l=n?s:o-1,f=this.__iteratees__,h=f.length,p=0,v=ggt(u,this.__takeCount__);if(!t||!n&&i==u&&v==u)return Qfe(e,this.__actions__);var m=[];e:for(;u--&&p<v;){l+=r;for(var x=-1,E=e[l];++x<h;){var A=f[x],L=A.iteratee,k=A.type,R=L(E);if(k==vgt)E=R;else if(!R){if(k==dgt)continue e;break e}}m[p++]=E}return m}/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var ygt="4.17.21",_gt=2,xgt=1,bgt=3,zhe=4294967295,wgt=Array.prototype,Cgt=Object.prototype,$he=Cgt.hasOwnProperty,AY=Nf?Nf.iterator:void 0,Egt=Math.max,TY=Math.min,o7=function(e){return function(r,t,n){if(n==null){var i=yu(t),a=i&&Vl(t),o=a&&a.length&&lP(t,a);(o?o.length:i)||(n=t,t=r,r=this)}return e(r,t,n)}}(jN);Ae.after=ul.after;Ae.ary=ul.ary;Ae.assign=la.assign;Ae.assignIn=la.assignIn;Ae.assignInWith=la.assignInWith;Ae.assignWith=la.assignWith;Ae.at=la.at;Ae.before=ul.before;Ae.bind=ul.bind;Ae.bindAll=fs.bindAll;Ae.bindKey=ul.bindKey;Ae.castArray=Bi.castArray;Ae.chain=hm.chain;Ae.chunk=ui.chunk;Ae.compact=ui.compact;Ae.concat=ui.concat;Ae.cond=fs.cond;Ae.conforms=fs.conforms;Ae.constant=fs.constant;Ae.countBy=Rs.countBy;Ae.create=la.create;Ae.curry=ul.curry;Ae.curryRight=ul.curryRight;Ae.debounce=ul.debounce;Ae.defaults=la.defaults;Ae.defaultsDeep=la.defaultsDeep;Ae.defer=ul.defer;Ae.delay=ul.delay;Ae.difference=ui.difference;Ae.differenceBy=ui.differenceBy;Ae.differenceWith=ui.differenceWith;Ae.drop=ui.drop;Ae.dropRight=ui.dropRight;Ae.dropRightWhile=ui.dropRightWhile;Ae.dropWhile=ui.dropWhile;Ae.fill=ui.fill;Ae.filter=Rs.filter;Ae.flatMap=Rs.flatMap;Ae.flatMapDeep=Rs.flatMapDeep;Ae.flatMapDepth=Rs.flatMapDepth;Ae.flatten=ui.flatten;Ae.flattenDeep=ui.flattenDeep;Ae.flattenDepth=ui.flattenDepth;Ae.flip=ul.flip;Ae.flow=fs.flow;Ae.flowRight=fs.flowRight;Ae.fromPairs=ui.fromPairs;Ae.functions=la.functions;Ae.functionsIn=la.functionsIn;Ae.groupBy=Rs.groupBy;Ae.initial=ui.initial;Ae.intersection=ui.intersection;Ae.intersectionBy=ui.intersectionBy;Ae.intersectionWith=ui.intersectionWith;Ae.invert=la.invert;Ae.invertBy=la.invertBy;Ae.invokeMap=Rs.invokeMap;Ae.iteratee=fs.iteratee;Ae.keyBy=Rs.keyBy;Ae.keys=Vl;Ae.keysIn=la.keysIn;Ae.map=Rs.map;Ae.mapKeys=la.mapKeys;Ae.mapValues=la.mapValues;Ae.matches=fs.matches;Ae.matchesProperty=fs.matchesProperty;Ae.memoize=ul.memoize;Ae.merge=la.merge;Ae.mergeWith=la.mergeWith;Ae.method=fs.method;Ae.methodOf=fs.methodOf;Ae.mixin=o7;Ae.negate=lw;Ae.nthArg=fs.nthArg;Ae.omit=la.omit;Ae.omitBy=la.omitBy;Ae.once=ul.once;Ae.orderBy=Rs.orderBy;Ae.over=fs.over;Ae.overArgs=ul.overArgs;Ae.overEvery=fs.overEvery;Ae.overSome=fs.overSome;Ae.partial=ul.partial;Ae.partialRight=ul.partialRight;Ae.partition=Rs.partition;Ae.pick=la.pick;Ae.pickBy=la.pickBy;Ae.property=fs.property;Ae.propertyOf=fs.propertyOf;Ae.pull=ui.pull;Ae.pullAll=ui.pullAll;Ae.pullAllBy=ui.pullAllBy;Ae.pullAllWith=ui.pullAllWith;Ae.pullAt=ui.pullAt;Ae.range=fs.range;Ae.rangeRight=fs.rangeRight;Ae.rearg=ul.rearg;Ae.reject=Rs.reject;Ae.remove=ui.remove;Ae.rest=ul.rest;Ae.reverse=ui.reverse;Ae.sampleSize=Rs.sampleSize;Ae.set=la.set;Ae.setWith=la.setWith;Ae.shuffle=Rs.shuffle;Ae.slice=ui.slice;Ae.sortBy=Rs.sortBy;Ae.sortedUniq=ui.sortedUniq;Ae.sortedUniqBy=ui.sortedUniqBy;Ae.split=ss.split;Ae.spread=ul.spread;Ae.tail=ui.tail;Ae.take=ui.take;Ae.takeRight=ui.takeRight;Ae.takeRightWhile=ui.takeRightWhile;Ae.takeWhile=ui.takeWhile;Ae.tap=hm.tap;Ae.throttle=ul.throttle;Ae.thru=fw;Ae.toArray=Bi.toArray;Ae.toPairs=la.toPairs;Ae.toPairsIn=la.toPairsIn;Ae.toPath=fs.toPath;Ae.toPlainObject=Bi.toPlainObject;Ae.transform=la.transform;Ae.unary=ul.unary;Ae.union=ui.union;Ae.unionBy=ui.unionBy;Ae.unionWith=ui.unionWith;Ae.uniq=ui.uniq;Ae.uniqBy=ui.uniqBy;Ae.uniqWith=ui.uniqWith;Ae.unset=la.unset;Ae.unzip=ui.unzip;Ae.unzipWith=ui.unzipWith;Ae.update=la.update;Ae.updateWith=la.updateWith;Ae.values=la.values;Ae.valuesIn=la.valuesIn;Ae.without=ui.without;Ae.words=ss.words;Ae.wrap=ul.wrap;Ae.xor=ui.xor;Ae.xorBy=ui.xorBy;Ae.xorWith=ui.xorWith;Ae.zip=ui.zip;Ae.zipObject=ui.zipObject;Ae.zipObjectDeep=ui.zipObjectDeep;Ae.zipWith=ui.zipWith;Ae.entries=la.toPairs;Ae.entriesIn=la.toPairsIn;Ae.extend=la.assignIn;Ae.extendWith=la.assignInWith;o7(Ae,Ae);Ae.add=mh.add;Ae.attempt=fs.attempt;Ae.camelCase=ss.camelCase;Ae.capitalize=ss.capitalize;Ae.ceil=mh.ceil;Ae.clamp=a7.clamp;Ae.clone=Bi.clone;Ae.cloneDeep=Bi.cloneDeep;Ae.cloneDeepWith=Bi.cloneDeepWith;Ae.cloneWith=Bi.cloneWith;Ae.conformsTo=Bi.conformsTo;Ae.deburr=ss.deburr;Ae.defaultTo=fs.defaultTo;Ae.divide=mh.divide;Ae.endsWith=ss.endsWith;Ae.eq=Bi.eq;Ae.escape=ss.escape;Ae.escapeRegExp=ss.escapeRegExp;Ae.every=Rs.every;Ae.find=Rs.find;Ae.findIndex=ui.findIndex;Ae.findKey=la.findKey;Ae.findLast=Rs.findLast;Ae.findLastIndex=ui.findLastIndex;Ae.findLastKey=la.findLastKey;Ae.floor=mh.floor;Ae.forEach=Rs.forEach;Ae.forEachRight=Rs.forEachRight;Ae.forIn=la.forIn;Ae.forInRight=la.forInRight;Ae.forOwn=la.forOwn;Ae.forOwnRight=la.forOwnRight;Ae.get=la.get;Ae.gt=Bi.gt;Ae.gte=Bi.gte;Ae.has=la.has;Ae.hasIn=la.hasIn;Ae.head=ui.head;Ae.identity=Uf;Ae.includes=Rs.includes;Ae.indexOf=ui.indexOf;Ae.inRange=a7.inRange;Ae.invoke=la.invoke;Ae.isArguments=Bi.isArguments;Ae.isArray=pa;Ae.isArrayBuffer=Bi.isArrayBuffer;Ae.isArrayLike=Bi.isArrayLike;Ae.isArrayLikeObject=Bi.isArrayLikeObject;Ae.isBoolean=Bi.isBoolean;Ae.isBuffer=Bi.isBuffer;Ae.isDate=Bi.isDate;Ae.isElement=Bi.isElement;Ae.isEmpty=Bi.isEmpty;Ae.isEqual=Bi.isEqual;Ae.isEqualWith=Bi.isEqualWith;Ae.isError=Bi.isError;Ae.isFinite=Bi.isFinite;Ae.isFunction=Bi.isFunction;Ae.isInteger=Bi.isInteger;Ae.isLength=Bi.isLength;Ae.isMap=Bi.isMap;Ae.isMatch=Bi.isMatch;Ae.isMatchWith=Bi.isMatchWith;Ae.isNaN=Bi.isNaN;Ae.isNative=Bi.isNative;Ae.isNil=Bi.isNil;Ae.isNull=Bi.isNull;Ae.isNumber=Bi.isNumber;Ae.isObject=yu;Ae.isObjectLike=Bi.isObjectLike;Ae.isPlainObject=Bi.isPlainObject;Ae.isRegExp=Bi.isRegExp;Ae.isSafeInteger=Bi.isSafeInteger;Ae.isSet=Bi.isSet;Ae.isString=Bi.isString;Ae.isSymbol=Bi.isSymbol;Ae.isTypedArray=Bi.isTypedArray;Ae.isUndefined=Bi.isUndefined;Ae.isWeakMap=Bi.isWeakMap;Ae.isWeakSet=Bi.isWeakSet;Ae.join=ui.join;Ae.kebabCase=ss.kebabCase;Ae.last=gp;Ae.lastIndexOf=ui.lastIndexOf;Ae.lowerCase=ss.lowerCase;Ae.lowerFirst=ss.lowerFirst;Ae.lt=Bi.lt;Ae.lte=Bi.lte;Ae.max=mh.max;Ae.maxBy=mh.maxBy;Ae.mean=mh.mean;Ae.meanBy=mh.meanBy;Ae.min=mh.min;Ae.minBy=mh.minBy;Ae.stubArray=fs.stubArray;Ae.stubFalse=fs.stubFalse;Ae.stubObject=fs.stubObject;Ae.stubString=fs.stubString;Ae.stubTrue=fs.stubTrue;Ae.multiply=mh.multiply;Ae.nth=ui.nth;Ae.noop=fs.noop;Ae.now=ugt.now;Ae.pad=ss.pad;Ae.padEnd=ss.padEnd;Ae.padStart=ss.padStart;Ae.parseInt=ss.parseInt;Ae.random=a7.random;Ae.reduce=Rs.reduce;Ae.reduceRight=Rs.reduceRight;Ae.repeat=ss.repeat;Ae.replace=ss.replace;Ae.result=la.result;Ae.round=mh.round;Ae.sample=Rs.sample;Ae.size=Rs.size;Ae.snakeCase=ss.snakeCase;Ae.some=Rs.some;Ae.sortedIndex=ui.sortedIndex;Ae.sortedIndexBy=ui.sortedIndexBy;Ae.sortedIndexOf=ui.sortedIndexOf;Ae.sortedLastIndex=ui.sortedLastIndex;Ae.sortedLastIndexBy=ui.sortedLastIndexBy;Ae.sortedLastIndexOf=ui.sortedLastIndexOf;Ae.startCase=ss.startCase;Ae.startsWith=ss.startsWith;Ae.subtract=mh.subtract;Ae.sum=mh.sum;Ae.sumBy=mh.sumBy;Ae.template=ss.template;Ae.times=fs.times;Ae.toFinite=Bi.toFinite;Ae.toInteger=wa;Ae.toLength=Bi.toLength;Ae.toLower=ss.toLower;Ae.toNumber=Bi.toNumber;Ae.toSafeInteger=Bi.toSafeInteger;Ae.toString=Bi.toString;Ae.toUpper=ss.toUpper;Ae.trim=ss.trim;Ae.trimEnd=ss.trimEnd;Ae.trimStart=ss.trimStart;Ae.truncate=ss.truncate;Ae.unescape=ss.unescape;Ae.uniqueId=fs.uniqueId;Ae.upperCase=ss.upperCase;Ae.upperFirst=ss.upperFirst;Ae.each=Rs.forEach;Ae.eachRight=Rs.forEachRight;Ae.first=ui.head;o7(Ae,function(){var e={};return cm(Ae,function(r,t){$he.call(Ae.prototype,t)||(e[t]=r)}),e}(),{chain:!1});Ae.VERSION=ygt;(Ae.templateSettings=ss.templateSettings).imports._=Ae;tv(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){Ae[e].placeholder=Ae});tv(["drop","take"],function(e,r){uo.prototype[e]=function(t){t=t===void 0?1:Egt(wa(t),0);var n=this.__filtered__&&!r?new uo(this):this.clone();return n.__filtered__?n.__takeCount__=TY(t,n.__takeCount__):n.__views__.push({size:TY(t,zhe),type:e+(n.__dir__<0?"Right":"")}),n},uo.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}});tv(["filter","map","takeWhile"],function(e,r){var t=r+1,n=t==xgt||t==bgt;uo.prototype[e]=function(i){var a=this.clone();return a.__iteratees__.push({iteratee:da(i),type:t}),a.__filtered__=a.__filtered__||n,a}});tv(["head","last"],function(e,r){var t="take"+(r?"Right":"");uo.prototype[e]=function(){return this[t](1).value()[0]}});tv(["initial","tail"],function(e,r){var t="drop"+(r?"":"Right");uo.prototype[e]=function(){return this.__filtered__?new uo(this):this[t](1)}});uo.prototype.compact=function(){return this.filter(Uf)};uo.prototype.find=function(e){return this.filter(e).head()};uo.prototype.findLast=function(e){return this.reverse().find(e)};uo.prototype.invokeMap=$a(function(e,r){return typeof e=="function"?new uo(this):this.map(function(t){return US(t,e,r)})});uo.prototype.reject=function(e){return this.filter(lw(da(e)))};uo.prototype.slice=function(e,r){e=wa(e);var t=this;return t.__filtered__&&(e>0||r<0)?new uo(t):(e<0?t=t.takeRight(-e):e&&(t=t.drop(e)),r!==void 0&&(r=wa(r),t=r<0?t.dropRight(-r):t.take(r-e)),t)};uo.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()};uo.prototype.toArray=function(){return this.take(zhe)};cm(uo.prototype,function(e,r){var t=/^(?:filter|find|map|reject)|While$/.test(r),n=/^(?:head|last)$/.test(r),i=Ae[n?"take"+(r=="last"?"Right":""):r],a=n||/^find/.test(r);!i||(Ae.prototype[r]=function(){var o=this.__wrapped__,s=n?[1]:arguments,u=o instanceof uo,l=s[0],f=u||pa(o),h=function(A){var L=i.apply(Ae,A_([A],s));return n&&p?L[0]:L};f&&t&&typeof l=="function"&&l.length!=1&&(u=f=!1);var p=this.__chain__,v=!!this.__actions__.length,m=a&&!p,x=u&&!v;if(!a&&f){o=x?o:new uo(this);var E=e.apply(o,s);return E.__actions__.push({func:fw,args:[h],thisArg:void 0}),new Wd(E,p)}return m&&x?e.apply(this,s):(E=this.thru(h),m?n?E.value()[0]:E.value():E)})});tv(["pop","push","shift","sort","splice","unshift"],function(e){var r=wgt[e],t=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);Ae.prototype[e]=function(){var i=arguments;if(n&&!this.__chain__){var a=this.value();return r.apply(pa(a)?a:[],i)}return this[t](function(o){return r.apply(pa(o)?o:[],i)})}});cm(uo.prototype,function(e,r){var t=Ae[r];if(t){var n=t.name+"";$he.call(a2,n)||(a2[n]=[]),a2[n].push({name:r,func:t})}});a2[Xk(void 0,_gt).name]=[{name:"wrapper",func:void 0}];uo.prototype.clone=lgt;uo.prototype.reverse=cgt;uo.prototype.value=mgt;Ae.prototype.at=hm.at;Ae.prototype.chain=hm.wrapperChain;Ae.prototype.commit=hm.commit;Ae.prototype.next=hm.next;Ae.prototype.plant=hm.plant;Ae.prototype.reverse=hm.reverse;Ae.prototype.toJSON=Ae.prototype.valueOf=Ae.prototype.value=hm.value;Ae.prototype.first=Ae.prototype.head;AY&&(Ae.prototype[AY]=hm.toIterator);/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Sgt=Object.freeze(Object.defineProperty({__proto__:null,add:zoe,after:Voe,ary:Q6,assign:ase,assignIn:NL,assignInWith:P2,assignWith:ose,at:use,attempt:iN,before:aN,bind:sN,bindAll:cse,bindKey:fse,camelCase:Pse,capitalize:lN,castArray:Rse,ceil:Ose,chain:vN,chunk:Fse,clamp:Dse,clone:Xse,cloneDeep:Yse,cloneDeepWith:Zse,cloneWith:qse,commit:l3,compact:Kse,concat:Qse,cond:aue,conforms:sue,conformsTo:uue,constant:Hk,countBy:fue,create:hue,curry:aP,curryRight:oP,debounce:MN,deburr:hN,defaultTo:pue,defaults:vue,defaultsDeep:mue,defer:_ue,delay:xue,difference:bue,differenceBy:wue,differenceWith:Cue,divide:Eue,drop:Sue,dropRight:Aue,dropRightWhile:Tue,dropWhile:Mue,each:$L,eachRight:UL,endsWith:kue,entries:VL,entriesIn:GL,eq:rv,escape:RN,escapeRegExp:Fue,every:Bue,extend:NL,extendWith:P2,fill:Nue,filter:$ue,find:Vue,findIndex:FN,findKey:Hue,findLast:jue,findLastIndex:DN,findLastKey:Wue,first:HL,flatMap:Yue,flatMapDeep:Zue,flatMapDepth:que,flatten:nN,flattenDeep:Kue,flattenDepth:Que,flip:Jue,floor:ele,flow:rle,flowRight:nle,forEach:$L,forEachRight:UL,forIn:ile,forInRight:ale,forOwn:ole,forOwnRight:sle,fromPairs:ule,functions:lle,functionsIn:cle,get:Kk,groupBy:fle,gt:hle,gte:ple,has:dle,hasIn:nP,head:HL,identity:Uf,inRange:vle,includes:gle,indexOf:mle,initial:yle,intersection:_le,intersectionBy:xle,intersectionWith:ble,invert:Cle,invertBy:Sle,invoke:Tle,invokeMap:Mle,isArguments:h_,isArray:pa,isArrayBuffer:Lle,isArrayLike:vh,isArrayLikeObject:ol,isBoolean:Ile,isBuffer:Ly,isDate:kle,isElement:Ple,isEmpty:Rle,isEqual:Ole,isEqualWith:Fle,isError:Jk,isFinite:Dle,isFunction:sm,isInteger:UN,isLength:OS,isMap:_N,isMatch:Ble,isMatchWith:Nle,isNaN:zle,isNative:$le,isNil:Ule,isNull:Vle,isNumber:VN,isObject:yu,isObjectLike:ju,isPlainObject:ow,isRegExp:fP,isSafeInteger:Gle,isSet:xN,isString:$S,isSymbol:vp,isTypedArray:O1,isUndefined:Hle,isWeakMap:jle,isWeakSet:Wle,iteratee:Xle,join:Yle,kebabCase:Zle,keyBy:qle,keys:Vl,keysIn:gh,last:gp,lastIndexOf:Kle,lodash:Ae,lowerCase:Qle,lowerFirst:Jle,lt:ece,lte:tce,map:zS,mapKeys:rce,mapValues:nce,matches:ice,matchesProperty:ace,max:oce,maxBy:sce,mean:lce,meanBy:cce,memoize:DS,merge:fce,mergeWith:IN,method:hce,methodOf:pce,min:dce,minBy:vce,mixin:jN,multiply:gce,negate:lw,next:h3,noop:Gk,now:JC,nth:yce,nthArg:_ce,omit:xce,omitBy:wce,once:Cce,orderBy:Ace,over:Tce,overArgs:Mce,overEvery:Lce,overSome:Ice,pad:Bce,padEnd:Nce,padStart:zce,parseInt:$ce,partial:KN,partialRight:Uce,partition:Vce,pick:Gce,pickBy:YN,plant:g3,property:AN,propertyOf:Hce,pull:jce,pullAll:e7,pullAllBy:Wce,pullAllWith:Xce,pullAt:Zce,random:qce,range:Qce,rangeRight:Jce,rearg:efe,reduce:rfe,reduceRight:nfe,reject:ife,remove:afe,repeat:ofe,replace:sfe,rest:ufe,result:lfe,reverse:WL,round:cfe,sample:hfe,sampleSize:pfe,set:dfe,setWith:vfe,shuffle:gfe,size:mfe,slice:yfe,snakeCase:_fe,some:xfe,sortBy:bfe,sortedIndex:wfe,sortedIndexBy:Cfe,sortedIndexOf:Efe,sortedLastIndex:Sfe,sortedLastIndexBy:Afe,sortedLastIndexOf:Tfe,sortedUniq:Lfe,sortedUniqBy:Ife,split:kfe,spread:Pfe,startCase:Rfe,startsWith:Ofe,stubArray:tP,stubFalse:Yk,stubObject:Ffe,stubString:Dfe,stubTrue:Bfe,subtract:Nfe,sum:zfe,sumBy:$fe,tail:Ufe,take:Vfe,takeRight:Gfe,takeRightWhile:Hfe,takeWhile:jfe,tap:Wfe,template:Zfe,templateSettings:XL,throttle:qfe,thru:fw,times:Kfe,toArray:WN,toFinite:Zg,toInteger:wa,toIterator:m3,toJSON:Nx,toLength:ON,toLower:Jfe,toNumber:Zp,toPairs:VL,toPairsIn:GL,toPath:ehe,toPlainObject:LN,toSafeInteger:the,toString:as,toUpper:rhe,transform:nhe,trim:ohe,trimEnd:she,trimStart:uhe,truncate:lhe,unary:che,unescape:hhe,union:phe,unionBy:dhe,unionWith:vhe,uniq:ghe,uniqBy:mhe,uniqWith:yhe,uniqueId:_he,unset:xhe,unzip:vP,unzipWith:n7,update:whe,updateWith:Che,upperCase:Ehe,upperFirst:eP,value:Nx,valueOf:Nx,values:B1,valuesIn:She,without:Ahe,words:pN,wrap:The,wrapperAt:Mhe,wrapperChain:Lhe,wrapperCommit:l3,wrapperLodash:Ae,wrapperNext:h3,wrapperPlant:g3,wrapperReverse:Ihe,wrapperToIterator:m3,wrapperValue:Nx,xor:khe,xorBy:Phe,xorWith:Rhe,zip:Ohe,zipObject:Dhe,zipObjectDeep:Bhe,zipWith:Nhe,default:Ae},Symbol.toStringTag,{value:"Module"})),Uhe=ed(Sgt),ll={},gP={};Object.defineProperty(gP,"__esModule",{value:!0});gP.deepAssign=void 0;var Agt=5,Tgt=new Object().toString,Vhe=function(e,r){return Tgt.call(e)==="[object "+r+"]"},Mgt=function(e){return Vhe(e,"Array")},Lgt=function(e){return typeof e=="object"&&e!==null},MY=function(e){if(!Lgt(e)||!Vhe(e,"Object"))return!1;for(var r=e;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r},Ghe=function(e,r,t,n){t=t||0,n=n||Agt;for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){var a=r[i];a?MY(a)?(MY(e[i])||(e[i]={}),t<n?Ghe(e[i],a,t+1,n):e[i]=r[i]):Mgt(a)?(e[i]=[],e[i]=e[i].concat(a)):e[i]=a:e[i]=a}},Igt=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=0;n<r.length;n+=1)Ghe(e,r[n]);return e};gP.deepAssign=Igt;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.deepAssign=void 0;var r=gP;Object.defineProperty(e,"deepAssign",{enumerable:!0,get:function(){return r.deepAssign}})})(ll);Object.defineProperty($k,"__esModule",{value:!0});$k.Tooltip=void 0;var Hhe=mi.exports,LY=N6,kgt=Hhe.__importDefault(zk),IY=Ps,Pgt=Doe,kY=Uhe,Rgt=w1,PY=ll,Ogt=["mousemove","click"],Fgt=function(e){Hhe.__extends(r,e);function r(t,n,i){var a=e.call(this)||this;a.currentVisible=!1,a.interactionTriggerHander=function(m){var x=m.feature,E=m.featureId,A=a.options,L=A.title,k=A.customTitle,R=A.items,D=A.customItems,$=x.type==="Feature"&&x.geometry&&x.properties,j=$?x.properties:x,H=[];if(D){var ee=D(x);if(Array.isArray(ee))H=ee;else throw new Error("customItems return array")}else R&&R.forEach(function(W){if((0,IY.isString)(W)){var Q=W.split(".").pop()||W,te=(0,kY.get)(j,W);te!==void 0&&H.push({name:Q,value:te})}else{var ie=W.field,ve=W.alias,me=W.customValue,Re=ve||ie.split(".").pop()||ie,te=(0,kY.get)(j,ie);te!==void 0&&H.push({name:Re,value:me?me(te,j,E):te})}});var U={title:k?k(j):L,items:H};a.updateTooltip(m,U)},a.interactionUntriggerHander=function(){a.hideTooltip()},a.scene=t,a.interactionLayers=n,a.options=(0,PY.deepAssign)({},a.getDefaultOptions(),i);var o=a.options,s=o.offsets,u=o.title,l=o.showTitle,f=o.customContent,h=o.domStyles,p=o.anchor,v=o.className;return a.marker=new LY.Marker({offsets:s,anchor:p,draggable:!1}),a.tooltipComponent=new Pgt.Tooltip({title:u,showTitle:l,items:[],customContent:f,domStyles:h,className:v}),a.setComponent(),a.initInteractionEvent(),a}return r.prototype.getDefaultOptions=function(){return{showTitle:!0,showComponent:!0,items:[],offsets:[15,0],trigger:"mousemove",anchor:Rgt.TooltipAnchorType["TOP-LEFT"]}},r.prototype.update=function(t){this.marker.remove(),this.currentVisible=!1,this.options=(0,PY.deepAssign)({},this.options,t);var n=this.options,i=n.offsets,a=n.showTitle,o=n.customContent,s=n.domStyles,u=n.anchor,l=n.className;this.marker=new LY.Marker({offsets:i,anchor:u,draggable:!1}),this.tooltipComponent.update({showTitle:a,customContent:o,domStyles:s,className:l}),this.setComponent()},r.prototype.initInteractionEvent=function(){var t=this,n=this.options.trigger||"mousemove";if(!Ogt.includes(n))throw new Error("trigger is mousemove or click");this.interactionLayers.forEach(function(i){var a=i.layer;a.on(n,t.interactionTriggerHander),a.on("un".concat(n),t.interactionUntriggerHander)})},r.prototype.unBindInteractionEvent=function(){var t=this,n=this.options.trigger||"mousemove";this.interactionLayers.forEach(function(i){var a=i.layer;a.off(n,t.interactionTriggerHander),a.off("un".concat(n),t.interactionUntriggerHander)})},r.prototype.updateTooltip=function(t,n){var i=t.lngLat,a=t.x,o=t.y;if(this.options.showComponent&&(this.updateComponent(n),this.setPostion(i)),this.currentVisible){var s={type:"tooltip:change",data:n,lngLat:i,x:a,y:o};this.emit("tooltip:change",s)}else{this.showTooltip();var u={type:"tooltip:show",data:n,lngLat:i,x:a,y:o};this.emit("tooltip:show",u)}},r.prototype.showTooltip=function(){this.currentVisible||(this.options.showComponent&&this.scene.addMarker(this.marker),this.currentVisible=!0)},r.prototype.hideTooltip=function(){if(!!this.currentVisible){this.options.showComponent&&this.marker.remove(),this.currentVisible=!1;var t={type:"tooltip:hide"};this.emit("tooltip:hide",t)}},r.prototype.updateComponent=function(t){(0,IY.isEqual)(this.lastComponentOptions,t)||(this.tooltipComponent.update(t),this.lastComponentOptions=t)},r.prototype.setComponent=function(){var t=this.tooltipComponent.getContainer(),n=window.document.createElement("div");n.style.cursor="auto",n.style.userSelect="text",n.className="l7plot-tooltip-container",["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(i){n.addEventListener(i,function(a){return a.stopPropagation()})}),n.appendChild(t),this.marker.setElement(n)},r.prototype.setPostion=function(t){this.marker.setLnglat(t)},r.prototype.destroy=function(){this.unBindInteractionEvent(),this.off(),this.marker.remove(),this.tooltipComponent.destroy()},r}(kgt.default);$k.Tooltip=Fgt;var mP={};Object.defineProperty(mP,"__esModule",{value:!0});mP.Legend=void 0;var Dgt=mi.exports,Bgt=N6,RY=Doe,Ngt=function(e){Dgt.__extends(r,e);function r(t){var n=e.call(this,t)||this;return n.legendComponents=[],n.options=t,n.legendComponents=n.initLegendComponents(t.items),n}return r.prototype.initLegendComponents=function(t){for(var n=[],i=0;i<t.length;i++){var a=t[i];if(a.type==="category"){var o=new RY.CategoryLegend({title:a.options.title,items:a.options.items,className:a.options.className,customContent:a.options.customContent,domStyles:a.options.domStyles});n.push(o)}else if(a.type==="continue"){var o=new RY.ContinueLegend({title:a.options.title,min:a.options.min,max:a.options.max,colors:a.options.colors,className:a.options.className,customContent:a.options.customContent,domStyles:a.options.domStyles});n.push(o)}}return n},r.prototype.getDefaultOptions=function(){return{position:"bottomleft"}},r.prototype.onAdd=function(){var t=window.document.createElement("div");return t.className="l7plot-legend-container",this.legendComponents.forEach(function(n){var i=n.getContainer();t.appendChild(i)}),t},r.prototype.onRemove=function(){this.legendComponents.forEach(function(t){t.destroy()})},r}(Bgt.Control);mP.Legend=Ngt;var xp={};Object.defineProperty(xp,"__esModule",{value:!0});xp.LayerGroup=void 0;var jhe=mi.exports,zgt=Ps,$gt=jhe.__importDefault(zk),Ugt=function(e){jhe.__extends(r,e);function r(t,n){t===void 0&&(t=[]),n===void 0&&(n={});var i=e.call(this)||this;return i.name=n.name?n.name:(0,zgt.uniqueId)("layerGroup"),i.layers=t,i}return r.prototype.addTo=function(t){var n=this;this.scene=t;var i=0,a=this.layers.length;this.layers.forEach(function(o){o.once("inited",function(s){i++,n.emit("inited",s),i===a&&n.emit("inited-all")}),o.addTo(t)})},r.prototype.hasLayer=function(t){return this.layers.some(function(n){return n===t})},r.prototype.addLayer=function(t){var n=this;this.layers.push(t),this.scene&&(t.once("inited",function(i){return n.emit("inited",i)}),t.addTo(this.scene))},r.prototype.removeLayer=function(t){var n=this.layers.findIndex(function(i){return i===t});return n===-1?!1:(this.layers.splice(n,1),this.scene&&t.remove(this.scene),!0)},r.prototype.getLayers=function(){return this.layers},r.prototype.getInteractionLayers=function(){return this.layers.filter(function(t){var n=t.interaction;return n})},r.prototype.getLayer=function(t){return this.layers.find(function(n){var i=n.layer;return i.id===t})},r.prototype.getLayerByName=function(t){return this.layers.find(function(n){return n.name===t})},r.prototype.removeAllLayer=function(){var t=this;this.layers.forEach(function(n){t.scene&&n.remove(t.scene)}),this.layers=[]},r.prototype.isEmpty=function(){return this.layers.length===0},r}($gt.default);xp.LayerGroup=Ugt;var yy={};Object.defineProperty(yy,"__esModule",{value:!0});yy.LayerEventList=yy.MapEventList=yy.SceneEventList=void 0;yy.SceneEventList=[{original:"loaded",adaptation:"scene-loaded"},{original:"resize",adaptation:"resize"},{original:"destroy",adaptation:"destroy"},{original:"resize",adaptation:"resize"}];yy.MapEventList=["mapmove","movestart","moveend","zoomchange","zoomstart","zoomend","click","dblclick","contextmenu","mousemove","mousewheel","mouseover","mouseout","mouseup","mousedown","dragstart","dragging","dragend"];yy.LayerEventList=["inited","add","remove","dataUpdate","click","unclick","contextmenu","uncontextmenu","mouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","uncontextmenu","unpick"];Object.defineProperty(tw,"__esModule",{value:!0});tw.Map=void 0;var Ub=mi.exports,Vgt=Lnt,OY=knt,QO=N6,Ggt=Ub.__importDefault(zk),Xm=Ps,Hgt=$k,jgt=mP,mx=ll,TM=w1,Wgt=xp,JO=yy,Ib=gB,FY=a_,Xgt=mB,DY={map:{type:TM.BaseMapType.Amap},logo:!0},Ygt=function(e){Ub.__extends(r,e);function r(t){var n=e.call(this)||this;return n.inited=!1,n.sceneLoaded=!1,n.layersLoaded=!1,n.loaded=!1,n.layerGroup=new Wgt.LayerGroup,n.options=(0,mx.deepAssign)({},n.getDefaultOptions(),t),n.lastOptions=n.options,n}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createContainer=function(t){var n=this.options,i=n.width,a=n.height,o=typeof t=="string"?document.getElementById(t):t;return o.style.position||(o.style.position="relative"),i&&(o.style.width||(o.style.width="".concat(i,"px"))),a&&(o.style.height||(o.style.height="".concat(a,"px"))),o},r.prototype.createTheme=function(){var t=(0,Xm.isObject)(this.options.theme)?(0,mx.deepAssign)({},(0,FY.getTheme)("default"),(0,Xgt.createTheme)(this.options.theme)):(0,FY.getTheme)(this.options.theme);return t},r.prototype.createMap=function(){var t=this.options.map?this.options.map:DY.map,n=t.type,i=Ub.__rest(t,["type"]),a=Object.assign({style:this.theme.mapStyle},i);return n===TM.BaseMapType.Amap?new OY.GaodeMap(a):new OY.Mapbox(a)},r.prototype.createScene=function(){var t=this.options,n=t.logo,i=t.antialias,a=t.preserveDrawingBuffer,o=(0,Xm.isBoolean)(n)?{logoVisible:n}:{logoVisible:n==null?void 0:n.visible,logoPosition:n==null?void 0:n.position},s=Object.assign({antialias:i,preserveDrawingBuffer:a},o),u=this.createMap(),l=new Vgt.Scene(Ub.__assign({id:this.container,map:u},s));return l},r.prototype.registerResources=function(){var t=this;Ib.IMAGES_CACHE.size&&Ib.IMAGES_CACHE.forEach(function(n,i){!t.scene.hasImage(i)&&t.scene.addImage(i,n)}),Ib.FONT_FACE_CACHE.size&&Ib.FONT_FACE_CACHE.forEach(function(n,i){t.scene.addFontFace(i,n)}),Ib.ICON_FONT_CACHE.size&&Ib.ICON_FONT_CACHE.forEach(function(n,i){t.scene.addIconFont(i,n)})},r.prototype.update=function(t){this.updateOption(t),t.map&&!(0,Xm.isEqual)(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),this.render(),this.emit("update")},r.prototype.updateOption=function(t){this.lastOptions=this.options,this.options=(0,mx.deepAssign)({},this.options,t)},r.prototype.updateMap=function(t){var n;if(!!this.scene){var i=t.style,a=t.center,o=t.zoom,s=t.rotation,u=t.pitch;(0,Xm.isUndefined)(u)||this.scene.setPitch(u),(0,Xm.isUndefined)(s)||this.scene.setRotation(s),i&&i!==((n=this.lastOptions.map)===null||n===void 0?void 0:n.style)&&this.scene.setMapStyle(i),o&&a&&this.scene.setZoomAndCenter(o,a)}},r.prototype.changeSize=function(t,n){this.options.width===t&&this.options.height===n||(this.container.style.width="".concat(t,"px"),this.container.style.height="".concat(n,"px"),this.options=Object.assign(this.options,{width:t,height:n}))},r.prototype.on=function(t,n){return this.proxyEventHander("on",t,n),this},r.prototype.once=function(t,n){return this.proxyEventHander("once",t,n),this},r.prototype.off=function(t,n){return this.proxyEventHander("off",t,n),this},r.prototype.proxyEventHander=function(t,n,i){var a=JO.SceneEventList.find(function(f){return f.adaptation===n});if(a)this.scene[t](a.original,i);else if(JO.MapEventList.indexOf(n)!==-1)this.scene[t](n,i);else if(n.includes("Layer:")){var o=Ub.__read(n.split(":"),2),s=o[0],u=o[1],l=this[s]&&this[s][t];if(l&&JO.LayerEventList.indexOf(u)!==-1)this[s][t](u,i);else throw new Error('No event name "'.concat(n,'"'))}else e.prototype[t].call(this,n,i)},r.prototype.getScene=function(){return this.scene},r.prototype.getMap=function(){var t,n;return((t=this.options.map)===null||t===void 0?void 0:t.type)===TM.BaseMapType.Amap?this.scene.map:((n=this.options.map)===null||n===void 0?void 0:n.type)===TM.BaseMapType.Mapbox?this.scene.map:this.scene.map},r.prototype.addLayer=function(t){this.layerGroup.addLayer(t)},r.prototype.getLayes=function(){return console.warn("Replace to use getLayers()"),this.getLayers()},r.prototype.getLayers=function(){return this.layerGroup.getLayers()},r.prototype.getLayerByName=function(t){return this.layerGroup.getLayerByName(t)},r.prototype.removeLayer=function(t){return this.layerGroup.removeLayer(t)},r.prototype.removeAllLayer=function(){this.layerGroup.removeAllLayer()},r.prototype.zoomIn=function(){this.scene.zoomIn()},r.prototype.zoomOut=function(){this.scene.zoomOut()},r.prototype.setPitch=function(t){this.scene.setPitch(t)},r.prototype.fitBounds=function(t){this.scene.fitBounds(t)},r.prototype.setMapStatus=function(t){this.scene.setMapStatus(t)},r.prototype.setBgColor=function(t){this.scene.setBgColor(t)},r.prototype.initComponents=function(){this.initControls(),this.initTooltip()},r.prototype.updateComponents=function(){this.updateControls(),this.initTooltip()},r.prototype.initControls=function(){var t=this.options,n=t.zoom,i=t.scale,a=t.layerMenu,o=t.legend;i&&this.addScaleControl(i),n&&this.addZoomControl(n),a&&this.addLayerMenuControl(a),o&&this.addLegendControl(o)},r.prototype.updateControls=function(){var t=this.options,n=t.zoom,i=t.scale,a=t.layerMenu,o=t.legend;(0,Xm.isEqual)(this.lastOptions.zoom,n)||(n?this.updateZoomControl(n):this.removeZoomControl()),(0,Xm.isEqual)(this.lastOptions.scale,i)||(i?this.updateScaleControl(i):this.removeScaleControl()),(0,Xm.isEqual)(this.lastOptions.layerMenu,a)||(a?this.updateLayerMenuControl(a):this.removeLayerMenuControl()),(0,Xm.isEqual)(this.lastOptions.legend,o)||(o?this.updateLegendControl(o):this.removeLegendControl())},r.prototype.addZoomControl=function(t){this.zoomControl||(this.zoomControl=new QO.Zoom(t),this.scene.addControl(this.zoomControl))},r.prototype.updateZoomControl=function(t){if(!this.zoomControl){this.addZoomControl(t);return}this.removeZoomControl(),this.addZoomControl(t)},r.prototype.removeZoomControl=function(){this.zoomControl&&(this.zoomControl.remove(),this.zoomControl=void 0)},r.prototype.addScaleControl=function(t){this.scaleControl||(this.scaleControl=new QO.Scale(t),this.scene.addControl(this.scaleControl))},r.prototype.updateScaleControl=function(t){if(!this.scaleControl){this.addScaleControl(t);return}this.removeScaleControl(),this.addScaleControl(t)},r.prototype.removeScaleControl=function(){this.scaleControl&&(this.scaleControl.remove(),this.scaleControl=void 0)},r.prototype.addLayerMenuControl=function(t){if(!this.layerMenuControl){var n={},i={};this.layerGroup.getLayers().forEach(function(a){var o=a.name,s=a.layer;i[o]=s}),this.layerMenuControl=new QO.Layers(Object.assign({},t,{baseLayers:n,overlayers:i})),this.scene.addControl(this.layerMenuControl)}},r.prototype.updateLayerMenuControl=function(t){if(!this.layerMenuControl){this.addLayerMenuControl(t);return}this.removeLayerMenuControl(),this.addLayerMenuControl(t)},r.prototype.removeLayerMenuControl=function(){this.layerMenuControl&&(this.layerMenuControl.remove(),this.layerMenuControl=void 0)},r.prototype.getLegendOptions=function(){return{}},r.prototype.addLegendControl=function(t){if(!this.legendControl){var n=this.theme.components.legend,i=(0,mx.deepAssign)({},this.getLegendOptions(),t),a=i.type,o=i.position,s=Ub.__rest(i,["type","position"]),u=[];if(a==="category"){var l=(0,mx.deepAssign)({},{domStyles:n.category.domStyles},s);u.push({type:a,options:l})}else if(a==="continue"){var f=(0,mx.deepAssign)({},{domStyles:n.continue.domStyles},s);u.push({type:a,options:f})}u.length&&(this.legendControl=new jgt.Legend({position:o,items:u}),this.scene.addControl(this.legendControl))}},r.prototype.updateLegendControl=function(t){if(!this.legendControl){this.addLegendControl(t);return}this.removeLegendControl(),this.addLegendControl(t)},r.prototype.removeLegendControl=function(){this.legendControl&&(this.legendControl.remove(),this.legendControl=void 0)},r.prototype.initTooltip=function(){var t=this;this.tooltip&&this.tooltip.destroy();var n=this.options.tooltip;if(n){var i=(0,mx.deepAssign)({},{domStyles:this.theme.components.tooltip.domStyles},n),a=this.layerGroup.getInteractionLayers();this.tooltip=new Hgt.Tooltip(this.scene,a,i),this.tooltip.on("*",function(o){return t.emit(o.type,o)})}},r.prototype.exportPng=function(t){return this.scene.exportPng(t)},r.prototype.destroy=function(){var t;e.prototype.off.call(this,"*"),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(t=this.tooltip)===null||t===void 0||t.destroy(),this.scene.destroy()},r.DefaultOptions=DY,r}(Ggt.default);tw.Map=Ygt;var cl={},I_={},k_=ed(brt),rg={},GS={};Object.defineProperty(GS,"__esModule",{value:!0});GS.MappingSource=void 0;var Zgt=function(){function e(){}return e.aggregation=function(r,t){var n=t.type,i=n===void 0?"grid":n,a=t.radius,o=t.method,s=t.field,u={type:i,size:a,method:o,field:s};r.transforms?(r.transforms=r.transforms.filter(function(l){return l.type!==u.type}),r.transforms.push(u)):r.transforms=[u]},e}();GS.MappingSource=Zgt;Object.defineProperty(rg,"__esModule",{value:!0});rg.PlotLayer=void 0;var YL=mi.exports,Nv=Ps,qgt=YL.__importDefault(_oe),Kgt=YL.__importDefault(zk),Qgt=B6,Jgt=GS,eF=yy,BY=ll,NY=["name","zIndex","visible","minZoom","maxZoom","pickingBuffer","autoFit","blend"],emt=function(e){YL.__extends(r,e);function r(t){var n=e.call(this)||this;return n.options=(0,BY.deepAssign)({},n.getDefaultOptions(),t),n.lastOptions=n.options,n}return r.prototype.getDefaultOptions=function(){return{}},r.prototype.pickLayerConfig=function(t){var n=(0,Nv.pick)(t,NY);return n},r.prototype.addTo=function(t){t.addLayer(this.layer)},r.prototype.remove=function(t){t.removeLayer(this.layer)},r.prototype.update=function(t){this.updateOption(t),this.updateConfig(t)},r.prototype.updateOption=function(t){this.lastOptions=this.options,this.options=(0,BY.deepAssign)({},this.options,t)},r.prototype.updateConfig=function(t){!(0,Nv.isUndefined)(t.zIndex)&&!(0,Nv.isEqual)(this.lastOptions.zIndex,this.options.zIndex)&&this.setIndex(t.zIndex),!(0,Nv.isUndefined)(t.blend)&&!(0,Nv.isEqual)(this.lastOptions.blend,this.options.blend)&&this.setBlend(t.blend),!(0,Nv.isUndefined)(t.minZoom)&&!(0,Nv.isEqual)(this.lastOptions.minZoom,this.options.minZoom)&&this.setMinZoom(t.minZoom),!(0,Nv.isUndefined)(t.maxZoom)&&!(0,Nv.isEqual)(this.lastOptions.maxZoom,this.options.maxZoom)&&this.setMinZoom(t.maxZoom),!(0,Nv.isUndefined)(t.visible)&&!(0,Nv.isEqual)(this.lastOptions.visible,this.options.visible)&&(t.visible?this.show():this.hide())},r.prototype.render=function(){this.layer.renderLayers()},r.prototype.setSource=function(t){if(t instanceof qgt.default)this.layer.setSource(t);else{var n=t.data,i=t.aggregation,a=YL.__rest(t,["data","aggregation"]);i&&Jgt.MappingSource.aggregation(a,i);var o=this.layer.getSource();o?this.layer.setData(n,a):this.layer.source(n,a)}},r.prototype.changeData=function(t){this.setSource(t)},r.prototype.setIndex=function(t){this.layer.setIndex(t)},r.prototype.setBlend=function(t){this.layer.setBlend(t)},r.prototype.setMinZoom=function(t){this.layer.setMinZoom(t)},r.prototype.setMaxZoom=function(t){this.layer.setMaxZoom(t)},r.prototype.show=function(){this.layer.inited&&this.layer.show()},r.prototype.hide=function(){this.layer.inited&&this.layer.hide()},r.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},r.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():this.options.visible},r.prototype.fitBounds=function(t){this.layer.fitBounds(t)},r.prototype.on=function(t,n){return eF.LayerEventList.indexOf(t)!==-1?this.layer.on(t,n):e.prototype.on.call(this,t,n),this},r.prototype.once=function(t,n){return eF.LayerEventList.indexOf(t)!==-1?this.layer.once(t,n):e.prototype.once.call(this,t,n),this},r.prototype.off=function(t,n){return eF.LayerEventList.indexOf(t)!==-1?this.layer.off(t,n):e.prototype.off.call(this,t,n),this},r.LayerType=Qgt.LayerType,r.LayerConfigkeys=NY,r}(Kgt.default);rg.PlotLayer=emt;var yP={},Jp={};Object.defineProperty(Jp,"__esModule",{value:!0});Jp.MappingLayer=Jp.getMappingFunction=void 0;var eu=Ps;function E0(e,r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i={};return e.forEach(function(a,o){i[a]=t[o]}),delete i.undefined,r(i)}}Jp.getMappingFunction=E0;var tmt=function(){function e(){}return e.shape=function(r,t){if((0,eu.isString)(t))r.shape(t);else if((0,eu.isFunction)(t)){var n=[];r.shape(n.join("*"),E0(n,t))}else if((0,eu.isObject)(t)){var i=t.field?t.field:"";if((0,eu.isFunction)(t.value)){var n=(0,eu.isArray)(i)?i:i.split("*");r.shape(i,E0(n,t.value))}else r.shape(i,t.value);(0,eu.isString)(i)&&t.scale&&e.scale(r,i,t.scale)}},e.size=function(r,t){if((0,eu.isNumber)(t))r.size(t);else if((0,eu.isArray)(t))r.size(t);else if((0,eu.isFunction)(t)){var n=[];r.size(n.join("*"),E0(n,t))}else if((0,eu.isObject)(t)){var i=t.field?t.field:"";if((0,eu.isFunction)(t.value)){var n=(0,eu.isArray)(i)?i:i.split("*");r.size(i,E0(n,t.value))}else r.size(i,t.value);(0,eu.isString)(i)&&t.scale&&e.scale(r,i,t.scale)}},e.color=function(r,t){if((0,eu.isString)(t))r.color(t);else if((0,eu.isFunction)(t)){var n=[];r.color(n.join("*"),E0(n,t))}else if((0,eu.isObject)(t)){var i=t.field?t.field:"";if((0,eu.isFunction)(t.value)){var n=(0,eu.isArray)(i)?i:i.split("*");r.color(i,E0(n,t.value))}else r.color(i,t.value);(0,eu.isString)(i)&&t.scale&&e.scale(r,i,t.scale)}},e.style=function(r,t){t&&r.style(t)},e.state=function(r,t){var n=t.active,i=t.select;n&&r.active(n),i&&r.select(i)},e.rotate=function(r,t){(0,eu.isString)(t)||(0,eu.isFunction)(t)||(0,eu.isObject)(t)},e.texture=function(r,t){(0,eu.isString)(t)&&r.texture(t)},e.animate=function(r,t){((0,eu.isBoolean)(t)||(0,eu.isObject)(t))&&r.animate(t)},e.scale=function(r,t,n){r.scale(t,n)},e.filter=function(r,t){var n=t.field?t.field:"",i=(0,eu.isArray)(n)?n:n.split("*");r.filter(i.join("*"),E0(i,t.value))},e}();Jp.MappingLayer=tmt;Object.defineProperty(yP,"__esModule",{value:!0});yP.mappingLayer=void 0;var uC=Jp;function rmt(e,r){var t=r.field,n=r.content,i=r.style,a=i===void 0?{}:i,o=r.state,s=a.fontSize,u=a.fill,l=t||n||"",f={field:l,value:"text"};uC.MappingLayer.shape(e,f),s&&uC.MappingLayer.size(e,s),u&&uC.MappingLayer.color(e,u),a&&uC.MappingLayer.style(e,a),o&&uC.MappingLayer.state(e,o)}yP.mappingLayer=rmt;Object.defineProperty(I_,"__esModule",{value:!0});I_.TextLayer=void 0;var tF=mi.exports,nmt=Ps,imt=k_,rF=rg,amt=yP,zY={style:{fontSize:12}},omt=[],smt=function(e){tF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.type=rF.PlotLayer.LayerType.TextLayer,n.interaction=!1;var i=n.options,a=i.name,o=i.source,s=n.pickLayerConfig(n.options);return n.name=a||(0,nmt.uniqueId)(n.type),n.layer=new imt.PointLayer(tF.__assign(tF.__assign({},s),{name:n.name})),n.mappingLayer(n.layer,n.options),n.setSource(o),n}return r.prototype.getDefaultOptions=function(){return zY},r.prototype.mappingLayer=function(t,n){(0,amt.mappingLayer)(t,n)},r.prototype.update=function(t){e.prototype.update.call(this,t),this.mappingLayer(this.layer,this.options)},r.DefaultOptions=zY,r.LayerOptionsKeys=rF.PlotLayer.LayerConfigkeys.concat(omt),r}(rF.PlotLayer);I_.TextLayer=smt;Object.defineProperty(cl,"__esModule",{value:!0});cl.Plot=void 0;var yx=mi.exports,umt=tw,lmt=ll,cmt=I_,$Y=w1,UY=GS,VY=Ps,fmt=a_,hmt={autoFit:!1},pmt=function(e){yx.__extends(r,e);function r(t,n){var i=this;if(typeof t=="string"||t instanceof Element){if(n===void 0)throw new Error("options is undefined");i=e.call(this,n)||this,i.container=i.createContainer(t),i.theme=i.createTheme(),i.scene=i.createScene(),i.registerResources(),i.initSource()}else i=e.call(this,t)||this;return i}return r.prototype.initSource=function(){this.source=this.createSource(),this.render(),this.inited=!0},r.prototype.initLayersEvent=function(){},r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createSource=function(){var t=this.options.source,n=t.data,i=t.aggregation,a=yx.__rest(t,["data","aggregation"]);i&&UY.MappingSource.aggregation(a,i);var o=new $Y.Source(n,a);return o},r.prototype.createLabelLayer=function(t,n,i){var a=i||{},o=a.visible,s=a.minZoom,u=a.maxZoom,l=a.zIndex,f=l===void 0?0:l,h=new cmt.TextLayer(yx.__assign({name:"labelLayer",visible:o,minZoom:s,maxZoom:u,zIndex:f+.1,source:t},n));return h},r.prototype.updateLabelLayer=function(t,n,i,a){n?a?a.update(yx.__assign({},n)):(a=this.createLabelLayer(t,n,i),this.layerGroup.addLayer(a)):n===!1&&a&&this.layerGroup.removeLayer(a)},r.prototype.render=function(){var t=this,n=this.createLayers(this.source);this.inited?(this.layerGroup.removeAllLayer(),n.addTo(this.scene),this.layerGroup=n):(this.layerGroup=n,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){t.onSceneLoaded()})),this.initLayersEvent()},r.prototype.onSceneLoaded=function(){var t=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",function(){t.onLayersLoaded()}),this.layerGroup.addTo(this.scene)},r.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.initComponents(),this.loaded=!0,this.emit("loaded")},r.prototype.attachToScene=function(t,n){this.scene=t,this.theme=n||(0,fmt.getTheme)("default"),this.registerResources(),this.initSource()},r.prototype.unattachFromScene=function(){var t;this.removeAllLayer(),(t=this.tooltip)===null||t===void 0||t.destroy()},r.prototype.addToScene=function(t){this.attachToScene(t)},r.prototype.removeFromScene=function(){var t;this.removeAllLayer(),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(t=this.tooltip)===null||t===void 0||t.destroy()},r.prototype.update=function(t){if(this.updateOption(t),t.map&&!(0,VY.isEqual)(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),this.scene.setEnableRender(!1),t.source&&!(0,VY.isEqual)(this.lastOptions.source,this.options.source)){var n=t.source,i=n.data,a=yx.__rest(n,["data"]);this.changeData(i,a)}this.scene.setEnableRender(!0),this.render(),this.updateComponents(),this.emit("update")},r.prototype.changeData=function(t,n){var i=this;this.options.source=(0,lmt.deepAssign)({},this.options.source,yx.__assign({data:t},n));var a=this.options.source,o=a.aggregation,s=yx.__rest(a,["aggregation"]);o&&UY.MappingSource.aggregation(s,o),this.source.setData(this.options.source.data,s);var u=this.options.legend;u&&setTimeout(function(){i.updateLegendControl(u)}),this.emit("change-data")},r.DefaultOptions=hmt,r.PlotType=$Y.PlotType,r}(umt.Map);cl.Plot=pmt;var _P={},R2={},HS={},xP={};Object.defineProperty(xP,"__esModule",{value:!0});xP.DEFAULT_OPTIONS=void 0;var dmt=cl,vmt=ll;xP.DEFAULT_OPTIONS=(0,vmt.deepAssign)({},dmt.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}});var pm={},bP={};Object.defineProperty(bP,"__esModule",{value:!0});bP.mappingLayer=void 0;var kb=Jp;function gmt(e,r){var t=r.shape,n=r.color,i=r.size,a=r.style,o=r.state,s=r.animate;t&&kb.MappingLayer.shape(e,t),i&&kb.MappingLayer.size(e,i),n&&kb.MappingLayer.color(e,n),a&&kb.MappingLayer.style(e,a),o&&kb.MappingLayer.state(e,o),s&&kb.MappingLayer.animate(e,s)}bP.mappingLayer=gmt;var N1={};Object.defineProperty(N1,"__esModule",{value:!0});N1.getColorLegendItems=void 0;var GY=mi.exports,HY=Uhe,mmt=function(e){return!Array.isArray(e[0].value)},ymt=function(e){if(mmt(e))return e;var r=e.map(function(t){return GY.__assign(GY.__assign({},t),{value:[(0,HY.round)(t.value[0],2),(0,HY.round)(t.value[1],2)]})});return r};N1.getColorLegendItems=ymt;Object.defineProperty(pm,"__esModule",{value:!0});pm.DotLayer=void 0;var nF=mi.exports,_mt=Ps,xmt=k_,iF=rg,bmt=bP,wmt=N1,jY={source:{data:[],parser:{type:"json",x:"x",y:"y"}},shape:"circle",size:12,color:"#5FD3A6"},Cmt=["shape","color","size","style","state","animate"],Emt=function(e){nF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.type=iF.PlotLayer.LayerType.DotLayer,n.interaction=!0;var i=n.options,a=i.name,o=i.source,s=n.pickLayerConfig(n.options);return n.name=a||(0,_mt.uniqueId)(n.type),n.layer=new xmt.PointLayer(nF.__assign(nF.__assign({},s),{name:n.name})),n.mappingLayer(n.layer,n.options),n.setSource(o),n}return r.prototype.getDefaultOptions=function(){return jY},r.prototype.mappingLayer=function(t,n){(0,bmt.mappingLayer)(t,n)},r.prototype.update=function(t){e.prototype.update.call(this,t),this.mappingLayer(this.layer,this.options)},r.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&t.length!==0){var n=(0,wmt.getColorLegendItems)(t);return n}return[]},r.DefaultOptions=jY,r.LayerOptionsKeys=iF.PlotLayer.LayerConfigkeys.concat(Cmt),r}(iF.PlotLayer);pm.DotLayer=Emt;Object.defineProperty(HS,"__esModule",{value:!0});HS.Dot=void 0;var WY=mi.exports,XY=Ps,YY=cl,Smt=xP,aF=pm,Amt=xp,Tmt=function(e){WY.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=YY.Plot.PlotType.Dot,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.dotLayer=new aF.DotLayer(WY.__assign({source:t},(0,XY.pick)(this.options,aF.DotLayer.LayerOptionsKeys)));var n=new Amt.LayerGroup([this.dotLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label,this.options),n.addLayer(this.labelLayer)),n},r.prototype.updateLayers=function(t){var n=(0,XY.pick)(t,aF.DotLayer.LayerOptionsKeys);this.dotLayer.update(n),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},r.prototype.getLegendOptions=function(){var t=this.dotLayer.getColorLegendItems();return t.length!==0?{type:"category",items:t}:{}},r.DefaultOptions=Smt.DEFAULT_OPTIONS,r}(YY.Plot);HS.Dot=Tmt;var jS={},wP={};Object.defineProperty(wP,"__esModule",{value:!0});wP.DEFAULT_OPTIONS=void 0;var Mmt=cl,Lmt=ll;wP.DEFAULT_OPTIONS=(0,Lmt.deepAssign)({},Mmt.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}});var hw={};Object.defineProperty(hw,"__esModule",{value:!0});hw.DotDensityLayer=void 0;var Imt=mi.exports,kmt=ll,GT=pm,Pmt=["color","size","style","state","animate"],Rmt=function(e){Imt.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=GT.DotLayer.LayerType.DotDensity,t.interaction=!1,t}return r.prototype.getDefaultOptions=function(){return(0,kmt.deepAssign)({},GT.DotLayer.DefaultOptions,{shape:"dot",size:1})},r.LayerOptionsKeys=GT.DotLayer.LayerConfigkeys.concat(Pmt),r}(GT.DotLayer);hw.DotDensityLayer=Rmt;Object.defineProperty(jS,"__esModule",{value:!0});jS.DotDensity=void 0;var ZY=mi.exports,qY=Ps,KY=cl,Omt=wP,Fmt=xp,oF=hw,Dmt=function(e){ZY.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=KY.Plot.PlotType.DotDensity,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.dotDensityLayer=new oF.DotDensityLayer(ZY.__assign({source:t},(0,qY.pick)(this.options,oF.DotDensityLayer.LayerOptionsKeys)));var n=new Fmt.LayerGroup([this.dotDensityLayer]);return n},r.prototype.updateLayers=function(t){var n=(0,qY.pick)(t,oF.DotDensityLayer.LayerOptionsKeys);this.dotDensityLayer.update(n)},r.DefaultOptions=Omt.DEFAULT_OPTIONS,r}(KY.Plot);jS.DotDensity=Dmt;var WS={},CP={};Object.defineProperty(CP,"__esModule",{value:!0});CP.DEFAULT_OPTIONS=void 0;var Bmt=cl,Nmt=ll;CP.DEFAULT_OPTIONS=(0,Nmt.deepAssign)({},Bmt.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}});var pw={},EP={};Object.defineProperty(EP,"__esModule",{value:!0});EP.mappingLayer=void 0;var HT=Jp;function zmt(e){var r=e.colorsRamp,t={colors:[],positions:[]};return r.forEach(function(n){var i=n.color,a=n.position;t.colors.push(i),t.positions.push(a)}),t}function $mt(e,r){var t=r.shape,n=r.size,i=r.style,a=r.state;t&&HT.MappingLayer.shape(e,t),n&&HT.MappingLayer.size(e,n),i&&("colorsRamp"in i&&(i.rampColors=zmt(i)),HT.MappingLayer.style(e,i)),a&&HT.MappingLayer.state(e,a)}EP.mappingLayer=$mt;Object.defineProperty(pw,"__esModule",{value:!0});pw.HeatmapLayer=void 0;var sF=mi.exports,Umt=Ps,Vmt=k_,uF=rg,Gmt=EP,QY={source:{data:[],parser:{type:"json",x:"x",y:"y"}},shape:"heatmap",size:{value:[0,1]},style:{intensity:3,radius:20,opacity:1,colorsRamp:[{color:"rgba(33,102,172,0.0)",position:0},{color:"rgb(103,169,207)",position:.2},{color:"rgb(209,229,240)",position:.4},{color:"rgb(253,219,199)",position:.6},{color:"rgb(239,138,98)",position:.8},{color:"rgb(178,24,43,1.0)",position:1}]}},Hmt=["shape","color","size","style","state"],jmt=function(e){sF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.type=uF.PlotLayer.LayerType.HeatmapLayer,n.interaction=!1;var i=n.options,a=i.name,o=i.source,s=n.pickLayerConfig(n.options);return n.name=a||(0,Umt.uniqueId)(n.type),n.layer=new Vmt.HeatmapLayer(sF.__assign(sF.__assign({},s),{name:n.name})),n.mappingLayer(n.layer,n.options),n.setSource(o),n}return r.prototype.getDefaultOptions=function(){return QY},r.prototype.mappingLayer=function(t,n){(0,Gmt.mappingLayer)(t,n)},r.prototype.update=function(t){e.prototype.update.call(this,t),this.mappingLayer(this.layer,this.options)},r.DefaultOptions=QY,r.LayerOptionsKeys=uF.PlotLayer.LayerConfigkeys.concat(Hmt),r}(uF.PlotLayer);pw.HeatmapLayer=jmt;Object.defineProperty(WS,"__esModule",{value:!0});WS.Heatmap=void 0;var JY=mi.exports,eZ=Ps,tZ=cl,Wmt=CP,lF=pw,Xmt=xp,Ymt=function(e){JY.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=tZ.Plot.PlotType.Heatmap,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.heatmapLayer=new lF.HeatmapLayer(JY.__assign({source:t},(0,eZ.pick)(this.options,lF.HeatmapLayer.LayerOptionsKeys)));var n=new Xmt.LayerGroup([this.heatmapLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),n.addLayer(this.labelLayer)),n},r.prototype.updateLayers=function(t){var n=(0,eZ.pick)(t,lF.HeatmapLayer.LayerOptionsKeys);this.heatmapLayer.update(n),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},r.prototype.getLegendOptions=function(){var t,n=this.heatmapLayer.layer.getLegendItems("size");if(Array.isArray(n)&&n.length!==0){var i=n[0].value,a=n[n.length-1].value,o=(t=this.heatmapLayer.options.style)===null||t===void 0?void 0:t.colorsRamp.map(function(s){var u=s.color;return u});return{type:"continue",min:i,max:a,colors:o}}return{}},r.DefaultOptions=Wmt.DEFAULT_OPTIONS,r}(tZ.Plot);WS.Heatmap=Ymt;var XS={},SP={};Object.defineProperty(SP,"__esModule",{value:!0});SP.DEFAULT_OPTIONS=void 0;var Zmt=cl,qmt=ll;SP.DEFAULT_OPTIONS=(0,qmt.deepAssign)({},Zmt.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"grid",radius:15e3,method:"sum"}}});var dw={},AP={};Object.defineProperty(AP,"__esModule",{value:!0});AP.mappingLayer=void 0;var lC=Jp;function Kmt(e,r){var t=r.shape,n=r.color,i=r.size,a=r.style,o=r.state;t&&lC.MappingLayer.shape(e,t),i&&lC.MappingLayer.size(e,i),n&&lC.MappingLayer.color(e,n),a&&lC.MappingLayer.style(e,a),o&&lC.MappingLayer.state(e,o)}AP.mappingLayer=Kmt;Object.defineProperty(dw,"__esModule",{value:!0});dw.GridLayer=void 0;var cF=mi.exports,Qmt=Ps,Jmt=k_,fF=rg,eyt=AP,rZ={source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"grid",field:"",radius:15e3,method:"sum"}},shape:"square",color:"#5FD3A6",style:{coverage:.9,angle:0,opacity:1}},tyt=["shape","color","size","style","state"],ryt=function(e){cF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.type=fF.PlotLayer.LayerType.GridLayer,n.interaction=!1;var i=n.options,a=i.name,o=i.source,s=n.pickLayerConfig(n.options);return n.name=a||(0,Qmt.uniqueId)(n.type),n.layer=new Jmt.HeatmapLayer(cF.__assign(cF.__assign({},s),{name:n.name})),n.mappingLayer(n.layer,n.options),n.setSource(o),n}return r.prototype.getDefaultOptions=function(){return rZ},r.prototype.mappingLayer=function(t,n){(0,eyt.mappingLayer)(t,n)},r.prototype.update=function(t){e.prototype.update.call(this,t),this.mappingLayer(this.layer,this.options)},r.DefaultOptions=rZ,r.LayerOptionsKeys=fF.PlotLayer.LayerConfigkeys.concat(tyt),r}(fF.PlotLayer);dw.GridLayer=ryt;Object.defineProperty(XS,"__esModule",{value:!0});XS.Grid=void 0;var nZ=mi.exports,iZ=Ps,aZ=cl,nyt=SP,hF=dw,iyt=xp,ayt=function(e){nZ.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=aZ.Plot.PlotType.Grid,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.gridLayer=new hF.GridLayer(nZ.__assign({source:t},(0,iZ.pick)(this.options,hF.GridLayer.LayerOptionsKeys)));var n=new iyt.LayerGroup([this.gridLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),n.addLayer(this.labelLayer)),n},r.prototype.updateLayers=function(t){var n=(0,iZ.pick)(t,hF.GridLayer.LayerOptionsKeys);this.gridLayer.update(n),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},r.DefaultOptions=nyt.DEFAULT_OPTIONS,r}(aZ.Plot);XS.Grid=ayt;var YS={},TP={};Object.defineProperty(TP,"__esModule",{value:!0});TP.DEFAULT_OPTIONS=void 0;var oyt=cl,syt=ll;TP.DEFAULT_OPTIONS=(0,syt.deepAssign)({},oyt.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"hexagon",radius:15e3,method:"sum"}}});var vw={},MP={};Object.defineProperty(MP,"__esModule",{value:!0});MP.mappingLayer=void 0;var cC=Jp;function uyt(e,r){var t=r.shape,n=r.color,i=r.size,a=r.style,o=r.state;t&&cC.MappingLayer.shape(e,t),i&&cC.MappingLayer.size(e,i),n&&cC.MappingLayer.color(e,n),a&&cC.MappingLayer.style(e,a),o&&cC.MappingLayer.state(e,o)}MP.mappingLayer=uyt;Object.defineProperty(vw,"__esModule",{value:!0});vw.HexbinLayer=void 0;var pF=mi.exports,lyt=Ps,cyt=k_,dF=rg,fyt=MP,oZ={source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"hexagon",field:"",radius:15e3,method:"sum"}},shape:"hexagon",color:"#5FD3A6",style:{coverage:.9,angle:0,opacity:1}},hyt=["shape","color","size","style","state"],pyt=function(e){pF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.type=dF.PlotLayer.LayerType.HexbinLayer,n.interaction=!1;var i=n.options,a=i.name,o=i.source,s=n.pickLayerConfig(n.options);return n.name=a||(0,lyt.uniqueId)(n.type),n.layer=new cyt.HeatmapLayer(pF.__assign(pF.__assign({},s),{name:n.name})),n.mappingLayer(n.layer,n.options),n.setSource(o),n}return r.prototype.getDefaultOptions=function(){return oZ},r.prototype.mappingLayer=function(t,n){(0,fyt.mappingLayer)(t,n)},r.prototype.update=function(t){e.prototype.update.call(this,t),this.mappingLayer(this.layer,this.options)},r.DefaultOptions=oZ,r.LayerOptionsKeys=dF.PlotLayer.LayerConfigkeys.concat(hyt),r}(dF.PlotLayer);vw.HexbinLayer=pyt;Object.defineProperty(YS,"__esModule",{value:!0});YS.Hexbin=void 0;var sZ=mi.exports,uZ=Ps,lZ=cl,dyt=TP,vF=vw,vyt=xp,gyt=function(e){sZ.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=lZ.Plot.PlotType.Hexbin,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.hexbinLayer=new vF.HexbinLayer(sZ.__assign({source:t},(0,uZ.pick)(this.options,vF.HexbinLayer.LayerOptionsKeys)));var n=new vyt.LayerGroup([this.hexbinLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),n.addLayer(this.labelLayer)),n},r.prototype.updateLayers=function(t){var n=(0,uZ.pick)(t,vF.HexbinLayer.LayerOptionsKeys);this.hexbinLayer.update(n),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},r.DefaultOptions=dyt.DEFAULT_OPTIONS,r}(lZ.Plot);YS.Hexbin=gyt;var ZS={},LP={};Object.defineProperty(LP,"__esModule",{value:!0});LP.DEFAULT_OPTIONS=void 0;var myt=cl,yyt=ll;LP.DEFAULT_OPTIONS=(0,yyt.deepAssign)({},myt.Plot.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}});var z1={},qS={},IP={};Object.defineProperty(IP,"__esModule",{value:!0});IP.mappingLayer=void 0;var _x=Jp;function _yt(e,r){var t=r.shape,n=r.color,i=r.size,a=r.style,o=r.state,s=r.animate,u=r.texture;t&&_x.MappingLayer.shape(e,t),i&&_x.MappingLayer.size(e,i),n&&_x.MappingLayer.color(e,n),a&&_x.MappingLayer.style(e,a),o&&_x.MappingLayer.state(e,o),s&&_x.MappingLayer.animate(e,s),u&&_x.MappingLayer.texture(e,u)}IP.mappingLayer=_yt;Object.defineProperty(qS,"__esModule",{value:!0});qS.LinesLayer=void 0;var gF=mi.exports,xyt=Ps,byt=k_,mF=rg,wyt=IP,Cyt=N1,cZ={},Eyt=["shape","color","size","style","state","animate"],Syt=function(e){gF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.type=mF.PlotLayer.LayerType.LinesLayer,n.interaction=!0;var i=n.options,a=i.name,o=i.source,s=n.pickLayerConfig(n.options);return n.name=a||(0,xyt.uniqueId)(n.type),n.layer=new byt.LineLayer(gF.__assign(gF.__assign({},s),{name:n.name})),n.mappingLayer(n.layer,n.options),n.setSource(o),n}return r.prototype.getDefaultOptions=function(){return cZ},r.prototype.mappingLayer=function(t,n){(0,wyt.mappingLayer)(t,n)},r.prototype.update=function(t){e.prototype.update.call(this,t),this.mappingLayer(this.layer,this.options)},r.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&t.length!==0){var n=(0,Cyt.getColorLegendItems)(t);return n}return[]},r.DefaultOptions=cZ,r.LayerOptionsKeys=mF.PlotLayer.LayerConfigkeys.concat(Eyt),r}(mF.PlotLayer);qS.LinesLayer=Syt;Object.defineProperty(z1,"__esModule",{value:!0});z1.PathLayer=void 0;var Ayt=mi.exports,Tyt=ll,jT=qS,Myt=["color","size","style","state","animate"],Lyt=function(e){Ayt.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=jT.LinesLayer.LayerType.PathLayer,t}return r.prototype.getDefaultOptions=function(){return(0,Tyt.deepAssign)({},jT.LinesLayer.DefaultOptions,{shape:"line"})},r.LayerOptionsKeys=jT.LinesLayer.LayerConfigkeys.concat(Myt),r}(jT.LinesLayer);z1.PathLayer=Lyt;Object.defineProperty(ZS,"__esModule",{value:!0});ZS.Path=void 0;var fZ=mi.exports,hZ=Ps,pZ=cl,Iyt=LP,yF=z1,kyt=xp,Pyt=function(e){fZ.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=pZ.Plot.PlotType.Path,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.pathLayer=new yF.PathLayer(fZ.__assign({source:t},(0,hZ.pick)(this.options,yF.PathLayer.LayerOptionsKeys)));var n=new kyt.LayerGroup([this.pathLayer]);return n},r.prototype.updateLayers=function(t){var n=(0,hZ.pick)(t,yF.PathLayer.LayerOptionsKeys);this.pathLayer.update(n)},r.prototype.getLegendOptions=function(){var t=this.pathLayer.getColorLegendItems();return t.length!==0?{type:"category",items:t}:{}},r.DefaultOptions=Iyt.DEFAULT_OPTIONS,r}(pZ.Plot);ZS.Path=Pyt;var KS={},kP={};Object.defineProperty(kP,"__esModule",{value:!0});kP.DEFAULT_OPTIONS=void 0;var Ryt=cl,Oyt=ll;kP.DEFAULT_OPTIONS=(0,Oyt.deepAssign)({},Ryt.Plot.DefaultOptions,{source:{data:[],parser:{type:"json"}},shape:"arc"});var gw={};Object.defineProperty(gw,"__esModule",{value:!0});gw.ArcLayer=void 0;var Fyt=mi.exports,Dyt=ll,_F=qS,Byt=function(e){Fyt.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=_F.LinesLayer.LayerType.ArcLayer,t}return r.prototype.getDefaultOptions=function(){return(0,Dyt.deepAssign)({},_F.LinesLayer.DefaultOptions,{shape:"arc"})},r}(_F.LinesLayer);gw.ArcLayer=Byt;Object.defineProperty(KS,"__esModule",{value:!0});KS.Flow=void 0;var x0=mi.exports,dZ=Ps,vZ=cl,Nyt=kP,xF=gw,zyt=pm,$yt=I_,Uyt=xp,Vyt=function(e){x0.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=vZ.Plot.PlotType.Flow,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.flowLayer=new xF.ArcLayer(x0.__assign({name:"flowLayer",source:t},(0,dZ.pick)(this.options,xF.ArcLayer.LayerOptionsKeys)));var n=new Uyt.LayerGroup([this.flowLayer]);return this.options.radiation&&(this.radiationLayer=this.createRadiationLayer(t),n.addLayer(this.radiationLayer)),this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label),n.addLayer(this.labelLayer)),n},r.prototype.parserPointData=function(t){var n=[];return t.data.dataArray.forEach(function(i){var a=i.coordinates,o=x0.__read(a,2),s=o[1];n.push(x0.__assign(x0.__assign({},i),{coordinates:s}))}),n},r.prototype.createRadiationLayer=function(t){var n=this,i=this.parserPointData(t),a=this.options.radiation||{},o=a.enabled,s=o===void 0?!0:o,u=a.color,l=a.size,f=l===void 0?20:l,h=a.shape,p=h===void 0?"circle":h,v=a.animate,m=v===void 0?!0:v,x=new zyt.DotLayer({name:"radiationLayer",source:{data:i,parser:{type:"json",coordinates:"coordinates"}},visible:s,color:u,size:f,shape:p,animate:m}),E=function(){var A=n.parserPointData(n.source);x.layer.setData(A)};return t.on("update",E),x.on("remove",function(){t.off("update",E)}),x},r.prototype.createLabelLayer=function(t,n){var i=this,a=this.parserPointData(t),o=this.options,s=o.visible,u=o.minZoom,l=o.maxZoom,f=o.zIndex,h=f===void 0?0:f,p=new $yt.TextLayer(x0.__assign({name:"labelLayer",source:{data:a,parser:{type:"json",coordinates:"coordinates"}},visible:s,minZoom:u,maxZoom:l,zIndex:h+.1},n)),v=function(){var m=i.parserPointData(i.source);p.layer.setData(m)};return t.on("update",v),p.on("remove",function(){t.off("update",v)}),p},r.prototype.updateLayers=function(t){var n=(0,dZ.pick)(t,xF.ArcLayer.LayerOptionsKeys);if(this.flowLayer.update(n),t.radiation)if(this.radiationLayer){var i=x0.__assign(x0.__assign({},t.radiation),{visible:t.radiation.enabled});this.radiationLayer.update(i)}else this.radiationLayer=this.createRadiationLayer(this.source),this.layerGroup.addLayer(this.radiationLayer);this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},r.prototype.getLegendOptions=function(){var t=this.flowLayer.getColorLegendItems();return t.length!==0?{type:"category",items:t}:{}},r.DefaultOptions=Nyt.DEFAULT_OPTIONS,r}(vZ.Plot);KS.Flow=Vyt;var QS={},PP={};Object.defineProperty(PP,"__esModule",{value:!0});PP.DEFAULT_OPTIONS=void 0;var Gyt=cl,Hyt=ll;PP.DEFAULT_OPTIONS=(0,Hyt.deepAssign)({},Gyt.Plot.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}});var $1={},Whe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.mappingLayer=e.getDefaultState=void 0;var r=Ps,t=Jp,n="#2f54eb",i={active:{fill:!1,stroke:n,lineWidth:1.5,lineOpacity:.8},select:{fill:!1,stroke:n,lineWidth:1.5,lineOpacity:.8}},a=function(s){return(0,r.isUndefined)(s)||(s.active===!1?i.active=Object.assign(i.active,{fill:!1,stroke:!1}):typeof s.active=="object"&&(s.active.fill===!1?i.active.fill=!1:typeof s.active.fill=="string"&&(i.active.fill=s.active.fill),s.active.stroke===!1?i.active.stroke=!1:typeof s.active.stroke=="string"&&(i.active.stroke=s.active.stroke),typeof s.active.lineWidth=="number"&&(i.active.lineWidth=s.active.lineWidth),typeof s.active.lineOpacity=="number"&&(i.active.lineOpacity=s.active.lineOpacity)),s.select===!1?i.select=Object.assign(i.select,{fill:!1,stroke:!1}):typeof s.select=="object"&&(s.select.fill===!1?i.select.fill=!1:typeof s.select.fill=="string"&&(i.select.fill=s.select.fill),s.select.stroke===!1?i.select.stroke=!1:typeof s.select.stroke=="string"&&(i.select.stroke=s.select.stroke),typeof s.select.lineWidth=="number"&&(i.select.lineWidth=s.select.lineWidth),typeof s.select.lineOpacity=="number"&&(i.select.lineOpacity=s.select.lineOpacity))),i};e.getDefaultState=a;function o(s,u,l,f,h,p){var v=p.color,m=p.style,x=p.state,E=(0,e.getDefaultState)(x),A={active:E.active.fill===!1?!1:{color:E.active.fill},select:!1},L={opacity:m==null?void 0:m.opacity},k=m==null?void 0:m.fillBottomColor,R=m==null?void 0:m.lineWidth,D=m==null?void 0:m.stroke,$={opacity:m==null?void 0:m.lineOpacity,dashArray:m==null?void 0:m.lineDash,lineType:m==null?void 0:m.lineType};if(t.MappingLayer.shape(s,"fill"),v&&t.MappingLayer.color(s,v),L&&t.MappingLayer.style(s,L),A&&t.MappingLayer.state(s,A),k&&s.setBottomColor(k),t.MappingLayer.shape(u,"line"),R&&t.MappingLayer.size(u,R),D&&t.MappingLayer.color(u,D),$&&t.MappingLayer.style(u,$),E.active.stroke){var j=E.active.stroke,H=E.active.lineWidth||R,ee={opacity:E.active.lineOpacity};t.MappingLayer.shape(l,"line"),H&&t.MappingLayer.size(l,H),j&&t.MappingLayer.color(l,j),ee&&t.MappingLayer.style(l,ee)}if(E.select.fill){var U=E.select.fill;t.MappingLayer.shape(f,"fill"),U&&t.MappingLayer.color(f,U),L&&t.MappingLayer.style(f,L),t.MappingLayer.state(f,{select:!1,active:!1})}if(E.select.stroke){var W=E.select.stroke,H=E.select.lineWidth||R,Q={opacity:E.select.lineOpacity};t.MappingLayer.shape(h,"line"),H&&t.MappingLayer.size(h,H),W&&t.MappingLayer.color(h,W),Q&&t.MappingLayer.style(h,Q)}}e.mappingLayer=o})(Whe);Object.defineProperty($1,"__esModule",{value:!0});$1.AreaLayer=void 0;var bF=mi.exports,xx=Ps,fC=k_,wF=rg,hC=Whe,jyt=N1,gZ={visible:!0,state:{active:!1,select:!1},enabledMultiSelect:!1},Wyt=["color","style","state","enabledMultiSelect"],Xyt=function(e){bF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.selectData=[],n.type=wF.PlotLayer.LayerType.AreaLayer,n.interaction=!0,n.onHighlighHandle=function(m){var x=m.feature,E=m.featureId;n.setHighlightLayerSource(x,E)},n.onUnhighlighHandle=function(){n.setHighlightLayerSource()},n.onSelectHandle=function(m){var x=n.options.enabledMultiSelect,E=m.feature,A=m.featureId,L=(0,xx.clone)(n.selectData),k=L.findIndex(function(D){return D.featureId===A});if(k===-1)x?L.push({feature:E,featureId:A}):L=[{feature:E,featureId:A}],n.emit("select",E,(0,xx.clone)(L));else{var R=L[k];x?L.splice(k,1):L=[],n.emit("unselect",R,(0,xx.clone)(L))}n.setSelectLayerSource(L)};var i=n.options,a=i.name,o=i.source,s=i.visible,u=i.minZoom,l=i.maxZoom,f=i.zIndex,h=f===void 0?0:f,p=n.pickLayerConfig(n.options),v=(0,hC.getDefaultState)(n.options.state);return n.name=a||(0,xx.uniqueId)(n.type),n.layer=new fC.PolygonLayer(bF.__assign(bF.__assign({},p),{name:n.name})),n.strokeLayer=new fC.LineLayer({name:"strokeLayer",visible:s,zIndex:h,minZoom:u,maxZoom:l}),n.highlightLayer=new fC.LineLayer({name:"highlightLayer",visible:s&&Boolean(v.active.stroke),zIndex:h+.1,minZoom:u,maxZoom:l}),n.selectFillLayer=new fC.PolygonLayer({name:"selectFillLayer",visible:s&&Boolean(v.select.fill),zIndex:h+.1,minZoom:u,maxZoom:l}),n.selectStrokeLayer=new fC.LineLayer({name:"selectStrokeLayer",visible:s&&Boolean(v.select.stroke),zIndex:h+.1,minZoom:u,maxZoom:l}),n.mappingLayer(n.options),n.setSource(o),n.initEvent(),n}return r.prototype.getDefaultOptions=function(){return gZ},r.prototype.mappingLayer=function(t){(0,hC.mappingLayer)(this.layer,this.strokeLayer,this.highlightLayer,this.selectFillLayer,this.selectStrokeLayer,t)},r.prototype.setSource=function(t){e.prototype.setSource.call(this,t),this.setStrokeLayerSource(),this.setHighlightLayerSource(),this.selectFillLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.selectStrokeLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}})},r.prototype.setStrokeLayerSource=function(){var t=this.layer.getSource();if(t)this.strokeLayer.setSource(t);else{var n=this.layer.sourceOption,i=n.data,a=n.options;this.strokeLayer.source(i,a)}},r.prototype.setHighlightLayerSource=function(t,n){if(n===void 0&&(n=-999),this.highlightLayerData!==n){var i=t?[t]:[];this.highlightLayer.setData({type:"FeatureCollection",features:i},{parser:{type:"geojson"}}),this.highlightLayerData=n}},r.prototype.setSelectLayerSource=function(t){if(t===void 0&&(t=[]),!(this.selectData.length===t.length&&(0,xx.isEqual)(this.selectData.map(function(i){var a=i.featureId;return a}),t.map(function(i){var a=i.featureId;return a})))){var n=t.map(function(i){var a=i.feature;return a});this.selectFillLayer.setData({type:"FeatureCollection",features:n},{parser:{type:"geojson"}}),this.selectStrokeLayer.setData({type:"FeatureCollection",features:n},{parser:{type:"geojson"}}),this.selectData=t}},r.prototype.initEvent=function(){this.layer.off("mousemove",this.onHighlighHandle),this.layer.off("unmousemove",this.onHighlighHandle),this.layer.off("click",this.onSelectHandle),this.selectData=[],this.highlightLayerData=null,this.options.state&&(this.options.state.active&&(this.layer.on("mousemove",this.onHighlighHandle),this.layer.on("unmousemove",this.onUnhighlighHandle)),this.options.state.select&&this.layer.on("click",this.onSelectHandle))},r.prototype.addTo=function(t){t.addLayer(this.layer),t.addLayer(this.strokeLayer),t.addLayer(this.highlightLayer),t.addLayer(this.selectFillLayer),t.addLayer(this.selectStrokeLayer)},r.prototype.remove=function(t){t.removeLayer(this.layer),t.removeLayer(this.strokeLayer),t.removeLayer(this.highlightLayer),t.removeLayer(this.selectFillLayer),t.removeLayer(this.selectStrokeLayer)},r.prototype.update=function(t){if(e.prototype.update.call(this,t),this.mappingLayer(this.options),this.options.visible){!(0,xx.isUndefined)(t.state)&&!(0,xx.isEqual)(this.lastOptions.state,this.options.state)&&this.updateHighlightLayer();var n=(0,hC.getDefaultState)(this.options.state);n.active.stroke&&this.setHighlightLayerSource(),(n.select.fill||n.select.stroke)&&this.setSelectLayerSource()}this.initEvent()},r.prototype.updateHighlightLayer=function(){var t=(0,hC.getDefaultState)(this.options.state),n=(0,hC.getDefaultState)(this.lastOptions.state);n.active.stroke!==t.active.stroke&&(t.active.stroke?this.highlightLayer.show():this.highlightLayer.hide()),n.select.fill!==t.select.fill&&(t.select.fill?this.selectFillLayer.show():this.selectFillLayer.hide()),n.select.stroke!==t.select.stroke&&(t.select.stroke?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())},r.prototype.setIndex=function(t){this.layer.setIndex(t),this.strokeLayer.setIndex(t),this.highlightLayer.setIndex(t+.1),this.selectFillLayer.setIndex(t+.1),this.selectStrokeLayer.setIndex(t+.1)},r.prototype.setMinZoom=function(t){this.layer.setMinZoom(t),this.strokeLayer.setMinZoom(t),this.highlightLayer.setMinZoom(t),this.selectFillLayer.setMinZoom(t),this.selectStrokeLayer.setMinZoom(t)},r.prototype.setMaxZoom=function(t){this.layer.setMaxZoom(t),this.strokeLayer.setMaxZoom(t),this.highlightLayer.setMaxZoom(t),this.selectFillLayer.setMaxZoom(t),this.selectStrokeLayer.setMaxZoom(t)},r.prototype.show=function(){!this.layer.inited||(this.layer.show(),this.strokeLayer.show(),this.selectFillLayer.show(),this.selectStrokeLayer.show())},r.prototype.hide=function(){!this.layer.inited||(this.layer.hide(),this.strokeLayer.hide(),this.selectFillLayer.hide(),this.selectStrokeLayer.hide())},r.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&t.length!==0){var n=(0,jyt.getColorLegendItems)(t);return n}return[]},r.prototype.setActive=function(t){},r.prototype.setSelect=function(t){},r.DefaultOptions=gZ,r.LayerOptionsKeys=wF.PlotLayer.LayerConfigkeys.concat(Wyt),r}(wF.PlotLayer);$1.AreaLayer=Xyt;Object.defineProperty(QS,"__esModule",{value:!0});QS.Area=void 0;var mZ=mi.exports,yZ=Ps,_Z=cl,Yyt=PP,CF=$1,Zyt=xp,qyt=function(e){mZ.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=_Z.Plot.PlotType.Area,t}return r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.createLayers=function(t){this.areaLayer=new CF.AreaLayer(mZ.__assign({source:t},(0,yZ.pick)(this.options,CF.AreaLayer.LayerOptionsKeys)));var n=new Zyt.LayerGroup([this.areaLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label,this.options),n.addLayer(this.labelLayer)),n},r.prototype.updateLayers=function(t){var n=(0,yZ.pick)(t,CF.AreaLayer.LayerOptionsKeys);this.areaLayer.update(n),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},r.prototype.initLayersEvent=function(){},r.prototype.getLegendOptions=function(){var t=this.areaLayer.getColorLegendItems();return t.length!==0?{type:"category",items:t}:{}},r.DefaultOptions=Yyt.DEFAULT_OPTIONS,r}(_Z.Plot);QS.Area=qyt;var JS={},RP={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CHINA_BOUNDARY_STYLE=e.GEO_AREA_URL=e.GEO_DATA_URL=e.DEFAULT_AREA_GRANULARITY=e.DEFAULT_OPTIONS=void 0;var r=cl,t=ll;e.DEFAULT_OPTIONS=(0,t.deepAssign)({},r.Plot.DefaultOptions,{source:{data:[],joinBy:{geoField:"adcode"}},viewLevel:{level:"country",adcode:"100000"},chinaBorder:!0}),e.DEFAULT_AREA_GRANULARITY={world:"country",country:"province",province:"city",city:"district",district:"district"},e.GEO_DATA_URL="https://gw.alipayobjects.com/os/alisis/geo-data-v0.1.2",e.GEO_AREA_URL="".concat(e.GEO_DATA_URL,"/choropleth-data"),e.CHINA_BOUNDARY_STYLE={national:{color:"red",width:1,opacity:1},dispute:{color:"red",width:1,opacity:.8,dashArray:[2,4]},coast:{color:"blue",width:.7,opacity:.8},hkm:{color:"gray",width:.7,opacity:.8,dashArray:[2,4]}}})(RP);var OP={};Object.defineProperty(OP,"__esModule",{value:!0});OP.createCountryBoundaryLayer=void 0;var Kyt=ll,EF=z1,xZ=RP,Qyt=function(e,r){var t=r||{},n=t.visible,i=t.minZoom,a=t.maxZoom,o=t.zIndex,s=o===void 0?0:o,u=t.chinaBorder,l=typeof u=="object"?(0,Kyt.deepAssign)({},xZ.CHINA_BOUNDARY_STYLE,u):xZ.CHINA_BOUNDARY_STYLE,f=e.features.filter(function(E){var A=E.properties;return["coast","national"].includes(A==null?void 0:A.type)}),h=e.features.filter(function(E){var A=E.properties;return(A==null?void 0:A.type)==="dispute"}),p=e.features.filter(function(E){var A=E.properties;return(A==null?void 0:A.type)==="hkm"}),v=new EF.PathLayer({name:"chinaBoundaryLayer",visible:n,minZoom:i,maxZoom:a,zIndex:s+.1,source:{data:{type:"FeatureCollection",features:f},parser:{type:"geojson"}},color:{field:"type",value:function(E){var A=E.type;return l[A].color}},size:{field:"type",value:function(E){var A=E.type;return l[A].width}},style:{opacity:["type",function(E){return l[E].opacity}]}}),m=new EF.PathLayer({name:"chinaHkmBoundaryLayer",visible:n,minZoom:i,maxZoom:a,zIndex:s+.1,source:{data:{type:"FeatureCollection",features:p},parser:{type:"geojson"}},color:l.hkm.color,size:l.hkm.width,style:{opacity:l.hkm.opacity,lineType:"dash",dashArray:l.hkm.dashArray}}),x=new EF.PathLayer({name:"chinaDisputeBoundaryLayer",visible:n,minZoom:i,maxZoom:a,zIndex:s+.1,source:{data:{type:"FeatureCollection",features:h},parser:{type:"geojson"}},color:l.dispute.color,size:l.dispute.width,style:{opacity:l.dispute.opacity,lineType:"dash",dashArray:l.dispute.dashArray}});return{chinaBoundaryLayer:v,chinaHkmBoundaryLayer:m,chinaDisputeBoundaryLayer:x}};OP.createCountryBoundaryLayer=Qyt;var Xhe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.unregisterCacheArea=e.hasCacheArea=e.getCacheArea=e.registerCacheAreas=e.registerCacheArea=e.AREA_CACHE=void 0,e.AREA_CACHE=new Map;function r(o,s){e.AREA_CACHE.set(o,s)}e.registerCacheArea=r;function t(o){o.forEach(function(s){e.AREA_CACHE.set(s.key,s.area)})}e.registerCacheAreas=t;function n(o){return e.AREA_CACHE.get(o)}e.getCacheArea=n;function i(o){return e.AREA_CACHE.has(o)}e.hasCacheArea=i;function a(o){return e.AREA_CACHE.delete(o)}e.unregisterCacheArea=a})(Xhe);var Wg={};function Yhe(e){return e}function s7(e){if(e==null)return Yhe;var r,t,n=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,u){u||(r=t=0);var l=2,f=s.length,h=new Array(f);for(h[0]=(r+=s[0])*n+a,h[1]=(t+=s[1])*i+o;l<f;)h[l]=s[l],++l;return h}}function Zhe(e){var r=s7(e.transform),t,n=1/0,i=n,a=-n,o=-n;function s(l){l=r(l),l[0]<n&&(n=l[0]),l[0]>a&&(a=l[0]),l[1]<i&&(i=l[1]),l[1]>o&&(o=l[1])}function u(l){switch(l.type){case"GeometryCollection":l.geometries.forEach(u);break;case"Point":s(l.coordinates);break;case"MultiPoint":l.coordinates.forEach(s);break}}e.arcs.forEach(function(l){for(var f=-1,h=l.length,p;++f<h;)p=r(l[f],f),p[0]<n&&(n=p[0]),p[0]>a&&(a=p[0]),p[1]<i&&(i=p[1]),p[1]>o&&(o=p[1])});for(t in e.objects)u(e.objects[t]);return[n,i,a,o]}function Jyt(e,r){for(var t,n=e.length,i=n-r;i<--n;)t=e[i],e[i++]=e[n],e[n]=t}function e0t(e,r){return typeof r=="string"&&(r=e.objects[r]),r.type==="GeometryCollection"?{type:"FeatureCollection",features:r.geometries.map(function(t){return bZ(e,t)})}:bZ(e,r)}function bZ(e,r){var t=r.id,n=r.bbox,i=r.properties==null?{}:r.properties,a=FP(e,r);return t==null&&n==null?{type:"Feature",properties:i,geometry:a}:n==null?{type:"Feature",id:t,properties:i,geometry:a}:{type:"Feature",id:t,bbox:n,properties:i,geometry:a}}function FP(e,r){var t=s7(e.transform),n=e.arcs;function i(f,h){h.length&&h.pop();for(var p=n[f<0?~f:f],v=0,m=p.length;v<m;++v)h.push(t(p[v],v));f<0&&Jyt(h,m)}function a(f){return t(f)}function o(f){for(var h=[],p=0,v=f.length;p<v;++p)i(f[p],h);return h.length<2&&h.push(h[0]),h}function s(f){for(var h=o(f);h.length<4;)h.push(h[0]);return h}function u(f){return f.map(s)}function l(f){var h=f.type,p;switch(h){case"GeometryCollection":return{type:h,geometries:f.geometries.map(l)};case"Point":p=a(f.coordinates);break;case"MultiPoint":p=f.coordinates.map(a);break;case"LineString":p=o(f.arcs);break;case"MultiLineString":p=f.arcs.map(o);break;case"Polygon":p=u(f.arcs);break;case"MultiPolygon":p=f.arcs.map(u);break;default:return null}return{type:h,coordinates:p}}return l(r)}function qhe(e,r){var t={},n={},i={},a=[],o=-1;r.forEach(function(l,f){var h=e.arcs[l<0?~l:l],p;h.length<3&&!h[1][0]&&!h[1][1]&&(p=r[++o],r[o]=l,r[f]=p)}),r.forEach(function(l){var f=s(l),h=f[0],p=f[1],v,m;if(v=i[h])if(delete i[v.end],v.push(l),v.end=p,m=n[p]){delete n[m.start];var x=m===v?v:v.concat(m);n[x.start=v.start]=i[x.end=m.end]=x}else n[v.start]=i[v.end]=v;else if(v=n[p])if(delete n[v.start],v.unshift(l),v.start=h,m=i[h]){delete i[m.end];var E=m===v?v:m.concat(v);n[E.start=m.start]=i[E.end=v.end]=E}else n[v.start]=i[v.end]=v;else v=[l],n[v.start=h]=i[v.end=p]=v});function s(l){var f=e.arcs[l<0?~l:l],h=f[0],p;return e.transform?(p=[0,0],f.forEach(function(v){p[0]+=v[0],p[1]+=v[1]})):p=f[f.length-1],l<0?[p,h]:[h,p]}function u(l,f){for(var h in l){var p=l[h];delete f[p.start],delete p.start,delete p.end,p.forEach(function(v){t[v<0?~v:v]=1}),a.push(p)}}return u(i,n),u(n,i),r.forEach(function(l){t[l<0?~l:l]||a.push([l])}),a}function t0t(e){return FP(e,Khe.apply(this,arguments))}function Khe(e,r,t){var n,i,a;if(arguments.length>1)n=r0t(e,r,t);else for(i=0,n=new Array(a=e.arcs.length);i<a;++i)n[i]=i;return{type:"MultiLineString",arcs:qhe(e,n)}}function r0t(e,r,t){var n=[],i=[],a;function o(h){var p=h<0?~h:h;(i[p]||(i[p]=[])).push({i:h,g:a})}function s(h){h.forEach(o)}function u(h){h.forEach(s)}function l(h){h.forEach(u)}function f(h){switch(a=h,h.type){case"GeometryCollection":h.geometries.forEach(f);break;case"LineString":s(h.arcs);break;case"MultiLineString":case"Polygon":u(h.arcs);break;case"MultiPolygon":l(h.arcs);break}}return f(r),i.forEach(t==null?function(h){n.push(h[0].i)}:function(h){t(h[0].g,h[h.length-1].g)&&n.push(h[0].i)}),n}function n0t(e){for(var r=-1,t=e.length,n,i=e[t-1],a=0;++r<t;)n=i,i=e[r],a+=n[0]*i[1]-n[1]*i[0];return Math.abs(a)}function i0t(e){return FP(e,Qhe.apply(this,arguments))}function Qhe(e,r){var t={},n=[],i=[];r.forEach(a);function a(u){switch(u.type){case"GeometryCollection":u.geometries.forEach(a);break;case"Polygon":o(u.arcs);break;case"MultiPolygon":u.arcs.forEach(o);break}}function o(u){u.forEach(function(l){l.forEach(function(f){(t[f=f<0?~f:f]||(t[f]=[])).push(u)})}),n.push(u)}function s(u){return n0t(FP(e,{type:"Polygon",arcs:[u]}).coordinates[0])}return n.forEach(function(u){if(!u._){var l=[],f=[u];for(u._=1,i.push(l);u=f.pop();)l.push(u),u.forEach(function(h){h.forEach(function(p){t[p<0?~p:p].forEach(function(v){v._||(v._=1,f.push(v))})})})}}),n.forEach(function(u){delete u._}),{type:"MultiPolygon",arcs:i.map(function(u){var l=[],f;if(u.forEach(function(x){x.forEach(function(E){E.forEach(function(A){t[A<0?~A:A].length<2&&l.push(A)})})}),l=qhe(e,l),(f=l.length)>1)for(var h=1,p=s(l[0]),v,m;h<f;++h)(v=s(l[h]))>p&&(m=l[0],l[0]=l[h],l[h]=m,p=v);return l}).filter(function(u){return u.length>0})}}function wZ(e,r){for(var t=0,n=e.length;t<n;){var i=t+n>>>1;e[i]<r?t=i+1:n=i}return t}function a0t(e){var r={},t=e.map(function(){return[]});function n(x,E){x.forEach(function(A){A<0&&(A=~A);var L=r[A];L?L.push(E):r[A]=[E]})}function i(x,E){x.forEach(function(A){n(A,E)})}function a(x,E){x.type==="GeometryCollection"?x.geometries.forEach(function(A){a(A,E)}):x.type in o&&o[x.type](x.arcs,E)}var o={LineString:n,MultiLineString:i,Polygon:i,MultiPolygon:function(x,E){x.forEach(function(A){i(A,E)})}};e.forEach(a);for(var s in r)for(var u=r[s],l=u.length,f=0;f<l;++f)for(var h=f+1;h<l;++h){var p=u[f],v=u[h],m;(m=t[p])[s=wZ(m,v)]!==v&&m.splice(s,0,v),(m=t[v])[s=wZ(m,p)]!==p&&m.splice(s,0,p)}return t}function Jhe(e){if(e==null)return Yhe;var r,t,n=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,u){u||(r=t=0);var l=2,f=s.length,h=new Array(f),p=Math.round((s[0]-a)/n),v=Math.round((s[1]-o)/i);for(h[0]=p-r,r=p,h[1]=v-t,t=v;l<f;)h[l]=s[l],++l;return h}}function o0t(e,r){if(e.transform)throw new Error("already quantized");if(!r||!r.scale){if(!((o=Math.floor(r))>=2))throw new Error("n must be \u22652");u=e.bbox||Zhe(e);var t=u[0],n=u[1],i=u[2],a=u[3],o;r={scale:[i-t?(i-t)/(o-1):1,a-n?(a-n)/(o-1):1],translate:[t,n]}}else u=e.bbox;var s=Jhe(r),u,l,f=e.objects,h={};function p(x){return s(x)}function v(x){var E;switch(x.type){case"GeometryCollection":E={type:"GeometryCollection",geometries:x.geometries.map(v)};break;case"Point":E={type:"Point",coordinates:p(x.coordinates)};break;case"MultiPoint":E={type:"MultiPoint",coordinates:x.coordinates.map(p)};break;default:return x}return x.id!=null&&(E.id=x.id),x.bbox!=null&&(E.bbox=x.bbox),x.properties!=null&&(E.properties=x.properties),E}function m(x){var E=0,A=1,L=x.length,k,R=new Array(L);for(R[0]=s(x[0],0);++E<L;)((k=s(x[E],E))[0]||k[1])&&(R[A++]=k);return A===1&&(R[A++]=[0,0]),R.length=A,R}for(l in f)h[l]=v(f[l]);return{type:"Topology",bbox:u,transform:r,objects:h,arcs:e.arcs.map(m)}}var s0t=Object.freeze(Object.defineProperty({__proto__:null,bbox:Zhe,feature:e0t,mesh:t0t,meshArcs:Khe,merge:i0t,mergeArcs:Qhe,neighbors:a0t,quantize:o0t,transform:s7,untransform:Jhe},Symbol.toStringTag,{value:"Module"})),u0t=ed(s0t);Object.defineProperty(Wg,"__esModule",{value:!0});Wg.getDrillStepDefaultConfig=Wg.isEqualDrillSteps=Wg.topojson2geojson=Wg.getGeoAreaConfig=void 0;var l0t=mi.exports,epe=Ps,c0t=l0t.__importStar(u0t),CZ=RP,f0t=function(e){var r={url:CZ.GEO_AREA_URL,type:"topojson",extension:"topo.json"};return(0,epe.isUndefined)(e)||(typeof e=="string"?r.url=e:(r.url=(e==null?void 0:e.url)||CZ.GEO_AREA_URL,r.type=e.type,r.extension=e.type==="topojson"?"topo.json":"json")),r};Wg.getGeoAreaConfig=f0t;var h0t=function(e){try{var r=c0t.feature(e,"json");return r}catch{throw new Error('Failed convert to geojson from topojson, topojson default layer name "json"')}};Wg.topojson2geojson=h0t;var p0t=function(e,r){if(e.length!==r.length)return!1;for(var t=0;t<e.length;t++){var n=e[t],i=n.level,a=n.granularity;if(r[t].level!==i||r[t].granularity!==a)return!1}return!0};Wg.isEqualDrillSteps=p0t;var d0t=function(e){var r=(0,epe.pick)(e,["source","color","style","state","label","tooltip"]);return r};Wg.getDrillStepDefaultConfig=d0t;Object.defineProperty(JS,"__esModule",{value:!0});JS.Choropleth=void 0;var Ec=mi.exports,bx=Ps,EZ=cl,Pb=ll,Ym=RP,SF=$1,v0t=I_,g0t=w1,m0t=xp,y0t=OP,SZ=Xhe,pC=Wg,_0t=function(e){Ec.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=EZ.Plot.PlotType.Choropleth,t.chinaBoundaryData={type:"FeatureCollection",features:[]},t.currentDistrictData={type:"FeatureCollection",features:[]},t.drillSteps=[],t.drillStacks=[],t.onDrillDownHander=function(n){var i,a=t.options.drill,o=a.steps,s=a.onDown,u=(i=n.feature)===null||i===void 0?void 0:i.properties,l=u.adcode;if(t.drillStacks.length!==o.length+1){var f=t.drillStacks.slice(-1)[0],h=t.drillStacks.length-1,p=t.drillSteps[h],v=p.level,m=p.granularity,x=m===void 0?Ym.DEFAULT_AREA_GRANULARITY[v]:m,E=Ec.__rest(p,["level","granularity"]),A={from:{level:f.level,adcode:f.adcode,granularity:f.granularity},to:{level:v,adcode:l,granularity:x,properties:u}},L=function(k){k===void 0&&(k={});var R={level:v,adcode:l,granularity:x},D=(0,Pb.deepAssign)({},E,k);t.changeView(R,D).then(function($){$&&(t.drillStacks.push($),t.emit("drilldown",A))})};s?s(A.from,A.to,L):L()}},t.onDrillUpHander=function(){var n=t.options.drill.onUp,i=t.drillStacks.length===0||t.drillStacks.length===1;if(!i){var a=t.drillStacks.length-1,o=t.drillStacks[a],s=t.drillStacks[a-1],u={from:{level:o.level,adcode:o.adcode,granularity:o.granularity},to:{level:s.level,adcode:s.adcode,granularity:s.granularity}},l=function(f){f===void 0&&(f={});var h=u.to,p=(0,Pb.deepAssign)({},s.config,f);t.changeView(h,p).then(function(v){v&&(t.drillStacks.pop(),t.emit("drillup",u))})};n?n(u.from,u.to,l):l()}},t}return r.prototype.initSource=function(){var t=this;this.getInitDistrictData().then(function(){t.source=t.createSource(),t.render(),t.inited=!0})},r.prototype.render=function(){var t=this;if(console.time("l7plot choropleth render time"),this.inited)this.scene.setEnableRender(!0),this.scene.render();else{var n=this.createLayers(this.source);this.layerGroup=n,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){t.onSceneLoaded()}),this.initLayersEvent()}console.timeEnd("l7plot choropleth render time")},r.prototype.update=function(t){var n=this,i,a,o;if(this.updateOption(t),t.map&&!(0,bx.isEqual)(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),t.drill&&t.drill.enabled!==!1&&!(0,bx.isEqual)((i=this.lastOptions.drill)===null||i===void 0?void 0:i.steps,(a=this.options.drill)===null||a===void 0?void 0:a.steps)&&(this.drillReset(),this.initDrillEvent()),this.scene.setEnableRender(!1),t.viewLevel&&!(0,bx.isEqual)(this.lastOptions.viewLevel,this.options.viewLevel)){var s=(o=t.source)===null||o===void 0?void 0:o.joinBy.geoData;console.time("l7plot choropleth update viewLevel time"),this.getDistrictData(s).then(function(){var h=n.options.source,p=h.data,v=Ec.__rest(h,["data"]);n.changeData(p,v),n.updateLayers(t),n.render(),n.updateComponents(),console.timeEnd("l7plot choropleth update viewLevel time"),n.emit("update")})}else{if(t.source&&!(0,bx.isEqual)(this.lastOptions.source,this.options.source)){var u=this.options.source,l=u.data,f=Ec.__rest(u,["data"]);this.changeData(l,f)}this.updateLayers(t),this.render(),this.updateComponents(),this.emit("update")}},r.prototype.getDefaultOptions=function(){return r.DefaultOptions},r.prototype.parserSourceConfig=function(t){var n=t.data,i=t.joinBy,a=Ec.__rest(t,["data","joinBy"]),o=i.sourceField,s=i.geoField,u=i.geoData,l=u,f={type:"join",sourceField:o,targetField:s,data:n};return a.transforms?a.transforms.push(f):a.transforms=[f],a.parser&&delete a.parser,{data:l,sourceCFG:a}},r.prototype.createSource=function(){var t=this.parserSourceConfig(this.options.source),n=t.data,i=t.sourceCFG,a=new g0t.Source(n,i);return a},r.prototype.changeData=function(t,n){var i=this;console.time("l7plot choropleth update data time"),this.options.source=(0,Pb.deepAssign)({},this.options.source,Ec.__assign({data:t},n));var a=this.parserSourceConfig(this.options.source),o=a.data,s=a.sourceCFG;this.source.setData(o,s),console.timeEnd("l7plot choropleth update data time");var u=this.options.legend;u&&setTimeout(function(){i.updateLegendControl(u)}),this.emit("change-data")},r.prototype.createLayers=function(t){this.fillAreaLayer=new SF.AreaLayer(Ec.__assign({name:"fillAreaLayer",source:t},(0,bx.pick)(this.options,SF.AreaLayer.LayerOptionsKeys)));var n=new m0t.LayerGroup([this.fillAreaLayer]);if(this.options.chinaBorder){var i=this.createCountryBoundaryLayer(this.chinaBoundaryData,this.options);i.forEach(function(a){return n.addLayer(a)})}return this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label),n.addLayer(this.labelLayer)),n},r.prototype.createCountryBoundaryLayer=function(t,n){var i=(0,y0t.createCountryBoundaryLayer)(t,n),a=i.chinaBoundaryLayer,o=i.chinaHkmBoundaryLayer,s=i.chinaDisputeBoundaryLayer;return this.chinaBoundaryLayer=a,this.chinaHkmBoundaryLayer=o,this.chinaDisputeBoundaryLayer=s,[a,o,s]},r.prototype.createLabelLayer=function(t,n){var i=this,a=t.originData.features.map(function(m){var x=m.properties;return Object.assign({},x,{centroid:x.centroid||x.center})}).filter(function(m){var x=m.centroid;return x}),o=this.options,s=o.visible,u=o.minZoom,l=o.maxZoom,f=o.zIndex,h=f===void 0?0:f,p=new v0t.TextLayer(Ec.__assign({name:"labelLayer",source:{data:a,parser:{type:"json",coordinates:"centroid"},transforms:t.transforms},visible:s,minZoom:u,maxZoom:l,zIndex:h+.1},n)),v=function(){var m=i.source.originData.features.map(function(x){var E=x.properties;return E}).filter(function(x){var E=x.centroid;return E});p.layer.setData(m)};return t.on("update",v),p.on("remove",function(){t.off("update",v)}),p},r.prototype.updateLayers=function(t){var n=this,i=(0,bx.pick)(t,SF.AreaLayer.LayerOptionsKeys);this.fillAreaLayer.update(i);var a=function(){var s=n.createCountryBoundaryLayer(n.chinaBoundaryData,n.options);s.forEach(function(u){return n.layerGroup.addLayer(u)})},o=function(){n.chinaBoundaryLayer&&n.layerGroup.removeLayer(n.chinaBoundaryLayer),n.chinaHkmBoundaryLayer&&n.layerGroup.removeLayer(n.chinaHkmBoundaryLayer),n.chinaDisputeBoundaryLayer&&n.layerGroup.removeLayer(n.chinaDisputeBoundaryLayer)};t.chinaBorder?(this.chinaBoundaryLayer&&o(),a()):t.chinaBorder===!1&&o(),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},r.prototype.initLayersEvent=function(){this.initDrillEvent()},r.prototype.initDrillEvent=function(){if(this.lastOptions.drill){var t=this.lastOptions.drill,n=t.triggerUp,i=n===void 0?"unclick":n,a=t.triggerDown,o=a===void 0?"click":a;this.fillAreaLayer.off(i,this.onDrillUpHander),this.fillAreaLayer.off(o,this.onDrillDownHander)}if(!(!this.options.drill||this.options.drill.enabled===!1)){var s=this.options.drill,u=s.steps,l=s.triggerUp,f=l===void 0?"unclick":l,h=s.triggerDown,p=h===void 0?"click":h,v=u.map(function(R){return typeof R=="string"?{level:R,granularity:Ym.DEFAULT_AREA_GRANULARITY[R]}:(R.granularity||(R.granularity=Ym.DEFAULT_AREA_GRANULARITY[R.level]),R)});if((0,pC.isEqualDrillSteps)(v,this.drillSteps)||(this.drillSteps=v,this.drillStacks=[]),!this.drillStacks.length){var m=this.options.viewLevel,x=m.level,E=m.adcode,A=m.granularity,L=A===void 0?Ym.DEFAULT_AREA_GRANULARITY[x]:A,k=(0,pC.getDrillStepDefaultConfig)(this.options);this.drillStacks=[{level:x,adcode:E,granularity:L,config:k}]}this.fillAreaLayer.on(f,this.onDrillUpHander),this.fillAreaLayer.on(p,this.onDrillDownHander)}},r.prototype.drillReset=function(){this.drillStacks=[]},r.prototype.getCurrentDrillSteps=function(){var t=this.drillStacks.map(function(n){return(0,bx.pick)(n,["level","adcode","granularity"])});return t},r.prototype.getLegendOptions=function(){var t=this.fillAreaLayer.getColorLegendItems();return t.length!==0?{type:"category",items:t}:{}},r.prototype.fetchData=function(t,n,i){return Ec.__awaiter(this,void 0,void 0,function(){var a,o,s,u,l,f,h,p;return Ec.__generator(this,function(v){switch(v.label){case 0:return a="".concat(n,"_").concat(t,"_").concat(i),o=(0,SZ.getCacheArea)(a),o?[2,o]:(s=(0,pC.getGeoAreaConfig)(this.options.geoArea),u=s.url,l=s.type,f=s.extension,[4,fetch("".concat(u,"/").concat(t,"/").concat(a,".").concat(f))]);case 1:return h=v.sent(),[4,h.json()];case 2:return p=v.sent(),l==="topojson"&&(p=(0,pC.topojson2geojson)(p)),(0,SZ.registerCacheArea)(a,p),[2,p]}})})},r.prototype.getInitDistrictData=function(){var t;return Ec.__awaiter(this,void 0,void 0,function(){var n,i,a,o;return Ec.__generator(this,function(s){switch(s.label){case 0:n=this.fetchData("country","100000","boundary"),i=(t=this.options.source)===null||t===void 0?void 0:t.joinBy.geoData,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all([n,this.getDistrictData(i)])];case 2:return o=Ec.__read.apply(void 0,[s.sent(),1]),this.chinaBoundaryData=o[0],[3,4];case 3:throw a=s.sent(),new Error("Failed to get china boundary data\uFF0C".concat(a));case 4:return[2]}})})},r.prototype.getDistrictData=function(t){return Ec.__awaiter(this,void 0,void 0,function(){var n,i,a,o,s,u,l,f;return Ec.__generator(this,function(h){switch(h.label){case 0:n=this.options.viewLevel,i=n.level,a=n.adcode,o=n.granularity,s=o===void 0?Ym.DEFAULT_AREA_GRANULARITY[i]:o,u=t?Promise.resolve(t):this.fetchData(i,a,s),h.label=1;case 1:return h.trys.push([1,3,,4]),l=this,[4,u];case 2:return l.currentDistrictData=h.sent(),this.options.source=(0,Pb.deepAssign)({},this.options.source,{joinBy:{geoData:this.currentDistrictData}}),[3,4];case 3:throw f=h.sent(),new Error("Failed to get district data\uFF0C".concat(f));case 4:return[2]}})})},r.prototype.drillDown=function(t,n){var i=this;n===void 0&&(n={}),this.changeView(t,n).then(function(a){a&&i.drillStacks.push(a)})},r.prototype.drillUp=function(t,n){t===void 0&&(t={});var i=this.drillStacks.length,a=[0,1].includes(i);if(!a){var o=n?this.drillStacks.findIndex(function(v){return v.level===n}):-1,s=o!==-1,u=s?o:i-2,l=this.drillStacks[u],f=l.config,h=Ec.__rest(l,["config"]),p=(0,Pb.deepAssign)({},f,t);this.changeView(h,p),s?this.drillStacks.splice(o+1):this.drillStacks.pop()}},r.prototype.changeView=function(t,n){return n===void 0&&(n={}),Ec.__awaiter(this,void 0,void 0,function(){var i,a,o,s,u,l,f;return Ec.__generator(this,function(h){switch(h.label){case 0:return i=t.level,a=t.adcode,o=t.granularity,s=o===void 0?Ym.DEFAULT_AREA_GRANULARITY[i]:o,[4,this.fetchData(i,a,s)];case 1:return u=h.sent(),u.features.length?(l=(0,Pb.deepAssign)({},(0,pC.getDrillStepDefaultConfig)(this.options),n,{viewLevel:{level:i,adcode:a,granularity:s},source:{joinBy:{geoData:u}}}),this.update(l),f={level:i,adcode:a,granularity:s,config:l},[2,f]):[2]}})})},r.DefaultOptions=Ym.DEFAULT_OPTIONS,r.GeoDataUrl=Ym.GEO_DATA_URL,r.GeoAreaUrl=Ym.GEO_AREA_URL,r}(EZ.Plot);JS.Choropleth=_0t;var eA={};Object.defineProperty(eA,"__esModule",{value:!0});eA.IconLayer=void 0;var x0t=mi.exports,b0t=ll,AF=pm,w0t=function(e){x0t.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=AF.DotLayer.LayerType.IconLayer,t}return r.prototype.getDefaultOptions=function(){return(0,b0t.deepAssign)({},AF.DotLayer.DefaultOptions,{color:void 0})},r}(AF.DotLayer);eA.IconLayer=w0t;var DP={};Object.defineProperty(DP,"__esModule",{value:!0});DP.ColumnLayer=void 0;var C0t=mi.exports,E0t=ll,TF=pm,S0t=function(e){C0t.__extends(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=TF.DotLayer.LayerType.ColumnLayer,t}return r.prototype.getDefaultOptions=function(){return(0,E0t.deepAssign)({},TF.DotLayer.DefaultOptions,{shape:"cylinder"})},r}(TF.DotLayer);DP.ColumnLayer=S0t;var tA={},BP={};Object.defineProperty(BP,"__esModule",{value:!0});BP.mappingLayer=void 0;var dC=Jp;function A0t(e,r){var t=r.color,n=r.size,i=r.style,a=r.state;dC.MappingLayer.shape(e,"extrude"),n&&dC.MappingLayer.size(e,n),t&&dC.MappingLayer.color(e,t),i&&dC.MappingLayer.style(e,i),a&&dC.MappingLayer.state(e,a)}BP.mappingLayer=A0t;Object.defineProperty(tA,"__esModule",{value:!0});tA.PrismLayer=void 0;var MF=mi.exports,T0t=Ps,M0t=k_,LF=rg,L0t=BP,I0t=N1,AZ={},k0t=["color","size","style","state"],P0t=function(e){MF.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.type=LF.PlotLayer.LayerType.PrismLayer,n.interaction=!0;var i=n.options,a=i.name,o=i.source,s=n.pickLayerConfig(n.options);return n.name=a||(0,T0t.uniqueId)(n.type),n.layer=new M0t.PolygonLayer(MF.__assign(MF.__assign({},s),{name:n.name})),n.mappingLayer(n.layer,n.options),n.setSource(o),n}return r.prototype.getDefaultOptions=function(){return AZ},r.prototype.mappingLayer=function(t,n){(0,L0t.mappingLayer)(t,n)},r.prototype.update=function(t){e.prototype.update.call(this,t),this.mappingLayer(this.layer,this.options)},r.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&t.length!==0){var n=(0,I0t.getColorLegendItems)(t);return n}return[]},r.DefaultOptions=AZ,r.LayerOptionsKeys=LF.PlotLayer.LayerConfigkeys.concat(k0t),r}(LF.PlotLayer);tA.PrismLayer=P0t;var zv,qh;Object.defineProperty(R2,"__esModule",{value:!0});R2.LAYERS_MAP=R2.PLOTS_MAP=void 0;var ml=w1,R0t=HS,O0t=jS,F0t=WS,D0t=XS,B0t=YS,N0t=ZS,z0t=KS,$0t=QS,U0t=JS,V0t=I_,G0t=pm,H0t=eA,j0t=DP,W0t=hw,X0t=dw,Y0t=vw,Z0t=z1,q0t=gw,K0t=pw,Q0t=$1,J0t=tA;R2.PLOTS_MAP=(zv={},zv[ml.PlotType.Dot]=R0t.Dot,zv[ml.PlotType.DotDensity]=O0t.DotDensity,zv[ml.PlotType.Heatmap]=F0t.Heatmap,zv[ml.PlotType.Grid]=D0t.Grid,zv[ml.PlotType.Hexbin]=B0t.Hexbin,zv[ml.PlotType.Path]=N0t.Path,zv[ml.PlotType.Flow]=z0t.Flow,zv[ml.PlotType.Area]=$0t.Area,zv[ml.PlotType.Choropleth]=U0t.Choropleth,zv);R2.LAYERS_MAP=(qh={},qh[ml.LayerType.TextLayer]=V0t.TextLayer,qh[ml.LayerType.DotLayer]=G0t.DotLayer,qh[ml.LayerType.IconLayer]=H0t.IconLayer,qh[ml.LayerType.DotDensity]=W0t.DotDensityLayer,qh[ml.LayerType.ColumnLayer]=j0t.ColumnLayer,qh[ml.LayerType.HeatmapLayer]=K0t.HeatmapLayer,qh[ml.LayerType.GridLayer]=X0t.GridLayer,qh[ml.LayerType.HexbinLayer]=Y0t.HexbinLayer,qh[ml.LayerType.PathLayer]=Z0t.PathLayer,qh[ml.LayerType.ArcLayer]=q0t.ArcLayer,qh[ml.LayerType.AreaLayer]=Q0t.AreaLayer,qh[ml.LayerType.PrismLayer]=J0t.PrismLayer,qh);Object.defineProperty(_P,"__esModule",{value:!0});_P.L7Plot=void 0;var WT=mi.exports,TZ=Ps,MZ=tw,e_t=ll,t_t=xp,LZ=R2,r_t={},n_t=function(e){WT.__extends(r,e);function r(t,n){var i=e.call(this,n)||this;return i.plots=[],i.container=i.createContainer(t),i.theme=i.createTheme(),i.scene=i.createScene(),i.registerResources(),i.render(),i.inited=!0,i}return r.prototype.getDefaultOptions=function(){return(0,e_t.deepAssign)({},MZ.Map.DefaultOptions,r.DefaultOptions)},r.prototype.createLayers=function(){for(var t=new t_t.LayerGroup([]),n=this.options.layers||[],i=0;i<n.length;i++){var a=this.createLayer(n[i]);t.addLayer(a)}return t},r.prototype.createLayer=function(t){var n=t.type,i=WT.__rest(t,["type"]),a=LZ.LAYERS_MAP[n];if((0,TZ.isUndefined)(a))throw new Error("Don't exist ".concat(n," layer"));var o=new a(i);return o},r.prototype.addLayer=function(t){var n=function(a){return typeof a.render=="function"};if(n(t))e.prototype.addLayer.call(this,t);else{var i=this.createLayer(t);e.prototype.addLayer.call(this,i)}},r.prototype.removeLayerByName=function(t){var n=this.layerGroup.getLayerByName(t);return n?this.layerGroup.removeLayer(n):!1},r.prototype.updateLayers=function(t){},r.prototype.updatePlots=function(t){},r.prototype.render=function(){var t=this,n=this.createLayers();this.inited?(this.layerGroup.removeAllLayer(),n.addTo(this.scene),this.layerGroup=n,this.updateControls()):(this.layerGroup=n,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){t.onSceneLoaded()}))},r.prototype.onSceneLoaded=function(){var t=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",function(){t.onLayersLoaded()}),this.layerGroup.addTo(this.scene)},r.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.renderPlots(),this.initControls(),this.loaded=!0,this.emit("loaded")},r.prototype.renderPlots=function(){for(var t=this.options.plots||[],n=0;n<t.length;n++){var i=t[n],a=this.createPlot(i);this.plots.push(a)}},r.prototype.createPlot=function(t){var n=t.type;t.legend,t.layerMenu;var i=WT.__rest(t,["type","legend","layerMenu"]),a=LZ.PLOTS_MAP[n];if((0,TZ.isUndefined)(a))throw new Error("Don't exist ".concat(n," plot"));var o=new a(i);return o.attachToScene(this.scene,this.theme),o},r.prototype.addPlot=function(t){var n=this.createPlot(t);this.plots.push(n)},r.prototype.getPlots=function(){return this.plots},r.prototype.getPlotByName=function(t){return this.plots.find(function(n){var i;return((i=n.options)===null||i===void 0?void 0:i.name)===t})},r.prototype.removePlotByName=function(t){var n=this.plots.findIndex(function(o){var s;return((s=o.options)===null||s===void 0?void 0:s.name)===t});if(n===-1)return!1;var i=WT.__read(this.plots.splice(n,1),1),a=i[0];return a.unattachFromScene(),!0},r.prototype.removeAllPlot=function(){this.plots.forEach(function(t){t.unattachFromScene()}),this.plots=[]},r.DefaultOptions=r_t,r}(MZ.Map);_P.L7Plot=n_t;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Choropleth=e.Area=e.Flow=e.Path=e.Hexbin=e.Grid=e.Heatmap=e.DotDensity=e.Dot=e.PrismLayer=e.AreaLayer=e.ArcLayer=e.PathLayer=e.HexbinLayer=e.GridLayer=e.HeatmapLayer=e.TextLayer=e.DotDensityLayer=e.IconLayer=e.DotLayer=e.L7Plot=e.Plot=e.Map=e.registerTheme=e.getTheme=e.unregisterIconFont=e.registerIconFonts=e.registerIconFont=e.unregisterFontFace=e.registerFontFace=e.unregisterImage=e.registerImages=e.registerImage=e.version=void 0;var r=mi.exports,t=vB;Object.defineProperty(e,"version",{enumerable:!0,get:function(){return r.__importDefault(t).default}});var n=gB;Object.defineProperty(e,"registerImage",{enumerable:!0,get:function(){return n.registerImage}}),Object.defineProperty(e,"registerImages",{enumerable:!0,get:function(){return n.registerImages}}),Object.defineProperty(e,"unregisterImage",{enumerable:!0,get:function(){return n.unregisterImage}}),Object.defineProperty(e,"registerFontFace",{enumerable:!0,get:function(){return n.registerFontFace}}),Object.defineProperty(e,"unregisterFontFace",{enumerable:!0,get:function(){return n.unregisterFontFace}}),Object.defineProperty(e,"registerIconFont",{enumerable:!0,get:function(){return n.registerIconFont}}),Object.defineProperty(e,"registerIconFonts",{enumerable:!0,get:function(){return n.registerIconFonts}}),Object.defineProperty(e,"unregisterIconFont",{enumerable:!0,get:function(){return n.unregisterIconFont}});var i=a_;Object.defineProperty(e,"getTheme",{enumerable:!0,get:function(){return i.getTheme}}),Object.defineProperty(e,"registerTheme",{enumerable:!0,get:function(){return i.registerTheme}}),r.__exportStar(w1,e);var a=tw;Object.defineProperty(e,"Map",{enumerable:!0,get:function(){return a.Map}});var o=cl;Object.defineProperty(e,"Plot",{enumerable:!0,get:function(){return o.Plot}});var s=_P;Object.defineProperty(e,"L7Plot",{enumerable:!0,get:function(){return s.L7Plot}});var u=pm;Object.defineProperty(e,"DotLayer",{enumerable:!0,get:function(){return u.DotLayer}});var l=eA;Object.defineProperty(e,"IconLayer",{enumerable:!0,get:function(){return l.IconLayer}});var f=hw;Object.defineProperty(e,"DotDensityLayer",{enumerable:!0,get:function(){return f.DotDensityLayer}});var h=I_;Object.defineProperty(e,"TextLayer",{enumerable:!0,get:function(){return h.TextLayer}});var p=pw;Object.defineProperty(e,"HeatmapLayer",{enumerable:!0,get:function(){return p.HeatmapLayer}});var v=dw;Object.defineProperty(e,"GridLayer",{enumerable:!0,get:function(){return v.GridLayer}});var m=vw;Object.defineProperty(e,"HexbinLayer",{enumerable:!0,get:function(){return m.HexbinLayer}});var x=z1;Object.defineProperty(e,"PathLayer",{enumerable:!0,get:function(){return x.PathLayer}});var E=gw;Object.defineProperty(e,"ArcLayer",{enumerable:!0,get:function(){return E.ArcLayer}});var A=$1;Object.defineProperty(e,"AreaLayer",{enumerable:!0,get:function(){return A.AreaLayer}});var L=tA;Object.defineProperty(e,"PrismLayer",{enumerable:!0,get:function(){return L.PrismLayer}});var k=HS;Object.defineProperty(e,"Dot",{enumerable:!0,get:function(){return k.Dot}});var R=jS;Object.defineProperty(e,"DotDensity",{enumerable:!0,get:function(){return R.DotDensity}});var D=WS;Object.defineProperty(e,"Heatmap",{enumerable:!0,get:function(){return D.Heatmap}});var $=XS;Object.defineProperty(e,"Grid",{enumerable:!0,get:function(){return $.Grid}});var j=YS;Object.defineProperty(e,"Hexbin",{enumerable:!0,get:function(){return j.Hexbin}});var H=ZS;Object.defineProperty(e,"Path",{enumerable:!0,get:function(){return H.Path}});var ee=KS;Object.defineProperty(e,"Flow",{enumerable:!0,get:function(){return ee.Flow}});var U=QS;Object.defineProperty(e,"Area",{enumerable:!0,get:function(){return U.Area}});var W=JS;Object.defineProperty(e,"Choropleth",{enumerable:!0,get:function(){return W.Choropleth}})})(zte);var i_t=function(e,r){!e||(kn(e)?e(r):e.current=r)},eE=globalThis&&globalThis.__assign||function(){return eE=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},eE.apply(this,arguments)},a_t=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},IZ=function(e){var r=e.source,t=a_t(e,["source"]),n=eE(eE({},y3(t)),{source:eE({},r)});return n},y3=function(e){if(!e||typeof e!="object")return e;var r;return Array.isArray(e)?r=e.map(function(t){return y3(t)}):(r={},Object.keys(e).forEach(function(t){return r[t]=y3(e[t])})),r},_3=globalThis&&globalThis.__assign||function(){return _3=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_3.apply(this,arguments)},XT=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};function o_t(e,r){var t=ut.exports.useRef(),n=ut.exports.useRef(),i=ut.exports.useRef(null),a=r.onReady;return ut.exports.useEffect(function(){if(!(!t.current||!n.current||rs(n.current,r))){var o=!1,s=!1,u=!1,l=n.current;l.onReady;var f=l.map,h=l.source,p=h.data,v=XT(h,["data"]),m=XT(l,["onReady","map","source"]);r.onReady;var x=r.map,E=r.source,A=E.data,L=XT(E,["data"]),k=XT(r,["onReady","map","source"]);if(s=!rs(f,x),o=!rs(v,L)||p!==A,u=!rs(m,k),n.current=IZ(r),s){var R=lS(x,["center","pitch","rotation","zoom","style"]);t.current.updateMap(R)}o&&(t.current.loaded?t.current.changeData(A,L):t.current.once("loaded",function(){var D;(D=t.current)===null||D===void 0||D.changeData(A,L)})),u&&(t.current.loaded?t.current.update(k):t.current.once("loaded",function(){var D;(D=t.current)===null||D===void 0||D.update(k)}))}},[r]),ut.exports.useEffect(function(){return i.current?(n.current||(n.current=IZ(r)),t.current=new e(i.current,_3({},r)),a&&t.current.once("loaded",function(){a(t.current)}),function(){t.current&&(t.current.destroy(),t.current=void 0)}):function(){return null}},[]),{plotRef:t,containerRef:i}}var s_t=globalThis&&globalThis.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),u_t=function(e){s_t(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={hasError:!1},t.renderError=function(n){var i=t.props.errorTemplate;switch(n){default:return i&&typeof i=="function"?i(n):_y("h5",{children:["\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",n.message]})}},t}return r.getDerivedStateFromError=function(t){return{hasError:!0,error:t}},r.getDerivedStateFromProps=function(t,n){return n.children!==t.children?{children:t.children,hasError:!1,error:void 0}:null},r.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):oo(OZ,{children:this.props.children})},r}(Is.Component),l_t=u_t,c_t=function(e){var r=e.loadingTemplate,t=function(){return r||Is.createElement(Nte,{viewBox:"0 0 400 180",width:200,height:90,speed:1},Is.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),Is.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),Is.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),Is.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),Is.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),Is.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),Is.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),Is.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),Is.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),Is.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return Is.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:"#fff"}},t())},f_t=c_t,h_t=globalThis&&globalThis.__rest||function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t},p_t=ut.exports.forwardRef(function(e,r){var t=e.chartRef,n=e.containerStyle,i=n===void 0?{height:"inherit"}:n,a=e.className,o=e.loading,s=e.loadingTemplate,u=e.errorTemplate,l=h_t(e,["chartRef","containerStyle","className","loading","loadingTemplate","errorTemplate"]),f=o_t(zte.Choropleth,l),h=f.plotRef,p=f.containerRef;return ut.exports.useEffect(function(){i_t(t,h.current)},[h.current]),ut.exports.useImperativeHandle(r,function(){return{getChart:function(){return h.current}}}),_y(l_t,{errorTemplate:u,children:[o&&oo(f_t,{loadingTemplate:s}),oo("div",{className:a,style:i,ref:p})]})}),d_t=p_t;const v_t=()=>oo(d_t,{...{map:{type:"mapbox",style:"blank",center:[120.19382669582967,30.258134],zoom:3,pitch:0},source:{data:[{name:"\u4E91\u5357\u7701",code:53e4,value:17881.12},{name:"\u9ED1\u9F99\u6C5F\u7701",code:23e4,value:16361.62},{name:"\u8D35\u5DDE\u7701",code:52e4,value:14806.45},{name:"\u5317\u4EAC\u5E02",code:11e4,value:30319.98},{name:"\u6CB3\u5317\u7701",code:13e4,value:36010.27},{name:"\u5C71\u897F\u7701",code:14e4,value:16818.11},{name:"\u5409\u6797\u7701",code:22e4,value:15074},{name:"\u5B81\u590F\u56DE\u65CF\u81EA\u6CBB\u533A",code:64e4,value:3705.18},{name:"\u8FBD\u5B81\u7701",code:21e4,value:25315.35},{name:"\u6D77\u5357\u7701",code:46e4,value:4832.05},{name:"\u5185\u8499\u53E4\u81EA\u6CBB\u533A",code:15e4,value:17289.22},{name:"\u5929\u6D25\u5E02",code:12e4,value:18809.64},{name:"\u65B0\u7586\u7EF4\u543E\u5C14\u81EA\u6CBB\u533A",code:65e4,value:12199.08},{name:"\u4E0A\u6D77\u5E02",code:31e4,value:32679.87},{name:"\u9655\u897F\u7701",code:61e4,value:24438.32},{name:"\u7518\u8083\u7701",code:62e4,value:8246.07},{name:"\u5B89\u5FBD\u7701",code:34e4,value:30006.82},{name:"\u9999\u6E2F\u7279\u522B\u884C\u653F\u533A",code:81e4,value:0},{name:"\u5E7F\u4E1C\u7701",code:44e4,value:97277.77},{name:"\u6CB3\u5357\u7701",code:41e4,value:48055.86},{name:"\u6E56\u5357\u7701",code:43e4,value:36425.78},{name:"\u6C5F\u897F\u7701",code:36e4,value:21984.78},{name:"\u56DB\u5DDD\u7701",code:51e4,value:40678.13},{name:"\u5E7F\u897F\u58EE\u65CF\u81EA\u6CBB\u533A",code:45e4,value:20353.51},{name:"\u6C5F\u82CF\u7701",code:32e4,value:92595.4},{name:"\u6FB3\u95E8\u7279\u522B\u884C\u653F\u533A",code:82e4,value:null},{name:"\u6D59\u6C5F\u7701",code:33e4,value:56197.15},{name:"\u5C71\u4E1C\u7701",code:37e4,value:76469.67},{name:"\u9752\u6D77\u7701",code:63e4,value:2865.23},{name:"\u91CD\u5E86\u5E02",code:5e5,value:20363.19},{name:"\u798F\u5EFA\u7701",code:35e4,value:35804.04},{name:"\u6E56\u5317\u7701",code:42e4,value:39366.55},{name:"\u897F\u85CF\u81EA\u6CBB\u533A",code:54e4,value:1477.63},{name:"\u53F0\u6E7E\u7701",code:71e4,value:null}],joinBy:{sourceField:"code",geoField:"adcode"}},viewLevel:{level:"country",adcode:1e5},autoFit:!0,color:{field:"value",value:["#B8E1FF","#7DAAFF","#3D76DD","#0047A5","#001D70"],scale:{type:"quantile"}},style:{opacity:1,stroke:"#ccc",lineWidth:.6,lineOpacity:1},label:{visible:!0,field:"name",style:{fill:"#000",opacity:.8,fontSize:10,stroke:"#fff",strokeWidth:1.5,textAllowOverlap:!1,padding:[5,5]}},state:{active:{stroke:"black",lineWidth:1}},tooltip:{items:["name","adcode","value"]},zoom:{position:"bottomright"},legend:{position:"bottomleft"}}});var g_t=v_t;function x_t(){const e=[0,.3333333333333333,.6666666666666666,1],r=["#F4664A","#FAAD14","#30BF78"],t=ut.exports.useRef(null);ut.exports.useEffect(()=>{if(t!=null&&t.current){let s=.7;const u=setInterval(()=>{var l;s>=1.5&&clearInterval(u),s+=.005,(l=t.current)==null||l.changeData(s>1?s-1:s)},100)}},[t]);const n={percent:0,range:{ticks:[0,1],color:["l(0) 0:#F4664A 0.5:#FAAD14 1:#30BF78"]},indicator:{pointer:{style:{stroke:"#D0D0D0"}},pin:{style:{stroke:"#D0D0D0"}}},statistic:{title:{formatter:({percent:s})=>s<e[1]?"\u5DEE":s<e[2]?"\u4E2D":"\u4F18",style:({percent:s})=>({fontSize:"18px",lineHeight:1,color:s<e[1]?r[0]:s<e[2]?r[1]:r[2]})},content:{offsetY:24,style:{fontSize:"12px",color:"#4B535E"},formatter:()=>"\u7CFB\u7EDF\u8868\u73B0"}},onReady:s=>{t.current=s}},i={percent:.25,outline:{border:4,distance:8},wave:{length:128}},o={data:[{type:"\u5BB6\u5177\u5BB6\u7535",sales:38},{type:"\u7CAE\u6CB9\u526F\u98DF",sales:52},{type:"\u751F\u9C9C\u6C34\u679C",sales:61},{type:"\u7F8E\u5BB9\u6D17\u62A4",sales:145},{type:"\u6BCD\u5A74\u7528\u54C1",sales:48},{type:"\u8FDB\u53E3\u98DF\u54C1",sales:38},{type:"\u98DF\u54C1\u996E\u6599",sales:38},{type:"\u5BB6\u5EAD\u6E05\u6D01",sales:38}],xField:"type",yField:"sales",label:{position:"middle",style:{fill:"#FFFFFF",opacity:.6}},xAxis:{label:{autoHide:!0,autoRotate:!1}},meta:{type:{alias:"\u7C7B\u522B"},sales:{alias:"\u9500\u552E\u989D"}}};return _y("div",{children:[oo(bde,{onBack:()=>null,title:"Dashboard",backIcon:!1}),_y(tR,{gutter:[24],children:[oo(Iw,{span:8,children:oo(kw,{title:"\u52A8\u6001\u4EEA\u8868\u76D8",bordered:!1,children:oo("div",{style:{width:"100%",height:180},children:oo(tDe,{...n,ref:t})})})}),oo(Iw,{span:8,children:oo(kw,{title:"\u8FDB\u5EA6",bordered:!1,children:oo("div",{style:{width:"100%",height:180},children:oo(Q5e,{...i})})})}),oo(Iw,{span:8,children:oo(kw,{title:"\u5206\u7C7B\u6761\u76EE",bordered:!1,children:oo("div",{style:{width:"100%",height:180},children:oo(W5e,{...o})})})})]}),oo(tR,{style:{marginTop:24},children:oo(Iw,{span:24,children:oo(kw,{title:"\u4E2D\u56FD\u5730\u56FE",bordered:!1,children:oo("div",{style:{height:500},children:oo(g_t,{})})})})}),oo(tR,{style:{marginTop:24},children:oo(Iw,{span:24,children:oo(kw,{title:"\u6298\u7EBF\u56FE",bordered:!1,children:oo(nDe,{})})})})]})}export{x_t as default};
